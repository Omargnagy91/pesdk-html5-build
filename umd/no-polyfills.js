var PhotoEditorSDK=(()=>{var NP=Object.create,Gl=Object.defineProperty,HP=Object.getPrototypeOf,L1=Object.prototype.hasOwnProperty,WP=Object.getOwnPropertyNames,z1=Object.getOwnPropertyDescriptor,U1=Object.getOwnPropertySymbols,GP=Object.prototype.propertyIsEnumerable;var b=Object.assign,N1=i=>Gl(i,"__esModule",{value:!0});var _i=(i,t)=>{var e={};for(var r in i)L1.call(i,r)&&t.indexOf(r)<0&&(e[r]=i[r]);if(i!=null&&U1)for(var r of U1(i))t.indexOf(r)<0&&GP.call(i,r)&&(e[r]=i[r]);return e},ie=(i,t)=>()=>(t||(t={exports:{}},i(t.exports,t)),t.exports),ne=(i,t)=>{N1(i);for(var e in t)Gl(i,e,{get:t[e],enumerable:!0})},VP=(i,t,e)=>{if(N1(i),t&&typeof t=="object"||typeof t=="function")for(let r of WP(t))!L1.call(i,r)&&r!=="default"&&Gl(i,r,{get:()=>t[r],enumerable:!(e=z1(t,r))||e.enumerable});return i},y=i=>i&&i.__esModule?i:VP(Gl(i!=null?NP(HP(i)):{},"default",{value:i,enumerable:!0}),i),h=(i,t,e,r)=>{for(var o=r>1?void 0:r?z1(t,e):t,s=i.length-1,n;s>=0;s--)(n=i[s])&&(o=(r?n(t,e,o):n(o))||o);return r&&o&&Gl(t,e,o),o};var V=(i,t,e)=>(typeof t!="symbol"&&(t+=""),t in i?Gl(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e);var K=(i,t,e)=>new Promise((r,o)=>{var s=l=>{try{a(e.next(l))}catch(c){o(c)}},n=l=>{try{a(e.throw(l))}catch(c){o(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,n);a((e=e.apply(i,t)).next())});var Py=ie((jV,vw)=>{var zM="Expected a function",Cw=0/0,UM="[object Symbol]",NM=/^\s+|\s+$/g,HM=/^[-+]0x[0-9a-f]+$/i,WM=/^0b[01]+$/i,GM=/^0o[0-7]+$/i,VM=parseInt,jM=typeof global=="object"&&global&&global.Object===Object&&global,$M=typeof self=="object"&&self&&self.Object===Object&&self,YM=jM||$M||Function("return this")(),KM=Object.prototype,XM=KM.toString,qM=Math.max,ZM=Math.min,Oy=function(){return YM.Date.now()};function JM(i,t,e){var r,o,s,n,a,l,c=0,d=!1,u=!1,m=!0;if(typeof i!="function")throw new TypeError(zM);t=Sw(t)||0,Ry(e)&&(d=!!e.leading,u="maxWait"in e,s=u?qM(Sw(e.maxWait)||0,t):s,m="trailing"in e?!!e.trailing:m);function p(T){var F=r,q=o;return r=o=void 0,c=T,n=i.apply(q,F),n}function f(T){return c=T,a=setTimeout(_,t),d?p(T):n}function v(T){var F=T-l,q=T-c,Z=t-F;return u?ZM(Z,s-q):Z}function x(T){var F=T-l,q=T-c;return l===void 0||F>=t||F<0||u&&q>=s}function _(){var T=Oy();if(x(T))return D(T);a=setTimeout(_,v(T))}function D(T){return a=void 0,m&&r?p(T):(r=o=void 0,n)}function k(){a!==void 0&&clearTimeout(a),c=0,r=l=o=a=void 0}function A(){return a===void 0?n:D(Oy())}function B(){var T=Oy(),F=x(T);if(r=arguments,o=this,l=T,F){if(a===void 0)return f(l);if(u)return a=setTimeout(_,t),p(l)}return a===void 0&&(a=setTimeout(_,t)),n}return B.cancel=k,B.flush=A,B}function Ry(i){var t=typeof i;return!!i&&(t=="object"||t=="function")}function QM(i){return!!i&&typeof i=="object"}function t4(i){return typeof i=="symbol"||QM(i)&&XM.call(i)==UM}function Sw(i){if(typeof i=="number")return i;if(t4(i))return Cw;if(Ry(i)){var t=typeof i.valueOf=="function"?i.valueOf():i;i=Ry(t)?t+"":t}if(typeof i!="string")return i===0?i:+i;i=i.replace(NM,"");var e=WM.test(i);return e||GM.test(i)?VM(i.slice(2),e?2:8):HM.test(i)?Cw:+i}vw.exports=JM});var Ck=ie((Fq,_k)=>{var yk="Expected a function",xk=0/0,U4="[object Symbol]",N4=/^\s+|\s+$/g,H4=/^[-+]0x[0-9a-f]+$/i,W4=/^0b[01]+$/i,G4=/^0o[0-7]+$/i,V4=parseInt,j4=typeof global=="object"&&global&&global.Object===Object&&global,$4=typeof self=="object"&&self&&self.Object===Object&&self,Y4=j4||$4||Function("return this")(),K4=Object.prototype,X4=K4.toString,q4=Math.max,Z4=Math.min,ex=function(){return Y4.Date.now()};function J4(i,t,e){var r,o,s,n,a,l,c=0,d=!1,u=!1,m=!0;if(typeof i!="function")throw new TypeError(yk);t=vk(t)||0,zh(e)&&(d=!!e.leading,u="maxWait"in e,s=u?q4(vk(e.maxWait)||0,t):s,m="trailing"in e?!!e.trailing:m);function p(T){var F=r,q=o;return r=o=void 0,c=T,n=i.apply(q,F),n}function f(T){return c=T,a=setTimeout(_,t),d?p(T):n}function v(T){var F=T-l,q=T-c,Z=t-F;return u?Z4(Z,s-q):Z}function x(T){var F=T-l,q=T-c;return l===void 0||F>=t||F<0||u&&q>=s}function _(){var T=ex();if(x(T))return D(T);a=setTimeout(_,v(T))}function D(T){return a=void 0,m&&r?p(T):(r=o=void 0,n)}function k(){a!==void 0&&clearTimeout(a),c=0,r=l=o=a=void 0}function A(){return a===void 0?n:D(ex())}function B(){var T=ex(),F=x(T);if(r=arguments,o=this,l=T,F){if(a===void 0)return f(l);if(u)return a=setTimeout(_,t),p(l)}return a===void 0&&(a=setTimeout(_,t)),n}return B.cancel=k,B.flush=A,B}function Q4(i,t,e){var r=!0,o=!0;if(typeof i!="function")throw new TypeError(yk);return zh(e)&&(r="leading"in e?!!e.leading:r,o="trailing"in e?!!e.trailing:o),J4(i,t,{leading:r,maxWait:t,trailing:o})}function zh(i){var t=typeof i;return!!i&&(t=="object"||t=="function")}function tL(i){return!!i&&typeof i=="object"}function eL(i){return typeof i=="symbol"||tL(i)&&X4.call(i)==U4}function vk(i){if(typeof i=="number")return i;if(eL(i))return xk;if(zh(i)){var t=typeof i.valueOf=="function"?i.valueOf():i;i=zh(t)?t+"":t}if(typeof i!="string")return i===0?i:+i;i=i.replace(N4,"");var e=W4.test(i);return e||G4.test(i)?V4(i.slice(2),e?2:8):H4.test(i)?xk:+i}_k.exports=Q4});var ZT=ie(hz=>{ne(hz,{glGet:()=>lf,webUtils:()=>_z});var lf=i=>{let t={preserveDrawingBuffer:!0};return i.getContext("webgl",t)||i.getContext("experimental-webgl",t)},fz=()=>{let i=lf(Mu()),t=i.getParameter(i.MAX_TEXTURE_SIZE),e=i.getExtension("WEBGL_lose_context");return e&&e.loseContext(),t},gz=(i,t)=>{if(t instanceof af)i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t.width,t.height,0,i.RGBA,i.UNSIGNED_BYTE,t.data);else{let e=qT(t);i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)}},bz=i=>Boolean(i.tagName&&i.tagName.toUpperCase()==="IMG"),_z={isSupported:()=>Boolean(lf(Mu())),isCanvas:i=>i.constructor.name==="Canvas"||Boolean(i.tagName&&i.tagName.toUpperCase()==="CANVAS"),isImage:bz,Image:window.Image,glMaxTexture:fz,glGet:lf,createCanvas:Mu,glResize(i,t){return i},glTexImage:gz}});var oD=ie((Mrt,rD)=>{"use strict";function Sz(i,t){return Object.prototype.hasOwnProperty.call(i,t)}rD.exports=function(i,t,e,r){t=t||"&",e=e||"=";var o={};if(typeof i!="string"||i.length===0)return o;var s=/\+/g;i=i.split(t);var n=1e3;r&&typeof r.maxKeys=="number"&&(n=r.maxKeys);var a=i.length;n>0&&a>n&&(a=n);for(var l=0;l<a;++l){var c=i[l].replace(s,"%20"),d=c.indexOf(e),u,m,p,f;d>=0?(u=c.substr(0,d),m=c.substr(d+1)):(u=c,m=""),p=decodeURIComponent(u),f=decodeURIComponent(m),Sz(o,p)?Array.isArray(o[p])?o[p].push(f):o[p]=[o[p],f]:o[p]=f}return o}});var nD=ie((Lrt,sD)=>{"use strict";var Lu=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}};sD.exports=function(i,t,e,r){return t=t||"&",e=e||"=",i===null&&(i=void 0),typeof i=="object"?Object.keys(i).map(function(o){var s=encodeURIComponent(Lu(o))+e;return Array.isArray(i[o])?i[o].map(function(n){return s+encodeURIComponent(Lu(n))}).join(t):s+encodeURIComponent(Lu(i[o]))}).join(t):r?encodeURIComponent(Lu(r))+e+encodeURIComponent(Lu(i)):""}});var aD=ie(zu=>{"use strict";zu.decode=zu.parse=oD();zu.encode=zu.stringify=nD()});var Vu=ie((kD,Gu)=>{(function(){var i,t,e,r,o,s;typeof performance!="undefined"&&performance!==null&&performance.now?Gu.exports=function(){return performance.now()}:typeof process!="undefined"&&process!==null&&process.hrtime?(Gu.exports=function(){return(i()-o)/1e6},t=process.hrtime,i=function(){var n;return n=t(),n[0]*1e9+n[1]},r=i(),s=process.uptime()*1e9,o=r-s):Date.now?(Gu.exports=function(){return Date.now()-e},e=Date.now()):(Gu.exports=function(){return new Date().getTime()-e},e=new Date().getTime())}).call(kD)});var AD=ie((cnt,Vx)=>{var Yu=function(){function i(d){return r.appendChild(d.dom),d}function t(d){for(var u=0;u<r.children.length;u++)r.children[u].style.display=u===d?"block":"none";e=d}var e=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(d){d.preventDefault(),t(++e%r.children.length)},!1);var o=(performance||Date).now(),s=o,n=0,a=i(new Yu.Panel("FPS","#0ff","#002")),l=i(new Yu.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=i(new Yu.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:i,showPanel:t,begin:function(){o=(performance||Date).now()},end:function(){n++;var d=(performance||Date).now();if(l.update(d-o,200),d>s+1e3&&(a.update(1e3*n/(d-s),100),s=d,n=0,c)){var u=performance.memory;c.update(u.usedJSHeapSize/1048576,u.jsHeapSizeLimit/1048576)}return d},update:function(){o=this.end()},domElement:r,setMode:t}};Yu.Panel=function(i,t,e){var r=Infinity,o=0,s=Math.round,n=s(window.devicePixelRatio||1),a=80*n,l=48*n,c=3*n,d=2*n,u=3*n,m=15*n,p=74*n,f=30*n,v=document.createElement("canvas");v.width=a,v.height=l,v.style.cssText="width:80px;height:48px";var x=v.getContext("2d");return x.font="bold "+9*n+"px Helvetica,Arial,sans-serif",x.textBaseline="top",x.fillStyle=e,x.fillRect(0,0,a,l),x.fillStyle=t,x.fillText(i,c,d),x.fillRect(u,m,p,f),x.fillStyle=e,x.globalAlpha=.9,x.fillRect(u,m,p,f),{dom:v,update:function(_,D){r=Math.min(r,_),o=Math.max(o,_),x.fillStyle=e,x.globalAlpha=1,x.fillRect(0,0,a,m),x.fillStyle=t,x.fillText(s(_)+" "+i+" ("+s(r)+"-"+s(o)+")",c,d),x.drawImage(v,u+n,m,p-n,f,u,m,p-n,f),x.fillRect(u+p-n,m,n,f),x.fillStyle=e,x.globalAlpha=.9,x.fillRect(u+p-n,m,n,s((1-_/D)*f))}}};typeof Vx=="object"&&(Vx.exports=Yu)});var qE=ie((ggt,XE)=>{"use strict";XE.exports=(i,t=1,e)=>{if(e=b({indent:" ",includeEmptyLines:!1},e),typeof i!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof i}\``);if(typeof t!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if(typeof e.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof e.indent}\``);if(t===0)return i;let r=e.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return i.replace(r,e.indent.repeat(t))}});var ZE=ie(()=>{});var eA=ie((ygt,JE)=>{"use strict";var QE=ZE(),tA=/\s+at.*(?:\(|\s)(.*)\)?/,p9=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,h9=typeof QE.homedir=="undefined"?"":QE.homedir();JE.exports=(i,t)=>(t=Object.assign({pretty:!1},t),i.replace(/\\/g,"/").split(`
`).filter(e=>{let r=e.match(tA);if(r===null||!r[1])return!0;let o=r[1];return o.includes(".app/Contents/Resources/electron.asar")||o.includes(".app/Contents/Resources/default_app.asar")?!1:!p9.test(o)}).filter(e=>e.trim()!=="").map(e=>t.pretty?e.replace(tA,(r,o)=>r.replace(o,o.replace(h9,"~"))):e).join(`
`))});var oA=ie((xgt,iA)=>{"use strict";var f9=qE(),g9=eA(),b9=i=>i.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),rA=class extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);t=[...t].map(r=>r instanceof Error?r:r!==null&&typeof r=="object"?Object.assign(new Error(r.message),r):new Error(r));let e=t.map(r=>typeof r.stack=="string"?b9(g9(r.stack)):String(r)).join(`
`);e=`
`+f9(e,4),super(e),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(let t of this._errors)yield t}};iA.exports=rA});var cg=ie((yv,sA)=>{"use strict";var _9=oA();sA.exports=(o,s,...n)=>K(yv,[o,s,...n],function*(i,t,{concurrency:e=Infinity,stopOnError:r=!0}={}){return new Promise((a,l)=>{if(typeof t!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(e)||e===Infinity)&&e>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${e}\` (${typeof e})`);let c=[],d=[],u=i[Symbol.iterator](),m=!1,p=!1,f=0,v=0,x=()=>{if(m)return;let _=u.next(),D=v;if(v++,_.done){p=!0,f===0&&(!r&&d.length!==0?l(new _9(d)):a(c));return}f++,(()=>K(yv,null,function*(){try{let k=yield _.value;c[D]=yield t(k,D),f--,x()}catch(k){r?(m=!0,l(k)):(d.push(k),f--,x())}}))()};for(let _=0;_<e&&(x(),!p);_++);})})});var NA=ie(Y9=>{ne(Y9,{default:()=>K9});var Rg=class{constructor(t){this._editor=t}serialize(...t){return new Og(this._editor).serialize(...t)}deserialize(t){return new Ag(this._editor,t).deserialize()}},K9=Rg;Rg.version="1.0.0"});var WA=ie(X9=>{ne(X9,{default:()=>q9});var zg=class{constructor(t){this._editor=t}serialize(...t){return new Lg(this._editor).serialize(...t)}deserialize(t){return new Bg(this._editor,t).deserialize()}},q9=zg;zg.version="1.0.1"});var $A=ie(J9=>{ne(J9,{default:()=>Q9});var Vg=class{constructor(t){this._editor=t}serialize(...t){return new Gg(this._editor).serialize(...t)}deserialize(t){return new Hg(this._editor,t).deserialize()}},Q9=Vg;Vg.version="2.0.0"});var YA=ie(t7=>{ne(t7,{default:()=>e7});var Zg=class{constructor(t){this._editor=t}serialize(...t){return new qg(this._editor).serialize(...t)}deserialize(t){return new $g(this._editor,t).deserialize()}},e7=Zg;Zg.version="3.0.0"});var KA=ie(i7=>{ne(i7,{default:()=>r7});var ib=class{constructor(t){this._editor=t}serialize(...t){return new eb(this._editor).serialize(...t)}deserialize(t){return new Qg(this._editor,t).deserialize()}},r7=ib;ib.version="3.1.0"});var XA=ie(o7=>{ne(o7,{default:()=>s7});var ab=class{constructor(t){this._editor=t}serialize(...t){return new nb(this._editor).serialize(...t)}deserialize(t){return new ob(this._editor,t).deserialize()}},s7=ab;ab.version="3.2.0"});var qA=ie(n7=>{ne(n7,{default:()=>a7});var mb=class{constructor(t){this._editor=t}serialize(...t){return new ub(this._editor).serialize(...t)}deserialize(t){return new cb(this._editor,t).deserialize()}},a7=mb;mb.version="3.4.0"});var ZA=ie(l7=>{ne(l7,{default:()=>c7});var bb=class{constructor(t){this._editor=t}serialize(...t){return new gb(this._editor).serialize(...t)}deserialize(t){return new hb(this._editor,t).deserialize()}},c7=bb;bb.version="3.5.0"});var JA=ie(d7=>{ne(d7,{default:()=>u7});var Cb=class{constructor(t){this._editor=t}serialize(...t){return new vb(this._editor).serialize(...t)}deserialize(t){return new yb(this._editor,t).deserialize()}},u7=Cb;Cb.version="3.6.0"});var QA=ie(m7=>{ne(m7,{default:()=>p7});var Db=class{constructor(t){this._editor=t}serialize(...t){return new Tb(this._editor).serialize(...t)}deserialize(t){return new wb(this._editor,t).deserialize()}},p7=Db;Db.version="3.7.0"});var tF=ie(h7=>{ne(h7,{default:()=>f7});var Ob=class{constructor(t){this._editor=t}serialize(...t){return new Fb(this._editor).serialize(...t)}deserialize(t){return new Eb(this._editor,t).deserialize()}},f7=Ob;Ob.version="3.8.0"});var oF=ie(g7=>{ne(g7,{default:()=>b7});var Bb=class{constructor(t){this._editor=t}serialize(...t){return new rF(this._editor).serialize(...t)}deserialize(t){return new eF(this._editor,t).deserialize()}},b7=Bb;Bb.version="3.9.0"});var IC=ie(sU=>{ne(sU,{Deserializer:()=>DC,Serializer:()=>TC})});var QF=ie(QU=>{ne(QU,{Color:()=>cn,ColorPicker:()=>d_})});var R1=ie(OW=>{ne(OW,{BasicUI:()=>O1})});var BW={};ne(BW,{AdjustmentConfiguration:()=>Jd,AdjustmentIdentifier:()=>Et,AdjustmentIdentifierKeys:()=>rh,AdvancedUICardLabel:()=>me,AdvancedUICategoryCard:()=>LP,AdvancedUIItemCard:()=>zP,AdvancedUIToolbarItem:()=>Id,BlendMode:()=>vt,BrushConfiguration:()=>nu,CanvasAction:()=>ct,CanvasBarTextSecondaryButton:()=>Du,CardAvatar:()=>Rn,CardType:()=>ft,CategoryHeaderType:()=>we,Checkbox:()=>RP,CheckboxBase:()=>PP,CheckboxCheckMark:()=>MP,CheckboxInput:()=>BP,ColorItem:()=>yP,ColorItemActiveOverlay:()=>SP,ColorItemBackground:()=>vP,ColorItemBase:()=>xP,ColorItemTiledBackground:()=>CP,Configuration:()=>My,ContainedPrimaryButton:()=>hc,Container:()=>_P,CustomToolConfiguration:()=>Ly,Dialog:()=>wP,DialogBackdrop:()=>DP,DialogBase:()=>kP,DialogBody:()=>EP,DialogContainer:()=>TP,DialogFooter:()=>AP,DialogHeader:()=>IP,DialogSpinner:()=>FP,EventEmitter:()=>Ri,ExportConfiguration:()=>By,ExportFormat:()=>qe,FilterCategoryIdentifier:()=>oe,FilterConfiguration:()=>Qd,FilterIdentifier:()=>I,FocusConfiguration:()=>tu,FocusIdentifier:()=>Tt,FrameConfiguration:()=>eu,IconButton:()=>Eo,ImageFormat:()=>Le,ImageMimeType:()=>ir,Label:()=>OP,LibraryCategory:()=>zy,LibraryConfiguration:()=>iu,LibraryImage:()=>Uy,LibraryProvider:()=>Hy,ModalType:()=>Vt,OutlinedPrimaryButton:()=>pc,OutlinedSecondaryButton:()=>Cs,OverlayConfiguration:()=>ru,OverlayIdentifier:()=>dt,PhotoEditorSDKUI:()=>B1,PhotoEditorSDKUIComponent:()=>G_,SearchField:()=>UP,SerializationExportType:()=>ih,SnappingConfiguration:()=>Zd,SpriteActionButton:()=>Zr,StickerConfiguration:()=>ou,TextConfiguration:()=>su,TextDesignConfiguration:()=>au,TextPrimaryButton:()=>On,TextSecondaryButton:()=>Ar,Tool:()=>C,ToolbarIcons:()=>Ka,TransformConfiguration:()=>lu,TransformIdentifier:()=>be,UIEvent:()=>rt,deepmergeAll:()=>hr,defaultConfig:()=>id,isDuoToneFilterAsset:()=>La,isExistingCategory:()=>Ow,isExistingItem:()=>Fw,isGoogleFontAsset:()=>nh,isLUTFilterAsset:()=>oh,isWebFontAsset:()=>sh,useSetImage:()=>bP});var H1={react:"React","react-dom":"ReactDOM","react-dom/server":"ReactDOMServer","styled-components":"styled"};window.require=i=>{if(Object.hasOwnProperty.call(H1,i)){let t=H1[i];if(Object.hasOwnProperty.call(window,t))return window[t];console.log(`Cannot find umd script for ${i}`)}};var jP="An invariant failed, however the error is obfuscated because this is an production build.",xp=[];Object.freeze(xp);var W1={};Object.freeze(W1);var $P={};function Vl(){return typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:$P}function Qi(){return++tt.mobxGuid}function re(i){throw bn(!1,i),"X"}function bn(i,t){if(!i)throw new Error("[mobx] "+(t||jP))}var G1=[];function ds(i,t){return!1}function V_(i){var t=!1;return function(){if(!t)return t=!0,i.apply(this,arguments)}}var V1=function(){};function YP(i){var t=[];return i.forEach(function(e){t.indexOf(e)===-1&&t.push(e)}),t}function j_(i){return i!==null&&typeof i=="object"}function jl(i){if(i===null||typeof i!="object")return!1;var t=Object.getPrototypeOf(i);return t===Object.prototype||t===null}function KP(i){if($l(i)||_o(i))return i;if(Array.isArray(i))return new Map(i);if(jl(i)){var t=new Map;for(var e in i)t.set(e,i[e]);return t}else return re("Cannot convert to map from '"+i+"'")}function XP(i,t){for(var e=0;e<t.length;e++)us(i,t[e],i[t[e]])}function us(i,t,e){Object.defineProperty(i,t,{enumerable:!1,writable:!0,configurable:!0,value:e})}function Rd(i,t,e){Object.defineProperty(i,t,{enumerable:!1,writable:!1,configurable:!0,value:e})}function qP(i,t){}function _n(i,t){var e="isMobX"+i;return t.prototype[e]=!0,function(r){return j_(r)&&r[e]===!0}}function ZP(i,t){return typeof i=="number"&&typeof t=="number"&&isNaN(i)&&isNaN(t)}function $l(i){return Vl().Map!==void 0&&i instanceof Vl().Map}function Pd(i){return i instanceof Set}function ms(i){for(var t=[];;){var e=i.next();if(e.done)break;t.push(e.value)}return t}function j1(){return typeof Symbol=="function"&&Symbol.toPrimitive||"@@toPrimitive"}function $1(i){return i===null?null:typeof i=="object"?""+i:i}function Y1(i,t){for(var e=i.next();!e.done;)t(e.value),e=i.next()}function K1(){return typeof Symbol=="function"&&Symbol.iterator||"@@iterator"}function $_(i,t){Rd(i,K1(),t)}function Bd(i){return i[K1()]=JP,i}function Y_(){return typeof Symbol=="function"&&Symbol.toStringTag||"@@toStringTag"}function JP(){return this}var vp=function(){function i(t){t===void 0&&(t="Atom@"+Qi()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=Gt.NOT_TRACKING}return i.prototype.onBecomeUnobserved=function(){},i.prototype.onBecomeObserved=function(){},i.prototype.reportObserved=function(){return X1(this)},i.prototype.reportChanged=function(){ps(),QP(this),hs()},i.prototype.toString=function(){return this.name},i}(),K_=_n("Atom",vp);function Cp(i,t,e){t===void 0&&(t=V1),e===void 0&&(e=V1);var r=new vp(i);return tB(r,t),q1(r,e),r}function Z1(i,t){return i===t}function eB(i,t){return X_(i,t)}function iB(i,t){return X_(i,t,1)}function rB(i,t){return ZP(i,t)||Z1(i,t)}var Sp={identity:Z1,structural:eB,default:rB,shallow:iB};var q_=function(i,t){return q_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])},q_(i,t)};function J1(i,t){q_(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var de=function(){return de=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},de.apply(this,arguments)};function Z_(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r=e.call(i),o,s=[],n;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(a){n={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(n)throw n.error}}return s}function J_(){for(var i=[],t=0;t<arguments.length;t++)i=i.concat(Z_(arguments[t]));return i}var oB={},sB={};function nB(i,t){var e=t?oB:sB;return e[i]||(e[i]={configurable:!0,enumerable:t,get:function(){return Ea(this),this[i]},set:function(r){Ea(this),this[i]=r}})}function Ea(i){if(i.__mobxDidRunLazyInitializers!==!0){var t=i.__mobxDecorators;if(t){us(i,"__mobxDidRunLazyInitializers",!0);for(var e in t){var r=t[e];r.propertyCreator(i,r.prop,r.descriptor,r.decoratorTarget,r.decoratorArguments)}}}}function Q1(i,t){return function(){var r,o=function(n,a,l,c){if(c===!0)return t(n,a,l,n,r),null;if(!Object.prototype.hasOwnProperty.call(n,"__mobxDecorators")){var d=n.__mobxDecorators;us(n,"__mobxDecorators",de({},d))}return n.__mobxDecorators[a]={prop:a,propertyCreator:t,descriptor:l,decoratorTarget:n,decoratorArguments:r},nB(a,i)};return aB(arguments)?(r=xp,o.apply(null,arguments)):(r=Array.prototype.slice.call(arguments),o)}}function aB(i){return(i.length===2||i.length===3)&&typeof i[1]=="string"||i.length===4&&i[3]===!0}function Md(i,t,e){return wp(i)?i:Array.isArray(i)?Y.array(i,{name:e}):jl(i)?Y.object(i,void 0,{name:e}):$l(i)?Y.map(i,{name:e}):Pd(i)?Y.set(i,{name:e}):i}function lB(i,t,e){return i==null||Fa(i)||Aa(i)||_o(i)||yn(i)?i:Array.isArray(i)?Y.array(i,{name:e,deep:!1}):jl(i)?Y.object(i,void 0,{name:e,deep:!1}):$l(i)?Y.map(i,{name:e,deep:!1}):Pd(i)?Y.set(i,{name:e,deep:!1}):re(!1)}function kp(i){return i}function cB(i,t,e){return X_(i,t)?t:i}function Tp(i){bn(i);var t=Q1(!0,function(r,o,s,n,a){var l=s?s.initializer?s.initializer.call(r):s.value:void 0;dB(r,o,l,i)}),e=typeof process!="undefined"&&process.env&&!1?function(){return arguments.length<2?re("Incorrect decorator invocation. @observable decorator doesn't expect any arguments"):t.apply(null,arguments)}:t;return e.enhancer=i,e}var tS={deep:!0,name:void 0,defaultDecorator:void 0},uB={deep:!1,name:void 0,defaultDecorator:void 0};Object.freeze(tS);Object.freeze(uB);function Yl(i){return i==null?tS:typeof i=="string"?{name:i,deep:!0}:i}function Dp(i){return i.defaultDecorator?i.defaultDecorator.enhancer:i.deep===!1?kp:Md}var Q_=Tp(Md),mB=Tp(lB),eS=Tp(kp),pB=Tp(cB);function hB(i,t,e){if(typeof arguments[1]=="string")return Q_.apply(null,arguments);if(wp(i))return i;var r=jl(i)?Y.object(i,t,e):Array.isArray(i)?Y.array(i,t):$l(i)?Y.map(i,t):Pd(i)?Y.set(i,t):i;if(r!==i)return r;re(!1)}var iS={box:function(i,t){arguments.length>2&&fs("box");var e=Yl(t);return new xn(i,Dp(e),e.name,!0,e.equals)},shallowBox:function(i,t){return arguments.length>2&&fs("shallowBox"),ds("observable.shallowBox","observable.box(value, { deep: false })"),Y.box(i,{name:t,deep:!1})},array:function(i,t){arguments.length>2&&fs("array");var e=Yl(t);return new yo(i,Dp(e),e.name)},shallowArray:function(i,t){return arguments.length>2&&fs("shallowArray"),ds("observable.shallowArray","observable.array(values, { deep: false })"),Y.array(i,{name:t,deep:!1})},map:function(i,t){arguments.length>2&&fs("map");var e=Yl(t);return new Ip(i,Dp(e),e.name)},shallowMap:function(i,t){return arguments.length>2&&fs("shallowMap"),ds("observable.shallowMap","observable.map(values, { deep: false })"),Y.map(i,{name:t,deep:!1})},set:function(i,t){arguments.length>2&&fs("set");var e=Yl(t);return new Ep(i,Dp(e),e.name)},object:function(i,t,e){typeof arguments[1]=="string"&&fs("object");var r=Yl(e);return fB({},i,t,r)},shallowObject:function(i,t){return typeof arguments[1]=="string"&&fs("shallowObject"),ds("observable.shallowObject","observable.object(values, {}, { deep: false })"),Y.object(i,{},{name:t,deep:!1})},ref:eS,shallow:mB,deep:Q_,struct:pB},Y=hB;Object.keys(iS).forEach(function(i){return Y[i]=iS[i]});function fs(i){re("Expected one or two arguments to observable."+i+". Did you accidentally try to use observable."+i+" as decorator?")}var Ap=Q1(!1,function(i,t,e,r,o){var s=e.get,n=e.set,a=o[0]||{};gB(i,t,de({get:s,set:n},a))}),bB=Ap({equals:Sp.structural}),S=function(t,e,r){if(typeof e=="string"||t!==null&&typeof t=="object"&&arguments.length===1)return Ap.apply(null,arguments);var o=typeof e=="object"?e:{};return o.get=t,o.set=typeof e=="function"?e:o.set,o.name=o.name||t.name||"",new vn(o)};S.struct=bB;var Gt;(function(i){i[i.NOT_TRACKING=-1]="NOT_TRACKING",i[i.UP_TO_DATE=0]="UP_TO_DATE",i[i.POSSIBLY_STALE=1]="POSSIBLY_STALE",i[i.STALE=2]="STALE"})(Gt||(Gt={}));var Hr;(function(i){i[i.NONE=0]="NONE",i[i.LOG=1]="LOG",i[i.BREAK=2]="BREAK"})(Hr||(Hr={}));var Fp=function(){function i(t){this.cause=t}return i}();function Ld(i){return i instanceof Fp}function ty(i){switch(i.dependenciesState){case Gt.UP_TO_DATE:return!1;case Gt.NOT_TRACKING:case Gt.STALE:return!0;case Gt.POSSIBLY_STALE:{for(var t=Oa(!0),e=Kl(),r=i.observing,o=r.length,s=0;s<o;s++){var n=r[s];if(Op(n)){if(tt.disableErrorBoundaries)n.get();else try{n.get()}catch(a){return Cn(e),gs(t),!0}if(i.dependenciesState===Gt.STALE)return Cn(e),gs(t),!0}}return rS(i),Cn(e),gs(t),!1}}}function Xl(i){var t=i.observers.length>0;tt.computationDepth>0&&t&&re(!1),!tt.allowStateChanges&&(t||tt.enforceActions==="strict")&&re(!1)}function _B(i){}function oS(i,t,e){var r=Oa(!0);rS(i),i.newObserving=new Array(i.observing.length+100),i.unboundDepsCount=0,i.runId=++tt.runId;var o=tt.trackingDerivation;tt.trackingDerivation=i;var s;if(tt.disableErrorBoundaries===!0)s=t.call(e);else try{s=t.call(e)}catch(n){s=new Fp(n)}return tt.trackingDerivation=o,xB(i),i.observing.length===0&&yB(i),gs(r),s}function yB(i){}function xB(i){for(var t=i.observing,e=i.observing=i.newObserving,r=Gt.UP_TO_DATE,o=0,s=i.unboundDepsCount,n=0;n<s;n++){var a=e[n];a.diffValue===0&&(a.diffValue=1,o!==n&&(e[o]=a),o++),a.dependenciesState>r&&(r=a.dependenciesState)}for(e.length=o,i.newObserving=null,s=t.length;s--;){var a=t[s];a.diffValue===0&&sS(a,i),a.diffValue=0}for(;o--;){var a=e[o];a.diffValue===1&&(a.diffValue=0,vB(a,i))}r!==Gt.UP_TO_DATE&&(i.dependenciesState=r,i.onBecomeStale())}function ey(i){var t=i.observing;i.observing=[];for(var e=t.length;e--;)sS(t[e],i);i.dependenciesState=Gt.NOT_TRACKING}function iy(i){var t=Kl(),e=i();return Cn(t),e}function Kl(){var i=tt.trackingDerivation;return tt.trackingDerivation=null,i}function Cn(i){tt.trackingDerivation=i}function Oa(i){var t=tt.allowStateReads;return tt.allowStateReads=i,t}function gs(i){tt.allowStateReads=i}function rS(i){if(i.dependenciesState!==Gt.UP_TO_DATE){i.dependenciesState=Gt.UP_TO_DATE;for(var t=i.observing,e=t.length;e--;)t[e].lowestObserverState=Gt.UP_TO_DATE}}var Rp=0,CB=1,nS=Object.getOwnPropertyDescriptor(function(){},"name"),zW=nS&&nS.configurable;function Ra(i,t){var e=function(){return aS(i,t,this,arguments)};return e.isMobxAction=!0,e}function aS(i,t,e,r){var o=SB(i,e,r);try{return t.apply(e,r)}catch(s){throw o.error=s,s}finally{wB(o)}}function SB(i,t,e){var r=oi()&&!!i,o=0;if(r){o=Date.now();var s=e&&e.length||0,n=new Array(s);if(s>0)for(var a=0;a<s;a++)n[a]=e[a];tr({type:"action",name:i,object:t,arguments:n})}var l=Kl();ps();var c=zd(!0),d=Oa(!0),u={prevDerivation:l,prevAllowStateChanges:c,prevAllowStateReads:d,notifySpy:r,startTime:o,actionId:CB++,parentActionId:Rp};return Rp=u.actionId,u}function wB(i){Rp!==i.actionId&&re("invalid action stack. did you forget to finish an action?"),Rp=i.parentActionId,i.error!==void 0&&(tt.suppressReactionErrors=!0),Ud(i.prevAllowStateChanges),gs(i.prevAllowStateReads),hs(),Cn(i.prevDerivation),i.notifySpy&&er({time:Date.now()-i.startTime}),tt.suppressReactionErrors=!1}function lS(i,t){var e=zd(i),r;try{r=t()}finally{Ud(e)}return r}function zd(i){var t=tt.allowStateChanges;return tt.allowStateChanges=i,t}function Ud(i){tt.allowStateChanges=i}var xn=function(i){J1(t,i);function t(e,r,o,s,n){o===void 0&&(o="ObservableValue@"+Qi()),s===void 0&&(s=!0),n===void 0&&(n=Sp.default);var a=i.call(this,o)||this;return a.enhancer=r,a.name=o,a.equals=n,a.hasUnreportedChange=!1,a.value=r(e,void 0,o),s&&oi()&&Pa({type:"create",name:a.name,newValue:""+a.value}),a}return t.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},t.prototype.set=function(e){var r=this.value;if(e=this.prepareNewValue(e),e!==tt.UNCHANGED){var o=oi();o&&tr({type:"update",name:this.name,newValue:e,oldValue:r}),this.setNewValue(e),o&&er()}},t.prototype.prepareNewValue=function(e){if(Xl(this),xo(this)){var r=vo(this,{object:this,type:"update",newValue:e});if(!r)return tt.UNCHANGED;e=r.newValue}return e=this.enhancer(e,this.value,this.name),this.equals(this.value,e)?tt.UNCHANGED:e},t.prototype.setNewValue=function(e){var r=this.value;this.value=e,this.reportChanged(),Wr(this)&&Gr(this,{type:"update",object:this,newValue:e,oldValue:r})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(e){return Nd(this,e)},t.prototype.observe=function(e,r){return r&&e({object:this,type:"update",newValue:this.value,oldValue:void 0}),Hd(this,e)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return $1(this.get())},t}(vp);xn.prototype[j1()]=xn.prototype.valueOf;var kB=_n("ObservableValue",xn),vn=function(){function i(t){this.dependenciesState=Gt.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=Gt.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Qi(),this.value=new Fp(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=Hr.NONE,bn(t.get,"missing option for computed: get"),this.derivation=t.get,this.name=t.name||"ComputedValue@"+Qi(),t.set&&(this.setter=Ra(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?Sp.structural:Sp.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return i.prototype.onBecomeStale=function(){DB(this)},i.prototype.onBecomeUnobserved=function(){},i.prototype.onBecomeObserved=function(){},i.prototype.get=function(){this.isComputing&&re("Cycle detected in computation "+this.name+": "+this.derivation),tt.inBatch===0&&this.observers.length===0&&!this.keepAlive?ty(this)&&(this.warnAboutUntrackedRead(),ps(),this.value=this.computeValue(!1),hs()):(X1(this),ty(this)&&this.trackAndCompute()&&TB(this));var t=this.value;if(Ld(t))throw t.cause;return t},i.prototype.peek=function(){var t=this.computeValue(!1);if(Ld(t))throw t.cause;return t},i.prototype.set=function(t){if(this.setter){bn(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else bn(!1,!1)},i.prototype.trackAndCompute=function(){oi()&&Pa({object:this.scope,type:"compute",name:this.name});var t=this.value,e=this.dependenciesState===Gt.NOT_TRACKING,r=this.computeValue(!0),o=e||Ld(t)||Ld(r)||!this.equals(t,r);return o&&(this.value=r),o},i.prototype.computeValue=function(t){this.isComputing=!0,tt.computationDepth++;var e;if(t)e=oS(this,this.derivation,this.scope);else if(tt.disableErrorBoundaries===!0)e=this.derivation.call(this.scope);else try{e=this.derivation.call(this.scope)}catch(r){e=new Fp(r)}return tt.computationDepth--,this.isComputing=!1,e},i.prototype.suspend=function(){this.keepAlive||(ey(this),this.value=void 0)},i.prototype.observe=function(t,e){var r=this,o=!0,s=void 0;return IB(function(){var n=r.get();if(!o||e){var a=Kl();t({type:"update",object:r,newValue:n,oldValue:s}),Cn(a)}o=!1,s=n})},i.prototype.warnAboutUntrackedRead=function(){},i.prototype.toJSON=function(){return this.get()},i.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},i.prototype.valueOf=function(){return $1(this.get())},i}();vn.prototype[j1()]=vn.prototype.valueOf;var Op=_n("ComputedValue",vn);var Pp=function(){function i(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return i}(),Bp=!0,cS=!1,tt=function(){var i=Vl();return i.__mobxInstanceCount>0&&!i.__mobxGlobals&&(Bp=!1),i.__mobxGlobals&&i.__mobxGlobals.version!==new Pp().version&&(Bp=!1),Bp?i.__mobxGlobals?(i.__mobxInstanceCount+=1,i.__mobxGlobals.UNCHANGED||(i.__mobxGlobals.UNCHANGED={}),i.__mobxGlobals):(i.__mobxInstanceCount=1,i.__mobxGlobals=new Pp):(setTimeout(function(){cS||re("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new Pp)}();function EB(){(tt.pendingReactions.length||tt.inBatch||tt.isRunningReactions)&&re("isolateGlobalState should be called before MobX is running any reactions"),cS=!0,Bp&&(--Vl().__mobxInstanceCount==0&&(Vl().__mobxGlobals=void 0),tt=new Pp)}function vB(i,t){var e=i.observers.length;e&&(i.observersIndexes[t.__mapid]=e),i.observers[e]=t,i.lowestObserverState>t.dependenciesState&&(i.lowestObserverState=t.dependenciesState)}function sS(i,t){if(i.observers.length===1)i.observers.length=0,dS(i);else{var e=i.observers,r=i.observersIndexes,o=e.pop();if(o!==t){var s=r[t.__mapid]||0;s?r[o.__mapid]=s:delete r[o.__mapid],e[s]=o}delete r[t.__mapid]}}function dS(i){i.isPendingUnobservation===!1&&(i.isPendingUnobservation=!0,tt.pendingUnobservations.push(i))}function ps(){tt.inBatch++}function hs(){if(--tt.inBatch==0){uS();for(var i=tt.pendingUnobservations,t=0;t<i.length;t++){var e=i[t];e.isPendingUnobservation=!1,e.observers.length===0&&(e.isBeingObserved&&(e.isBeingObserved=!1,e.onBecomeUnobserved()),e instanceof vn&&e.suspend())}tt.pendingUnobservations=[]}}function X1(i){_B(i);var t=tt.trackingDerivation;return t!==null?(t.runId!==i.lastAccessedBy&&(i.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=i,i.isBeingObserved||(i.isBeingObserved=!0,i.onBecomeObserved())),!0):(i.observers.length===0&&tt.inBatch>0&&dS(i),!1)}function QP(i){if(i.lowestObserverState!==Gt.STALE){i.lowestObserverState=Gt.STALE;for(var t=i.observers,e=t.length;e--;){var r=t[e];r.dependenciesState===Gt.UP_TO_DATE&&(r.isTracing!==Hr.NONE&&mS(r,i),r.onBecomeStale()),r.dependenciesState=Gt.STALE}}}function TB(i){if(i.lowestObserverState!==Gt.STALE){i.lowestObserverState=Gt.STALE;for(var t=i.observers,e=t.length;e--;){var r=t[e];r.dependenciesState===Gt.POSSIBLY_STALE?r.dependenciesState=Gt.STALE:r.dependenciesState===Gt.UP_TO_DATE&&(i.lowestObserverState=Gt.UP_TO_DATE)}}}function DB(i){if(i.lowestObserverState===Gt.UP_TO_DATE){i.lowestObserverState=Gt.POSSIBLY_STALE;for(var t=i.observers,e=t.length;e--;){var r=t[e];r.dependenciesState===Gt.UP_TO_DATE&&(r.dependenciesState=Gt.POSSIBLY_STALE,r.isTracing!==Hr.NONE&&mS(r,i),r.onBecomeStale())}}}function mS(i,t){if(console.log("[mobx.trace] '"+i.name+"' is invalidated due to a change in: '"+t.name+"'"),i.isTracing===Hr.BREAK){var e=[];pS(ry(i),e,1),new Function(`debugger;
/*
Tracing '`+i.name+`'

You are entering this break point because derivation '`+i.name+"' is being traced and '"+t.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(i instanceof vn?i.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+e.join(`
`)+`
*/
    `)()}}function pS(i,t,e){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+new Array(e).join("	")+i.name),i.dependencies&&i.dependencies.forEach(function(r){return pS(r,t,e+1)})}var Sn=function(){function i(t,e,r,o){t===void 0&&(t="Reaction@"+Qi()),o===void 0&&(o=!1),this.name=t,this.onInvalidate=e,this.errorHandler=r,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=Gt.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Qi(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=Hr.NONE}return i.prototype.onBecomeStale=function(){this.schedule()},i.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,tt.pendingReactions.push(this),uS())},i.prototype.isScheduled=function(){return this._isScheduled},i.prototype.runReaction=function(){if(!this.isDisposed){if(ps(),this._isScheduled=!1,ty(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&oi()&&Pa({name:this.name,type:"scheduled-reaction"})}catch(t){this.reportExceptionInDerivation(t)}}hs()}},i.prototype.track=function(t){ps();var e=oi(),r;e&&(r=Date.now(),tr({name:this.name,type:"reaction"})),this._isRunning=!0;var o=oS(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&ey(this),Ld(o)&&this.reportExceptionInDerivation(o.cause),e&&er({time:Date.now()-r}),hs()},i.prototype.reportExceptionInDerivation=function(t){var e=this;if(this.errorHandler){this.errorHandler(t,this);return}if(tt.disableErrorBoundaries)throw t;var r="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";tt.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(r,t),oi()&&Pa({type:"error",name:this.name,message:r,error:""+t}),tt.globalReactionErrorHandlers.forEach(function(o){return o(t,e)})},i.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(ps(),ey(this),hs()))},i.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t.$mobx=this,t},i.prototype.toString=function(){return"Reaction["+this.name+"]"},i.prototype.trace=function(t){t===void 0&&(t=!1),AB(this,t)},i}();var hS=100,oy=function(i){return i()};function uS(){tt.inBatch>0||tt.isRunningReactions||oy(FB)}function FB(){tt.isRunningReactions=!0;for(var i=tt.pendingReactions,t=0;i.length>0;){++t===hS&&(console.error("Reaction doesn't converge to a stable state after "+hS+" iterations."+(" Probably there is a cycle in the reactive function: "+i[0])),i.splice(0));for(var e=i.splice(0),r=0,o=e.length;r<o;r++)e[r].runReaction()}tt.isRunningReactions=!1}var Mp=_n("Reaction",Sn);function OB(i){var t=oy;oy=function(e){return i(function(){return t(e)})}}function oi(){return!!tt.spyListeners.length}function Pa(i){if(!!tt.spyListeners.length)for(var t=tt.spyListeners,e=0,r=t.length;e<r;e++)t[e](i)}function tr(i){var t=de(de({},i),{spyReportStart:!0});Pa(t)}var RB={spyReportEnd:!0};function er(i){Pa(i?de(de({},i),{spyReportEnd:!0}):RB)}function sy(i){return tt.spyListeners.push(i),V_(function(){tt.spyListeners=tt.spyListeners.filter(function(t){return t!==i})})}function PB(){re(!1)}function fS(i){return function(t,e,r){if(r){if(r.value)return{value:Ra(i,r.value),enumerable:!1,configurable:!0,writable:!0};var o=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return Ra(i,o.call(this))}}}return BB(i).apply(this,arguments)}}function BB(i){return function(t,e,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!1,get:function(){},set:function(o){us(this,e,w(i,o))}})}}function MB(i,t,e,r){return r===!0?(ny(i,t,e.value),null):e?{configurable:!0,enumerable:!1,get:function(){return ny(this,t,e.value||e.initializer.call(this)),this[t]},set:PB}:{enumerable:!1,configurable:!0,set:function(o){ny(this,t,o)},get:function(){}}}var w=function(t,e,r,o){if(arguments.length===1&&typeof t=="function")return Ra(t.name||"<unnamed action>",t);if(arguments.length===2&&typeof e=="function")return Ra(t,e);if(arguments.length===1&&typeof t=="string")return fS(t);if(o===!0)t[e]=Ra(t.name||e,r.value);else return fS(e).apply(null,arguments)};w.bound=MB;function Me(i,t){var e=typeof i=="string"?i:i.name||"<unnamed action>",r=typeof i=="function"?i:t;return aS(e,r,this,void 0)}function ny(i,t,e){us(i,t,Ra(t,e.bind(i)))}function IB(i,t){t===void 0&&(t=W1);var e=t&&t.name||i.name||"Autorun@"+Qi(),r=!t.scheduler&&!t.delay,o;if(r)o=new Sn(e,function(){this.track(a)},t.onError,t.requiresObservable);else{var s=LB(t),n=!1;o=new Sn(e,function(){n||(n=!0,s(function(){n=!1,o.isDisposed||o.track(a)}))},t.onError,t.requiresObservable)}function a(){i(o)}return o.schedule(),o.getDisposer()}var zB=function(i){return i()};function LB(i){return i.scheduler?i.scheduler:i.delay?function(t){return setTimeout(t,i.delay)}:zB}function tB(i,t,e){return gS("onBecomeObserved",i,t,e)}function q1(i,t,e){return gS("onBecomeUnobserved",i,t,e)}function gS(i,t,e,r){var o=typeof r=="function"?wn(t,e):wn(t),s=typeof r=="function"?r:e,n=o[i];return typeof n!="function"?re(!1):(o[i]=function(){n.call(this),s.call(this)},function(){o[i]=n})}function Lp(i){var t=i.enforceActions,e=i.computedRequiresReaction,r=i.computedConfigurable,o=i.disableErrorBoundaries,s=i.arrayBuffer,n=i.reactionScheduler,a=i.reactionRequiresObservable,l=i.observableRequiresReaction;if(i.isolateGlobalState===!0&&EB(),t!==void 0){(typeof t=="boolean"||t==="strict")&&ds(`Deprecated value for 'enforceActions', use 'false' => '"never"', 'true' => '"observed"', '"strict"' => "'always'" instead`);var c=void 0;switch(t){case!0:case"observed":c=!0;break;case!1:case"never":c=!1;break;case"strict":case"always":c="strict";break;default:re("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}tt.enforceActions=c,tt.allowStateChanges=!(c===!0||c==="strict")}e!==void 0&&(tt.computedRequiresReaction=!!e),a!==void 0&&(tt.reactionRequiresObservable=!!a),l!==void 0&&(tt.observableRequiresReaction=!!l,tt.allowStateReads=!tt.observableRequiresReaction),r!==void 0&&(tt.computedConfigurable=!!r),o!==void 0&&(o===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),tt.disableErrorBoundaries=!!o),typeof s=="number"&&ay(s),n&&OB(n)}function fB(i,t,e,r){if(!1&&e)for(var o in e);r=Yl(r);var s=r.defaultDecorator||(r.deep===!1?eS:Q_);Ea(i),ly(i,r.name,s.enhancer),ps();try{for(var n=Object.getOwnPropertyNames(t),a=0,l=n.length;a<l;a++){var o=n[a],c=Object.getOwnPropertyDescriptor(t,o),d=e&&o in e?e[o]:c.get?Ap:s,u=d(i,o,c,!0);u&&Object.defineProperty(i,o,u)}}finally{hs()}return i}function ry(i,t){return bS(wn(i,t))}function bS(i){var t={name:i.name};return i.observing&&i.observing.length>0&&(t.dependencies=YP(i.observing).map(bS)),t}function UB(){this.message="FLOW_CANCELLED"}UB.prototype=Object.create(Error.prototype);function NB(i,t){if(i==null)return!1;if(t!==void 0){if(Fa(i)){var e=i.$mobx;return e.values&&!!e.values[t]}return!1}return Fa(i)||!!i.$mobx||K_(i)||Mp(i)||Op(i)}function wp(i){return arguments.length!==1&&re(!1),NB(i)}function HB(i){return Fa(i)?i.$mobx.getKeys():_o(i)||yn(i)?ms(i.keys()):Aa(i)?i.map(function(t,e){return e}):re(!1)}var WB={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function ql(i,t,e,r){return r.detectCycles&&i.set(t,e),e}function kn(i,t,e){if(!t.recurseEverything&&!wp(i)||typeof i!="object")return i;if(i===null)return null;if(i instanceof Date)return i;if(kB(i))return kn(i.get(),t,e);wp(i)&&HB(i);var r=t.detectCycles===!0;if(r&&i!==null&&e.has(i))return e.get(i);if(Aa(i)||Array.isArray(i)){var o=ql(e,i,[],t),s=i.map(function(f){return kn(f,t,e)});o.length=s.length;for(var n=0,a=s.length;n<a;n++)o[n]=s[n];return o}if(yn(i)||Object.getPrototypeOf(i)===Set.prototype)if(t.exportMapsAsObjects===!1){var l=ql(e,i,new Set,t);return i.forEach(function(f){l.add(kn(f,t,e))}),l}else{var c=ql(e,i,[],t);return i.forEach(function(f){c.push(kn(f,t,e))}),c}if(_o(i)||Object.getPrototypeOf(i)===Map.prototype)if(t.exportMapsAsObjects===!1){var d=ql(e,i,new Map,t);return i.forEach(function(f,v){d.set(v,kn(f,t,e))}),d}else{var u=ql(e,i,{},t);return i.forEach(function(f,v){u[v]=kn(f,t,e)}),u}var m=ql(e,i,{},t);for(var p in i)m[p]=kn(i[p],t,e);return m}function at(i,t){typeof t=="boolean"&&(t={detectCycles:t}),t||(t=WB),t.detectCycles=t.detectCycles===void 0?t.recurseEverything===!0:t.detectCycles===!0;var e;return t.detectCycles&&(e=new Map),kn(i,t,e)}function AB(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];var e=!1;typeof i[i.length-1]=="boolean"&&(e=i.pop());var r=GB(i);if(!r)return re(!1);r.isTracing===Hr.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled"),r.isTracing=e?Hr.BREAK:Hr.LOG}function GB(i){switch(i.length){case 0:return tt.trackingDerivation;case 1:return wn(i[0]);case 2:return wn(i[0],i[1])}}function Co(i,t){t===void 0&&(t=void 0),ps();try{return i.apply(t)}finally{hs()}}function xo(i){return i.interceptors!==void 0&&i.interceptors.length>0}function Nd(i,t){var e=i.interceptors||(i.interceptors=[]);return e.push(t),V_(function(){var r=e.indexOf(t);r!==-1&&e.splice(r,1)})}function vo(i,t){var e=Kl();try{var r=i.interceptors;if(r)for(var o=0,s=r.length;o<s&&(t=r[o](t),bn(!t||t.type,"Intercept handlers should return nothing or a change object"),!!t);o++);return t}finally{Cn(e)}}function Wr(i){return i.changeListeners!==void 0&&i.changeListeners.length>0}function Hd(i,t){var e=i.changeListeners||(i.changeListeners=[]);return e.push(t),V_(function(){var r=e.indexOf(t);r!==-1&&e.splice(r,1)})}function Gr(i,t){var e=Kl(),r=i.changeListeners;if(!!r){r=r.slice();for(var o=0,s=r.length;o<s;o++)r[o](t);Cn(e)}}var VB=1e4,jB=function(){var i=!1,t={};return Object.defineProperty(t,"0",{set:function(){i=!0}}),Object.create(t)["0"]=1,i===!1}(),cy=0,dy=function(){function i(){}return i}();function $B(i,t){typeof Object.setPrototypeOf!="undefined"?Object.setPrototypeOf(i.prototype,t):typeof i.prototype.__proto__!="undefined"?i.prototype.__proto__=t:i.prototype=t}$B(dy,Array.prototype);Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(i){Object.defineProperty(dy.prototype,i,{configurable:!0,writable:!0,value:Array.prototype[i]})});var _S=function(){function i(t,e,r,o){this.array=r,this.owned=o,this.values=[],this.lastKnownLength=0,this.atom=new vp(t||"ObservableArray@"+Qi()),this.enhancer=function(s,n){return e(s,n,t+"[..]")}}return i.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},i.prototype.dehanceValues=function(t){return this.dehancer!==void 0&&t.length>0?t.map(this.dehancer):t},i.prototype.intercept=function(t){return Nd(this,t)},i.prototype.observe=function(t,e){return e===void 0&&(e=!1),e&&t({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),Hd(this,t)},i.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},i.prototype.setArrayLength=function(t){if(typeof t!="number"||t<0)throw new Error("[mobx.array] Out of range: "+t);var e=this.values.length;if(t!==e)if(t>e){for(var r=new Array(t-e),o=0;o<t-e;o++)r[o]=void 0;this.spliceWithArray(e,0,r)}else this.spliceWithArray(t,e-t)},i.prototype.updateArrayLength=function(t,e){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=e,e>0&&t+e+1>cy&&ay(t+e+1)},i.prototype.spliceWithArray=function(t,e,r){var o=this;Xl(this.atom);var s=this.values.length;if(t===void 0?t=0:t>s?t=s:t<0&&(t=Math.max(0,s+t)),arguments.length===1?e=s-t:e==null?e=0:e=Math.max(0,Math.min(e,s-t)),r===void 0&&(r=xp),xo(this)){var n=vo(this,{object:this.array,type:"splice",index:t,removedCount:e,added:r});if(!n)return xp;e=n.removedCount,r=n.added}r=r.length===0?r:r.map(function(c){return o.enhancer(c,void 0)});var a=r.length-e;this.updateArrayLength(s,a);var l=this.spliceItemsIntoValues(t,e,r);return(e!==0||r.length!==0)&&this.notifyArraySplice(t,r,l),this.dehanceValues(l)},i.prototype.spliceItemsIntoValues=function(t,e,r){var o;if(r.length<VB)return(o=this.values).splice.apply(o,J_([t,e],r));var s=this.values.slice(t,t+e);return this.values=this.values.slice(0,t).concat(r,this.values.slice(t+e)),s},i.prototype.notifyArrayChildUpdate=function(t,e,r){var o=!this.owned&&oi(),s=Wr(this),n=s||o?{object:this.array,type:"update",index:t,newValue:e,oldValue:r}:null;o&&tr(de(de({},n),{name:this.atom.name})),this.atom.reportChanged(),s&&Gr(this,n),o&&er()},i.prototype.notifyArraySplice=function(t,e,r){var o=!this.owned&&oi(),s=Wr(this),n=s||o?{object:this.array,type:"splice",index:t,removed:r,added:e,removedCount:r.length,addedCount:e.length}:null;o&&tr(de(de({},n),{name:this.atom.name})),this.atom.reportChanged(),s&&Gr(this,n),o&&er()},i}(),yo=function(i){J1(t,i);function t(e,r,o,s){o===void 0&&(o="ObservableArray@"+Qi()),s===void 0&&(s=!1);var n=i.call(this)||this,a=new _S(o,r,n,s);if(Rd(n,"$mobx",a),e&&e.length){var l=zd(!0);n.spliceWithArray(0,0,e),Ud(l)}return jB&&Object.defineProperty(a.array,"0",YB),n}return t.prototype.intercept=function(e){return this.$mobx.intercept(e)},t.prototype.observe=function(e,r){return r===void 0&&(r=!1),this.$mobx.observe(e,r)},t.prototype.clear=function(){return this.splice(0)},t.prototype.concat=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),e.map(function(o){return Aa(o)?o.peek():o}))},t.prototype.replace=function(e){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,e)},t.prototype.toJS=function(){return this.slice()},t.prototype.toJSON=function(){return this.toJS()},t.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},t.prototype.find=function(e,r,o){o===void 0&&(o=0),arguments.length===3&&ds("The array.find fromIndex argument to find will not be supported anymore in the next major");var s=this.findIndex.apply(this,arguments);return s===-1?void 0:this.get(s)},t.prototype.findIndex=function(e,r,o){o===void 0&&(o=0),arguments.length===3&&ds("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");for(var s=this.peek(),n=s.length,a=o;a<n;a++)if(e.call(r,s[a],a,this))return a;return-1},t.prototype.splice=function(e,r){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(e);case 2:return this.$mobx.spliceWithArray(e,r)}return this.$mobx.spliceWithArray(e,r,o)},t.prototype.spliceWithArray=function(e,r,o){return this.$mobx.spliceWithArray(e,r,o)},t.prototype.push=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(o.values.length,0,e),o.values.length},t.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},t.prototype.shift=function(){return this.splice(0,1)[0]},t.prototype.unshift=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(0,0,e),o.values.length},t.prototype.reverse=function(){var e=this.slice();return e.reverse.apply(e,arguments)},t.prototype.sort=function(e){var r=this.slice();return r.sort.apply(r,arguments)},t.prototype.remove=function(e){var r=this.$mobx.dehanceValues(this.$mobx.values).indexOf(e);return r>-1?(this.splice(r,1),!0):!1},t.prototype.move=function(e,r){ds("observableArray.move is deprecated, use .slice() & .replace() instead");function o(a){if(a<0)throw new Error("[mobx.array] Index out of bounds: "+a+" is negative");var l=this.$mobx.values.length;if(a>=l)throw new Error("[mobx.array] Index out of bounds: "+a+" is not smaller than "+l)}if(o.call(this,e),o.call(this,r),e!==r){var s=this.$mobx.values,n;e<r?n=J_(s.slice(0,e),s.slice(e+1,r+1),[s[e]],s.slice(r+1)):n=J_(s.slice(0,r),[s[e]],s.slice(r,e),s.slice(e+1)),this.replace(n)}},t.prototype.get=function(e){var r=this.$mobx;if(r){if(e<r.values.length)return r.atom.reportObserved(),r.dehanceValue(r.values[e]);console.warn("[mobx.array] Attempt to read an array index ("+e+") that is out of bounds ("+r.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},t.prototype.set=function(e,r){var o=this.$mobx,s=o.values;if(e<s.length){Xl(o.atom);var n=s[e];if(xo(o)){var a=vo(o,{type:"update",object:this,index:e,newValue:r});if(!a)return;r=a.newValue}r=o.enhancer(r,n);var l=r!==n;l&&(s[e]=r,o.notifyArrayChildUpdate(e,r,n))}else if(e===s.length)o.spliceWithArray(e,0,[r]);else throw new Error("[mobx.array] Index out of bounds, "+e+" is larger than "+s.length)},t}(dy);$_(yo.prototype,function(){this.$mobx.atom.reportObserved();var i=this,t=0;return Bd({next:function(){return t<i.length?{value:i[t++],done:!1}:{done:!0,value:void 0}}})});Object.defineProperty(yo.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(i){this.$mobx.setArrayLength(i)}});us(yo.prototype,Y_(),"Array");["indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(i){var t=Array.prototype[i];bn(typeof t=="function","Base function not defined on Array prototype: '"+i+"'"),us(yo.prototype,i,function(){return t.apply(this.peek(),arguments)})});["every","filter","forEach","map","some"].forEach(function(i){var t=Array.prototype[i];bn(typeof t=="function","Base function not defined on Array prototype: '"+i+"'"),us(yo.prototype,i,function(e,r){var o=this,s=this.$mobx;s.atom.reportObserved();var n=s.dehanceValues(s.values);return n[i](function(a,l){return e.call(r,a,l,o)},r)})});["reduce","reduceRight"].forEach(function(i){us(yo.prototype,i,function(){var t=this,e=this.$mobx;e.atom.reportObserved();var r=arguments[0];return arguments[0]=function(o,s,n){return s=e.dehanceValue(s),r(o,s,n,t)},e.values[i].apply(e.values,arguments)})});XP(yo.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var YB=yS(0);function yS(i){return{enumerable:!1,configurable:!1,get:function(){return this.get(i)},set:function(t){this.set(i,t)}}}function KB(i){Object.defineProperty(yo.prototype,""+i,yS(i))}function ay(i){for(var t=cy;t<i;t++)KB(t);cy=i}ay(1e3);var XB=_n("ObservableArrayAdministration",_S);function Aa(i){return j_(i)&&XB(i.$mobx)}var qB={},Ip=function(){function i(t,e,r){if(e===void 0&&(e=Md),r===void 0&&(r="ObservableMap@"+Qi()),this.enhancer=e,this.name=r,this.$mobx=qB,this._keysAtom=Cp(this.name+".keys()"),typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return i.prototype._has=function(t){return this._data.has(t)},i.prototype.has=function(t){var e=this;if(!tt.trackingDerivation)return this._has(t);var r=this._hasMap.get(t);if(!r){var o=r=new xn(this._has(t),kp,this.name+"."+zp(t)+"?",!1);this._hasMap.set(t,o),q1(o,function(){return e._hasMap.delete(t)})}return r.get()},i.prototype.set=function(t,e){var r=this._has(t);if(xo(this)){var o=vo(this,{type:r?"update":"add",object:this,newValue:e,name:t});if(!o)return this;e=o.newValue}return r?this._updateValue(t,e):this._addValue(t,e),this},i.prototype.delete=function(t){var e=this;if(Xl(this._keysAtom),xo(this)){var r=vo(this,{type:"delete",object:this,name:t});if(!r)return!1}if(this._has(t)){var o=oi(),s=Wr(this),r=s||o?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return o&&tr(de(de({},r),{name:this.name,key:t})),Co(function(){e._keysAtom.reportChanged(),e._updateHasMapEntry(t,!1);var a=e._data.get(t);a.setNewValue(void 0),e._data.delete(t)}),s&&Gr(this,r),o&&er(),!0}return!1},i.prototype._updateHasMapEntry=function(t,e){var r=this._hasMap.get(t);r&&r.setNewValue(e)},i.prototype._updateValue=function(t,e){var r=this._data.get(t);if(e=r.prepareNewValue(e),e!==tt.UNCHANGED){var o=oi(),s=Wr(this),n=s||o?{type:"update",object:this,oldValue:r.value,name:t,newValue:e}:null;o&&tr(de(de({},n),{name:this.name,key:t})),r.setNewValue(e),s&&Gr(this,n),o&&er()}},i.prototype._addValue=function(t,e){var r=this;Xl(this._keysAtom),Co(function(){var a=new xn(e,r.enhancer,r.name+"."+zp(t),!1);r._data.set(t,a),e=a.value,r._updateHasMapEntry(t,!0),r._keysAtom.reportChanged()});var o=oi(),s=Wr(this),n=s||o?{type:"add",object:this,name:t,newValue:e}:null;o&&tr(de(de({},n),{name:this.name,key:t})),s&&Gr(this,n),o&&er()},i.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},i.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},i.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},i.prototype.values=function(){var t=this,e=this.keys();return Bd({next:function(){var r=e.next(),o=r.done,s=r.value;return{done:o,value:o?void 0:t.get(s)}}})},i.prototype.entries=function(){var t=this,e=this.keys();return Bd({next:function(){var r=e.next(),o=r.done,s=r.value;return{done:o,value:o?void 0:[s,t.get(s)]}}})},i.prototype.forEach=function(t,e){var r=this;this._keysAtom.reportObserved(),this._data.forEach(function(o,s){return t.call(e,r.get(s),s,r)})},i.prototype.merge=function(t){var e=this;return _o(t)&&(t=t.toJS()),Co(function(){var r=zd(!0);try{jl(t)?Object.keys(t).forEach(function(o){return e.set(o,t[o])}):Array.isArray(t)?t.forEach(function(o){var s=Z_(o,2),n=s[0],a=s[1];return e.set(n,a)}):$l(t)?t.constructor!==Map?re("Cannot initialize from classes that inherit from Map: "+t.constructor.name):t.forEach(function(o,s){return e.set(s,o)}):t!=null&&re("Cannot initialize map from "+t)}finally{Ud(r)}}),this},i.prototype.clear=function(){var t=this;Co(function(){iy(function(){t._data.forEach(function(e,r){return t.delete(r)})})})},i.prototype.replace=function(t){var e=this;return Co(function(){var r=KP(t),o=new Map,s=!1;if(Y1(e._data.keys(),function(d){if(!r.has(d)){var u=e.delete(d);if(u)s=!0;else{var m=e._data.get(d);o.set(d,m)}}}),Y1(r.entries(),function(d){var u=Z_(d,2),m=u[0],p=u[1],f=e._data.has(m);if(e.set(m,p),e._data.has(m)){var v=e._data.get(m);o.set(m,v),f||(s=!0)}}),!s)if(e._data.size!==o.size)e._keysAtom.reportChanged();else for(var n=e._data.keys(),a=o.keys(),l=n.next(),c=a.next();!l.done;){if(l.value!==c.value){e._keysAtom.reportChanged();break}l=n.next(),c=a.next()}e._data=o}),this},Object.defineProperty(i.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),i.prototype.toPOJO=function(){var t=this,e={};return this.forEach(function(r,o){return e[typeof o=="symbol"?o:zp(o)]=t.get(o)}),e},i.prototype.toJS=function(){return new Map(this)},i.prototype.toJSON=function(){return this.toPOJO()},i.prototype.toString=function(){var t=this;return this.name+"[{ "+ms(this.keys()).map(function(e){return zp(e)+": "+(""+t.get(e))}).join(", ")+" }]"},i.prototype.observe=function(t,e){return Hd(this,t)},i.prototype.intercept=function(t){return Nd(this,t)},i}();function zp(i){return i&&i.toString?i.toString():new String(i).toString()}$_(Ip.prototype,function(){return this.entries()});Rd(Ip.prototype,Y_(),"Map");var _o=_n("ObservableMap",Ip),ZB={},Ep=function(){function i(t,e,r){if(e===void 0&&(e=Md),r===void 0&&(r="ObservableSet@"+Qi()),this.name=r,this.$mobx=ZB,this._data=new Set,this._atom=Cp(this.name),typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(o,s){return e(o,s,r)},t&&this.replace(t)}return i.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},i.prototype.clear=function(){var t=this;Co(function(){iy(function(){t._data.forEach(function(e){t.delete(e)})})})},i.prototype.forEach=function(t,e){var r=this;this._atom.reportObserved(),this._data.forEach(function(o){t.call(e,o,o,r)})},Object.defineProperty(i.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),i.prototype.add=function(t){var e=this;if(Xl(this._atom),xo(this)){var r=vo(this,{type:"add",object:this,newValue:t});if(!r)return this}if(!this.has(t)){Co(function(){e._data.add(e.enhancer(t,void 0)),e._atom.reportChanged()});var o=oi(),s=Wr(this),r=s||o?{type:"add",object:this,newValue:t}:null;o&&!1&&tr(r),s&&Gr(this,r),o&&!1&&er()}return this},i.prototype.delete=function(t){var e=this;if(xo(this)){var r=vo(this,{type:"delete",object:this,oldValue:t});if(!r)return!1}if(this.has(t)){var o=oi(),s=Wr(this),r=s||o?{type:"delete",object:this,oldValue:t}:null;return o&&!1&&tr(de(de({},r),{name:this.name})),Co(function(){e._atom.reportChanged(),e._data.delete(t)}),s&&Gr(this,r),o&&!1&&er(),!0}return!1},i.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},i.prototype.entries=function(){var t=0,e=ms(this.keys()),r=ms(this.values());return Bd({next:function(){var o=t;return t+=1,o<r.length?{value:[e[o],r[o]],done:!1}:{done:!0}}})},i.prototype.keys=function(){return this.values()},i.prototype.values=function(){this._atom.reportObserved();var t=this,e=0,r;return this._data.values!==void 0?r=ms(this._data.values()):(r=[],this._data.forEach(function(o){return r.push(o)})),Bd({next:function(){return e<r.length?{value:t.dehanceValue(r[e++]),done:!1}:{done:!0}}})},i.prototype.replace=function(t){var e=this;return yn(t)&&(t=t.toJS()),Co(function(){var r=zd(!0);try{Array.isArray(t)?(e.clear(),t.forEach(function(o){return e.add(o)})):Pd(t)?(e.clear(),t.forEach(function(o){return e.add(o)})):t!=null&&re("Cannot initialize set from "+t)}finally{Ud(r)}}),this},i.prototype.observe=function(t,e){return Hd(this,t)},i.prototype.intercept=function(t){return Nd(this,t)},i.prototype.toJS=function(){return new Set(this)},i.prototype.toString=function(){return this.name+"[ "+ms(this.keys()).join(", ")+" ]"},i}();$_(Ep.prototype,function(){return this.values()});Rd(Ep.prototype,Y_(),"Set");var yn=_n("ObservableSet",Ep),xS=function(){function i(t,e,r){this.target=t,this.name=e,this.defaultEnhancer=r,this.values={}}return i.prototype.read=function(t,e){if(!(this.target!==t&&(this.illegalAccess(t,e),!this.values[e])))return this.values[e].get()},i.prototype.write=function(t,e,r){var o=this.target;o!==t&&this.illegalAccess(t,e);var s=this.values[e];if(s instanceof vn){s.set(r);return}if(xo(this)){var n=vo(this,{type:"update",object:o,name:e,newValue:r});if(!n)return;r=n.newValue}if(r=s.prepareNewValue(r),r!==tt.UNCHANGED){var a=Wr(this),l=oi(),n=a||l?{type:"update",object:o,oldValue:s.value,name:e,newValue:r}:null;l&&tr(de(de({},n),{name:this.name,key:e})),s.setNewValue(r),a&&Gr(this,n),l&&er()}},i.prototype.remove=function(t){if(!!this.values[t]){var e=this.target;if(xo(this)){var r=vo(this,{object:e,name:t,type:"remove"});if(!r)return}try{ps();var o=Wr(this),s=oi(),n=this.values[t].get();this.keys&&this.keys.remove(t),delete this.values[t],delete this.target[t];var r=o||s?{type:"remove",object:e,oldValue:n,name:t}:null;s&&tr(de(de({},r),{name:this.name,key:t})),o&&Gr(this,r),s&&er()}finally{hs()}}},i.prototype.illegalAccess=function(t,e){console.warn("Property '"+e+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},i.prototype.observe=function(t,e){return Hd(this,t)},i.prototype.intercept=function(t){return Nd(this,t)},i.prototype.getKeys=function(){var t=this;return this.keys===void 0&&(this.keys=new yo(Object.keys(this.values).filter(function(e){return t.values[e]instanceof xn}),kp,"keys("+this.name+")",!0)),this.keys.slice()},i}();function ly(i,t,e){t===void 0&&(t=""),e===void 0&&(e=Md);var r=i.$mobx;return r||(jl(i)||(t=(i.constructor.name||"ObservableObject")+"@"+Qi()),t||(t="ObservableObject@"+Qi()),r=new xS(i,t,e),Rd(i,"$mobx",r),r)}function dB(i,t,e,r){var o=ly(i);if(qP(i,t),xo(o)){var s=vo(o,{object:i,name:t,type:"add",newValue:e});if(!s)return;e=s.newValue}var n=o.values[t]=new xn(e,r,o.name+"."+t,!1);e=n.value,Object.defineProperty(i,t,JB(t)),o.keys&&o.keys.push(t),QB(o,i,t,e)}function gB(i,t,e){var r=ly(i);e.name=r.name+"."+t,e.context=i,r.values[t]=new vn(e),Object.defineProperty(i,t,tM(t))}var vS=Object.create(null),CS=Object.create(null);function JB(i){return vS[i]||(vS[i]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,i)},set:function(t){this.$mobx.write(this,i,t)}})}function SS(i){var t=i.$mobx;return t||(Ea(i),i.$mobx)}function tM(i){return CS[i]||(CS[i]={configurable:tt.computedConfigurable,enumerable:!1,get:function(){return SS(this).read(this,i)},set:function(t){SS(this).write(this,i,t)}})}function QB(i,t,e,r){var o=Wr(i),s=oi(),n=o||s?{type:"add",object:t,name:e,newValue:r}:null;s&&tr(de(de({},n),{name:i.name,key:e})),o&&Gr(i,n),s&&er()}var eM=_n("ObservableObjectAdministration",xS);function Fa(i){return j_(i)?(Ea(i),eM(i.$mobx)):!1}function wn(i,t){if(typeof i=="object"&&i!==null){if(Aa(i))return t!==void 0&&re(!1),i.$mobx.atom;if(yn(i))return i.$mobx;if(_o(i)){var e=i;if(t===void 0)return e._keysAtom;var r=e._data.get(t)||e._hasMap.get(t);return r||re(!1),r}if(Ea(i),t&&!i.$mobx&&i[t],Fa(i)){if(!t)return re(!1);var r=i.$mobx.values[t];return r||re(!1),r}if(K_(i)||Op(i)||Mp(i))return i}else if(typeof i=="function"&&Mp(i.$mobx))return i.$mobx;return re(!1)}function wS(i,t){if(i||re("Expecting some object"),t!==void 0)return wS(wn(i,t));if(K_(i)||Op(i)||Mp(i)||_o(i)||yn(i))return i;if(Ea(i),i.$mobx)return i.$mobx;re(!1)}function iM(i,t){var e;return t!==void 0?e=wn(i,t):Fa(i)||_o(i)||yn(i)?e=wS(i):e=wn(i),e.name}var kS=Object.prototype.toString;function X_(i,t,e){return e===void 0&&(e=-1),uy(i,t,e)}function uy(i,t,e,r,o){if(i===t)return i!==0||1/i==1/t;if(i==null||t==null)return!1;if(i!==i)return t!==t;var s=typeof i;if(s!=="function"&&s!=="object"&&typeof t!="object")return!1;i=TS(i),t=TS(t);var n=kS.call(i);if(n!==kS.call(t))return!1;switch(n){case"[object RegExp]":case"[object String]":return""+i==""+t;case"[object Number]":return+i!=+i?+t!=+t:+i==0?1/+i==1/t:+i==+t;case"[object Date]":case"[object Boolean]":return+i==+t;case"[object Symbol]":return typeof Symbol!="undefined"&&Symbol.valueOf.call(i)===Symbol.valueOf.call(t)}var a=n==="[object Array]";if(!a){if(typeof i!="object"||typeof t!="object")return!1;var l=i.constructor,c=t.constructor;if(l!==c&&!(typeof l=="function"&&l instanceof l&&typeof c=="function"&&c instanceof c)&&"constructor"in i&&"constructor"in t)return!1}if(e===0)return!1;e<0&&(e=-1),r=r||[],o=o||[];for(var d=r.length;d--;)if(r[d]===i)return o[d]===t;if(r.push(i),o.push(t),a){if(d=i.length,d!==t.length)return!1;for(;d--;)if(!uy(i[d],t[d],e-1,r,o))return!1}else{var u=Object.keys(i),m=void 0;if(d=u.length,Object.keys(t).length!==d)return!1;for(;d--;)if(m=u[d],!(rM(t,m)&&uy(i[m],t[m],e-1,r,o)))return!1}return r.pop(),o.pop(),!0}function TS(i){return Aa(i)?i.peek():$l(i)||_o(i)||Pd(i)||yn(i)?ms(i.entries()):i}function rM(i,t){return Object.prototype.hasOwnProperty.call(i,t)}try{}catch(i){my=Vl(),typeof process=="undefined"&&(my.process={}),my.process.env={}}var my;(function(){function i(){}if(i.name!=="testCodeMinification"&&!1&&typeof process!="undefined"&&process.env.IGNORE_MOBX_MINIFY_WARNING!=="true"){var t=["process","env","NODE_ENV"].join(".");console.warn("[mobx] you are running a minified build, but '"+t+"' was not set to 'production' in your bundler. This results in an unnecessarily large and slow bundle")}})();var py="$mobx";typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:sy,extras:{getDebugName:iM},$mobx:py});var rp=y(require("react"));var Ae=y(require("react"));var DS=y(require("react"));if(!DS.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!sy)throw new Error("mobx-react-lite requires mobx at least version 4 to be available");var hy=y(require("react-dom"));var Wd=y(require("react")),oM=function(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r=e.call(i),o,s=[],n;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(a){n={error:a}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(n)throw n.error}}return s};function fy(){var i=oM(Wd.useState(0),2),t=i[1],e=Wd.useCallback(function(){t(function(r){return r+1})},[]);return e}function IS(i){return typeof Symbol=="function"?Symbol.for(i):"__$mobx-react "+i+"__"}var sM={};function ES(){return typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:sM}var nM=IS("observerBatching");function aM(i){i()}function Up(i){i||(i=aM),Lp({reactionScheduler:i}),ES()[nM]=!0}var lM=!1;function So(){return lM}var Vd=y(require("react"));var Wp=y(require("react"));function AS(i){return ry(i)}function FS(i){var t={cleanAt:Date.now()+cM,reaction:i};return t}var cM=1e4,dM=1e4,Gd=new Set,gy;function OS(){gy===void 0&&(gy=setTimeout(uM,dM))}function RS(i){Gd.add(i),OS()}function PS(i){Gd.delete(i)}function uM(){gy=void 0;var i=Date.now();Gd.forEach(function(t){var e=t.current;e&&i>=e.cleanAt&&(e.reaction.dispose(),t.current=null,Gd.delete(t))}),Gd.size>0&&OS()}var BS=y(require("react")),Np=!1,Hp=[];function by(i){return function(){Np?Hp.push(i):i()}}function _y(i){Np=!0,Hp=[];try{var t=i();Np=!1;var e=Hp.length>0?Hp:void 0;return BS.default.useLayoutEffect(function(){e&&e.forEach(function(r){return r()})},[e]),t}finally{Np=!1}}var mM={};function MS(i){return"observer"+i}function Zl(i,t,e){if(t===void 0&&(t="observed"),e===void 0&&(e=mM),So())return i();var r=e.useForceUpdate||fy,o=r(),s=by(o),n=Wp.default.useRef(null);if(!n.current){var a=new Sn(MS(t),function(){l.mounted?s():(a.dispose(),n.current=null)}),l=FS(a);n.current=l,RS(n)}var c=n.current.reaction;return Wp.default.useDebugValue(c,AS),Wp.default.useEffect(function(){return PS(n),n.current?n.current.mounted=!0:(n.current={reaction:new Sn(MS(t),function(){s()}),cleanAt:Infinity},s()),function(){n.current.reaction.dispose(),n.current=null}},[]),_y(function(){var d,u;if(c.track(function(){try{d=i()}catch(m){u=m}}),u)throw u;return d})}var yy=function(){return yy=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o])}return i},yy.apply(this,arguments)};function xy(i,t){if(So())return i;var e=yy({forwardRef:!1},t),r=i.displayName||i.name,o=function(n,a){return Zl(function(){return i(n,a)},r)};o.displayName=r;var s;return e.forwardRef?s=Vd.memo(Vd.forwardRef(o)):s=Vd.memo(o),pM(i,s),s.displayName=r,s}var hM={$$typeof:!0,render:!0,compare:!0,type:!0};function pM(i,t){Object.keys(i).forEach(function(e){hM[e]||Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}function Jl(i){var t=i.children,e=i.render,r=t||e;return typeof r!="function"?null:Zl(r)}Jl.propTypes={children:LS,render:LS};Jl.displayName="Observer";function LS(i,t,e,r,o){var s=t==="children"?"render":"children",n=typeof i[t]=="function",a=typeof i[s]=="function";return n&&a?new Error("MobX Observer: Do not use children and render in the same time in`"+e):n||a?null:new Error("Invalid prop `"+o+"` of type `"+typeof i[t]+"` supplied to `"+e+"`, expected `function`.")}var fM=y(require("react"));var gM=y(require("react"));Up(hy.unstable_batchedUpdates);var zS=0;function xM(i){if(typeof Symbol=="function")return Symbol(i);var t="__$mobx-react "+i+" ("+zS+")";return zS++,t}var vy={};function Tn(i){return vy[i]||(vy[i]=xM(i)),vy[i]}function NS(i,t){if(US(i,t))return!0;if(typeof i!="object"||i===null||typeof t!="object"||t===null)return!1;var e=Object.keys(i),r=Object.keys(t);if(e.length!==r.length)return!1;for(var o=0;o<e.length;o++)if(!Object.hasOwnProperty.call(t,e[o])||!US(i[e[o]],t[e[o]]))return!1;return!0}function US(i,t){return i===t?i!==0||1/i==1/t:i!==i&&t!==t}var vM={$$typeof:1,render:1,compare:1,type:1,childContextTypes:1,contextType:1,contextTypes:1,defaultProps:1,getDefaultProps:1,getDerivedStateFromError:1,getDerivedStateFromProps:1,mixins:1,propTypes:1};function CM(i,t){var e=Object.getOwnPropertyNames(Object.getPrototypeOf(i));Object.getOwnPropertyNames(i).forEach(function(r){!vM[r]&&e.indexOf(r)===-1&&Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(i,r))})}function bs(i,t,e){Object.hasOwnProperty.call(i,t)?i[t]=e:Object.defineProperty(i,t,{enumerable:!1,configurable:!0,writable:!0,value:e})}var HS=Tn("patchMixins"),WS=Tn("patchedDefinition");function SM(i,t){var e=i[HS]=i[HS]||{},r=e[t]=e[t]||{};return r.locks=r.locks||0,r.methods=r.methods||[],r}function GS(i,t){for(var e=this,r=arguments.length,o=new Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];t.locks++;try{var n;return i!=null&&(n=i.apply(this,o)),n}finally{t.locks--,t.locks===0&&t.methods.forEach(function(a){a.apply(e,o)})}}function VS(i,t){var e=function(){for(var o=arguments.length,s=new Array(o),n=0;n<o;n++)s[n]=arguments[n];GS.call.apply(GS,[this,i,t].concat(s))};return e}function wM(i,t,e){var r=SM(i,t);r.methods.indexOf(e)<0&&r.methods.push(e);var o=Object.getOwnPropertyDescriptor(i,t);if(!(o&&o[WS])){var s=i[t],n=jS(i,t,o?o.enumerable:void 0,r,s);Object.defineProperty(i,t,n)}}function jS(i,t,e,r,o){var s,n=VS(o,r);return s={},s[WS]=!0,s.get=function(){return n},s.set=function(l){if(this===i)n=VS(l,r);else{var c=jS(this,t,e,r,l);Object.defineProperty(this,t,c)}},s.configurable=!0,s.enumerable=e,s}var Cy=py||"$mobx",$S=Tn("isMobXReactObserver"),YS=Tn("isUnmounted"),Gp=Tn("skipRender"),Vp=Tn("isForcingUpdate");function TM(i){var t=i.prototype;if(i[$S]){var e=Sy(t);console.warn("The provided component class ("+e+`) 
                has already been declared as an observer component.`)}else i[$S]=!0;if(t.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if(i.__proto__!==Ae.PureComponent){if(!t.shouldComponentUpdate)t.shouldComponentUpdate=KS;else if(t.shouldComponentUpdate!==KS)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}XS(t,"props"),XS(t,"state");var r=t.render;return t.render=function(){return kM.call(this,r)},wM(t,"componentWillUnmount",function(){var o;if(So()!==!0&&((o=this.render[Cy])===null||o===void 0||o.dispose(),this[YS]=!0,!this.render[Cy])){var s=Sy(this);console.warn("The reactive render of an observer class component ("+s+`) 
                was overriden after MobX attached. This may result in a memory leak if the 
                overriden reactive render was not properly disposed.`)}}),i}function Sy(i){return i.displayName||i.name||i.constructor&&(i.constructor.displayName||i.constructor.name)||"<component>"}function kM(i){var t=this;if(So()===!0)return i.call(this);bs(this,Gp,!1),bs(this,Vp,!1);var e=Sy(this),r=i.bind(this),o=!1,s=new Sn(e+".render()",function(){if(!o&&(o=!0,t[YS]!==!0)){var a=!0;try{bs(t,Vp,!0),t[Gp]||Ae.Component.prototype.forceUpdate.call(t),a=!1}finally{bs(t,Vp,!1),a&&s.dispose()}}});s.reactComponent=this,n[Cy]=s,this.render=n;function n(){o=!1;var a=void 0,l=void 0;if(s.track(function(){try{l=lS(!1,r)}catch(c){a=c}}),a)throw a;return l}return n.call(this)}function KS(i,t){return So()&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==t?!0:!NS(this.props,i)}function XS(i,t){var e=Tn("reactProp_"+t+"_valueHolder"),r=Tn("reactProp_"+t+"_atomHolder");function o(){return this[r]||bs(this,r,Cp("reactive "+t)),this[r]}Object.defineProperty(i,t,{configurable:!0,enumerable:!0,get:function(){var n=!1;return Oa&&gs&&(n=Oa(!0)),o.call(this).reportObserved(),Oa&&gs&&gs(n),this[e]},set:function(n){!this[Vp]&&!NS(this[e],n)?(bs(this,e,n),bs(this,Gp,!0),o.call(this).reportChanged(),bs(this,Gp,!1)):bs(this,e,n)}})}var qS=typeof Symbol=="function"&&Symbol.for,ZS=qS?Symbol.for("react.forward_ref"):typeof Ae.forwardRef=="function"&&Ae.forwardRef(function(i){return null}).$$typeof,JS=qS?Symbol.for("react.memo"):typeof Ae.memo=="function"&&Ae.memo(function(i){return null}).$$typeof;function O(i){if(i.isMobxInjector===!0&&console.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),JS&&i.$$typeof===JS)throw new Error("Mobx observer: You are trying to use 'observer' on a function component wrapped in either another observer or 'React.memo'. The observer already applies 'React.memo' for you.");if(ZS&&i.$$typeof===ZS){var t=i.render;if(typeof t!="function")throw new Error("render property of ForwardRef was not a function");return Ae.forwardRef(function(){var r=arguments;return Ae.createElement(Jl,null,function(){return t.apply(void 0,r)})})}return typeof i=="function"&&(!i.prototype||!i.prototype.render)&&!i.isReactClass&&!Object.prototype.isPrototypeOf.call(Ae.Component,i)?xy(i):TM(i)}function jp(){return jp=Object.assign||function(i){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r])}return i},jp.apply(this,arguments)}function DM(i,t){if(i==null)return{};var e={},r=Object.keys(i),o,s;for(s=0;s<r.length;s++)o=r[s],!(t.indexOf(o)>=0)&&(e[o]=i[o]);return e}var jd=Ae.default.createContext({});function $d(i){var t=i.children,e=DM(i,["children"]),r=Ae.default.useContext(jd),o=Ae.default.useRef(jp({},r,e)),s=o.current;if(!1)var n;return Ae.default.createElement(jd.Provider,{value:s},t)}$d.displayName="MobXProvider";function QS(i,t,e,r){var o=Ae.default.forwardRef(function(s,n){var a=jp({},s),l=Ae.default.useContext(jd);return Object.assign(a,i(l||{},a)||{}),n&&(a.ref=n),Ae.default.createElement(t,a)});return r&&(o=O(o)),o.isMobxInjector=!0,CM(t,o),o.wrappedComponent=t,o.displayName=IM(t,e),o}function IM(i,t){var e,r=i.displayName||i.name||i.constructor&&i.constructor.name||"Component";return t?e="inject-with-"+t+"("+r+")":e="inject("+r+")",e}function EM(i){return function(t,e){return i.forEach(function(r){if(!(r in e)){if(!(r in t))throw new Error("MobX injector: Store '"+r+"' is not available! Make sure it is provided by some Provider");e[r]=t[r]}}),e}}function P(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];if(typeof arguments[0]=="function"){var r=arguments[0];return function(o){return QS(r,o,r.name,!0)}}else return function(o){return QS(EM(t),o,t.join("-"),!1)}}if(!Ae.Component)throw new Error("mobx-react requires React to be available");if(!Y)throw new Error("mobx-react requires mobx to be available");var t5=y(require("styled-components"));var r2=y(require("styled-components"));var tw=y(require("styled-components")),$p=tw.keyframes`
from {
  opacity: 1;
  transform: scale(0);
}
to {
  opacity: 0;
  transform: scale(10);
}
`;var ew=y(require("styled-components")),iw=ew.keyframes`
  0% {
    opacity: 0;
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
`;var rw=y(require("styled-components")),Yp=rw.keyframes`
  0% {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
`;var An=y(require("react"));var wr=[];var ow=function(){return wr.some(function(i){return i.activeTargets.length>0})};var sw=function(){return wr.some(function(i){return i.skippedTargets.length>0})};var nw="ResizeObserver loop completed with undelivered notifications.",aw=function(){var i;typeof ErrorEvent=="function"?i=new ErrorEvent("error",{message:nw}):(i=document.createEvent("Event"),i.initEvent("error",!1,!1),i.message=nw),window.dispatchEvent(i)};var Ba;(function(i){i.BORDER_BOX="border-box",i.CONTENT_BOX="content-box",i.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Ba||(Ba={}));var wy=function(){function i(t,e,r,o){return this.x=t,this.y=e,this.width=r,this.height=o,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return i.prototype.toJSON=function(){var t=this,e=t.x,r=t.y,o=t.top,s=t.right,n=t.bottom,a=t.left,l=t.width,c=t.height;return{x:e,y:r,top:o,right:s,bottom:n,left:a,width:l,height:c}},i.fromRect=function(t){return new i(t.x,t.y,t.width,t.height)},i}();var Yd=function(i){return i instanceof SVGElement&&"getBBox"in i},Kp=function(i){if(Yd(i)){var t=i.getBBox(),e=t.width,r=t.height;return!e&&!r}var o=i,s=o.offsetWidth,n=o.offsetHeight;return!(s||n||i.getClientRects().length)},ky=function(i){var t,e,r=(e=(t=i)===null||t===void 0?void 0:t.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(r&&i instanceof r.Element)},lw=function(i){switch(i.tagName){case"INPUT":if(i.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1};var Ma=typeof window!="undefined"?window:{};var Xp=new WeakMap,cw=/auto|scroll/,AM=/^tb|vertical/,FM=/msie|trident/i.test(Ma.navigator&&Ma.navigator.userAgent),wo=function(i){return parseFloat(i||"0")},Ql=function(i,t,e){return i===void 0&&(i=0),t===void 0&&(t=0),e===void 0&&(e=!1),Object.freeze({inlineSize:(e?t:i)||0,blockSize:(e?i:t)||0})},dw=Object.freeze({devicePixelContentBoxSize:Ql(),borderBoxSize:Ql(),contentBoxSize:Ql(),contentRect:new wy(0,0,0,0)}),Ty=function(i,t){if(t===void 0&&(t=!1),Xp.has(i)&&!t)return Xp.get(i);if(Kp(i))return Xp.set(i,dw),dw;var e=getComputedStyle(i),r=Yd(i)&&i.ownerSVGElement&&i.getBBox(),o=!FM&&e.boxSizing==="border-box",s=AM.test(e.writingMode||""),n=!r&&cw.test(e.overflowY||""),a=!r&&cw.test(e.overflowX||""),l=r?0:wo(e.paddingTop),c=r?0:wo(e.paddingRight),d=r?0:wo(e.paddingBottom),u=r?0:wo(e.paddingLeft),m=r?0:wo(e.borderTopWidth),p=r?0:wo(e.borderRightWidth),f=r?0:wo(e.borderBottomWidth),v=r?0:wo(e.borderLeftWidth),x=u+c,_=l+d,D=v+p,k=m+f,A=a?i.offsetHeight-k-i.clientHeight:0,B=n?i.offsetWidth-D-i.clientWidth:0,T=o?x+D:0,F=o?_+k:0,q=r?r.width:wo(e.width)-T-B,Z=r?r.height:wo(e.height)-F-A,pt=q+x+B+D,xt=Z+_+A+k,ht=Object.freeze({devicePixelContentBoxSize:Ql(Math.round(q*devicePixelRatio),Math.round(Z*devicePixelRatio),s),borderBoxSize:Ql(pt,xt,s),contentBoxSize:Ql(q,Z,s),contentRect:new wy(u,l,q,Z)});return Xp.set(i,ht),ht},qp=function(i,t,e){var r=Ty(i,e),o=r.borderBoxSize,s=r.contentBoxSize,n=r.devicePixelContentBoxSize;switch(t){case Ba.DEVICE_PIXEL_CONTENT_BOX:return n;case Ba.BORDER_BOX:return o;default:return s}};var Dy=function(){function i(t){var e=Ty(t);this.target=t,this.contentRect=e.contentRect,this.borderBoxSize=[e.borderBoxSize],this.contentBoxSize=[e.contentBoxSize],this.devicePixelContentBoxSize=[e.devicePixelContentBoxSize]}return i}();var Zp=function(i){if(Kp(i))return Infinity;for(var t=0,e=i.parentNode;e;)t+=1,e=e.parentNode;return t};var uw=function(){var i=Infinity,t=[];wr.forEach(function(n){if(n.activeTargets.length!==0){var a=[];n.activeTargets.forEach(function(c){var d=new Dy(c.target),u=Zp(c.target);a.push(d),c.lastReportedSize=qp(c.target,c.observedBox),u<i&&(i=u)}),t.push(function(){n.callback.call(n.observer,a,n.observer)}),n.activeTargets.splice(0,n.activeTargets.length)}});for(var e=0,r=t;e<r.length;e++){var o=r[e];o()}return i};var Iy=function(i){wr.forEach(function(e){e.activeTargets.splice(0,e.activeTargets.length),e.skippedTargets.splice(0,e.skippedTargets.length),e.observationTargets.forEach(function(o){o.isActive()&&(Zp(o.target)>i?e.activeTargets.push(o):e.skippedTargets.push(o))})})};var mw=function(){var i=0;for(Iy(i);ow();)i=uw(),Iy(i);return sw()&&aw(),i>0};var Ey,pw=[],OM=function(){return pw.splice(0).forEach(function(i){return i()})},hw=function(i){if(!Ey){var t=0,e=document.createTextNode(""),r={characterData:!0};new MutationObserver(function(){return OM()}).observe(e,r),Ey=function(){e.textContent=""+(t?t--:t++)}}pw.push(i),Ey()};var fw=function(i){hw(function(){requestAnimationFrame(i)})};var Jp=0,RM=function(){return!!Jp},PM=250,BM={attributes:!0,characterData:!0,childList:!0,subtree:!0},gw=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],bw=function(i){return i===void 0&&(i=0),Date.now()+i},Ay=!1,MM=function(){function i(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return i.prototype.run=function(t){var e=this;if(t===void 0&&(t=PM),!Ay){Ay=!0;var r=bw(t);fw(function(){var o=!1;try{o=mw()}finally{if(Ay=!1,t=r-bw(),!RM())return;o?e.run(1e3):t>0?e.run(t):e.start()}})}},i.prototype.schedule=function(){this.stop(),this.run()},i.prototype.observe=function(){var t=this,e=function(){return t.observer&&t.observer.observe(document.body,BM)};document.body?e():Ma.addEventListener("DOMContentLoaded",e)},i.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),gw.forEach(function(e){return Ma.addEventListener(e,t.listener,!0)}))},i.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),gw.forEach(function(e){return Ma.removeEventListener(e,t.listener,!0)}),this.stopped=!0)},i}(),Qp=new MM,Fy=function(i){!Jp&&i>0&&Qp.start(),Jp+=i,!Jp&&Qp.stop()};var LM=function(i){return!Yd(i)&&!lw(i)&&getComputedStyle(i).display==="inline"},_w=function(){function i(t,e){this.target=t,this.observedBox=e||Ba.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return i.prototype.isActive=function(){var t=qp(this.target,this.observedBox,!0);return LM(this.target)&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},i}();var yw=function(){function i(t,e){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=e}return i}();var th=new WeakMap,xw=function(i,t){for(var e=0;e<i.length;e+=1)if(i[e].target===t)return e;return-1},Kd=function(){function i(){}return i.connect=function(t,e){var r=new yw(t,e);th.set(t,r)},i.observe=function(t,e,r){var o=th.get(t),s=o.observationTargets.length===0;xw(o.observationTargets,e)<0&&(s&&wr.push(o),o.observationTargets.push(new _w(e,r&&r.box)),Fy(1),Qp.schedule())},i.unobserve=function(t,e){var r=th.get(t),o=xw(r.observationTargets,e),s=r.observationTargets.length===1;o>=0&&(s&&wr.splice(wr.indexOf(r),1),r.observationTargets.splice(o,1),Fy(-1))},i.disconnect=function(t){var e=this,r=th.get(t);r.observationTargets.slice().forEach(function(o){return e.unobserve(t,o.target)}),r.activeTargets.splice(0,r.activeTargets.length)},i}();var Xd=function(){function i(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Kd.connect(this,t)}return i.prototype.observe=function(t,e){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!ky(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Kd.observe(this,t,e)},i.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!ky(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Kd.unobserve(this,t)},i.prototype.disconnect=function(){Kd.disconnect(this)},i.toString=function(){return"function ResizeObserver () { [polyfill code] }"},i}();var Vw=y(Py()),jw=y(require("styled-components"));var ww=y(require("react")),eh=ww.default.createContext({});var qd=()=>window&&window.navigator&&window.navigator.userAgent||"",kr=(i=qd())=>i.indexOf("Edge")!==-1,Se=(i=qd())=>!!i.match(/msie|trident/i),kw=(i=qd())=>!!i.match(/windows/i),Tw=(i=qd())=>i.indexOf("Safari")!==-1&&i.indexOf("Chrome")===-1,Dw=(i=qd())=>!!i.match(/iP(hone|od|ad)|AppleWebKit/),Iw=()=>{let i=document.createElement("canvas"),t=i.getContext("webgl")||i.getContext("experimental-webgl");return t&&t instanceof WebGLRenderingContext};var e4=new RegExp(/\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83D\uDC68\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83D\uDC68\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83D\uDC68\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83D\uDC68\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC69(?:\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFC-\uDFFF]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68\u200D(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D(?:\uD83D[\uDC68\uDC69])|\uD83E\uDDD1\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC68(?:\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|(?:\uD83D[\uDC67-\uDC69])\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]\uFE0F)|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83C\uDFF3\uFE0F\u200D\u26A7|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF]))\u200D[\u2695\u2696\u2708]\uFE0F|\uD83D\uDC69\u200D(?:\uD83D[\uDC67\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D\uDC3B\u200D\u2744|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDF])\u200D[\u2640\u2642])\uFE0F|\uD83E\uDDD1\u200D[\u2695\u2696\u2708]\uFE0F|(?:\uD83D[\uDC68\uDC69])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D[\u2695\u2696\u2708]\uFE0F)|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC08\u200D\u2B1B|\uD83E\uDDD1\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDC66\uDC67\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC3\uDFC7]|\uD83D[\uDC43\uDC4A-\uDC4C\uDC4F\uDC50\uDC66-\uDC69\uDC6B-\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270C\u270D]|\uD83C[\uDFC2\uDFC4\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC46-\uDC49\uDC4D\uDC4E\uDD74\uDD75\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9\u23EA\u23ED-\u23EF\u23F1-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7\u26F8\u26FA\u26FD\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2753\u2757\u2763\u2764\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF0D-\uDF0F\uDF15\uDF1C\uDF21\uDF24-\uDF2C\uDF36\uDF78\uDF7D\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFA7\uDFAC-\uDFAE\uDFC6\uDFCD\uDFCE\uDFD4-\uDFE0\uDFED\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC08\uDC15\uDC1F\uDC26\uDC3F\uDC41\uDC53\uDC6A\uDC7D\uDCA3\uDCB0\uDCB3\uDCBB\uDCBF\uDCCB\uDCDA\uDCDF\uDCE4-\uDCE6\uDCEA-\uDCED\uDCF7\uDCF9-\uDCFB\uDCFD\uDD08\uDD0D\uDD12\uDD13\uDD49\uDD4A\uDD50-\uDD67\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDE10\uDE87\uDE8D\uDE91\uDE94\uDE98\uDEAD\uDEB2\uDEB9\uDEBA\uDEBC\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|[\u23E9-\u23F3\u23F8-\u23FA\u25FB-\u25FE\u2614\u2615\u267F\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]/g),Ew=i=>i.replace(e4,"");var Dn=i=>{try{return new URL(i),!0}catch(t){return!1}};var Aw=i=>i instanceof HTMLImageElement;function Fw(i){return!Object.prototype.hasOwnProperty.call(i,"name")}function Ow(i){return!Object.prototype.hasOwnProperty.call(i,"name")}var ct;(function(i){i.UNDO="undo",i.REDO="redo",i.DELETE="delete",i.BRING_TO_FRONT="bringtofront",i.EDIT="edit",i.DUPLICATE="duplicate",i.ADD="add",i.FLIP="flip",i.INVERT="invert",i.CLOSE="close",i.EXPORT="export"})(ct||(ct={}));var C;(function(i){i.LIBRARY="library",i.ART_FILTER="artFilter",i.TRANSFORM="transform",i.FILTER="filter",i.ADJUSTMENT="adjustment",i.FOCUS="focus",i.STICKER="sticker",i.TEXT="text",i.TEXT_DESIGN="textdesign",i.OVERLAY="overlay",i.FRAME="frame",i.BRUSH="brush",i.CUSTOM="customTool"})(C||(C={}));var we;(function(i){i.TEXT="text",i.CARD="card"})(we||(we={}));var ft;(function(i){i.LARGE="large",i.MEDIUM="medium",i.SMALL="small"})(ft||(ft={}));var Vt;(function(i){i.ERROR="error",i.WARNING="warning",i.INFO="info",i.TEXT_EDIT="textEdit"})(Vt||(Vt={}));var Rw=class{constructor(){this.enabled=!0;this.threshold=20;this.snapToHorizontalCenter=!0;this.snapToVerticalCenter=!0;this.snapToLeft=.1;this.snapToRight=.1;this.snapToTop=.1;this.snapToBottom=.1}},Pw=class{constructor(){this.enabled=!0;this.threshold=20;this.angles=[0,45,90,135,180,225,270,315]}},Zd=class{constructor(){this.position=new Rw;this.rotation=new Pw}};var ih;(function(i){i.OBJECT="object"})(ih||(ih={}));var By=class{};var qe;(function(i){i.IMAGE="image",i.DATA_URL="data-url",i.BLOB="blob",i.MSBLOB="ms-blob"})(qe||(qe={}));var Le;(function(i){i.PNG="image/png",i.JPEG="image/jpeg"})(Le||(Le={}));var ir;(function(i){i.BMP="image/bmp",i.GIF="image/gif",i.ICO="image/x-icon",i.JPEG="image/jpeg",i.PNG="image/png",i.SVG="image/svg+xml",i.TIFF="image/tiff",i.WEBP="image/webp"})(ir||(ir={}));var My=class{constructor(){this.order="default";this.language="en";this.theme="dark";this.assetBaseUrl="assets/";this.displayResizeWarning=!1;this.displayCloseWarning=!0;this.displayCanvasRendererWarning=!0;this.displayToolControlBarTitle=!0;this.forceCrop=!1;this.enableZoom=!0;this.defaultTool=C.FILTER}};C.FILTER,C.FOCUS,C.ADJUSTMENT,C.LIBRARY,C.OVERLAY,C.STICKER,C.TEXT,C.TEXT_DESIGN,C.FRAME,C.BRUSH,C.TRANSFORM,C.CUSTOM;var Et;(function(i){i.BRIGHTNESS="brightness",i.CONTRAST="contrast",i.SATURATION="saturation",i.CLARITY="clarity",i.SHADOWS="shadows",i.HIGHLIGHTS="highlights",i.EXPOSURE="exposure",i.GAMMA="gamma",i.BLACKS="blacks",i.WHITES="whites",i.TEMPERATURE="temperature",i.SHARPNESS="sharpness"})(Et||(Et={}));var rh=Object.values(Et).reduce((i,t)=>(i[t]=!0,i),{});var Jd=class{constructor(){this.categories=[];this.flattenCategories=!1}};var Ly=class{};var Qd=class{constructor(){this.categories=[];this.flattenCategories=!1;this.categoryHeaderType=we.CARD;this.enablePreviewThumbnails=!1}};function La(i){return i.lightColor!==void 0}function oh(i){return i.lutURI!==void 0}var I;(function(i){i.Desert="imgly_duotone_desert",i.Peach="imgly_duotone_peach",i.Clash="imgly_duotone_clash",i.Plum="imgly_duotone_plum",i.Breezy="imgly_duotone_breezy",i.DeepBlue="imgly_duotone_deepblue",i.Frog="imgly_duotone_frog",i.Sunset="imgly_duotone_sunset",i.AD1920="imgly_lut_ad1920",i.Greyed="imgly_lut_bw",i.Dusty="imgly_lut_x400",i.Litho="imgly_lut_litho",i.Sepia="imgly_lut_sepiahigh",i.Weathered="imgly_lut_plate",i.HardStuff="imgly_lut_sin",i.Polaroid="imgly_lut_blues",i.Sunny70s="imgly_lut_front",i.Oldtimer="imgly_lut_texas",i.Inferno="imgly_lut_celsius",i.Snappy="imgly_lut_cool",i.Chestnut="imgly_lut_chest",i.Softy="imgly_lut_winter",i.Pebble="imgly_lut_kdynamic",i.Moss="imgly_lut_fall",i.Lemon="imgly_lut_lenin",i.GreenGap="imgly_lut_pola669",i.Colla="imgly_lut_elder",i.Solanus="imgly_lut_orchid",i.Kalmen="imgly_lut_bleached",i.Joran="imgly_lut_bleachedblue",i.Levante="imgly_lut_breeze",i.Zephyr="imgly_lut_blueshadows",i.Golden="imgly_lut_sunset",i.LowFire="imgly_lut_eighties",i.Sunrise="imgly_lut_evening",i.FlatBlack="imgly_lut_k2",i.Pumpkin="imgly_lut_nogreen",i.Ancient="imgly_lut_ancient",i.Candy="imgly_lut_cottoncandy",i.Classic="imgly_lut_classic",i.Colorful="imgly_lut_colorful",i.Creamy="imgly_lut_creamy",i.Fixie="imgly_lut_fixie",i.Food="imgly_lut_food",i.Fridge="imgly_lut_fridge",i.Glam="imgly_lut_glam",i.Gobblin="imgly_lut_gobblin",i.Hicon="imgly_lut_highcontrast",i.HighCarb="imgly_lut_highcarb",i.K1="imgly_lut_k1",i.K6="imgly_lut_k6",i.Keen="imgly_lut_keen",i.Lomo="imgly_lut_lomo",i.Lomo100="imgly_lut_lomo100",i.Lucid="imgly_lut_lucid",i.Mellow="imgly_lut_mellow",i.Neat="imgly_lut_neat",i.Pale="imgly_lut_pale",i.Pitched="imgly_lut_pitched",i.PolaSX="imgly_lut_polasx",i.Pro400="imgly_lut_pro400",i.Quozi="imgly_lut_quozi",i.Settled="imgly_lut_settled",i.Seventies="imgly_lut_seventies",i.Soft="imgly_lut_soft",i.Steel="imgly_lut_steel",i.Summer="imgly_lut_summer",i.Tender="imgly_lut_tender",i.Twilight="imgly_lut_twilight"})(I||(I={}));var oe;(function(i){i.DuoTone="imgly_filter_category_duotone",i.BW="imgly_filter_category_bw",i.Vintage="imgly_filter_category_vintage",i.Smooth="imgly_filter_category_smooth",i.Cold="imgly_filter_category_cold",i.Warm="imgly_filter_category_warm",i.Legacy="imgly_filter_category_legacy"})(oe||(oe={}));var tu=class{constructor(){this.items=[]}};var Tt;(function(i){i.RADIAL="radial",i.LINEAR="linear",i.MIRRORED="mirrored",i.GAUSSIAN="gaussian"})(Tt||(Tt={}));var eu=class{constructor(){this.items=[]}};var zy=class{constructor(t){this.name=t.name,this.coverImageUrl=t.coverImageUrl}loadCoverImage(t="anonymous"){return new Promise((e,r)=>{let o=new Image;o.addEventListener("load",()=>{e(o)}),o.addEventListener("error",()=>{r(new Error(`Failed to load image at ${this.coverImage}`))}),o.crossOrigin=t,o.src=this.coverImageUrl,this.coverImage=o})}};var Uy=class{constructor(t){this.title=t.title,this.category=t.category||t.title,this.thumbUrl=t.thumbUrl,this.rawUrl=t.rawUrl,this.authorName=t.authorName,this.authorAvatar=t.authorAvatar}loadThumbImage(t="anonymous"){return new Promise((e,r)=>{let o=new Image;o.addEventListener("load",()=>{e(o)}),o.addEventListener("error",()=>{r(new Error(`Failed to load image at ${this.thumbUrl}`))}),o.crossOrigin=t,o.src=this.thumbUrl,this.thumbImage=o})}getThumbImage(){return this.thumbUrl}};var iu=class{constructor(){this.enableWebcam=!1;this.enableUpload=!1;this.flattenCategories=!1;this.categoryHeaderType=we.CARD}};var Ny=class{getData(t){return new Promise((e,r)=>{let o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="json",o.onload=()=>{let{status:s}=o;s===200?e(o.response):r(new Error(`HTTP Status ${s}`))},o.send()})}},Bw=Ny;var Hy=class{loadJSON(t){return new Bw().getData(t)}getCategories(){return Promise.resolve([])}searchImages(t){return Promise.resolve([])}};var ru=class{constructor(){this.items=[]}};var vt;(function(i){i.NORMAL="normal",i.OVERLAY="overlay",i.SOFT_LIGHT="softLight",i.HARD_LIGHT="hardLight",i.MULTIPLY="multiply",i.DARKEN="darken",i.COLOR_BURN="colorBurn",i.SCREEN="screen",i.LIGHTEN="lighten"})(vt||(vt={}));var dt;(function(i){i.Bokeh="imgly_overlay_bokeh",i.Chop="imgly_overlay_chop",i.Clouds="imgly_overlay_clouds",i.Golden="imgly_overlay_golden",i.Grain="imgly_overlay_grain",i.Hearts="imgly_overlay_hearts",i.LightLeak1="imgly_overlay_lightleak1",i.LightLeak2="imgly_overlay_lightleak2",i.Metal="imgly_overlay_metal",i.Mosaic="imgly_overlay_mosaic",i.Painting="imgly_overlay_painting",i.Paper="imgly_overlay_paper",i.Rain="imgly_overlay_rain",i.Vintage="imgly_overlay_vintage",i.Wall1="imgly_overlay_wall1",i.Wall2="imgly_overlay_wall2",i.Wood="imgly_overlay_wood"})(dt||(dt={}));var ou=class{constructor(){this.categories=[];this.canvasActions=[ct.BRING_TO_FRONT,ct.FLIP,ct.DUPLICATE,ct.DELETE];this.flattenCategories=!1;this.categoryHeaderType=we.CARD;this.enableCustomUpload=!0;this.customStickerTintMode="none"}};var su=class{constructor(){this.fonts=[];this.canvasActions=[ct.EDIT,ct.BRING_TO_FRONT,ct.DUPLICATE,ct.DELETE];this.disableAutoScaling=!1}};function sh(i){return i.provider===void 0||i.provider==="file"}function nh(i){return i.provider==="google"}var nu=class{constructor(){this.defaultSize=.05;this.defaultHardness=.5}};var au=class{constructor(){this.items=[];this.canvasActions=[ct.EDIT,ct.BRING_TO_FRONT,ct.INVERT,ct.DUPLICATE,ct.DELETE]}};var lu=class{constructor(){this.categories=[];this.enableRotation=!0;this.enableFlip=!0;this.flattenCategories=!1;this.categoryHeaderType=we.TEXT}};var be;(function(i){i.CommonCategory="imgly_transforms_common",i.FacebookCategory="imgly_transforms_facebook",i.TwitterCategory="imgly_transforms_twitter",i.InstagramCategory="imgly_transforms_instagram",i.Custom="imgly_transform_common_custom",i.Square="imgly_transform_common_square",i.ThreeByFour="imgly_transform_common_3",i.FourByThree="imgly_transform_common_4",i.NineBySixteen="imgly_transform_common_9",i.SixteenByNine="imgly_transform_common_16",i.FacebookPost="imgly_transform_facebook_post",i.FacebookProfile="imgly_transform_facebook_profile",i.FacebookTitle="imgly_transform_facebook_title",i.InstagramLandscape="imgly_transform_instagram_landscape",i.InstagramPortrait="imgly_transform_instagram_portrait",i.InstagramSquare="imgly_transform_instagram_square",i.InstagramStory="imgly_transform_instagram_story",i.TwitterPost="imgly_transform_twitter_post",i.TwitterProfile="imgly_transform_twitter_profile",i.TwitterTitle="imgly_transform_twitter_title"})(be||(be={}));var rt;(function(i){i.EXPORT="export",i.CLOSE="close",i.HISTORY_CHANGE="historyChange",i.EDITOR_READY="editorReady",i.ERROR_IMAGE_LOADING="errorImageLoading",i.IMAGE_LOAD="imageLoad",i.TOOL_ENTER="toolEnter",i.STICKER_UPLOAD_ADD="stickerUploadAdd"})(rt||(rt={}));var Ri=class{constructor(){this.events={}}addListener(t,e){return(this.events[t]||(this.events[t]=[])).push(e),this}removeListener(t,e){let r=this.events[t];if(!r)return this;let o=r.lastIndexOf(e);return o===-1?this:(r.splice(o,1),this)}removeAllListeners(t){return this.events[t]=void 0,this}on(t,e){return this.addListener(t,e)}off(t,e){return this.removeListener(t,e)}emit(t,...e){let r=this.events[t];return!r||!r.length?!1:(r.slice(0).forEach(o=>o.apply(null,e)),!0)}};var i4=[{identifier:"basics",name:"Basics",items:[{identifier:Et.BRIGHTNESS},{identifier:Et.CONTRAST},{identifier:Et.SATURATION},{identifier:Et.GAMMA}]},{identifier:"refinements",name:"Refinements",items:[{identifier:Et.CLARITY},{identifier:Et.SHADOWS},{identifier:Et.HIGHLIGHTS},{identifier:Et.EXPOSURE},{identifier:Et.BLACKS},{identifier:Et.WHITES},{identifier:Et.TEMPERATURE},{identifier:Et.SHARPNESS}]}],ah=i4;var r4=[{identifier:oe.DuoTone,name:"DuoTone",thumbnailURI:"./categories/duotone.jpg",items:[{identifier:I.Desert,name:"Desert",thumbnailURI:"./items/imgly_duotone_desert.jpg",lightColor:"#e1de9a",darkColor:"#cb2129",defaultIntensity:.5},{identifier:I.Peach,name:"Peach",thumbnailURI:"./items/imgly_duotone_peach.jpg",lightColor:"#e9abb8",darkColor:"#0040ff",defaultIntensity:.5},{identifier:I.Clash,name:"Clash",thumbnailURI:"./items/imgly_duotone_clash.jpg",lightColor:"#f41a0f",darkColor:"#23007c",defaultIntensity:.5},{identifier:I.Plum,name:"Plum",thumbnailURI:"./items/imgly_duotone_plum.jpg",lightColor:"#74d7ff",darkColor:"#23007c",defaultIntensity:.5},{identifier:I.Breezy,name:"Breezy",thumbnailURI:"./items/imgly_duotone_breezy.jpg",lightColor:"#68fdff",darkColor:"#c20000",defaultIntensity:.5},{identifier:I.DeepBlue,name:"Deep Blue",thumbnailURI:"./items/imgly_duotone_deepblue.jpg",lightColor:"#2de9eb",darkColor:"#58007c",defaultIntensity:.5},{identifier:I.Frog,name:"Frog",thumbnailURI:"./items/imgly_duotone_frog.jpg",lightColor:"#5bff60",darkColor:"#7f23a9",defaultIntensity:.5},{identifier:I.Sunset,name:"Sunset",thumbnailURI:"./items/imgly_duotone_sunset.jpg",lightColor:"#f8ea46",darkColor:"#c400be",defaultIntensity:.5}]},{identifier:oe.BW,name:"B & W",thumbnailURI:"./categories/b&w.jpg",items:[{identifier:I.AD1920,name:"1920 A.D.",thumbnailURI:"./items/imgly_lut_ad1920.jpg",lutURI:"./items/imgly_lut_ad1920_5_5_128.png",defaultIntensity:1},{identifier:I.Greyed,name:"Greyed",thumbnailURI:"./items/imgly_lut_bw.jpg",lutURI:"./items/imgly_lut_bw_5_5_128.png",defaultIntensity:1},{identifier:I.Dusty,name:"Dusty",thumbnailURI:"./items/imgly_lut_x400.jpg",lutURI:"./items/imgly_lut_dusty_5_5_128.png",defaultIntensity:1},{identifier:I.Litho,name:"Litho",thumbnailURI:"./items/imgly_lut_litho.jpg",lutURI:"./items/imgly_lut_litho_5_5_128.png",defaultIntensity:1},{identifier:I.Sepia,name:"Sepia",thumbnailURI:"./items/imgly_lut_sepiahigh.jpg",lutURI:"./items/imgly_lut_sepia_5_5_128.png",defaultIntensity:1},{identifier:I.Weathered,name:"Weathered",thumbnailURI:"./items/imgly_lut_plate.jpg",lutURI:"./items/imgly_lut_weathered_5_5_128.png",defaultIntensity:1},{identifier:I.HardStuff,name:"Hard Stuff",thumbnailURI:"./items/imgly_lut_sin.jpg",lutURI:"./items/imgly_lut_hard_stuff_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8}]},{identifier:oe.Vintage,name:"Vintage",thumbnailURI:"./categories/vintage.jpg",items:[{identifier:I.Polaroid,name:"Polaroid",thumbnailURI:"./items/imgly_lut_blues.jpg",lutURI:"./items/imgly_lut_polaroid_5_5_128.png",defaultIntensity:1},{identifier:I.Sunny70s,name:"Sunny 70s",thumbnailURI:"./items/imgly_lut_front.jpg",lutURI:"./items/imgly_lut_sunny_70s_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Oldtimer,name:"Oldtimer",thumbnailURI:"./items/imgly_lut_texas.jpg",lutURI:"./items/imgly_lut_oldtimer_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Inferno,name:"Inferno",thumbnailURI:"./items/imgly_lut_celsius.jpg",lutURI:"./items/imgly_lut_inferno_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Snappy,name:"Snappy",thumbnailURI:"./items/imgly_lut_cool.jpg",lutURI:"./items/imgly_lut_snappy_5_5_128.png",defaultIntensity:1}]},{identifier:oe.Smooth,name:"Smooth",thumbnailURI:"./categories/smooth.jpg",items:[{identifier:I.Chestnut,name:"Chestnut",thumbnailURI:"./items/imgly_lut_chest.jpg",lutURI:"./items/imgly_lut_chestnut_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Softy,name:"Softy",thumbnailURI:"./items/imgly_lut_winter.jpg",lutURI:"./items/imgly_lut_softly_5_5_128.png",defaultIntensity:1},{identifier:I.Pebble,name:"Pebble",thumbnailURI:"./items/imgly_lut_kdynamic.jpg",lutURI:"./items/imgly_lut_pebble_5_5_128.png",defaultIntensity:1},{identifier:I.Moss,name:"Moss",thumbnailURI:"./items/imgly_lut_fall.jpg",lutURI:"./items/imgly_lut_moss_5_5_128.png",defaultIntensity:1},{identifier:I.Lemon,name:"Lemon",thumbnailURI:"./items/imgly_lut_lenin.jpg",lutURI:"./items/imgly_lut_lemon_5_5_128.png",defaultIntensity:1},{identifier:I.GreenGap,name:"Green Gap",thumbnailURI:"./items/imgly_lut_pola669.jpg",lutURI:"./items/imgly_lut_green_gap_5_5_128.png",defaultIntensity:1}]},{identifier:oe.Cold,name:"Cold",thumbnailURI:"./categories/cold.jpg",items:[{identifier:I.Colla,name:"Colla",thumbnailURI:"./items/imgly_lut_elder.jpg",lutURI:"./items/imgly_lut_colla_5_5_128.png",defaultIntensity:1},{identifier:I.Solanus,name:"Solanus",thumbnailURI:"./items/imgly_lut_orchid.jpg",lutURI:"./items/imgly_lut_solanus_5_5_128.png",defaultIntensity:1},{identifier:I.Kalmen,name:"Kalmen",thumbnailURI:"./items/imgly_lut_bleached.jpg",lutURI:"./items/imgly_lut_kalmen_5_5_128.png",defaultIntensity:1},{identifier:I.Joran,name:"Joran",thumbnailURI:"./items/imgly_lut_bleachedblue.jpg",lutURI:"./items/imgly_lut_joran_5_5_128.png",defaultIntensity:1},{identifier:I.Levante,name:"Levante",thumbnailURI:"./items/imgly_lut_breeze.jpg",lutURI:"./items/imgly_lut_levante_5_5_128.png",defaultIntensity:1},{identifier:I.Zephyr,name:"Zephyr",thumbnailURI:"./items/imgly_lut_blueshadows.jpg",lutURI:"./items/imgly_lut_zephyr_5_5_128.png",defaultIntensity:1}]},{identifier:oe.Warm,name:"Warm",thumbnailURI:"./categories/warm.jpg",items:[{identifier:I.Golden,name:"Golden",thumbnailURI:"./items/imgly_lut_sunset.jpg",lutURI:"./items/imgly_lut_golden_5_5_128.png",defaultIntensity:1},{identifier:I.LowFire,name:"Low Fire",thumbnailURI:"./items/imgly_lut_eighties.jpg",lutURI:"./items/imgly_lut_low_fire_5_5_128.png",defaultIntensity:1},{identifier:I.Sunrise,name:"Sunrise",thumbnailURI:"./items/imgly_lut_evening.jpg",lutURI:"./items/imgly_lut_sunrise_5_5_128.png",defaultIntensity:1},{identifier:I.FlatBlack,name:"Flat Black",thumbnailURI:"./items/imgly_lut_k2.jpg",lutURI:"./items/imgly_lut_flat_black_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Pumpkin,name:"Pumpkin",thumbnailURI:"./items/imgly_lut_nogreen.jpg",lutURI:"./items/imgly_lut_pumpkin_5_5_128.png",defaultIntensity:1}]},{identifier:oe.Legacy,name:"Legacy",thumbnailURI:"./categories/legacy.jpg",items:[{identifier:I.Ancient,name:"Ancient",thumbnailURI:"./items/imgly_lut_ancient.jpg",lutURI:"./items/imgly_lut_ancient_5_5_128.png",defaultIntensity:1},{identifier:I.Candy,name:"Candy",thumbnailURI:"./items/imgly_lut_cottoncandy.jpg",lutURI:"./items/imgly_lut_cottoncandy_5_5_128.png",defaultIntensity:1},{identifier:I.Classic,name:"Classic",thumbnailURI:"./items/imgly_lut_classic.jpg",lutURI:"./items/imgly_lut_classic_5_5_128.png",defaultIntensity:1},{identifier:I.Colorful,name:"Colorful",thumbnailURI:"./items/imgly_lut_colorful.jpg",lutURI:"./items/imgly_lut_colorful_5_5_128.png",defaultIntensity:1},{identifier:I.Creamy,name:"Creamy",thumbnailURI:"./items/imgly_lut_creamy.jpg",lutURI:"./items/imgly_lut_creamy_5_5_128.png",defaultIntensity:1},{identifier:I.Fixie,name:"Fixie",thumbnailURI:"./items/imgly_lut_fixie.jpg",lutURI:"./items/imgly_lut_fixie_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Food,name:"Food",thumbnailURI:"./items/imgly_lut_food.jpg",lutURI:"./items/imgly_lut_food_5_5_128.png",defaultIntensity:1},{identifier:I.Fridge,name:"Fridge",thumbnailURI:"./items/imgly_lut_fridge.jpg",lutURI:"./items/imgly_lut_fridge_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Glam,name:"Glam",thumbnailURI:"./items/imgly_lut_glam.jpg",lutURI:"./items/imgly_lut_glam_5_5_128.png",defaultIntensity:1},{identifier:I.Gobblin,name:"Gobblin",thumbnailURI:"./items/imgly_lut_gobblin.jpg",lutURI:"./items/imgly_lut_gobblin_5_5_128.png",defaultIntensity:1},{identifier:I.Hicon,name:"Hicon",thumbnailURI:"./items/imgly_lut_highcontrast.jpg",lutURI:"./items/imgly_lut_highcontrast_5_5_128.png",defaultIntensity:1},{identifier:I.HighCarb,name:"High Carb",thumbnailURI:"./items/imgly_lut_highcarb.jpg",lutURI:"./items/imgly_lut_highcarb_5_5_128.png",defaultIntensity:1},{identifier:I.K1,name:"K1",thumbnailURI:"./items/imgly_lut_k1.jpg",lutURI:"./items/imgly_lut_k1_5_5_128.png",defaultIntensity:1},{identifier:I.K6,name:"K6",thumbnailURI:"./items/imgly_lut_k6.jpg",lutURI:"./items/imgly_lut_k6_5_5_128.png",defaultIntensity:1},{identifier:I.Keen,name:"Keen",thumbnailURI:"./items/imgly_lut_keen.jpg",lutURI:"./items/imgly_lut_keen_5_5_128.png",defaultIntensity:1},{identifier:I.Lomo,name:"Lomo",thumbnailURI:"./items/imgly_lut_lomo.jpg",lutURI:"./items/imgly_lut_lomo_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Lomo100,name:"Lomo 100",thumbnailURI:"./items/imgly_lut_lomo100.jpg",lutURI:"./items/imgly_lut_lomo100_5_5_128.png",defaultIntensity:1},{identifier:I.Lucid,name:"Lucid",thumbnailURI:"./items/imgly_lut_lucid.jpg",lutURI:"./items/imgly_lut_lucid_5_5_128.png",defaultIntensity:1},{identifier:I.Mellow,name:"Mellow",thumbnailURI:"./items/imgly_lut_mellow.jpg",lutURI:"./items/imgly_lut_mellow_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:I.Neat,name:"Neat",thumbnailURI:"./items/imgly_lut_neat.jpg",lutURI:"./items/imgly_lut_neat_5_5_128.png",defaultIntensity:1},{identifier:I.Pale,name:"Pale",thumbnailURI:"./items/imgly_lut_pale.jpg",lutURI:"./items/imgly_lut_pale_5_5_128.png",defaultIntensity:1},{identifier:I.Pitched,name:"Pitched",thumbnailURI:"./items/imgly_lut_pitched.jpg",lutURI:"./items/imgly_lut_pitched_5_5_128.png",defaultIntensity:1},{identifier:I.PolaSX,name:"Pola SX",thumbnailURI:"./items/imgly_lut_polasx.jpg",lutURI:"./items/imgly_lut_polasx_5_5_128.png",defaultIntensity:1},{identifier:I.Pro400,name:"Pro 400",thumbnailURI:"./items/imgly_lut_pro400.jpg",lutURI:"./items/imgly_lut_pro400_5_5_128.png",defaultIntensity:1},{identifier:I.Quozi,name:"Quozi",thumbnailURI:"./items/imgly_lut_quozi.jpg",lutURI:"./items/imgly_lut_quozi_5_5_128.png",defaultIntensity:1},{identifier:I.Settled,name:"Settled",thumbnailURI:"./items/imgly_lut_settled.jpg",lutURI:"./items/imgly_lut_settled_5_5_128.png",defaultIntensity:1},{identifier:I.Seventies,name:"Seventies",thumbnailURI:"./items/imgly_lut_seventies.jpg",lutURI:"./items/imgly_lut_seventies_5_5_128.png",defaultIntensity:1},{identifier:I.Soft,name:"Soft",thumbnailURI:"./items/imgly_lut_soft.jpg",lutURI:"./items/imgly_lut_soft_5_5_128.png",defaultIntensity:1},{identifier:I.Steel,name:"Steel",thumbnailURI:"./items/imgly_lut_steel.jpg",lutURI:"./items/imgly_lut_steel_5_5_128.png",defaultIntensity:1},{identifier:I.Summer,name:"Summer",thumbnailURI:"./items/imgly_lut_summer.jpg",lutURI:"./items/imgly_lut_summer_5_5_128.png",defaultIntensity:1},{identifier:I.Tender,name:"Tender",thumbnailURI:"./items/imgly_lut_tender.jpg",lutURI:"./items/imgly_lut_tender_5_5_128.png",defaultIntensity:1},{identifier:I.Twilight,name:"Twilight",thumbnailURI:"./items/imgly_lut_twilight.jpg",lutURI:"./items/imgly_lut_twilight_5_5_128.png",defaultIntensity:1}]}],lh=r4;var o4=[{identifier:Tt.RADIAL,thumbnailURI:"./items/radial.png"},{identifier:Tt.MIRRORED,thumbnailURI:"./items/mirrored.png"},{identifier:Tt.LINEAR,thumbnailURI:"./items/linear.png"},{identifier:Tt.GAUSSIAN,thumbnailURI:"./items/gaussian.png"}],Wy=o4;var s4=[{identifier:"imgly_font_open_sans_bold",fontFamily:"Open Sans",fontWeight:"bold",fontURI:"./fonts/imgly_font_open_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}},{identifier:"imgly_font_aleo_bold",fontFamily:"Aleo",fontWeight:"bold",fontURI:"./fonts/imgly_font_aleo_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}},{identifier:"imgly_font_amaticsc",fontFamily:"Amatic SC",fontWeight:"normal",fontURI:"./fonts/imgly_font_amaticsc.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}},{identifier:"imgly_font_archivo_black",fontFamily:"Archivo",fontWeight:"normal",fontURI:"./fonts/imgly_font_archivo_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}},{identifier:"imgly_font_bungee_inline",fontFamily:"Bungee Inline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_bungee_inline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}},{identifier:"imgly_font_fira_sans_regular",fontFamily:"Fira Sans",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_fira_sans_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}},{identifier:"imgly_font_campton_bold",fontFamily:"Campton Book",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_campton_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}},{identifier:"imgly_font_carter_one",fontFamily:"Carter One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_carter_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}},{identifier:"imgly_font_codystar",fontFamily:"Codystar",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_codystar.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}},{identifier:"imgly_font_galano_grotesque_bold",fontFamily:"Galano Grotesque",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_galano_grotesque_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_krona_one",fontFamily:"Krona One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_krona_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}},{identifier:"imgly_font_kumar_one_outline",fontFamily:"Kumar One Outline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_kumar_one_outline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}},{identifier:"imgly_font_lobster",fontFamily:"Lobster",fontWeight:"normal",fontURI:"./fonts/imgly_font_lobster.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}},{identifier:"imgly_font_molle",fontFamily:"Molle",fontWeight:"normal",fontStyle:"italic",fontURI:"./fonts/imgly_font_molle.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}},{identifier:"imgly_font_monoton",fontFamily:"Monoton",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_monoton.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}},{identifier:"imgly_font_nixie_one",fontFamily:"Nixie One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_nixie_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}},{identifier:"imgly_font_notable",fontFamily:"Notable",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_notable.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}},{identifier:"imgly_font_ostrich_sans_black",fontFamily:"Ostrich",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontFamily:"Ostrich",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_oswald_semi_bold",fontFamily:"Oswald SemiBold",googleFamily:"Oswald",fontWeight:600,fontStyle:"normal",fontURI:"./fonts/imgly_font_oswald_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}},{identifier:"imgly_font_palanquin_dark_semi_bold",fontFamily:"Palanquin Dark SemiBold",googleFamily:"Palanquin Dark",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_palanquin_dark_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}},{identifier:"imgly_font_poppins",fontFamily:"Poppins",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_poppins.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}},{identifier:"imgly_font_permanent_marker",fontFamily:"Permanent Marker",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_permanent_marker.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}},{identifier:"imgly_font_roboto_black_italic",fontFamily:"Roboto Black",fontWeight:"bold",fontStyle:"italic",googleFamily:"Roboto",fontURI:"./fonts/imgly_font_roboto_black_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontFamily:"Roboto Light",googleFamily:"Roboto",fontWeight:300,fontStyle:"italic",fontURI:"./fonts/imgly_font_roboto_light_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sancreek",fontFamily:"Sancreek",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sancreek.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}},{identifier:"imgly_font_stint_ultra_expanded",fontFamily:"Stint Ultra Expanded",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_stint_ultra_expanded.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}},{identifier:"imgly_font_trash_hand",fontFamily:"Trash Hand",fontWeight:"normal",fontURI:"./fonts/imgly_font_trash_hand.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}},{identifier:"imgly_font_vt323",fontFamily:"VT323",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_vt323.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_yeseva_one",fontFamily:"Yeseva One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_yeseva_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}},{identifier:"imgly_font_abril_fatface_regular",fontFamily:"Abril Fatface",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_abril_fatface_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}},{identifier:"imgly_font_amberlight",fontFamily:"Amberlight",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_amberlight.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}},{identifier:"imgly_font_montserrat_light",fontFamily:"Montserrat Light",googleFamily:"Montserrat",fontWeight:300,fontStyle:"normal",fontURI:"./fonts/imgly_font_montserrat_light.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}},{identifier:"imgly_font_handycheera_regular",fontFamily:"Handycheera",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_handycheera_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}},{identifier:"imgly_font_ostrich_sans_heavy",fontFamily:"Ostrich",fontWeight:900,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_heavy.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}},{identifier:"imgly_font_petit_formal_script",fontFamily:"Petit Formal Script",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_petit_formal_script.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}},{identifier:"imgly_font_rasa_500",fontFamily:"Rasa",fontWeight:500,fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_500.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_regular",fontFamily:"Rasa",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_regular.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_roboto_black",fontFamily:"Roboto Black",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_black.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light",fontFamily:"Roboto Light",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_light.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sue_ellen_francisco",fontFamily:"Sue Ellen Francisco",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sue_ellen_francisco.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}},{identifier:"imgly_font_ultra",fontFamily:"Ultra",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_ultra.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}},{identifier:"imgly_font_wolesbro",fontFamily:"Wolesbro",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_wolesbro.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}],ch=s4;var Mw=["imgly_font_open_sans_bold","imgly_font_aleo_bold","imgly_font_amaticsc","imgly_font_archivo_black","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_carter_one","imgly_font_codystar","imgly_font_fira_sans_regular","imgly_font_galano_grotesque_bold","imgly_font_krona_one","imgly_font_kumar_one_outline","imgly_font_lobster","imgly_font_molle","imgly_font_monoton","imgly_font_nixie_one","imgly_font_notable","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_oswald_semi_bold","imgly_font_palanquin_dark_semi_bold","imgly_font_poppins","imgly_font_permanent_marker","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sancreek","imgly_font_stint_ultra_expanded","imgly_font_trash_hand","imgly_font_vt323","imgly_font_yeseva_one"],Lw=["imgly_font_abril_fatface_regular","imgly_font_amberlight","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_galano_grotesque_bold","imgly_font_handycheera_regular","imgly_font_montserrat_light","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_heavy","imgly_font_permanent_marker","imgly_font_petit_formal_script","imgly_font_rasa_500","imgly_font_rasa_regular","imgly_font_roboto_black","imgly_font_roboto_light","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sue_ellen_francisco","imgly_font_ultra","imgly_font_wolesbro"];var n4=[{identifier:"imgly_frame_dia",name:"Dia",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_left.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_right.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",name:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",name:"Black Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",name:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",name:"Low Poly",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}}],dh=n4;var a4=[{identifier:dt.Golden,name:"Golden",defaultBlendMode:vt.LIGHTEN,overlayURI:"./items/imgly_overlay_golden.jpg",thumbnailURI:"./items/imgly_overlay_golden_thumb.jpg"},{identifier:dt.LightLeak1,name:"Lightleak",defaultBlendMode:vt.SCREEN,overlayURI:"./items/imgly_overlay_lightleak1.jpg",thumbnailURI:"./items/imgly_overlay_lightleak1_thumb.jpg"},{identifier:dt.Rain,name:"Rain",defaultBlendMode:vt.OVERLAY,overlayURI:"./items/imgly_overlay_rain.jpg",thumbnailURI:"./items/imgly_overlay_rain_thumb.jpg"},{identifier:dt.Mosaic,name:"Mosaic",defaultBlendMode:vt.MULTIPLY,overlayURI:"./items/imgly_overlay_mosaic.jpg",thumbnailURI:"./items/imgly_overlay_mosaic_thumb.jpg"},{identifier:dt.Vintage,name:"Vintage",defaultBlendMode:vt.DARKEN,overlayURI:"./items/imgly_overlay_vintage.jpg",thumbnailURI:"./items/imgly_overlay_vintage_thumb.jpg"},{identifier:dt.Paper,name:"Paper",defaultBlendMode:vt.MULTIPLY,overlayURI:"./items/imgly_overlay_paper.jpg",thumbnailURI:"./items/imgly_overlay_paper_thumb.jpg"},{identifier:dt.Bokeh,name:"Bokeh",defaultBlendMode:vt.LIGHTEN,overlayURI:"./items/imgly_overlay_bokeh.jpg",thumbnailURI:"./items/imgly_overlay_bokeh_thumb.jpg"},{identifier:dt.Hearts,name:"Hearts",defaultBlendMode:vt.SCREEN,overlayURI:"./items/imgly_overlay_hearts.jpg",thumbnailURI:"./items/imgly_overlay_hearts_thumb.jpg"},{identifier:dt.LightLeak2,name:"Lightleak 2",defaultBlendMode:vt.LIGHTEN,overlayURI:"./items/imgly_overlay_lightleak2.jpg",thumbnailURI:"./items/imgly_overlay_lightleak2_thumb.jpg"},{identifier:dt.Wood,name:"Wood",defaultBlendMode:vt.MULTIPLY,overlayURI:"./items/imgly_overlay_wood.jpg",thumbnailURI:"./items/imgly_overlay_wood_thumb.jpg"},{identifier:dt.Chop,name:"Chop",defaultBlendMode:vt.MULTIPLY,overlayURI:"./items/imgly_overlay_chop.jpg",thumbnailURI:"./items/imgly_overlay_chop_thumb.jpg"},{identifier:dt.Metal,name:"Metal",defaultBlendMode:vt.OVERLAY,overlayURI:"./items/imgly_overlay_metal.jpg",thumbnailURI:"./items/imgly_overlay_metal_thumb.jpg"},{identifier:dt.Painting,name:"Painting",defaultBlendMode:vt.OVERLAY,overlayURI:"./items/imgly_overlay_painting.jpg",thumbnailURI:"./items/imgly_overlay_painting_thumb.jpg"},{identifier:dt.Grain,name:"Grain",defaultBlendMode:vt.OVERLAY,overlayURI:"./items/imgly_overlay_grain.jpg",thumbnailURI:"./items/imgly_overlay_grain_thumb.jpg"},{identifier:dt.Clouds,name:"Clouds",defaultBlendMode:vt.SOFT_LIGHT,overlayURI:"./items/imgly_overlay_clouds.jpg",thumbnailURI:"./items/imgly_overlay_clouds_thumb.jpg"},{identifier:dt.Wall1,name:"Wall",defaultBlendMode:vt.LIGHTEN,overlayURI:"./items/imgly_overlay_wall1.jpg",thumbnailURI:"./items/imgly_overlay_wall1_thumb.jpg"},{identifier:dt.Wall2,name:"Wall 2",defaultBlendMode:vt.OVERLAY,overlayURI:"./items/imgly_overlay_wall2.jpg",thumbnailURI:"./items/imgly_overlay_wall2_thumb.jpg"}],uh=a4;var l4=[{identifier:"imgly_sticker_emoticons",name:"Emoticons",thumbnailURI:"./categories/emoticons.png",items:[{identifier:"imgly_sticker_emoticons_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_grin.svg",tintMode:"none",name:"Grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_laugh",stickerURI:"./emoticons/imgly_sticker_emoticons_laugh.svg",tintMode:"none",name:"Laugh",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smile",stickerURI:"./emoticons/imgly_sticker_emoticons_smile.svg",tintMode:"none",name:"Smile",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_wink.svg",tintMode:"none",name:"Wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tongue_out_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_tongue_out_wink.svg",tintMode:"none",name:"Tongue out wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angel",stickerURI:"./emoticons/imgly_sticker_emoticons_angel.svg",tintMode:"none",name:"Angel",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kisses",stickerURI:"./emoticons/imgly_sticker_emoticons_kisses.svg",tintMode:"none",name:"Kisses",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loving",stickerURI:"./emoticons/imgly_sticker_emoticons_loving.svg",tintMode:"none",name:"Loving",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kiss",stickerURI:"./emoticons/imgly_sticker_emoticons_kiss.svg",tintMode:"none",name:"Kiss",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wave",stickerURI:"./emoticons/imgly_sticker_emoticons_wave.svg",tintMode:"none",name:"Wave",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_nerd",stickerURI:"./emoticons/imgly_sticker_emoticons_nerd.svg",tintMode:"none",name:"Nerd",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cool",stickerURI:"./emoticons/imgly_sticker_emoticons_cool.svg",tintMode:"none",name:"Cool",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_blush",stickerURI:"./emoticons/imgly_sticker_emoticons_blush.svg",tintMode:"none",name:"Blush",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_duckface",stickerURI:"./emoticons/imgly_sticker_emoticons_duckface.svg",tintMode:"none",name:"Duckface",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_furious.svg",tintMode:"none",name:"Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angry",stickerURI:"./emoticons/imgly_sticker_emoticons_angry.svg",tintMode:"none",name:"Angry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_steaming_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_steaming_furious.svg",tintMode:"none",name:"Steaming Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sad",stickerURI:"./emoticons/imgly_sticker_emoticons_sad.svg",tintMode:"none",name:"Sad",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_anxious",stickerURI:"./emoticons/imgly_sticker_emoticons_anxious.svg",tintMode:"none",name:"Anxious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_cry.svg",tintMode:"none",name:"Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sobbing",stickerURI:"./emoticons/imgly_sticker_emoticons_sobbing.svg",tintMode:"none",name:"Sobbing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loud_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_loud_cry.svg",tintMode:"none",name:"Loud Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wide_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_wide_grin.svg",tintMode:"none",name:"Wide grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_impatient",stickerURI:"./emoticons/imgly_sticker_emoticons_impatient.svg",tintMode:"none",name:"Impatient",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tired",stickerURI:"./emoticons/imgly_sticker_emoticons_tired.svg",tintMode:"none",name:"Tired",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_asleep",stickerURI:"./emoticons/imgly_sticker_emoticons_asleep.svg",tintMode:"none",name:"Asleep",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sleepy",stickerURI:"./emoticons/imgly_sticker_emoticons_sleepy.svg",tintMode:"none",name:"Sleepy",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_deceased",stickerURI:"./emoticons/imgly_sticker_emoticons_deceased.svg",tintMode:"none",name:"Deceased",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_attention",stickerURI:"./emoticons/imgly_sticker_emoticons_attention.svg",tintMode:"none",name:"Attention",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_question",stickerURI:"./emoticons/imgly_sticker_emoticons_question.svg",tintMode:"none",name:"Question",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",stickerURI:"./emoticons/imgly_sticker_emoticons_not_speaking_to_you.svg",tintMode:"none",name:"Not speaking to you",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sick",stickerURI:"./emoticons/imgly_sticker_emoticons_sick.svg",tintMode:"none",name:"Sick",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pumpkin",stickerURI:"./emoticons/imgly_sticker_emoticons_pumpkin.svg",tintMode:"none",name:"Pumpkin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_boxer",stickerURI:"./emoticons/imgly_sticker_emoticons_boxer.svg",tintMode:"none",name:"Boxer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_idea",stickerURI:"./emoticons/imgly_sticker_emoticons_idea.svg",tintMode:"none",name:"Idea",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smoking",stickerURI:"./emoticons/imgly_sticker_emoticons_smoking.svg",tintMode:"none",name:"Smoking",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_beer",stickerURI:"./emoticons/imgly_sticker_emoticons_beer.svg",tintMode:"none",name:"Beer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skateboard",stickerURI:"./emoticons/imgly_sticker_emoticons_skateboard.svg",tintMode:"none",name:"Skateboard",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_guitar",stickerURI:"./emoticons/imgly_sticker_emoticons_guitar.svg",tintMode:"none",name:"Guitar",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_music",stickerURI:"./emoticons/imgly_sticker_emoticons_music.svg",tintMode:"none",name:"Music",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sunbathing",stickerURI:"./emoticons/imgly_sticker_emoticons_sunbathing.svg",tintMode:"none",name:"Sunbathing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hippie",stickerURI:"./emoticons/imgly_sticker_emoticons_hippie.svg",tintMode:"none",name:"Hippie",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_humourous",stickerURI:"./emoticons/imgly_sticker_emoticons_humourous.svg",tintMode:"none",name:"Humourous",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hitman",stickerURI:"./emoticons/imgly_sticker_emoticons_hitman.svg",tintMode:"none",name:"Hitman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_harry_potter",stickerURI:"./emoticons/imgly_sticker_emoticons_harry_potter.svg",tintMode:"none",name:"Harry Potter",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_business",stickerURI:"./emoticons/imgly_sticker_emoticons_business.svg",tintMode:"none",name:"Business",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_batman",stickerURI:"./emoticons/imgly_sticker_emoticons_batman.svg",tintMode:"none",name:"Batman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skull",stickerURI:"./emoticons/imgly_sticker_emoticons_skull.svg",tintMode:"none",name:"Skull",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_ninja",stickerURI:"./emoticons/imgly_sticker_emoticons_ninja.svg",tintMode:"none",name:"Ninja",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_masked",stickerURI:"./emoticons/imgly_sticker_emoticons_masked.svg",tintMode:"none",name:"Masked",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_alien",stickerURI:"./emoticons/imgly_sticker_emoticons_alien.svg",tintMode:"none",name:"Alien",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wrestler",stickerURI:"./emoticons/imgly_sticker_emoticons_wrestler.svg",tintMode:"none",name:"Wrestler",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_devil",stickerURI:"./emoticons/imgly_sticker_emoticons_devil.svg",tintMode:"none",name:"Devil",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_star",stickerURI:"./emoticons/imgly_sticker_emoticons_star.svg",tintMode:"none",name:"Star",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_baby_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_baby_chicken.svg",tintMode:"none",name:"Baby Chicken",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_rabbit",stickerURI:"./emoticons/imgly_sticker_emoticons_rabbit.svg",tintMode:"none",name:"Rabbit",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pig",stickerURI:"./emoticons/imgly_sticker_emoticons_pig.svg",tintMode:"none",name:"Pig",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_chicken.svg",tintMode:"none",name:"Chicken",resizeMode:"keepAspect"}]},{identifier:"imgly_sticker_shapes",name:"Shapes",thumbnailURI:"./categories/shapes.png",items:[{identifier:"imgly_sticker_shapes_badge_01",stickerURI:"./shapes/imgly_sticker_shapes_badge_01.svg",tintMode:"solid",name:"Shape Badge 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_04",stickerURI:"./shapes/imgly_sticker_shapes_badge_04.svg",tintMode:"solid",name:"Shape Badge 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_12",stickerURI:"./shapes/imgly_sticker_shapes_badge_12.svg",tintMode:"solid",name:"Shape Badge 12",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_06",stickerURI:"./shapes/imgly_sticker_shapes_badge_06.svg",tintMode:"solid",name:"Shape Badge 06",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_13",stickerURI:"./shapes/imgly_sticker_shapes_badge_13.svg",tintMode:"solid",name:"Shape Badge 13",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_36",stickerURI:"./shapes/imgly_sticker_shapes_badge_36.svg",tintMode:"solid",name:"Shape Badge 36",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_08",stickerURI:"./shapes/imgly_sticker_shapes_badge_08.svg",tintMode:"solid",name:"Shape Badge 08",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_11",stickerURI:"./shapes/imgly_sticker_shapes_badge_11.svg",tintMode:"solid",name:"Shape Badge 11",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_35",stickerURI:"./shapes/imgly_sticker_shapes_badge_35.svg",tintMode:"solid",name:"Shape Badge 35",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_28",stickerURI:"./shapes/imgly_sticker_shapes_badge_28.svg",tintMode:"solid",name:"Shape Badge 28",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_32",stickerURI:"./shapes/imgly_sticker_shapes_badge_32.svg",tintMode:"solid",name:"Shape Badge 32",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_15",stickerURI:"./shapes/imgly_sticker_shapes_badge_15.svg",tintMode:"solid",name:"Shape Badge 15",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_20",stickerURI:"./shapes/imgly_sticker_shapes_badge_20.svg",tintMode:"solid",name:"Shape Badge 20",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_18",stickerURI:"./shapes/imgly_sticker_shapes_badge_18.svg",tintMode:"solid",name:"Shape Badge 18",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_19",stickerURI:"./shapes/imgly_sticker_shapes_badge_19.svg",tintMode:"solid",name:"Shape Badge 19",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_02",stickerURI:"./shapes/imgly_sticker_shapes_arrow_02.svg",tintMode:"solid",name:"Shape Arrow 02",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_03",stickerURI:"./shapes/imgly_sticker_shapes_arrow_03.svg",tintMode:"solid",name:"Shape Arrow 03",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_01",stickerURI:"./shapes/imgly_sticker_shapes_spray_01.svg",tintMode:"solid",name:"Shape Spray 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_04",stickerURI:"./shapes/imgly_sticker_shapes_spray_04.svg",tintMode:"solid",name:"Shape Spray 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_03",stickerURI:"./shapes/imgly_sticker_shapes_spray_03.svg",tintMode:"solid",name:"Shape Spray 03",resizeMode:"keepAspect"}]}],mh=l4;var c4=[{thumbnailURI:"./items/dark/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/dark/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/dark/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/dark/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/dark/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/dark/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/dark/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/dark/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/dark/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/dark/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/dark/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/dark/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/dark/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/dark/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}],zw=c4;var d4=[{thumbnailURI:"./items/light/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/light/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/light/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/light/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/light/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/light/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/light/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/light/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/light/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/light/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/light/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/light/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/light/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/light/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}],Uw=d4;var u4=[{identifier:"imgly_transforms_common",name:"Common",items:[{identifier:"imgly_transform_common_custom",name:"Custom",thumbnailURI:"",ratio:"*"},{identifier:"imgly_transform_common_square",name:"Square",thumbnailURI:"",ratio:1},{identifier:"imgly_transform_common_4",name:"4:3",thumbnailURI:"",ratio:4/3},{identifier:"imgly_transform_common_16",name:"16:9",thumbnailURI:"",ratio:16/9},{identifier:"imgly_transform_common_3",name:"3:4",thumbnailURI:"",ratio:3/4},{identifier:"imgly_transform_common_9",name:"9:16",thumbnailURI:"",ratio:9/16}]},{identifier:"imgly_transforms_facebook",name:"Facebook",items:[{identifier:"imgly_transform_facebook_profile",name:"Profile",thumbnailURI:"",dimensions:{x:300,y:300},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_title",name:"Title",thumbnailURI:"",dimensions:{x:1200,y:627},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_post",name:"Post",thumbnailURI:"",dimensions:{x:940,y:788},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_instagram",name:"Instagram",items:[{identifier:"imgly_transform_instagram_landscape",name:"Landscape",thumbnailURI:"",dimensions:{x:1080,y:566},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_portrait",name:"Portrait",thumbnailURI:"",dimensions:{x:1080,y:1350},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_square",name:"Square",thumbnailURI:"",dimensions:{x:1080,y:1080},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_story",name:"Story",thumbnailURI:"",dimensions:{x:1080,y:1920},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_twitter",name:"Twitter",items:[{identifier:"imgly_transform_twitter_post",name:"Post",thumbnailURI:"",dimensions:{x:1024,y:512},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_profile",name:"Profile",thumbnailURI:"",dimensions:{x:400,y:400},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_title",name:"Title",thumbnailURI:"",dimensions:{x:1500,y:500},forceDimensions:!0,lockDimensions:!0}]}],ph=u4;var _s={imgly_font_bernier_regular:"imgly_font_sancreek",imgly_font_cheque_regular:"imgly_font_kumar_one_outline",imgly_font_gagalin_regular:"imgly_font_permanent_marker",imgly_font_hagin_caps_thin:"imgly_font_nixie_one",imgly_font_intro_inline:"imgly_font_bungee_inline",imgly_font_nexa_script:"imgly_font_molle",imgly_font_panton_blackitalic_caps:"imgly_font_roboto_black_italic",imgly_font_panton_lightitalic_caps:"imgly_font_roboto_light_italic",imgly_font_perfograma:"imgly_font_codystar",imgly_font_panton_black_caps:"imgly_font_roboto_black",imgly_font_panton_light_caps:"imgly_font_roboto_light",imgly_font_summer_font_light:"imgly_font_sue_ellen_francisco"},In=(i,t=!1)=>_s[i]?(t&&console.warn(`Font ${i} was deprecated. Please use ${_s[i]} instead.`),_s[i]):i;var hh={};ne(hh,{isMobile:()=>Gy});function Gy(){if(typeof navigator=="undefined")return!1;let i=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4))}function Vr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{let t=Math.random()*16|0;return(i==="x"?t:t&3|8).toString(16)})}var eK=window.performance.now.bind(window.performance);var cu=class{constructor(t){this.text=t;this.lastOffsetWidth=-1;let e="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.element=document.createElement("div"),this.element.setAttribute("aria-hidden","true"),this.element.appendChild(document.createTextNode(t)),this.collapsible=document.createElement("span"),this.expandable=document.createElement("span"),this.collapsibleInner=document.createElement("span"),this.expandableInner=document.createElement("span"),this.collapsible.style.cssText=e,this.expandable.style.cssText=e,this.expandableInner.style.cssText=e,this.collapsibleInner.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.collapsible.appendChild(this.collapsibleInner),this.expandable.appendChild(this.expandableInner),this.element.appendChild(this.collapsible),this.element.appendChild(this.expandable)}getElement(){return this.element}setFont(t){this.element.style.cssText=`max-width:none;
      min-width:20px;
      min-height:20px;
      display:inline-block;
      overflow:hidden;
      position:absolute;
      width:auto;
      margin:0;
      padding:0;
      top:-999px;
      white-space:nowrap;
      font-synthesis:none;
      font:${t};`}getWidth(){return this.element.offsetWidth}setWidth(t){this.element.style.width=`${t}px`}onResize(t){let e=()=>{this.onScroll(t)};this.collapsible.addEventListener("scroll",e),this.expandable.addEventListener("scroll",e),this.reset()}reset(){let t=this.getWidth(),e=t+100;return this.expandableInner.style.width=`${e}px`,this.expandable.scrollLeft=e,this.collapsible.scrollLeft=this.collapsible.scrollWidth+100,this.lastOffsetWidth!==t?(this.lastOffsetWidth=t,!0):!1}onScroll(t){this.reset()&&this.element.parentNode!==null&&t(this.lastOffsetWidth)}};var _e=class{static getUserAgent(){return window.navigator.userAgent}static getNavigatorVendor(){return window.navigator.vendor}static hasWebKitFallbackBug(){if(_e.HAS_WEBKIT_FALLBACK_BUG===null){let t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(_e.getUserAgent());_e.HAS_WEBKIT_FALLBACK_BUG=!!t&&(parseInt(t[1],10)<536||parseInt(t[1],10)===536&&parseInt(t[2],10)<=11)}return _e.HAS_WEBKIT_FALLBACK_BUG}static hasSafari10Bug(){if(_e.HAS_SAFARI_10_BUG===null)if(_e.supportsNativeFontLoading()&&/Apple/.test(_e.getNavigatorVendor())){let t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(_e.getUserAgent());_e.HAS_SAFARI_10_BUG=!!t&&parseInt(t[1],10)<603}else _e.HAS_SAFARI_10_BUG=!1;return _e.HAS_SAFARI_10_BUG}static supportsNativeFontLoading(){return _e.SUPPORTS_NATIVE_FONT_LOADING===null&&(_e.SUPPORTS_NATIVE_FONT_LOADING=!!document.fonts),_e.SUPPORTS_NATIVE_FONT_LOADING}static supportsStretch(){if(_e.SUPPORTS_STRETCH===null){let t=document.createElement("div");try{t.style.font="condensend 100px sans-serif"}catch(e){_e.SUPPORTS_STRETCH=!1}_e.SUPPORTS_STRETCH=t.style.font!==""}return _e.SUPPORTS_STRETCH}constructor(t){this.font=b({fontFamily:"normal",fontStyle:"normal",fontWeight:"normal",fontStretch:"normal"},t)}load(t,e){let r="BESbswy",o=null,s=e||_e.DEFAULT_TIMEOUT,n=this.getTime();return new Promise((a,l)=>{if(_e.supportsNativeFontLoading()&&!_e.hasSafari10Bug()){let c=new Promise((u,m)=>{let p=()=>{this.getTime()-n>=s?m(new Error(""+s+"ms timeout exceeded")):document.fonts.load(this.getStyle(`"${this.font.fontFamily}"`),r).then(v=>{v.length>=1?u():setTimeout(p,25)},l)};p()}),d=new Promise((u,m)=>{o=setTimeout(()=>{m(new Error(`${s} ms timeout exceeded`))},s)});Promise.race([d,c]).then(()=>{clearTimeout(o),a(this)},l)}else{let c=new cu(r),d=new cu(r),u=new cu(r),m=-1,p=-1,f=-1,v=-1,x=-1,_=-1,D=document.createElement("div"),k=()=>{D.parentNode!==null&&D.parentNode.removeChild(D)},A=()=>{if((m!==-1&&p!==-1||m!==-1&&f!==-1||p!==-1&&f!==-1)&&(m===p||m===f||p===f)){if(_e.hasWebKitFallbackBug()&&(m===v&&p===v&&f===v||m===x&&p===x&&f===x||m===_&&p===_&&f===_))return;k(),clearTimeout(o),a(this)}};D.dir="ltr",c.setFont(this.getStyle("sans-serif")),d.setFont(this.getStyle("serif")),u.setFont(this.getStyle("monospace")),D.appendChild(c.getElement()),D.appendChild(d.getElement()),D.appendChild(u.getElement()),document.body.appendChild(D),v=c.getWidth(),x=d.getWidth(),_=u.getWidth();let B=()=>{if(this.getTime()-n>=s)k(),l(new Error(`${s} ms timeout exceeded`));else{let F=document.hidden;(F===!0||F===void 0)&&(m=c.getWidth(),p=d.getWidth(),f=u.getWidth(),A()),o=setTimeout(B,50)}};B(),c.onResize(T=>{m=T,A()}),c.setFont(this.getStyle(`"${this.font.fontFamily}",sans-serif`)),d.onResize(T=>{p=T,A()}),d.setFont(this.getStyle(`"${this.font.fontFamily}",serif`)),u.onResize(T=>{f=T,A()}),u.setFont(this.getStyle(`"${this.font.fontFamily}",monospace`))}})}getStyle(t){return[this.font.fontStyle,this.font.fontWeight,_e.supportsStretch()?this.font.fontStretch:"","100px",t].join(" ")}getTime(){return new Date().getTime()}},En=_e;En.HAS_WEBKIT_FALLBACK_BUG=null,En.HAS_SAFARI_10_BUG=null,En.SUPPORTS_STRETCH=null,En.SUPPORTS_NATIVE_FONT_LOADING=null,En.DEFAULT_TIMEOUT=3e3;var ue=class{static fromSize(t){return new ue(t.width,t.height)}static distance(t,e){let r=e.x-t.x,o=e.y-t.y;return Math.sqrt(r*r+o*o)}static dot(t,e){return t.x*e.x+t.y*e.y}static lerp(t,e,r){let o=Math.min(Math.max(r,0),1);return new ue(t.x*o+e.x*(1-o),t.y*o+e.y*(1-o))}static lerpUnclamped(t,e,r){return new ue(t.x*r+e.x*(1-r),t.y*r+e.y*(1-r))}static proportionalFit(t,e){let r=t.x/t.y,o=e.x/e.y;return r>o?e.multiply(t.y/e.y):e.multiply(t.x/e.x)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalized(){let t=this.magnitude;return new ue(this.x/t,this.y/t)}get floored(){return new ue(Math.floor(this.x),Math.floor(this.y))}get rounded(){return new ue(Math.round(this.x),Math.round(this.y))}get min(){return Math.min(this.x,this.y)}get max(){return Math.max(this.x,this.y)}get abs(){return new ue(Math.abs(this.x),Math.abs(this.y))}get swapped(){return new ue(this.y,this.x)}constructor(t,e){typeof t=="number"?(this.x=t,this.y=e):(this.x=t.x,this.y=t.y)}clone(){return new ue(this.x,this.y)}add(t,e){return typeof t=="number"?new ue(this.x+t,this.y+e):new ue(this.x+t.x,this.y+t.y)}subtract(t,e){return typeof t=="number"?new ue(this.x-t,this.y-e):new ue(this.x-t.x,this.y-t.y)}multiply(t,e){return typeof t=="number"?new ue(this.x*t,this.y*(e===void 0?t:e)):new ue(this.x*t.x,this.y*t.y)}divide(t,e){return typeof t=="number"?new ue(this.x/t,this.y/(e===void 0?t:e)):new ue(this.x/t.x,this.y/t.y)}equals(t){return this.x===t.x&&this.y===t.y}clamp(t,e){let r=Math.max(t.x,Math.min(e.x,this.x)),o=Math.max(t.y,Math.min(e.y,this.y));return new ue(r,o)}},R=ue;R.ZERO=new ue(0,0),R.ONE=new ue(1,1),R.UP=new ue(0,1),R.DOWN=new ue(0,-1),R.RIGHT=new ue(1,0),R.LEFT=new ue(-1,0);var ys;(function(i){i.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",i.IMAGE_DOWNSCALED="imageDownscaled"})(ys||(ys={}));var du=class extends Ri{constructor(t,e){super();this.image=t,this.options=e}needsResize(){let t=this.resizedDimensions();return t.x<this.image.width||t.y<this.image.height}resizedDimensions(){let{options:t}=this,e={width:this.image.width,height:this.image.height},r=R.fromSize(e),o=R.fromSize(e),{maxMegaPixels:s}=t;if(s){let l=(Gy()?s.mobile:s.desktop)*1e6,c=e.width/e.height,d=e.height/e.width,u=new R(Math.floor(Math.sqrt(l*c)),Math.floor(Math.sqrt(l*d)));u.x<=e.width&&u.y<=e.height&&(r=u)}let n=t.maxDimensions;n&&(n.height<e.height||n.width<e.width)&&(o=new R(n.width,n.height));let a=new R(Math.min(r.x,o.x),Math.min(r.y,o.y));return R.proportionalFit(a,R.fromSize(e)).floored}downscaleIfNecessary(){let t=this.resizedDimensions();if(!(t.x<this.image.width||t.y<this.image.height))return this.image;this.emit(ys.BEGAN_IMAGE_DOWNSCALING,this.image);let r=document.createElement("canvas");r.width=t.x,r.height=t.y;let o=r.getContext("2d"),{image:s}=this;return o.imageSmoothingQuality="high",o.drawImage(s,0,0,s.width,s.height,0,0,t.x,t.y),this.emit(ys.IMAGE_DOWNSCALED,{width:t.x,height:t.y}),r}downscaleImageIfNecessary(){let t=this.image,e=this.resizedDimensions();if(!(e.x<this.image.width||e.y<this.image.height))return t;this.emit(ys.BEGAN_IMAGE_DOWNSCALING,t);let o=new Image;return o.width=e.x,o.height=e.y,o.src=t.src,this.emit(ys.IMAGE_DOWNSCALED,{width:e.x,height:e.y}),o}};var m4=i=>i.key==="Enter",p4=i=>i.key==="Escape",Nw=i=>t=>{m4(t)&&i(t)},Hw=i=>t=>{p4(t)&&i(t)};var fh;(function(i){i[i.EditorContainer=0]="EditorContainer",i[i.ToolControlBar=1]="ToolControlBar",i[i.ToolControlBarControls=2]="ToolControlBarControls",i[i.CanvasContainer=3]="CanvasContainer",i[i.Canvas=4]="Canvas",i[i.MainBarButtonClose=5]="MainBarButtonClose",i[i.MainBarButtonExport=6]="MainBarButtonExport",i[i.MainBarButtonUndo=7]="MainBarButtonUndo",i[i.MainBarButtonRedo=8]="MainBarButtonRedo",i[i.MainBarButtonZoom=9]="MainBarButtonZoom",i[i.Tooltip=10]="Tooltip",i[i.Cursor=11]="Cursor",i[i.CursorContainer=12]="CursorContainer",i[i.NummericInput=13]="NummericInput",i[i.BrushSize=14]="BrushSize",i[i.BrushHardness=15]="BrushHardness",i[i.Dialog=16]="Dialog",i[i.DialogBody=17]="DialogBody",i[i.CardContainer=18]="CardContainer",i[i.CategoryItemsContainer=19]="CategoryItemsContainer",i[i.ToolbarItem=20]="ToolbarItem",i[i.ColorList=21]="ColorList",i[i.NoResult=22]="NoResult",i[i.CardLabel=23]="CardLabel",i[i.CardAvatar=24]="CardAvatar",i[i.Dropdown=25]="Dropdown",i[i.DropdownList=26]="DropdownList",i[i.TextAlignment=27]="TextAlignment",i[i.Sprite=28]="Sprite",i[i.SpriteTopLeft=29]="SpriteTopLeft",i[i.SpriteTopRight=30]="SpriteTopRight",i[i.SpriteBottomLeft=31]="SpriteBottomLeft",i[i.SpriteBottomRight=32]="SpriteBottomRight",i[i.Knob=33]="Knob",i[i.TextWidth=34]="TextWidth",i[i.ToolbarWrapper=35]="ToolbarWrapper",i[i.MainCanvasActionBar=36]="MainCanvasActionBar",i[i.SpriteActions=37]="SpriteActions",i[i.CarouselSlider=38]="CarouselSlider",i[i.CropMask=39]="CropMask",i[i.FlipRotateControls=40]="FlipRotateControls",i[i.RotateSlider=41]="RotateSlider",i[i.CropTopRight=42]="CropTopRight",i[i.CropTopLeft=43]="CropTopLeft",i[i.CropBottomRight=44]="CropBottomRight",i[i.CropBottomLeft=45]="CropBottomLeft",i[i.Watermark=46]="Watermark",i[i.Toolbar=47]="Toolbar",i[i.CanvasBar=48]="CanvasBar",i[i.Checkbox=49]="Checkbox",i[i.Focus=50]="Focus",i[i.SnappingLine=51]="SnappingLine"})(fh||(fh={}));var Ww={};for(let i in fh){let t=fh[i];typeof t=="string"&&(Ww[t]=t)}var H=Ww,Gw,hK=Boolean((Gw=window.Cypress)==null?void 0:Gw.env("pesdk"));function h4(i,t){let e=0;for(let r=i.length-1;r>=0;r--){let o=i[r];o==="."?i.splice(r,1):o===".."?(i.splice(r,1),e++):e&&(i.splice(r,1),e--)}if(t)for(;e--;e)i.unshift("..");return i}function f4(i){return i.charAt(0)==="/"}function g4(i){let t=f4(i),e=i.substr(-1)==="/";return i=h4(i.split("/").filter(Boolean),!t).join("/"),!i&&!t&&(i="."),i&&e&&(i+="/"),(t?"/":"")+i}var Vy=(...i)=>g4(i.join("/"));var jy=(i,t,[e,r],o=0)=>{let s=i[t];if(s){if(s<e)return console.error(`${t} must be greater than or equal to ${e}`),e;if(s>r)return console.error(`${t} must be less than or equal to ${r}`),r}return s||o},jr=(i,t,e=[1,1,1,1])=>{let r=i[t],o=!0;return r&&r.forEach(s=>{s<0&&(console.error(`${s} in ${t} must be greater than or equal to 0`),o=!1),s>1&&(console.error(`${s} in ${t} must be less than or equal to 1`),o=!1)}),o&&r||e};var At=i=>i*.08,gh=i=>i*.03;var b4={italic:"i"},uu=class{constructor(t){this.assetManager=t;this.injectedFonts={};this.loadedFonts={};this.getGoogleFamiliesString=t=>{let e=t.reduce((r,o)=>{let{fontFamily:s,fontStyle:n,fontWeight:a=400}=o;return r[s]=(r[s]||[]).concat(`${a}${b4[n]||""}`),r},{});return Object.keys(e).map(r=>{let o=e[r].length?`:${e[r].join(",")}`:"";return r.replace(" ","+")+o}).join("|")}}static createFontFacesCSS(t,e){return t.map(r=>{let o=e(r.fontURI);return`@font-face {
        font-family: "${r.fontFamily}";
        src: url('${o}') format('${r.format||"woff"}');
        font-weight: ${r.fontWeight||"normal"};
        font-style: ${r.fontStyle||"normal"};
      }`})}getFontWithId(t){let e=this.assetManager.getFontAsset(t);if(!e)throw new Error("The requested font does not exist as an asset.");return e}isFontLoaded(t){return this.loadedFonts[t]!==void 0}injectAllFonts(){let t=this.assetManager.getFontAssets();this.injectFonts(t)}loadAllFonts(){return K(this,null,function*(){let t=this.assetManager.getFontAssets();return this.loadFonts(t)})}loadFontsWithIdentifiers(t){return K(this,null,function*(){let e=t.map(r=>this.getFontWithId(r));return this.loadFonts(e)})}loadFonts(t){return K(this,null,function*(){this.injectFonts(t);let e=new Array;return t.forEach(r=>{e.push(this.loadFont(r,!1))}),new Promise((r,o)=>{Promise.all(e).then(()=>r()).catch(s=>o(s))})})}loadFont(t,e=!0){return K(this,null,function*(){return new Promise((r,o)=>{this.isFontLoaded(t.identifier)&&r(),e&&this.injectFonts([t]),new En(t).load().then(()=>{this.loadedFonts[t.identifier]=t,r()}).catch(()=>{o(t.identifier)})})})}loadFontWithIdentifier(t,e=!0){return K(this,null,function*(){let r=this.assetManager.getFontAsset(t);if(!r)throw new Error(`The requested font asset with identifier ${t} does not exist!`);return this.loadFont(r,e)})}injectFonts(t,e=this.assetManager.getPathForCategory("font")){let r=t.filter(nh),o=t.filter(sh);r.length>0&&this.addGoogleFontLinks(r),o.length>0&&this.addWebFontCSS(o,e)}addGoogleFontLinks(t){let e=t.filter(n=>!this.injectedFonts[n.identifier]);if(e.length===0)return;let r=this.getGoogleFamiliesString(e),o=document.createElement("link");o.rel="stylesheet",o.href=`https://fonts.googleapis.com/css?family=${r}`,document.getElementsByTagName("head")[0].appendChild(o),t.forEach(n=>{this.injectedFonts[n.identifier]=n})}addWebFontCSS(t,e){let r=t.filter(a=>!this.injectedFonts[a.identifier]);if(r.length===0)return;let s=`
      /* Injected by PhotoEditorSDK */
      ${uu.createFontFacesCSS(r,e).join(`
`)}
    `,n=document.createElement("style");n.innerHTML=s,document.head.appendChild(n),t.forEach(a=>{this.injectedFonts[a.identifier]=a})}};var mu=class{constructor(t,e=!1){this.basePath="assets/";this.areCustomAssetsAllowed=!1;this.getAssets=t=>{switch(t){case"overlay":return this.overlayAssets;case"filter":return this.filterCategories;case"font":return this.fontAssets;case"focus":return this.focusAssets;case"adjustment":return this.adjustmentCategories;case"sticker":return this.stickerCategories;case"textdesign":return this.textDesignAssets;case"frame":return this.frameAssets;case"transform":return this.transformCategories}return[]};this.getPath=(t,...e)=>{if(e.length===1&&e[0].match(/(ftp|http|https):\/\//)&&Dn(e[0]))return e[0];let r=Vy(t,...e);if((!e||e.length===0)&&Dn(t))return t;if(this.basePath.match(/(ftp|http|https):\/\//)){let{length:o}=this.basePath;return this.basePath[o-1]!=="/"&&(this.basePath=`${this.basePath}/`),this.basePath+r}return Vy(this.basePath,r)};this.getPathForCategory=t=>(...e)=>this.getPath(t,...e);this.addCustomStickerAsset=(t,e,r)=>{t.forEach(o=>{let{thumbnailURI:s,name:n,stickerURI:a,identifier:l,tintMode:c,resizeMode:d}=o,u=this.stickerCategories.find(p=>p.identifier===e),m={identifier:l,name:n,thumbnailURI:s,stickerURI:a,tintMode:c,resizeMode:d};if(u)u.items.push(m);else{let p={identifier:e,name:r,thumbnailURI:s,items:[m]};this.stickerCategories=[p,...this.stickerCategories]}}),this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[])};this.getItemPath=(t,e,r)=>{let o=t.find(s=>s.identifier===e);return o&&(o[r]||o.path)||""};this.isNonExistingFont=t=>!ch.find(e=>e.identifier===t.identifier)&&!_s[t.identifier];this.replaceDeprecatedFont=t=>_s[t.identifier]?ch.find(e=>e.identifier===In(t.identifier,!0)):t;t&&t.basePath&&(this.basePath=t.basePath),this.areCustomAssetsAllowed=e;let r=lh.reduce(this.allOptions,[]);t&&t.filter?this.filterCategories=this.configuredCategory(lh,t.filter,r):this.filterCategories=lh,this.lutFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(d=>oh(d)),this.duoToneFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(d=>La(d));let o=ah.reduce(this.allOptions,[]);t&&t.adjustment?this.adjustmentCategories=this.configuredCategory(ah,t.adjustment,o):this.adjustmentCategories=ah,this.fontAssets=ch.reduce(this.allOptions,[]);let s=Mw.map(d=>this.getFontAsset(d));if(t&&t.text&&t.text.fonts&&t.text.fonts.length>0){let d=t.text.fonts.filter(this.isNonExistingFont),u=t.text.fonts.filter(m=>!this.isNonExistingFont(m)).map(m=>this.replaceDeprecatedFont(m)).map(m=>this.getFontAsset(m.identifier));s=t.text.fonts?[...u,...d]:s,this.fontAssets=t.text.fonts?[...this.fontAssets,...d]:this.fontAssets}this.textToolFontAssets=s;let n=t&&t.focus&&t.focus.items&&t.focus.items.length?t.focus.items.map(d=>Wy.find(u=>u.identifier===d.identifier)):Wy;this.focusAssets=n,t&&t.overlay&&t.overlay.items?this.overlayAssets=this.configuredItem(t.overlay.items,uh,uh):this.overlayAssets=uh,t&&t.frame&&t.frame.items?this.frameAssets=this.configuredItem(t.frame.items,dh,dh):this.frameAssets=dh;let a=mh.reduce(this.allOptions,[]);t&&t.sticker?this.stickerCategories=this.configuredCategory(mh,t.sticker,a):this.stickerCategories=mh,this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[]);let l=zw;t&&t.theme==="light"&&(l=Uw),this.textDesignAssets=t&&t.textdesign&&t.textdesign.items&&t.textdesign.items.length?t.textdesign.items.map(d=>l.find(u=>u.identifier===d.identifier)):l,this.textDesignToolFontAssets=Lw.map(d=>this.getFontAsset(d));let c=ph.reduce(this.allOptions,[]);t&&t.transform?this.transformCategories=this.configuredCategory(ph,t.transform,c):this.transformCategories=ph,this.transformAssets=this.transformCategories.reduce(this.allOptions,[]),this.fontManager=new uu(this)}getFontManager(){return this.fontManager}getAssetSource(t,e){switch(t){case"filter":if(this.getLUTFilterAsset(e))return this.getPath(t,this.getItemPath(this.lutFilterAssets,e,"lutURI"));break;case"overlay":return this.getPath(t,this.getItemPath(this.overlayAssets,e,"overlayURI"));case"font":return this.getPath(t,this.getItemPath(this.fontAssets,e,"fontURI"));case"sticker":let o=this.stickerAssets.find(s=>s.identifier===e);if(o){if(o.stickerURI.substr(0,10)==="data:image")return o.stickerURI;if(e.includes("imgly_sticker")&&o.stickerURI.includes(".svg")&&Se()){let n=this.getPath(t,this.getItemPath(this.stickerAssets,e,"stickerURI")).split("/");return n.splice(n.length-1,0,"base"),n[n.length-1]=n[n.length-1].replace(".svg",".png"),n.join("/")}return this.getPath(t,this.getItemPath(this.stickerAssets,e,"stickerURI"))}throw new Error("Cannot resolve this type of sticker asset yet");case"textdesign":return this.getPath(t,"engine",e);case"frame":return this.getPath(t,e)}throw new Error("Cannot resolve this type of asset yet")}getDuotoneFilterAsset(t){return this.duoToneFilterAssets.filter(e=>e.identifier===t)[0]}getLUTFilterAsset(t){return this.lutFilterAssets.filter(e=>e.identifier===t)[0]}getOverlayAsset(t){return this.overlayAssets.filter(e=>e.identifier===t)[0]}getStickerAsset(t){return this.stickerAssets.filter(e=>e.identifier===t)[0]}getFontAsset(t){return this.fontAssets.filter(e=>e.identifier===t)[0]}getTextDesignAssets(t){return this.textDesignAssets.filter(e=>e.identifier===t)[0]}getFrameAsset(t){return this.frameAssets.filter(e=>e.identifier===t)[0]}getFontAssets(){return this.fontAssets}getFontAssetsForText(){return this.textToolFontAssets}getFontAssetsForTextDesign(){return this.textDesignToolFontAssets}getFrameAssets(){return this.frameAssets}allOptions(t,e){return Object.prototype.hasOwnProperty.call(e,"items")?[...t,...e.items]:[...t,e]}configuredCategory(t,e,r){return e.categories&&e.categories.length?e.categories.reduce((o,s)=>{let n=t.find(a=>a.identifier===s.identifier);return n?o.push(b(b(b({},n),s),{items:this.configuredItem(s.items,r,n.items).filter(Boolean)})):this.areCustomAssetsAllowed&&o.push(b(b({},s),{items:this.configuredItem(s.items,r,s.items).filter(Boolean)})),o},[]):t}configuredItem(t,e,r){return t&&t.length?t.reduce((o,s)=>{let n=e.find(a=>a.identifier===s.identifier);return n?o.push(b(b({},n),s)):this.areCustomAssetsAllowed&&o.push(s),o},[]).filter(Boolean):r}};var $y=class{static contains(t,e){return e.x>=t.minX&&e.x<=t.maxX&&e.y>=t.minY&&e.y<=t.maxY}constructor(t,e,r,o){if(typeof t=="number")if(typeof e=="number"&&r!==void 0&&o!==void 0)this.origin={x:t,y:e},this.size={width:r||0,height:o||0};else throw new Error("Invalid arguments passed to Rect. Expected (number, number, number, number)");else{if(this.origin=t,typeof e=="number")throw new Error("Invalid arguments passed to Rect. Expected (Float2, Size)");this.size=e}}get minX(){return this.origin.x}get minY(){return this.origin.y}get midX(){return this.origin.x+.5*this.size.width}get midY(){return this.origin.y+.5*this.size.height}get maxX(){return this.origin.x+this.size.width}get maxY(){return this.origin.y+this.size.height}get width(){return this.size.width}get height(){return this.size.height}},ze=$y;ze.ZERO=new $y({x:0,y:0},{width:0,height:0});var xs=class{constructor(t,e,r,o,s,n){this.a=t;this.b=e;this.c=r;this.d=o;this.tx=s;this.ty=n}static fromScale(t,e){return new xs(t,0,0,e,0,0)}static fromRotation(t){let e=Math.cos(t),r=Math.sin(t);return new xs(e,-r,r,e,0,0)}static fromRotationDeg(t){let e=Math.PI*t/180;return this.fromRotation(e)}static fromTranslation(t,e){return new xs(1,0,0,1,t,e)}static fromTRS(t,e,r,o,s){let n=Math.cos(r),a=Math.sin(r);return new xs(o*n,-s*a,o*a,s*n,t,e)}static multiply(t,e){let r=t.a*e.a+t.b*e.c,o=t.a*e.b+t.b*e.d,s=t.c*e.a+t.d*e.c,n=t.c*e.b+t.d*e.d,a=t.a*e.tx+t.b*e.ty+t.tx,l=t.c*e.tx+t.d*e.ty+t.ty;return new xs(r,o,s,n,a,l)}static transformPoint(t,e){return{x:t.a*e.x+t.b*e.y+t.tx,y:t.c*e.x+t.d*e.y+t.ty}}static getInverted(t){let e=t.a*t.d-t.b*t.c;if(e===0)return t;let r=1/e,o=r*t.d,s=-r*t.b,n=-r*t.c,a=r*t.a,l=r*(t.b*t.ty-t.d*t.tx),c=r*(t.c*t.tx-t.a*t.ty);return new xs(o,s,n,a,l,c)}},It=xs;It.IDENTITY=xs.fromScale(1,1);function Tr(i){return typeof i=="number"}var qt=class{static get IDENTITY(){return new qt({x:0,y:0})}constructor(t,e={x:1,y:1},r=0){this.position=t,this.scale=e,this.rotation=r}};var _4=jw.default.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  background: ${i=>i.theme.background};
  color: ${i=>i.theme.foreground};
  display: flex;
  flex-direction: row;
  overflow: hidden;
  -webkit-touch-callout: none;
  user-select: none;
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;
    /* css reset for a global box-sizing: border-box */
    box-sizing: content-box;
    /* todo: fix the issue with these settings */
    font-size: inherit;
    color: inherit;
    line-height: normal;

    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.2) transparent;

    &::-webkit-scrollbar-track {
      border-radius: 10px;
      background-color: transparent;
      margin: 1px;
    }

    &::-webkit-scrollbar {
      width: 6px;
      height: 6px;
      background-color: transparent;
    }

    &::-webkit-scrollbar-thumb {
      border-radius: 10px;
      box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.4);
      background-color: rgba(255, 255, 255, 0.2);
    }

    &::-webkit-scrollbar-thumb:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }
  }
`,Yy=class extends An.default.Component{constructor(t){super(t);this.node=An.default.createRef();this.saveEditorDimensions=t=>{this.setState({contextValue:{element:t,rect:t.getBoundingClientRect()}})};var e;if((e=An.default)==null?void 0:e.version){let r=Number.parseInt(An.default.version.split(".")[0],10),o=Number.parseInt(An.default.version.split(".")[1],10);(r<16||r===16&&o<8)&&console.error("Please be aware that the PhotoEditorSDK will require React 16.8.6 or above.")}this.saveEditorDimensions=Vw.default(this.saveEditorDimensions,100),this.resizeObserver=new Xd(([r])=>{this.saveEditorDimensions(r.target)}),this.state={contextValue:{element:null,rect:null}}}componentDidMount(){var t;((t=this.node)==null?void 0:t.current)&&this.resizeObserver.observe(this.node.current)}componentWillUnmount(){var t;((t=this.node)==null?void 0:t.current)&&this.resizeObserver.unobserve(this.node.current)}render(){let{children:t}=this.props,{contextValue:e}=this.state;return An.default.createElement(_4,{ref:this.node,"data-test":H.EditorContainer},An.default.createElement(eh.Provider,{value:e},t))}};var fu=y(require("react"));var za=y(require("react")),hu=y(require("styled-components"));var bh=y(require("styled-components")),pu=bh.css`
  position: absolute;
  top: 0;
  left: 0;
  height: ${i=>i.theme.measurements.colorItem.size}px;
  width: ${i=>i.theme.measurements.colorItem.size}px;
  border-radius: ${i=>i.theme.colorItem.borderRadius||`${i.theme.shape.radiusSmall}px`};
  pointer-events: none;
`,y4=bh.default.div.attrs(i=>({style:{background:i.color}}))`
  ${pu}
  z-index: ${i=>i.theme.measurements.zIndex.colorItem.background};
`,_h=y4;var x4=hu.default.div`
  ${pu}
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: ${i=>i.theme.measurements.zIndex.colorItem.overlay};

  box-sizing: border-box;
  border: 2px solid transparent;
  border-radius: ${i=>i.theme.colorItem.borderRadius||`${i.theme.shape.radiusSmall}px`};
  transition: border-color 300ms ease-in-out;
  ${i=>i.isActive&&hu.css`
      border-color: ${i.theme.selectColor.activeBorderColor};
    `}
`,Ky=hu.default.span`
  display: inline-block;
  height: 2px;
  width: 2px;
  border-radius: 50%;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.6);
  background: rgba(255, 255, 255, 0.87);
  margin: 1px;
  pointer-events: none;
`,v4=({isActive:i,className:t,style:e})=>za.default.createElement(x4,{isActive:i,className:t,style:e},i&&za.default.createElement(za.default.Fragment,null,za.default.createElement(Ky,null),za.default.createElement(Ky,null),za.default.createElement(Ky,null))),yh=v4;var Kw=y(require("styled-components"));var $w=y(require("styled-components")),Ze=$w.css`
  &:focus {
    outline: none;
    box-shadow: 0 0 2px ${i=>i.theme.focusOutlineColor};
  }
  &:-moz-focusring {
    outline: none;
    box-shadow: 0 0 2px ${i=>i.theme.focusOutlineColor};
  }
`;var Yw=y(require("styled-components")),tc=Yw.css`
  position: absolute !important;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
  clip: rect(1px, 1px, 1px, 1px);
`;var C4=Kw.default.button.attrs({type:"button"})`
  &&& {
    box-sizing: border-box;
  }
  position: relative;
  background: transparent;
  border: none;
  height: ${i=>i.theme.measurements.colorItem.size}px;
  width: ${i=>i.theme.measurements.colorItem.size}px;
  margin: ${i=>i.theme.colorItem.margin};
  padding: 0;
  cursor: pointer;
  border-radius: ${i=>i.theme.colorItem.borderRadius||`${i.theme.shape.radiusSmall}px`};

  &:hover {
    opacity: 0.7;
  }

  ${Ze}

  &:disabled {
    opacity: ${i=>i.theme.selectColor.inactiveOpacity};
    cursor: default;
  }
`,xh=C4;var Xw=y(require("styled-components"));var S4=Xw.default.div.attrs(i=>({style:i.url?{backgroundImage:`url(${i.url})`}:{}}))`
  ${pu}
  z-index: ${i=>i.theme.measurements.zIndex.colorItem.tiledBackground};
`,vh=S4;var w4=({isActive:i,onClick:t,color:e,label:r,isDisabled:o,tiledBackgroundUrl:s,className:n,style:a,children:l})=>fu.default.createElement(xh,{disabled:o,onClick:t,"aria-label":r,className:n,style:a},fu.default.createElement(vh,{url:s}),fu.default.createElement(_h,{color:e}),fu.default.createElement(yh,{isActive:i}),l),qw=P("config")(O(w4));var Th=y(require("react"));var Zw=y(require("styled-components")),k4=Zw.default.div`
  display: block;
  opacity: 1;
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: ${i=>i.theme.measurements.zIndex.dialog.backdrop};
  text-align: left;
  background: ${i=>i.theme.modal.backdrop};
  height: 100%;
  width: 100%;
`,Ch=k4;var Jw=y(require("react")),Sh=y(require("styled-components")),T4=Sh.default.div`
  display: none;
  visibility: hidden;
  opacity: 0;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${i=>i.theme.measurements.zIndex.dialog.base};
  transition: opacity 100s ease-in-out;

  ${i=>i.isVisible&&Sh.css`
      opacity: 1;
      display: block;
      visibility: visible;
    `};
`,wh=({isVisible:i,className:t,children:e})=>Jw.default.createElement(T4,{isVisible:i,className:t},e);var Qw=y(require("styled-components")),D4=Qw.default.div.attrs(({style:i})=>({role:"dialog","aria-hidden":!1,style:i}))`
  display: flex;
  flex: 0 0 auto;
  flex-direction: column;
  transition: top 0.25s ease;
  position: absolute;
  top: calc(50% + ${i=>i.top}px);
  left: calc(50% + ${i=>i.left}px);
  width: ${i=>i.width};
  height: ${i=>i.height};
  transform: translate(-50%, -50%);
  border-radius: ${i=>i.theme.shape.radiusLarge}px;
  background: ${i=>i.theme.modal.background};
  color: ${i=>i.theme.modal.bodyForeground};
  z-index: ${i=>i.theme.measurements.zIndex.dialog.container};

  @media all and (min-width: 0) and (max-width: 640px) {
    text-align: center;
    width: auto;
    min-width: 200px;
    height: auto;
    top: 50%;
    left: 50%;
  }
`,kh=D4;var I4=({isVisible:i=!1,width:t="350px",height:e="fit-content",position:r,header:o,body:s,footer:n,className:a,style:l,children:c})=>Th.default.createElement(wh,{isVisible:i},Th.default.createElement(Ch,null),Th.default.createElement(kh,{height:e,width:t,left:r.x,top:r.y,className:a,style:l,"data-test":H.Dialog},o,s,c,n)),tk=I4;var ek=y(require("styled-components")),E4=ek.default.div`
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-sizing: border-box;
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  color: ${i=>i.theme.modal.bodyForeground};

  padding: 0px 20px 11px;
  &:first-child {
    padding-top: 11px;
  }

  @media all and (min-width: 0) and (max-width: 640px) {
    align-items: center;
  }
`,vs=E4;var ik=y(require("styled-components")),A4=ik.default.div`
  display: flex;
  border-top: 2px solid
    ${i=>i.type==="error"?i.theme.error:i.theme.warning};

  min-height: 40px;
  justify-content: flex-end;
  @media all and (min-width: 0) and (max-width: 640px) {
    height: auto;
    flex-direction: column;
    justify-content: space-around;
  }
`,ec=A4;var rk=y(require("styled-components")),F4=rk.default.h3`
  font-size: ${i=>i.theme.measurements.fontSystem.headline2.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.headline2.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.headline2.case};
  color: ${i=>i.theme.modal.headerForeground};

  padding: 11px 20px 0px;
`,ic=F4;var rc=y(require("react")),gu=y(require("styled-components")),O4=gu.keyframes`
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
`,R4=gu.default.div`
  display: inline-block;
  position: relative;
  width: 45px;
  height: 45px;
`,Dh=gu.default.div`
  box-sizing: border-box;
  display: block;
  position: absolute;
  width: 40px;
  height: 40px;
  margin: 2.5px;
  border: 2.5px solid ${i=>i.theme.primary};
  border-radius: 50%;
  animation: ${O4} 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
  border-color: ${i=>i.theme.primary} transparent transparent
    transparent;

  :nth-child(1) {
    animation-delay: -0.45s;
  }
  :nth-child(2) {
    animation-delay: -0.3s;
  }
  :nth-child(3) {
    animation-delay: -0.15s;
  }
`,P4=({className:i,style:t})=>rc.default.createElement(R4,{className:i,style:t},rc.default.createElement(Dh,null),rc.default.createElement(Dh,null),rc.default.createElement(Dh,null),rc.default.createElement(Dh,null)),Ih=P4;var bu=y(require("react"));var Bh=y(require("react")),Mh=y(require("react-dom"));var Xy=["Moz","Webkit","O","ms"];function B4(i){let t="",e=!0,r;for(r=0;r<i.length;r+=1)e?(t+=i[r].toUpperCase(),e=!1):i[r]==="-"?e=!0:t+=i[r];return t}function qy(i,t){return t?`${t}${B4(i)}`:i}function M4(i="transform"){if(typeof window=="undefined"||typeof window.document=="undefined")return"";let{style:t}=window.document.documentElement;if(i in t)return"";let e;for(e=0;e<Xy.length;e+=1)if(qy(i,Xy[e])in t)return Xy[e];return""}var ok=M4();function Eh(i,t){for(let e=0,{length:r}=i;e<r;e+=1)if(t.apply(t,[i[e],e,i]))return i[e];return null}function Zy(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Function]"}function oc(i){return typeof i=="number"&&!Number.isNaN(i)}function Je(i){return parseInt(i,10)}var Ah="";function L4(i,t){return Ah||(Ah=Eh(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],e=>Zy(i[e]))),Zy(i[Ah])?i[Ah](t):!1}function Jy(i,t,e){let r=i;do{if(L4(r,t))return!0;if(r===e)return!1;r=r.parentNode}while(r);return!1}function Fh(i,t,e){!i||(i.attachEvent?i.attachEvent(`on${t}`,e):i.addEventListener?i.addEventListener(t,e,!0):i[`on${t}`]=e)}function Fn(i,t,e){!i||(i.detachEvent?i.detachEvent(`on${t}`,e):i.removeEventListener?i.removeEventListener(t,e,!0):i[`on${t}`]=null)}function sk(i){let t=i.clientHeight,e=i.ownerDocument.defaultView.getComputedStyle(i);return t+=Je(e.borderTopWidth),t+=Je(e.borderBottomWidth),t}function nk(i){let t=i.clientWidth,e=i.ownerDocument.defaultView.getComputedStyle(i);return t+=Je(e.borderLeftWidth),t+=Je(e.borderRightWidth),t}function ak(i){let t=i.clientHeight,e=i.ownerDocument.defaultView.getComputedStyle(i);return t-=Je(e.paddingTop),t-=Je(e.paddingBottom),t}function lk(i){let t=i.clientWidth,e=i.ownerDocument.defaultView.getComputedStyle(i);return t-=Je(e.paddingLeft),t-=Je(e.paddingRight),t}function ck(i,t){let r=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect(),o=i.clientX+t.scrollLeft-r.left,s=i.clientY+t.scrollTop-r.top;return{x:o,y:s}}function dk({x:i,y:t,rotation:e}){let r=`translate(${i}px,${t}px) rotate(${e}rad)`;return{[qy("transform",ok)]:r}}function uk(i,t){let e=null;return i.targetTouches&&(e=Eh(i.targetTouches,r=>t===r.identifier)),i.changedTouches&&!e&&(e=Eh(i.changedTouches,r=>t===r.identifier)),e}function mk(i){return i.targetTouches&&i.targetTouches[0]?i.targetTouches[0].identifier:i.changedTouches&&i.changedTouches[0]?i.changedTouches[0].identifier:null}var pk=y(require("react-dom"));function Qy(i){let t=pk.default.findDOMNode(i);if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}function hk(i,t,e){if(!i.props.bounds)return[t,e];let{bounds:r}=i.props;r=typeof r=="string"?r:b({},r);let o=Qy(i);if(typeof r=="string"){let{ownerDocument:s}=o,n=s.defaultView,a=r==="parent"?o.parentNode:s.querySelector(r);if(!(a instanceof HTMLElement))throw new Error(`Bounds selector "${r}" could not find an element.`);if(o instanceof HTMLElement){let l=n.getComputedStyle(o),c=n.getComputedStyle(a);r={left:-o.offsetLeft+Je(c.paddingLeft)+Je(l.marginLeft),top:-o.offsetTop+Je(c.paddingTop)+Je(l.marginTop),right:lk(a)-nk(o)-o.offsetLeft+Je(c.paddingRight)-Je(l.marginRight),bottom:ak(a)-sk(o)-o.offsetTop+Je(c.paddingBottom)-Je(l.marginBottom)}}}return r=r,oc(r.right)&&(t=Math.min(t,r.right)),oc(r.bottom)&&(e=Math.min(e,r.bottom)),oc(r.left)&&(t=Math.max(t,r.left)),oc(r.top)&&(e=Math.max(e,r.top)),[t,e]}function Oh(i,t,e){let{state:r}=i,o=!oc(r.lastX),s=Qy(i);return o?{node:s,deltaX:0,deltaY:0,lastX:t,lastY:e,x:t,y:e}:{node:s,deltaX:t-r.lastX,deltaY:e-r.lastY,lastX:r.lastX,lastY:r.lastY,x:t,y:e}}function Rh(i,t){return{node:t.node,x:i.state.x+t.deltaX,y:i.state.y+t.deltaY,deltaX:t.deltaX,deltaY:t.deltaY,lastX:i.state.x,lastY:i.state.y}}function fk(i){return i.props.axis==="both"||i.props.axis==="x"}function gk(i){return i.props.axis==="both"||i.props.axis==="y"}function Ph(i,t){let e=Qy(t),{offsetParent:r}=t.props;return!r&&e instanceof HTMLElement&&(r=e.offsetParent||e.ownerDocument.body),ck(i,r)}var ko={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},rr=ko.mouse,tx={cancel:null,disabled:!1,offsetParent:null,handle:null,transform:null,onStart:()=>{},onDrag:()=>{},onStop:()=>{},onMouseDown:()=>{}},Ua=class extends Bh.default.Component{constructor(){super(...arguments);this.state={dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:void 0};this.getTouchFromEvent=t=>{let e=mk(t);return this.setState({touchIdentifier:e}),uk(t,e)};this.preventDefault=t=>{t.stopPropagation&&t.stopPropagation()};this.handleDragStart=t=>{let e=Mh.default.findDOMNode(this);if(!e||!e.ownerDocument||!e.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");let{ownerDocument:r}=e;if(this.props.disabled||!(t.target instanceof Node)||this.props.handle&&!Jy(t.target,this.props.handle,e)||this.props.cancel&&Jy(t.target,this.props.cancel,e))return!1;let o=Ph(t,this);if(o==null)return!1;let{x:s,y:n}=o,a=Oh(this,s,n);if(this.props.onStart(t,a)===!1)return!1;this.setState({dragging:!0,lastX:s,lastY:n}),rr.move==="touchmove"?Fh(r,rr.move,this.onTouchDrag):Fh(r,rr.move,this.onMouseDrag),Fh(r,rr.stop,this.handleDragStop)};this.handleDrag=t=>{let e=Ph(t,this);if(e==null)return;let{x:r,y:o}=e,s=Oh(this,r,o);if(this.props.onDrag(t,s)===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(a){let l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.setState({lastX:r,lastY:o})};this.handleDragStop=t=>{if(!this.state.dragging)return;let e=Ph(t,this);if(e==null)return;let{x:r,y:o}=e,s=Oh(this,r,o),n=Mh.default.findDOMNode(this);this.setState({dragging:!1,lastX:NaN,lastY:NaN}),this.props.onStop(t,s),n&&(rr.move==="touchmove"?Fn(n.ownerDocument,rr.move,this.onTouchDrag):Fn(n.ownerDocument,rr.move,this.onMouseDrag),Fn(n.ownerDocument,rr.stop,this.handleDragStop))};this.onMouseDown=t=>(this.preventDefault(t),rr=ko.mouse,this.props.onMouseDown(t),t.button&&typeof t.button=="number"&&t.button!==0?!1:this.handleDragStart(t));this.onMouseDrag=t=>(this.preventDefault(t),this.handleDrag(t));this.onMouseUp=t=>(this.preventDefault(t),rr=ko.mouse,this.handleDragStop(t));this.onTouchStart=t=>{this.preventDefault(t),rr=ko.touch;let e=this.getTouchFromEvent(t);return this.handleDragStart(e)};this.onTouchDrag=t=>{this.preventDefault(t),rr=ko.touch;let e=this.getTouchFromEvent(t);return this.handleDrag(e)};this.onTouchEnd=t=>{this.preventDefault(t),rr=ko.touch;let e=this.getTouchFromEvent(t);return this.handleDragStop(e)}}componentWillUnmount(){let t=Mh.default.findDOMNode(this);if(t){let{ownerDocument:e}=t;Fn(e,ko.mouse.move,this.onMouseDrag),Fn(e,ko.touch.move,this.onTouchDrag),Fn(e,ko.mouse.stop,this.handleDragStop),Fn(e,ko.touch.stop,this.handleDragStop)}}render(){return Bh.default.cloneElement(Bh.default.Children.only(this.props.children),{style:b({touchAction:"none"},this.props.children.props.style),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};Ua.defaultProps=tx,Ua.displayName="DraggableCore";var z4=b(b({},tx),{axis:"both",bounds:!1,defaultClassName:"draggable",defaultClassNameDragging:"draggable-dragging",defaultClassNameDragged:"draggable-dragged",defaultPosition:{x:0,y:0},position:null,rotation:0,updateOnPosition:!1}),Lh=class extends bu.default.Component{constructor(t){super(t);this.onDragStart=(t,e)=>{if(this.props.onStart(t,Rh(this,e))===!1)return!1;this.setState({dragging:!0,dragged:!0})};this.onDrag=(t,e)=>{let{position:r,defaultPosition:o,onDrag:s,bounds:n}=this.props;if(!this.state.dragging)return!1;let a=Rh(this,e),l=Boolean(r),c={x:l?a.x:o.x,y:l?a.y:o.y,slackX:0,slackY:0};if(n){let{x:u,y:m}=c;c.x+=this.state.slackX,c.y+=this.state.slackY;let[p,f]=hk(this,c.x,c.y);c.x=p,c.y=f,c.slackX=this.state.slackX+(u-c.x),c.slackY=this.state.slackY+(m-c.y),a.x=c.x,a.y=c.y,a.deltaX=c.x-this.state.x,a.deltaY=c.y-this.state.y}if(s(t,a)===!1)return!1;this.setState(c)};this.onDragStop=(t,e)=>{if(!this.state.dragging||this.props.onStop(t,Rh(this,e))===!1)return!1;let o={dragging:!1,slackX:0,slackY:0,x:0,y:0};if(Boolean(this.props.position)){let{x:n,y:a}=this.props.position;o.x=n,o.y=a}this.setState(o)};this.state={dragging:!1,dragged:!1,x:t.position?t.position.x:t.defaultPosition.x,y:t.position?t.position.y:t.defaultPosition.y,slackX:0,slackY:0}}componentDidUpdate(t){Boolean(this.props.position)&&(this.props.updateOnPosition?(t.position&&t.position.x!==this.props.position.x||t.position.y!==this.props.position.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}):(t.position&&this.props.position.x!==this.state.x||this.props.position.y!==this.state.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}))}componentWillUnmount(){this.setState({dragging:!1})}render(){let A=this.props,{position:t,defaultPosition:e,rotation:r,defaultClassName:o,defaultClassNameDragging:s,defaultClassNameDragged:n}=A,a=_i(A,["position","defaultPosition","rotation","defaultClassName","defaultClassNameDragging","defaultClassNameDragged"]),{x:l,y:c,dragging:d,dragged:u}=this.state,m={},f=!Boolean(t)||d,v=t||e,x={x:fk(this)&&f?l:v.x,y:gk(this)&&f?c:v.y,rotation:r};m=dk(x);let _=bu.default.Children.only(this.props.children),D=[_.props.className||"",o,d?s:"",u?n:""].join(" ").trim(),k=bu.default.cloneElement(_,{className:D,style:b(b({},_.props.style),m)});return bu.default.createElement(Ua,b(b({},a),{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),k)}};Lh.defaultProps=z4,Lh.displayName="Draggable";var bk=Lh;var Dr=y(require("react")),wk=y(Ck()),Ir=y(require("styled-components"));var ac=y(require("react")),Wh=y(require("styled-components"));var sc=y(require("styled-components"));var Uh=sc.default.span`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
`,ix=sc.default(Uh)``,yi=sc.default(Uh)``,nc=sc.default(Uh)``,Nh={display:"none",left:0,top:0},Hh=sc.default(Uh)`
  display: ${({display:i})=>i};
  left: ${({left:i})=>i}px;
  top: ${({top:i})=>i}px;
  pointer-events: none;
  border-radius: 50%;
  background-color: rgba(255, 255, 255, 0.12);
  animation: ${$p} 1.2s;
  width: 100px;
  height: 100px;
  margin-top: -50px;
  margin-left: -50px;
  opacity: 0;
`;var $r=Wh.css`
  color: ${i=>i.theme.button.activeForeground};
  border-color: ${i=>i.theme.button.activeForeground};
`,iL=Wh.default.button`
  &&& {
    box-sizing: border-box;
  }
  text-align: center;
  position: relative;
  padding: 4px 8px;
  min-height: 32px;
  border-radius: ${i=>i.theme.shape.radiusMedium}px;
  font-size: ${i=>i.theme.measurements.fontSystem.button1.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.button1.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.button1.case};
  font-family: ${i=>i.theme.typography.fontFamily}, sans-serif;
  cursor: pointer;
  border: none;
  background-color: transparent;
  overflow: hidden;
  ${Ze}

  /* Active */

  &:active {
    ${$r}
  }

  ${({isActive:i})=>i&&$r}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${yi} {
      background-color: ${i=>i.theme.button.outlinedInactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${nc} {
      background-color: ${i=>i.theme.button.hoverOverlayColor};
    }
  }
`,si=class extends ac.default.Component{constructor(){super(...arguments);this.state=Nh;this.timeout=null;this.onClick=t=>{let e=t.currentTarget.getBoundingClientRect(),r=t.pageX-e.left,o=t.pageY-e.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(r,o)}):this.setRippleState(r,o),this.props.onClick(t)};this.setRippleState=(t,e)=>{this.setState({left:t,top:e,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){let u=this.props,{isActive:t,isDisabled:e,label:r,ariaLabel:o,children:s,className:n}=u,a=_i(u,["isActive","isDisabled","label","ariaLabel","children","className"]),{left:l,top:c,display:d}=this.state;return ac.default.createElement(iL,b(b({"data-test":o,className:n,isActive:t,disabled:e,"aria-label":o},a),{onClick:this.onClick}),r,s,ac.default.createElement(Hh,{display:d,left:l,top:c}),ac.default.createElement(yi,null),ac.default.createElement(nc,null))}};si.defaultProps={type:"button",isDisabled:!1,isActive:!1};var Sk=y(require("react")),_u=y(require("styled-components"));var rL=_u.default.label`
  ${tc}
`,oL=_u.default.label`
  display: block;
  font-size: ${i=>i.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.label.case};
  color: ${i=>i.theme.toolControlBar.inputLabelForeground};
  margin: 0;
  padding-bottom: 8px;

  ${({isDisabled:i})=>i&&_u.css`
      opacity: ${t=>t.theme.toolControlBar.inputLabelInactiveOpacity};
      cursor: default;
      pointer-events: none;
    `}
`,ni=({label:i,htmlFor:t,show:e,style:r,isDisabled:o,className:s})=>{let n=e?oL:rL,a=t||(i?i.replace(" ","-"):void 0);return Sk.default.createElement(n,{style:r,isDisabled:o,htmlFor:a,className:s},i)};ni.defaultProps={show:!0};var sL=Ir.default.div`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
`,nL=Ir.default(ni)`
  align-self: flex-start;
`,kk=Ir.default(si)`
  color: ${i=>i.theme.button.textSecondaryForeground};
  padding: 1px 7px 2px;
`,aL=Ir.default.div`
  display: flex;
  justify-content: space-between;
  width: ${i=>i.theme.measurements.advancedUIToolControlBar.width-48}px;
`,lL=Ir.default.article`
  /* 0.6 of width here refers to the width of the container without padding */
  width: ${i=>.6*i.theme.measurements.advancedUIToolControlBar.width}px;
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  text-align: center;
  margin-top: 7px;
  display: inline-block;
  color: ${i=>i.theme.toolControlBar.inputLabelForeground};
`,cL=Ir.default.div`
  width: ${i=>.6*i.theme.measurements.advancedUIToolControlBar.width}px;
  transform: translateZ(0);
  overflow: hidden;
  transition: all 500ms ease-out;
`,dL=Ir.default.span`
  width: ${i=>Math.round(i.length*.6*i.theme.measurements.advancedUIToolControlBar.width)}px;
  margin-left: -${i=>i.activeIndex*.6*i.theme.measurements.advancedUIToolControlBar.width}px;
  position: relative;
  display: inline-block;
  transform: translateZ(0);
  transition: all 600ms cubic-bezier(0.77, 0, 0.175, 1);
  font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;
`,Tk=Ir.default.div`
  border: solid ${i=>i.theme.card.foreground};
  border-width: 0 2px 2px 0;
  padding: 3px;
  height: 0;
  width: 0;

  ${({direction:i})=>i==="left"?Ir.css`
          margin-left: 2px;
          transform: rotate(135deg);
        `:Ir.css`
          margin-right: 2px;
          transform: rotate(-45deg);
        `}
`,rx=class extends Dr.default.PureComponent{constructor(t){super(t);this.updateIndex=(t,e=!1)=>{let r=t+(e?-1:1),o=this.props.list.length-1;r>o&&(r=0),r<0&&(r=o),this.props.onSelect(this.props.list[r].identifier)};this.getActiveIndex=t=>{let{list:e}=this.props,r=e.findIndex(o=>o.identifier===t);return r!==-1?r:0};this.throttledUpdateIndex=wk.default(this.updateIndex,600)}render(){let{list:t,label:e,showLabel:r=!0}=this.props,o=this.getActiveIndex(this.props.defaultIdentifier),s=t.length<=1;return Dr.default.createElement(sL,{"data-test":H.CarouselSlider},Dr.default.createElement(nL,{show:r,label:e}),Dr.default.createElement(aL,{id:`photoeditorsdk-${e.replace(" ","-")}`},Dr.default.createElement(kk,{ariaLabel:"Select Previous",isDisabled:s,onClick:()=>this.throttledUpdateIndex(o,!0)},Dr.default.createElement(Tk,{direction:"left"})),Dr.default.createElement(cL,null,Dr.default.createElement(dL,{activeIndex:o,length:t.length},t.map(n=>Dr.default.createElement(lL,{key:n.identifier},n.value)))),Dr.default.createElement(kk,{ariaLabel:"Select Next",isDisabled:s,onClick:()=>this.throttledUpdateIndex(o)},Dr.default.createElement(Tk,{direction:"right"}))))}};rx.defaultProps={showLabel:!0};var Dk=rx;var lc=y(require("react"));var Ik=y(require("styled-components")),uL=Ik.default.div`
  display: flex;
  position: relative;
  margin-bottom: 12px;
  max-width: ${i=>i.theme.measurements.basicToolControlBar.maxWidth}px;
`,Gh=uL;var yu=y(require("styled-components"));var mL=yu.default.div.attrs({tabIndex:0})`
  position: relative;
  height: 16px;
  width: 16px;
  cursor: pointer;
  background-color: ${i=>i.theme.checkbox.background};
  border-radius: ${i=>i.theme.shape.radiusSmall}px;
  transition-timing-function: ease-in;
  transition-duration: 0.3s;
  &::after {
    content: '';
    position: absolute;
    display: inline-block;
    left: 5px;
    width: 5px;
    height: 10px;
    border-style: solid;
    border-width: 0 2px 2px 0;
    border-color: transparent;
    transform: rotate(45deg) scale(0.8);
  }

  &:first-child {
    margin-right: 8px;
  }

  &:last-child {
    margin-left: 8px;
  }

  ${Ze}

  &:hover {
    opacity: ${i=>i.theme.checkbox.hoverOpacity};
  }
  ${i=>i.isChecked&&yu.css`
      background-color: ${i.theme.checkbox.activeBackground};
      &::after {
        color: ${i.theme.checkbox.activeForeground};
        border-color: ${i.theme.checkbox.foreground};
      }
      &:hover {
        background-color: ${i.theme.checkbox.activeBackground};
        opacity: 0.8;
      }
    `}
  ${i=>i.isDisabled&&yu.css`
      opacity: 0.5;
      cursor: default;
      pointer-events: none;
    `}
`,xu=mL;var Ek=y(require("styled-components"));var pL=Ek.default.input.attrs({type:"checkbox",tabIndex:0})`
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
  margin: 0;
  padding: 0;
  ${Ze}
`,Vh=pL;var Ak=({label:i,value:t,checkMarkPosition:e,onClick:r,isDisabled:o,className:s,style:n})=>{let a=`photoeditorsdk-${i.replace(" ","-")}`;return lc.default.createElement(Gh,{"data-test":H.Checkbox,className:s,style:n},e==="left"&&lc.default.createElement(xu,{onClick:r,isDisabled:o,isChecked:t}),lc.default.createElement(ni,{isDisabled:o,label:i,htmlFor:a}),lc.default.createElement(Vh,{id:a,disabled:o,checked:t,onChange:r}),e==="right"&&lc.default.createElement(xu,{onClick:r,isDisabled:o,isChecked:t}))},Fk=Ak;Ak.defaultProps={value:!1,checkMarkPosition:"left"};var Ok=y(require("styled-components")),Na=Ok.css`
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  width: 100%;
  min-height: 26px;
  color: ${i=>i.theme.textInput.foreground};
  padding-bottom: 7px;
  border: none;
  appearance: none;
  border-bottom: 1px solid ${i=>i.theme.textInput.borderColor};
  background: ${i=>i.theme.textInput.background};
  font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;
  transition: border-color 0.4s ease-in-out;

  &:focus {
    outline: none;
    border-color: ${i=>i.theme.textInput.hoverBorderColor};
  }

  &:-moz-focusring {
    outline: none;
    border-color: ${i=>i.theme.textInput.hoverBorderColor};
  }

  &:disabled {
    opacity: ${i=>i.theme.textInput.inactiveOpacity};
    pointer-events: none;
  }

  &:hover {
    border-color: ${i=>i.theme.textInput.hoverBorderColor};
  }

  &::-ms-clear,
  &::-ms-reveal {
    display: none;
  }

  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  &::-webkit-inner-spin-button,
  &::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
`;var Do=y(require("react")),nx=y(require("styled-components"));var jh=y(require("styled-components")),Rk=jh.css`
  opacity: ${i=>i.theme.dropdown.inactiveOpacity};
  pointer-events: none;
`,Pk=jh.default.div`
  display: block;
  position: relative;
  width: 100%;
  white-space: nowrap;
  transition-duration: 0.5s;

  &:disabled {
    ${Rk}
  }

  ${({isDisabled:i})=>i&&Rk}
`;var $h=y(require("styled-components"));var Bk=$h.default.li`
  padding: 10px 16px;
  text-overflow: ellipsis;
  font-size: ${i=>i.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.button2.case};
  white-space: nowrap;
  color: ${i=>i.theme.dropdown.foreground};

  &:hover {
    cursor: pointer;
    background: ${i=>i.theme.dropdown.listItemHoverBackground};
  }

  ${({isActive:i})=>i&&$h.css`
      border-left: 2px solid ${t=>t.theme.primary};
    `}

  ${Ze}
`;var vu=y(require("styled-components"));var ox=y(require("react")),To=y(require("styled-components"));var hL=To.default.div`
  display: flex;
  ${i=>Se()||kr()?To.css`
        overflow: hidden;
      `:i.direction==="vertical"?To.css`
        flex-direction: column;
        flex: 1 1 auto;
        overflow-y: auto;
        overflow-x: hidden;
      `:To.css`
      overflow-y: hidden;
      overflow-x: auto;
    `};
`,fL=To.default.ul.attrs(()=>({role:"menubar","aria-label":"Tool Navigation"}))`
  display: flex;
  flex-direction: ${i=>i.direction==="vertical"?"column":"row"};

  list-style: none;
  padding: 0;
  margin: 0;

  ${i=>Se()||kr()?To.css`
        width: 100%;
        height: 100%;

        ${()=>i.direction==="vertical"?To.css`
              overflow-y: auto;
              overflow-x: hidden;

              /* hidde the arrows */
              margin-top: -10px;
              margin-bottom: -10px;
              padding-top: 10px;
              padding-bottom: 10px;

              /* hide the scrollbar */
              padding-right: 10px;
              margin-right: -10px;
            `:To.css`
            overflow-y: hidden;
            overflow-x: auto;

            margin-right: -10px;
            margin-left: -10px;
            padding-right: 10px;
            padding-left: 10px;

            padding-bottom: 10px;
            margin-bottom: -10px;
          `}

        scrollbar-face-color: #454545;
        scrollbar-track-color: ${i.theme.toolbar.background};
        scrollbar-base-color: ${i.theme.toolbar.background};
        scrollbar-3dlight-color: #454545;
        scrollbar-highlight-color: #454545;
        scrollbar-arrow-color: ${i.theme.toolbar.background};
        scrollbar-shadow-color: #454545;
        scrollbar-dark-shadow-color: #454545;
      `:""}
`,Yr=({direction:i="horizontal","data-test":t,className:e,children:r})=>ox.default.createElement(hL,{direction:i,className:e},ox.default.createElement(fL,{direction:i,"data-test":t},r));var sx=vu.default(Yr)`
  position: absolute;

  background: ${i=>i.theme.dropdown.listBackground};
  color: ${i=>i.theme.dropdown.listForeground};
  border: 1px solid ${i=>i.theme.dropdown.listBorderColor};
  box-shadow: ${i=>i.theme.dropdown.listShadow};

  visibility: hidden;
  opacity: 0;
  ${i=>i.isOpen?vu.css`
        visibility: visible;
        opacity: 1;
        display: flex;
      `:""}

  transition: all 0.5s ease;

  width: 100%;
  max-height: 160px;
  margin: 5px 0;

  /* had to add these changes to get the dropdown working in IE11 */
  ${()=>Se()?vu.css`
        > ul {
          height: 160px;
          margin-bottom: 0px;
          margin-top: 0px;
          padding-bottom: 0px;
          padding-top: 0px;
        }
      `:""}

  border-radius: 0 0 ${i=>i.theme.shape.radiusMedium}px
    ${i=>i.theme.shape.radiusMedium}px;
  z-index: ${i=>i.theme.measurements.zIndex.input.list};
`;sx.defaultProps={direction:"vertical"};var Mk=y(require("styled-components"));var Lk=Mk.default.div`
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  color: ${i=>i.theme.dropdown.foreground};
  background-color: ${i=>i.theme.dropdown.background};
  border: none;
  border-bottom: 1px solid ${i=>i.theme.dropdown.borderColor};
  padding: 5px 0;
  cursor: ${i=>i.showList?"pointer":"default"};
  transition: border-color 0.4s ease-in-out;

  &:hover {
    border-color: ${i=>i.theme.dropdown.hoverBorderColor};
  }

  ${Ze}
`;var gL=nx.default.div`
  position: absolute;
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${i=>i.theme.dropdown.caretColor};
  transform: rotate(${i=>i.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
  right: 0;
  top: 13px;
`,bL=nx.default.div``,ax=class extends Do.default.PureComponent{constructor(t){super(t);this.state={isOpen:!1};this.handleOutsideClick=t=>{this.node&&this.node.contains(t.target)||this.setState({isOpen:!1})};this.onSelect=t=>{let{onSelect:e}=this.props;e(t),this.setState({isOpen:!1})};this.onClick=()=>{this.setState(t=>({isOpen:!t.isOpen}))};this.listItem=t=>{let{itemStyle:e,selectedItem:r}=this.props,{isOpen:o}=this.state,{value:s,label:n}=t,a={};return typeof e=="function"?a=e(t):e!==null&&typeof e=="object"&&(a=e),Do.default.createElement(Bk,{"aria-hidden":!o,tabIndex:0,style:a,onClick:()=>this.onSelect(s),key:s,isActive:r===s},n)};this.onKeyDown=t=>{(t.code==="Space"||t.code==="Enter")&&this.onClick()};this.nodeRef=e=>{this.node=e}}componentDidMount(){document.addEventListener("mousedown",this.handleOutsideClick,!1)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1)}render(){let{selectedItem:t,list:e,label:r,style:o,isDisabled:s}=this.props,{isOpen:n}=this.state,a=e.length>1,l=s?{}:{tabIndex:0};return Do.default.createElement(bL,null,Do.default.createElement(ni,{isDisabled:s,style:{paddingLeft:"0px"},label:r}),Do.default.createElement("div",{ref:this.nodeRef},Do.default.createElement(Pk,{isOpen:n,isDisabled:s},Do.default.createElement(Lk,b(b({"data-test":H.Dropdown,"aria-hidden":s},l),{showList:a,style:o,onClick:a?this.onClick:void 0,onKeyDown:this.onKeyDown}),t,a&&Do.default.createElement(gL,{rotation:n?180:0})),Do.default.createElement(sx,{"data-test":H.DropdownList,isOpen:n},a&&e.map(this.listItem)))))}};var zk=y(require("styled-components")),Uk=zk.default.input.attrs({type:"file",id:"fileUpload",accept:"image/*"})`
  display: none;
`;var Nk=y(require("react")),_L=({children:i})=>Nk.default.createElement("form",{onSubmit:e=>{e.preventDefault()}},i),Hk=_L;var cc=y(require("react")),Cu=y(require("styled-components"));var Yh=y(require("react")),lx=y(require("styled-components"));var yL=lx.default.input`
  ${Na}
  /* override user agent style */
  padding: 0;
  &:disabled {
    opacity: ${i=>i.theme.textInput.inactiveOpacity};
    cursor: default;
    pointer-events: none;
  }
`,xL=lx.default.div`
  position: relative;
  &:first-child {
    margin-right: 15px;
  }
`,cx=class extends Yh.default.Component{constructor(){super(...arguments);this.onChange=t=>{let{onChange:e}=this.props;e&&e(t.target.value)}}render(){let{id:t,testId:e,value:r,type:o,min:s,max:n,onBlur:a,onFocus:l,onKeyUp:c,onKeyDown:d,onMouseUp:u,onTouchEnd:m,isDisabled:p,className:f,children:v}=this.props;return Yh.default.createElement(xL,{className:f},Yh.default.createElement(yL,{id:t,"data-test":e,"aria-hidden":p,disabled:p,value:r,type:o,min:s,max:n,onChange:this.onChange,onBlur:a,onFocus:l,onKeyUp:c,onKeyDown:d,onMouseUp:u,onTouchEnd:m}),v)}};cx.defaultProps={type:"text"};var Kh=cx;var vL=Cu.default.div`
  ${Se()?Cu.css``:Cu.css`
        display: flex;
        flex: 0 1 auto;
        flex-direction: column;
      `}
`,Su=class extends cc.default.Component{constructor(t){super(t);this.node=null;this.handleOutsideClick=t=>{this.node&&this.node.current&&this.node.current.contains(t.target)||this.onSubmit()};this.onSubmit=()=>{let{onSubmit:t}=this.props,{value:e,isActive:r}=this.state;if(t){let o=parseFloat(Su.cleanValue(e));!Number.isNaN(o)&&r&&t(`${o}`)}this.setState({isActive:!1})};this.onBlur=()=>{this.onSubmit()};this.onFocus=()=>{this.setState({isActive:!0})};this.onKeyDown=t=>{let{value:e}=this.state;if(t.key==="Enter")this.onSubmit();else if(t.key==="ArrowUp"){let r=parseFloat(Su.cleanValue(e));typeof r=="number"&&this.setState({value:(r+1).toString(),isActive:!0})}else if(t.key==="ArrowDown"){let r=parseFloat(Su.cleanValue(e));typeof r=="number"&&this.setState({value:(r-1).toString(),isActive:!0})}};this.onChange=t=>{this.setState({value:t.replace(/[^\d.,-]/g,""),isActive:!0})};this.state={value:this.props.value||"",isActive:!1},this.node=cc.default.createRef(),document.addEventListener("mousedown",this.handleOutsideClick,!1),document.addEventListener("touchstart",this.handleOutsideClick,!1)}static getDerivedStateFromProps({value:t},{value:e,isActive:r}){return t!==e&&!r?{value:t}:null}static cleanValue(t){return t?t.replace(",",".").replace(/[a-zA-Z]/g,"").trim():""}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1),document.removeEventListener("touchstart",this.handleOutsideClick,!1)}render(){let{id:t,label:e,isDisabled:r,ariaHidden:o,onMouseUp:s,onTouchEnd:n,className:a}=this.props,{value:l}=this.state;return cc.default.createElement(vL,{ref:this.node,"data-test":H.NummericInput,className:a},cc.default.createElement(ni,{htmlFor:t,label:e,show:!!e,isDisabled:r}),cc.default.createElement(Kh,{id:t,value:l,isDisabled:r,"aria-hidden":o,onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.onFocus,onMouseUp:s,onTouchEnd:n}))}},dx=Su;dx.defaultProps={showLabel:!0};var Xh=dx;var dc=y(require("react")),Wk=y(require("styled-components"));var CL=Wk.default.input.attrs({type:"search"})`
  ${Na}
`,Gk=dc.forwardRef(({onChange:i,onKeyDown:t,placeholder:e,className:r,style:o},s)=>dc.default.createElement("div",{className:r,style:o},dc.default.createElement(ni,{show:!1,label:"photoeditorsdk-Search"}),dc.default.createElement(CL,{ref:s,id:"photoeditorsdk-Search",onChange:a=>{i&&i(a.target.value)},onKeyDown:t,placeholder:e})));var qh=y(require("react")),wu=y(require("styled-components"));var SL=wu.default.div``,Vk=({label:i,children:t,inline:e,showLabel:r,isDisabled:o,"data-test":s})=>qh.default.createElement(SL,{"data-test":s},qh.default.createElement(ni,{isDisabled:o,label:i,show:r}),qh.default.createElement(wL,{id:`photoeditorsdk-${i.replace(" ","-")}`,inline:!!e},t)),wL=wu.default.div`
  display: inline-flex;
  ${i=>!i.inline&&wu.css`
        flex-wrap: wrap;
      `||""}
`;Vk.defaultProps={showLabel:!0};var jk=Vk;var Ha=y(require("react")),Er=y(require("styled-components"));var kL=Er.default.div`
  display: flex;
  flex-direction: column;
  /* needed for IE11 to properly calculate the width */
  min-width: 1px;
`,TL=Er.default(ni)`
  padding-bottom: 2px;
`,ux=Er.css`
  ${kr()||Se()?Er.css`
        width: 16px;
        height: 16px;
      `:Er.css`
        width: 20px;
        height: 20px;
      `}
  background: ${i=>i.theme.slider.thumbBackground};
  border: 2px solid ${i=>i.theme.slider.thumbBorderColor};
  border-radius: 50%;
  cursor: pointer;
`,DL=i=>{let t=(i.value-i.min)*100/(i.max-i.min);return i.adjust?i.value>0?(t=i.value*(i.max/2)*100,`${i.theme.slider.trackColor} 0%,
      ${i.theme.slider.trackColor} 50%,
      ${i.theme.slider.activeTrackColor} 50%,
      ${i.theme.slider.activeTrackColor} ${50+t}%,
      ${i.theme.slider.trackColor} ${50+t}%,
      ${i.theme.slider.trackColor} 100%
      `):i.value<0?(t=i.value*(i.min/2)*100,`${i.theme.slider.trackColor} 0%,
      ${i.theme.slider.trackColor} ${50-t}%,
      ${i.theme.slider.activeTrackColor} ${50-t}%,
      ${i.theme.slider.activeTrackColor} 50%,
      ${i.theme.slider.trackColor} 50%,
      ${i.theme.slider.trackColor} 100%
      `):`${i.theme.slider.trackColor} 0%,
    ${i.theme.slider.trackColor} 100%`:`${i.theme.slider.activeTrackColor} 0%,
    ${i.theme.slider.activeTrackColor} ${t}%,
    ${i.theme.slider.trackColor} ${t}%,
    ${i.theme.slider.trackColor} 100%`},IL=Er.default.input`
  display: flex;
  flex: 1 0 auto;
  appearance: none;
  max-width: calc(100% - 50px);
  outline: none;
  border-radius: 0; /* iOS */

  ${Ze}

  ${kr()||Se()?Er.css`
        margin-top: 10px;
        height: 20px;
        /* remove once we have a better concept for focus in all browser */
        &:focus {
          box-shadow: none;
        }
      `:Er.css`
        height: 2px;
        background: ${i=>`linear-gradient(to right, ${DL(i)})`};
      `}
  &::-moz-focus-outer {
    /** This is to remove the dotted focus lines in firefox */
    border: 0;
  }
  &:disabled {
    opacity: ${i=>i.theme.slider.inactiveOpacity};
    pointer-events: none;
  }
  &:hover {
    opacity: ${i=>i.theme.slider.hoverOpacity};
  }
  &::-webkit-slider-runnable-track {
    cursor: pointer;
    appearance: none;
  }
  &::-moz-range-track {
    appearance: none;
    cursor: pointer;
  }
  &::-ms-track {
    cursor: pointer;
    height: 2px;
    appearance: none;
    background: transparent;
    color: transparent;
    border-color: transparent;
    border-width: 6px 0;
  }
  &::-webkit-slider-thumb {
    appearance: none;
    ${ux}
  }
  &::-moz-range-thumb {
    appearance: none;
    ${ux}
  }
  &::-ms-thumb {
    appearance: none;
    ${ux}
  }
  &::-ms-fill-lower {
    background: ${i=>`${i.theme.slider.activeTrackColor}`};
  }
  &::-ms-fill-upper {
    background: ${i=>`${i.theme.slider.trackColor}`};
  }
  &::-ms-tooltip {
    display: none;
  }
  @media all and (min-width: 0) and (max-width: 599px) {
    width: 200px;
  }
`,EL=Er.default.div`
  display: flex;
  align-items: center;
  height: 26px;
  margin-right: ${i=>i.centerSlider?-56:0}px;
`,AL=Er.default(Xh)`
  max-width: 50px;
  padding-left: 16px;
  > div > input {
    text-align: center;
  }
`,mx=class extends Ha.default.Component{constructor(t){super(t);this.onSubmit=t=>{let{onChange:e,suffix:r,divider:o,min:s,max:n,value:a}=this.props,l=t.replace(r,""),c=l?parseFloat(l)/o:a,d=Math.max(s,Math.min(n,c));Number.isNaN(d)||(e(d),this.props.onMouseUp?this.props.onMouseUp():this.props.onTouchEnd&&this.props.onTouchEnd())};this.onSliderChange=t=>{let{onChange:e}=this.props,r=parseFloat(t.target.value);e(r)};this.randomId=Vr()}render(){let{"data-test":t,identifier:e,value:r,min:o,max:s,divider:n,suffix:a,decimal:l,showLabel:c,showInput:d,style:u,centerSlider:m,adjust:p,label:f,isDisabled:v,step:x,"aria-hidden":_,onMouseUp:D,onTouchEnd:k,className:A}=this.props,B=`photoeditorsdk-slider-${this.randomId}`,T=`${B}-input`,F=`${(r*n).toFixed(l)}${a}`,q=d&&Ha.default.createElement(AL,{id:T,value:F,isDisabled:v,"aria-hidden":_,onSubmit:this.onSubmit});return Ha.default.createElement(kL,{className:A,"data-test":t||e||B},Ha.default.createElement(TL,{isDisabled:v,label:f,show:c}),Ha.default.createElement(EL,{centerSlider:d&&m},Ha.default.createElement(IL,{type:"range",role:"slider","aria-hidden":_,tabIndex:0,value:r,min:o,max:s,step:x,style:u,disabled:v,id:B,onChange:this.onSliderChange,adjust:p,name:f,onKeyUp:this.onSliderChange,onKeyDown:this.onSliderChange,onMouseUp:D,onTouchEnd:k}),q))}};mx.defaultProps={showLabel:!0,showInput:!0,adjust:!1,centerSlider:!1,min:-1,max:1,value:0,step:.01,decimal:0,divider:100,suffix:""};var $k=mx;var Io=y(require("react"));var Yk=y(require("styled-components"));var On=Yk.default(si)`
  color: ${i=>i.theme.button.textPrimaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:i})=>i&&$r}

  ${yi} {
    display: none;
  }

  &:disabled {
    opacity: ${i=>i.theme.button.textInactiveOpacity};
  }
`;var Kk=y(require("styled-components"));var Ar=Kk.default(si)`
  color: ${i=>i.theme.button.textSecondaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:i})=>i&&$r}

  ${yi} {
    display: none;
  }

  &:disabled {
    opacity: ${i=>i.theme.button.textInactiveOpacity};
  }
`;var px=class extends Io.default.Component{constructor(){super(...arguments);this.onDismiss=()=>{let{handleClose:t,handleDismiss:e}=this.props;t&&t(),e&&e()};this.onConfirm=()=>{let{handleClose:t,handleConfirm:e}=this.props;t&&t(),e&&e()}}render(){let{headerLabel:t,bodyLabel:e,confirmLabel:r,dismissLabel:o,type:s,children:n}=this.props,a=Io.default.Children.toArray(n)[0];if(!Io.default.isValidElement(a))throw new Error("Child is not a valid react element");return Io.default.cloneElement(a,{handleConfirm:this.onConfirm,handleDismiss:this.onDismiss,header:Io.default.createElement(ic,null,t),body:Io.default.createElement(vs,{"data-test":H.DialogBody},e),footer:Io.default.createElement(ec,{type:s},o&&Io.default.createElement(Ar,{label:o,ariaLabel:o,onClick:this.onDismiss}),r&&Io.default.createElement(On,{label:r,ariaLabel:r,onClick:this.onConfirm}))})}};var Kr=y(require("react")),ku=y(require("styled-components"));var FL=ku.default.div`
  display: flex;
`,OL=ku.default(ic)`
  padding: 0;
`,RL=ku.default.div`
  display: flex;
  flex-direction: column;
  margin-left: 8px;
  @media all and (min-width: 640px) {
    margin-left: 30px;
  }
`,PL=ku.default(vs)`
  padding: 0;
  margin: 0;
`,hx=class extends Kr.default.PureComponent{render(){let{headerLabel:t,bodyLabel:e,children:r}=this.props,o=Kr.default.Children.toArray(r)[0];if(!Kr.default.isValidElement(o))throw new Error("Child is not a valid react element");return Kr.default.cloneElement(o,{height:"90px",body:Kr.default.createElement(vs,{"data-test":H.DialogBody},Kr.default.createElement(FL,null,Kr.default.createElement(Ih,null),Kr.default.createElement(RL,null,Kr.default.createElement(OL,null,t),Kr.default.createElement(PL,null,e))))})}};var or=y(require("react")),uc=y(require("styled-components"));var BL=uc.default.form`
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
`,ML=uc.default.textarea`
  display: flex;
  caret-color: ${i=>i.theme.primary};
  ${Na}
  min-height: 100%;
  padding: 0px;
  outline-offset: -8px;
  color: ${i=>i.theme.modal.bodyForeground};
  resize: none;
  font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;

  &:selection,
  &:-moz-selection {
    background-color: ${i=>i.theme.primary};
    color: ${i=>i.theme.foreground};
  }
`,LL=uc.default.label`
  padding: 11px 20px 8px;
  font-size: ${i=>i.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.label.case};
  color: ${i=>i.theme.modal.headerForeground};
`,zL=uc.default(vs)`
  height: 100%;
`,UL=uc.default(ec)`
  border-top: none;
`,fx=class extends or.default.Component{constructor(){super(...arguments);this.state={value:""};this.input=or.default.createRef();this.handleKeydown=t=>{Hw(this.handleDismiss)(t)};this.handleDismiss=()=>{let{handleDismiss:t}=this.props;t&&t(!1)};this.handleConfirm=()=>{let{handleConfirm:t}=this.props,{value:e}=this.input.current;e&&(t&&t(e),this.handleDismiss())};this.onChange=t=>{let e=Ew(t.target.value);this.input.current.value=e,this.setState({value:e})};this.onSubmit=t=>{t.preventDefault()}}componentDidMount(){let{text:t,defaultText:e}=this.props;this.input.current.focus(),this.input.current.value=t||e||"",this.setState({value:this.input.current.value}),document.addEventListener("keydown",this.handleKeydown,!1),t===e&&this.input.current.select()}componentDidUpdate(t){let{isVisible:e}=this.props;t.isVisible!==e&&e&&this.input.current.focus()}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeydown,!1)}render(){let{headerLabel:t,dismissLabel:e,confirmLabel:r,maxLength:o,type:s,children:n}=this.props,{value:a}=this.state,l=or.default.Children.toArray(n)[0];if(!or.default.isValidElement(l))throw new Error("Child is not a valid react element");return or.default.cloneElement(l,{handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss,isConfirmDisabled:!a,height:"150px",header:or.default.createElement(LL,{htmlFor:"photoeditorsdk-TextInput"},t),body:or.default.createElement(zL,null,or.default.createElement(BL,{onSubmit:this.onSubmit},or.default.createElement(ML,{ref:this.input,id:"photoeditorsdk-TextInput",placeholder:"Write Something",autoFocus:!0,onChange:this.onChange,maxLength:o}))),footer:or.default.createElement(UL,{type:s},or.default.createElement(Ar,{label:e,ariaLabel:e,onClick:this.handleDismiss}),or.default.createElement(On,{label:r,ariaLabel:r,isDisabled:!a,onClick:this.handleConfirm}))})}};fx.defaultProps={defaultText:"Write Something"};var Xk=fx;var qk=y(require("styled-components")),gx=qk.default.div`
  padding-bottom: ${i=>(i.count||1)*8}px;
`;gx.defaultProps={count:1};var Wa=y(require("react")),bx=class extends Wa.default.Component{getChildren(){let t=[],e=[];return Wa.default.Children.forEach(this.props.children,r=>{switch(r.type.componentName){case"case":this.props.type===r.props.value&&t.push(r);break;case"default":e.push(r);break}}),t.length>0?t:e}render(){let t=this.getChildren();return t.length===0?null:Wa.default.createElement(Wa.default.Fragment,null,t)}},Zh=class extends Wa.default.Component{render(){return this.props.children}};Zh.componentName="case";var Jh=class extends Wa.default.Component{render(){return this.props.children}};Jh.componentName="default";var mc=y(require("styled-components")),NL=mc.keyframes`
  from { transform: translate(-50%, 0%); }
  to { transform: translate(-50%, 50%); }
`,HL=mc.default.div`
  position: absolute;
  top: ${i=>i.position.y}px;
  left: ${i=>i.position.x}px;
  transform: translate(-50%, 50%);
  background: black;
  color: white;
  border-radius: ${i=>i.theme.shape.radiusMedium}px;
  padding: 10px 16px;
  text-align: center;
  z-index: ${i=>i.theme.measurements.zIndex.toast};
  visibility: hidden;

  ${({show:i})=>i&&mc.css`
      visibility: visible;
      animation: ${NL} 0.5s, fadeout 0.5s 2.5s;
    `}
`,Zk=HL;var Qh=y(require("react")),Ga=y(require("styled-components"));var WL=Ga.default(si)`
  ${({fullWidth:i})=>i&&Ga.css`
      width: 100%;
    `}
`,GL=Ga.default.div`
  &:focus {
    outline: none;
  }

  > img {
    height: 18px;
    width: 18px;
  }

  > svg {
    height: 18px;
    width: 18px;
  }
  display: none;

  @media all and (min-width: 0) and (max-width: 599px) {
    display: flex;
  }
`,VL=Ga.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  &:focus {
    outline: none;
  }

  ${({hasIcon:i})=>i&&Ga.css`
      @media all and (min-width: 0) and (max-width: 599px) {
        display: none;
      }
    `}
`,Xr=s=>{var{label:i,children:t,icon:e,fullWidth:r}=s,o=_i(s,["label","children","icon","fullWidth"]);let n=Qh.default.createElement(VL,{hasIcon:!!e},i,t);return Qh.default.createElement(WL,b({fullWidth:r},o),e&&Qh.default.createElement(GL,null,e),(t||i)&&n)};var Jk=y(require("styled-components"));var pc=Jk.default(Xr)`
  background: ${i=>i.theme.button.outlinedPrimaryBackground};
  color: ${i=>i.theme.button.outlinedPrimaryForeground};
  border: 1px solid ${i=>i.theme.button.outlinedBorderColor};
  min-width: 32px;
`;var Qk=y(require("styled-components"));var Cs=Qk.default(Xr)`
  background: ${i=>i.theme.button.outlinedSecondaryBackground};
  color: ${i=>i.theme.button.outlinedSecondaryForeground};
  border: 1px solid ${i=>i.theme.button.outlinedBorderColor};

  ${({isActive:i})=>i&&$r}
`;var _x=y(require("react")),yx=y(require("styled-components"));var jL=yx.default(si)`
  color: ${i=>i.theme.foreground};
  /* Repeat active styles so they are not overwritten */
  ${({isActive:i})=>i&&$r}

  ${yi} {
    display: none;
  }

  &:disabled {
    opacity: ${i=>i.theme.button.textInactiveOpacity};
  }
`,$L=yx.default.div`
  display: flex;
  &:focus {
    outline: none;
  }
`,Eo=o=>{var{label:i,icon:t,children:e}=o,r=_i(o,["label","icon","children"]);return _x.default.createElement(jL,b({},r),_x.default.createElement($L,null,t))};var t2=y(require("styled-components"));var hc=t2.default(Xr)`
  background: ${i=>i.theme.button.containedPrimaryBackground};
  color: ${i=>i.theme.button.containedPrimaryForeground};
  border: 1px solid ${i=>i.theme.button.containedPrimaryBackground};

  &:active {
    color: ${i=>i.theme.button.containedPrimaryForeground};
  }
`;var Va=y(require("react")),Tu=y(require("styled-components"));var YL=()=>Tu.css`
    animation: ${Yp} 0.2s linear;
  `,KL=Tu.css`
  border: 1px solid ${i=>i.theme.card.activeBorderColor};
  ${ix} {
    background-color: ${i=>i.theme.card.activeOverlayColor};
  }
`,XL=Tu.default.button.attrs(i=>{let t={};return i.image&&(t.backgroundImage=`url(${i.image})`),{style:t}})`
  &&& {
    box-sizing: border-box;
  }

  /* basic ui text items use position absolute */
  position: relative;

  padding: 0;
  cursor: pointer;
  /* Safari will change the height of the toolbar and position the category cards at the bottom for some reason */
  vertical-align: top;
  border: none;
  box-sizing: border-box;
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  background-color: ${i=>i.theme.card.background};
  color: ${i=>i.theme.card.foreground};
  border-radius: ${i=>i.theme.shape.radiusMedium}px;
  ${YL};
  animation-fill-mode: both;
  overflow: hidden;

  ${Ze}

  /* Active */

  /* No :active styles on purpose. */

  ${({isActive:i})=>i&&KL}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${yi} {
      background-color: ${i=>i.theme.card.inactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${nc} {
      background-color: ${i=>i.theme.card.hoverOverlayColor};
    }
  }
`,sr=class extends Va.default.Component{constructor(){super(...arguments);this.state=Nh;this.timeout=null;this.onKeyDown=t=>{(t.key==="Space"||t.key==="Enter")&&this.props.onClick&&this.props.onClick()};this.onClick=t=>{let e=t.currentTarget.getBoundingClientRect(),r=t.pageX-e.left,o=t.pageY-e.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(r,o)}):this.setRippleState(r,o),this.props.onClick(t)};this.setRippleState=(t,e)=>{this.setState({left:t,top:e,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){let{children:t,label:e,isActive:r,isDisabled:o,image:s,style:n,className:a}=this.props,{left:l,top:c,display:d}=this.state;return Va.default.createElement(XL,{isActive:r,"aria-label":e,"data-test":e,disabled:o,image:s,onClick:this.onClick,onKeyDown:this.onKeyDown,style:n,className:a},t,Va.default.createElement(Hh,{display:d,left:l,top:c}),Va.default.createElement(ix,null),Va.default.createElement(yi,null),Va.default.createElement(nc,null))}};sr.defaultProps={isActive:!1};var fc=y(require("react")),qr=y(require("styled-components"));var qL=qr.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 4px;
  font-size: ${i=>i.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.label.case};
`,ZL=qr.default.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  position: absolute;
  bottom: 0px;
  border-radius: ${i=>i.theme.shape.radiusMedium}px;
  left: 0;
  ${i=>i.withBackground?qr.css`
          color: ${i.theme.card.labelForeground};
          height: 40px;
          background: ${i.theme.card.labelBackground};
        `:qr.css`
          color: ${i.theme.card.foreground};
          height: 32px;
        `}
  width: 100%;
  cursor: pointer;
`,JL=qr.default.div`
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${i=>i.theme.card.labelForeground};
  ${i=>i.withBackground?qr.css`
          border-top-color: ${i.theme.card.labelForeground};
        `:qr.css`
          border-top-color: ${i.theme.card.foreground};
        `}
  transform: rotate(${i=>i.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
`,QL=qr.default.span`
  display: flex;
  align-items: center;
  justify-content: center;
  padding-left: 10px;
`,t3=qr.default.div`
  ${tc}
`,me=({children:i,className:t,caret:e,isActive:r,style:o,withBackground:s,hidden:n})=>{if(n)return fc.default.createElement(t3,null,i);let a=()=>fc.default.createElement(QL,null,fc.default.createElement(JL,{"aria-hidden":!0,rotation:r?180:0,withBackground:s}));return fc.default.createElement(ZL,{className:t,withBackground:s,style:o},fc.default.createElement(qL,{"data-test":H.CardLabel},i,e&&a()))};var e2=y(require("styled-components"));var Rn=e2.default.div.attrs(i=>({"data-test":H.CardAvatar,style:{backgroundImage:`url(${i.url})`}}))`
  position: absolute;
  top: 4px;
  left: 4px;
  height: 28px;
  width: 28px;
  border-radius: 50%;
`;var tf={Focused:Ze,VisuallyHidden:tc},i2={ripple:$p,scale:iw,slide:Yp},E={Container:Yy,ColorItem:qw,ColorItemBase:xh,ColorItemBackground:_h,ColorItemTiledBackground:vh,ColorItemActiveOverlay:yh,Dialog:tk,DialogBase:wh,DialogContainer:kh,DialogBackdrop:Ch,DialogHeader:ic,DialogBody:vs,DialogFooter:ec,DialogSpinner:Ih,TextEditModal:Xk,ActionModal:px,InfoModal:hx,Spacer:gx,Draggable:bk,DraggableCore:Ua,Toast:Zk,Input:{Label:ni,File:Uk,Search:Gk,Slider:$k,CarouselSlider:Dk,Selection:jk,Checkbox:Fk,CheckboxBase:Gh,CheckboxInput:Vh,CheckboxCheckMark:xu,Dropdown:ax,Text:Kh,NumericInput:Xh,Form:Hk},Switch:{Index:bx,Case:Zh,Default:Jh}};var Du=r2.default(Xr)`
  font-size: ${i=>i.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.button2.case};
  color: ${i=>i.theme.button.textSecondaryForeground};

  ${yi} {
    display: none;
  }

  &:disabled {
    opacity: ${i=>i.theme.button.textInactiveOpacity};
  }
`;var xx=y(require("react")),vx=y(require("styled-components"));var e3=vx.default(si)`
  width: 60px;
  height: 60px;
  background-color: gray;
  border-radius: 50%;
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  z-index: ${i=>i.theme.measurements.zIndex.button.float};
  padding: 2px;
`,i3=vx.default.div`
  height: 56px;
  width: 56px;
  border-radius: 50%;
  background-color: ${i=>i.theme.webcam.floatButton};
`,o2=i=>xx.default.createElement(e3,b({},i),xx.default.createElement(i3,null));var ja=y(require("styled-components"));var s2=ja.default.div`
  display: inline-flex;
`,Zr=ja.default(Xr)`
  background: ${i=>i.theme.canvasActionBar.background};
  color: ${i=>i.theme.canvasActionBar.foreground};
  font-size: ${i=>i.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.button2.case};
  padding: 4px 10px;
  position: relative;
  /* for safari */
  margin: 0;
  &:last-child:after {
    opacity: 0;
  }
`,Iu=ja.default.div`
  ${({show:i})=>i?ja.css`
          opacity: 1;
        `:ja.css`
          opacity: 0;
        `};
  position: absolute;
  transform: translate(-50%, -100%);
  background: ${i=>i.theme.canvasActionBar.background};
  color: ${i=>i.theme.canvasActionBar.foreground};
  border-radius: ${i=>i.theme.canvasActionBar.borderRadius?i.theme.canvasActionBar.borderRadius:i.theme.shape.radiusMedium}px;
  white-space: nowrap;
  transition: opacity 0.3s ease-in-out;
  z-index: ${i=>i.theme.measurements.zIndex.buttonGroup};

  ${Zr} {
    &:after {
      content: '';
      position: absolute;
      right: 0px;
      top: 6px;
      height: calc(100% - 12px);
      border-right: 1px solid
        ${i=>i.theme.canvasActionBar.separatorColor};
      &:last-child {
        border-right: unset;
      }
    }
  }
`;var xr=y(require("react"));var FF=y(require("styled-components"));var Ss=y(require("react")),r3=()=>Ss.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Ss.default.createElement("defs",null,Ss.default.createElement("path",{id:"photoeditorsdk-blacks-icon",d:"M24 12c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12m0 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10m4 12c0 2.788-2.326 3.879-7 3V18.5c4.148-.459 6.516.226 6.516 2.623 0 1.207-.492 1.998-1.512 2.474C27.504 23.999 28 24.619 28 26zm-5-6v3c2.244.068 2.775-.719 2.775-1.536 0-1.22-.531-1.812-2.775-1.464zm0 7.5c2.19.193 3.038-.04 3.038-1.484 0-1.37-1.096-1.695-3.038-1.516v3z"})),Ss.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ss.default.createElement("path",{d:"M0 0H48V48H0z"}),Ss.default.createElement("mask",{fill:"currentColor"},Ss.default.createElement("use",{xlinkHref:"#photoeditorsdk-blacks-icon"})),Ss.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-blacks-icon"}))),n2=r3;var Pn=y(require("react")),o3=()=>Pn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Pn.default.createElement("defs",null,Pn.default.createElement("path",{id:"photoeditorsdk-brightness-icon",d:"M22.185 33.836c.594.109 1.2.164 1.815.164v2c-.735 0-1.462-.066-2.175-.197zm5.58-.568l.753 1.852c-.675.275-1.375.487-2.093.635l-.402-1.96c.597-.122 1.18-.299 1.741-.527zm-9.446-1.037c.5.346 1.03.646 1.586.895l-.82 1.824c-.666-.3-1.303-.66-1.903-1.074zm12.884-1.295l1.44 1.388a12.06 12.06 0 01-1.65 1.429l-1.167-1.625a10.06 10.06 0 001.377-1.192zm-15.758-1.754c.316.52.679 1.01 1.083 1.464l-1.493 1.33a12.038 12.038 0 01-1.3-1.756zm17.97-1.802l1.882.676a11.948 11.948 0 01-.925 1.982l-1.727-1.008a9.948 9.948 0 00.77-1.65zM24 18c.091 0 .182.002.273.006L24 18a6.071 6.071 0 01.668.037l.192.024a5.974 5.974 0 011.847.585l.01.005a5.992 5.992 0 011.154.768A5.99 5.99 0 0130 24c0 3.309-2.691 6-6 6a5.985 5.985 0 01-4.404-1.929l.163.17a6.052 6.052 0 01-1.353-2.07A5.951 5.951 0 0118 24c0-3.309 2.691-6 6-6zm2.827 3.173l-5.654 5.654A3.988 3.988 0 0024 28c2.206 0 4-1.794 4-4a3.988 3.988 0 00-1.173-2.827zM14.08 25.268c.076.606.208 1.2.392 1.777l-1.905.608a11.936 11.936 0 01-.472-2.134zm21.885-2.192a12.16 12.16 0 01-.032 2.198l-1.989-.21a10.193 10.193 0 00.027-1.836zM12.522 20.49l1.912.584a9.943 9.943 0 00-.37 1.783l-1.987-.226c.083-.73.232-1.445.445-2.14zm22.059-2.155c.345.643.63 1.316.853 2.013l-1.905.608a9.934 9.934 0 00-.71-1.676zm-19.587-2.266l1.5 1.323c-.402.456-.762.948-1.075 1.47l-1.715-1.03c.376-.625.808-1.215 1.29-1.763zm16.272-1.62c.58.442 1.12.936 1.61 1.476l-1.479 1.346c-.41-.45-.859-.862-1.343-1.23zm-12.241-1.372l.83 1.82a9.986 9.986 0 00-1.58.903l-1.147-1.638a11.986 11.986 0 011.897-1.085zm7.7-.766c.714.166 1.408.396 2.076.688L28 14.832a9.916 9.916 0 00-1.727-.573zm-2.857-.31l.021 2c-.613.006-1.22.068-1.812.184l-.383-1.964a12.046 12.046 0 012.174-.22z"})),Pn.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Pn.default.createElement("mask",null,Pn.default.createElement("use",{xlinkHref:"#photoeditorsdk-brightness-icon"})),Pn.default.createElement("use",{fillOpacity:"0.9",transform:"rotate(-45 24.039 24)",xlinkHref:"#photoeditorsdk-brightness-icon"}))),a2=o3;var ws=y(require("react")),s3=()=>ws.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},ws.default.createElement("defs",null,ws.default.createElement("path",{id:"photoeditorsdk-clarity-icon",d:"M24 12L13 24.001 24 36l11-11.999L24 12zm-8.29 12.001H21l3-9.041 8.29 9.041-8.28 9.029L28 24.001h-7l2.99 9.029-8.28-9.029z"})),ws.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ws.default.createElement("path",{d:"M0 0H48V48H0z"}),ws.default.createElement("mask",{fill:"currentColor"},ws.default.createElement("use",{xlinkHref:"#photoeditorsdk-clarity-icon"})),ws.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-clarity-icon"}))),l2=s3;var ks=y(require("react")),n3=()=>ks.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},ks.default.createElement("defs",null,ks.default.createElement("path",{id:"photoeditorsdk-contrast-icon",d:"M24 34V14c5.51 0 10 4.49 10 10s-4.49 10-10 10m0-22c-6.62 0-12 5.38-12 12s5.38 12 12 12 12-5.38 12-12-5.38-12-12-12"})),ks.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ks.default.createElement("path",{d:"M0 0H48V48H0z"}),ks.default.createElement("mask",{fill:"currentColor"},ks.default.createElement("use",{xlinkHref:"#photoeditorsdk-contrast-icon"})),ks.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-contrast-icon"}))),c2=n3;var Ts=y(require("react")),a3=()=>Ts.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Ts.default.createElement("defs",null,Ts.default.createElement("path",{id:"photoeditorsdk-exposure-icon",d:"M24 34V14c5.51 0 10 4.49 10 10s-4.49 10-10 10m0-22c6.62 0 12 5.38 12 12s-5.38 12-12 12-12-5.38-12-12 5.38-12 12-12zm-3.536 8.464l-2.121 2.122-2.121-2.122-1.414 1.415L16.929 24l-2.121 2.121 1.414 1.415 2.121-2.122 2.121 2.122 1.415-1.415L19.757 24l2.122-2.121-1.415-1.415zm5.304 4.597l4.242-4.243 1.415 1.414-4.243 4.243-1.414-1.414z"})),Ts.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ts.default.createElement("path",{d:"M0 0H48V48H0z"}),Ts.default.createElement("mask",{fill:"currentColor"},Ts.default.createElement("use",{xlinkHref:"#photoeditorsdk-exposure-icon"})),Ts.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",transform:"rotate(45 24 24)",xlinkHref:"#photoeditorsdk-exposure-icon"}))),d2=a3;var Ds=y(require("react")),l3=()=>Ds.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Ds.default.createElement("defs",null,Ds.default.createElement("path",{id:"photoeditorsdk-gamma-icon",d:"M22.185 33.836c.594.109 1.2.164 1.815.164v2c-.735 0-1.462-.066-2.175-.197zm5.58-.568l.753 1.852c-.675.275-1.375.487-2.093.635l-.402-1.96c.597-.122 1.18-.299 1.741-.527zm-9.446-1.037c.5.346 1.03.646 1.586.895l-.82 1.824c-.666-.3-1.303-.66-1.903-1.074zm12.884-1.295l1.44 1.388a12.06 12.06 0 01-1.65 1.429l-1.167-1.625a10.06 10.06 0 001.377-1.192zm-15.758-1.754c.316.52.679 1.01 1.083 1.464l-1.493 1.33a12.038 12.038 0 01-1.3-1.756zm17.97-1.802l1.882.676a11.948 11.948 0 01-.925 1.982l-1.727-1.008a9.948 9.948 0 00.77-1.65zM24 18c.091 0 .182.002.273.006L24 18a6.071 6.071 0 01.668.037l.192.024a5.974 5.974 0 011.847.585l.01.005a5.992 5.992 0 011.154.768A5.99 5.99 0 0130 24c0 3.309-2.691 6-6 6a5.985 5.985 0 01-4.404-1.929l.163.17a6.052 6.052 0 01-1.353-2.07A5.951 5.951 0 0118 24c0-3.309 2.691-6 6-6zm2.827 3.173l-5.654 5.654A3.988 3.988 0 0024 28c2.206 0 4-1.794 4-4a3.988 3.988 0 00-1.173-2.827zM14.08 25.268c.076.606.208 1.2.392 1.777l-1.905.608a11.936 11.936 0 01-.472-2.134zm21.885-2.192a12.16 12.16 0 01-.032 2.198l-1.989-.21a10.193 10.193 0 00.027-1.836zM12.522 20.49l1.912.584a9.943 9.943 0 00-.37 1.783l-1.987-.226c.083-.73.232-1.445.445-2.14zm22.059-2.155c.345.643.63 1.316.853 2.013l-1.905.608a9.934 9.934 0 00-.71-1.676zm-19.587-2.266l1.5 1.323c-.402.456-.762.948-1.075 1.47l-1.715-1.03c.376-.625.808-1.215 1.29-1.763zm16.272-1.62c.58.442 1.12.936 1.61 1.476l-1.479 1.346c-.41-.45-.859-.862-1.343-1.23zm-12.241-1.372l.83 1.82a9.986 9.986 0 00-1.58.903l-1.147-1.638a11.986 11.986 0 011.897-1.085zm7.7-.766c.714.166 1.408.396 2.076.688L28 14.832a9.916 9.916 0 00-1.727-.573zm-2.857-.31l.021 2c-.613.006-1.22.068-1.812.184l-.383-1.964a12.046 12.046 0 012.174-.22z"})),Ds.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ds.default.createElement("path",{d:"M0 0H48V48H0z"}),Ds.default.createElement("mask",{fill:"#fff"},Ds.default.createElement("use",{xlinkHref:"#photoeditorsdk-gamma-icon"})),Ds.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-gamma-icon"}))),u2=l3;var Is=y(require("react")),c3=()=>Is.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Is.default.createElement("defs",null,Is.default.createElement("path",{id:"photoeditorsdk-highlights-icon",d:"M31.07 31.07A9.932 9.932 0 0124 34c-2.67 0-5.18-1.04-7.07-2.93l14.14-14.14c3.9 3.9 3.9 10.24 0 14.14m1.42-15.56A11.995 11.995 0 0024 12c-3.07 0-6.14 1.17-8.49 3.51-4.68 4.69-4.68 12.29 0 16.98C17.86 34.83 20.93 36 24 36c3.07 0 6.14-1.17 8.49-3.51 4.68-4.69 4.68-12.29 0-16.98"})),Is.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Is.default.createElement("path",{d:"M0 0H48V48H0z"}),Is.default.createElement("mask",{fill:"currentColor"},Is.default.createElement("use",{xlinkHref:"#photoeditorsdk-highlights-icon"})),Is.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-highlights-icon"}))),m2=c3;var Es=y(require("react")),d3=()=>Es.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Es.default.createElement("defs",null,Es.default.createElement("path",{id:"photoeditorsdk-saturation-icon",d:"M17 31c1.334 1.099 2 2.177 2 3.234 0 .797-.454 1.39-1.211 1.655-.165.057-.428.094-.789.111l-.172-.01a2.54 2.54 0 01-.617-.101C15.454 35.624 15 35.03 15 34.234c0-1.057.666-2.135 2-3.234zm8.7-6l-4.24 4H17v-3.81l.2-.19h8.5zm-.7-7.59l4.24 4.25L26.76 24h-8.54L25 17.41zm7.778-3.532a3 3 0 01.135 4.1l-.135.143-1.414 1.414 1.414 1.415-1.414 1.414-7.07-7.071 1.413-1.414 1.414 1.413 1.414-1.414a3.001 3.001 0 014.243 0z"})),Es.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Es.default.createElement("path",{d:"M0 0H48V48H0z"}),Es.default.createElement("mask",{fill:"currentColor"},Es.default.createElement("use",{xlinkHref:"#photoeditorsdk-saturation-icon"})),Es.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-saturation-icon"}))),p2=d3;var As=y(require("react")),u3=()=>As.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},As.default.createElement("defs",null,As.default.createElement("path",{id:"photoeditorsdk-shadows-icon",d:"M30.365 17.637l3.076 3.076c.382 1.09.566 2.234.56 3.387l-5.05-5.049-1.414 1.414 6.123 6.124a9.674 9.674 0 01-.792 2.036l-6.746-6.745-1.414 1.414 7.036 7.036c-.212.254-.43.502-.672.742-.24.24-.488.46-.742.672l-7.036-7.036-1.414 1.414 6.745 6.746a9.674 9.674 0 01-2.036.792l-6.124-6.123-1.414 1.414L24.101 34a10.012 10.012 0 01-3.388-.558l-3.076-3.076-.707.707c-3.896-3.896-3.896-10.246 0-14.142 3.896-3.896 10.246-3.896 14.142 0l-.707.707zm-14.849-2.12c-4.688 4.687-4.688 12.281 0 16.97a12.036 12.036 0 004.108 2.693c.064.022.127.057.191.078 4.264 1.577 9.242.658 12.671-2.772 3.43-3.429 4.35-8.407 2.772-12.67-.02-.065-.056-.128-.078-.192a12.036 12.036 0 00-2.694-4.108c-4.688-4.688-12.282-4.688-16.97 0z"})),As.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},As.default.createElement("path",{d:"M0 0H48V48H0z"}),As.default.createElement("mask",{fill:"currentColor"},As.default.createElement("use",{xlinkHref:"#photoeditorsdk-shadows-icon"})),As.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-shadows-icon"}))),h2=u3;var Fs=y(require("react")),m3=()=>Fs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Fs.default.createElement("defs",null,Fs.default.createElement("path",{id:"photoeditorsdk-sharpness-icon",d:"M24 12l11 24H13l11-24zm0 4.8V34h7.883L24 16.8z"})),Fs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Fs.default.createElement("path",{d:"M0 0H48V48H0z"}),Fs.default.createElement("mask",{fill:"currentColor"},Fs.default.createElement("use",{xlinkHref:"#photoeditorsdk-sharpness-icon"})),Fs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-sharpness-icon"}))),f2=m3;var Os=y(require("react")),p3=()=>Os.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Os.default.createElement("defs",null,Os.default.createElement("path",{id:"photoeditorsdk-temperature-icon",d:"M24 12a4 4 0 014 4v7.255a7 7 0 11-8 0V16a4 4 0 014-4zm0 2a2 2 0 00-2 2v8.298l-.856.597a5 5 0 105.712 0L26 24.298V16a2 2 0 00-2-2zm1 6v5.126A4.002 4.002 0 0124 33a4 4 0 01-1-7.874V20h2z"})),Os.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Os.default.createElement("path",{d:"M0 0H48V48H0z"}),Os.default.createElement("mask",{fill:"currentColor"},Os.default.createElement("use",{xlinkHref:"#photoeditorsdk-temperature-icon"})),Os.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-temperature-icon"}))),g2=p3;var Rs=y(require("react")),h3=()=>Rs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"48",height:"48",viewBox:"0 0 48 48"},Rs.default.createElement("defs",null,Rs.default.createElement("path",{id:"photoeditorsdk-whites-icon",d:"M24 12c6.627 0 12 5.373 12 12s-5.373 12-12 12-12-5.373-12-12 5.373-12 12-12zm-2 6.46h-2c.221 4.539.762 9.051 1 11.04h1.5l1.5-5.52 1.5 5.52H27c.238-1.989.779-6.501 1-11.04h-2c-.051 1.071-.432 7.446-.5 7.973-.459-1.717-.541-3.111-1-4.811h-1c-.442 1.7-.541 2.975-1 4.811-.051-.527-.466-6.902-.5-7.973z"})),Rs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Rs.default.createElement("path",{d:"M0 0H48V48H0z"}),Rs.default.createElement("mask",{fill:"currentColor"},Rs.default.createElement("use",{xlinkHref:"#photoeditorsdk-whites-icon"})),Rs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-whites-icon"}))),b2=h3;var Bn=y(require("react")),f3=()=>Bn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Bn.default.createElement("defs",null,Bn.default.createElement("path",{id:"photoeditorsdk-close-icon",d:"M21.583 0L24 2.416 14.416 12 24 21.584 21.583 24 12 14.416 2.417 24 0 21.584 9.584 12 0 2.416 2.417 0 12 9.584 21.583 0z"})),Bn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Bn.default.createElement("mask",{fill:"currentColor"},Bn.default.createElement("use",{xlinkHref:"#photoeditorsdk-close-icon"})),Bn.default.createElement("use",{fill:"currentColor",fillRule:"nonzero",xlinkHref:"#photoeditorsdk-close-icon"}))),_2=f3;var Mn=y(require("react"));function g3(){return Mn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Mn.default.createElement("defs",null,Mn.default.createElement("path",{id:"photoeditorsdk-export-icon",d:"M22 1.5a1.5 1.5 0 011.493 1.356L23.5 3H22h1.5v17a1.5 1.5 0 01-1.5 1.5H12a1.5 1.5 0 01-1.493-1.356L10.5 20v-6h2v5.499h9v-16h-9V9h-2V3A1.5 1.5 0 0112 1.5h10zM6.15 5.817L7.634 7.3l-3.171 3.171h13.978v2H4.47l3.171 3.17-1.483 1.483L.5 11.467l5.65-5.65z"})),Mn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Mn.default.createElement("mask",{fill:"#fff"},Mn.default.createElement("use",{xlinkHref:"#photoeditorsdk-export-icon"})),Mn.default.createElement("use",{fill:"currentcolor",fillOpacity:"0.9",transform:"rotate(90 12 11.5)",xlinkHref:"#photoeditorsdk-export-icon"})))}var y2=g3;var Ln=y(require("react")),b3=()=>Ln.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"25",height:"25",viewBox:"0 0 25 25"},Ln.default.createElement("defs",null,Ln.default.createElement("path",{id:"photoeditorsdk-redo-icon",d:"M4 10.065C4 4.506 8.365 0 13.75 0s9.75 4.506 9.75 10.065v9.29h-3v-9.29c0-3.849-3.022-6.968-6.75-6.968S7 6.217 7 10.065v7.741h3L5.5 24 1 17.806h3v-7.741z"})),Ln.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ln.default.createElement("mask",{fill:"currentColor"},Ln.default.createElement("use",{xlinkHref:"#photoeditorsdk-redo-icon"})),Ln.default.createElement("use",{fill:"currentColor",transform:"matrix(0 1 1 0 .25 -.25)",xlinkHref:"#photoeditorsdk-redo-icon"}))),x2=b3;var zn=y(require("react")),_3=()=>zn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"25",height:"25",viewBox:"0 0 25 25"},zn.default.createElement("defs",null,zn.default.createElement("path",{id:"photoeditorsdk-undo-icon",d:"M4 10.065C4 4.506 8.365 0 13.75 0s9.75 4.506 9.75 10.065v9.29h-3v-9.29c0-3.849-3.022-6.968-6.75-6.968S7 6.217 7 10.065v7.741h3L5.5 24 1 17.806h3v-7.741z"})),zn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},zn.default.createElement("mask",{fill:"currentColor"},zn.default.createElement("use",{xlinkHref:"#photoeditorsdk-undo-icon"})),zn.default.createElement("use",{fill:"currentColor",transform:"rotate(90 12.25 12)",xlinkHref:"#photoeditorsdk-undo-icon"}))),v2=_3;var Un=y(require("react"));function y3(){return Un.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48",focusable:"false","aria-hidden":"true","aria-label":"Center Align",width:"26",height:"26"},Un.default.createElement("defs",null,Un.default.createElement("path",{id:"photoeditorsdk-align-center-icon",d:"M31.5 30v3h-15v-3h15zm4.5-7.5v3H12v-3h24zm0-7.5v3H12v-3h24z"})),Un.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Un.default.createElement("mask",{fill:"#fff"},Un.default.createElement("use",{xlinkHref:"#photoeditorsdk-align-center-icon"})),Un.default.createElement("use",{fill:"currentColor",xlinkHref:"#photoeditorsdk-align-center-icon"})))}var C2=y3;var Nn=y(require("react")),x3=()=>Nn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48",focusable:"false","aria-hidden":"true","aria-label":"Left Align",width:"26",height:"26"},Nn.default.createElement("defs",null,Nn.default.createElement("path",{id:"photoeditorsdk-align-left-icon",d:"M27 30v3H12v-3h15zm9-7.5v3H12v-3h24zm0-7.5v3H12v-3h24z"})),Nn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Nn.default.createElement("mask",{fill:"#fff"},Nn.default.createElement("use",{xlinkHref:"#photoeditorsdk-align-left-icon"})),Nn.default.createElement("use",{fill:"currentColor",xlinkHref:"#photoeditorsdk-align-left-icon"}))),S2=x3;var Ps=y(require("react"));function v3(){return Ps.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 48 48",width:"26",height:"26",focusable:"false","aria-hidden":"true","aria-label":"Right Align"},Ps.default.createElement("defs",null,Ps.default.createElement("path",{id:"photoeditorsdk-align-right-icon",d:"M27 30v3H12v-3h15zm9-7.5v3H12v-3h24zm0-7.5v3H12v-3h24z"})),Ps.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ps.default.createElement("path",{d:"M0 0H48V48H0z"}),Ps.default.createElement("mask",{fill:"#fff"},Ps.default.createElement("use",{xlinkHref:"#photoeditorsdk-align-right-icon"})),Ps.default.createElement("use",{fill:"currentColor",transform:"matrix(-1 0 0 1 48 0)",xlinkHref:"#photoeditorsdk-align-right-icon"})))}var w2=v3;var ai=y(require("react")),C3=()=>ai.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Adjustments",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},ai.default.createElement("g",{fill:"none",fillRule:"evenodd"},ai.default.createElement("g",null,ai.default.createElement("g",{fill:"#D8D8D8",opacity:"0"},ai.default.createElement("rect",{width:"48",height:"48"})),ai.default.createElement("g",{transform:"translate(12 12)"},ai.default.createElement("rect",{fill:"#D8D8D8",opacity:"0",width:"24",height:"24"}),ai.default.createElement("g",{transform:"translate(2 13)",fill:"currentColor"},ai.default.createElement("path",{d:"M3.02746439,4 C3.00931666,4.16416693 3,4.33099545 3,4.5 C3,4.66900455 3.00931666,4.83583307 3.02746439,5 L0,5 L0,4 L3.02746439,4 Z M13,4 L20,4 L20,5 L13,5 L13,4 Z",fillOpacity:"0.2"}),ai.default.createElement("path",{d:"M5.09842503,6.29819429 C5.0340931,6.05140089 5,5.7851211 5,5.5 C5,3.56700338 6.56700338,2 8.5,2 C8.7851211,2 9.05140089,2.0340931 9.29819429,2.09842503 C10.0278893,2.64566496 10.5,3.5176988 10.5,4.5 C10.5,6.15685425 9.15685425,7.5 7.5,7.5 C6.5176988,7.5 5.64566496,7.02788926 5.09842503,6.29819429 Z M11.1637159,7.11349161 C10.874061,7.51881791 10.5188179,7.87406095 10.1134916,8.16371592 C10.5772175,7.93004328 10.9300433,7.5772175 11.1637159,7.11349161 Z",fillOpacity:"0.2"}),ai.default.createElement("path",{d:"M7.5,7.5 C9.15685425,7.5 10.5,6.15685425 10.5,4.5 C10.5,2.84314575 9.15685425,1.5 7.5,1.5 C5.84314575,1.5 4.5,2.84314575 4.5,4.5 C4.5,6.15685425 5.84314575,7.5 7.5,7.5 Z M7.5,9 C5.01471863,9 3,6.98528137 3,4.5 C3,2.01471863 5.01471863,0 7.5,0 C9.98528137,0 12,2.01471863 12,4.5 C12,6.98528137 9.98528137,9 7.5,9 Z",fillOpacity:"0.87"})),ai.default.createElement("g",{transform:"rotate(-180 11 5.5)",fill:"currentColor"},ai.default.createElement("path",{d:"M11.9725356,4 L20,4 L20,5 L11.9725356,5 C11.9906833,4.83583307 12,4.66900455 12,4.5 C12,4.33099545 11.9906833,4.16416693 11.9725356,4 Z M0,4 L2,4 L2,5 L0,5 L0,4 Z",fillOpacity:"0.2"}),ai.default.createElement("g",{transform:"rotate(-180 5 3.5)",fillOpacity:"0.2"},ai.default.createElement("path",{d:"M0.0984250251,4.29819429 C0.0340930963,4.05140089 0,3.7851211 0,3.5 C0,1.56700338 1.56700338,0 3.5,0 C3.7851211,0 4.05140089,0.0340930963 4.29819429,0.0984250251 C5.02788926,0.645664963 5.5,1.5176988 5.5,2.5 C5.5,4.15685425 4.15685425,5.5 2.5,5.5 C1.5176988,5.5 0.645664963,5.02788926 0.0984250251,4.29819429 Z M6.16371592,5.11349161 C5.87406095,5.51881791 5.51881791,5.87406095 5.11349161,6.16371592 C5.5772175,5.93004328 5.93004328,5.5772175 6.16371592,5.11349161 Z"})),ai.default.createElement("path",{d:"M7.5,7.5 C9.15685425,7.5 10.5,6.15685425 10.5,4.5 C10.5,2.84314575 9.15685425,1.5 7.5,1.5 C5.84314575,1.5 4.5,2.84314575 4.5,4.5 C4.5,6.15685425 5.84314575,7.5 7.5,7.5 Z M7.5,9 C5.01471863,9 3,6.98528137 3,4.5 C3,2.01471863 5.01471863,-3.6739404e-16 7.5,-3.6739404e-16 C9.98528137,-3.6739404e-16 12,2.01471863 12,4.5 C12,6.98528137 9.98528137,9 7.5,9 Z",fillOpacity:"0.87"})))))),k2=C3;var Hn=y(require("react"));function S3(){return Hn.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Brush",width:"48",height:"48",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},Hn.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Hn.default.createElement("path",{fillOpacity:"0.87",d:"M14.73 18.86C13.293 19.503 11.624 20 10 20 2 20 0 13 0 10c.486.972 2.37 5.848 7.537 4.165C7.873 17.125 10.427 19 13 19c.6 0 1.177-.05 1.73-.14zM8.422 8.63a7.352 7.352 0 00-1.127 1.616L2.401 3.705c-.215-.287-.178-.807.072-1.056l.088-.088L8.5 8.5l-.078.13z",opacity:"0.5",transform:"translate(12 12) translate(2 2)"}),Hn.default.createElement("path",{fillOpacity:"0.87",d:"M7.295 10.246c-.27.526-.48 1.09-.615 1.68L1.2 4.603c-.663-.885-.564-2.24.212-3.015l.176-.176c.78-.78 2.121-.881 3.015-.212l7.245 5.421a6.088 6.088 0 00-1.67.624L3.706 2.401c-.294-.22-.801-.184-1.056.072l-.176.176c-.25.25-.287.769-.072 1.056l4.894 6.54z",transform:"translate(12 12) translate(2 2)"}),Hn.default.createElement("path",{fillOpacity:"0.87",d:"M9.702 6.554c-.185-.869-.151-.71-.207-.955C8.88 2.902 8.145 2 6 2 3.98 2 2 4.08 2 6.5c0 2.294 1.835 4 4 4 1.545 0 2.915-.342 4.544-1.088-.332-.7-.578-1.619-.842-2.858z",opacity:"0.5",transform:"translate(12 12) translate(2 2) translate(7 7)"}),Hn.default.createElement("path",{fillOpacity:"0.25",d:"M10.379 9.027c.053.135.108.263.165.385C8.914 10.158 7.545 10.5 6 10.5c-2.165 0-4-1.706-4-4 0-1.528.79-2.921 1.88-3.74-.882 2.084-1.025 6.482 6.499 6.267z",transform:"translate(12 12) translate(2 2) translate(7 7)"}),Hn.default.createElement("path",{fillOpacity:"0.87",d:"M9.702 6.554c-.185-.869-.151-.71-.207-.955C8.88 2.902 8.145 2 6 2 3.98 2 2 4.08 2 6.5c0 2.294 1.835 4 4 4 1.545 0 2.915-.342 4.544-1.088-.332-.7-.578-1.619-.842-2.858zM6 12C3.239 12 .5 9.842.5 6.5S3.239.5 6 .5c6.5 0 4 8 7 9.342C11 10.947 8.761 12 6 12z",transform:"translate(12 12) translate(2 2) translate(7 7)"})))}var T2=S3;var Jr=y(require("react")),w3=()=>Jr.default.createElement("svg",{"aria-hidden":"true",focusable:"false","aria-label":"Filter",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},Jr.default.createElement("g",{fill:"none",fillRule:"evenodd"},Jr.default.createElement("g",null,Jr.default.createElement("g",{fill:"#D8D8D8",opacity:"0"},Jr.default.createElement("rect",{width:"48",height:"48"})),Jr.default.createElement("g",{transform:"translate(16 14)",fill:"currentColor"},Jr.default.createElement("g",null,Jr.default.createElement("path",{d:"M1.53468397,11.3244256 C2.30584171,10.1516526 4.0927284,8.69757613 8,10 C11.5643313,11.1881104 13.1877038,10.2588113 13.9183327,9.30853287 C14.2918933,10.1286474 14.5,11.0400207 14.5,12 C14.5,15.5898509 11.5898509,18.5 8,18.5 C4.41014913,18.5 1.5,15.5898509 1.5,12 C1.5,11.7718729 1.51175212,11.5464906 1.53468397,11.3244256 Z",fillOpacity:"0.2"}),Jr.default.createElement("path",{d:"M1.53471819,12.6759057 C2.39408133,13.5811739 4.12541941,14.1109247 5.5,13.5 C9.81068889,11.5841383 9.99203585,9.66827654 14.3948028,10.8290113 C14.4639074,11.2088572 14.5,11.6002137 14.5,12 C14.5,15.5898509 11.5898509,18.5 8,18.5 C4.63838968,18.5 1.87279864,15.9481381 1.53471819,12.6759057 Z",fillOpacity:"0.25"}),Jr.default.createElement("path",{d:"M11,1.44328993e-15 L11,4.58151705 C13.9318303,5.7682918 16,8.64262245 16,12 C16,16.418278 12.418278,20 8,20 C3.581722,20 0,16.418278 0,12 C0,8.64262245 2.06816966,5.7682918 5,4.58151705 L5,1.60982339e-15 L6.5,1.44328993e-15 L6.5,5.67393184 C3.6333,6.35109564 1.5,8.92641836 1.5,12 C1.5,15.5898509 4.41014913,18.5 8,18.5 C11.5898509,18.5 14.5,15.5898509 14.5,12 C14.5,8.92641836 12.3667,6.35109564 9.5,5.67393184 L9.5,1.77635684e-15 L11,1.44328993e-15 Z",fillOpacity:"0.87"})))))),D2=w3;var Fr=y(require("react")),k3=()=>Fr.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Focus",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},Fr.default.createElement("g",{fill:"none",fillRule:"evenodd"},Fr.default.createElement("g",null,Fr.default.createElement("g",{fill:"#D8D8D8",opacity:"0"},Fr.default.createElement("rect",{width:"48",height:"48"})),Fr.default.createElement("g",{transform:"translate(12 12)"},Fr.default.createElement("rect",{fill:"#D8D8D8",opacity:"0",width:"24",height:"24"}),Fr.default.createElement("g",{transform:"translate(4 2)",fill:"currentColor"},Fr.default.createElement("path",{d:"M8.51312274,19.9836057 C8.77273397,19.9669655 9.02898229,19.9377873 9.2812837,19.8966625 C9.14309542,19.9643562 9.04607398,20 9,20 C8.83633495,20 8.67398178,19.9944755 8.51312274,19.9836057 Z M2.27242753,15.0235117 C2.09503729,14.4174909 2,13.7771617 2,13.115 C2,8.89625769 7.39855682,4.1952443 9.03524007,2.8669743 C9.66704719,3.45933018 10.2896864,4.09178959 10.8802638,4.75434357 C12.9939648,7.12565193 14.310818,9.45010207 14.481291,11.4644804 C14.4937541,11.6117488 14.5,11.7569175 14.5,11.9 C14.5,15.5490785 11.5855665,18.5 8,18.5 C5.525182,18.5 3.37015673,17.0943182 2.27242753,15.0235117 Z M15.999821,11.9547651 C15.9999402,11.9698392 16,11.9849176 16,12 C16,12.0581275 15.9984809,12.1163475 15.9954873,12.1746435 C15.9978914,12.1015915 15.9993401,12.0282946 15.999821,11.9547651 Z",fillOpacity:"0.2"}),Fr.default.createElement("path",{d:"M3.47269084,16.6357644 C3.47244857,13.6389249 9.59189484,15.3529683 12,11.5 C13.2066771,9.56931667 12.316614,7.05620551 11.0727604,4.97270186 C13.0737756,7.26814668 14.316054,9.51197209 14.481291,11.4644804 C14.4937541,11.6117488 14.5,11.7569175 14.5,11.9 C14.5,15.5490785 11.5855665,18.5 8,18.5 C6.2411126,18.5 4.64375705,17.7899702 3.47269084,16.6357644 Z",fillOpacity:"0.25"}),Fr.default.createElement("path",{d:"M7.73975027,2.16383649 C6.84545319,2.94914111 5.95084629,3.82194197 5.11973623,4.75434357 C3.00603518,7.12565193 1.68918197,9.45010207 1.51870896,11.4644804 C1.50624591,11.6117488 1.5,11.7569175 1.5,11.9 C1.5,15.5492218 4.41434886,18.5 8,18.5 C11.5855665,18.5 14.5,15.5490785 14.5,11.9 C14.5,11.7569175 14.4937541,11.6117488 14.481291,11.4644804 C14.310818,9.45010207 12.9939648,7.12565193 10.8802638,4.75434357 C10.0491537,3.82194197 9.15454681,2.94914111 8.26024973,2.16383649 C8.17157048,2.08596503 8.08476013,2.01060875 8,1.93784184 C7.91523987,2.01060875 7.82842952,2.08596503 7.73975027,2.16383649 Z M8,20 C3.581722,20 0,16.3735065 0,11.9 C0,6.05 8,0 8,0 C8,0 16,6.05 16,11.9 C16,16.3732777 12.418278,20 8,20 Z",fillOpacity:"0.87"})))))),I2=k3;var $a=y(require("react")),T3=()=>$a.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",focusable:"false","aria-hidden":"true","aria-label":"Frames",width:"48",height:"48",viewBox:"0 0 48 48"},$a.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(12 12)"},$a.default.createElement("path",{fillOpacity:"0.2",d:"M8 8L17 7 17 17 7 17z"}),$a.default.createElement("path",{fillOpacity:"0.87",d:"M4.5 19.5h15v-15h-15v15zM3 3h18v18H3V3z"}),$a.default.createElement("path",{fillOpacity:"0.87",d:"M7 17h10V7H7v10zM6 6h12v12H6V6z"}),$a.default.createElement("path",{fillOpacity:"0.25",d:"M9 15L11 12 13 14 14 13.5 15 15z"}))),E2=T3;var nr=y(require("react")),D3=()=>nr.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Library",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},nr.default.createElement("g",{fill:"none",fillRule:"evenodd"},nr.default.createElement("g",{transform:"translate(15 15)",fill:"currentColor"},nr.default.createElement("g",null,nr.default.createElement("polygon",{fillOpacity:"0.2",points:"3 3 12.5 1.5 12.5 15.5 1.5 15.5"}),nr.default.createElement("path",{d:"M1.5,1.5 L1.5,15.5 L12.5,15.5 L12.5,1.5 L1.5,1.5 Z M0,0 L14,0 L14,17 L0,17 L0,0 Z",fillOpacity:"0.87"}),nr.default.createElement("polygon",{fillOpacity:"0.25",points:"3 11 6 7 8 9 9 8.5 11 11"}),nr.default.createElement("circle",{fillOpacity:"0.25",cx:"9",cy:"5",r:"1"}),nr.default.createElement("rect",{fillOpacity:"0.25",x:"3",y:"13",width:"8",height:"1"}),nr.default.createElement("g",{transform:"rotate(14 -2.352 56.952)",fillOpacity:"0.2"},nr.default.createElement("path",{d:"M1.32904158,1.07500967e-13 L5,1.07500967e-13 L5,14.7234101 L4,10.7126291 L4,1 L1.57836958,1 L1.32904158,1.07500967e-13 Z M5,14.9745817 L5,16 L0.887271787,16 L5,14.9745817 Z"}),nr.default.createElement("path",{d:"M1.82769758,2 L3,2 L3,6.70184819 L1.82769758,2 Z"})))))),A2=D3;var gc=y(require("react")),I3=()=>gc.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Overlays",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},gc.default.createElement("g",{fill:"none",fillRule:"evenodd"},gc.default.createElement("g",{transform:"translate(15 15)",fill:"currentColor"},gc.default.createElement("path",{d:"M13.5,4 L13.5,13.5 L4,13.5 L4,5 C4,4.44771525 4.44771525,4 5,4 L13.5,4 Z M15,4 L17,4 C17.5522847,4 18,4.44771525 18,5 L18,17 C18,17.5522847 17.5522847,18 17,18 L5,18 C4.44771525,18 4,17.5522847 4,17 L4,15 L14,15 C14.5522847,15 15,14.5522847 15,14 L15,4 Z",fillOpacity:"0.2"}),gc.default.createElement("path",{d:"M1.5,1.5 L1.5,13.5 L13.5,13.5 L13.5,1.5 L1.5,1.5 Z M1,0 L14,0 C14.5522847,-1.01453063e-16 15,0.44771525 15,1 L15,14 C15,14.5522847 14.5522847,15 14,15 L1,15 C0.44771525,15 6.76353751e-17,14.5522847 0,14 L0,1 C-6.76353751e-17,0.44771525 0.44771525,1.01453063e-16 1,0 Z",fillOpacity:"0.87"})))),F2=I3;var Ao=y(require("react")),E3=()=>Ao.default.createElement("svg",{focusable:"false","aria-hidden":"true",width:"48px",height:"48px",version:"1.1",xmlns:"http://www.w3.org/2000/svg","aria-label":"Stickers",viewBox:"0 0 48 48"},Ao.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Ao.default.createElement("g",null,Ao.default.createElement("g",{transform:"translate(14.000000, 14.000000)",fill:"currentColor"},Ao.default.createElement("g",{transform:"translate(2.000000, 2.000000)",fillOpacity:"0.2"},Ao.default.createElement("path",{d:"M11.5840291,0.290311095 C14.1040281,1.4637822 15.9529364,3.83641178 16.3972985,6.6747443 C11.4538042,7.5567274 7.55733385,11.4556991 6.68374109,16.3973312 C3.83946575,15.9530468 1.46423317,14.1041207 0.290132399,11.5832649 C0.0988489957,10.7650202 3.01980663e-14,9.89786431 3.01980663e-14,9 C3.01980663e-14,6.64646143 0.903391324,4.50392121 2.38232909,2.90022422 C4.02683831,1.11698861 6.38297582,-3.55271368e-15 9,-3.55271368e-15 C9.89814387,-3.55271368e-15 10.7655602,0.0989105588 11.5840291,0.290311095 Z"}),Ao.default.createElement("path",{d:"M17.9877222,8 L8,17.9877222 C8.2591955,12.5923102 12.5906864,8.26470667 17.9877222,8 Z"})),Ao.default.createElement("path",{d:"M9.87290303,14.9211604 C9.09408801,14.4293124 5,11.7146562 5,9 C5,7.34 6.34,6 8,6 C8.77,6 9.47,6.52 10,7 C10.53,6.52 11.23,6 12,6 C13.66,6 15,7.34 15,9 C15,9.30171667 14.9494261,9.60343334 14.8584511,9.90209822 C12.7354304,11.0373368 10.9933363,12.7905402 9.87290303,14.9211604 Z",fillOpacity:"0.25"}),Ao.default.createElement("path",{d:"M10,1.5 C5.30557963,1.5 1.5,5.30557963 1.5,10 C1.5,14.2449983 4.61102233,17.7611603 8.68374109,18.3973312 C9.55733385,13.4556991 13.4538042,9.5567274 18.3972985,8.6747443 C17.7608961,4.60976745 14.2436106,1.5 10,1.5 Z M0,10 C0,4.4771525 4.4771525,0 10,0 C15.5228475,0 20,4.4771525 20,10 C14.5988732,10.2649073 10.2649073,14.5988732 10.0116954,19.9999933 C4.4771525,20 0,15.5228475 0,10 Z",fillOpacity:"0.87"}))))),O2=E3;var bc=y(require("react")),A3=()=>bc.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",focusable:"false","aria-hidden":"true","aria-label":"Texts",width:"48",height:"48"},bc.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},bc.default.createElement("path",{fillOpacity:"0.2",d:"M17.883 19.5H16.07L11.702 6.833l1.235-1.411L17.883 19.5z",transform:"translate(12 12)"}),bc.default.createElement("path",{fillOpacity:"0.87",d:"M10.8 8.818L8.483 14.5h4.275l-1.96-5.682zM10 6.5l3.5-4 5.973 17H21V21h-8v-1.5h1.483L13.276 16H7.873l-1.426 3.5H8V21H3v-1.5h1.704L10 6.5zm1.702.333L16.069 19.5h1.814L12.937 5.422l-1.235 1.411z",transform:"translate(12 12)"}),bc.default.createElement("path",{fillOpacity:"0.2",d:"M19.55 15l-.35-1H21v1h-1.45zm1.05 3l-.35-1H21v1h-.4zM7.639 8L7.25 9H3V8h4.639zm1.167-3l-.39 1H7V5h1.806zm-2.334 6l-.389 1H6v-1h.472zm-1.166 3l-.39 1H3v-1h2.306zm-1.167 3l-.389 1H3v-1h1.139zM15.35 3L15 2h1v1h-.65zm3.15 9l-.35-1H21v1h-2.5zm-1.05-3l-.35-1H21v1h-3.55zM16.4 6l-.35-1H18v1h-1.6zm-5.9-3H9V2h2.5l-1 1zM3 5h3v1H3V5zm16 0h2v1h-2V5zM3 11h2v1H3v-1zm18-8h-4V2h4v1zM8 3H3V2h5v1z",transform:"translate(12 12)"}))),R2=A3;var _c=y(require("react")),F3=()=>_c.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Text Design",width:"48",height:"48",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},_c.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},_c.default.createElement("path",{fillOpacity:"0.87",d:"M1 0h14a1 1 0 011 1v19l-8-6-8 6V1a1 1 0 011-1zm.5 1.5V17L8 12.125 14.5 17V1.5h-13z",transform:"translate(14 14) translate(2)"}),_c.default.createElement("path",{fillOpacity:"0.2",d:"M1.5 1.5h13V17L8 12.125 1.5 17V1.5z",transform:"translate(14 14) translate(2)"}),_c.default.createElement("path",{fillOpacity:"0.25",d:"M9 4l2.52 7H10.2l-.7-1.85H6.45L5.77 11H4.49L6.9 4H9zm-1.04.78h-.05L6.73 8.14H9.2L7.96 4.78z",transform:"translate(14 14) translate(2)"}))),P2=F3;var Wn=y(require("react"));function O3(){return Wn.default.createElement("svg",{focusable:"false","aria-hidden":"true","aria-label":"Transform",width:"48",height:"48",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},Wn.default.createElement("g",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(12 12)"},Wn.default.createElement("path",{fillOpacity:"0.2",d:"M10 10L15 9 15 15 9 15z"}),Wn.default.createElement("path",{fillOpacity:"0.87",d:"M9 15h6V9H9v6zm-1.5 0V7.5H15V3h1.5v13.5H3V15h4.5zm0 2.5H9V21H7.5v-3.5zM21 7.5V9h-3.5V7.5H21z"}),Wn.default.createElement("g",{fillOpacity:"0.2"},Wn.default.createElement("path",{d:"M0 10h1a9.003 9.003 0 015.5-8.294L7 3 10.942.044C10.632.014 10.318 0 10 0 4.477 0 0 4.477 0 10z",transform:"translate(2 2)"}),Wn.default.createElement("path",{d:"M9 20h1a9.003 9.003 0 015.5-8.294L16 13l3.942-2.956c-.31-.03-.624-.044-.942-.044-5.523 0-10 4.477-10 10z",transform:"translate(2 2) rotate(-180 14.47 15)"}))))}var B2=O3;var Gn=y(require("react")),R3=()=>Gn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Gn.default.createElement("defs",null,Gn.default.createElement("path",{id:"photoeditorsdk-icon-add-text",d:"M12 0c6.627 0 12 5.373 12 12s-5.373 12-12 12S0 18.627 0 12 5.373 0 12 0zm1 6h-2v5H6v2h5v5h2v-5h5v-2h-5V6z"})),Gn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Gn.default.createElement("mask",{fill:"currentColor"},Gn.default.createElement("use",{xlinkHref:"#photoeditorsdk-icon-add-text"})),Gn.default.createElement("use",{fill:"currentColor",fillRule:"nonzero",xlinkHref:"#photoeditorsdk-icon-add-text"}))),M2=R3;var Cx=y(require("react")),P3=()=>Cx.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Cx.default.createElement("path",{fill:"currentColor",fillOpacity:"0.9",fillRule:"evenodd",stroke:"none",strokeWidth:"1",d:"M12 1c5.523 0 10 4.477 10 10a9.98 9.98 0 01-3.678 7.749c1.877.92 3.445 2.251 4.502 3.88l.176.283-1.743 1.02c-1.04-1.735-2.824-3.102-4.995-3.884A9.94 9.94 0 0112 21a9.962 9.962 0 01-4.255-.948c-2.076.748-3.797 2.033-4.852 3.661l-.147.237L1 22.935c1.053-1.766 2.694-3.204 4.684-4.183A9.975 9.975 0 012 11C2 5.477 6.477 1 12 1zm0 2a8 8 0 100 16 8 8 0 000-16zm0 5a5 5 0 110 10 5 5 0 010-10zm0 2a3 3 0 100 6 3 3 0 000-6zm1-4v1h-2V6h2z"})),L2=P3;var Sx=y(require("react")),B3=()=>Sx.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},Sx.default.createElement("path",{fill:"currentColor",fillOpacity:"0.9",fillRule:"evenodd",stroke:"none",strokeWidth:"1",d:"M16.23 10.885a2.292 2.292 0 00-2.285-2.286 2.292 2.292 0 00-2.286 2.286 2.292 2.292 0 002.286 2.286 2.292 2.292 0 002.286-2.286zM13.946.599C8.265.6 3.66 5.205 3.66 10.885H.231l4.571 4.571 4.572-4.571H5.945c0-4.423 3.577-8 8-8s8 3.577 8 8a7.994 7.994 0 01-12.64 6.514l-1.623 1.646a10.3 10.3 0 006.263 2.126c5.68 0 10.286-4.606 10.286-10.286S19.625.599 13.945.599z",transform:"rotate(56 11.298 10.261)"})),z2=B3;var Vn=y(require("react"));function M3(){return Vn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Vn.default.createElement("defs",null,Vn.default.createElement("path",{id:"photoeditorsdk-shuffle-icon",d:"M24 10v8a3 3 0 01-3 3H6v3l-6-4 6-4v3h15a1 1 0 001-1v-8h2zM18 0l6 4-6 4V5H3a1 1 0 00-1 1v8H0V6a3 3 0 013-3h15V0z"})),Vn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Vn.default.createElement("mask",{fill:"currentColor"},Vn.default.createElement("use",{xlinkHref:"#photoeditorsdk-shuffle-icon"})),Vn.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-shuffle-icon"})))}var U2=M3;var jn=y(require("react")),L3=()=>jn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},jn.default.createElement("defs",null,jn.default.createElement("path",{id:"photoeditorsdk-upload-icon",d:"M4.143 17.286l-.001 3.142h15.715v-3.142H23v6.285H1v-6.285h3.143zM12 0l9.429 9.429-2.2 2.2L13.57 5.97v9.743H10.43V5.971L4.77 11.63l-2.2-2.2L12 0z"})),jn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},jn.default.createElement("mask",{fill:"currentColor"},jn.default.createElement("use",{xlinkHref:"#photoeditorsdk-upload-icon"})),jn.default.createElement("use",{fill:"currentColor",xlinkHref:"#photoeditorsdk-upload-icon"}))),N2=L3;var Bs=y(require("react")),z3=()=>Bs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Bs.default.createElement("defs",null,Bs.default.createElement("path",{id:"photoeditorsdk-bring-to-front-icon",d:"M21 16a2 2 0 012 2v4a2 2 0 01-2 2H3a2 2 0 01-2-2v-4a2 2 0 012-2h18zM12.006 1l5.996 5.996-1.414 1.414-3.578-3.577V12h-2.008V4.833L7.418 8.417 6.004 7.003 12.006 1z"})),Bs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Bs.default.createElement("path",{d:"M0 0H24V24H0z"}),Bs.default.createElement("mask",{fill:"currentColor"},Bs.default.createElement("use",{xlinkHref:"#photoeditorsdk-bring-to-front-icon"})),Bs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-bring-to-front-icon"}))),H2=z3;var Ne=y(require("react")),U3=({highlight:i="currentColor",width:t=48,height:e=48})=>Ne.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:e,viewBox:"0 0 48 48"},Ne.default.createElement("g",{fill:"none",fillOpacity:"0.9",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ne.default.createElement("g",{fill:i,transform:"translate(13 13)"},Ne.default.createElement("path",{d:"M22 3.701h-1.642V1.644l-2.06-.001V0h2.538c.421 0 .682.174.827.32.322.322.337.748.337.83v2.551z"}),Ne.default.createElement("path",{d:"M1.643 3.701H0V1.165C0 .743.174.482.32.336.64.016 1.06 0 1.147 0H3.701v1.643H1.644l-.001 2.058z"}),Ne.default.createElement("path",{d:"M13.7232174 1.5486087L17.4249565 1.5486087 17.4249565 0 13.7232174 0z"}),Ne.default.createElement("path",{d:"M9.15008696 1.5486087L12.8508696 1.5486087 12.8508696 0 9.15008696 0z"}),Ne.default.createElement("path",{d:"M4.57504348 1.5486087L8.27678261 1.5486087 8.27678261 0 4.57504348 0z"}),Ne.default.createElement("path",{d:"M0 8.27582609L1.5486087 8.27582609 1.5486087 4.57504348 0 4.57504348z"}),Ne.default.createElement("path",{d:"M20.4513913 8.27582609L22 8.27582609 22 4.57504348 20.4513913 4.57504348z"}),Ne.default.createElement("path",{d:"M0 12.8508696L1.5486087 12.8508696 1.5486087 9.14913043 0 9.14913043z"}),Ne.default.createElement("path",{d:"M0 17.4249565L1.5486087 17.4249565 1.5486087 13.7232174 0 13.7232174z"}),Ne.default.createElement("path",{d:"M20.4513913 12.8508696L22 12.8508696 22 9.14913043 20.4513913 9.14913043z"}),Ne.default.createElement("path",{d:"M20.4513913 17.4249565L22 17.4249565 22 13.7232174 20.4513913 13.7232174z"}),Ne.default.createElement("path",{d:"M3.702 22H1.165c-.421 0-.682-.174-.828-.32-.322-.322-.337-.748-.337-.83v-2.552h1.643v2.059h2.059V22z"}),Ne.default.createElement("path",{d:"M20.853 22h-2.554v-1.642h2.057l.001-2.06H22v2.538c0 .42-.174.682-.319.827-.32.32-.742.337-.828.337"}),Ne.default.createElement("path",{d:"M4.57504348 22L8.27678261 22 8.27678261 20.4513913 4.57504348 20.4513913z"}),Ne.default.createElement("path",{d:"M9.15008696 22L12.8508696 22 12.8508696 20.4513913 9.15008696 20.4513913z"}),Ne.default.createElement("path",{d:"M13.7232174 22L17.4249565 22 17.4249565 20.4513913 13.7232174 20.4513913z"})))),W2=U3;var ef=y(require("react")),N3=({highlight:i="currentColor",width:t=48,height:e=48})=>ef.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:e,viewBox:"0 0 48 48"},ef.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},ef.default.createElement("path",{fill:i,d:"M29.967 13.005L26.984 13c-3.35 0-5.516 2.222-5.516 5.66v2.61h-2.999c-.26 0-.469.21-.469.47v3.78c0 .26.21.47.469.47h2.999v9.541c0 .26.21.469.469.469h3.912c.26 0 .47-.21.47-.469V25.99h3.506c.259 0 .469-.21.469-.47l.001-3.78a.47.47 0 00-.469-.47h-3.508v-2.212c0-1.064.254-1.603 1.639-1.603l2.01-.001c.258 0 .468-.21.468-.47v-3.51a.47.47 0 00-.468-.47z"}))),G2=N3;var Ya=y(require("react")),H3=({highlight:i="currentColor",width:t=48,height:e=48})=>Ya.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:e,viewBox:"0 0 48 48"},Ya.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ya.default.createElement("g",{fill:i,transform:"translate(13 13)"},Ya.default.createElement("path",{d:"M15.125 0h-8.25A6.876 6.876 0 000 6.875v8.25A6.876 6.876 0 006.875 22h8.25A6.876 6.876 0 0022 15.125v-8.25A6.876 6.876 0 0015.125 0zm4.813 15.125a4.818 4.818 0 01-4.813 4.813h-8.25a4.818 4.818 0 01-4.813-4.813v-8.25a4.818 4.818 0 014.813-4.813h8.25a4.818 4.818 0 014.813 4.813v8.25z"}),Ya.default.createElement("path",{d:"M11 5.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zm0 8.938A3.442 3.442 0 017.562 11 3.441 3.441 0 0111 7.562 3.441 3.441 0 0114.438 11 3.442 3.442 0 0111 14.438z"}),Ya.default.createElement("circle",{cx:"16.913",cy:"5.088",r:"1"})))),V2=H3;var rf=y(require("react")),W3=({highlight:i="currentColor",width:t=48,height:e=48})=>rf.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:e,viewBox:"0 0 48 48"},rf.default.createElement("g",{fill:"none",fillOpacity:"0.9",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},rf.default.createElement("path",{fill:i,d:"M36 17.305c-.892.402-1.843.668-2.835.797a4.997 4.997 0 002.165-2.79 9.685 9.685 0 01-3.12 1.222 4.874 4.874 0 00-3.595-1.596c-2.723 0-4.916 2.267-4.916 5.047 0 .4.032.785.113 1.151-4.09-.205-7.71-2.215-10.141-5.278a5.18 5.18 0 00-.673 2.55c0 1.748.877 3.297 2.185 4.194a4.766 4.766 0 01-2.223-.621v.055c0 2.452 1.705 4.49 3.942 4.958-.4.113-.837.167-1.29.167-.315 0-.633-.019-.931-.087.637 1.999 2.446 3.468 4.597 3.516a9.73 9.73 0 01-6.1 2.152c-.404 0-.791-.018-1.178-.07a13.601 13.601 0 007.548 2.266c9.054 0 14.004-7.693 14.004-14.36 0-.224-.008-.439-.018-.653A9.958 9.958 0 0036 17.305z"}))),j2=W3;var $2=y(require("styled-components")),G3=$2.default.svg.attrs({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"})``,xi=G3;var Zt=y(require("react"));var V3=({highlight:i="#565656",width:t=32,height:e=32})=>Zt.default.createElement(xi,{width:t,height:e,viewBox:"0 0 32 32"},Zt.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Zt.default.createElement("g",{fill:i,transform:"translate(-8 -8)"},Zt.default.createElement("g",{transform:"translate(8 8)"},Zt.default.createElement("g",null,Zt.default.createElement("path",{d:"M.941 31.992h2.824v-.94L.941 31.05v-2.822h-.94v2.846s-.004.918.94.918"}),Zt.default.createElement("path",{d:"M31.974 31.051v-2.823h-.942v2.823h-2.823v.941h2.846s.919.003.919-.94"}),Zt.default.createElement("path",{d:"M4.62305882 31.9926588L8.38776471 31.9926588 8.38776471 31.0514824 4.62305882 31.0514824z"}),Zt.default.createElement("path",{d:"M9.32894118 31.9926588L13.0936471 31.9926588 13.0936471 31.0514824 9.32894118 31.0514824z"}),Zt.default.createElement("path",{d:"M14.0348235 31.9926588L17.7995294 31.9926588 17.7995294 31.0514824 14.0348235 31.0514824z"}),Zt.default.createElement("path",{d:"M18.7407059 31.9926588L22.5054118 31.9926588 22.5054118 31.0514824 18.7407059 31.0514824z"}),Zt.default.createElement("path",{d:"M23.4465882 31.9926588L27.2112941 31.9926588 27.2112941 31.0514824 23.4465882 31.0514824z"}),Zt.default.createElement("path",{d:"M0 .94v2.824h.941L.942.941h2.823V0H.919S0-.002 0 .94"}),Zt.default.createElement("path",{d:"M31.032 0H28.21v.94l2.823.002v2.822h.942V.92s.002-.92-.942-.92"}),Zt.default.createElement("path",{d:"M4.62305882 0.940423529L8.38776471 0.940423529 8.38776471 -0.000752941176 4.62305882 -0.000752941176z"}),Zt.default.createElement("path",{d:"M9.32894118 0.940423529L13.0936471 0.940423529 13.0936471 -0.000752941176 9.32894118 -0.000752941176z"}),Zt.default.createElement("path",{d:"M14.0348235 0.940423529L17.7995294 0.940423529 17.7995294 -0.000752941176 14.0348235 -0.000752941176z"}),Zt.default.createElement("path",{d:"M18.7407059 0.940423529L22.5054118 0.940423529 22.5054118 -0.000752941176 18.7407059 -0.000752941176z"}),Zt.default.createElement("path",{d:"M23.4465882 0.940423529L27.2112941 0.940423529 27.2112941 -0.000752941176 23.4465882 -0.000752941176z"}),Zt.default.createElement("path",{d:"M0 8.46324706L0.941176471 8.46324706 0.941176471 4.69854118 0 4.69854118z"}),Zt.default.createElement("path",{d:"M0 13.1691294L0.941176471 13.1691294 0.941176471 9.40442353 0 9.40442353z"}),Zt.default.createElement("path",{d:"M0 17.8750118L0.941176471 17.8750118 0.941176471 14.1103059 0 14.1103059z"}),Zt.default.createElement("path",{d:"M0 22.5808941L0.941176471 22.5808941 0.941176471 18.8161882 0 18.8161882z"}),Zt.default.createElement("path",{d:"M0 27.2867765L0.941176471 27.2867765 0.941176471 23.5220706 0 23.5220706z"}),Zt.default.createElement("path",{d:"M30.976 8.46324706L31.9171765 8.46324706 31.9171765 4.69854118 30.976 4.69854118z"}),Zt.default.createElement("path",{d:"M30.976 13.1691294L31.9171765 13.1691294 31.9171765 9.40442353 30.976 9.40442353z"}),Zt.default.createElement("path",{d:"M30.976 17.8750118L31.9171765 17.8750118 31.9171765 14.1103059 30.976 14.1103059z"}),Zt.default.createElement("path",{d:"M30.976 22.5808941L31.9171765 22.5808941 31.9171765 18.8161882 30.976 18.8161882z"}),Zt.default.createElement("path",{d:"M30.976 27.2867765L31.9171765 27.2867765 31.9171765 23.5220706 30.976 23.5220706z"})))))),Y2=V3;var Eu=y(require("react"));var j3=({highlight:i="#565656",width:t=32,height:e=48})=>Eu.default.createElement(xi,{width:t,height:e,viewBox:"0 0 42 32"},Eu.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Eu.default.createElement("g",{fill:i,transform:"translate(-3 -8)"},Eu.default.createElement("rect",{width:"42",height:"32",x:"3",y:"8",rx:"0.5"})))),K2=j3;var Au=y(require("react"));var $3=({highlight:i="#565656",width:t=26,height:e=46})=>Au.default.createElement(xi,{width:t,height:e,viewBox:"0 0 26 46"},Au.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Au.default.createElement("g",{fill:i,transform:"translate(-11 -1)"},Au.default.createElement("path",{d:"M1 11.496A.5.5 0 011.5 11h45a.5.5 0 01.5.496v25.008a.5.5 0 01-.5.496h-45a.5.5 0 01-.5-.496V11.496z",transform:"rotate(90 24 24)"})))),X2=$3;var Fu=y(require("react"));var Y3=({highlight:i="#565656",width:t=26,height:e=46})=>Fu.default.createElement(xi,{width:t,height:e,viewBox:"0 0 26 46"},Fu.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Fu.default.createElement("g",{fill:i,transform:"translate(-11 -1)"},Fu.default.createElement("path",{d:"M1 11.496A.5.5 0 011.5 11h45a.5.5 0 01.5.496v25.008a.5.5 0 01-.5.496h-45a.5.5 0 01-.5-.496V11.496z"})))),q2=Y3;var Fo=y(require("react"));var K3=({highlight:i="#565656",mask:t="#fff",width:e=32,height:r=32})=>Fo.default.createElement(xi,{width:e,height:r,viewBox:"0 0 32 32"},Fo.default.createElement("defs",null,Fo.default.createElement("rect",{id:"photoeditorsdk-square-icon",width:"32",height:"32",x:"0.92",y:"0.707",rx:"1"})),Fo.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Fo.default.createElement("g",{transform:"translate(-8 -8)"},Fo.default.createElement("g",{transform:"translate(7.08 7.293)"},Fo.default.createElement("mask",{fill:t},Fo.default.createElement("use",{xlinkHref:"#photoeditorsdk-square-icon"})),Fo.default.createElement("use",{fill:i,xlinkHref:"#photoeditorsdk-square-icon"}))))),Z2=K3;var Ou=y(require("react"));var X3=({highlight:i="#565656",width:t=32,height:e=42})=>Ou.default.createElement(xi,{width:t,height:e,viewBox:"0 0 32 42"},Ou.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ou.default.createElement("g",{fill:i,transform:"translate(-8 -3)"},Ou.default.createElement("rect",{width:"42",height:"32",x:"3",y:"8",rx:"0.5",transform:"rotate(90 24 24)"})))),J2=X3;var Oo=y(require("react")),q3=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>Oo.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},Oo.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Oo.default.createElement("rect",{width:"28",height:"3",x:"12",y:"41",fill:i,rx:"0.5",transform:"matrix(-1 0 0 1 52 0)"}),Oo.default.createElement("rect",{width:"34",height:"28",x:"7",y:"8",fill:t,rx:"0.5",transform:"matrix(1 0 0 -1 0 44)"}),Oo.default.createElement("rect",{width:"3",height:"3",x:"8",y:"41",fill:i,rx:"0.5",transform:"matrix(-1 0 0 1 19 0)"}),Oo.default.createElement("rect",{width:"28",height:"3",x:"12",y:"37",fill:i,rx:"0.5",transform:"matrix(-1 0 0 1 52 0)"}),Oo.default.createElement("rect",{width:"28",height:"3",x:"12",y:"4",fill:i,rx:"0.5",transform:"matrix(1 0 0 -1 0 11)"}),Oo.default.createElement("rect",{width:"3",height:"3",x:"8",y:"37",fill:i,rx:"0.5",transform:"matrix(-1 0 0 1 19 0)"}),Oo.default.createElement("rect",{width:"3",height:"3",x:"8",y:"4",fill:i,rx:"0.5",transform:"matrix(1 0 0 -1 0 11)"}))),Q2=q3;var Ro=y(require("react")),Z3=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>Ro.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},Ro.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ro.default.createElement("g",null,Ro.default.createElement("path",{fill:i,d:"M42 5a1 1 0 011 1v13a1 1 0 01-1 1H6a1 1 0 01-1-1V6a1 1 0 011-1h36zM21.505 18h-2.01a.494.494 0 00-.495.5c0 .268.222.5.495.5h2.01c.28 0 .495-.224.495-.5l-.008-.088a.503.503 0 00-.487-.412zm8.004 0h-5.018a.5.5 0 000 1h5.018a.5.5 0 00.491-.5l-.008-.088A.5.5 0 0029.51 18z"}),Ro.default.createElement("rect",{width:"22",height:"11",x:"20",y:"29",fill:i,rx:"1"}),Ro.default.createElement("rect",{width:"13",height:"10",x:"6",y:"23",fill:i,rx:"1"}),Ro.default.createElement("rect",{width:"22",height:"5",x:"20",y:"23",fill:i,rx:"1"}),Ro.default.createElement("rect",{width:"7",height:"7",x:"9",y:"14",fill:t,rx:"1"}),Ro.default.createElement("rect",{width:"13",height:"9",x:"6",y:"34",fill:i,rx:"1"})))),tT=Z3;var Po=y(require("react")),J3=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>Po.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},Po.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Po.default.createElement("g",{transform:"translate(5 5)"},Po.default.createElement("path",{fill:t,d:"M37 0a1 1 0 011 1v13a1 1 0 01-1 1H1a1 1 0 01-1-1V1a1 1 0 011-1h36zM16.505 13h-2.01a.494.494 0 00-.495.5c0 .268.222.5.495.5h2.01c.28 0 .495-.224.495-.5l-.008-.088a.503.503 0 00-.487-.412zm8.004 0h-5.018a.5.5 0 000 1h5.018a.5.5 0 00.491-.5l-.008-.088A.5.5 0 0024.51 13z"}),Po.default.createElement("rect",{width:"22",height:"11",x:"15",y:"24",fill:i,rx:"1"}),Po.default.createElement("rect",{width:"13",height:"10",x:"1",y:"18",fill:i,rx:"1"}),Po.default.createElement("rect",{width:"22",height:"5",x:"15",y:"18",fill:i,rx:"1"}),Po.default.createElement("rect",{width:"7",height:"7",x:"4",y:"9",fill:i,rx:"1"}),Po.default.createElement("rect",{width:"13",height:"9",x:"1",y:"29",fill:i,rx:"1"})))),eT=J3;var Ms=y(require("react")),Q3=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>Ms.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},Ms.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ms.default.createElement("rect",{width:"26",height:"7",x:"7",y:"18",fill:i,rx:"1"}),Ms.default.createElement("rect",{width:"9",height:"7",x:"34",y:"11",fill:i,rx:"1"}),Ms.default.createElement("rect",{width:"9",height:"8",x:"34",y:"19",fill:i,rx:"1"}),Ms.default.createElement("rect",{width:"3",height:"3",x:"40",y:"6",fill:i,rx:"1"}),Ms.default.createElement("rect",{width:"26",height:"21",x:"7",y:"27",fill:i,rx:"1"}),Ms.default.createElement("rect",{width:"26",height:"16",x:"7",y:"5",fill:t,rx:"1"}))),iT=Q3;var Ls=y(require("react")),tz=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>Ls.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},Ls.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ls.default.createElement("rect",{width:"26",height:"7",x:"7",y:"34",fill:i,rx:"1"}),Ls.default.createElement("rect",{width:"26",height:"32",x:"7",y:"5",fill:t,rx:"1"}),Ls.default.createElement("rect",{width:"9",height:"7",x:"34",y:"11",fill:i,rx:"1"}),Ls.default.createElement("rect",{width:"9",height:"8",x:"34",y:"19",fill:i,rx:"1"}),Ls.default.createElement("rect",{width:"3",height:"3",x:"40",y:"6",fill:i,rx:"1"}),Ls.default.createElement("rect",{width:"26",height:"5",x:"7",y:"43",fill:i,rx:"1"}))),rT=tz;var zs=y(require("react")),ez=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>zs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},zs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},zs.default.createElement("rect",{width:"26",height:"7",x:"7",y:"28",fill:i,rx:"1"}),zs.default.createElement("rect",{width:"26",height:"26",x:"7",y:"5",fill:t,rx:"1"}),zs.default.createElement("rect",{width:"9",height:"7",x:"34",y:"11",fill:i,rx:"1"}),zs.default.createElement("rect",{width:"9",height:"8",x:"34",y:"19",fill:i,rx:"1"}),zs.default.createElement("rect",{width:"3",height:"3",x:"40",y:"6",fill:i,rx:"1"}),zs.default.createElement("rect",{width:"26",height:"11",x:"7",y:"37",fill:i,rx:"1"}))),oT=ez;var Ru=y(require("react")),iz=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>Ru.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},Ru.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Ru.default.createElement("rect",{width:"20",height:"34",x:"14",y:"10",fill:t,rx:"1.5"}),Ru.default.createElement("rect",{width:"3",height:"3",x:"14",y:"5",fill:i,rx:"1"}))),sT=iz;var vi=y(require("react")),rz=({main:i="#424242",highlight:t="#565656",shadow:e="#333333",width:r="48px",height:o="48px"})=>vi.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:r,height:o,viewBox:"0 0 48 48"},vi.default.createElement("defs",null,vi.default.createElement("filter",{id:"photoeditorsdk-twitter-post-icon",width:"166.7%",height:"166.7%",x:"-33.3%",y:"-33.3%",filterUnits:"objectBoundingBox"},vi.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1"}))),vi.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},vi.default.createElement("rect",{width:"38",height:"15",x:"5",y:"5",fill:i,rx:"0.5"}),vi.default.createElement("rect",{width:"11",height:"1",x:"5",y:"24",fill:i,rx:"0.5"}),vi.default.createElement("rect",{width:"11",height:"1",x:"5",y:"26",fill:i,rx:"0.5"}),vi.default.createElement("rect",{width:"11",height:"1",x:"5",y:"28",fill:i,rx:"0.5"}),vi.default.createElement("rect",{width:"26",height:"13",x:"17",y:"24",fill:t,rx:"0.5"}),vi.default.createElement("rect",{width:"26",height:"3",x:"17",y:"38",fill:i,rx:"0.5"}),vi.default.createElement("rect",{width:"26",height:"3",x:"17",y:"42",fill:i,rx:"0.5"}),vi.default.createElement("rect",{width:"9",height:"9",x:"8",y:"13",fill:e,filter:"url(#photoeditorsdk-twitter-post-icon)",rx:"1"}),vi.default.createElement("rect",{width:"7",height:"7",x:"9",y:"14",fill:i,rx:"1"}))),nT=rz;var Qr=y(require("react")),oz=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>Qr.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},Qr.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Qr.default.createElement("rect",{width:"38",height:"15",x:"5",y:"5",fill:i,rx:"0.5"}),Qr.default.createElement("rect",{width:"11",height:"1",x:"5",y:"24",fill:i,rx:"0.5"}),Qr.default.createElement("rect",{width:"11",height:"1",x:"5",y:"26",fill:i,rx:"0.5"}),Qr.default.createElement("rect",{width:"11",height:"1",x:"5",y:"28",fill:i,rx:"0.5"}),Qr.default.createElement("rect",{width:"26",height:"13",x:"17",y:"24",fill:i,rx:"0.5"}),Qr.default.createElement("rect",{width:"26",height:"3",x:"17",y:"38",fill:i,rx:"0.5"}),Qr.default.createElement("rect",{width:"26",height:"3",x:"17",y:"42",fill:i,rx:"0.5"}),Qr.default.createElement("rect",{width:"7",height:"7",x:"9",y:"14",fill:t,rx:"1"}))),aT=oz;var to=y(require("react")),sz=({main:i="#424242",highlight:t="#565656",width:e="48px",height:r="48px"})=>to.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:r,viewBox:"0 0 48 48"},to.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},to.default.createElement("rect",{width:"38",height:"15",x:"5",y:"5",fill:t,rx:"0.5"}),to.default.createElement("rect",{width:"11",height:"1",x:"5",y:"24",fill:i,rx:"0.5"}),to.default.createElement("rect",{width:"11",height:"1",x:"5",y:"26",fill:i,rx:"0.5"}),to.default.createElement("rect",{width:"11",height:"1",x:"5",y:"28",fill:i,rx:"0.5"}),to.default.createElement("rect",{width:"26",height:"13",x:"17",y:"24",fill:i,rx:"0.5"}),to.default.createElement("rect",{width:"26",height:"3",x:"17",y:"38",fill:i,rx:"0.5"}),to.default.createElement("rect",{width:"26",height:"3",x:"17",y:"42",fill:i,rx:"0.5"}),to.default.createElement("rect",{width:"7",height:"7",x:"9",y:"14",fill:i,rx:"1"}))),lT=sz;var $n=y(require("react")),nz=()=>$n.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},$n.default.createElement("defs",null,$n.default.createElement("path",{id:"photoeditorsdk-delete-icon",d:"M20 6l-2.312 15.718A1.5 1.5 0 0116.204 23H5.796a1.5 1.5 0 01-1.484-1.282L2 6h18zM7 1a1 1 0 011-1h6a1 1 0 011 1v1h7v2H0V2h7V1z"})),$n.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},$n.default.createElement("mask",{fill:"currentColor"},$n.default.createElement("use",{xlinkHref:"#photoeditorsdk-delete-icon"})),$n.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-delete-icon"}))),cT=nz;var ar=y(require("react")),az=({height:i=3,width:t=102,x:e=-102,className:r,style:o})=>ar.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:i,viewBox:"0 0 102 3",className:r,style:o},ar.default.createElement("pattern",{id:"photoeditorsdk-slider-dots",fill:"currentColor",patternUnits:"userSpaceOnUse",width:"102",height:"3"},ar.default.createElement("rect",{width:"3",height:"3",x:"99",y:"0",opacity:"0.5",rx:"1.5"}),ar.default.createElement("rect",{width:"3",height:"3",x:"88",y:"0",opacity:"0.5",rx:"1.5"}),ar.default.createElement("rect",{width:"3",height:"3",x:"77",y:"0",opacity:"0.5",rx:"1.5"}),ar.default.createElement("rect",{width:"3",height:"3",x:"66",y:"0",rx:"1.5"}),ar.default.createElement("rect",{width:"3",height:"3",x:"55",y:"0",opacity:"0.5",rx:"1.5"}),ar.default.createElement("rect",{width:"3",height:"3",x:"44",y:"0",opacity:"0.5",rx:"1.5"}),ar.default.createElement("rect",{width:"3",height:"3",x:"33",y:"0",opacity:"0.5",rx:"1.5"}),ar.default.createElement("rect",{width:"3",height:"3",x:"22",y:"0",opacity:"0.5",rx:"1.5"}),ar.default.createElement("rect",{width:"3",height:"3",x:"11",y:"0",rx:"1.5"})),ar.default.createElement("rect",{fill:"url(#photoeditorsdk-slider-dots)",x:-t*1.5,y:"0",width:t*4,height:"3",transform:`translate(${e}, 0)`})),dT=az;var Yn=y(require("react")),lz=()=>Yn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"},Yn.default.createElement("defs",null,Yn.default.createElement("path",{id:"photoeditorsdk-duplicate-icon",d:"M3.429 8.571v12h12v-12h-12zM1.714 5.143h15.429c.947 0 1.714.767 1.714 1.714v15.429c0 .946-.767 1.714-1.714 1.714H1.714A1.714 1.714 0 010 22.286V6.857c0-.947.768-1.714 1.714-1.714zM22.286 0C23.232 0 24 .768 24 1.714v15.429c0 .947-.768 1.714-1.714 1.714H20.57V3.429L5.142 3.428V1.714C5.143.768 5.91 0 6.858 0h15.429z"})),Yn.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},Yn.default.createElement("mask",{fill:"currentColor"},Yn.default.createElement("use",{xlinkHref:"#photoeditorsdk-duplicate-icon"})),Yn.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-duplicate-icon"}))),uT=lz;var wx=y(require("react")),cz=()=>wx.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},wx.default.createElement("path",{fill:"currentColor",fillRule:"evenodd",stroke:"none",strokeWidth:"1",d:"M2.087 7.115h7.66v15.32h5.027l.223-15.32h7.438V2.087H2.087v5.028zM14.075 24h-4.15a2.42 2.42 0 01-1.718-.711 2.423 2.423 0 01-.711-1.717V9.01H2.429c-.67 0-1.278-.273-1.718-.713A2.426 2.426 0 010 6.579V2.43C0 1.76.272 1.153.711.713A2.424 2.424 0 012.43 0h19.142c.671 0 1.278.272 1.718.713.439.44.711 1.047.711 1.718v4.148c0 .671-.272 1.278-.711 1.718-.44.44-1.047.713-1.718.713h-5.067v12.562c0 .67-.272 1.278-.711 1.717a2.42 2.42 0 01-1.718.711z"})),mT=cz;var Us=y(require("react")),dz=({className:i})=>Us.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 15 14",transform:"scale(-1, 1)",className:i},Us.default.createElement("title",null,"Flip Horizontal"),Us.default.createElement("defs",null,Us.default.createElement("path",{id:"photoeditorsdk-flip-horizontal-icon",d:"M42 1v14h-1.167v-1.167H37a2 2 0 01-2-2V4.167a2 2 0 012-2l3.833-.001V1H42zm5.833 11.958a.875.875 0 01-.875.875h-3.791v-1.166l3.499-.001V3.333h-3.5V2.167h3.792c.446 0 .815.333.869.765l.006.11v9.916z"})),Us.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(-34 -1)"},Us.default.createElement("mask",{fill:"none"},Us.default.createElement("use",{xlinkHref:"#photoeditorsdk-flip-horizontal-icon"})),Us.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-flip-horizontal-icon"}))),pT=dz;var Ns=y(require("react")),uz=({className:i})=>Ns.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 15 14",className:i},Ns.default.createElement("title",null,"Flip Vertical"),Ns.default.createElement("defs",null,Ns.default.createElement("path",{id:"photoeditorsdk-flip-vertical-icon",d:"M42 1v14h-1.167v-1.167H37a2 2 0 01-2-2V4.167a2 2 0 012-2l3.833-.001V1H42zm5.833 11.958a.875.875 0 01-.875.875h-3.791v-1.166l3.499-.001V3.333h-3.5V2.167h3.792c.446 0 .815.333.869.765l.006.11v9.916z"})),Ns.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(-34 -1)"},Ns.default.createElement("mask",{fill:"none"},Ns.default.createElement("use",{xlinkHref:"#photoeditorsdk-flip-vertical-icon"})),Ns.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",transform:"rotate(-90 41.417 8)",xlinkHref:"#photoeditorsdk-flip-vertical-icon"}))),hT=uz;var Hs=y(require("react")),mz=({alt:i="Rotate",className:t})=>Hs.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 16 16",className:t},Hs.default.createElement("title",null,i),Hs.default.createElement("defs",null,Hs.default.createElement("path",{id:"photoeditorsdk-rotate-icon",d:"M132 0l1.25 1.57a8.01 8.01 0 0110.41.77 8.015 8.015 0 010 11.32c-.33.33-.67.62-1.04.859-1.38.991-3 1.481-4.62 1.481v-2c1.22 0 2.44-.37 3.47-1.111a6 6 0 00.77-9.129 5.992 5.992 0 00-7.73-.63L136 5h-5l1-5zm2.43 12.82c.5.38 1.06.67 1.66.87l-.64 1.89a7.56 7.56 0 01-1.48-.67l-.03-.01v-.01h-.02v-.01h-.01c0-.01-.01-.01-.01-.01h-.01v-.01h-.02v-.01h-.01l-.01-.01s-.01 0-.01-.01h-.01c-.2-.12-.4-.26-.6-.4zm-2.15-3.02c.18.6.47 1.17.83 1.68l-1.63 1.16v-.01s-.01 0-.01-.01c0 0 0-.01-.01-.01v-.01h-.01v-.01c-.01 0-.01-.01-.01-.01v-.01h-.01v-.01h-.01v-.01c0-.01-.01-.01-.01-.01v-.01c-.01 0-.01 0-.01-.01-.27-.39-.49-.79-.68-1.21-.01 0-.01-.01-.01-.01v-.01h-.01v-.02l-.01-.01c0-.02-.01-.02-.01-.02v-.02h-.01v-.02h-.01v-.03h-.01v-.02h-.01v-.02c-.01 0-.01 0-.01-.01v-.01c-.1-.23-.19-.47-.26-.7z"})),Hs.default.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1",transform:"translate(-130)"},Hs.default.createElement("mask",{fill:"none"},Hs.default.createElement("use",{xlinkHref:"#photoeditorsdk-rotate-icon"})),Hs.default.createElement("use",{fill:"currentColor",fillOpacity:"0.9",xlinkHref:"#photoeditorsdk-rotate-icon"}))),fT=mz;var Ka={[C.ADJUSTMENT]:k2,[C.FILTER]:D2,[C.LIBRARY]:A2,[C.OVERLAY]:F2,[C.FOCUS]:I2,[C.STICKER]:O2,[C.TEXT]:R2,[C.TEXT_DESIGN]:P2,[C.FRAME]:E2,[C.TRANSFORM]:B2,[C.BRUSH]:T2},of={left:S2,right:w2,center:C2},ke={addText:M2,openWebcam:L2,reset:z2,shuffle:U2,uploadImage:N2},Pu={undo:v2,redo:x2,close:_2,export:y2},Nt={categories:{[be.CommonCategory]:W2,[be.FacebookCategory]:G2,[be.TwitterCategory]:j2,[be.InstagramCategory]:V2},crops:{[be.Custom]:Y2,[be.Square]:Z2,[be.ThreeByFour]:J2,[be.FourByThree]:K2,[be.NineBySixteen]:X2,[be.SixteenByNine]:q2,[be.FacebookPost]:Q2,[be.FacebookProfile]:tT,[be.FacebookTitle]:eT,[be.InstagramLandscape]:iT,[be.InstagramPortrait]:rT,[be.InstagramSquare]:oT,[be.InstagramStory]:sT,[be.TwitterPost]:nT,[be.TwitterProfile]:aT,[be.TwitterTitle]:lT},dots:dT,duplicate:uT,edit:mT,bringToFront:H2,delete:cT,flipHorizontal:pT,flipVertical:hT,rotate:fT},gT={[Et.BRIGHTNESS]:a2,[Et.CONTRAST]:c2,[Et.SATURATION]:p2,[Et.CLARITY]:l2,[Et.SHADOWS]:h2,[Et.HIGHLIGHTS]:m2,[Et.EXPOSURE]:d2,[Et.GAMMA]:u2,[Et.BLACKS]:n2,[Et.WHITES]:b2,[Et.TEMPERATURE]:g2,[Et.SHARPNESS]:f2};var bT=y(require("styled-components")),Kn=bT.default.div`
  display: flex;
  position: relative;
  flex-direction: column;
  width: 100%;
  height: 100%;
`;var Bu=y(require("styled-components"));var _T=Bu.default.div.attrs(()=>({"data-test":H.MainCanvasActionBar}))`
  &&& {
    display: ${i=>i.hide?"none":"flex"};
    flex-direction: row;
    align-items: center;
    height: ${i=>i.theme.measurements.mainCanvasActionBar.height}px;
    color: ${i=>i.theme.mainCanvasActionBar.foreground};
    border-bottom: 1px solid
      ${i=>i.theme.mainCanvasActionBar.borderColor};
    padding: 8px 24px;
    box-sizing: border-box;
    position: absolute;
    width: 100%;
    z-index: ${i=>i.theme.measurements.zIndex.canvas.bar};
    background: ${i=>i.transparentBackgound?"transparent":i.theme.mainCanvasActionBar.background};
    ${i=>i.bottom?Bu.css`
            justify-content: space-around;
            bottom: 0;
            transform: rotate(180deg);
          `:Bu.css`
            justify-content: space-between;
          `}
  }
`;var yT=y(require("styled-components")),xT=yT.default.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
`;var vT=y(require("styled-components")),CT=vT.default.div.attrs({role:"main"})`
  background-color: ${i=>i.theme.canvas.background};
  flex-grow: 1;
  flex-shrink: 1;
  flex-basis: auto;
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  /* added this for safari, else the webcam overlay did not know the height */
  height: 100%;
  width: 100%;
  margin-top: ${i=>i.theme.measurements.canvas.marginTop}px;
`;var ST=y(require("styled-components")),wT=ST.default.div.attrs(({height:i,width:t})=>({style:{height:`${i}px`,width:`${t}px`}}))`
  border-style: solid;
  border-width: 2px 0 2px 0;
  border-color: ${i=>i.theme.canvas.controlsOutline};
  box-shadow: 0 -6px 6px -6px rgba(0, 0, 0, 0.2),
    inset 0 6px 6px -6px rgba(0, 0, 0, 0.2);
  cursor: move;
  position: absolute;
`;var kT=y(require("styled-components")),TT=kT.default.div.attrs(({radius:i})=>({style:{height:`${i*2}px`,width:`${i*2}px`}}))`
  border-radius: 50%;
  border: 2px solid ${i=>i.theme.canvas.controlsOutline};
  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.2),
    inset 0 2px 6px 0 rgba(0, 0, 0, 0.2);
  cursor: move;
`;var DT=y(require("styled-components")),IT=DT.default.div`
  position: relative;
  height: inherit;
  width: inherit;
`;var pe=y(require("styled-components")),pz=pe.default.div(i=>{let{desktop:t,mobile:e}=i.theme.measurements.canvasControls.corner.touchable,r=t/4,o=e/2;return pe.css`
    position: absolute;
    width: ${t}px;
    height: ${t}px;
    ${s=>s.vertical==="top"?pe.css`
            top: 0px;
          `:pe.css`
            bottom: 0px;
          `}
    ${s=>s.horizontal==="left"?pe.css`
            left: 0px;
          `:pe.css`
            right: 0px;
          `}
  ${s=>s.vertical==="top"?pe.css`
            margin-top: -${r}px;
          `:pe.css`
            margin-bottom: -${r}px;
          `}
  ${s=>s.horizontal==="left"?pe.css`
            margin-left: -${r}px;
          `:pe.css`
            margin-right: -${r}px;
          `}
  @media all and (min-width: 0) and (max-width: 599px) {
      width: ${e}px;
      height: ${e}px;
      ${s=>s.vertical==="top"?pe.css`
              margin-top: -${o}px;
            `:pe.css`
              margin-bottom: -${o}px;
            `}
      ${s=>s.horizontal==="left"?pe.css`
              margin-left: -${o}px;
            `:pe.css`
              margin-right: -${o}px;
            `}
    }
  `}),sf=pe.default(pz)(i=>{let t=i.horizontal==="right"?i.borderWidth:0,e=i.vertical==="bottom"?i.borderWidth:0,r=i.horizontal==="left"?i.borderWidth:0,s=`${i.vertical==="top"?i.borderWidth:0}px ${t}px ${e}px ${r}px`,n=i.horizontal==="left"&&i.vertical==="bottom"||i.horizontal==="right"&&i.vertical==="top"?"nesw-resize":"nwse-resize",a=i.theme.measurements.canvasControls.corner.touchable.desktop/4-i.borderWidth,l=i.theme.measurements.canvasControls.corner.touchable.mobile/4+i.borderWidth;return pe.css`
    &:before {
      display: block;
      position: absolute;
      content: '';
      width: ${c=>c.theme.measurements.canvasControls.corner.size}px;
      height: ${c=>c.theme.measurements.canvasControls.corner.size}px;
      z-index: ${c=>c.theme.measurements.zIndex.canvas.controls};
      border-color: ${c=>c.theme.canvas.controlsColor};
      border-style: solid;
      border-width: ${s};
      pointer-events: auto;
      ${i.vertical==="top"?pe.css`
            top: ${a}px;
          `:pe.css`
            bottom: ${a}px;
          `}
      ${i.horizontal==="left"?pe.css`
            left: ${a}px;
          `:pe.css`
            right: ${a}px;
          `}
      @media all and (min-width: 0) and (max-width: 599px) {
        ${i.vertical==="top"?pe.css`
              margin-top: ${l}px;
            `:pe.css`
              margin-bottom: ${l}px;
            `}
        ${i.horizontal==="left"?pe.css`
              margin-left: ${l}px;
            `:pe.css`
              margin-right: ${l}px;
            `}
      }
    }
    cursor: ${n};
    pointer-events: none;
  `});var ET=y(require("styled-components"));var AT=ET.default.div.attrs(()=>({"data-test":H.Knob}))`
  position: absolute;
  height: ${i=>i.theme.measurements.canvasControls.knob.touchable.desktop}px;
  width: ${i=>i.theme.measurements.canvasControls.knob.touchable.desktop}px;
  margin-left: -10px;
  margin-top: -10px;
  z-index: ${i=>i.theme.measurements.zIndex.canvas.knob};
  will-change: transform;
  cursor: ew-resize;
  &:before {
    display: block;
    position: absolute;
    content: '';
    background: ${i=>i.theme.canvas.controlsColor};
    border-radius: 50%;
    width: ${i=>i.theme.measurements.canvasControls.knob.size}px;
    height: ${i=>i.theme.measurements.canvasControls.knob.size}px;
    top: ${i=>i.theme.measurements.canvasControls.knob.size/4}px;
    left: ${i=>i.theme.measurements.canvasControls.knob.size/4}px;
    box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.24);
  }
`;var FT=y(require("styled-components")),OT=FT.default.div`
  position: absolute;
  color: ${i=>i.theme.canvas.controlsOutline};
`;var RT=y(require("styled-components")),PT=RT.default.div.attrs(i=>({style:{left:`${i.x}px`}}))`
  position: absolute;
  bottom: -${i=>i.theme.measurements.canvasControls.sprite.rotateHandle.height}px;
  height: ${i=>i.theme.measurements.canvasControls.sprite.rotateHandle.height}px;
  width: 2px;
  background-color: ${i=>i.theme.canvas.controlsOutline};
`;var BT=y(require("styled-components")),MT=BT.default.div.attrs(({height:i,width:t,theme:e})=>({style:{height:`${i+e.measurements.canvasControls.sprite.controlPadding}px`,width:`${t+e.measurements.canvasControls.sprite.controlPadding}px`}}))`
  left: -${i=>i.theme.measurements.canvasControls.sprite.controlPadding/2}px;
  top: -${i=>i.theme.measurements.canvasControls.sprite.controlPadding/2}px;
  transform-origin: center center;
  border-style: solid;
  border-width: 2px;
  border-color: ${i=>i.theme.canvas.controlsColor};
  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.2),
    inset 0 2px 6px 0 rgba(0, 0, 0, 0.2);
  cursor: move;
  will-change: transform;
  position: absolute;
`;var LT=y(require("styled-components"));var zT=LT.default.div.attrs(()=>({"data-test":H.TextWidth}))`
  position: absolute;
  height: ${i=>i.theme.measurements.canvasControls.width.size}px;
  width: 4px;
  z-index: ${i=>i.theme.measurements.zIndex.canvas.controls};
  background: ${i=>i.theme.canvas.controlsColor};
  cursor: pointer;
`;var UT=y(require("styled-components")),NT=UT.default.div.attrs({tabIndex:0})`
  position: absolute;
  height: ${i=>i.height}px;
  width: ${i=>i.width}px;
  top: 0;
  left: 0;
  &:focus {
    outline: 0;
  }
`;var Xn=y(require("styled-components"));var nf=Tw()?Xn.css`
      transition: unset;
    `:Xn.css`
      transition: all 0.4s ease-in-out;
    `,HT=Xn.default.div`
  position: absolute;
  background: ${i=>i.theme.canvas.cropBackdrop};
  z-index: ${i=>i.theme.measurements.zIndex.canvas.crop.backdrop};
  ${nf}
`,WT=Xn.default.div.attrs({"data-test":H.CropMask})`
  position: absolute;
  box-shadow: inset 0 0 0 2px ${i=>i.theme.canvas.controlsOutline};
  cursor: move;
  ${nf}
`,GT=Xn.default.div`
  position: absolute;
  background: ${i=>i.theme.canvas.controlsOutline};
  z-index: ${i=>i.theme.measurements.zIndex.canvas.crop.grid};
  ${nf}
`,Xa=Xn.default(sf)`
  z-index: ${i=>i.theme.measurements.zIndex.canvas.controls};
  ${nf};
`;var VT=y(require("styled-components")),jT=VT.default.canvas`
  position: absolute;
  top: 0;
  left: 0;
`;var $T=y(require("styled-components")),YT=$T.default.video`
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
`;var KT=y(require("styled-components")),XT=KT.default.div`
  position: relative;
  transition: all 0.4s cubic-bezier(0.17, 0.04, 0.03, 0.94);
  height: 100%;
  width: 100%;
  z-index: ${i=>i.theme.measurements.zIndex.canvas.webcam.backdrop};
  background-color: ${i=>i.theme.webcam.background};
`;var ot={Index:xT,Area:Kn,Bar:{Index:_T,ButtonGroup:s2},Button:{TextSecondary:Du,Float:o2},Container:CT,Element:jT,Wrapper:XT,Webcam:YT,Controls:{Knob:AT,Circle:TT,Corner:sf,Line:OT,Area:wT,Sprite:MT,RotateHandle:PT,Container:IT,Wrapper:NT,SpriteActionsWrapper:Iu,SpriteActionButton:Zr,Width:zT},Crop:{Mask:WT,GridLine:GT,Backdrop:HT,Control:Xa}};var Am=y(require("react"));var DF=y(require("styled-components"));var Pi={};ne(Pi,{FragmentPrecision:()=>Or,ImageFormat:()=>qa,OptionType:()=>g,RenderType:()=>lr,RendererType:()=>gt,UniformType:()=>N});var lr={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"},qa={PNG:"image/png",JPEG:"image/jpeg",RAW:"raw"},g;(function(i){i.NUMBER="number",i.VECTOR2="vector2",i.COLOR_MATRIX="color-matrix",i.COLOR="color",i.ARRAY="array",i.OBJECT="object",i.STRING="string",i.BOOLEAN="boolean",i.CONFIGURABLE="configurable",i.IMAGE="image",i.FUNCTION="function",i.TEXTURE="texture",i.ALL="*"})(g||(g={}));var N;(function(i){i.SAMPLER2D="sampler2d",i.INT="i",i.INT1="1i",i.INT2="2i",i.INT3="3i",i.INT4="4i",i.FLOAT="f",i.FLOAT1="1f",i.FLOAT2="2f",i.FLOAT_VECTOR2="2fv",i.FLOAT3="3f",i.FLOAT4="4f",i.MAT3="mat3",i.MAT3FV="mat3fv",i.MAT4="mat4"})(N||(N={}));var gt;(function(i){i.WEBGL="webgl",i.CANVAS="canvas"})(gt||(gt={}));var Or;(function(i){i.High="highp",i.Medium="mediump",i.Low="lowp"})(Or||(Or={}));var JT;var Mu=()=>document.createElement("canvas"),qT=(i,t)=>{let e=t||Mu();e.width=i.width,e.height=i.height;let r=e.getContext("2d");if(!r)throw new Error("Cannot render context");return r.clearRect(0,0,e.width,e.height),r.drawImage(i,0,0,i.width,i.height),e};var kx=class{constructor(t,e,r){this.width=t;this.height=e;this.data=r}},af=kx;JT=ZT().webUtils;var Qe=JT,yc=i=>i._type===gt.WEBGL,Tx=i=>Boolean(i&&"tagName"in i&&i.tagName&&i.tagName.toUpperCase()==="CANVAS"),QT=i=>Boolean("tagName"in i&&i.tagName.toUpperCase()==="IMG");var cf=class{static head(t){return t[0]}static tail(t){return t.slice(1)}static last(t){return t[t.length-1]}static init(t){return t.slice(0,t.length-1)}static remove(t,e){return t.filter((r,o,s)=>!e(r,o,s))}static findIndex(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r;return-1}static find(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return t[r]}static flatten(t){return t.reduce(function(e,r){return e.concat(Array.isArray(r)?cf.flatten(r):r)},[])}static range(t,e){let r=[];if(e>t)for(let o=t;o<e;o++)r.push(o);return r}static repeat(t,e){let r=[];for(let o=0;o<e;o++)r[o]=t;return r}static zip(t,e){let r=Math.min(t.length,e.length),o=[];for(let s=0;s<r;s++)o[s]=[t[s],e[s]];return o}},tD=cf;var qn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",yz={encode(i){let t="",e,r,o,s,n,a,l,c=0;do e=i[c++],r=i[c++],o=i[c++],s=e>>2,n=(e&3)<<4|r>>4,a=(r&15)<<2|o>>6,l=o&63,isNaN(r)?a=l=64:isNaN(o)&&(l=64),t=t+qn.charAt(s)+qn.charAt(n)+qn.charAt(a)+qn.charAt(l),e=r=o="",s=n=a=l="";while(c<i.length);return t},decode(i){let t,e,r,o,s,n,a,l=0,c=[];if(/[^A-Za-z0-9+/=]/g.exec(i))throw new Error(`There were invalid base64 characters in the input text.
Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='
Expect errors in decoding.`);i=i.replace(/[^A-Za-z0-9+/=]/g,"");do o=qn.indexOf(i.charAt(l++)),s=qn.indexOf(i.charAt(l++)),n=qn.indexOf(i.charAt(l++)),a=qn.indexOf(i.charAt(l++)),t=o<<2|s>>4,e=(s&15)<<4|n>>2,r=(n&3)<<6|a,c.push(t),n!==64&&c.push(e),a!==64&&c.push(r),t=e=r="",o=s=n=a="";while(l<i.length);return c}},eo=yz;var Za=class{static mapRange(t,e,r){return(t-e.getMin())*r.getLength()/e.getLength()+r.getMin()}static isPlainObject(t){if(typeof t!="object"||!t)return!1;if(typeof Object.getPrototypeOf=="function"){let e=Object.getPrototypeOf(t);return e===Object.prototype||e===null}return Object.prototype.toString.call(t)==="[object Object]"}static isMobile(){if(typeof navigator=="undefined")return!1;let t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}static isBrowser(){return typeof window!="undefined"}static values(t){let e=[];for(let r in t)e.push(t[r]);return e}static generateUUID(){let t=new Date().getTime();return typeof window.performance!="undefined"&&typeof window.performance.now=="function"&&(t+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(e==="x"?r:r&3|8).toString(16)})}static resizeVectorToFit(t,e){let r=Math.min(e.x/t.x,e.y/t.y);return t.clone().multiply(r)}static resizeVectorToFill(t,e){let r=t.x/t.y,o=e.x/e.y;return r>o?e.clone().set(e.y*r,e.y):e.clone().set(e.x,e.x/r)}static isExtendable(t){return typeof t!="undefined"&&t!==null&&(typeof t=="object"||typeof t=="function")}static defaults(t,...e){let r={};for(let o in t)r[o]=t[o];for(let o=0;o<e.length;o++){let s=e[o];for(let n in s)typeof r[n]=="undefined"&&(r[n]=s[n])}return r}static deepMerge(t,...e){let r=(o,s)=>{if(s===void 0)return r(null,o);if(Array.isArray(s))return[...s];if(!Za.isPlainObject(s))return s;if(!Za.isPlainObject(o))return b({},s);let n=b({},o);return Object.keys(s).forEach(a=>{let l=s[a];l!==void 0&&(n[a]=r(o[a],l))}),n};return e.reduce(r,t)}static deepDefaults(t,...e){let r=[...e].reverse();return Za.deepMerge(...r,t)}static deepClone(t){let e={};for(let r in t)Za.isExtendable(t[r])?e[r]=Za.deepClone(t[r]):e[r]=t[r];return e}static extend(t,...e){let r={};for(let o in t)r[o]=t[o];for(let o=0;o<e.length;o++){let s=e[o];for(let n in s)r[n]=s[n]}return r}static clone(t){return this.extend({},t)}static getUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}static createCanvas(){return Qe.createCanvas()}static isPowerOfTwo(t){return(t.x&t.x-1)==0&&(t.y&t.y-1)==0}static nextLowestPOT(t){for(let e=1;e<32;e<<=1)t|=t>>e;return t-(t>>1)}static nextHighestPOT(t){t--;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}static moveArrayItem(t,e,r){if(r>=t.length){let o=r-t.length;for(;o--+1;)t.push(void 0)}t.splice(r,0,t.splice(e,1)[0])}static ensureCanvasDimensions(t,e){return t.width!==e.x||t.height!==e.y?(t.width=e.x,t.height=e.y,!0):!1}static byteArrayToString(t){return t.map(e=>String.fromCharCode(e)).join("")}static clamp(t,e,r){return Math.max(e,Math.min(t,r))}static wildCardMatch(t,e){return new RegExp(`^${e.split("*").join(".*")}$`).test(t)}static flipObject(t){let e={};for(let r in t)e[t[r]]=r;return e}static ISODateString(t){function e(r){return r<10?`0${r}`:r}return`${t.getUTCFullYear()}-${e(t.getUTCMonth()+1)}-${e(t.getUTCDate())}T${e(t.getUTCHours())}:${e(t.getUTCMinutes())}:${e(t.getUTCSeconds())}Z`}static getCrossOriginValue(t){if(!t)return"anonymous";if(t!=="none")return t}static invariant(t,e){if(!t)throw new Error(e)}static executePromises(t){let e=t.length,r=0,o=[],s=[];return new Promise((n,a)=>{let l=()=>{r++,r>=e&&(s.length<=0?n(o):a(s))},c=u=>{o.push(u),l()},d=u=>{s.push(u),l()};t.forEach(u=>{u.then(c).catch(d)})})}},Dx=Za;V(Dx,"Array",tD);var z=Dx;var xz=[{name:"trace",type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{name:"info",type:"log",background:"#BDE5F8",color:"#00529B"},{name:"warn",type:"warn",background:"#FEEFB3",color:"#9F6000"},{name:"error",type:"error",background:"#FFBABA",color:"#D8000C"},{name:"log",type:"log",background:"#EEEEEE",color:"#1f4f6b"}],eD=()=>console&&console.group&&console.groupCollapsed&&console.groupEnd,vz=()=>typeof navigator!="undefined"&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/),Cz=(i,t)=>["background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0",`background: ${i}; color: ${t}; line-height: 20px; padding: 4px 0; font-weight: bold`,"background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0"],iD=class{constructor(t="warn",e=xz){this._levels=[...e],this._maxLevel=this.getLevelIndexByName(t),this._consoleFuncs={trace:(...r)=>{eD()?(console.groupCollapsed(...r),console.trace(),console.groupEnd()):console.trace(...r)}},this._levels.forEach(({name:r})=>{this[r]=(o,...s)=>{this._log(r,o,...s)}})}getLevelIndexByName(t){return z.Array.findIndex(this._levels,e=>e.name===t)}getLevelObjectByName(t){return z.Array.find(this._levels,e=>e.name===t)}canLog(t){let e=this.getLevelIndexByName(t);return e<0?!1:e>=this._maxLevel}setLevel(t){let e=this.getLevelIndexByName(t);e<0||(this._maxLevel=e)}_log(t,e,...r){let o=this.getLevelObjectByName(t);if(!o||!this.canLog(t))return;let{name:s,type:n,background:a,color:l}=o,c=r.filter(p=>p!==void 0).map(p=>p.toObject?JSON.parse(JSON.stringify(p.toObject())):p),d=this._consoleFuncs[n]||console[n]?(...p)=>console[n](...p):(...p)=>console.log(...p),u=c.length,m=Cz(a,l);if(!vz()){let p=c.length;if(p<=0){d(`PhotoEditorSDK | ${e} `);return}if(p===1&&typeof c[0]=="string"){d(`PhotoEditorSDK | ${e} | ${c[0]}`);return}d(`PhotoEditorSDK | ${e} | `,...c);return}if(u<=0){d(`%c  %c PhotoEditorSDK %c  %c ${e} %c %c  `,...m);return}if(u===1&&typeof c[0]=="string"){d(`%c  %c PhotoEditorSDK %c  %c ${e} %c  ${c[0]}  %c  `,...m);return}eD()?(console.groupCollapsed(`%c  %c PhotoEditorSDK %c  %c ${e} %c`,...z.Array.init(m)),d(...c),console.groupEnd()):d(`%c  %c PhotoEditorSDK %c  %c ${e} %c`,...z.Array.init(m),...c)}image(t="",e){{let r=new window.Image,o=()=>{let{width:s}=r,{height:n}=r;t&&console.log(t),console.log("%c+",`
        font-size: 1px;
        padding: 0px ${Math.floor(s/2)}px;
        line-height: ${n}px;
        background: url(${r.src});
        color: transparent;
        background-repeat: no-repeat;
        background-size: ${s}px ${n}px;`)};return r.onload=o,e instanceof window.HTMLCanvasElement?r.src=e.toDataURL():e instanceof window.Image?(r=e,o()):typeof e=="string"?r.src=e:this.log(t,e),r}}texture(t="",e){{if(!e){this.log(t,"texture: null or undefined");return}let r=e.getBaseTexture(),o=r.getRenderers(),s=z.Array.find(o,l=>l&&l.constructor.type==="webgl"),{width:n,height:a}=r.getFrame();if(s){let l=s.getContext(),c=r.getGLTextureForRenderer(s);this.logGlTexture(l,c,n,a,t)}else Ix.image(t,r.getSource())}}logGlTexture(t,e,r=150,o=150,s){{t.bindTexture(t.TEXTURE_2D,e);let n=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0);let a=new Uint8Array(r*o*4);t.readPixels(0,0,r,o,t.RGBA,t.UNSIGNED_BYTE,a),t.deleteFramebuffer(n);let l=document.createElement("canvas");l.width=r,l.height=o;let c=l.getContext("2d"),d=c.createImageData(r,o);return d.data.set(a),c.putImageData(d,0,0),Ix.image(s,l)}}},Ix=new iD("warn"),j=Ix;var Bx={};ne(Bx,{ImageLoader:()=>cr,JSONLoader:()=>Bo});var cr={load(i,t={cors:!0,value:"anonymous"}){return(()=>Promise.resolve([i,i]))().then(([r,o])=>this._createAndLoadImage(r,o,t))},loadImage(i,t={cors:!0,value:"anonymous"}){return this._loadWithoutExif(i,t)},_loadWithoutExif(i,t={cors:!0,value:"anonymous"}){return new Promise((e,r)=>{let o=new window.Image;o.addEventListener("load",()=>{e(o)}),o.addEventListener("error",()=>{r(new Error(`Failed to load image at ${i}`))}),t.cors&&(o.crossOrigin=t.value),o.src=i})},_createAndLoadImage(i,t,e={cors:!0,value:"anonymous"}){return new Promise((r,o)=>{{let s=this._loadWithoutExif(t,e).then(a=>r(a)),n=new Promise((a,l)=>{this._loadAsDataURL(t,e).then(c=>{let d=new window.Image;d.addEventListener("load",()=>{a(d)}),d.src=c,d.rawSource=c}).catch(c=>{s.then(d=>a(d))})});return this._stringEndsWith(t,".svg")?s.then(a=>r(a)):n.then(a=>r(a))}})},_stringEndsWith(i,t,e=i.length){return(e===void 0||e>i.length)&&(e=i.length),i.substring(e-t.length,e)===t},_loadAsDataURL(i,t={cors:!0,value:"anonymous"}){return new Promise((e,r)=>{let o=new XMLHttpRequest;o.onload=function(){let s=new FileReader;s.onloadend=function(){s.error&&r(s.error),e(s.result)},s.readAsDataURL(o.response)},o.open("GET",i),o.responseType="blob",o.withCredentials=t.cors&&t.value==="use-credentials",o.send()})},loadXHR(i,t){return new Promise((e,r)=>{let o;window.XDomainRequest?(o=new window.XDomainRequest,t&&o.overrideMimeType(t),o.onload=function(){e(o)},o.onerror=function(s){r(s)}):window.XMLHttpRequest&&(o=new window.XMLHttpRequest,t&&o.overrideMimeType(t),o.onreadystatechange=function(s){o.readyState===4&&(o.status===200?e(o):r(new Error(`HTTP Status ${o.status}`)))}),o.open("GET",i,!0),o.send()})}};var Ex=y(aD()),wz=/https?|ftp|gopher|file/;function Uu(i){typeof i=="string"&&(i=xc(i));var t=function(e,r,o){var s=e.auth,n=e.hostname,a=e.protocol||"",l=e.pathname||"",c=e.hash||"",d=e.query||"",u=!1;s=s?encodeURIComponent(s).replace(/%3A/i,":")+"@":"",e.host?u=s+e.host:n&&(u=s+(~n.indexOf(":")?"["+n+"]":n),e.port&&(u+=":"+e.port)),d&&typeof d=="object"&&(d=r.encode(d));var m=e.search||d&&"?"+d||"";return a&&a.substr(-1)!==":"&&(a+=":"),e.slashes||(!a||o.test(a))&&u!==!1?(u="//"+(u||""),l&&l[0]!=="/"&&(l="/"+l)):u||(u=""),c&&c[0]!=="#"&&(c="#"+c),m&&m[0]!=="?"&&(m="?"+m),{protocol:a,host:u,pathname:l=l.replace(/[?#]/g,encodeURIComponent),search:m=m.replace("#","%23"),hash:c}}(i,Ex.default,wz);return""+t.protocol+t.host+t.pathname+t.search+t.hash}var Ax="http://",Fx="w.w",Ox=Ax+Fx,kz=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,Tz=/https?|ftp|gopher|file/;function lD(i,t){var e=typeof i=="string"?xc(i):i;i=typeof i=="object"?Uu(i):i;var r=xc(t),o="";e.protocol&&!e.slashes&&(o=e.protocol,i=i.replace(e.protocol,""),o+=t[0]==="/"||i[0]==="/"?"/":""),o&&r.protocol&&(o="",r.slashes||(o=r.protocol,t=t.replace(r.protocol,"")));var s=i.match(kz);s&&!r.protocol&&(i=i.substr((o=s[1]+(s[2]||"")).length),/^\/\/[^/]/.test(t)&&(o=o.slice(0,-1)));var n=new URL(i,Ox+"/"),a=new URL(t,n).toString().replace(Ox,""),l=r.protocol||e.protocol;return l+=e.slashes||r.slashes?"//":"",!o&&l?a=a.replace(Ax,l):o&&(a=a.replace(Ax,"")),Tz.test(a)||~t.indexOf(".")||i.slice(-1)==="/"||t.slice(-1)==="/"||a.slice(-1)!=="/"||(a=a.slice(0,-1)),o&&(a=o+(a[0]==="/"?a.substr(1):a)),a}function vc(){}vc.prototype.parse=xc,vc.prototype.format=Uu,vc.prototype.resolve=lD,vc.prototype.resolveObject=lD;var Rx=/^https?|ftp|gopher|file/,Dz=/^(.*?)([#?].*)/,Iz=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,Ez=/^([a-z0-9.+-]*:)?\/\/\/*/i,Az=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i;function xc(i,t,e){if(t===void 0&&(t=!1),e===void 0&&(e=!1),i&&typeof i=="object"&&i instanceof vc)return i;var r=(i=i.trim()).match(Dz);i=r?r[1].replace(/\\/g,"/")+r[2]:i.replace(/\\/g,"/"),Az.test(i)&&i.slice(-1)!=="/"&&(i+="/");var o=!/(^javascript)/.test(i)&&i.match(Iz),s=Ez.test(i),n="";o&&(Rx.test(o[1])||(n=o[1].toLowerCase(),i=""+o[2]+o[3]),o[2]||(s=!1,Rx.test(o[1])?(n=o[1],i=""+o[3]):i="//"+o[3]),o[2].length!==3&&o[2].length!==1||(n=o[1],i="/"+o[3]));var a,l=(r?r[1]:i).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),c=l&&l[1],d=new vc,u="",m="";try{a=new URL(i)}catch(v){u=v,n||e||!/^\/\//.test(i)||/^\/\/.+[@.]/.test(i)||(m="/",i=i.substr(1));try{a=new URL(i,Ox)}catch(x){return d.protocol=n,d.href=n,d}}d.slashes=s&&!m,d.host=a.host===Fx?"":a.host,d.hostname=a.hostname===Fx?"":a.hostname.replace(/(\[|\])/g,""),d.protocol=u?n||null:a.protocol,d.search=a.search.replace(/\\/g,"%5C"),d.hash=a.hash.replace(/\\/g,"%5C");var p=i.split("#");!d.search&&~p[0].indexOf("?")&&(d.search="?"),d.hash||p[1]!==""||(d.hash="#"),d.query=t?Ex.default.decode(a.search.substr(1)):d.search.substr(1),d.pathname=m+(o?function(v){return v.replace(/['^|`]/g,function(x){return"%"+x.charCodeAt().toString(16).toUpperCase()}).replace(/((?:%[0-9A-F]{2})+)/g,function(x,_){try{return decodeURIComponent(_).split("").map(function(D){var k=D.charCodeAt();return k>256||/^[a-z0-9]$/i.test(D)?D:"%"+k.toString(16).toUpperCase()}).join("")}catch(D){return _}})}(a.pathname):a.pathname),d.protocol==="about:"&&d.pathname==="blank"&&(d.protocol="",d.pathname=""),u&&i[0]!=="/"&&(d.pathname=d.pathname.substr(1)),n&&!Rx.test(n)&&i.slice(-1)!=="/"&&d.pathname==="/"&&(d.pathname=""),d.path=d.pathname+d.search,d.auth=[a.username,a.password].map(decodeURIComponent).filter(Boolean).join(":"),d.port=a.port,c&&!d.host.endsWith(c)&&(d.host+=c,d.port=c.slice(1)),d.href=m?""+d.pathname+d.search+d.hash:Uu(d);var f=/^(file)/.test(d.href)?["host","hostname"]:[];return Object.keys(d).forEach(function(v){~f.indexOf(v)||(d[v]=d[v]||null)}),d}var Fz=5e3,Nu=typeof window!="undefined"?window:global,Px=class{constructor(t){this._url=t,this._parsedUrl=xc(this._url,!0)}_isJSONPRequest(){let{query:t}=this._parsedUrl;for(let e in t)if(t[e]==="?")return!0;return!1}load(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()}_loadJSON(){return new Promise((t,e)=>{let r;Nu.XDomainRequest?(r=new Nu.XDomainRequest,r.onload=function(){let o=JSON.parse(r.responseText);t(o)},r.onerror=function(o){e(o)},r.open("GET",this._url,!0),r.send()):Nu.XMLHttpRequest&&(r=new XMLHttpRequest,r.onreadystatechange=function(o){if(r.readyState===4)if(r.status===200){let s=JSON.parse(r.responseText);t(s)}else e(new Error(`HTTP Status ${r.status}`))},r.open("GET",this._url,!0),r.send())})}_loadJSONP(){let t=!1,e=!1,r=`pesdk${Math.round(Math.random()*99999999999999)}`;return new Promise((o,s)=>{let n=this._createJSONPNode(r);Nu[r]=a=>{this._removeJSONPNode(n),t||(e=!0,o(a))},Nu.setTimeout(()=>{e||(this._removeJSONPNode(n),t=!0,s(new Error("Timeout of 5 seconds exceeded.")))},Fz)})}_createJSONPNode(t){let e=this._buildJSONPUrl(t),r=document.querySelector("head"),o=document.createElement("script");return o.src=e,r.appendChild(o),o}_removeJSONPNode(t){t.parentNode.removeChild(t)}_buildJSONPUrl(t){let{query:e}=this._parsedUrl,r=null;for(let o in e)if(e[o]==="?"){r=o;break}return delete this._parsedUrl.search,e[r]=t,Uu(this._parsedUrl)}},Bo=Px;var Bi=class{constructor(t,e,r,o=1){this.r=t,this.g=e,this.b=r,this.a=o}toRGBA(){return`rgba(${[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a.toFixed(2)].join(",")})`}set(t,e,r,o=this.a){return this.r=t,this.g=e,this.b=r,this.a=o,this}toRGB(){return[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)]}toHex(){return`#${[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))].join("")}`}toGLColor(){return[this.r,this.g,this.b,this.a]}toArray(){return this.toGLColor()}toRGBGLColor(){return[this.r,this.g,this.b]}toHSV(){let t=Math.max(this.r,this.g,this.b),e=Math.min(this.r,this.g,this.b),r,o,s=t,n=t-e;if(o=t===0?0:n/t,t===e)r=0;else{switch(t){case this.r:r=(this.g-this.b)/n,this.g<this.b&&(r+=6);break;case this.g:r=(this.b-this.r)/n+2;break;case this.b:r=(this.r-this.g)/n+4;break}r/=6}return[r,o,s]}fromHSV(t,e,r){return this.copy(Bi.fromHSV(t,e,r)),this}static fromHSV(t,e,r,o=1){let[s,n,a]=[],l=Math.floor(t*6),c=t*6-l,d=r*(1-e),u=r*(1-c*e),m=r*(1-(1-c)*e);switch(l%6){case 0:s=r,n=m,a=d;break;case 1:s=u,n=r,a=d;break;case 2:s=d,n=r,a=m;break;case 3:s=d,n=u,a=r;break;case 4:s=m,n=d,a=r;break;case 5:s=r,n=d,a=u;break}return new Bi(s,n,a,o)}static fromArray(t){return new Bi(t[0],t[1],t[2],t[3])}static fromHex(t){let[e,r,o]=t.match(/[0-9A-fa-f]{1,2}/g);return new Bi(parseInt(e,16)/255,parseInt(r,16)/255,parseInt(o,16)/255,1)}clone(){return new Bi(this.r,this.g,this.b,this.a)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}minus(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}divideScalar(t){return this.r/=t,this.g/=t,this.b/=t,this.a/=t,this}clamp(t,e){return this.r=Math.min(Math.max(this.r,t),e),this.g=Math.min(Math.max(this.g,t),e),this.b=Math.min(Math.max(this.b,t),e),this.a=Math.min(Math.max(this.a,t),e),this}mix(t,e){return this.r=(1-e)*this.r+e*t.r,this.g=(1-e)*this.g+e*t.g,this.b=(1-e)*this.b+e*t.b,this.a=(1-e)*this.a+e*t.a,this}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}_componentToHex(t){let e=t.toString(16);return e.length===1?`0${e}`:e}toString(){return`Color(${this.r}, ${this.g}, ${this.b}, ${this.a})`}static get TRANSPARENT(){return new Bi(0,0,0,0)}static get WHITE(){return new Bi(1,1,1,1)}static get BLACK(){return new Bi(0,0,0,1)}static get RED(){return new Bi(1,0,0,1)}static get BLUE(){return new Bi(0,0,1,1)}static get GREEN(){return new Bi(0,1,0,1)}},U=Bi;var Oz=12,cD=class{constructor(){this._maxListeners=Oz,this._events={},this._pipeDestinations=[]}pipeEvents(t){this._pipeDestinations.push(t)}unpipeEvents(t){let e=this._pipeDestinations.indexOf(t);e!==-1&&this._pipeDestinations.splice(e,1)}on(t,e){if(typeof t=="undefined")throw new Error(`Invalid event type: \`${t}\``);if(typeof e!="function")throw new TypeError;let r=this._events[t]||(this._events[t]=[]);return r.indexOf(e)!==-1?this:(r.push(e),this._maxListeners&&r.length>this._maxListeners&&(j.warn("EventEmitter",`Possible memory leak detected, added ${r.length} \`${t}\` listeners (current limit is ${this._maxListeners})`),typeof console!="undefined"&&console.trace()),this)}once(t,e){if(typeof t=="undefined")throw new Error(`Invalid event type: \`${t}\``);let r=this;function o(){r.off(t,o),e.apply(null,arguments)}return this.on(t,o)}off(t,...e){if(typeof t=="undefined")throw new Error(`Invalid event type: \`${t}\``);if(e.length===0)return this._events[t]=null,this;let r=e[0];if(typeof r!="function")throw new TypeError;let o=this._events[t];if(!o||!o.length)return this;let s=o.indexOf(r);return s===-1?this:(o.splice(s,1),this)}emit(t,...e){if(typeof t=="undefined")throw new Error(`Invalid event type: \`${t}\``);this._pipeDestinations.forEach(o=>{o.emit(t,...e)});let r=this._events[t];return!r||!r.length?!1:(r.slice(0).forEach(o=>o.apply(null,e)),!0)}setMaxListeners(t){if(parseInt(t,10)!==t)throw new TypeError;this._maxListeners=t}},Ci=cD;var Ja={checkFramebufferStatus(i,t){let e=t.checkFramebufferStatus(t.FRAMEBUFFER),r={[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Incomplete attachment",[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"Missing attachment",[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS]:"Incomplete dimensions",[t.FRAMEBUFFER_UNSUPPORTED]:"Framebuffer unsupported"};e!==t.FRAMEBUFFER_COMPLETE&&j.warn(i,`Framebuffer incomplete: ${r[e]}`)},determineGPUName(i){let t=null,e=null;i||(e=document.createElement("canvas"),i=e.getContext("experimental-webgl")||e.getContext("webgl"));let r=i&&i.getExtension("WEBGL_debug_renderer_info");return r&&(t=i.getParameter(r.UNMASKED_RENDERER_WEBGL),e&&e.remove()),t},isGPUBlacklisted(i,t=null){return!1}};var df=i=>typeof i=="number";var Rz=i=>i instanceof et,Qa=(i,t)=>Rz(i)?{x:i.x,y:i.y}:{x:i,y:df(t)?t:i},uf=(i,t)=>(e,r)=>{let{x:o,y:s}=Qa(e,r);return i.x=t(i.x,o),i.y=t(i.y,s),i},et=class{constructor(t=0,e=0){this.add=uf(this,(t,e)=>t+e);this.subtract=uf(this,(t,e)=>t-e);this.divide=uf(this,(t,e)=>t/e);this.multiply=uf(this,(t,e)=>t*e);this.x=t,this.y=e}set(t,e){let{x:r,y:o}=Qa(t,e);return this.x=r,this.y=o,this}clone(){return new et(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}clamp(t,e){return df(t)&&(t=new et(t,t)),df(e)&&(e=new et(e,e)),t&&(this.x=Math.max(t.x,this.x),this.y=Math.max(t.y,this.y)),e&&(this.x=Math.min(e.x,this.x),this.y=Math.min(e.y,this.y)),this}dot(t,e){let{x:r,y:o}=Qa(t,e);return this.x*r+this.y*o}equals(t,e){let{x:r,y:o}=Qa(t,e);return r===this.x&&o===this.y}flip(){let t=this.x;return this.x=this.y,this.y=t,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}floor(){return this.x|=0,this.y|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y)}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}toObject(){return{x:this.x,y:this.y}}toString(){return`Vector2({ x: ${this.x}, y: ${this.y} })`}roundDecimal(t){return this.x=parseFloat(this.x.toFixed(t)),this.y=parseFloat(this.y.toFixed(t)),this}asArray(t=!1){return t?[this.y,this.x]:[this.x,this.y]}static fromObject(t){return new et(t.x,t.y)}static get NULL(){return new et(0,0)}};var Mi=class{constructor(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;this.reset()}multiply(t){let e,r,o,s,n,a;return e=this.a*t.a+this.b*t.c,r=this.a*t.b+this.b*t.d,o=this.c*t.a+this.d*t.c,s=this.c*t.b+this.d*t.d,n=this.tx*t.a+this.ty*t.c+t.tx,a=this.tx*t.b+this.ty*t.d+t.ty,this.a=e,this.b=r,this.c=o,this.d=s,this.tx=n,this.ty=a,this}applyToVector(t){let{x:e,y:r}=t;return t=t.clone(),t.x=this.a*e+this.c*r+this.tx,t.y=this.b*e+this.d*r+this.tx,t}applyInverseToVector(t){let e=1/(this.a*this.d+this.c*-this.b),{x:r,y:o}=t;return t=t.clone(),t.x=this.d*e*r+-this.c*e*o+(this.ty*this.c-this.tx*this.d)*e,t.y=this.a*e*o+-this.b*e*r+(-this.ty*this.a+this.tx*this.b)*e,t}rectangleToCoordinates(t,e=new et(0,0)){let r=t.width*(1-e.x),o=t.width*-e.x,s=t.height*(1-e.y),n=t.height*-e.y,a=[];return a.push(new et(this.a*o+this.c*n+this.tx,this.d*n+this.b*o+this.ty)),a.push(new et(this.a*r+this.c*n+this.tx,this.d*n+this.b*r+this.ty)),a.push(new et(this.a*r+this.c*s+this.tx,this.d*s+this.b*r+this.ty)),a.push(new et(this.a*o+this.c*s+this.tx,this.d*s+this.b*o+this.ty)),a}reset(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}toArray(){let t=[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1];return typeof Float32Array=="undefined"?t:new Float32Array(t)}toString(){return`Matrix({ a: ${this.a}, b: ${this.b}, c: ${this.c}, d: ${this.d}, tx: ${this.tx}, ty: ${this.ty} })`}static get IDENTITY(){return new Mi}};var te=class{constructor(t=0,e=0,r=0,o=0){this.x=0;this.y=0;this.width=0;this.height=0;this.x=t,this.y=e,this.width=r,this.height=o}set(t,e,r,o){return this.x=t,this.y=e,this.width=r,this.height=o,this}clone(){return new te(this.x,this.y,this.width,this.height)}copy(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}equals(t,e,r,o){return t instanceof te?t.x===this.x&&t.y===this.y&&t.width===this.width&&t.height===this.height:t===this.x&&e===this.y&&r===this.width&&o===this.height}translate(t,e){let{x:r,y:o}=Qa(t,e);return this.x+=r,this.y+=o,this}scale(t,e){let{x:r,y:o}=Qa(t,e);return this.width*=r,this.height*=o,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this}getPosition(){return new et(this.x,this.y)}getSize(){return new et(this.width,this.height)}insetBy(t,e){return this.x+=t,this.y+=e,this.width-=2*t,this.height-=2*e,this}intersects(t){let e=new et(this.x,this.y),r=new et(this.x+this.width,this.y+this.height),o=new et(t.x,t.y),s=new et(t.x+t.width,t.y+t.height);return!(o.x>r.x||e.x>s.x||s.y<e.y||r.y<o.y)}toString(){return`Rectangle({ x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height} })`}static FromDiagonalPoints(t,e){let r=!1;e.x-t.x<0&&(r=!0);let o=r?e:t,s=r?t:e,n=s.x-o.x,a=s.y-o.y;return new te(o.x,o.y,n,a)}};var Cc=2e3,Pz=5,Zn=Pz*4;var tl=class{constructor(){this._position=new et(0,0),this._scale=new et(1,1),this._pivot=new et(0,0),this._rotation=0,this._lastRotation=null,this._alpha=1,this._visible=!0,this._worldTransform=new Mi,this._parent=null,this._shaders=[],this._boundsNeedUpdate=!0,this._bounds=new te(0,0,1,1),this._localBoundsNeedUpdate=!0,this._localBounds=new te(0,0,1,1),this._filterRectangle=new te(0,0,0,0)}renderWebGL(t){j.warn(this.constructor.name,"`renderWebGL` is abstract and not implemented in inherited class")}renderCanvas(t){j.warn(this.constructor.name,"`renderCanvas` is abstract and not implemented in inherited class")}updateTransform(){let t=this._parent?this._parent.getWorldTransform():Mi.IDENTITY,e=this._worldTransform,r=Math.sin(this._rotation),o=Math.cos(this._rotation);e.a=o*this._scale.x,e.b=r*this._scale.x,e.c=-r*this._scale.y,e.d=o*this._scale.y,e.tx=this._position.x,e.ty=this._position.y,(this._pivot.x||this._pivot.y)&&(e.tx-=this._pivot.x*e.a+this._pivot.y*e.c,e.ty-=this._pivot.x*e.b+this._pivot.y*e.d),e.multiply(t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}addShader(t){this._shaders.push(t)}removeShader(t){let e=this._shaders.indexOf(t);return e!==-1?(this._shaders.splice(e,1),!0):!1}removeShaderAt(t){return this._shaders[t]?(this._shaders.splice(t,1),!0):!1}getBounds(){return this._bounds.clone()}getPosition(){return this._position}setPosition(t,e){this._position.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getScale(){return this._scale}setScale(t,e){this._scale.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getPivot(){return this._pivot}setPivot(t,e){this._pivot.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getRotation(){return this._rotation}setRotation(t){this._rotation=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getAlpha(){return this._alpha}setAlpha(t){this._alpha=t}getWorldAlpha(){return this._parent?this._parent.getAlpha()*this._alpha:this._alpha}getWorldTransform(){return this._worldTransform}getParent(){return this._parent}setParent(t){this._parent=t}getFilterRectangle(){return this._filterRectangle}setFilterRectangle(t){this._filterRectangle.copy(t)}isVisible(){return this._visible}setVisible(t){this._visible=t}};var Mo=class extends tl{constructor(){super();this._children=[],this._filters=[]}addFilter(t){this._filters.push(t)}removeFilter(t){let e=this._filters.indexOf(t);return e!==-1?(this._filters.splice(e,1),!0):!1}setFilters(t){this._filters=t}addChild(t){let e=t.getParent();e instanceof Mo&&e.removeChild(t),t.setParent(this),this._children.push(t)}prependChild(t){let e=t.getParent();e instanceof Mo&&e.removeChild(t),t.setParent(this),this._children.unshift(t)}hasChild(t){return this._children.indexOf(t)!==-1}removeChild(t){let e=this._children.indexOf(t);e!==-1?(this._children.splice(e,1),t.setParent(null)):j.info(this.constructor.name,"Tried to remove a child that does not exist")}clearChildren(){this._children=[]}renderWebGL(t){if(!this._visible)return;let e=t.getFilterManager();this._filters&&this._filters.length&&e.pushFilters(this,this._filters),t.getCurrentObjectRenderer().start(),this._renderWebGL(t),this._children.forEach(r=>{r.renderWebGL(t)}),t.getCurrentObjectRenderer().flush(),this._filters&&this._filters.length&&e.popFilters(),t.getCurrentObjectRenderer().start()}_renderWebGL(t){}renderCanvas(t){if(!this._visible)return;let e=t.getFilterManager();this._filters&&this._filters.length&&e.pushFilters(this,this._filters),this._renderCanvas(t),this._children.forEach(r=>{r.renderCanvas(t)}),this._filters&&this._filters.length&&e.popFilters()}_renderCanvas(t){}updateTransform(){super.updateTransform(),this._children.forEach(t=>{t.updateTransform()})}getLocalBounds(){return this._localBoundsNeedUpdate&&(this._localBoundsNeedUpdate=!1),this._localBounds.clone()}getBounds(){return this._boundsNeedUpdate&&(this._boundsNeedUpdate=!1),this._bounds.clone()}getChildren(){return this._children}getFilters(){return this._filters}dispose(){}};var Hx={};ne(Hx,{ColorOverlayFilter:()=>bD,OverlayFilter:()=>SD,TintFilter:()=>vD,UnpremultiplyFilter:()=>fD});"use strict";var Bz=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Mz=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function uD(i,t,e,r,o,s){if(!(isNaN(s)||s<1)){s|=0;var n=i.data,a,l,c,d,u,m,p,f,v,x,_,D,k,A,B,T,F,q,Z,pt,xt,ht,ut,Yt,ri=s+s+1,Ve=r-1,Sr=o-1,wt=s+1,ce=wt*(wt+1)/2,Qt=new dD,Xt,it=Qt;for(c=1;c<ri;c++)it=it.next=new dD,c==wt&&(Xt=it);it.next=Qt;var lt=null,mt=null;p=m=0;var bi=Bz[s],Ji=Mz[s];for(l=0;l<o;l++){for(T=F=q=Z=f=v=x=_=0,D=wt*(pt=n[m]),k=wt*(xt=n[m+1]),A=wt*(ht=n[m+2]),B=wt*(ut=n[m+3]),f+=ce*pt,v+=ce*xt,x+=ce*ht,_+=ce*ut,it=Qt,c=0;c<wt;c++)it.r=pt,it.g=xt,it.b=ht,it.a=ut,it=it.next;for(c=1;c<wt;c++)d=m+((Ve<c?Ve:c)<<2),f+=(it.r=pt=n[d])*(Yt=wt-c),v+=(it.g=xt=n[d+1])*Yt,x+=(it.b=ht=n[d+2])*Yt,_+=(it.a=ut=n[d+3])*Yt,T+=pt,F+=xt,q+=ht,Z+=ut,it=it.next;for(lt=Qt,mt=Xt,a=0;a<r;a++)n[m+3]=ut=_*bi>>Ji,ut!==0?(ut=255/ut,n[m]=(f*bi>>Ji)*ut,n[m+1]=(v*bi>>Ji)*ut,n[m+2]=(x*bi>>Ji)*ut):n[m]=n[m+1]=n[m+2]=0,f-=D,v-=k,x-=A,_-=B,D-=lt.r,k-=lt.g,A-=lt.b,B-=lt.a,d=p+((d=a+s+1)<Ve?d:Ve)<<2,T+=lt.r=n[d],F+=lt.g=n[d+1],q+=lt.b=n[d+2],Z+=lt.a=n[d+3],f+=T,v+=F,x+=q,_+=Z,lt=lt.next,D+=pt=mt.r,k+=xt=mt.g,A+=ht=mt.b,B+=ut=mt.a,T-=pt,F-=xt,q-=ht,Z-=ut,mt=mt.next,m+=4;p+=r}for(a=0;a<r;a++){for(F=q=Z=T=v=x=_=f=0,m=a<<2,D=wt*(pt=n[m]),k=wt*(xt=n[m+1]),A=wt*(ht=n[m+2]),B=wt*(ut=n[m+3]),f+=ce*pt,v+=ce*xt,x+=ce*ht,_+=ce*ut,it=Qt,c=0;c<wt;c++)it.r=pt,it.g=xt,it.b=ht,it.a=ut,it=it.next;for(u=r,c=1;c<=s;c++)m=u+a<<2,f+=(it.r=pt=n[m])*(Yt=wt-c),v+=(it.g=xt=n[m+1])*Yt,x+=(it.b=ht=n[m+2])*Yt,_+=(it.a=ut=n[m+3])*Yt,T+=pt,F+=xt,q+=ht,Z+=ut,it=it.next,c<Sr&&(u+=r);for(m=a,lt=Qt,mt=Xt,l=0;l<o;l++)d=m<<2,n[d+3]=ut=_*bi>>Ji,ut>0?(ut=255/ut,n[d]=f*bi>>Ji,n[d+1]=v*bi>>Ji,n[d+2]=x*bi>>Ji):n[d]=n[d+1]=n[d+2]=0,f-=D,v-=k,x-=A,_-=B,D-=lt.r,k-=lt.g,A-=lt.b,B-=lt.a,d=a+((d=l+wt)<Sr?d:Sr)*r<<2,f+=T+=lt.r=n[d],v+=F+=lt.g=n[d+1],x+=q+=lt.b=n[d+2],_+=Z+=lt.a=n[d+3],lt=lt.next,D+=pt=mt.r,k+=xt=mt.g,A+=ht=mt.b,B+=ut=mt.a,T-=pt,F-=xt,q-=ht,Z-=ut,mt=mt.next,m+=r}}}function dD(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var Lo=class{constructor(t=1,e=0,r=0,o=0,s=0,n=0,a=1,l=0,c=0,d=0,u=0,m=0,p=1,f=0,v=0,x=0,_=0,D=0,k=1,A=0){this.set(t,e,r,o,s,n,a,l,c,d,u,m,p,f,v,x,_,D,k,A)}set(t,e,r,o,s,n,a,l,c,d,u,m,p,f,v,x,_,D,k,A){this.a=t,this.b=e,this.c=r,this.d=o,this.e=s,this.f=n,this.g=a,this.h=l,this.i=c,this.j=d,this.k=u,this.l=m,this.m=p,this.n=f,this.o=v,this.p=x,this.q=_,this.r=D,this.s=k,this.t=A}reset(){this.a=1,this.b=0,this.c=0,this.d=0,this.e=0,this.f=0,this.g=1,this.h=0,this.i=0,this.j=0,this.k=0,this.l=0,this.m=1,this.n=0,this.o=0,this.p=0,this.q=0,this.r=0,this.s=1,this.t=0}apply(t){let e=this.a*t.r+this.b*t.g+this.c*t.b+this.d*t.a+this.e,r=this.f*t.r+this.g*t.g+this.h*t.b+this.i*t.a+this.j,o=this.k*t.r+this.l*t.g+this.m*t.b+this.n*t.a+this.o,s=this.p*t.r+this.q*t.g+this.r*t.b+this.s*t.a+this.t;return new U(e,r,o,s)}multiply(t){let e,r,o,s,n,a,l,c,d,u,m,p,f,v,x,_,D,k,A,B,T=t,F=this;return e=T.a*F.a+T.b*F.f+T.c*F.k+T.d*F.p,r=T.a*F.b+T.b*F.g+T.c*F.l+T.d*F.q,o=T.a*F.c+T.b*F.h+T.c*F.m+T.d*F.r,s=T.a*F.d+T.b*F.i+T.c*F.n+T.d*F.s,a=T.f*F.a+T.g*F.f+T.h*F.k+T.i*F.p,l=T.f*F.b+T.g*F.g+T.h*F.l+T.i*F.q,c=T.f*F.c+T.g*F.h+T.h*F.m+T.i*F.r,d=T.f*F.d+T.g*F.i+T.h*F.n+T.i*F.s,m=T.k*F.a+T.l*F.f+T.m*F.k+T.n*F.p,p=T.k*F.b+T.l*F.g+T.m*F.l+T.n*F.q,f=T.k*F.c+T.l*F.h+T.m*F.m+T.n*F.r,v=T.k*F.d+T.l*F.i+T.m*F.n+T.n*F.s,_=T.p*F.a+T.q*F.f+T.r*F.k+T.s*F.p,D=T.p*F.b+T.q*F.g+T.r*F.l+T.s*F.q,k=T.p*F.c+T.q*F.h+T.r*F.m+T.s*F.r,A=T.p*F.d+T.q*F.i+T.r*F.n+T.s*F.s,n=T.a*F.e+T.b*F.j+T.c*F.o+T.d*F.t+T.e,u=T.f*F.e+T.g*F.j+T.h*F.o+T.i*F.t+T.j,x=T.k*F.e+T.l*F.j+T.m*F.o+T.n*F.t+T.o,B=T.p*F.e+T.q*F.j+T.r*F.o+T.s*F.t+T.t,this.a=e,this.b=r,this.c=o,this.d=s,this.e=n,this.f=a,this.g=l,this.h=c,this.i=d,this.j=u,this.k=m,this.l=p,this.m=f,this.n=v,this.o=x,this.p=_,this.q=D,this.r=k,this.s=A,this.t=B,this}clone(){let t=new Lo;return t.set(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,this.j,this.k,this.l,this.m,this.n,this.o,this.p,this.q,this.r,this.s,this.t),t}equals(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f&&this.g===t.g&&this.h===t.h&&this.i===t.i&&this.j===t.j&&this.k===t.k&&this.l===t.l&&this.m===t.m&&this.n===t.n&&this.o===t.o&&this.p===t.p&&this.q===t.q&&this.r===t.r&&this.s===t.s&&this.t===t.t}getOffsets(){return[this.e,this.j,this.o,this.t]}toString(){return`ColorMatrix( ${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.e},
      ${this.f}, ${this.g}, ${this.h}, ${this.i}, ${this.j},
      ${this.k}, ${this.l}, ${this.m}, ${this.n}, ${this.o},
      ${this.p}, ${this.q}, ${this.r}, ${this.s}, ${this.t} )`}toArray(){return"abcdefghijklmnopqrst".split("").map(t=>this[t])}static get IDENTITY(){return new Lo}static createBrightnessMatrix(t){let e=new Lo;return e.e=t,e.j=t,e.o=t,e}static createContrastMatrix(t){let e=new Lo,r=(1-t)/2;return e.a=e.g=e.m=t,e.e=e.j=e.o=r,e}static createSaturationMatrix(t=1){let e=new Lo,r=1-t,o=.213*r,s=.715*r,n=.072*r;return e.a=o+t,e.b=s,e.c=n,e.f=o,e.g=s+t,e.h=n,e.k=o,e.l=s,e.m=n+t,e}static createExposureMatrix(t=0){let e=Math.pow(2,t);return new Lo(e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0)}static createLinearMatrix(t=1,e=0){let r=new Lo;return r.a=r.g=r.m=t,r.e=r.j=r.o=e,r}},Hu=Lo;var Sc=class extends Ci{constructor(t={},e={}){super();this.availableOptions=b(b({},Object.getPrototypeOf(this).availableOptions),e),this._onConfigurableUpdate=this._onConfigurableUpdate.bind(this),this._initOptions(t)}_buildConfigError(t){let e="";return this.constructor.name&&(e=`${this.constructor.name}: `),e+=t,new Error(e)}_onOptionsChange(){}validateSettings(){return new Promise((t,e)=>{for(let r in this.availableOptions)if(this.availableOptions[r].required&&typeof this._options[r]=="undefined")return e(this._buildConfigError(`Option \`${r}\` is required.`));t()})}_initOptions(t={}){this._options={};let e,r,o,s=this;for(e in this.availableOptions){if(o=e.charAt(0).toUpperCase()+e.slice(1),r=this.availableOptions[e],[g.STRING,g.NUMBER,g.BOOLEAN,g.OBJECT,g.VECTOR2,g.COLOR,g.CONFIGURABLE,g.COLOR_MATRIX,g.ARRAY,g.IMAGE,g.FUNCTION,g.ALL].indexOf(r.type)===-1)throw this._buildConfigError(`Unknown option type: \`${r.type}\``);if(function(l){s[`set${o}`]=function(c,d,u){s.setOption(l,c,d,u)},s[`get${o}`]=function(){return s.getOption(l)}}(e),r.type===g.CONFIGURABLE&&(this._options[e]=new Sc(void 0,r.structure||{}),this._options[e].on("update",this._onConfigurableUpdate)),!(e in t)||typeof t[e]=="undefined")if(typeof r.default!="undefined"){let a=r.default;typeof r.default=="function"&&(a=r.default()),this[`set${o}`](a,!1,!0)}else r.type!==g.CONFIGURABLE&&(this._options[e]=void 0)}for(e in t){if(typeof this.availableOptions[e]=="undefined")throw new Error(`Invalid option: ${e}`);typeof t[e]!="undefined"&&(o=e.charAt(0).toUpperCase()+e.slice(1),this[`set${o}`](t[e],!1,!0))}}set(t,e=!0){Object.keys(t).forEach(r=>{this.setOption(r,t[r],!1)}),this._onOptionsChange(),e&&this.emit("update",this,t)}getOption(t){return this._options[t]}hasOption(t){return!!this.availableOptions[t]}getOptionDefault(t){let e=this.availableOptions[t];if(!e)throw new Error(`Invalid option: ${t}`);return e.default}resetOptions(){this.set(this.getDefaultOptions())}getDefaultOptions(){let t={};for(let e in this.availableOptions){let r=this.availableOptions[e].default;typeof r!="undefined"&&(t[e]=r)}return t}getOptions(){return b({},this._options)}equals(t){let e=t.getOptions();return this.optionsEqual(e)}optionsEqual(t){for(let e in t){let r=t[e];if(!this._optionEquals(e,r))return!1}return!0}_optionEquals(t,e){if(typeof this.availableOptions[t]=="undefined")throw new Error(`Invalid option: ${t}`);let o=this.availableOptions[t].type,s=this._options[t];if(s===e)return!0;if(typeof e=="undefined"||typeof s=="undefined")return!1;switch(o){case g.OBJECT:return typeof s.optionsEqual=="function"?s.optionsEqual(e._options):s===e;case g.STRING:case g.NUMBER:case g.BOOLEAN:case g.FUNCTION:case"*":return s===e;case g.VECTOR2:return s.equals(e);case g.COLOR:case g.COLOR_MATRIX:return e.equals(s);case g.CONFIGURABLE:return s.optionsEqual(e);case g.ARRAY:return this._arrayOptionEquals(t,e);case g.IMAGE:return s.src===e.src}}_arrayOptionEquals(t,e){let r=this._options[t];if(e.length!==r.length)return!1;let o=!0;for(let s=0;s<r.length;s++){let n=r[s],a=e[s];if(n instanceof Sc){if(typeof a=="undefined"||!n.optionsEqual(a)){o=!1;break}}else if(a!==n){o=!1;break}}return o}serializeOptions(t=Object.keys(this._options),e=!1){let r={};return t.forEach(o=>{if(typeof this.availableOptions[o]=="undefined")return Log.warn(`Trying to serialize a key that does not exist: ${o}`);this.availableOptions[o].serializable!==!1&&(r[o]=this.serializeOption(o,e))}),r}serializeOption(t,e=!1){let r=this.availableOptions[t],o=r.type,s=this._options[t];if(!s)return s;if(r.serializable===!1)throw new Error(`Option \`${t}\` is not serializable.`);switch(o){case g.STRING:case g.NUMBER:case g.BOOLEAN:case g.OBJECT:case g.FUNCTION:case g.ALL:return s;case g.VECTOR2:return e?s.toObject():s.clone();case g.COLOR:case g.COLOR_MATRIX:return e?s.toArray():s.clone();case g.CONFIGURABLE:return s.serializeOptions(void 0,e);case g.ARRAY:return s.slice(0);case g.IMAGE:return e?s.src:s}}setOption(t,e,r=!0,o=!1){let s=this.availableOptions[t];if(!s)throw new Error(`Invalid option: ${t}`);if(typeof s.setter!="undefined"&&(e=s.setter.call(this,e,o)),typeof s.validation!="undefined"&&s.validation(e),e===null||typeof e=="undefined"){if(s.required)throw this._buildConfigError(`Option \`${t}\` is required.`);this._options[t]=e}else switch(s.type){case g.STRING:{if(typeof e!==g.STRING)throw this._buildConfigError(`Option \`${t}\` has to be a string.`);let{available:n}=s;if(typeof n!="undefined"&&n.indexOf(e)===-1)throw this._buildConfigError(`Invalid value for \`${t}\` (valid values are: ${s.available.join(", ")})`);this._options[t]=e;break}case g.NUMBER:if(typeof e!==g.NUMBER)throw this._buildConfigError(`Option \`${t}\` has to be a number.`);this._options[t]=e;break;case g.BOOLEAN:if(typeof e!==g.BOOLEAN)throw this._buildConfigError(`Option \`${t}\` has to be a boolean.`);this._options[t]=e;break;case g.VECTOR2:if(!(e instanceof et)&&!(typeof e=="object"&&"x"in e&&"y"in e))throw this._buildConfigError(`Option \`${t}\` has to be an instance of Vector2 or an Object holding x and y values.`);e instanceof et?this._options[t]=e.clone():this._options[t]=et.fromObject(e);break;case g.COLOR:if(!(e instanceof U))throw this._buildConfigError(`Option \`${t}\` has to be an instance of Color.`);this._options[t]=e;break;case g.COLOR_MATRIX:if(!(e instanceof Hu))throw this._buildConfigError(`Option \`${t}\` has to be an instance of ColorMatrix.`);this._options[t]=e.clone();break;case g.FUNCTION:if(typeof e!="function")throw this._buildConfigError(`Option \`${t}\` has to be a function.`);this._options[t]=e;break;case g.OBJECT:case"*":this._options[t]=e;break;case g.IMAGE:{let{Image:n}=Qe;if(typeof e=="string"){let a=new n;QT(a)&&(a.crossOrigin=z.getCrossOriginValue(s.crossOrigin)),a.src=e,this._options[t]=a}else if(e instanceof n||typeof HTMLCanvasElement!="undefined"&&e instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement)this._options[t]=e;else throw this._buildConfigError(`Option \`${t}\` has to be an Image, Canvas or String.`);break}case g.CONFIGURABLE:e instanceof Sc?this._options[t]=e:this._options[t].set(e);break;case g.ARRAY:if(!(e instanceof Array))throw this._buildConfigError(`Option \`${t}\` has to be an Array.`);this._options[t]=e.slice(0);break;default:throw this._buildConfigError(`Unknown option type: \`${s.type}\``)}r&&(this._onOptionsChange(),this.emit("update",this,{[t]:e}))}_onConfigurableUpdate(...t){this.emit("update",...t)}hasChanges(){let t=this.getDefaultOptions();return!this.optionsEqual(t)}},Ct=Sc;var Wu=class{constructor(t,e,r,o={},s=[]){this._program=null;this._renderer=t,this._vertexSource=e,this._fragmentSource=r,this._uniforms=o,this._uniformLocations={},this._attributes=s,this._attributeLocations={},this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._init()}_init(){this._compile(),this._renderer.getContext().useProgram(this._program),this._cacheUniformLocations(),this._cacheAttributeLocations()}_onContextChange(){this._init()}setupBuffers(t,e){let r=this._renderer.getContext();r.bindBuffer(r.ARRAY_BUFFER,t),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),r.vertexAttribPointer(this._attributeLocations.a_position,2,r.FLOAT,!1,Zn,0),r.vertexAttribPointer(this._attributeLocations.a_texCoord,2,r.FLOAT,!1,Zn,2*4),r.vertexAttribPointer(this._attributeLocations.a_color,4,r.UNSIGNED_BYTE,!0,Zn,4*4)}syncUniforms(){Object.keys(this._uniforms).forEach(t=>{this.syncUniform(t)})}syncUniform(t){let e=this._renderer.getContext(),r=this._uniforms[t],o=this._uniformLocations[t];switch(r.type){case N.SAMPLER2D:e.uniform1i(o,r.value);break;case N.INT:case N.INT1:e.uniform1i(o,r.value);break;case N.INT2:e.uniform2i(o,r.value[0],r.value[1]);break;case N.INT3:e.uniform3i(o,r.value[0],r.value[1],r.value[2]);break;case N.INT4:e.uniform4i(o,r.value[0],r.value[1],r.value[2],r.value[3]);break;case N.FLOAT:case N.FLOAT1:e.uniform1f(o,r.value);break;case N.FLOAT2:e.uniform2f(o,r.value[0],r.value[1]);break;case N.FLOAT3:e.uniform3f(o,r.value[0],r.value[1],r.value[2]);break;case N.FLOAT4:e.uniform4f(o,r.value[0],r.value[1],r.value[2],r.value[3]);break;case N.FLOAT_VECTOR2:e.uniform2fv(o,r.value);break;case N.MAT3:case N.MAT3FV:e.uniformMatrix3fv(o,!1,r.value);break;case N.MAT4:e.uniformMatrix4fv(o,!1,r.value);break;default:j.warn(this.constructor.name,`Unknown uniform type: ${r.type}`)}}_cacheAttributeLocations(){let t=this._renderer.getContext();this._attributes.forEach(e=>{this._program&&(this._attributeLocations[e]=t.getAttribLocation(this._program,e))})}_cacheUniformLocations(){let t=this._renderer.getContext();Object.keys(this._uniforms).forEach(r=>{if(this._program){let o=t.getUniformLocation(this._program,r);o&&(this._uniformLocations[r]=o)}})}_addPrecisionToSource(t){let e=this._renderer.getMaxFloatPrecision(),r=Or.Medium;return z.isMobile()&&e===Or.High&&(r=Or.High),`precision ${r} float;
${t}`}_compile(){let t=this._renderer.getContext(),e=this._compileShader(t.VERTEX_SHADER,this._vertexSource);this._vertexShader=e;let r=this._addPrecisionToSource(this._fragmentSource),o=this._compileShader(t.FRAGMENT_SHADER,r);this._fragmentShader=o;let s=t.createProgram();if(!s)return;if(t.attachShader(s,e),t.attachShader(s,o),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS))this._program=s;else{let a=t.getProgramInfoLog(s);t.isContextLost()&&(a="WebGL context lost"),t.deleteProgram(s),j.error(this.constructor.name,`WebGL program linking error: ${a}`)}}_compileShader(t,e){let r=this._renderer.getContext(),o=r.createShader(t);if(!o)throw new Error(`Cannot create shared: ${JSON.stringify(t)}`);if(r.shaderSource(o,e),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS)){let n=r.getShaderInfoLog(o);r.isContextLost()&&(n="WebGL context lost"),r.deleteShader(o),j.error(this.constructor.name,`WebGL shader compilation error: ${n}`)}return o}setUniform(t,e,r=!1){this._uniforms[t].value=e,r&&this.syncUniform(t)}setUniforms(t,e=!1){Object.keys(t).forEach(r=>{this._uniforms[r].value=t[r],e&&this.syncUniform(r)})}getUniforms(){return this._uniforms}getAttributes(){return this._attributes}getAttributeLocations(){return this._attributeLocations}getProgram(){return this._program}dispose(){let t=this._renderer.getContext();t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader),this._renderer.off("context",this._onContextChange)}};var mD=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;
}
`;var pD=`attribute vec2 a_position;
attribute vec2 a_texCoord;
attribute vec4 a_color;
varying vec2 v_texCoord;
varying vec4 v_color;
uniform mat3 u_projMatrix;

void main() {
  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);
  v_texCoord = a_texCoord;
  v_color = vec4(a_color.rgb * a_color.a, a_color.a);
}
`;var Lz=new Mi,Ws={vertexSource:pD,fragmentSource:mD,uniforms:{u_image:{type:N.SAMPLER2D,value:0},u_projMatrix:{type:N.MAT3,value:Lz.toArray()}},attributes:["a_position","a_texCoord","a_color"]},Mx=class extends Wu{constructor(t,e=Ws.vertexSource,r=Ws.fragmentSource){super(t,e,r,Ws.uniforms,Ws.attributes)}};var io=class extends Ct{constructor(t={},e={}){super(t,e);this._initOptions(t)}_initOptions(t={}){this._shaders=[],this._availableUniforms=Ws.uniforms,this._attributes=Ws.attributes,this._vertexSource=Ws.vertexSource,this._fragmentSource=Ws.fragmentSource,this._initUniforms(),super._initOptions(t)}_initUniforms(){this._uniforms={};for(let t in this._availableUniforms){let e=this._availableUniforms[t];this._uniforms[t]={type:e.type,value:e.default||null}}for(let t in this.availableOptions){let e=this.availableOptions[t];e.uniformType?this._uniforms[`u_${t}`]={type:e.uniformType,value:e.default||null}:j.trace(this.constructor.name,`Option \`${t}\` is missing a \`uniformType\`!`)}}setOption(t,e,r=!0){super.setOption(t,e,r);let o=e,s=this.availableOptions[t];if(!s.uniformType)return;let n=`u_${t}`;switch(s.type){case g.COLOR:s.uniformType===N.FLOAT4?o=e.toGLColor():s.uniformType===N.FLOAT3&&(o=e.toRGBGLColor());break;case g.VECTOR2:o=[e.x,e.y];break;case g.COLOR_MATRIX:{o=[e.a,e.b,e.c,e.d,e.f,e.g,e.h,e.i,e.k,e.l,e.m,e.n,e.p,e.q,e.r,e.s];let a=[e.e,e.j,e.o,e.t];this._uniforms[`${n}_vec`]={value:a,type:N.FLOAT4}}}this.setUniform(n,o)}setUniform(t,e,r=!1){this._uniforms[t].value=e}setUniforms(t,e=!1){Object.entries(t).forEach(([r,o])=>{this._uniforms[r].value=o,e&&this.syncUniform(r)})}syncUniform(t){this._shaders.forEach(e=>{e.syncUniform(t)})}syncUniforms(){this._shaders.forEach(t=>{t.syncUniforms()})}getShaderForRenderer(t){let{id:e}=t;this._shaders||(this._shaders=[]);let r=this._shaders[e];return r||(r=new Wu(t,this._vertexSource,this._fragmentSource,this._uniforms,this._attributes),this._shaders[e]=r),r}apply(t,e,r,o=!1){yc(t)?this._applyWebGL(t,e,r,o):this._applyCanvas(t,e,r,o)}_applyWebGL(t,e,r,o=!1){let s=t.getContext(),n=this.getShaderForRenderer(t);t.setRenderTarget(r),o&&r.clear(),t.setShader(n);let a=t.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",a),n.syncUniforms(),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,e.getTexture()),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0)}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=r.getContext();j.warn(this.constructor.name,"`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`."),n.clearRect(0,0,s.width,s.height),n.drawImage(s,0,0)}dispose(){this._shaders.forEach(t=>t.dispose()),this._shaders=[]}_blurImage(t,e,r){let o=10,s=t.getCanvas(),n=Math.min(1,o/(r*Math.min(s.width,s.height))),a=z.createCanvas();a.width=Math.round(s.width*n),a.height=Math.round(s.height*n);let l=a.getContext("2d");l.drawImage(s,0,0,s.width,s.height,0,0,a.width,a.height);let c=r*Math.min(a.width,a.height),d=l.getImageData(0,0,a.width,a.height);uD(d,0,0,a.width,a.height,c),l.putImageData(d,0,0),e.getContext().drawImage(a,0,0,a.width,a.height,0,0,s.width,s.height)}};var hD=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);
}
`;var Lx=class extends io{constructor(){super();this._fragmentSource=hD}},fD=Lx;var gD=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;
}
`;var{OptionType:zz,UniformType:Uz}=Pi,zx=class extends io{constructor(...t){super(...t);this._fragmentSource=gD}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),{color:l}=this._options,c=n.getImageData(0,0,s.width,s.height),d=a.getImageData(0,0,s.width,s.height),u=s.width*s.height,m=new U,p=new U;for(let f=0;f<u*4;f+=4){m.set(c.data[f]/255,c.data[f+1]/255,c.data[f+2]/255,c.data[f+3]/255),p.set(d.data[f]/255,d.data[f+1]/255,d.data[f+2]/255,d.data[f+3]/255);let v=p.r+m.a*(m.r-p.r);d.data[f]=(v+m.a*(l.r-v))*255;let x=p.g+m.a*(m.g-p.g);d.data[f+1]=(x+m.a*(l.g-x))*255;let _=p.b+m.a*(m.b-p.b);d.data[f+2]=(_+m.a*(l.b-_))*255}a.putImageData(d,0,0)}};zx.prototype.availableOptions={color:{type:zz.COLOR,default:U.WHITE,uniformType:Uz.FLOAT4}};var bD=zx;var _D=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;
uniform int u_mode;

vec3 W = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  if (u_mode == 0) {
    gl_FragColor = color * color.a;
  } else if (u_mode == 1) {
    gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;
  } else if (u_mode == 2) {
    float luminance = dot(color.rgb, W);
    vec3 colorized = vec3(luminance) * u_color.rgb;
    gl_FragColor = vec4(mix(color.rgb, colorized, u_color.a), color.a) * color.a;
  }
}
`;var{OptionType:yD,UniformType:xD}=Pi,Jn=class extends io{constructor(...t){super(...t);this._fragmentSource=_D}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{mode:c,color:d}=this._options,{r:u,g:m,b:p,a:f}=d,v=[.2125,.7154,.0721];switch(c){case Jn.MODES.SOLID:for(let x=0;x<s.width*s.height;x++){let _=x*4;l.data[_]+=(u*255-l.data[_])*f,l.data[_+1]+=(m*255-l.data[_+1])*f,l.data[_+2]+=(p*255-l.data[_+2])*f}break;case Jn.MODES.COLORIZED:for(let x=0;x<s.width*s.height;x++){let _=x*4,D=l.data[_]/255*v[0]+l.data[_+1]/255*v[1]+l.data[_+2]/255*v[2],k=new U(D*u,D*m,D*p);l.data[_]+=(k.r*255-l.data[_])*f,l.data[_+1]+=(k.g*255-l.data[_+1])*f,l.data[_+2]+=(k.b*255-l.data[_+2])*f}break}a.putImageData(l,0,0)}};Jn.MODES={NONE:0,SOLID:1,COLORIZED:2};Jn.prototype.availableOptions={color:{type:yD.COLOR,default:U.WHITE,uniformType:xD.FLOAT4},mode:{type:yD.NUMBER,default:Jn.MODES.NONE,uniformType:xD.INT}};var vD=Jn;var CD=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform sampler2D u_overlayImage;
uniform int u_blendMode;
uniform float u_alpha;

const float EPSILON = 0.000001;

vec4 overlay(vec4 a, vec4 b) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 hardLight(vec4 b, vec4 a) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(b, vec4(result, b.a), u_alpha * a.a);
}

vec4 softLight(vec4 a, vec4 b) {
    vec3 result = mix(
          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),
          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),
          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 multiply(vec4 a, vec4 b) {
    vec3 result = a.rgb * b.rgb;
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 darken(vec4 a, vec4 b) {
    vec3 result = min(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 lighten(vec4 a, vec4 b) {
    vec3 result = max(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 screen(vec4 a, vec4 b) {
    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 colorBurn(vec4 a, vec4 b) {
    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 normal(vec4 a, vec4 b) {
    return mix(a, vec4(b.rgb, a.a), u_alpha * b.a);
}

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);

  vec4 resultColor;
  if (u_blendMode == 0) {
    resultColor = normal(color, overlayColor);
  } else if (u_blendMode == 1) {
    resultColor = overlay(color, overlayColor);
  } else if (u_blendMode == 2) {
    resultColor = hardLight(color, overlayColor);
  } else if (u_blendMode == 3) {
    resultColor = softLight(color, overlayColor);
  } else if (u_blendMode == 4) {
    resultColor = multiply(color, overlayColor);
  } else if (u_blendMode == 5) {
    resultColor = darken(color, overlayColor);
  } else if (u_blendMode == 6) {
    resultColor = lighten(color, overlayColor);
  } else if (u_blendMode == 7) {
    resultColor = screen(color, overlayColor);
  } else if (u_blendMode == 8) {
    resultColor = colorBurn(color, overlayColor);
  }
  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);
}
`;var{OptionType:mf,UniformType:Ux}=Pi,Nx=1e-6,Si=class extends io{constructor(...t){super(...t);this._fragmentSource=CD,this._lastImage=null}_applyCanvas(t,e,r,o=!1){let s=this._options.overlayTexture.getRenderTarget().getContext(),n=e.getCanvas(),a=e.getContext(),l=r.getContext(),c=a.getImageData(0,0,n.width,n.height),d=s.getImageData(0,0,n.width,n.height),{blendMode:u,alpha:m}=this._options,p=new U,f=new U,v=new U;for(let x=0;x<n.width*n.height*4;x+=4){p.set(c.data[x]/255,c.data[x+1]/255,c.data[x+2]/255,c.data[x+3]/255),f.set(d.data[x]/255,d.data[x+1]/255,d.data[x+2]/255,d.data[x+3]/255);let _,D,k,A,B,T,F,q,Z;switch(u){case Si.BLEND_MODES.NORMAL:v.set(p.r+f.a*m*(f.r-p.r),p.g+f.a*m*(f.g-p.g),p.b+f.a*m*(f.b-p.b),p.a);break;case Si.BLEND_MODES.OVERLAY:_=1-2*(1-p.r)*(1-f.r),D=2*p.r*f.r,k=_+(p.r<.5?1:0)*(D-_),A=1-2*(1-p.g)*(1-f.g),B=2*p.g*f.g,T=A+(p.g<.5?1:0)*(B-A),F=1-2*(1-p.b)*(1-f.b),q=2*p.b*f.b,Z=F+(p.b<.5?1:0)*(q-F),v.set(p.r+f.a*m*(k-p.r),p.g+f.a*m*(T-p.g),p.b+f.a*m*(Z-p.b),p.a);break;case Si.BLEND_MODES.HARD_LIGHT:_=1-2*(1-f.r)*(1-p.r),D=2*f.r*p.r,k=_+(f.r<.5?1:0)*(D-_),A=1-2*(1-f.g)*(1-p.g),B=2*f.g*p.g,T=A+(f.g<.5?1:0)*(B-A),F=1-2*(1-f.b)*(1-p.b),q=2*f.b*p.b,Z=F+(f.b<.5?1:0)*(q-F),v.set(p.r+f.a*m*(k-p.r),p.g+f.a*m*(T-p.g),p.b+f.a*m*(Z-p.b),p.a);break;case Si.BLEND_MODES.SOFT_LIGHT:_=2*p.r*(1-f.r)+(2*f.r-1)*Math.sqrt(p.r),D=2*p.r*f.r+p.r*p.r*(1-2*f.r),k=_+(f.r<.5?1:0)*(D-_),A=2*p.g*(1-f.g)+(2*f.g-1)*Math.sqrt(p.g),B=2*p.g*f.g+p.g*p.g*(1-2*f.g),T=A+(f.g<.5?1:0)*(B-A),F=2*p.b*(1-f.b)+(2*f.b-1)*Math.sqrt(p.b),q=2*p.b*f.b+p.b*p.b*(1-2*f.b),Z=F+(f.b<.5?1:0)*(q-F),v.set(p.r+f.a*m*(k-p.r),p.g+f.a*m*(T-p.g),p.b+f.a*m*(Z-p.b),p.a);break;case Si.BLEND_MODES.MULTIPLY:k=p.r*f.r,T=p.g*f.g,Z=p.b*f.b,v.set(p.r+f.a*m*(k-p.r),p.g+f.a*m*(T-p.g),p.b+f.a*m*(Z-p.b),p.a);break;case Si.BLEND_MODES.DARKEN:k=Math.min(p.r,f.r),T=Math.min(p.g,f.g),Z=Math.min(p.b,f.b),v.set(p.r+f.a*m*(k-p.r),p.g+f.a*m*(T-p.g),p.b+f.a*m*(Z-p.b),p.a);break;case Si.BLEND_MODES.LIGHTEN:k=Math.max(p.r,f.r),T=Math.max(p.g,f.g),Z=Math.max(p.b,f.b),v.set(p.r+f.a*m*(k-p.r),p.g+f.a*m*(T-p.g),p.b+f.a*m*(Z-p.b),p.a);break;case Si.BLEND_MODES.SCREEN:k=1-(1-p.r)*(1-f.r),T=1-(1-p.g)*(1-f.g),Z=1-(1-p.b)*(1-f.b),v.set(p.r+f.a*m*(k-p.r),p.g+f.a*m*(T-p.g),p.b+f.a*m*(Z-p.b),p.a);break;case Si.BLEND_MODES.COLOR_BURN:k=Math.max(0,Math.min(1,1-(1-p.r)/Math.max(f.r,Nx))),T=Math.max(0,Math.min(1,1-(1-p.g)/Math.max(f.g,Nx))),Z=Math.max(0,Math.min(1,1-(1-p.b)/Math.max(f.b,Nx))),v.set(p.r+f.a*m*(k-p.r),p.g+f.a*m*(T-p.g),p.b+f.a*m*(Z-p.b),p.a);break}c.data[x]=v.r*255,c.data[x+1]=v.g*255,c.data[x+2]=v.b*255,c.data[x+3]=v.a*255}l.putImageData(c,0,0)}};Si.BLEND_MODES={NORMAL:0,OVERLAY:1,HARD_LIGHT:2,SOFT_LIGHT:3,MULTIPLY:4,DARKEN:5,LIGHTEN:6,SCREEN:7,COLOR_BURN:8};Si.prototype.availableOptions={blendMode:{type:mf.NUMBER,default:Si.BLEND_MODES.NORMAL,uniformType:Ux.INT},overlayImage:{type:mf.NUMBER,required:!0,uniformType:Ux.SAMPLER2D},overlayTexture:{type:mf.OBJECT,required:!0},alpha:{type:mf.NUMBER,default:1,uniformType:Ux.FLOAT}};var SD=Si;var Rr;(function(i){i[i.Nearest=0]="Nearest",i[i.Linear=1]="Linear",i[i.Bilinear=2]="Bilinear",i[i.Trilinear=3]="Trilinear"})(Rr||(Rr={}));var Qn;(function(i){i[i.ClampToEdge=0]="ClampToEdge",i[i.Repeat=1]="Repeat",i[i.MirroredRepeat=2]="MirroredRepeat"})(Qn||(Qn={}));var wD={[1]:"LINEAR",[0]:"NEAREST",[2]:"LINEAR_MIPMAP_NEAREST",[3]:"LINEAR_MIPMAP_LINEAR"},wc=class extends Ci{constructor(t){super();this._renderers=[];this._glTextures={};this._dirty=!0;this._mipMapping=!1;this._glUnit=0;this._magFilter=wc.DefaultMagFilter;this._minFilter=wc.DefaultMinFilter;this._repeatX=0;this._repeatY=0;this._pixelRatio=1;this._loaded=!1;this._frame=new te(0,0,100,100);this._onSourceLoaded=this._onSourceLoaded.bind(this),this._source=t,this._loadSource()}resizeTo(t){this._frame.width===t.x&&this._frame.height===t.y||(this._frame.width=t.x,this._frame.height=t.y,this._dirty=!0)}_loadSource(){let t=this._source;if(!!t){if(Qe.isCanvas(t))return this._onSourceLoaded();if(t.complete)return this._onSourceLoaded();t.addEventListener&&t.addEventListener("load",this._onSourceLoaded)}}_onSourceLoaded(){this._loaded=!0,this.emit("loaded"),this.update()}_updateGLFilters(){if(!this._source)return;let t=new et(this._source.width,this._source.height);z.isPowerOfTwo(t)?(j.info(this.constructor.name,"Mip-mapping enabled"),this._minFilter=wc.TrilinearFilter,this._mipMapping=!0):(this._minFilter=wc.LinearFilter,this._mipMapping=!1)}update(){!this._source||((this._frame.width!==this._source.width||this._frame.height!==this._source.height)&&(this._frame=new te(0,0,this._source.width,this._source.height),this._dirty=!0),this._updateGLFilters(),this.emit("update"))}getRenderers(){return[...this._renderers]}getGLFilter(t,e){switch(e){case"min":return t[wD[this._minFilter]];case"mag":return t[wD[this._magFilter]]}}isLoaded(){return this._loaded}setLoaded(t){this._loaded=t}getSource(){return this._source}setSource(t){this._source=t}getGLTextureForRenderer(t){return this._glTextures[t.id]}setGLTextureForRenderer(t,e){this._renderers[e.id]=e,this._glTextures[e.id]=t}getFrame(){return this._frame}setFrame(t){this._frame=t}getDimensions(){return new et(this._frame.width,this._frame.height)}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){this._pixelRatio=t}getGLUnit(){return this._glUnit}setGLUnit(t){this._glUnit=t}setMinFilter(t){this._minFilter=t}getMinFilter(){return this._minFilter}setMagFilter(t){this._magFilter=t}getMagFilter(){return this._magFilter}setRepeatX(t){this._repeatX=t}getRepeatX(){return this._repeatX}setRepeatY(t){this._repeatY=t}getRepeatY(){return this._repeatY}getGLRepeat(t,e){switch(e==="x"?this.getRepeatX():this.getRepeatY()){case 0:return t.CLAMP_TO_EDGE;case 1:return t.REPEAT;case 2:return t.MIRRORED_REPEAT;default:return 0}}isDirty(){return this._dirty}setDirty(t){this._dirty=t}disposeGLTextures(){this._renderers.forEach(t=>{yc(t)&&this.disposeGLTexturesForRenderer(t)})}disposeGLTexturesForRenderer(t){if(!this._glTextures[t.id])return;t.getContext().deleteTexture(this._glTextures[t.id]),delete this._glTextures[t.id],this._renderers[t.id]||delete this._renderers[t.id]}isMipMappingEnabled(){return this._mipMapping}setMipMappingEnabled(t){this._mipMapping=t}dispose(){this.disposeGLTextures(),this._source=void 0}},Te=wc;Te.NearestFilter=0,Te.LinearFilter=1,Te.BilinearFilter=2,Te.TrilinearFilter=3,Te.DefaultMagFilter=0,Te.DefaultMinFilter=1,Te.Repeat=1,Te._id=0;var Gs=class{constructor(t,e,r,o=Qe.createCanvas(),s){this._width=t,this._height=e,this._pixelRatio=r,this._baseTexture=new Te,this._canvas=o;let n=s||this._canvas.getContext("2d");if(!n)throw new Error("Cannot get canvas context");this._context=n,this._baseTexture.setSource(this._canvas),this._canvas.width=this._width*this._pixelRatio,this._canvas.height=this._height*this._pixelRatio,this._filterStack=[{renderTarget:this,filters:[]}]}clear(){let t=this._context;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}resizeTo(t){this._baseTexture.resizeTo(t),this._width!==t.x&&(this._width=t.x,this._canvas.width=this._width*this._pixelRatio),this._height!==t.y&&(this._height=t.y,this._canvas.height=this._height*this._pixelRatio)}getCanvas(){return this._canvas}getContext(){return this._context}getFilterStack(){return this._filterStack}getWidth(){return this._width}getHeight(){return this._height}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){this._pixelRatio=t}getDimensions(){return new et(this._width,this._height)}getBaseTexture(){return this._baseTexture}dispose(){delete this._canvas,delete this._context,this._baseTexture.dispose()}};var el=class{constructor(t){this._renderer=t,this._filterStack=[{renderTarget:t.getCurrentRenderTarget(),filters:[]}],this._textures=[],this._textureFrame=new te(0,0,t.getWidth(),t.getHeight())}resizeTo(t){this._textureFrame.width=t.x,this._textureFrame.height=t.y,this._textures.forEach(e=>e.resizeTo(t))}pushFilters(t,e){this._currentFrame=t.getBounds();let r=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(r),this._filterStack.push({renderTarget:r,filters:e}),r.clear()}popFilters(){let t=this._filterStack.pop();if(!t)return;let{filters:e,renderTarget:r}=t,o=this._filterStack[this._filterStack.length-1],s=r,n=o.renderTarget;return e.length===1?(e[0].apply(this._renderer,s,n),this._textures.push(s)):this._applyFilters(e,s,n),e}_applyFilters(t,e,r){let o=e,s=this._getOrCreateRenderTarget(!0),n=t[t.length-1];t.forEach(a=>{if(a===n)a.apply(this._renderer,o,r);else{a.apply(this._renderer,o,s);let c=o;o=s,s=c}}),this._textures.push(o),this._textures.push(s)}_getOrCreateRenderTarget(t=!1){let e=this._textures.pop();return e||(e=new Gs(this._textureFrame.width,this._textureFrame.height,1)),t&&e.clear(),e}setFilterStack(t){this._filterStack=t}dispose(){}};var TD=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Vu(),DD=class{constructor(t){this._context=t,this._tracking=!1;let e=this;for(let r in t)typeof t[r]=="function"?this[r]=function(...s){let n=t[r];if(!e._tracking)return n.apply(t,s);let a=TD(),l=n.apply(t,s),c=TD()-a,d={functionName:r,arguments:s,duration:c};return e._trackedCalls.push(d),l}:this._makePropertyWrapper(r)}_makePropertyWrapper(t){if(["_context","_trackedCalls","_tracking"].indexOf(t)!==-1)return;let r=this._context;this.__defineGetter__(t,()=>r[t]),this.__defineSetter__(t,o=>{r[t]=o})}startFrame(){this._tracking=!0,this._trackedCalls=[]}endFrame(){let t="Rendering";j.log(t,"Frame rendering results:"),j.log(t,`Context calls: ${this._trackedCalls.length}`);let e={};this._trackedCalls.forEach(({functionName:o,duration:s})=>{e[o]=e[o]||{totalDuration:0,calls:0},e[o].totalDuration+=s,e[o].calls++});let r=[];for(let o in e){let s=e[o];s.averageDuration=s.totalDuration/s.calls,r.push({functionName:o,data:s})}r.sort((o,s)=>s.data.totalDuration-o.data.totalDuration),r=r.slice(0,3),r.forEach(o=>{j.log(t,`${o.functionName}: ${o.data.calls} calls, ${o.data.totalDuration.toFixed(2)}ms`)})}},pf=DD;var ju=class extends Ci{constructor(t=800,e=600,r){super();this._maxTextureSize=null;this._options=b(b({debug:!1},r),{pixelRatio:1,transparent:!1,clearColor:U.BLACK}),this.setMaxListeners(0),this._width=t,this._height=e,this._dimensions=new et(this._width,this._height),this._maxTextureSize=null,this._pixelRatio=this._options.pixelRatio,this._canvas=this._options.canvas,this._clearColor=this._options.transparent?U.TRANSPARENT:this._options.clearColor||U.BLACK}setCanvas(t){let e=this._canvas;this._canvas=t,e!==t&&(this._createContext(),this._onBeforeContext(),this._setupContext()),this.resizeTo(new et(this._width,this._height))}getCanvas(){return this._canvas}_onBeforeContext(){}resizeTo(t,e=!0){this._width=t.x*this._pixelRatio,this._height=t.y*this._pixelRatio,e&&this._canvas&&(this._canvas.width=this._width,this._canvas.height=this._height,"style"in this._canvas&&(this._canvas.style.width=`${this._width/this._pixelRatio}px`,this._canvas.style.height=`${this._height/this._pixelRatio}px`)),this._dimensions=t.clone()}_createContext(){j.warn(this.constructor.name,"`_createContext` is abstract and not implemented in inherited class")}_setupContext(){j.warn(this.constructor.name,"`_setupContext` is abstract and not implemented in inherited class")}render(t){j.warn(this.constructor.name,"`render` is abstract and not implemented in inherited class")}getMaxDimensions(){return null}getContext(){return this._context}getWidth(){return this._dimensions.x}getHeight(){return this._dimensions.y}getDimensions(){return this._dimensions}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){this._pixelRatio=t,this._defaultRenderTarget&&this._defaultRenderTarget.setPixelRatio(t)}getMaxTextureSize(){return this._maxTextureSize}getFilterManager(){return this._filterManager}setFilterManager(t){this._filterManager=t}isOfType(t){return this._type===t}dispose(){j.warn(this.constructor.name,"`dispose` is abstract and not implemented in inherited class")}};var{RendererType:ID}=Pi,Wx=class extends ju{constructor(t=800,e=600,r){super(t,e,b({},r));this.id=0;this.setCanvas((r==null?void 0:r.canvas)||Qe.createCanvas()),this._type=ID.CANVAS}_createContext(){let e=this._canvas.getContext("2d");if(!!e)return this._options.debug&&(e=new pf(e)),this.id=Wx.contextId++,this._context=e,this.emit("context",e),e}_setupContext(){let t=this._context;"imageSmoothingEnabled"in t?t.imageSmoothingEnabled=!0:["moz","webkit","ms"].forEach(e=>{t[e]&&(t[e]=!0)}),this._defaultRenderTarget=new Gs(this._width,this._height,this._pixelRatio,this._canvas,this._context),this.setRenderTarget(this._defaultRenderTarget),this._filterManager=new el(this)}render(t){let e=this._renderTarget.getContext(),r=t.getParent();t.setParent(new tl),t.updateTransform(),r&&t.setParent(r),e.setTransform(1,0,0,1,0,0),e.globalAlpha=1;let{width:o,height:s}=this._canvas;e.clearRect(0,0,o,s),this._clearColor.a!==0&&(e.save(),e.fillStyle=this._clearColor.toRGBA(),e.fillRect(0,0,o,s),e.restore()),this.renderDisplayObject(t,this._renderTarget)}renderDisplayObject(t,e){let r=this._renderTarget;this._filterManager.setFilterStack(e.getFilterStack()),this.setRenderTarget(e),t.renderCanvas(this),this.setRenderTarget(r)}getCurrentRenderTarget(){return this._renderTarget}setRenderTarget(t){this._renderTarget=t}getContext(){return this._renderTarget.getContext()}dispose(){this._filterManager.dispose()}},kc=Wx;kc.contextId=0,kc.type=ID.CANVAS;var ED=i=>{if(typeof window!="undefined"){let{WebGLDebugUtils:t}=window;if(t){let e=(r,o)=>{console.error(`gl.${r}(${t.glFunctionArgsToString(r,o)})`)};i=t.makeDebugContext(i,null,e)}}return i};var Gx=class{constructor(t){this.vertices=new Float32Array([0,0,100,0,100,100,0,100]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.indices=new Uint16Array([0,1,2,0,3,2]);this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);this.vertexBuffer=null;this.indexBuffer=null;this.gl=t,this.initBuffers(),this.uploadBuffers()}map(t,e){let{x:r,y:o}=e;this.uvs[2]=e.width/t.width,this.uvs[4]=this.uvs[2],this.uvs[5]=e.height/t.height,this.uvs[7]=this.uvs[5],this.vertices[0]=r,this.vertices[1]=o,this.vertices[2]=r+e.width,this.vertices[3]=o,this.vertices[4]=this.vertices[2],this.vertices[5]=o+e.height,this.vertices[6]=r,this.vertices[7]=this.vertices[5],this.uploadBuffers()}getVertexBuffer(){return this.vertexBuffer}getIndexBuffer(){return this.indexBuffer}dispose(){this.cleanBuffer()}initBuffers(){let{gl:t}=this;this.cleanBuffer(),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,(8+8+16)*4,t.DYNAMIC_DRAW),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)}uploadBuffers(){let{gl:t}=this;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices),t.bufferSubData(t.ARRAY_BUFFER,8*4,this.uvs),t.bufferSubData(t.ARRAY_BUFFER,(8+8)*4,this.colors)}cleanBuffer(){let{gl:t}=this;t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.indexBuffer)}};var Vs=class{constructor(t,e,r,o,s=!1){this._renderer=t,this._gl=t.getContext(),this._width=e,this._height=r,this._frame=null,this._pixelRatio=o,this._projectionMatrix=new Mi,this._mipMapping=!1,this._baseTexture=new Te;let n=this._baseTexture.getFrame();n.width=e,n.height=r,this._baseTexture.setPixelRatio(o),this._baseTexture.setLoaded(!0),this._framebuffer=null,this._isRoot=s,this._filterStack=[{renderTarget:this,filters:[]}],s||this._initFrameBuffer()}resizeTo(t){this._width=t.x|0,this._height=t.y|0,this._baseTexture.resizeTo(t),this._isRoot||this._resizeTexture(),this._baseTexture.setMinFilter(this._getMinFilter()),this._baseTexture.setMagFilter(this._getMagFilter()),this._calculateProjectionMatrix()}_getMinFilter(){let t=Te.DefaultMinFilter;return this._mipMapping&&(t=Te.TrilinearFilter),t}_getMagFilter(){return Te.DefaultMagFilter}_resizeTexture(){let t=this._gl,e=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this._texture&&(t.deleteTexture(this._texture),this._texture=null),this._texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,r,0,t.RGBA,t.UNSIGNED_BYTE,null),t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._texture,0),this._texture&&this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this._renderer._options.debug&&Ja.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",t);let o=new et(this._width,this._height);z.isPowerOfTwo(o)?(j.info("WebGLRenderTarget","Mip-mapping enabled"),this._mipMapping=!0):this._mipMapping=!1,this._baseTexture.setMipMappingEnabled(this._mipMapping)}activate(){let t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),this._calculateProjectionMatrix(),t.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),t.disable(t.STENCIL_TEST)}clear(t=U.TRANSPARENT){let e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),this._renderer._options.debug&&Ja.checkFramebufferStatus("WebGLRenderTarget#clear",e),e.clearColor.apply(e,t.toGLColor()),e.clear(e.COLOR_BUFFER_BIT)}_calculateProjectionMatrix(){let t=this._projectionMatrix;t.reset();let e=this._frame||new te(0,0,this._width,this._height),{x:r,y:o}=e;this._isRoot?(t.a=1/this._width*2,t.d=-1/this._height*2,t.tx=-1-r*t.a,t.ty=1-o*t.d):(t.a=1/this._width*2,t.d=1/this._height*2,t.tx=-1-r*t.a,t.ty=-1-o*t.d)}_initFrameBuffer(){let t=this._gl;this._framebuffer&&(t.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(t.deleteTexture(this._texture),this._texture=null),this._framebuffer=t.createFramebuffer(),this._texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._texture),t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this._texture,0),this._texture&&this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this.resizeTo(new et(this._width,this._height)),this._renderer._options.debug&&Ja.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",t)}getProjectionMatrix(){return this._projectionMatrix}getTexture(){return this._texture}getFrame(){return this._frame}setFrame(t){this._frame=t}getFilterStack(){return this._filterStack}getPixelRatio(){return this._pixelRatio}setPixelRatio(t){this._pixelRatio=t,this._isRoot||this._resizeTexture()}getBaseTexture(){return this._baseTexture}dispose(){let t=this._gl;this._baseTexture.dispose(),this._framebuffer&&(t.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(t.deleteTexture(this._texture),this._texture=null)}};var $u=class{constructor(t){this._renderer=t,this._filterStack=[],this._currentFrame=null,this._renderTargets=[],this._textureFrame=new te(0,0,t.getWidth(),t.getHeight()),this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._onContextChange()}resizeTo(t){this._textureFrame.width=t.x,this._textureFrame.height=t.y,this._renderTargets.forEach(e=>e.resizeTo(t))}getFilterStack(){return this._filterStack}setFilterStack(t){this._filterStack=t}_getOrCreateRenderTarget(t=!1){let e=this._renderTargets.pop();return e||(e=new Vs(this._renderer,this._textureFrame.width,this._textureFrame.height,1)),this._currentFrame&&e.setFrame(this._currentFrame),t&&e.clear(),e}pushFilters(t,e){let r=t.getBounds();this._currentFrame=r;let o=t.getFilterRectangle();o.width>0&&o.height>0&&(this._currentFrame=o);let s=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(s),s.clear(),this._filterStack.push({renderTarget:s,filters:e})}popFilters(){let t=this._filterStack.pop();if(!t)return;let{filters:e,renderTarget:r}=t,o=this._filterStack[this._filterStack.length-1],s=r,n=o.renderTarget,a=s.getFrame();a&&this._quad.map(this._textureFrame,a);let l=e[0].getShaderForRenderer(this._renderer),c=this._quad.getVertexBuffer(),d=this._quad.getIndexBuffer(),u=this._renderer.getContext();u.bindBuffer(u.ARRAY_BUFFER,c),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,d);let m=l.getAttributeLocations();return u.vertexAttribPointer(m.a_position,2,u.FLOAT,!1,0,0),u.vertexAttribPointer(m.a_texCoord,2,u.FLOAT,!1,0,2*4*4),u.vertexAttribPointer(m.a_color,4,u.FLOAT,!1,0,4*4*4),this._renderer.updateTexture(s.getBaseTexture(),!1),e.length===1?(e[0].apply(this._renderer,s,n),this._renderTargets.push(s)):this._applyFilters(e,s,n),e}_applyFilters(t,e,r){let o=e,s=this._getOrCreateRenderTarget(!0);this._renderer.updateTexture(s.getBaseTexture(),!1);let n=t[t.length-1];t.forEach(a=>{if(a===n)a.apply(this._renderer,o,r,!0);else{a.apply(this._renderer,o,s,!0);let c=o;o=s,s=c}}),this._renderTargets.push(o),this._renderTargets.push(s)}_onContextChange(){this._renderTargets.length=0,yc(this._renderer)&&(this._quad&&this._quad.dispose(),this._quad=new Gx(this._renderer.getContext()))}dispose(){this._renderer.off("context",this._onContextChange),this._quad&&this._quad.dispose(),this._renderTargets.forEach(t=>{t.dispose()})}};var ta=y(AD()),jx=class{constructor(t){this._context=t,this._domAvailable=typeof document!="undefined",this._hookIntoContext(),this._textures={},this._framebuffers={},this._programs={},this._shaders={},this._buffers={},this._boundTexture=null,this._id=0,this._enums={},this._setupStats(),this._createEnumMap(),this._updateMemoryStats=this._updateMemoryStats.bind(this),this._updateMemoryStats()}_createEnumMap(){for(let t in this._context){let e=this._context[t];typeof e=="number"&&(this._enums[e]=t)}}_enumValueToString(t){let e=this._enums[t];return typeof e=="undefined"?t:e}_setupStats(){!this._domAvailable||(this._stats=new ta.default,this._stats.showPanel(3),this._memPanel=this._stats.addPanel(new ta.default.Panel("MB [WebGL]","#43ADEB","#282828")),this._texPanel=this._stats.addPanel(new ta.default.Panel("Textures","#43ADEB","#282828")),this._bufPanel=this._stats.addPanel(new ta.default.Panel("Buffers","#43ADEB","#282828")),this._fboPanel=this._stats.addPanel(new ta.default.Panel("FBOs","#43ADEB","#282828")),this._prgPanel=this._stats.addPanel(new ta.default.Panel("Programs","#43ADEB","#282828")),this._shdPanel=this._stats.addPanel(new ta.default.Panel("Shaders","#43ADEB","#282828")))}_updatePanel(t){if(!!this._domAvailable){switch(this._stats.begin(),t){case"tex":this._texPanel.update(this.getTexturesCount(),50);break;case"buf":this._bufPanel.update(this.getBuffersCount(),50);break;case"fbo":this._fboPanel.update(this.getFBOCount(),50);break;case"prg":this._prgPanel.update(this.getProgramCount(),50);break;case"shd":this._shdPanel.update(this.getShaderCount(),50);break}this._stats.end()}}getTexturesCount(){return Object.keys(this._textures).length}getBuffersCount(){return Object.keys(this._buffers).length}getFBOCount(){return Object.keys(this._framebuffers).length}getProgramCount(){return Object.keys(this._programs).length}getShaderCount(){return Object.keys(this._shaders).length}_updateMemoryStats(){if(!this._domAvailable)return;let t=this._getMemoryUsage()/1e3/1e3;this._memPanel.update(t,400),setTimeout(this._updateMemoryStats,1e3)}_getMemoryUsage(){let t=0;for(let e in this._textures)t+=this._textures[e].memory;for(let e in this._buffers)t+=this._buffers[e].memory;return t}_hookIntoContext(){for(let t in this._context)typeof this._context[t]=="function"?this[t]=function(...r){let o=this._context[t];return this._trackGLCall(o,t,r)}:this._makePropertyWrapper(t)}_makePropertyWrapper(t){if(["_context"].indexOf(t)!==-1)return;let r=this._context;this.__defineGetter__(t,()=>r[t]),this.__defineSetter__(t,o=>{r[t]=o})}_trackGLCall(t,e,r){let o=["texImage2D","bindTexture","createTexture","deleteTexture","createBuffer","bindBuffer","bufferData","deleteBuffer","createFramebuffer","deleteFramebuffer","createProgram","deleteProgram","createShader","deleteShader"],s;o.indexOf(e)!==-1?s=this[`_${e}`](r):s=t.apply(this._context,r);let n=this._context.getError();if(n!==0){let a=r.join(", ");a.length>100&&(a=`${a.substr(0,100)}...`),console.error(new Error(`WebGL Error ${this._enumValueToString(n)} in ${e}(${a})`))}return s}_createProgram(){let t=this._context.createProgram();return t._wmmId=this._id++,this._programs[t._wmmId]=t,this._updatePanel("prg"),t}_deleteProgram([t]){!t||!this._programs[t._wmmId]||(delete this._programs[t._wmmId],this._context.deleteProgram(t),this._updatePanel("prg"))}_createShader([t]){let e=this._context.createShader(t);return e._wmmId=this._id++,this._shaders[e._wmmId]=e,this._updatePanel("shd"),e}_deleteShader([t]){!t||!this._shaders[t._wmmId]||(delete this._shaders[t._wmmId],this._context.deleteShader(t),this._updatePanel("shd"))}_createFramebuffer(){let t=this._context.createFramebuffer();return t._wmmId=this._id++,this._framebuffers[t._wmmId]=t,this._updatePanel("fbo"),t}_deleteFramebuffer([t]){!t||!this._framebuffers[t._wmmId]||(delete this._framebuffers[t._wmmId],this._context.deleteFramebuffer(t),this._updatePanel("fbo"))}_createBuffer(){let t=this._context.createBuffer();return t._wmmId=this._id++,this._buffers[t._wmmId]={buffer:t,memory:0},this._updatePanel("buf"),t}_bindBuffer([t,e]){this._context.bindBuffer(t,e),this._boundBuffer=e._wmmId}_bufferData([t,e,r]){this._context.bufferData(t,e,r);let o;typeof e=="number"?o=e:"byteLength"in e?o=e.byteLength:"length"in e&&(o=e.length),this._buffers[this._boundBuffer].memory=o}_deleteBuffer([t]){!t||!this._buffers[t._wmmId]||(delete this._buffers[t._wmmId],this._context.deleteBuffer(t),this._updatePanel("buf"))}_createTexture(){let t=this._context.createTexture();return t._wmmId=this._id++,this._textures[t._wmmId]={texture:t,memory:0},this._updatePanel("tex"),t}_deleteTexture([t]){!t||!this._textures[t._wmmId]||(delete this._textures[t._wmmId],this._context.deleteTexture(t),this._updatePanel("tex"))}_bindTexture([t,e]){this._context.bindTexture(t,e),this._boundTexture=e._wmmId}_texImage2D(t){let[,,e,r,o,s,,,n]=t;typeof n=="undefined"&&(n=s),this._context.texImage2D.apply(this._context,t);let a=this._calculateByteCountForTexture(e,r,o,n);this._textures[this._boundTexture].memory=a}_calculateByteCountForTexture(t,e,r,o){if(o!==null)if("width"in o)e=o.width,r=o.height;else return o.length;let s=1;switch(t){case this._context.ALPHA:s=1;break;case this._context.RGB:s=3;break;case this._context.RGBA:s=4;break}return e*r*s}},FD=jx;var Ku=class{constructor(t){this._renderer=t,this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange)}_onContextChange(){}start(){}stop(){this.flush()}flush(){}dispose(){this._renderer.off("context",this._onContextChange),delete this._renderer}};var $x=class extends Ku{constructor(t){super(t);this._vertexBuffer=null;this._indexBuffer=null;this._maxBatchSize=Cc,this._vertices=new ArrayBuffer(Cc*4*Zn),this._positions=new Float32Array(this._vertices),this._colors=new Uint32Array(this._vertices),this._indices=new Uint16Array(Cc*6);for(let e=0,r=0;e<Cc*6;e+=6,r+=4)this._indices[e+0]=r+0,this._indices[e+1]=r+1,this._indices[e+2]=r+2,this._indices[e+3]=r+0,this._indices[e+4]=r+2,this._indices[e+5]=r+3;this._sprites=[],this._currentBatchSize=0,this._onContextChange()}render(t){let e=t.getTexture();if(!e)return;let r=e.getFrame(),o=e.getBaseTexture();this._currentBatchSize>=this._maxBatchSize&&this.flush();let s=e.getUVs();if(!s)return;let n=this._currentBatchSize*Zn;this._addVertexCoordinates(t,n,r),this._addTextureUVs(t,n,s),this._addColors(t,n),this._sprites[this._currentBatchSize]=t,this._currentBatchSize++}_addColors(t,e){let r=this._colors,o=16777215,s=(o>>16)+(o&65280)+((o&255)<<16)+(t.getWorldAlpha()*255<<24);r[e+4]=r[e+9]=r[e+14]=r[e+19]=s}_addTextureUVs(t,e,r){let o=this._positions,[s,n,a,l]=r;o[e+2]=s.x,o[e+3]=s.y,o[e+7]=n.x,o[e+8]=n.y,o[e+12]=a.x,o[e+13]=a.y,o[e+17]=l.x,o[e+18]=l.y}_addVertexCoordinates(t,e,r){let o=this._positions,s=t.getWorldTransform(),n=t.getAnchor(),a=s.rectangleToCoordinates(r,n),l=5;for(let c=0;c<4;c++)o[e+c*l]=a[c].x,o[e+c*l+1]=a[c].y}_onContextChange(){let t=this._renderer.getContext();this._shader=this._renderer.shaders.default,this._vertexBuffer&&(this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer=null),this._vertexBuffer=t.createBuffer(),this._indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this._indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this._vertices,t.DYNAMIC_DRAW)}start(){this._vertexBuffer&&this._indexBuffer&&this._shader.setupBuffers(this._vertexBuffer,this._indexBuffer)}flush(){var m;let t=this._renderer,e=t.getContext();if(this._currentBatchSize===0)return;if(this._currentBatchSize>Cc*.5)e.bufferSubData(e.ARRAY_BUFFER,0,this._vertices);else{let p=this._positions.subarray(0,this._currentBatchSize*Zn);e.bufferSubData(e.ARRAY_BUFFER,0,p)}let r=0,o=null,s=null,n=null,a=null,l=!1,c=!1,d=null,u=0;for(let p=0,f=this._currentBatchSize;p<f;p++){if(d=this._sprites[p],s=(m=d.getTexture())==null?void 0:m.getBaseTexture(),a=d.getShader()||this._shader,l=n!==a,c=o!==s,(c||l)&&(o&&this._renderBatch(o,r,u),u=p,r=0,o=s,l)){n=a,t.setShader(n);let x=t.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",x),n.syncUniforms(),e.activeTexture(e.TEXTURE0)}r++}o&&this._renderBatch(o,r,u),this._currentBatchSize=0,this._sprites=[]}_renderBatch(t,e,r){if(e===0)return;let o=this._renderer,s=o.getContext(),n=t.getGLTextureForRenderer(o);n||(n=o.getOrCreateGLTexture(t)),t.isDirty()&&(o.updateTexture(t),t.setDirty(!1)),s.activeTexture(s.TEXTURE0+t.getGLUnit()),s.bindTexture(s.TEXTURE_2D,n);let a=e*6,l=r*6*2;s.drawElements(s.TRIANGLES,a,s.UNSIGNED_SHORT,l)}dispose(){let e=this._renderer.getContext();this._sprites.forEach(r=>{r.dispose()}),this._vertexBuffer&&(e.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(e.deleteBuffer(this._indexBuffer),this._indexBuffer=null),delete this._vertices,delete this._positions,delete this._colors,delete this._indices,super.dispose()}};var Yx=class extends ju{constructor(t=800,e=600,r){super(t,e,r);this.type=gt.WEBGL;this.maxTextureDimensions=null;this._type=gt.WEBGL,this._onContextLost=this._onContextLost.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.setCanvas(this._options.canvas||Qe.createCanvas()),this.shaders={default:new Mx(this,void 0,void 0)},this.renderers={sprite:new $x(this)}}_onContextLost(t){t.preventDefault(),j.warn(this.constructor.name,"WebGL context has been lost - trying to restore.")}_onContextCreationError(t){t.preventDefault(),j.warn(this.constructor.name,`Failed to create WebGL context: ${t.statusMessage||"Unknown error"}`)}_onContextRestored(){j.warn(this.constructor.name,"WebGL context has been restored. Clearing all textures."),this._createContext(),this._setupContext(),this.emit("context-restored")}_onBeforeContext(){this._filterManager&&this._filterManager.dispose(),this._filterManager=new $u(this),this._currentObjectRenderer=new Ku(this)}setShader(t){this._currentShader=t,this._context.useProgram(t.getProgram()),this._setAttributesForShader(t)}setCanvas(t){this._canvas&&this._removeContextEventListeners(),super.setCanvas(t),this._addContextEventListeners()}_addContextEventListeners(){Tx(this._canvas)&&(this._canvas.addEventListener("webglcontextlost",this._onContextLost),this._canvas.addEventListener("webglcontextrestored",this._onContextRestored),this._canvas.addEventListener("webglcontextcreationerror",this._onContextCreationError))}_removeContextEventListeners(){Tx(this._canvas)&&(this._canvas.removeEventListener("webglcontextlost",this._onContextLost),this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored),this._canvas.removeEventListener("webglcontextcreationerror",this._onContextCreationError))}_setAttributesForShader(t){if(!this._canvas)return;let e=this._context,r=t.getAttributes(),o=t.getAttributeLocations();r.forEach(s=>{let n=o[s];e.enableVertexAttribArray(n)})}_createContext(){if(!this._canvas)return;let t=Qe.glGet(this._canvas);return this._options.debug&&ED(t),this._options.debug&&(t=new pf(t),t=new FD(t)),this.id=Yx.contextId++,this._context=t,this._maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.emit("context",t),t}_setupContext(){let t=this._context;t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),this._defaultRenderTarget=new Vs(this,this._width,this._height,this._pixelRatio,!0),this.setRenderTarget(this._defaultRenderTarget),this._getMaxPrecision()}getContext(){return this._context}_getMaxPrecision(){let t=this._context,e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);this._maxFloatPrecision=(e==null?void 0:e.precision)!==0?Or.High:Or.Medium;let r=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_INT);this._maxIntPrecision=(r==null?void 0:r.rangeMax)!==0?Or.High:Or.Low}resizeTo(t,e=!0){super.resizeTo(t,e),this._currentRenderTarget&&this._currentRenderTarget.resizeTo(t),this._context=Qe.glResize(this._context,t)}setRenderTarget(t=this._defaultRenderTarget){this._currentRenderTarget=t,this._currentRenderTarget.activate()}setObjectRenderer(t){this._currentObjectRenderer.stop(),this._currentObjectRenderer=t,this._currentObjectRenderer.start()}render(t){this.setRenderTarget(this._defaultRenderTarget),this._defaultRenderTarget.clear(this._clearColor);let e=t.getParent();t.setParent(new tl),t.updateTransform(),e&&t.setParent(e),this.renderDisplayObject(t,this._defaultRenderTarget)}renderDisplayObject(t,e){this.setRenderTarget(e),this._filterManager.setFilterStack(e.getFilterStack()),t.renderWebGL(this),this._currentObjectRenderer.flush()}clear(){let t=this._context;t.clearColor.apply(t,this._clearColor.toGLColor),t.clear(t.COLOR_BUFFER_BIT)}save(){return{renderTarget:this._currentRenderTarget,objectRenderer:this._currentObjectRenderer,filterStack:this._filterManager.getFilterStack()}}restore(t){this.setRenderTarget(t.renderTarget),this._filterManager.setFilterStack(t.filterStack),this._currentObjectRenderer=t.objectRenderer}getOrCreateGLTexture(t){let e=this._context,r=t.getGLTextureForRenderer(this);return r||(r=e.createTexture(),t.setGLTextureForRenderer(r,this)),r}updateTexture(t,e=!0){let r=t.getSource(),o=this._context,s=t.getGLUnit(),n=this.getOrCreateGLTexture(t);o.activeTexture(o.TEXTURE0+s),o.bindTexture(o.TEXTURE_2D,n),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e&&r&&Qe.glTexImage(o,r),t.isMipMappingEnabled()?o.generateMipmap(o.TEXTURE_2D):(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,t.getGLRepeat(o,"x")),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,t.getGLRepeat(o,"y"))),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,t.getGLFilter(o,"min")),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t.getGLFilter(o,"mag")),o.activeTexture(o.TEXTURE0)}getMaxDimensions(){return this.maxTextureDimensions||(this.maxTextureDimensions=Qe.glMaxTexture(this._context)),this.maxTextureDimensions}getCurrentRenderTarget(){return this._currentRenderTarget}getCurrentObjectRenderer(){return this._currentObjectRenderer}getMaxFloatPrecision(){return this._maxFloatPrecision}getMaxIntPrecision(){return this._maxIntPrecision}dispose(){this._filterManager.dispose(),this._currentObjectRenderer.dispose(),this._defaultRenderTarget.dispose();for(let r in this.shaders)this.shaders[r].dispose(),delete this.shaders[r];this._removeContextEventListeners();let e=this._context.getExtension("WEBGL_lose_context");e&&e.loseContext()}},hf=Yx;hf.contextId=0;var Nz=()=>[new et(0,0),new et(1,0),new et(1,1),new et(0,1)],Hz=(i,t,e)=>{let[r,o,s,n]=i;return r.x=t.x/e.width,r.y=t.y/e.height,o.x=(t.x+t.width)/e.width,o.y=t.y/e.height,s.x=(t.x+t.width)/e.width,s.y=(t.y+t.height)/e.height,n.x=t.x/e.width,n.y=(t.y+t.height)/e.height,i},Kx={create:Nz,updateViaFrames:Hz};var ea=class extends Ci{constructor(t,e){super();if(!(t instanceof Te))throw new Error("`baseTexture` should be an instance of BaseTexture");this._uvs=Kx.create(),this._frame=e?e.clone():new te(0,0,1,1),this._frameLocked=Boolean(e),this._onBaseTextureLoaded=this._onBaseTextureLoaded.bind(this),this._onBaseTextureUpdated=this._onBaseTextureUpdated.bind(this),this.setBaseTexture(t)}static fromImage(t){let e=new Te(t);return new ea(e)}static fromCanvas(t){let e=new Te(t);return new ea(e)}_onBaseTextureLoaded(){if(!this._frameLocked){let t=this._baseTexture.getFrame().clone();this.setFrame(t)}this._baseTexture.on("update",this._onBaseTextureUpdated)}_onBaseTextureUpdated(){let{width:t,height:e}=this._baseTexture.getFrame();this._frame.width=t,this._frame.height=e,this.emit("update")}_updateUVs(){this._uvs=Kx.updateViaFrames(this._uvs,this._frame,this._baseTexture.getFrame())}getBaseTexture(){return this._baseTexture}setBaseTexture(t){if(this._baseTexture=t,!this._baseTexture.isLoaded())this._baseTexture.once("loaded",this._onBaseTextureLoaded);else{let{width:e,height:r}=t.getFrame();this._frameLocked||(this._frame=new te(0,0,e,r)),this._onBaseTextureLoaded()}}getFrame(){return this._frame}setFrame(t){this._frame=t,this._updateUVs()}getWidth(){return this._frame.width}getHeight(){return this._frame.height}getUVs(){return this._uvs}getDimensions(){return new et(this._frame.width,this._frame.height)}dispose(t=!0){t&&this._baseTexture.dispose()}};var Xu=i=>i._type===gt.WEBGL,qu=class extends ea{constructor(t,e=100,r=100,o=1){super(new Te,new te(0,0,e,r));this._loaded=!0,this._width=e,this._height=r,this._pixelRatio=o,this._renderer=t,this._setupFilterManager(),this._setupBuffer(),this.setBaseTexture(this._renderTarget.getBaseTexture()),this._updateUVs()}_setupFilterManager(){this._filterManager&&this._filterManager.dispose(),Xu(this._renderer)?this._filterManager=new $u(this._renderer):this._filterManager=new el(this._renderer),this._filterManager.resizeTo(new et(this._width,this._height))}_setupBuffer(){this._renderTarget&&this._renderTarget.dispose(),Xu(this._renderer)?this._renderTarget=new Vs(this._renderer,this._width,this._height,this._pixelRatio):this._renderTarget=new Gs(this._width,this._height,this._pixelRatio)}clear(t){this._renderTarget.clear(t)}resizeTo(t){this._width===t.x&&this._height===t.y||(this._width=t.x,this._height=t.y,this._frame.width=t.x,this._frame.height=t.y,this._renderTarget.resizeTo(t),this._filterManager.resizeTo(t))}render(t){Xu(this._renderer)?this._renderWebGL(t):this._renderCanvas(t)}_renderWebGL(t){if(!Xu(this._renderer))return;this._renderTarget.activate(),t.getWorldTransform().reset(),t.getChildren().forEach(r=>{r.updateTransform()});let e=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(t,this._renderTarget),this._renderer.setFilterManager(e)}_renderCanvas(t){if(Xu(this._renderer))return;t.getWorldTransform().reset(),t.getChildren().forEach(r=>{r.updateTransform()});let e=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(t,this._renderTarget),this._renderer.setFilterManager(e)}getRenderTarget(){return this._renderTarget}dispose(){this._renderTarget.dispose(),this._filterManager.dispose(),super.dispose()}};var Ju={};ne(Ju,{Base64:()=>eo,Color:()=>U,ColorMatrix:()=>Hu,Configurable:()=>Ct,Constants:()=>Pi,CubicBezierCurve:()=>e0,Engine:()=>L,EventEmitter:()=>Ci,Events:()=>Tc,FreeLicenseChecker:()=>t0,GLUtils:()=>Ja,LicenseChecker:()=>bf,Log:()=>j,Matrix:()=>Mi,Range:()=>i0,Rectangle:()=>te,Utils:()=>z,Vector2:()=>et,Vector3:()=>r0,cancelAnimationFrame:()=>oa,requestAnimationFrame:()=>$s});var Tc={EXPORT:"export",CLOSE:"close",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",EDITOR_READY:"editor:ready",WINDOW_RESIZE:"window:resize",ZOOM_DONE:"editor:zoom_done",HISTORY_UNDO:"history:undo",HISTORY_UPDATED:"history:update",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"};var js={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_duotone",defaultName:"DuoTone",assetFileName:"duotone",filters:[{identifier:"imgly_duotone_desert",defaultName:"Desert",lightColor:"#e1de9a",darkColor:"#cb2129"},{identifier:"imgly_duotone_peach",defaultName:"Peach",lightColor:"#e9abb8",darkColor:"#0040ff"},{identifier:"imgly_duotone_clash",defaultName:"Clash",lightColor:"#f41a0f",darkColor:"#23007c"},{identifier:"imgly_duotone_plum",defaultName:"Plum",lightColor:"#74d7ff",darkColor:"#23007c"},{identifier:"imgly_duotone_breezy",defaultName:"Breezy",lightColor:"#68fdff",darkColor:"#c20000"},{identifier:"imgly_duotone_deepblue",defaultName:"Deep Blue",lightColor:"#2de9eb",darkColor:"#58007c"},{identifier:"imgly_duotone_frog",defaultName:"Frog",lightColor:"#5bff60",darkColor:"#7f23a9"},{identifier:"imgly_duotone_sunset",defaultName:"Sunset",lightColor:"#f8ea46",darkColor:"#c400be"}]},{identifier:"imgly_filters_bw",assetFileName:"b&w",defaultName:"Black & White",filters:[{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"Greyed",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"Dusty",lutImage:"filters/imgly_lut_dusty_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia",lutImage:"filters/imgly_lut_sepia_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Weathered",lutImage:"filters/imgly_lut_weathered_5_5_128.png"},{identifier:"imgly_lut_sin",defaultName:"Hard Stuff",lutImage:"filters/imgly_lut_hard_stuff_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8}]},{identifier:"imgly_filters_retro",assetFileName:"vintage",defaultName:"Vintage",filters:[{identifier:"imgly_lut_blues",defaultName:"Polaroid",lutImage:"filters/imgly_lut_polaroid_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Sunny 70s",lutImage:"filters/imgly_lut_sunny_70s_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_texas",defaultName:"Oldtimer",lutImage:"filters/imgly_lut_oldtimer_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_celsius",defaultName:"Inferno",lutImage:"filters/imgly_lut_inferno_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_cool",defaultName:"Snappy",lutImage:"filters/imgly_lut_snappy_5_5_128.png"}]},{identifier:"imgly_filters_analog",assetFileName:"smooth",defaultName:"Smooth",filters:[{identifier:"imgly_lut_chest",defaultName:"Chestnut",lutImage:"filters/imgly_lut_chestnut_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_winter",defaultName:"Softly",lutImage:"filters/imgly_lut_softly_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"Pebble",lutImage:"filters/imgly_lut_pebble_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Moss",lutImage:"filters/imgly_lut_moss_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lemon",lutImage:"filters/imgly_lut_lemon_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Green Gap",lutImage:"filters/imgly_lut_green_gap_5_5_128.png"}]},{identifier:"imgly_filters_winter",assetFileName:"cold",defaultName:"Cold",filters:[{identifier:"imgly_lut_elder",defaultName:"Colla",lutImage:"filters/imgly_lut_colla_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Solanus",lutImage:"filters/imgly_lut_solanus_5_5_128.png"},{identifier:"imgly_lut_bleached",defaultName:"Kalmen",lutImage:"filters/imgly_lut_kalmen_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Joran",lutImage:"filters/imgly_lut_joran_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Levante",lutImage:"filters/imgly_lut_levante_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Zephyr",lutImage:"filters/imgly_lut_zephyr_5_5_128.png"}]},{identifier:"imgly_filters_summer",assetFileName:"warm",defaultName:"Warm",filters:[{identifier:"imgly_lut_sunset",defaultName:"Golden",lutImage:"filters/imgly_lut_golden_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Low Fire",lutImage:"filters/imgly_lut_low_fire_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Sunrise",lutImage:"filters/imgly_lut_sunrise_5_5_128.png"},{identifier:"imgly_lut_k2",defaultName:"Flat Black",lutImage:"filters/imgly_lut_flat_black_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_nogreen",defaultName:"Pumpkin",lutImage:"filters/imgly_lut_pumpkin_5_5_128.png"}]},{identifier:"imgly_filters_legacy",defaultName:"Legacy",assetFileName:"legacy",filters:[{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"Hicon",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_lomo",defaultName:"Lomo",lutImage:"filters/imgly_lut_lomo_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}};var Xx={};Xx=window.navigator;var ia,Wz=244837814094590,OD=(Wz&16777215)==15715070;function G(i,t,e){i!=null&&(typeof i=="number"?this.fromNumber(i,t,e):t==null&&typeof i!="string"?this.fromString(i,256):this.fromString(i,t))}function zt(){return new G(null)}function Gz(i,t,e,r,o,s){for(;--s>=0;){var n=t*this[i++]+e[r]+o;o=Math.floor(n/67108864),e[r++]=n&67108863}return o}function Vz(i,t,e,r,o,s){for(var n=t&32767,a=t>>15;--s>=0;){var l=this[i]&32767,c=this[i++]>>15,d=a*l+c*n;l=n*l+((d&32767)<<15)+e[r]+(o&1073741823),o=(l>>>30)+(d>>>15)+a*c+(o>>>30),e[r++]=l&1073741823}return o}function jz(i,t,e,r,o,s){for(var n=t&16383,a=t>>14;--s>=0;){var l=this[i]&16383,c=this[i++]>>14,d=a*l+c*n;l=n*l+((d&16383)<<14)+e[r]+o,o=(l>>28)+(d>>14)+a*c,e[r++]=l&268435455}return o}OD&&Xx.appName=="Microsoft Internet Explorer"?(G.prototype.am=Vz,ia=30):OD&&Xx.appName!="Netscape"?(G.prototype.am=Gz,ia=26):(G.prototype.am=jz,ia=28);G.prototype.DB=ia;G.prototype.DM=(1<<ia)-1;G.prototype.DV=1<<ia;var qx=52;G.prototype.FV=Math.pow(2,qx);G.prototype.F1=qx-ia;G.prototype.F2=2*ia-qx;var $z="0123456789abcdefghijklmnopqrstuvwxyz",ff=new Array,Dc,Pr;Dc="0".charCodeAt(0);for(Pr=0;Pr<=9;++Pr)ff[Dc++]=Pr;Dc="a".charCodeAt(0);for(Pr=10;Pr<36;++Pr)ff[Dc++]=Pr;Dc="A".charCodeAt(0);for(Pr=10;Pr<36;++Pr)ff[Dc++]=Pr;function RD(i){return $z.charAt(i)}function PD(i,t){var e=ff[i.charCodeAt(t)];return e==null?-1:e}function Yz(i){for(var t=this.t-1;t>=0;--t)i[t]=this[t];i.t=this.t,i.s=this.s}function Kz(i){this.t=1,this.s=i<0?-1:0,i>0?this[0]=i:i<-1?this[0]=i+this.DV:this.t=0}function ra(i){var t=zt();return t.fromInt(i),t}function Xz(i,t){var e;if(t==16)e=4;else if(t==8)e=3;else if(t==256)e=8;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else{this.fromRadix(i,t);return}this.t=0,this.s=0;for(var r=i.length,o=!1,s=0;--r>=0;){var n=e==8?i[r]&255:PD(i,r);if(n<0){i.charAt(r)=="-"&&(o=!0);continue}o=!1,s==0?this[this.t++]=n:s+e>this.DB?(this[this.t-1]|=(n&(1<<this.DB-s)-1)<<s,this[this.t++]=n>>this.DB-s):this[this.t-1]|=n<<s,s+=e,s>=this.DB&&(s-=this.DB)}e==8&&(i[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&G.ZERO.subTo(this,this)}function qz(){for(var i=this.s&this.DM;this.t>0&&this[this.t-1]==i;)--this.t}function Zz(i){if(this.s<0)return"-"+this.negate().toString(i);var t;if(i==16)t=4;else if(i==8)t=3;else if(i==2)t=1;else if(i==32)t=5;else if(i==4)t=2;else return this.toRadix(i);var e=(1<<t)-1,r,o=!1,s="",n=this.t,a=this.DB-n*this.DB%t;if(n-- >0)for(a<this.DB&&(r=this[n]>>a)>0&&(o=!0,s=RD(r));n>=0;)a<t?(r=(this[n]&(1<<a)-1)<<t-a,r|=this[--n]>>(a+=this.DB-t)):(r=this[n]>>(a-=t)&e,a<=0&&(a+=this.DB,--n)),r>0&&(o=!0),o&&(s+=RD(r));return o?s:"0"}function Jz(){var i=zt();return G.ZERO.subTo(this,i),i}function Qz(){return this.s<0?this.negate():this}function t8(i){var t=this.s-i.s;if(t!=0)return t;var e=this.t;if(t=e-i.t,t!=0)return this.s<0?-t:t;for(;--e>=0;)if((t=this[e]-i[e])!=0)return t;return 0}function gf(i){var t=1,e;return(e=i>>>16)!=0&&(i=e,t+=16),(e=i>>8)!=0&&(i=e,t+=8),(e=i>>4)!=0&&(i=e,t+=4),(e=i>>2)!=0&&(i=e,t+=2),(e=i>>1)!=0&&(i=e,t+=1),t}function e8(){return this.t<=0?0:this.DB*(this.t-1)+gf(this[this.t-1]^this.s&this.DM)}function i8(i,t){var e;for(e=this.t-1;e>=0;--e)t[e+i]=this[e];for(e=i-1;e>=0;--e)t[e]=0;t.t=this.t+i,t.s=this.s}function r8(i,t){for(var e=i;e<this.t;++e)t[e-i]=this[e];t.t=Math.max(this.t-i,0),t.s=this.s}function o8(i,t){var e=i%this.DB,r=this.DB-e,o=(1<<r)-1,s=Math.floor(i/this.DB),n=this.s<<e&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>r|n,n=(this[a]&o)<<e;for(a=s-1;a>=0;--a)t[a]=0;t[s]=n,t.t=this.t+s+1,t.s=this.s,t.clamp()}function s8(i,t){t.s=this.s;var e=Math.floor(i/this.DB);if(e>=this.t){t.t=0;return}var r=i%this.DB,o=this.DB-r,s=(1<<r)-1;t[0]=this[e]>>r;for(var n=e+1;n<this.t;++n)t[n-e-1]|=(this[n]&s)<<o,t[n-e]=this[n]>>r;r>0&&(t[this.t-e-1]|=(this.s&s)<<o),t.t=this.t-e,t.clamp()}function n8(i,t){for(var e=0,r=0,o=Math.min(i.t,this.t);e<o;)r+=this[e]-i[e],t[e++]=r&this.DM,r>>=this.DB;if(i.t<this.t){for(r-=i.s;e<this.t;)r+=this[e],t[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<i.t;)r-=i[e],t[e++]=r&this.DM,r>>=this.DB;r-=i.s}t.s=r<0?-1:0,r<-1?t[e++]=this.DV+r:r>0&&(t[e++]=r),t.t=e,t.clamp()}function a8(i,t){var e=this.abs(),r=i.abs(),o=e.t;for(t.t=o+r.t;--o>=0;)t[o]=0;for(o=0;o<r.t;++o)t[o+e.t]=e.am(0,r[o],t,o,0,e.t);t.s=0,t.clamp(),this.s!=i.s&&G.ZERO.subTo(t,t)}function l8(i){for(var t=this.abs(),e=i.t=2*t.t;--e>=0;)i[e]=0;for(e=0;e<t.t-1;++e){var r=t.am(e,t[e],i,2*e,0,1);(i[e+t.t]+=t.am(e+1,2*t[e],i,2*e+1,r,t.t-e-1))>=t.DV&&(i[e+t.t]-=t.DV,i[e+t.t+1]=1)}i.t>0&&(i[i.t-1]+=t.am(e,t[e],i,2*e,0,1)),i.s=0,i.clamp()}function c8(i,t,e){var r=i.abs();if(!(r.t<=0)){var o=this.abs();if(o.t<r.t){t!=null&&t.fromInt(0),e!=null&&this.copyTo(e);return}e==null&&(e=zt());var s=zt(),n=this.s,a=i.s,l=this.DB-gf(r[r.t-1]);l>0?(r.lShiftTo(l,s),o.lShiftTo(l,e)):(r.copyTo(s),o.copyTo(e));var c=s.t,d=s[c-1];if(d!=0){var u=d*(1<<this.F1)+(c>1?s[c-2]>>this.F2:0),m=this.FV/u,p=(1<<this.F1)/u,f=1<<this.F2,v=e.t,x=v-c,_=t==null?zt():t;for(s.dlShiftTo(x,_),e.compareTo(_)>=0&&(e[e.t++]=1,e.subTo(_,e)),G.ONE.dlShiftTo(c,_),_.subTo(s,s);s.t<c;)s[s.t++]=0;for(;--x>=0;){var D=e[--v]==d?this.DM:Math.floor(e[v]*m+(e[v-1]+f)*p);if((e[v]+=s.am(0,D,e,x,0,c))<D)for(s.dlShiftTo(x,_),e.subTo(_,e);e[v]<--D;)e.subTo(_,e)}t!=null&&(e.drShiftTo(c,t),n!=a&&G.ZERO.subTo(t,t)),e.t=c,e.clamp(),l>0&&e.rShiftTo(l,e),n<0&&G.ZERO.subTo(e,e)}}}function d8(i){var t=zt();return this.abs().divRemTo(i,null,t),this.s<0&&t.compareTo(G.ZERO)>0&&i.subTo(t,t),t}function il(i){this.m=i}function u8(i){return i.s<0||i.compareTo(this.m)>=0?i.mod(this.m):i}function m8(i){return i}function p8(i){i.divRemTo(this.m,null,i)}function h8(i,t,e){i.multiplyTo(t,e),this.reduce(e)}function f8(i,t){i.squareTo(t),this.reduce(t)}il.prototype.convert=u8;il.prototype.revert=m8;il.prototype.reduce=p8;il.prototype.mulTo=h8;il.prototype.sqrTo=f8;function g8(){if(this.t<1)return 0;var i=this[0];if((i&1)==0)return 0;var t=i&3;return t=t*(2-(i&15)*t)&15,t=t*(2-(i&255)*t)&255,t=t*(2-((i&65535)*t&65535))&65535,t=t*(2-i*t%this.DV)%this.DV,t>0?this.DV-t:-t}function rl(i){this.m=i,this.mp=i.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<i.DB-15)-1,this.mt2=2*i.t}function b8(i){var t=zt();return i.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),i.s<0&&t.compareTo(G.ZERO)>0&&this.m.subTo(t,t),t}function _8(i){var t=zt();return i.copyTo(t),this.reduce(t),t}function y8(i){for(;i.t<=this.mt2;)i[i.t++]=0;for(var t=0;t<this.m.t;++t){var e=i[t]&32767,r=e*this.mpl+((e*this.mph+(i[t]>>15)*this.mpl&this.um)<<15)&i.DM;for(e=t+this.m.t,i[e]+=this.m.am(0,r,i,t,0,this.m.t);i[e]>=i.DV;)i[e]-=i.DV,i[++e]++}i.clamp(),i.drShiftTo(this.m.t,i),i.compareTo(this.m)>=0&&i.subTo(this.m,i)}function x8(i,t){i.squareTo(t),this.reduce(t)}function v8(i,t,e){i.multiplyTo(t,e),this.reduce(e)}rl.prototype.convert=b8;rl.prototype.revert=_8;rl.prototype.reduce=y8;rl.prototype.mulTo=v8;rl.prototype.sqrTo=x8;function C8(){return(this.t>0?this[0]&1:this.s)==0}function S8(i,t){if(i>4294967295||i<1)return G.ONE;var e=zt(),r=zt(),o=t.convert(this),s=gf(i)-1;for(o.copyTo(e);--s>=0;)if(t.sqrTo(e,r),(i&1<<s)>0)t.mulTo(r,o,e);else{var n=e;e=r,r=n}return t.revert(e)}function w8(i,t){var e;return i<256||t.isEven()?e=new il(t):e=new rl(t),this.exp(i,e)}G.prototype.copyTo=Yz;G.prototype.fromInt=Kz;G.prototype.fromString=Xz;G.prototype.clamp=qz;G.prototype.dlShiftTo=i8;G.prototype.drShiftTo=r8;G.prototype.lShiftTo=o8;G.prototype.rShiftTo=s8;G.prototype.subTo=n8;G.prototype.multiplyTo=a8;G.prototype.squareTo=l8;G.prototype.divRemTo=c8;G.prototype.invDigit=g8;G.prototype.isEven=C8;G.prototype.exp=S8;G.prototype.toString=Zz;G.prototype.negate=Jz;G.prototype.abs=Qz;G.prototype.compareTo=t8;G.prototype.bitLength=e8;G.prototype.mod=d8;G.prototype.modPowInt=w8;G.ZERO=ra(0);G.ONE=ra(1);function k8(){var i=zt();return this.copyTo(i),i}function T8(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function D8(){return this.t==0?this.s:this[0]<<24>>24}function I8(){return this.t==0?this.s:this[0]<<16>>16}function E8(i){return Math.floor(Math.LN2*this.DB/Math.log(i))}function A8(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function F8(i){if(i==null&&(i=10),this.signum()==0||i<2||i>36)return"0";var t=this.chunkSize(i),e=Math.pow(i,t),r=ra(e),o=zt(),s=zt(),n="";for(this.divRemTo(r,o,s);o.signum()>0;)n=(e+s.intValue()).toString(i).substr(1)+n,o.divRemTo(r,o,s);return s.intValue().toString(i)+n}function O8(i,t){this.fromInt(0),t==null&&(t=10);for(var e=this.chunkSize(t),r=Math.pow(t,e),o=!1,s=0,n=0,a=0;a<i.length;++a){var l=PD(i,a);if(l<0){i.charAt(a)=="-"&&this.signum()==0&&(o=!0);continue}n=t*n+l,++s>=e&&(this.dMultiply(r),this.dAddOffset(n,0),s=0,n=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(n,0)),o&&G.ZERO.subTo(this,this)}function R8(i,t,e){if(typeof t=="number")if(i<2)this.fromInt(1);else for(this.fromNumber(i,e),this.testBit(i-1)||this.bitwiseTo(G.ONE.shiftLeft(i-1),Zx,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>i&&this.subTo(G.ONE.shiftLeft(i-1),this);else{var r=new Array,o=i&7;r.length=(i>>3)+1,t.nextBytes(r),o>0?r[0]&=(1<<o)-1:r[0]=0,this.fromString(r,256)}}function P8(){var i=this.t,t=new Array;t[0]=this.s;var e=this.DB-i*this.DB%8,r,o=0;if(i-- >0)for(e<this.DB&&(r=this[i]>>e)!=(this.s&this.DM)>>e&&(t[o++]=r|this.s<<this.DB-e);i>=0;)e<8?(r=(this[i]&(1<<e)-1)<<8-e,r|=this[--i]>>(e+=this.DB-8)):(r=this[i]>>(e-=8)&255,e<=0&&(e+=this.DB,--i)),(r&128)!=0&&(r|=-256),o==0&&(this.s&128)!=(r&128)&&++o,(o>0||r!=this.s)&&(t[o++]=r);return t}function B8(i){return this.compareTo(i)==0}function M8(i){return this.compareTo(i)<0?this:i}function L8(i){return this.compareTo(i)>0?this:i}function z8(i,t,e){var r,o,s=Math.min(i.t,this.t);for(r=0;r<s;++r)e[r]=t(this[r],i[r]);if(i.t<this.t){for(o=i.s&this.DM,r=s;r<this.t;++r)e[r]=t(this[r],o);e.t=this.t}else{for(o=this.s&this.DM,r=s;r<i.t;++r)e[r]=t(o,i[r]);e.t=i.t}e.s=t(this.s,i.s),e.clamp()}function U8(i,t){return i&t}function N8(i){var t=zt();return this.bitwiseTo(i,U8,t),t}function Zx(i,t){return i|t}function H8(i){var t=zt();return this.bitwiseTo(i,Zx,t),t}function BD(i,t){return i^t}function W8(i){var t=zt();return this.bitwiseTo(i,BD,t),t}function MD(i,t){return i&~t}function G8(i){var t=zt();return this.bitwiseTo(i,MD,t),t}function V8(){for(var i=zt(),t=0;t<this.t;++t)i[t]=this.DM&~this[t];return i.t=this.t,i.s=~this.s,i}function j8(i){var t=zt();return i<0?this.rShiftTo(-i,t):this.lShiftTo(i,t),t}function $8(i){var t=zt();return i<0?this.lShiftTo(-i,t):this.rShiftTo(i,t),t}function Y8(i){if(i==0)return-1;var t=0;return(i&65535)==0&&(i>>=16,t+=16),(i&255)==0&&(i>>=8,t+=8),(i&15)==0&&(i>>=4,t+=4),(i&3)==0&&(i>>=2,t+=2),(i&1)==0&&++t,t}function K8(){for(var i=0;i<this.t;++i)if(this[i]!=0)return i*this.DB+Y8(this[i]);return this.s<0?this.t*this.DB:-1}function X8(i){for(var t=0;i!=0;)i&=i-1,++t;return t}function q8(){for(var i=0,t=this.s&this.DM,e=0;e<this.t;++e)i+=X8(this[e]^t);return i}function Z8(i){var t=Math.floor(i/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<i%this.DB)!=0}function J8(i,t){var e=G.ONE.shiftLeft(i);return this.bitwiseTo(e,t,e),e}function Q8(i){return this.changeBit(i,Zx)}function t6(i){return this.changeBit(i,MD)}function e6(i){return this.changeBit(i,BD)}function i6(i,t){for(var e=0,r=0,o=Math.min(i.t,this.t);e<o;)r+=this[e]+i[e],t[e++]=r&this.DM,r>>=this.DB;if(i.t<this.t){for(r+=i.s;e<this.t;)r+=this[e],t[e++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;e<i.t;)r+=i[e],t[e++]=r&this.DM,r>>=this.DB;r+=i.s}t.s=r<0?-1:0,r>0?t[e++]=r:r<-1&&(t[e++]=this.DV+r),t.t=e,t.clamp()}function r6(i){var t=zt();return this.addTo(i,t),t}function o6(i){var t=zt();return this.subTo(i,t),t}function s6(i){var t=zt();return this.multiplyTo(i,t),t}function n6(){var i=zt();return this.squareTo(i),i}function a6(i){var t=zt();return this.divRemTo(i,t,null),t}function l6(i){var t=zt();return this.divRemTo(i,null,t),t}function c6(i){var t=zt(),e=zt();return this.divRemTo(i,t,e),new Array(t,e)}function d6(i){this[this.t]=this.am(0,i-1,this,0,0,this.t),++this.t,this.clamp()}function u6(i,t){if(i!=0){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=i;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function Zu(){}function LD(i){return i}function m6(i,t,e){i.multiplyTo(t,e)}function p6(i,t){i.squareTo(t)}Zu.prototype.convert=LD;Zu.prototype.revert=LD;Zu.prototype.mulTo=m6;Zu.prototype.sqrTo=p6;function h6(i){return this.exp(i,new Zu)}function f6(i,t,e){var r=Math.min(this.t+i.t,t);for(e.s=0,e.t=r;r>0;)e[--r]=0;var o;for(o=e.t-this.t;r<o;++r)e[r+this.t]=this.am(0,i[r],e,r,0,this.t);for(o=Math.min(i.t,t);r<o;++r)this.am(0,i[r],e,r,0,t-r);e.clamp()}function g6(i,t,e){--t;var r=e.t=this.t+i.t-t;for(e.s=0;--r>=0;)e[r]=0;for(r=Math.max(t-this.t,0);r<i.t;++r)e[this.t+r-t]=this.am(t-r,i[r],e,0,0,this.t+r-t);e.clamp(),e.drShiftTo(1,e)}function Ic(i){this.r2=zt(),this.q3=zt(),G.ONE.dlShiftTo(2*i.t,this.r2),this.mu=this.r2.divide(i),this.m=i}function b6(i){if(i.s<0||i.t>2*this.m.t)return i.mod(this.m);if(i.compareTo(this.m)<0)return i;var t=zt();return i.copyTo(t),this.reduce(t),t}function _6(i){return i}function y6(i){for(i.drShiftTo(this.m.t-1,this.r2),i.t>this.m.t+1&&(i.t=this.m.t+1,i.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);i.compareTo(this.r2)<0;)i.dAddOffset(1,this.m.t+1);for(i.subTo(this.r2,i);i.compareTo(this.m)>=0;)i.subTo(this.m,i)}function x6(i,t){i.squareTo(t),this.reduce(t)}function v6(i,t,e){i.multiplyTo(t,e),this.reduce(e)}Ic.prototype.convert=b6;Ic.prototype.revert=_6;Ic.prototype.reduce=y6;Ic.prototype.mulTo=v6;Ic.prototype.sqrTo=x6;function C6(i,t){var e=i.bitLength(),r,o=ra(1),s;if(e<=0)return o;e<18?r=1:e<48?r=3:e<144?r=4:e<768?r=5:r=6,e<8?s=new il(t):t.isEven()?s=new Ic(t):s=new rl(t);var n=new Array,a=3,l=r-1,c=(1<<r)-1;if(n[1]=s.convert(this),r>1){var d=zt();for(s.sqrTo(n[1],d);a<=c;)n[a]=zt(),s.mulTo(d,n[a-2],n[a]),a+=2}var u=i.t-1,m,p=!0,f=zt(),v;for(e=gf(i[u])-1;u>=0;){for(e>=l?m=i[u]>>e-l&c:(m=(i[u]&(1<<e+1)-1)<<l-e,u>0&&(m|=i[u-1]>>this.DB+e-l)),a=r;(m&1)==0;)m>>=1,--a;if((e-=a)<0&&(e+=this.DB,--u),p)n[m].copyTo(o),p=!1;else{for(;a>1;)s.sqrTo(o,f),s.sqrTo(f,o),a-=2;a>0?s.sqrTo(o,f):(v=o,o=f,f=v),s.mulTo(f,n[m],o)}for(;u>=0&&(i[u]&1<<e)==0;)s.sqrTo(o,f),v=o,o=f,f=v,--e<0&&(e=this.DB-1,--u)}return s.revert(o)}function S6(i){var t=this.s<0?this.negate():this.clone(),e=i.s<0?i.negate():i.clone();if(t.compareTo(e)<0){var r=t;t=e,e=r}var o=t.getLowestSetBit(),s=e.getLowestSetBit();if(s<0)return t;for(o<s&&(s=o),s>0&&(t.rShiftTo(s,t),e.rShiftTo(s,e));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),t.compareTo(e)>=0?(t.subTo(e,t),t.rShiftTo(1,t)):(e.subTo(t,e),e.rShiftTo(1,e));return s>0&&e.lShiftTo(s,e),e}function w6(i){if(i<=0)return 0;var t=this.DV%i,e=this.s<0?i-1:0;if(this.t>0)if(t==0)e=this[0]%i;else for(var r=this.t-1;r>=0;--r)e=(t*e+this[r])%i;return e}function k6(i){var t=i.isEven();if(this.isEven()&&t||i.signum()==0)return G.ZERO;for(var e=i.clone(),r=this.clone(),o=ra(1),s=ra(0),n=ra(0),a=ra(1);e.signum()!=0;){for(;e.isEven();)e.rShiftTo(1,e),t?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(i,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(i,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),t?((!n.isEven()||!a.isEven())&&(n.addTo(this,n),a.subTo(i,a)),n.rShiftTo(1,n)):a.isEven()||a.subTo(i,a),a.rShiftTo(1,a);e.compareTo(r)>=0?(e.subTo(r,e),t&&o.subTo(n,o),s.subTo(a,s)):(r.subTo(e,r),t&&n.subTo(o,n),a.subTo(s,a))}if(r.compareTo(G.ONE)!=0)return G.ZERO;if(a.compareTo(i)>=0)return a.subtract(i);if(a.signum()<0)a.addTo(i,a);else return a;return a.signum()<0?a.add(i):a}var wi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],T6=(1<<26)/wi[wi.length-1];function D6(i){var t,e=this.abs();if(e.t==1&&e[0]<=wi[wi.length-1]){for(t=0;t<wi.length;++t)if(e[0]==wi[t])return!0;return!1}if(e.isEven())return!1;for(t=1;t<wi.length;){for(var r=wi[t],o=t+1;o<wi.length&&r<T6;)r*=wi[o++];for(r=e.modInt(r);t<o;)if(r%wi[t++]==0)return!1}return e.millerRabin(i)}function I6(i){var t=this.subtract(G.ONE),e=t.getLowestSetBit();if(e<=0)return!1;var r=t.shiftRight(e);i=i+1>>1,i>wi.length&&(i=wi.length);for(var o=zt(),s=0;s<i;++s){o.fromInt(wi[Math.floor(Math.random()*wi.length)]);var n=o.modPow(r,this);if(n.compareTo(G.ONE)!=0&&n.compareTo(t)!=0){for(var a=1;a++<e&&n.compareTo(t)!=0;)if(n=n.modPowInt(2,this),n.compareTo(G.ONE)==0)return!1;if(n.compareTo(t)!=0)return!1}}return!0}G.prototype.chunkSize=E8;G.prototype.toRadix=F8;G.prototype.fromRadix=O8;G.prototype.fromNumber=R8;G.prototype.bitwiseTo=z8;G.prototype.changeBit=J8;G.prototype.addTo=i6;G.prototype.dMultiply=d6;G.prototype.dAddOffset=u6;G.prototype.multiplyLowerTo=f6;G.prototype.multiplyUpperTo=g6;G.prototype.modInt=w6;G.prototype.millerRabin=I6;G.prototype.clone=k8;G.prototype.intValue=T8;G.prototype.byteValue=D8;G.prototype.shortValue=I8;G.prototype.signum=A8;G.prototype.toByteArray=P8;G.prototype.equals=B8;G.prototype.min=M8;G.prototype.max=L8;G.prototype.and=N8;G.prototype.or=H8;G.prototype.xor=W8;G.prototype.andNot=G8;G.prototype.not=V8;G.prototype.shiftLeft=j8;G.prototype.shiftRight=$8;G.prototype.getLowestSetBit=K8;G.prototype.bitCount=q8;G.prototype.testBit=Z8;G.prototype.setBit=Q8;G.prototype.clearBit=t6;G.prototype.flipBit=e6;G.prototype.add=r6;G.prototype.subtract=o6;G.prototype.multiply=s6;G.prototype.divide=a6;G.prototype.remainder=l6;G.prototype.divideAndRemainder=c6;G.prototype.modPow=C6;G.prototype.modInverse=k6;G.prototype.pow=h6;G.prototype.gcd=S6;G.prototype.isProbablePrime=D6;G.prototype.square=n6;var zD=G;function UD(i){var t=8,e=0;function r(x,_){var D=(x&65535)+(_&65535),k=(x>>16)+(_>>16)+(D>>16);return k<<16|D&65535}function o(x,_){return x>>>_|x<<32-_}function s(x,_){return x>>>_}function n(x,_,D){return x&_^~x&D}function a(x,_,D){return x&_^x&D^_&D}function l(x){return o(x,2)^o(x,13)^o(x,22)}function c(x){return o(x,6)^o(x,11)^o(x,25)}function d(x){return o(x,7)^o(x,18)^s(x,3)}function u(x){return o(x,17)^o(x,19)^s(x,10)}function m(x,_){var D=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),k=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),A=new Array(64),B,T,F,q,Z,pt,xt,ht,ut,Yt,ri,Ve;x[_>>5]|=128<<24-_%32,x[(_+64>>9<<4)+15]=_;for(var ut=0;ut<x.length;ut+=16){B=k[0],T=k[1],F=k[2],q=k[3],Z=k[4],pt=k[5],xt=k[6],ht=k[7];for(var Yt=0;Yt<64;Yt++)Yt<16?A[Yt]=x[Yt+ut]:A[Yt]=r(r(r(u(A[Yt-2]),A[Yt-7]),d(A[Yt-15])),A[Yt-16]),ri=r(r(r(r(ht,c(Z)),n(Z,pt,xt)),D[Yt]),A[Yt]),Ve=r(l(B),a(B,T,F)),ht=xt,xt=pt,pt=Z,Z=r(q,ri),q=F,F=T,T=B,B=r(ri,Ve);k[0]=r(B,k[0]),k[1]=r(T,k[1]),k[2]=r(F,k[2]),k[3]=r(q,k[3]),k[4]=r(Z,k[4]),k[5]=r(pt,k[5]),k[6]=r(xt,k[6]),k[7]=r(ht,k[7])}return k}function p(x){for(var _=Array(),D=(1<<t)-1,k=0;k<x.length*t;k+=t)_[k>>5]|=(x.charCodeAt(k/t)&D)<<24-k%32;return _}function f(x){x=x.replace(/\r\n/g,`
`);for(var _="",D=0;D<x.length;D++){var k=x.charCodeAt(D);k<128?_+=String.fromCharCode(k):k>127&&k<2048?(_+=String.fromCharCode(k>>6|192),_+=String.fromCharCode(k&63|128)):(_+=String.fromCharCode(k>>12|224),_+=String.fromCharCode(k>>6&63|128),_+=String.fromCharCode(k&63|128))}return _}function v(x){for(var _=e?"0123456789ABCDEF":"0123456789abcdef",D="",k=0;k<x.length*4;k++)D+=_.charAt(x[k>>2]>>(3-k%4)*8+4&15)+_.charAt(x[k>>2]>>(3-k%4)*8&15);return D}return i=f(i),v(m(p(i),i.length*t))}var E6=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,A6=/^(0|[1-9]\d*)\.(0|[1-9]\d*)(\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,ol=class{get major(){return this._major}get minor(){return this._minor}get patch(){return this._patch}constructor(t,e=!1){let r=e?A6:E6,o=r.exec(t);r.lastIndex=0,this._major=o[1],this._minor=o[2],this._patch=o[3]||0}equals(t){return this._major===t._major&&this._minor===t._minor&&this._patch===t._patch}isMoreRecentThan(t){if(this._major<t.major)return!1;if(this._major>t.major)return!0;if(this._minor<t.minor)return!1;if(this._minor>t.minor)return!0;if(this._patch<=t.patch)return!1;if(this._patch>t.patch)return!0}};var li=i=>z.byteArrayToString(eo.decode(i));function F6(i){return i.map(t=>`0${(t&255).toString(16)}`.slice(-2)).join("")}var O6="TDNSeVlXTnJQMkZ3YVV0bGVUMD0=",R6="ZW50ZXJwcmlzZV9saWNlbnNl",ND="YXBwX2lkZW50aWZpZXJz",P6="cGxhdGZvcm0=",HD="ZmVhdHVyZXM=",Jx="ZXhwaXJlc19hdA==",B6="ZG9tYWlucw==",M6="YXBpX3Rva2Vu",Qx="c2lnbmF0dXJl",L6="dmVyc2lvbg==",WD=class{constructor(t){this._version="2.4",this._l=typeof t=="string"?t.trim():t,this._e=this._parseBigInt("65537",10),this._n=this._parseBigInt("681984042382424091378806337544846672160292647422517223678775230983366046720611873368204040735766698395282492937192783016867164773742859209434481353888637963692711665138989982680829529436715362566735813634679619274059040232728883894511099669775400556584329435375723951309340934658571478665059403241851229195311069345899870108307225910988692123234379186643268583453907260879685992156955936561142314233983397819356937109343127504441076920088455337597736475086676246750168976219763398350254797168313954762459542746440628077261880980924552698138857743609502132632199713575442848784271304503226045319991689413234228439044522583790713890093165912455428688507463773064216328753265963237930998706891042679105987175588970202082466871461192706070321938250462103821558100761330890228135620208935801286878657384108721268761878694436895194628411397454202904351577771506916746612289964053490210990342857409030179406810634136188751670648983222653319056818302012063874664196648868156305696644664362171542503665321455971335955948698828939948786720193132672749776162913092000667953299803216404664087988046584107737900256954976744353601826341965438148646041640662195744770544094748295945844184507459808803114917301124088082458306086473490516969815873631",10),this._parseLicense()}v(){return this._sigValid()&&!this.isExp()}_jsonValid(){try{this._decLic=JSON.parse(this._l)}catch(t){return this._decLic={},!1}return!0}_hostnameValid(){if(typeof window=="undefined"||!this._decLic[li(ND)].length)return!0;let{hostname:t}=window.location,e=!1;return this._decLic[li(ND)].forEach(r=>{z.wildCardMatch(t,r)&&(e=!0)}),e}_platformValid(){let t=this._decLic[li(P6)];return"HTML5"===t}c(){return new Promise((t,e)=>{let r=this._validateError();r!==null&&e(r),t()})}validate(){return this._validateError()===null}_validateError(){if(typeof this._l!=="string"||!this._jsonValid()){let e=new Error;return e.code="ELICINVFMT",e}if(!this._sigValid()){let e=new Error;return e.code="ELICINV",e}if(!this._hostnameValid()){let e=new Error;return e.code="ELICINVHOST",e}if(!this._platformValid()){let e=new Error;return e.code="ELICINVPLAT",e}if(this.isExp()){let e=new Error;return e.code="ELICEXP",e}return null}isToolAllowed(t){return this._includesFeature(t)}isWhiteLabel(){return this._includesFeature("whitelabel",new ol("2.4",!0))}areCustomAssetsAllowed(){return this._includesFeature("customassets",new ol("2.4",!0))}t(){if(this._decLic.enterprise_license||this._includesFeature("noexporttracking",new ol("2.4",!0)))return Promise.resolve();let t=this._decLic[li(B6)][0]+li(li(O6))+this._decLic[li(M6)];return new Bo(t).load()}isENT(){return this._decLic?this._decLic[li(R6)]:!1}_sigValid(){return this._verify(this._message,this._sig)}exp(){return!!this._decLic[li(Jx)]}dl(){return Math.ceil((this._expAt()-Date.now())/(60*60*24*1e3))}isExp(t=Date.now()){return this._decLic[li(Jx)]===null?!1:t>this._expAt()}_expAt(){return this._decLic[li(Jx)]*1e3}_verify(t,e){let r,o;return o=this._encodeMessage(t),r=this._decodeSignature(e),r=r.substr(-64),o===r}_encodeMessage(t){return UD(t)}_decodeSignature(t){let e;return t=eo.decode(t),t=F6(t),t=this._parseBigInt(t,16),e=t.modPowInt(this._e,this._n),e=e.toString(16),e}_parseBigInt(t,e){return new zD(t,e)}_parseLicense(){typeof this._l=="string"&&(!this._jsonValid()||(this._sig=this._decLic[li(Qx)]||"",delete this._decLic[li(Qx)],this._sig=this._sig.replace(/[^A-Za-z0-9+/=]/g,""),this._message=this._l.replace(new RegExp(`,"${li(Qx)}":"([^"]*)"`),"")))}_includesFeature(t,e=new ol("1.0",!0)){let r=new ol(this._decLic[li(L6)],!0);return e.isMoreRecentThan(r)?!0:this._decLic[li(HD)]&&this._decLic[li(HD)].indexOf(t)!==-1}},t0=class{v(){return!0}c(){return Promise.resolve()}isToolAllowed(t){return!0}isWhiteLabel(){return!1}areCustomAssetsAllowed(){return!0}t(){return Promise.resolve()}isENT(){return!1}exp(){return!1}dl(){return 0}isExp(t=Date.now()){return!1}},bf=WD;var sl=typeof window=="undefined"?global:window,$s=sl.requestAnimationFrame,oa=sl.cancelAnimationFrame,GD=0,_f=["ms","moz","webkit","o"];for(let i=0;i<_f.length&&!$s;++i)$s=sl[`${_f[i]}RequestAnimationFrame`],oa=sl[`${_f[i]}CancelAnimationFrame`]||sl[`${_f[i]}CancelRequestAnimationFrame`];$s&&($s=$s.bind(sl));oa&&(oa=oa.bind(sl));$s||($s=function(i,t){let e=new Date().getTime(),r=Math.max(0,16-(e-GD)),o=setTimeout(function(){i(e+r)},r);return GD=e+r,o});oa||(oa=function(i){clearTimeout(i)});var $={};ne($,{ColorMatrix:()=>Hu,CubicBezierCurve:()=>e0,Matrix:()=>Mi,Range:()=>i0,Rectangle:()=>te,Vector2:()=>et,Vector3:()=>r0});var VD=class{constructor(t=new et(0,0),e=new et(1,1),r=new et(2,-1),o=new et(2,0)){this._p0=t.clone(),this._p1=e.clone(),this._p2=r.clone(),this._p3=o.clone(),this._segments=[],this._length=-1,this._sample=[]}set(t=new et(0,0),e=new et(1,1),r=new et(2,1),o=new et(2,0)){this._p0=t.clone(),this._p1=e.clone(),this._p2=r.clone(),this._p3=o.clone()}getLength(){return this._length}calculateSegments(t=100){let e=0,r=0,o=[],s=1/t,n=this._p0.clone();for(let a=1;a<=t;a++){let l=[];l.push({t:e,s:r,point:n}),e+=s,e=Math.min(e,1);let c=this.evalAt(e);r+=c.clone().subtract(n).len(),l.push({t:e,s:r,point:c}),o.push(l),n=c}return this._segments=o,this._length=r,r}evalAt(t){t=this.normalizeParameter(t);let e=this._p0.clone().multiply((1-t)**3),r=this._p1.clone().multiply(3*(1-t)*(1-t)*t),o=this._p2.clone().multiply(3*(1-t)*t*t),s=this._p3.clone().multiply(t*t*t);return e.add(r).add(o).add(s)}isInSegment(t,e){return t=this.normalizeArcLength(t),t>=e[0].s&&t<=e[1].s}getArcLengthSegment(t){t=this.normalizeArcLength(t);for(let e=0;e<this._segments.length;e++){let r=this._segments[e];if(this.isInSegment(t,r))return r}return null}normalizeArcLength(t){return Math.max(Math.min(this._length,t),0)}normalizeParameter(t){return Math.max(Math.min(1,t),0)}getParameterForArcLength(t){let e=this.normalizeArcLength(t),r=this.getArcLengthSegment(e);if(!r)return j.warn("CubicBezierCurve#getParameterForArcLength","Segment not found."),-1;let o=(e-r[1].s)/(r[0].s-r[1].s);return o*r[0].t+(1-o)*r[1].t}evalAtArcLength(t){return this.evalAt(this.getParameterForArcLength(t))}approximateAtArcLength(t){let e=this.normalizeArcLength(t),r=this.getArcLengthSegment(e);if(!r)return-1;let o=(e-r[1].s)/(r[0].s-r[1].s);return r[0].point.clone().multiply(o).add(r[1].point.clone().multiply(1-o))}parameterSample(t=100){let e=1/t,r=[],o=0;for(let s=0;s<=t+1;s++)r.push(this.evalAt(o)),o+=e;return this._sample=r,[...r]}arcLengthApproxSample(t=100,e=!1,r=!1){let o=this._length/t,s=[],n=0;for(let a=e?1:0;a<t+1;a++)s.push(this.approximateAtArcLength(n)),n+=o;return r&&s.pop(),this._sample=s,[...s]}},e0=VD;var jD=class{constructor(t,e){this.min=t,this.max=e}getMin(){return this.min}getMax(){return this.max}getLength(){return this.max-this.min}contains(t){return this.min<=t&&t<=this.max}},i0=jD;var ki=class{constructor(t,e,r){this.x=t,this.y=e,this.z=r,typeof this.x=="undefined"&&(this.x=0),typeof this.y=="undefined"&&(this.y=0),typeof this.z=="undefined"&&(this.z=0)}set(t,e,r){return this.x=t,this.y=e,this.z=r,this}clone(){return new ki(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}clamp(t,e){let r=t!==null&&typeof t!="undefined",o=e!==null&&typeof e!="undefined";return!(t instanceof ki)&&r&&(t=new ki(t,t,t)),!(e instanceof ki)&&o&&(e=new ki(e,e,e)),r&&(this.x=Math.max(t.x,this.x),this.y=Math.max(t.y,this.y),this.z=Math.max(t.z,this.z)),o&&(this.x=Math.min(e.x,this.x),this.y=Math.min(e.y,this.y),this.z=Math.min(e.z,this.z)),this}divide(t){return t instanceof ki?(this.x/=t.x,this.y/=t.y,this.z/=t.z):(this.x/=t,this.y/=t,this.z/=t),this}subtract(t){return t instanceof ki?(this.x-=t.x,this.y-=t.y,this.z-=t.z):(this.x-=t,this.y-=t,this.z-=t),this}multiply(t){return t instanceof ki?(this.x*=t.x,this.y*=t.y,this.z*=t.z):(this.x*=t,this.y*=t,this.z*=t),this}add(t){return t instanceof ki?(this.x+=t.x,this.y+=t.y,this.z+=t.z):(this.x+=t,this.y+=t,this.z+=t),this}equals(t){return t instanceof ki?t.x===this.x&&t.y===this.y&&t.z===this.z:t===this.x&&t===this.y&&t===this.z}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}fract(){return this.x%=1,this.y%=1,this.z%=1,this}toInt(){return this.x|=0,this.y|=0,this.z|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toString(){return`Vector3({ x: ${this.x}, y: ${this.y}, z: ${this.z} })`}roundDecimal(t){return this.x=parseFloat(this.x.toFixed(t)),this.y=parseFloat(this.y.toFixed(t)),this.z=parseFloat(this.z.toFixed(t)),this}static fromObject(t){return new ki(t.x,t.y,t.z)}static get NULL(){return new ki(0,0,0)}},r0=ki;var o0=class{constructor(){this._container=new Mo;this._sprite=new Qu;this._container.addChild(this._sprite)}render(t,e,r){let o=r.getDimensions(),s=this._getNextHighestPOT(o);this._renderTexture?this._renderTexture.resizeTo(s):this._renderTexture=new qu(t,s.x,s.y);let n=this._renderTexture.getDimensions();this._sprite.setTexture(r),this._sprite.updateTransform(),this._renderTexture.clear(),this._renderTexture.render(this._container),this._updateSprite(t,e,o,n)}_updateSprite(t,e,r,o){e.setTexture(this._renderTexture),this._renderTexture.setFrame(new te(0,0,r.x,r.y))}_getNextHighestPOT(t){return new et(z.nextHighestPOT(t.x),z.nextHighestPOT(t.y))}getRenderTexture(){return this._renderTexture}dispose(){!this._renderTexture||(this._renderTexture.dispose(),delete this._renderTexture)}};var Qu=class extends Mo{constructor(t){super();this._shader=null;this._width=0;this._height=0;this._anchor=new et(0,0);this._canvasSmoothingEnabled=!0;this._smoothDownscaling=!1;this._onTextureUpdate=this._onTextureUpdate.bind(this),this.setTexture(t)}_onTextureUpdate(){this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}_renderWebGL(t){let e=t.save();this._smoothDownscaling&&(this._potRenderer||(this._potRenderer=new o0),this._texture&&this._potRenderer.render(t,this,this._texture)),t.restore(e),t.setObjectRenderer(t.renderers.sprite),t.renderers.sprite.render(this)}_renderCanvas(t){if(!this._texture)return;let e=this._worldTransform,r=this._texture.getFrame(),{width:o,height:s}=r,n=t.getCurrentRenderTarget().getPixelRatio(),a=this._anchor.x*-o|0,l=this._anchor.y*-s|0,c=t.getContext();if(c.setTransform(e.a,e.b,e.c,e.d,e.tx*n,e.ty*n),c.globalAlpha=this.getWorldAlpha(),!this._texture)return;let d=this._texture.getBaseTexture(),u=d.getPixelRatio(),m=d.getSource();c.imageSmoothingEnabled=this._canvasSmoothingEnabled,"beforeDraw"in t&&t.beforeDraw(c),c.drawImage(m,0,0,(m.naturalWidth||o)*u,(m.naturalHeight||s)*u,a*n,l*n,o*n,s*n)}isAtPosition(t){if(!this._texture)return;let e=this._worldTransform.applyInverseToVector(t),r=this._texture.getFrame(),{width:o,height:s}=r,n=new et(-o,-s);n.multiply(this._anchor);let a=n.clone().add(o,s);return!(e.x<n.x||e.x>a.x||e.y<n.y||e.y>a.y)}getLocalBounds(){if(this._localBoundsNeedUpdate&&this._texture){let t=this._localBounds,e=this._texture.getFrame();t.x=-e.width*this._anchor.x,t.y=-e.height*this._anchor.y,t.width=e.width,t.height=e.height,this._localBoundsNeedUpdate=!1}return this._localBounds.clone()}getBounds(){if(this._boundsNeedUpdate&&this._texture){let t=this._bounds,e=this._texture.getFrame(),r=this._worldTransform,o=this._anchor,s=r.rectangleToCoordinates(e,o),n=s[0].x,a=s[0].y,l=n,c=a;s.forEach(({x:d,y:u})=>{n=Math.min(n,d),a=Math.min(a,u),l=Math.max(l,d),c=Math.max(c,u)}),t.x=n,t.width=Math.abs(l-n),t.y=a,t.height=Math.abs(c-a),this._boundsNeedUpdate=!1}return this._bounds.clone()}getTexture(){return this._texture}clearTexture(t=!0){!this._texture||(this._texture.off("update",this._onTextureUpdate),t&&this._texture.dispose(),this._texture=null,this._potRenderer&&(t&&this._potRenderer.dispose(),delete this._potRenderer))}setTexture(t){!t||(this._texture&&this._texture.off("update",this._onTextureUpdate),this._potRenderer&&this._potRenderer.getRenderTexture().getBaseTexture().setDirty(!0),this._texture=t,t.getBaseTexture().isLoaded()&&this._onTextureUpdate(),t.on("update",this._onTextureUpdate))}getShader(){return this._shader}setShader(t){this._shader=t}getWidth(){return this._width}setWidth(t){!this._texture||(this._scale.x=t/this._texture.getFrame().width,this._width=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0)}getHeight(){return this._height}setHeight(t){!this._texture||(this._scale.y=t/this._texture.getFrame().height,this._height=t,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0)}getDimensions(){return new et(this._width,this._height)}getAnchor(){return this._anchor}setAnchor(t,e){this._anchor.set(t,e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}isSmoothDownscaling(){return this._smoothDownscaling}setSmoothDownscaling(t){this._smoothDownscaling=t}dispose(t=!1,e=!1){this._texture&&this._texture.off("update",this._onTextureUpdate),(t||e)&&this._texture&&this._texture.dispose(e),this._potRenderer&&this._potRenderer.dispose()}};var z6={CanvasFilterManager:el,Container:Mo,BaseTexture:Te,Texture:ea,RenderTexture:qu,WebGLRenderTarget:Vs,CanvasRenderTarget:Gs,Sprite:Qu,Filter:io,Filters:Hx,PixelArrayImage:af,autoDetectRenderer(i,t,e={}){return Qe.isSupported()?new hf(i,t,e):new kc(i,t,e)},canvasRenderer(i,t,e={}){return new kc(i,t,e)}},L=z6;var $D=class{static current(){return process.env.ENV}static isTest(){return process.env.ENV==="test"}static isDevelopment(){return process.env.ENV==="development"}static isProduction(){return process.env.ENV==="production"||!this.isTest()&&!this.isDevelopment()}},YD=$D;var KD=class{constructor(t){this._head=0,this._buf=t}peekInt8(){return this._buf[this._head]}peekInt16(t=!1){let e=this._buf[this._head],r=this._buf[this._head+1];return t?(r<<8)+e:(e<<8)+r}peekInt24(t=!1){let e=this._buf[this._head],r=this._buf[this._head+1],o=this._buf[this._head+2];return t?(o<<16)+(r<<8)+e:(e<<16)+(r<<8)+o}peekInt32(t=!1){let e=this._buf[this._head],r=this._buf[this._head+1],o=this._buf[this._head+2],s=this._buf[this._head+3];return t?(s<<32)+(o<<16)+(r<<8)+e:(e<<32)+(r<<16)+(o<<8)+s}writeInt8(t){this._buf[this._head]=t&255}writeInt16(t){this._buf[this._head]=t>>8,this._buf[this._head+1]=t&255}readInt8(){let t=this.peekInt8();return this._head+=1,t}readInt16(t=!1){let e=this.peekInt16(t);return this._head+=2,e}readInt24(t=!1){let e=this.peekInt24(t);return this._head+=3,e}readInt32(t=!1){let e=this.peekInt32(t);return this._head+=4,e}readString(t){let e="";for(let r=0;r<t;r++){let o=this.readInt8();e+=String.fromCharCode(o)}return e}getHead(){return this._head}setHead(t){this._head=t}},nl=KD;var U6={SOI:65496,SOS:65498,APP0:65504,APP1:65505,JFIF:65504,EXIF:65505},N6={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},Ec={MARKERS:U6,EXIF_TAGS:N6};var{invariant:s0}=z,{MARKERS:H6,EXIF_TAGS:XD}=Ec,qD=class{constructor(t){this._buf=t,this._stream=new nl(this._buf),this._stream.setHead(0),this._parse(),this._bigEndian=!1}isValid(){return this._stream.setHead(0),!(this._stream.readInt16()!==H6.EXIF||!(this._stream.readInt16()>0)||this._stream.readString(4)!=="Exif")}_parse(){if(!this.isValid())return;this._stream.setHead(10);let t=this._stream.getHead();this._bigEndian=!1;let e=this._stream.readInt16();e===18761?this._bigEndian=!1:e===19789?this._bigEndian=!0:s0(!1,"Invalid TIFF data: No endian type found"),s0(this._stream.readInt16(!this._bigEndian)===42,"Invalid TIFF data: No 0x002A");let r=this._stream.readInt32(!this._bigEndian);s0(r>=8,"Invalid TIFF data: First IFD offset < 8");let o=t+r,s=this._readTags(this._stream,t,o,this._bigEndian);this._tags=s.tags,this._tagData=s.tagData}getTags(){return this._tags}getTagData(){return this._tagData}setOrientation(t){if(this._tagData.Orientation){let{entryOffset:e}=this._tagData.Orientation;this._stream.setHead(e+8),this._stream.writeInt16(this._bigEndian?t:(t&255)<<8|t>>8&255)}}_readTags(t,e,r,o){t.setHead(r);let s=t.readInt16(!o),n={},a=[];for(let l=0;l<s;l++){let c=r+l*12+2;t.setHead(c);let d=t.readInt16(!o),u,m,p;if(XD[d]){d=XD[d],u=t.readInt16(!o),m=t.readInt32(!o),p=t.readInt32(!o)+e;let f=null;switch(u){case 1:case 7:if(m===1)f=t.readInt8(!o);else{f=[];for(let v=0;v<m;v++)f.push(t.readInt8(!o))}break;case 2:t.setHead(m>4?p:c+8),f=t.readString(m);break;case 3:if(t.setHead(m>2?p:c+8),m===1)f=t.readInt16(!o);else{f=[];for(let v=0;v<m;v++)f.push(t.readInt16(!o))}break;case 4:case 9:if(t.setHead(m>1?p:c+8),m===1)f=t.readInt32(!o);else{f=[];for(let v=0;v<m;v++)f.push(t.readInt32(!o))}break;case 5:case 10:if(t.setHead(p),m===1){let v=t.readInt32(!o),x=t.readInt32(!o);f=v/x}else{f=[];for(let v=0;v<m;v++){let x=t.readInt32(!o),_=t.readInt32(!o),D=x/_;f.push(D)}}break}n[d]=f,a[d]={value:f,numValues:m,entryOffset:c,valueOffset:p,type:u}}}return{tags:n,tagData:a}}getBuffer(){return this._buf}},ZD=qD;var{MARKERS:W6}=Ec,JD=class{constructor(t){this._buf=t,this._stream=new nl(this._buf),this._stream.setHead(0)}isValid(){if(this._stream.setHead(0),this._stream.readInt16()!==W6.APP0||!(this._stream.readInt16()>=16))return!1;let r=this._stream.readString(4),o=this._stream.readInt8();return!(r!=="JFIF"||o!==0)}setUnitDensity(t){this._stream.setHead(11),this._stream.writeInt8(t)}setDensityX(t){this._stream.setHead(12),this._stream.writeInt16(t)}setDensityY(t){this._stream.setHead(14),this._stream.writeInt16(t)}getUnitDensity(){return this._stream.setHead(11),this._stream.readInt8()}getDensityX(){return this._stream.setHead(12),this._stream.readInt16()}getDensityY(){return this._stream.setHead(14),this._stream.readInt16()}getBuffer(){return this._buf}},n0=JD;var{MARKERS:tm}=Ec,yf="data:image/jpeg;base64,",G6=new RegExp(`^${yf}`,"i"),zo=class{constructor(t){this._buf=t,this._stream=new nl(this._buf),this._stream.setHead(0),this._segments=this._sliceIntoSegments(this._buf),this._exifData=new ZD(this._getMarkerBuffer(tm.EXIF)),this._jfifData=new n0(this._getMarkerBuffer(tm.JFIF))}static toDataURL(t){return yf+eo.encode(t)}static fromDataURL(t){let e=t.replace(yf,"");return eo.decode(e)}restoreSegmentsInArray(t){return t=this.restoreExifTagsToImageData(t),this.restoreJfifSegmentToImageData(t)}restoreSegments(t){let e=zo.fromDataURL(t);return e=this.restoreSegmentsInArray(e),zo.toDataURL(e)}restoreExifTagsToImageData(t){if(!this._exifData.isValid())return t;let r=this._sliceIntoSegments(t)[1][0],o=t.slice(0,r),s=t.slice(r),n=o.concat(this._exifData.getBuffer());return n=n.concat(s),n}restoreJfifSegmentToImageData(t){if(!this._jfifData.isValid())return t;let e=this._sliceIntoSegments(t),r=this._findSegment(tm.JFIF,e),o=[];if(r){let s=r[0],n=r[1],a=t.slice(0,s),l=t.slice(s,n),c=t.slice(n),d=new n0(l);d.setDensityX(this._jfifData.getDensityX()),d.setDensityY(this._jfifData.getDensityY()),d.setUnitDensity(this._jfifData.getUnitDensity()),o=a.concat(l).concat(c)}else return t;return o}restoreExifTags(t){let e=zo.fromDataURL(t),r=this.restoreExifTagsToImageData(e);return zo.toDataURL(r)}restoreJfifSegment(t){if(!this._jfifData.isValid())return t;let e=zo.fromDataURL(t),r=this.restoreJfifSegmentToImageData(e);return zo.toDataURL(r)}setOrientation(t){return this._exifData.setOrientation(t)}static isJPEG(t){return G6.test(t)}static bufferIsJPEG(t){return t[0]===255&&t[1]===216&&t[2]===255}static fromBase64String(t){let e=t.replace(yf,""),r=eo.decode(e);return new zo(r)}_findSegment(t,e=this._segments){for(let r=0;r<e.length;r++){let o=e[r][0],s=e[r][1];if(this._stream.setHead(o),this._stream.peekInt16()===t)return[o,s]}return!1}_getLastSegment(t=this._segments){return t[t.length-1]}_getMarkerBuffer(t,e=this._segments){let r=this._findSegment(t,e);if(r){let o=r[0],s=r[1];return this._buf.slice(o,s)}return!1}_sliceIntoSegments(t){let e=new nl(t),r=[];for(;e.getHead()<t.length;){let o=e.readInt16();if(o!==tm.SOI){if(o===tm.SOS)break;if(o>=65280&&o<=65535){let s=e.readInt16(),n=e.getHead()+s-2;r.push([e.getHead()-4,n]),e.setHead(n)}else throw new Error(`Invalid marker: 0x${o.toString(16)}`)}}return this._stream.setHead(0),r}getTags(){return this._exifData.getTags()}getTagData(){return this._exifData.getTagData()}dispose(){this._buf=[],this._segments=[]}},em=zo;var QD;QD=window.Image;var Li=QD;var xf=class extends Ci{constructor(t=[]){super();this._onOperationUpdate=this._onOperationUpdate.bind(this),this._cacheEnabled=!0,this._stack=t,this._stack.forEach(e=>{e.on("update",this._onOperationUpdate)})}clear(){this.forEach(t=>this.remove(t)),this._stack=[]}hasChanges(){return this._stack.filter(t=>!!t).some(t=>t.hasChanges())}_onOperationUpdate(t,e){this.emit(Tc.OPERATION_UPDATED,t,e)}enableCache(){this._cacheEnabled=!0}disableCache(){this._cacheEnabled=!1}forEach(t){return this._stack.filter(e=>!!e).forEach(t)}render(t,e){let r=e,o=this._stack.filter(c=>!!c).filter(c=>c.getEnabled());o.reverse();let s=o.filter(c=>!c.isDirtyForRenderer(t.getRenderer()))[0],n=o.indexOf(s);o.reverse();let a=0;n!==-1&&(a=o.length-n-1);for(let c=0;c<a;c++)j.info(this.constructor.name,`Skipping ${o[c].constructor.name}`);let l=Promise.resolve(r);for(let c=a;c<o.length;c++){let d=o[c],u,m;l=l.then(p=>d.render(p).then(f=>(u&&f!==u&&!this._cacheEnabled&&m.disposeRenderTextures(),u=f,m=d,f)))}return l.then(c=>{let d=!o.some(u=>u.isDirtyForRenderer(t.getRenderer()));return{outputTexture:c,renderDone:d}})}validateSettings(){return Promise.all(this._stack.filter(t=>!!t).map(t=>t.validateSettings()))}setAllToDirty(t=!1){this.forEach(e=>e.setDirty(!0,t))}updateDirtinessForRenderer(t){let e=!1;for(let r=0;r<this._stack.length;r++){let o=this._stack[r];!o||(o.isDirtyForRenderer(t)&&(e=!0),e&&o.setDirtyForRenderer(!0,t))}}push(t){this._stack.push(t),t.on("update",this._onOperationUpdate)}pop(){let t=this._stack.pop();t&&(t.off("update",this._onOperationUpdate),t.dispose())}unshift(t){this._stack.unshift(t),t.on("update",this._onOperationUpdate)}clone(){return new xf(this._stack.slice(0))}get(t){return this._stack[t]}getByIdentifier(t){return z.Array.find(this._stack,e=>e&&e.constructor.identifier===t)}getIndexByIdentifier(t){return z.Array.findIndex(this._stack,e=>e&&e.constructor.identifier===t)}moveToTop(t){let e=z.Array.findIndex(this._stack,o=>o&&o.constructor.identifier===t);if(e<0||e===this._stack.length-1)return;let r=this.getByIdentifier(t);this._stack.splice(e,1),this._stack[this._stack.length]=r}set(t,e){this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),this._stack[t]=e,e.on("update",this._onOperationUpdate)}remove(t){let e=this._stack.indexOf(t);e!==-1&&(this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),this._stack.splice(e,1))}removeAt(t){this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),delete this._stack[t]}getStack(){return this._stack}dispose(){this.forEach(t=>{t.dispose()})}},vf=xf;var Ac={};ne(Ac,{ExifOrientationOperation:()=>iI});var tI=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Vu(),eI=class{constructor(t,e){this._tag=t,this._name=e,this._start=tI()}stop(){let e=tI()-this._start,r=Math.round(1e3/e);j.info(this._tag,`${this._name} took ${e.toFixed(2)}ms (${r} FPS)`)}},Cf=eI;var a0=class extends Ct{constructor(t,e={}){super(e,{enabled:{type:g.BOOLEAN,default:!0,serializable:!1}});this._sdk=t,this._cacheEnabled=!1,this._dirtiness={},this._sprite=new L.Sprite,this._container=new L.Container,this._container.addChild(this._sprite)}_onOptionsChange(){this.setDirty(!0)}render(t){if(!this.getEnabled())return j.info(this.constructor.name,"Disabled - skipping"),Promise.resolve(t);if(!this._renderTexture){let s=t.getDimensions().floor();this._renderTexture=new L.RenderTexture(this._sdk.getRenderer(),s.x,s.y)}let e=this._sdk.getRenderer(),r,o;if(j.canLog("info")&&(o=new Cf(this.constructor.name,"Rendering")),this.isDirtyForRenderer(e)){this._sprite.setTexture(t);let s=this.getNewDimensions(t.getDimensions()).floor();this._renderTexture.resizeTo(s),this._renderTexture.clear(),r=this._render(t).then((n=!1)=>(this.setDirtyForRenderer(n,e),this._renderTexture))}else j.info(this.constructor.name,"Rendering from cache"),r=Promise.resolve(this._renderTexture);return r.then(s=>(o&&o.stop(),s))}_render(t){let e;return this._sdk.getRenderer().isOfType(gt.WEBGL)?e=this._renderWebGL.bind(this):e=this._renderCanvas.bind(this),e(t)}_renderWebGL(t){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}_renderCanvas(t){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}getNewDimensions(t){return t.clone()}onBeforeExport(){this.transform&&this._tempTransformChange&&this.transform(this._tempTransformChange),this._onBeforeExport()}onAfterExport(){this.transform&&this._tempInverseTransformChange&&this.transform(this._tempInverseTransformChange),this._onAfterExport()}_onBeforeExport(){}_onAfterExport(){}setTemporaryTransformChange(t,e){this._tempTransformChange=t,this._tempInverseTransformChange=e}reset(){this._dirty=!0,this._glslPrograms={}}isDirtyForRenderer(t){let e=this._dirtiness[t.id];return typeof e=="undefined"?!0:e}setDirtyForRenderer(t,e,r=!1){this._dirtiness[e.id]=t}setDirty(t,e=!1){for(let r in this._dirtiness)this.setDirtyForRenderer(t,{id:r},e)}getSDK(){return this._sdk}getInputDimensions(t=!0){let e=this._sdk.getInputDimensions();t&&e.multiply(this._sdk.getZoom()).floor();let r;return this._sdk.getOperationsStack().forEach(o=>{if(!r){if(o===this){r=!0;return}e=o.getNewDimensions(e)}}),e.floor()}clone(){let t=this.constructor;return new t(this._sdk,this.serializeOptions())}disposeRenderTextures(){this._renderTexture&&this._renderTexture.dispose(),this._renderTexture=null}dispose(){this.disposeRenderTextures(),this._sprite.dispose()}};a0.identifier=null;var Mt=a0;var{OptionType:V6}=Pi,Sf=class extends Mt{getRotation(){let t=0;switch(this.getTags().Orientation){case 7:case 8:t=-90;break;case 3:case 4:t=-180;break;case 5:case 6:t=90;break}return t}_getFlipVertically(){let{Orientation:t}=this.getTags();return[5,7].indexOf(t)!==-1}_getFlipHorizontally(){let{Orientation:t}=this.getTags();return[2,4].indexOf(t)!==-1}_getFinalOptions(){return{rotation:this.getRotation(),flipVertically:this._getFlipVertically(),flipHorizontally:this._getFlipHorizontally()}}_render(t){let e=this._getFinalOptions(),o=e.rotation%360*(Math.PI/180);this._sprite.setScale(e.flipHorizontally?-1:1,e.flipVertically?-1:1),this._sprite.setRotation(o),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();let s=this._sprite.getBounds();return this._renderTexture.resizeTo(new et(s.width,s.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2)),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(t){let e=this._getFinalOptions();return t=t.clone(),e.rotation%180&&t.flip(),t}applyTo(t){let e=this._getFinalOptions(),r=z.createCanvas();Math.abs(e.rotation%180)===90?(r.width=t.height,r.height=t.width):(r.width=t.width,r.height=t.height);let o=r.getContext("2d"),s=e.rotation*Math.PI/180,n=.5*(r.width-t.width),a=.5*(r.height-t.height);return o.translate(n,a),o.translate(.5*t.width,.5*t.height),o.rotate(s),o.translate(-.5*t.width,-.5*t.height),e.flipVertically&&(o.translate(0,t.height),o.scale(1,-1)),e.flipHorizontally&&(o.translate(t.width,0),o.scale(-1,1)),o.drawImage(t,0,0),r}};Sf.identifier="exif-orientation";Sf.prototype.availableOptions={tags:{type:V6.OBJECT,default:{}}};var iI=Sf;var l0=class extends Ct{constructor(t,e={}){super(e);this._sdk=t}export(){let{imageFormat:t}=this._options,e=r=>r.renderDone?r:this._sdk.render().then(o=>e(o));return this.validateSettings().then(()=>this._prepareSDK().then(r=>e(r))).then(r=>{let{outputTexture:o,renderDone:s}=r,n=this._sdk.getRenderer(),a=n.getCanvas();return n.isOfType(gt.WEBGL)&&(a=this._createCanvasFromTexture(o)),this._encodeImageFormat(a)}).then(r=>this._restoreExifMetadata(r,t)).then(r=>this._restoreSDK().then(()=>r))}_restoreExifMetadata(t,e,r){if(e===qa.JPEG){let o=this._sdk.getExif();o&&typeof t=="string"&&(t=o.restoreSegments(t))}return Promise.resolve(t)}_encodeAsDataURL(t,e,r){return z.isBrowser?Promise.resolve(t.toDataURL(e,r)):new Promise((o,s)=>{t.toDataURL(e,r,(n,a)=>{n?s(n):o(a)})})}_encodeAsHTMLImage(t,e,r){return this._encodeAsDataURL(t,e,r).then(o=>{let s=new Li;return s.src=o,Promise.resolve(s)})}_encodeAsBuffer(t,e,r){return Promise.reject(new Error("Unsupported platform for RenderType"))}_encodeAsMSBlob(t,e,r){return Promise.resolve(t.msToBlob())}_encodeAsBLOB(t,e,r){return new Promise((o,s)=>{t.toBlob(n=>{o(n)},e,r)})}_encodeImageFormat(t){let{imageFormat:e,quality:r}=this._options,{renderType:o}=this._options;switch(o===lr.BLOB&&t.msToBlob&&!t.toBlob&&(o=lr.MSBLOB),o){case lr.IMAGE:return this._encodeAsHTMLImage(t,e,r);case lr.DATAURL:return this._encodeAsDataURL(t,e,r);case lr.BUFFER:return this._encodeAsBuffer(t,e,r);case lr.MSBLOB:return this._encodeAsMSBlob(t,e,r);case lr.BLOB:return this._encodeAsBLOB(t,e,r)}return Promise.reject(new Error(`Unsupported RenderType: ${o}!`))}_prepareSDK(){let t=this._sdk.getRenderer();this._sdkSettings={dimensions:t.getDimensions().clone(),textureQuality:this._sdk.getTextureQuality(),pixelRatio:this._sdk.getPixelRatio(),renderMode:this._sdk.getRenderMode()},this._sdk.setRenderMode("export"),this._sdk.setTextureQuality(1);let e=t.isOfType(gt.CANVAS);t.setPixelRatio(1),t.resizeTo(this._sdk.getFinalDimensions(),e),this._sdk.setAllOperationsToDirty(!0);let r=this._sdk.getOperationsStack();return r.forEach(o=>{o.disposeRenderTextures()}),r.disableCache(),this._sdk.render()}_restoreSDK(){this._sdk.getOperationsStack().enableCache(),this._sdk.setRenderMode(this._sdkSettings.renderMode);let e=this._sdk.getRenderer(),r=e.isOfType(gt.CANVAS);return e.setPixelRatio(this._sdkSettings.pixelRatio),e.resizeTo(this._sdkSettings.dimensions,r),this._sdk.setTextureQuality(this._sdkSettings.textureQuality),this._sdk.setAllOperationsToDirty(!0),this._sdk.render()}_createCanvasFromTexture(t){let e=this._sdk.getRenderer(),r=this._sdk.getFinalDimensions(),o=this._sdk.getRenderer().getContext(),s=o.createFramebuffer();o.bindFramebuffer(o.FRAMEBUFFER,s);let n=t.getBaseTexture().getGLTextureForRenderer(e);o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,n,0);let a=new Uint8Array(r.x*r.y*4);o.readPixels(0,0,r.x,r.y,o.RGBA,o.UNSIGNED_BYTE,a);let l=this._checkPixelsForTransparency(a),c;if(l){let p=new L.Sprite(t);p.setFilters([new L.Filters.UnpremultiplyFilter]);let f=new L.Container;f.addChild(p),c=new L.RenderTexture(e,r.x,r.y),c.render(f);let v=c.getBaseTexture().getGLTextureForRenderer(e);o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,v,0),o.readPixels(0,0,r.x,r.y,o.RGBA,o.UNSIGNED_BYTE,a),e.setRenderTarget(),c.dispose()}let d=z.createCanvas();d.width=r.x,d.height=r.y;let u=d.getContext("2d"),m=u.createImageData(r.x,r.y);return m.data.set(a),u.putImageData(m,0,0),o.deleteFramebuffer(s),d}_checkPixelsForTransparency(t){let e=this._sdk.getFinalDimensions(),r=e.x*e.y*4,o;for(let s=3;s<r;s+=4)if(o=t[s],o!==255)return!0;return!1}};l0.prototype.availableOptions={renderType:{type:g.STRING,available:z.values(lr),default:lr.IMAGE},imageFormat:{type:g.STRING,available:z.values(qa),default:qa.PNG},quality:{type:g.NUMBER,default:.8}};var rI=l0;var{Rectangle:j6,Constants:$6,Engine:Br,Utils:oI,EventEmitter:Y6,Events:c0,Vector2:d0,Log:ro,Base64:K6,Color:X6}=Ju,jt=i=>oI.byteArrayToString(K6.decode(i)),{RenderType:q6,ImageFormat:Z6,RendererType:sI}=$6,nI=class extends Y6{constructor(t,e={}){super();if(this._onOperationUpdate=this._onOperationUpdate.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.version="3.9.0",this[jt("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!0,this._preferredRenderer=t,this._options=b(b({},e),{extensions:{},renderMode:"dynamic",versionCheck:!0,displayWelcomeMessage:!0,image:null,canvas:null,transparent:!1,clearColor:X6.TRANSPARENT,textureQuality:1,zoom:1,spriteScale:1,rotation:0,smoothDownscaling:!1,smoothUpscaling:!1,crossOrigin:"anonymous",logLevel:"warn",pixelRatio:typeof window!="undefined"&&window.devicePixelRatio||1}),this._options.smoothUpscaling&&(Br.BaseTexture.DefaultMagFilter=Br.BaseTexture.LinearFilter),this._options.extensions=Object.assign(this._options.extensions,{operations:[],controls:[],languages:[]}),ro.setLevel(this._options.logLevel),this[jt("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!1,!this[jt("X29wdGlvbnM=")][jt("bGljZW5zZQ==")])this[jt("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!0,this._l=new Ju[jt("RnJlZUxpY2Vuc2VDaGVja2Vy")];else{if(!this._v())return;let o=Ju[jt("TGljZW5zZUNoZWNrZXI=")];this._l=new o(this[jt("X29wdGlvbnM=")][jt("bGljZW5zZQ==")]),this._cv(!0).then(()=>{this._ct()}).catch(s=>{ro.error(jt("TGljZW5zaW5n"),s.message)})}this._defaultRenderMode=this._options.renderMode,this._renderMode=this._options.renderMode,this._textureQuality=this._options.textureQuality,this._offset=new d0,this._zoom=this._options.zoom,this._spriteScale=this._options.spriteScale,this._rotation=this._options.rotation,this._operations={},this._operationsStack=null,this.setOperationsStack(new vf),this._container=new Br.Container,this._sprite=new Br.Sprite,this._container.addChild(this._sprite),this._inputTexture=this._options.inputTexture,this._currentInputTexture=null,this._currentTexture=null,this._resizedTexture=null,this._resizedContainer=new Br.Container,this._resizedSprite=new Br.Sprite,this._resizedContainer.addChild(this._resizedSprite),this._texturesToDispose=[],this.setSmoothDownscaling(this._options.smoothDownscaling),this._registerOperations(),this._initRenderer();let r=this._renderer.constructor.type;this._options.displayWelcomeMessage,this[jt("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]&&ro.log(jt("VGhlIFBob3RvRWRpdG9yIFNESyBpcyBhIGNvbW1lcmNpYWwgcHJvZHVjdC4gQmVmb3JlIGJlaW5nIGFibGUgdG8gdXNlIGl0IHdpdGhvdXQgbGltaXRhdGlvbnMsIHlvdSBuZWVkIHRvIHVubG9jayB0aGUgU0RLIHdpdGggYSBsaWNlbnNlIGZpbGUuIFlvdSBjYW4gb2J0YWluIGEgdGltZS1saW1pdGVkIGV2YWx1YXRpb24gbGljZW5zZSBieSBzdGFydGluZyBhIHRyaWFsIGF0IGh0dHBzOi8vd3d3LnBob3RvZWRpdG9yc2RrLmNvbS9zaWdudXAgb3IgeW91IGNhbiBwdXJjaGFzZSBhIGxpY2Vuc2UgYnkgcmVxdWVzdGluZyBhIHF1b3RlIGF0IGh0dHBzOi8vd3d3LnBob3RvZWRpdG9yc2RrLmNvbS9wcmljaW5nLgoKQmVjYXVzZSB5b3UgZGlkIG5vdCBzcGVjaWZ5IGEgbGljZW5zZSBmaWxlIHlldCwgdGhlIFNESyB3aWxsIG5vdyBkaXNwbGF5IGEgd2F0ZXJtYXJrIGltYWdlIG9uIHRvcCBvZiBhbnkgcGhvdG9zIHlvdSBkaXNwbGF5IG9yIGV4cG9ydCB3aXRoIGl0LiBGb3IgaW5zdHJ1Y3Rpb25zIGZvciBob3cgdG8gdW5sb2NrIHRoZSBTREssIHBsZWFzZSB2aXNpdCBodHRwczovL2RvY3MucGhvdG9lZGl0b3JzZGsuY29tL2d1aWRlcy9odG1sNS92NV84L2ludHJvZHVjdGlvbi9nZXR0aW5nX3N0YXJ0ZWQu")),this._options.image&&this.setImage(this._options.image,this._options.exif)}_v(){return this[jt("X29wdGlvbnM=")][jt("bGljZW5zZQ==")]?!0:(ro.error(jt("TGljZW5zaW5n"),jt("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4=")),ro.error(jt("TGljZW5zaW5n"),jt("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)}_ct(){this._l.exp()&&(this._l.isExp()?ro.error(jt("TGljZW5zaW5n"),jt("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tLg==")):ro.warn(jt("TGljZW5zaW5n"),jt("WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu").replace("%d",this._l.dl())))}_cv(t=!1){return this._l.c().catch(e=>{this[jt("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!1;let r=jt("SW52YWxpZCBsaWNlbnNlLg==");throw t&&(e.code==="ELICEXP"?r=jt("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tLg=="):e.code==="ELICINVHOST"?r=jt("VGhlIGJ1bmRsZSBpZGVudGlmaWVycyB0aGF0IHlvdSBzcGVjaWZpZWQgaW4geW91ciBsaWNlbnNlIGZpbGUgZG8gbm90IG1hdGNoIHRoZSBhcHAncyBidW5kbGUgaWRlbnRpZmllci4gUGxlYXNlIHVwZGF0ZSBhbmQgcmVkb3dubG9hZCB5b3VyIGxpY2Vuc2UgZnJvbSB5b3VyIGN1c3RvbWVyIGRhc2hib2FyZCBhdCBodHRwczovL3d3dy5waG90b2VkaXRvcnNkay5jb20vbG9naW4u"):e.code==="ELICINVPLAT"?r=jt("VGhlIGxpY2Vuc2UgdGhhdCB5b3Ugc3BlY2lmaWVkIGlzIGZvciBhbm90aGVyIHBsYXRmb3JtLiBQbGVhc2UgZG93bmxvYWQgeW91ciBsaWNlbnNlIGZvciB0aGUgd2ViIHBsYXRmb3JtIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cucGhvdG9lZGl0b3JzZGsuY29tL2xvZ2luLg=="):e.code==="ELICINVFMT"?r=jt("SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu").replace("$format",typeof this._options.license):e.code==="ELICINV"?r=jt("VGhlIHNpZ25hdHVyZSBvZiB5b3VyIGxpY2Vuc2UgaXMgbm90IHZhbGlkLiBQbGVhc2UgdHJ5IHRvIHJlZG93bmxvYWQgeW91ciBsaWNlbnNlIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cucGhvdG9lZGl0b3JzZGsuY29tL2xvZ2luLg=="):r=jt("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),e.message=r,new Error(e)})}_t(){this._l.t()}_fl(){return this[jt("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]}_onOperationUpdate(...t){this.emit(c0.OPERATION_UPDATED,...t)}_onContextRestored(){ro.warn(this.constructor.name,"Trying to re-render after WebGL context has been restored."),this.setAllOperationsToDirty(),this._operationsStack.forEach(t=>{t.disposeRenderTextures()}),this.render()}export(t=q6.DATAURL,e=Z6.PNG,r=.8){return this._cv(!0).then(()=>(this.hasChanges()&&this._t(),this._operationsStack.forEach(s=>{s.onBeforeExport()}),new rI(this,{renderType:t,imageFormat:e,quality:r}).export().then(s=>(this._operationsStack.forEach(n=>{n.onAfterExport()}),Promise.resolve(s)))))}render(t=!0){if(!this._inputTexture)throw new Error("You need to set an image before calling PhotoEditorSDK#render.");let e=this._renderer.getContext();e.startFrame&&e.startFrame();let r;ro.canLog("info")&&(r=new Cf("\u26A1\u26A1\u26A1","Frame rendering")),ro.info("\u26A1\u26A1\u26A1","Rendering starts");let o=this._operationsStack;return o.updateDirtinessForRenderer(this._renderer),this._prepareTexture().then(s=>{this._renderMode==="export"&&(s=this._inputTexture),this._currentTexture=s,this._sprite.setTexture(s),this._container.updateTransform()}).then(()=>o.validateSettings()).then(()=>((this._fl()||!this[jt("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")])&&(o.getByIdentifier("license-watermark")?o.moveToTop("license-watermark"):this.createOperation("license-watermark")),o.render(this,this._currentTexture))).then(s=>{let{outputTexture:n}=s;switch(this._currentTexture=n,this._sprite.setTexture(this._currentTexture),this._renderMode){case"dynamic":{let a=this._renderer.getDimensions().clone().divide(2).add(this._offset);this._container.setScale(this._zoom/this.getTextureScale(),this._zoom/this.getTextureScale()),this._container.setPosition(a),this._sprite.setAnchor(.5,.5),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(this._rotation);break}case"export":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(0);break;case"adapter":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(1,1),this._sprite.setRotation(0);break}return t&&this._renderer.render(this._container),s}).then(s=>(r&&r.stop(),e.endFrame&&e.endFrame(),this._disposeTextures(),s))}getTextureScale(){return Math.min(1,this._textureQuality*this._options.pixelRatio)}_prepareTexture(){return new Promise((t,e)=>{let r=this.getTextureScale();if(this._textureQuality===1)return t(this._inputTexture);let o=this.getInputDimensions().multiply(r).floor(),s;this._resizedTexture?this._resizedTexture.getDimensions().equals(o)||(this._resizedTexture.resizeTo(o),s=!0):(this._resizedTexture=new Br.RenderTexture(this._renderer,o.x,o.y),s=!0),s&&(this._resizedSprite.setScale(r,r),this._resizedSprite.setTexture(this._inputTexture),this._resizedTexture.render(this._resizedContainer)),t(this._resizedTexture)})}_registerOperations(){this._operations={};for(let t in Ac){let e=Ac[t];this._operations[e.identifier]=e}this._operations=b(b({},this._operations),this._options.extensions.operations)}registerOperations(t){t.forEach(e=>{this._operations[e.identifier]=e})}setAllOperationsToDirty(t=!1){this._operationsStack.setAllToDirty(t)}createOperation(t,e={},r=!0){let o=this._operations[t];if(!o)throw new Error(`No operation with identifier \`${t}\` found.`);let s=new o(this,e);return r&&this.addOperation(s),s}addOperation(t){this._operationsStack.push(t)}removeOperation(t){this._operationsStack.remove(t)}getInputDimensions(){let t=this._inputTexture.getFrame();return new d0(t.width,t.height)}getFinalDimensions(t=!1){let e=this.getInputDimensions();return this._operationsStack.forEach(o=>{!o.getEnabled()||(e=o.getNewDimensions(e))}),t&&e.multiply(this._spriteScale),e.floor()}getOutputDimensions(t=!1){return this.getFinalDimensions(t).clone().multiply(this._zoom).floor()}getOutputTextureDimensions(t=!1){let e=this.getTextureScale(),r=this.getInputDimensions().multiply(e).floor();return this._operationsStack.forEach(o=>{r=o.getNewDimensions(r)}),r}getCrossOrigin(){return oI.getCrossOrigin(this._options.crossOrigin||"Anonymous")}_initRenderer(){let t={canvas:this._options.canvas,pixelRatio:this._options.pixelRatio,debug:this._options.debug,transparent:this._options.transparent,clearColor:this._options.clearColor},e,r;if(this._renderMode!=="export"&&this._options.canvas){let{canvas:o}=this._options;e=o.width,r=o.height}else if(this._inputTexture){let o=this.getFinalDimensions();e=o.x,r=o.y}else e=1,r=1;switch(this._preferredRenderer){case sI.WEBGL:this._renderer=Br.autoDetectRenderer(e,r,t),this._renderer.on("context-restored",this._onContextRestored);break;case sI.CANVAS:this._renderer=Br.canvasRenderer(e,r,t),this._renderer.on("context-restored",this._onContextRestored);break;default:ro.warn("PhotoEditorSDK",`PhotoEditorSDK Error: Renderer \`${this._preferredRenderer}\` not supported. Falling back to automatically detected renderer.`),this._renderer=Br.autoDetectRenderer(e,r,t)}}resizeTo(t){this._renderer.resizeTo(t,!0)}reset(){this._operationsStack.clear()}parseExif(t){if(!t)return;let{src:e}=t,r=!1,o=null;if(r=em.isJPEG(e),o=e,r){let s=null;try{s=em.fromBase64String(o)}catch(n){}return s||void 0}}_handleExifOrientation(){let t=this._exif.getTags();if(t&&t.Orientation){let e=t.Orientation!==1&&t.Orientation!==2,r=[2,4,5,7].indexOf(t.Orientation)!==-1;if(e||r){if(typeof navigator=="undefined")this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(t);else{let o=window&&window.navigator&&window.navigator.userAgent||"";(!!o.match(/msie|trident/i)||o.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image"))&&(this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(t))}this._exif.setOrientation(1)}}}correctExifOrientation(t){let e=this.parseExif(t);if(!e)return t;let r=e.getTags();if(r&&r.Orientation){let o=r.Orientation!==1&&r.Orientation!==2,s=[2,4,5,7].indexOf(r.Orientation)!==-1;if(o||s){if(typeof navigator=="undefined"){let n=this.createOperation("exif-orientation",{},!1);n.setTags(r),t=n.applyTo(t)}else{let n=window&&window.navigator&&window.navigator.userAgent||"";if(!!n.match(/msie|trident/i)||n.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image")){let a=this.createOperation("exif-orientation",{},!1);a.setTags(r),t=a.applyTo(t)}}return e.setOrientation(1),r.Orientation=1,t}}return t}hasImage(){return this._image!==null&&typeof this._image!="undefined"}getImage(){return this._image}disposeTexture(t){this._texturesToDispose.push(t)}_disposeTextures(){for(let t=0;t<this._texturesToDispose.length;t++)this._texturesToDispose[t].dispose();this._texturesToDispose=[]}setImage(t,e=null,r=null){this._disposeTextures(),this._exifOperation&&(this.removeOperation(this._exifOperation),this._exifOperation=null),this._options.image=t,this._image=t,this._exif=e||this.parseExif(t),this._exif&&this._handleExifOrientation();let o=new Br.BaseTexture(this._image),s=new j6(0,0,this._image.naturalWidth||this._image.width,this._image.naturalHeight||this._image.height);r&&(s.width=r.x,s.height=r.y),this._resizedTexture&&this._resizedTexture.dispose(),this._resizedTexture=null,this._inputTexture&&this.disposeTexture(this._inputTexture.getBaseTexture()),this._inputTexture=new Br.Texture(o,s),this._currentTexture=this._inputTexture,this._sprite.clearTexture(!1),this._sprite.setTexture(this._inputTexture),this.emit("new-image"),this.setAllOperationsToDirty(!0)}setInputTexture(t){this._inputTexture=t}getCanvas(){return this._renderer.getCanvas()}setCanvas(t){this._renderer.setCanvas(t)}getSprite(){return this._sprite}getContainer(){return this._container}getOperationsStack(){return this._operationsStack}setOperationsStack(t){this._operationsStack&&this._operationsStack.off(c0.OPERATION_UPDATED,this._onOperationUpdate),this._operationsStack=t,this._operationsStack.on(c0.OPERATION_UPDATED,this._onOperationUpdate)}getOperations(){return this._operations}getRenderer(){return this._renderer}getOffset(){return this._offset}setOffset(t,e){t instanceof d0?this._offset.copy(t):this._offset.set(t,e)}getRenderMode(){return this._renderMode}setRenderMode(t){this._renderMode=t}getZoom(){return this._zoom}setZoom(t){this._zoom=t,this._container.setScale(this._zoom,this._zoom),this._container.updateTransform()}getTextureQuality(){return this._renderMode==="export"?1:this._textureQuality}setTextureQuality(t){t!==this._textureQuality&&this.setAllOperationsToDirty(!0),this._textureQuality=Math.min(1,t),this._textureQuality===1&&this._resizedTexture&&(this._resizedTexture.dispose(),this._resizedTexture=null)}getSpriteScale(){return this._spriteScale}setSpriteScale(t){this._spriteScale=t,this._sprite.setScale(t,t),this._sprite.updateTransform()}getPixelRatio(){return this._options.pixelRatio}getExif(){return this._exif}getOptions(){return this._options}getInputTexture(){return this._inputTexture}setSmoothDownscaling(t){this._options.smoothDownscaling=t,this._sprite.setSmoothDownscaling(t),this._resizedSprite.setSmoothDownscaling(t)}setRotation(t){this._rotation=t}getRotation(){return this._rotation}hasChanges(){return this.getOperationsStack().hasChanges()}dispose(){this._operationsStack.dispose(),this._renderer.dispose(),this._exif&&this._exif.dispose(),this._resizedTexture&&this._resizedTexture.dispose()}},ye=nI;ye.version="3.9.0";ye.Math=$;ye.Operations=Ac;ye.Engine=L;ye.Color=U;ye.LicenseChecker=bf;ye.Operation=Mt;ye.EventEmitter=Ci;ye.Utils=z;ye.Env=YD;ye.OperationsStack=vf;ye.EXIF=em;ye.Image=Li;ye.Configurable=Ct;ye.Log=j;ye.Loaders=Bx;ye.RenderType=lr;ye.ImageFormat=qa;ye.OptionType=g;ye.RendererType=gt;ye.UniformType=N;ye.Base64=eo;var J6={};ye.UI=J6;var bt=ye;var aI=`precision highp float;

varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform float u_gamma;
uniform float u_shadows;
uniform float u_highlights;
uniform float u_whites;
uniform float u_blacks;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.0000001;

float calculateLuminance(vec3 rgb) {
    // This is the luminance calculation part of the RGB to HSL formular.
    vec4 p = mix(
        vec4(rgb.gb, 0.0, -1.0 / 3.0),
        vec4(rgb.bg, -1.0, 2.0 / 3.0),
        vec4(rgb.g < rgb.b)
    );

    vec4 q = mix(
        vec4(rgb.r, p.yzx),
        vec4(p.xyw, rgb.r),
        vec4(rgb.r < p.x)
    );

    float croma = q.x - min(q.w, q.y);
    float luminance = q.x - croma * 0.5;
    return luminance;
}

vec3 map(vec3 x, float in_min, float in_max, float out_min, float out_max){
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
}

void main() {

  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha

  // Apply gamma
  if (u_gamma != 1.0) {
    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));
  }

  // Apply shadows and highlights
  float luminance = calculateLuminance(color.rgb);

  float shadow = u_shadows >= 0.0
    ? clamp(
          pow(luminance, 1.0 / (u_shadows + 1.0))
          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(u_shadows, 1.0))
    : -clamp(
          pow(luminance, 1.0 / (-u_shadows + 1.0))
          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(-u_shadows, 1.0));

  float highlight = u_highlights < 0.0
    ? clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0)
    : -clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0);

  // Bright color need more contrast and dark color need more brightness.
  // This is to keep saturatation because the color information of a dark colors is lost.
  float shadowContrast   = shadow * luminance * luminance;
  float shadowBrightness = shadow - shadowContrast;

  float offset = luminance + shadowContrast + highlight;
  color.rgb = clamp(offset * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);
  
  // Apply Color Matrix
  color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;
  color.rgb = map(color.rgb, 0.0, 1.0, u_blacks / 2.0, 1.0 + u_whites / 2.0);
  color = clamp(color, 0.0, 1.0);
  color.rgb *= color.a; // Reset premultiplied alpha

  gl_FragColor = color;
}
`;var{ColorMatrix:Q6}=$,Fc=1e-7;function u0(i,t,e,r,o){return(i-t)*(o-r)/(e-t)+r}var t9=i=>{let t=Math.max(i.r,i.g,i.b),e=Math.min(i.r,i.g,i.b);return(t+e)/2},m0=class extends L.Filter{constructor(){super();this._fragmentSource=aI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{colorMatrix:c,gamma:d,shadows:u,highlights:m,whites:p,blacks:f}=this._options,v=d!==1,x=u!==0||m!==0,_=new U(0,0,0,0);for(let D=0;D<s.width*s.height;D++){let k=D*4;if(_.r=l.data[k]/255,_.g=l.data[k+1]/255,_.b=l.data[k+2]/255,v&&(_.r=Math.pow(_.r,1/Math.max(d,Fc)),_.g=Math.pow(_.g,1/Math.max(d,Fc)),_.b=Math.pow(_.b,1/Math.max(d,Fc))),x){let A=t9(_),B=u>=0?z.clamp(Math.pow(A,1/(u+1))+Math.pow(A,2/(u+1))*-.76-A,0,Math.max(u,1)):-z.clamp(Math.pow(A,1/(-u+1))+Math.pow(A,2/(-u+1))*-.76-A,0,Math.max(-u,1)),T=m<0?z.clamp(1-Math.pow(1-A,1/(1-m))-Math.pow(1-A,2/(1-m))*-.8-A,-1,0):-z.clamp(1-Math.pow(1-A,1/(1+m))-Math.pow(1-A,2/(1+m))*-.8-A,-1,0),F=B*A*A,q=B-F,Z=A+F+T;_.r=z.clamp(Z*((_.r+q)/Math.max(A,Fc)),0,1),_.g=z.clamp(Z*((_.g+q)/Math.max(A,Fc)),0,1),_.b=z.clamp(Z*((_.b+q)/Math.max(A,Fc)),0,1)}_=c.apply(_).clamp(0,1),_.r=u0(_.r,0,1,f/2,1+p/2),_.g=u0(_.g,0,1,f/2,1+p/2),_.b=u0(_.b,0,1,f/2,1+p/2),l.data[k]=_.r*255,l.data[k+1]=_.g*255,l.data[k+2]=_.b*255}a.putImageData(l,0,0)}};m0.prototype.availableOptions={gamma:{type:g.NUMBER,default:1,uniformType:N.FLOAT},shadows:{type:g.NUMBER,default:0,uniformType:N.FLOAT},highlights:{type:g.NUMBER,default:1,uniformType:N.FLOAT},whites:{type:g.NUMBER,default:0,uniformType:N.FLOAT},blacks:{type:g.NUMBER,default:0,uniformType:N.FLOAT},colorMatrix:{type:g.COLOR_MATRIX,default:new Q6,uniformType:N.MAT4},colorOffset:{type:g.ARRAY,default:[],uniformType:N.FLOAT4}};var wf=m0;var lI=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)
uniform vec2 u_pixelDimension;

// Range (-1.0 - 1.0)
uniform float u_clarity;

varying vec2 v_texCoord;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.000001;

vec4 unpremultiply(vec4 col) {
    col.rgb /= max(col.a, EPSILON);
    return col;
}

void main() {
    vec4 color = texture2D(u_image, v_texCoord);
    color = unpremultiply(color);

    // L = Left, R = Right, C = Center, T = Top, B = Bottom
    vec4 colLB = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colLC = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));
    vec4 colLT = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));

    vec4 colCL = texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));
    vec4 colCR = texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));
    
    vec4 colRB = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colRC = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));
    vec4 colRT = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));

    vec4 mergedColor = color;
    mergedColor.rgb += unpremultiply(colLB).rgb + unpremultiply(colLC).rgb + unpremultiply(colLT).rgb;
    mergedColor.rgb += unpremultiply(colCL).rgb + unpremultiply(colCR).rgb;
    mergedColor.rgb += unpremultiply(colRB).rgb + unpremultiply(colRC).rgb + unpremultiply(colRT).rgb;

    mergedColor /= 9.0;

    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);
    // 1.0 and 0.0 result in white not black, therefore we clamp

    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,
    // and for values between 0.1 and 0.2 it will produce a gradient.
    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.
    // And values above 0.9 will be mapped to 0.
    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));

    // here we apply the high pass filter. Its strength is determined by the uniform ,
    // and the frequence factor. That means the only the mid tones are affected by this filter.
    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.
    // Therefore we see this little magic number '3.7'.
    color.rgb = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0).rgb;

    // apply exposure but only to the mid tones.
    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);

    // apply contrast and desaturation matrix
    color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;

    color.rgb *= color.a; // Premultiply alpha

    gl_FragColor = clamp(color, 0.0, 1.0);
}
`;var{Vector2:e9,ColorMatrix:i9}=$,p0=class extends L.Filter{constructor(){super();this._fragmentSource=lI}_applyCanvas(t,e,r,o=!1){let s=r.getContext(),n=e.getCanvas(),a=e.getContext(),{clarity:l}=this._options,{colorMatrix:c}=this._options,d=new U(this._options.colorOffset[0],this._options.colorOffset[1],this._options.colorOffset[2],this._options.colorOffset[3]),{width:u}=n,{height:m}=n,p=a.getImageData(0,0,u,m),f=s.createImageData(u,m);this.canvasShader(p,f,l,c,d),s.putImageData(f,0,0)}canvasShader(t,e,r,o,s){let n=(_,D,k)=>Math.min(Math.max(_,D),k),a=(_,D,k)=>{let A=n((k-_)/(D-_),0,1);return A*A*(3-2*A)},l=t.width*4,{length:c}=t.data,d=c-1,u=0,m=t.data,p=e.data,f=new U,v=255*9,x=_=>(_=_<u?u:_,_=_>d?d:_,m[_]);for(let _=0;_<c;_+=4){let D=x(_+0),k=x(_+1),A=x(_+2),B=x(_+3),T=(D+x(_-4-l+0)+x(_-4+0)+x(_-4+l+0)+x(_-l+0)+x(_+l+0)+x(_+4-l+0)+x(_+4+0)+x(_+4+l))/v,F=(k+x(_-4-l+1)+x(_-4+1)+x(_-4+l+1)+x(_-l+1)+x(_+l+1)+x(_+4-l+1)+x(_+4+1)+x(_+4+l+1))/v,q=(A+x(_-4-l+2)+x(_-4+2)+x(_-4+l+2)+x(_-l+2)+x(_+l+2)+x(_+4-l+2)+x(_+4+2)+x(_+4+l+2))/v,Z=(B+x(_-4-l+3)+x(_-4+3)+x(_-4+l+3)+x(_-l+3)+x(_+l+3)+x(_+4-l+3)+x(_+4+3)+x(_+4+l+3))/v;D/=255,k/=255,A/=255,B/=255;let pt=n(D*.3+k*.59+A*.1,.111111,.999999),xt=Math.min(a(1-pt,0,.11),a(pt,0,.11)),ht=r*3.7*xt,ut=Math.pow(2,r*.27*xt),Yt=n(D+n((D-T)*ht,0,10),0,1)*ut,ri=n(k+n((k-F)*ht,0,10),0,1)*ut,Ve=n(A+n((A-q)*ht,0,10),0,1)*ut,Sr=n(B+n((B-Z)*ht,0,10),0,1);f.set(Yt,ri,Ve,Sr);let wt=o.apply(f).clamp(0,1);p[_+0]=wt.r*255,p[_+1]=wt.g*255,p[_+2]=wt.b*255,p[_+3]=wt.a*255}}};p0.prototype.availableOptions={clarity:{type:g.NUMBER,default:0,uniformType:N.FLOAT},pixelDimension:{type:g.VECTOR2,default:new e9(100,100),uniformType:N.FLOAT2},colorMatrix:{type:g.COLOR_MATRIX,default:new i9,uniformType:N.MAT4},colorOffset:{type:g.ARRAY,default:[],uniformType:N.FLOAT4}};var cI=p0;var dI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec2 u_pixelDimension;
uniform float u_sharpness;
 
const float EPSILON = 0.000001;
 
void main() {
    vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);

    float factor        = mix(0.2, -1.0, float(u_sharpness > 0.0));
    vec4 sharpenedColor = mix(0.2,  5.0, float(u_sharpness > 0.0)) * color;
 
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2(-1.0,  0.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0, -1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0,  1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 1.0,  0.0)), 0.0, 1.0);
 
    color.rgb /= max(color.a, EPSILON); // unpremultiply
    sharpenedColor.rgb /= max(sharpenedColor.a, EPSILON); // unpremultiply
 
    sharpenedColor = clamp(sharpenedColor, 0.0, 1.0);
 
    color = clamp(mix(color, sharpenedColor, abs(u_sharpness)), 0.0, 1.0);
      
    gl_FragColor = vec4(color.rgb * color.a, color.a); // premultiply
}`;var{Vector2:r9}=$,h0=class extends L.Filter{constructor(){super();this._fragmentSource=dI}_applyCanvas(t,e,r,o=!1){let s=r.getContext(),n=e.getCanvas(),a=e.getContext(),{sharpness:l}=this._options,{width:c}=n,{height:d}=n,u=a.getImageData(0,0,c,d),m=s.createImageData(c,d);this.canvasShader(u,m,l),s.putImageData(m,0,0)}canvasShader(t,e,r){let o=(A,B,T)=>Math.min(Math.max(A,B),T),s=1e-6,{width:n}=t,{height:a}=t,l=t.data,c=e.data,d=(A,B,T)=>A*(1-T)+B*T,u=A=>o(l[A]/255,0,1),m=(A,B)=>{let T=o(A,0,n-1),F=o(B,0,a-1);return 4*(T+n*F)},p=[],f=[],v=[-1,0,0,1],x=[0,-1,1,0],_=r>0?-1:.2,D=r>0?5:.2,k=Math.abs(r);for(let A=0;A<n;A++)for(let B=0;B<a;B++){let T=m(A,B);p[0]=u(T+0),p[1]=u(T+1),p[2]=u(T+2),p[3]=u(T+3),f[0]=D*p[0]*p[3],f[1]=D*p[1]*p[3],f[2]=D*p[2]*p[3],f[3]=D*p[3];for(let F=0;F<4;F++){let q=v[F],Z=x[F],pt=m(A+q,B+Z),xt=u(pt+3);f[3]+=_*xt;for(let ht=0;ht<3;ht++)f[ht]+=_*u(pt+ht)*xt}for(let F=0;F<3;F++)f[F]/=Math.max(f[3],s),f[F]=o(f[F],0,1);f[3]=o(f[3],0,1);for(let F=0;F<4;F++)p[F]=o(d(p[F],f[F],k),0,1),c[T+F]=p[F]*255}}};h0.prototype.availableOptions={sharpness:{type:g.NUMBER,default:0,uniformType:N.FLOAT},pixelDimension:{type:g.VECTOR2,default:new r9(100,100),uniformType:N.FLOAT2}};var uI=h0;var mI=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Range (-1.0 - 1.0)
uniform float u_temperature;

const lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);

const mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);
const mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);

const float EPSILON = 0.0000001;

varying vec2 v_texCoord;
void main() {
  float temperature = u_temperature;
  const float tint = 0.0;
  vec4 source = texture2D(u_image, v_texCoord);

  source.rgb /= max(source.a, EPSILON);   // Revert premultiplied alpha

  vec3 yiq = RGBtoYIQ * source.rgb;
  yiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);
  vec3 rgb = YIQtoRGB * yiq;

  vec3 processed = mix(
    (1.0 - 2.0 * (1.0 - rgb) * (1.0 - warmFilter)),
    (2.0 * rgb * warmFilter),
    vec3(rgb.r < 0.5, rgb.g < 0.5, rgb.b < 0.5)
  );

  vec4 color = vec4(mix(rgb, processed, temperature), source.a);

  color.rgb *= color.a;   // Premultiply alpha again

  gl_FragColor = color;
}
`;var f0=class extends L.Filter{constructor(){super();this._fragmentSource=mI}_applyCanvas(t,e,r,o=!1){let s=r.getContext(),n=e.getCanvas(),a=e.getContext(),{temperature:l}=this._options,{width:c}=n,{height:d}=n,u=a.getImageData(0,0,c,d),m=s.createImageData(c,d);this.canvasShader(u,m,l),s.putImageData(m,0,0)}canvasShader(t,e,r){let o=(_,D,k)=>Math.min(Math.max(_,D),k),s=(_,D,k)=>_*(1-k)+D*k,n=(_,D)=>{let k=_[0]*D[0]+_[3]*D[1]+_[6]*D[2],A=_[1]*D[0]+_[4]*D[1]+_[7]*D[2],B=_[2]*D[0]+_[5]*D[1]+_[8]*D[2];return[k,A,B]},{length:a}=t.data,l=a-1,c=0,d=t.data,u=e.data,m=_=>(_=_<c?c:_,_=_>l?l:_,d[_]),p=[.93,.54,0],f=[.299,.587,.114,.596,-.274,-.322,.212,-.523,.311],v=[1,.956,.621,1,-.272,-.647,1,-1.105,1.702],x=0;for(let _=0;_<a;_+=4){let D=m(_+0)/255,k=m(_+1)/255,A=m(_+2)/255,B=m(_+3)/255,F=n(f,[D,k,A]);F.z=o(F.z+x*.5226*.1,-.5226,.5226);let q=n(v,F),Z=[q[0]<.5?2*q[0]*p[0]:1-2*(1-q[0])*(1-p[0]),q[1]<.5?2*q[1]*p[1]:1-2*(1-q[1])*(1-p[1]),q[2]<.5?2*q[2]*p[2]:1-2*(1-q[2])*(1-p[2])];u[_+0]=s(q[0],Z[0],r)*255,u[_+1]=s(q[1],Z[1],r)*255,u[_+2]=s(q[2],Z[2],r)*255,u[_+3]=B*255}}};f0.prototype.availableOptions={temperature:{type:g.NUMBER,default:0,uniformType:N.FLOAT}};var pI=f0;var{ColorMatrix:sa}=$,im=class extends Mt{constructor(...t){super(...t);this._clarityFilter=new cI,this._temperatureFilter=new pI,this._sharpnessFilter=new uI,this._filter=new wf,this._sprite.setFilters([this._clarityFilter,this._temperatureFilter,this._filter])}_render(t){let e=t.getDimensions();e.x=1/e.x,e.y=1/e.y;let r=new sa;r.multiply(sa.createSaturationMatrix(-.3*this._options.clarity+1)),r.multiply(sa.createContrastMatrix(.1*this._options.clarity+1)),this._clarityFilter.set({clarity:this._options.clarity,pixelDimension:e,colorMatrix:r,colorOffset:r.getOffsets()}),this._temperatureFilter.set({temperature:this._options.temperature}),this._sharpnessFilter.set({sharpness:this._options.sharpness,pixelDimension:e});let o=new sa;o.multiply(sa.createExposureMatrix(this._options.exposure)),o.multiply(sa.createSaturationMatrix(this._options.saturation+1)),o.multiply(sa.createContrastMatrix((this._options.contrast>0?this._options.contrast*2:this._options.contrast)+1)),o.multiply(sa.createBrightnessMatrix(this._options.brightness)),this._filter.set({gamma:this._options.gamma,shadows:this._options.shadows,highlights:this._options.highlights,whites:this._options.whites,blacks:this._options.blacks,colorMatrix:o,colorOffset:o.getOffsets()});let s=[];return this._options.clarity!==0&&s.push(this._clarityFilter),this._options.sharpness!==0&&s.push(this._sharpnessFilter),this._options.temperature!==0&&s.push(this._temperatureFilter),s.push(this._filter),this._sprite.setFilters(s),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._clarityFilter.dispose(),this._temperatureFilter.dispose(),this._sharpnessFilter.dispose()}};im.identifier="adjustments";im.prototype.availableOptions={brightness:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},saturation:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},contrast:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},gamma:{type:g.NUMBER,default:1,minValue:.5,midValue:1,maxValue:2},exposure:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},shadows:{type:g.NUMBER,default:0,minValue:-2,midValue:0,maxValue:2},highlights:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},clarity:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},whites:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},blacks:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},temperature:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},sharpness:{type:g.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1}};bt.Operations.AdjustmentsOperation=im;var hI=im;var fI=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);
    float radius = u_blurRadius;

    const float steps = 30.0;

    for (float t = -steps; t <= steps; t++) {
        float percent = (t + offset - 0.5) / steps;
        float weight = 1.0 - abs(percent);

        // Somehow \`sample\` is a keyword in headless-gl
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`;var{Vector2:kf}=$,g0=class extends L.Filter{constructor(...t){super(...t);this._fragmentSource=fI,this._lastBlurRadius=null,this._lastDimensions=new kf(0,0),this._blurredRenderTarget=new L.CanvasRenderTarget(100,100,1)}_applyCanvas(t,e,r,o=!1,s=null){if(this._options.blurQuality==="low"){this._renderLQBlur(t,e,r,o);return}let n=e.getCanvas(),a=e.getContext(),l=r.getContext();this._lastBlurRadius===this._options.blurRadius&&l.drawImage(n,0,0);let c=a.getImageData(0,0,n.width,n.height),d=l.getImageData(0,0,n.width,n.height),u=this._options.blurRadius,{delta:m}=this._options,p=30;for(let f=0;f<n.width;f++)for(let v=0;v<n.height;v++){let _=(f+v*n.width)*4,D=0,k=0,A=0,B=0,T=0;s&&(u=s(f/n.width,v/n.height));let F=this._random(f,1-v/n.height);for(let q=-p;q<=p;q++){let Z=(q+F-.5)/p,pt=1-Math.abs(Z),xt=m.x*Z*u,ht=m.y*Z*u,ut=Math.max(Math.min(f+xt,n.width-1),0),Yt=Math.max(Math.min(v+ht,n.height-1),0),ri=(Math.round(Yt)*n.width+Math.round(ut))*4,Ve=c.data[ri+3],Sr=Ve*c.data[ri],wt=Ve*c.data[ri+1],ce=Ve*c.data[ri+2];D+=Sr*pt,k+=wt*pt,A+=ce*pt,B+=Ve*pt,T+=pt}D/=T,k/=T,A/=T,B/=T,d.data[_]=D/B,d.data[_+1]=k/B,d.data[_+2]=A/B,d.data[_+3]=B}l.putImageData(d,0,0),this._lastDimensions.copy(new kf(n.width,n.height))}_renderLQBlur(t,e,r,o){let s=e.getDimensions(),n=!this._lastDimensions.equals(s);this._blurredRenderTarget.setPixelRatio(e.getPixelRatio()),this._blurredRenderTarget.resizeTo(e.getDimensions()),r.setPixelRatio(e.getPixelRatio()),r.resizeTo(e.getDimensions()),(this._lastBlurRadius!==this._options.blurRadius||n)&&(this._blurImage(e,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),r.getContext().drawImage(this._blurredRenderTarget.getCanvas(),0,0),this._lastDimensions.copy(s)}_random(t,e){let r=12.9898,o=78.233,s=43758.5453,n=t*r+e*o,a=n-3.14*Math.floor(n/3.14),l=Math.sin(a)*s;return l-Math.floor(l)}};g0.prototype.availableOptions={blurRadius:{type:g.NUMBER,default:30,uniformType:N.FLOAT},delta:{type:g.VECTOR2,default:new kf(1,1),uniformType:N.FLOAT2},texSize:{type:g.VECTOR2,default:new kf(100,100),uniformType:N.FLOAT2},blurQuality:{type:g.STRING,default:"low"}};var zi=g0;var{Vector2:gI}=$,rm=class extends Mt{constructor(...t){super(...t);this._lastBlurRadius=this._options.blurRadius;let e={blurQuality:{type:g.STRING}};this._horizontalFilter=new zi({},e),this._verticalFilter=new zi({},e),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new gI(.5,.5)),this._verticalFilter.setDelta(new gI(-.5,.5)),this._filter=new zi({},e)}_renderWebGL(t){return this._renderBlur(t)}_renderCanvas(t){return this._options.highQualityCanvasBlur?this._renderBlur(t):this._renderLQCanvasBlur(t)}_renderBlur(t){let e=t.getDimensions(),r=e.min(),{blurRadius:o}=this._options,s={blurRadius:o*r,texSize:e,blurQuality:"high"};return this._horizontalFilter.set(s),this._verticalFilter.set(s),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(t){let{blurRadius:e}=this._options,r=t.getDimensions();return this._filter.set({blurRadius:e,texSize:r,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}transform(t){let e=this.getBlurRadius(),r=t.applyToRelativeSize(e);this.set({blurRadius:r},!1)}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};rm.identifier="blur";rm.prototype.availableOptions={blurRadius:{type:g.NUMBER,default:.025},highQualityCanvasBlur:{type:g.BOOLEAN,default:!1}};bt.Operations.BlurOperation=rm;var bI=rm;var dv={};ne(dv,{A15Filter:()=>YI,BWFilter:()=>XI,BWHardFilter:()=>qI,BreezeFilter:()=>KI,CelsiusFilter:()=>ZI,ChestFilter:()=>JI,DuoToneFilter:()=>QI,FixieFilter:()=>tE,FoodFilter:()=>eE,FridgeFilter:()=>iE,FrontFilter:()=>rE,GlamFilter:()=>oE,GobblinFilter:()=>sE,IdentityFilter:()=>$f,K1Filter:()=>nE,K2Filter:()=>aE,K6Filter:()=>lE,KDynamicFilter:()=>cE,LUTFilter:()=>SE,LeninFilter:()=>dE,LomoFilter:()=>uE,MellowFilter:()=>mE,MetalFilter:()=>pE,MorningFilter:()=>hE,OrchidFilter:()=>fE,Pola669Filter:()=>bE,PolaFilter:()=>gE,QuoziFilter:()=>_E,SemiredFilter:()=>yE,SunnyFilter:()=>xE,TexasFilter:()=>vE,ThreeDLUTFilter:()=>wE,X400Filter:()=>CE});var _I=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filteredImage;
uniform float u_intensity;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filteredImage, v_texCoord);
  gl_FragColor = mix(color0, color1, u_intensity);
}
`;var b0=class extends L.Filter{constructor(){super();this._fragmentSource=_I}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=r.getContext(),{filteredCanvas:a}=this._options;n.save(),n.globalAlpha=1-this._options.intensity,n.drawImage(s,0,0),n.globalAlpha=this._options.intensity,n.drawImage(a,0,0),n.restore()}};b0.prototype.availableOptions={filteredImage:{type:g.NUMBER,default:1,uniformType:N.INT},filteredCanvas:{type:g.OBJECT,default:null},intensity:{type:g.NUMBER,default:1,uniformType:N.FLOAT}};var yI=class{constructor(t=1){this._intensity=t,this._stack=[],this._dirtiness={},this._renderTextures={},this._container=new L.Container,this._sprite=new L.Sprite,this._container.addChild(this._sprite),this._blendFilter=new b0}push(t){this._stack.push(t)}clear(){this._stack=[]}render(t,e,r){if(this.isEmpty())return Promise.resolve();let o=t.getRenderer();this._sprite.setTexture(e);let s=this._renderTextures[o.id];if(!s){let l=t.getSprite().getTexture().getFrame();s=new L.RenderTexture(t.getRenderer(),l.width,l.height),this._renderTextures[o.id]=s}let n=r.getDimensions();s.resizeTo(n);let a=this.isDirtyForRenderer(o);if(a){this._stack.forEach(c=>{c.update(t)});let l=this._stack.map(c=>c.getFilter());this._sprite.setFilters(l),s.render(this._container),this.setDirtyForRenderer(!1,o)}if(this._blendFilter.setIntensity(this._intensity),o.isOfType(gt.CANVAS))this._blendFilter.setFilteredCanvas(s.getRenderTarget().getCanvas());else if(o.isOfType(gt.WEBGL)){let l=s.getBaseTexture();l.setGLUnit(this._blendFilter.getFilteredImage()),o.updateTexture(l,!1)}return this._sprite.setFilters([this._blendFilter]),r.clear(U.TRANSPARENT),r.render(this._container),a&&this.disposeRenderTextures(),Promise.resolve()}setIntensity(t){this._intensity=t}isEmpty(){return this._stack.length===0}isDirtyForRenderer(t){return t.id in this._dirtiness||(this._dirtiness[t.id]=!0),this._dirtiness[t.id]}setDirtyForRenderer(t,e){this._dirtiness[e.id]=t}setDirty(t){for(let e in this._dirtiness)this._dirtiness[e]=t}disposeRenderTextures(){for(let t in this._renderTextures)this._renderTextures[t].dispose(),delete this._renderTextures[t]}dispose(){this.disposeRenderTextures(),this._stack.forEach(t=>t.dispose()),this._stack=[],this._blendFilter.dispose(),this._sprite.dispose()}},_0=yI;var Oc=class extends Ct{constructor(t={},e={}){super(t,b({intensity:{type:g.NUMBER,default:1,setter(r){return this._stack&&this._stack.setIntensity(r),r}},dirty:{type:g.BOOLEAN,default:!0}},e));this._stack=new _0(this._options.intensity)}render(t,e,r){return this._stack.render(t,e,r).then(o=>(this.setDirty(!1),o))}setDirtyForRenderer(t,e){this._stack.setDirtyForRenderer(t,e)}disposeRenderTextures(){this._stack.disposeRenderTextures()}dispose(){this._stack.dispose()}};Oc.identifier=null;Oc.isIdentity=!1;Oc.displayName=null;Oc.PrimitivesStack=_0;var nt=Oc;var P0={};ne(P0,{Brightness:()=>al,ColorMatrixPrimitive:()=>Ef,Contrast:()=>Ui,Desaturation:()=>Uo,DuoTone:()=>Of,Gamma:()=>Pf,Glow:()=>Rc,Gobblin:()=>Mf,Grayscale:()=>Pc,LookupTable:()=>Lf,LookupTableImage:()=>zf,Saturation:()=>Ni,SoftColorOverlay:()=>Hf,ThreeDLookupTableImage:()=>Vf,ToneCurve:()=>Dt,X400:()=>Wf});var xI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_brightness;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;
}
`;var vI=class extends Ct{update(){}getFilter(){return this._filter}dispose(){this._filter&&(this._filter.dispose(),this._filter=null)}},Jt=vI;var Tf=class extends L.Filter{constructor(){super();this._fragmentSource=xI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{brightness:c}=this._options;if(c===0){a.putImageData(l,0,0);return}c*=255;for(let d=0;d<s.width*s.height;d++){let u=d*4;l.data[u]+=c,l.data[u+1]+=c,l.data[u+2]+=c}a.putImageData(l,0,0)}};Tf.prototype.availableOptions={brightness:{type:g.NUMBER,default:0,uniformType:N.FLOAT}};var y0=class extends Jt{constructor(...t){super(...t);this._filter=new Tf}update(){this._filter.setBrightness(this._options.brightness)}};y0.prototype.availableOptions=Tf.prototype.availableOptions;var al=y0;var CI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_contrast;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);
}
`;var Df=class extends L.Filter{constructor(){super();this._fragmentSource=CI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{contrast:c}=this._options;if(c!==1){for(let d=0;d<s.width*s.height;d++){let u=d*4;l.data[u]=(l.data[u]-127)*c+127,l.data[u+1]=(l.data[u+1]-127)*c+127,l.data[u+2]=(l.data[u+2]-127)*c+127}a.putImageData(l,0,0)}}};Df.prototype.availableOptions={contrast:{type:g.NUMBER,default:1,uniformType:N.FLOAT}};var x0=class extends Jt{constructor(...t){super(...t);this._filter=new Df}update(){this._filter.setContrast(this._options.contrast)}};x0.prototype.availableOptions=Df.prototype.availableOptions;var Ui=x0;var SI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform mat4 u_colorMatrix;
uniform vec4 u_colorMatrixOffset;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;
}
`;var{ColorMatrix:o9}=$,If=class extends L.Filter{constructor(){super();this._fragmentSource=SI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{colorMatrix:c}=this._options,d=new U(0,0,0,0);for(let u=0;u<s.width*s.height;u++){let m=u*4;d.r=l.data[m]/255,d.g=l.data[m+1]/255,d.b=l.data[m+2]/255,d=c.apply(d),l.data[m]=d.r*255,l.data[m+1]=d.g*255,l.data[m+2]=d.b*255}a.putImageData(l,0,0)}};If.prototype.availableOptions={colorMatrix:{type:g.COLOR_MATRIX,default:new o9,uniformType:N.MAT4},colorMatrixOffset:{type:g.ARRAY,default:[],uniformType:N.FLOAT4}};var v0=class extends Jt{constructor(...t){super(...t);this._filter=new If}update(){this._filter.setColorMatrix(this._options.colorMatrix)}};v0.prototype.availableOptions=If.prototype.availableOptions;var Ef=v0;var wI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_desaturation;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 grayXfer = vec3(0.3, 0.59, 0.11);
  vec3 gray = vec3(dot(grayXfer, texColor.xyz));
  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);
}
`;var Af=class extends L.Filter{constructor(){super();this._fragmentSource=wI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),c=[.3,.59,.11],{desaturation:d}=this._options;for(let u=0;u<s.width*s.height;u++){let m=u*4,p=c[0]*l.data[m]/255+c[1]*l.data[m+1]/255+c[2]*l.data[m+2]/255;l.data[m]+=(p*255-l.data[m])*d,l.data[m+1]+=(p*255-l.data[m+1])*d,l.data[m+2]+=(p*255-l.data[m+2])*d}a.putImageData(l,0,0)}};Af.prototype.availableOptions={desaturation:{type:g.NUMBER,default:1,uniformType:N.FLOAT}};var C0=class extends Jt{constructor(...t){super(...t);this._filter=new Af}update(){this._filter.setDesaturation(this._options.desaturation)}};C0.prototype.availableOptions=Af.prototype.availableOptions;var Uo=C0;var kI=`precision highp float;

uniform sampler2D u_image;
uniform vec4 u_lightColor;
uniform vec4 u_darkColor;
uniform float u_intensity;
varying vec2 v_texCoord;

const float EPSILON = 0.0000001;
const vec3 GRAYSCALE_WEIGHTS = vec3(0.2126, 0.7152, 0.0722);

vec4 duotoneKernel(vec4 sampledCol, vec4 light, vec4 dark, float intensity) {
  vec4 color = clamp(sampledCol, 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON);
  color = clamp(color, 0.0, 1.0); // necessary to get rid of all extended sRGB issues with OpenGL ES
 
  // Apply intensity as "symmetric gamma"
  if (intensity > 0.0) {
    color.rgb = 1.0 - pow(1.0 - color.rgb, vec3(max(intensity + 1.0, EPSILON)));
  } else {
    color.rgb = pow(color.rgb, vec3(max(-intensity + 1.0, EPSILON)));
  }
 
  // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion
  // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale
  float luminance = dot(GRAYSCALE_WEIGHTS, color.rgb);
 
  // Apply DuoTone
  vec4 duotone = mix(dark, light, clamp(luminance, 0.0, 1.0));
  duotone.a *= color.a;
  
  duotone.rgb *= duotone.a;

  return duotone;
}

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = duotoneKernel(texColor, u_lightColor, u_darkColor, u_intensity);
}`;var Ff=class extends L.Filter{constructor(){super();this._fragmentSource=kI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{lightColor:c,darkColor:d,intensity:u}=this._options;for(let m=0;m<s.width*s.height;m++){let p=m*4,f=l.data[p]/255,v=l.data[p+1]/255,x=l.data[p+2]/255,_=l.data[p+3]/255,D=new U(f,v,x,_),k=this._duoToneKernel(D,c,d,u);l.data[p]=k.r*255,l.data[p+1]=k.g*255,l.data[p+2]=k.b*255,l.data[p+3]=k.a*255}a.putImageData(l,0,0)}_duoToneKernel(t,e,r,o){let s=1e-7;if(t.clone().clamp(0,1),o>0){let c=Math.max(o+1,s);t.r=1-Math.pow(1-t.r,c),t.g=1-Math.pow(1-t.g,c),t.b=1-Math.pow(1-t.b,c)}else{let c=Math.max(-o+1,s);t.r=Math.pow(t.r,c),t.g=Math.pow(t.g,c),t.b=Math.pow(t.b,c)}let n=.2126*t.r+.7152*t.g+.0722*t.b,a=Math.min(Math.max(n,0),1),l=r.clone().mix(e,a);return l.a*=t.a,l}};Ff.prototype.availableOptions={lightColor:{type:g.COLOR,default:U.RED,uniformType:N.FLOAT4},darkColor:{type:g.COLOR,default:U.BLACK,uniformType:N.FLOAT4},intensity:{type:g.NUMBER,default:.5,uniformType:N.FLOAT}};var S0=class extends Jt{constructor(...t){super(...t);this._filter=new Ff}update(){this._filter.setLightColor(this._options.lightColor),this._filter.setDarkColor(this._options.darkColor);let t=2*this._options.intensity-1;this._filter.setIntensity(t)}};S0.prototype.availableOptions=Ff.prototype.availableOptions;var Of=S0;var TI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_gamma;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);
  rgb = pow(rgb, u_gamma);
  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;
}
`;var Rf=class extends L.Filter{constructor(){super();this._fragmentSource=TI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{gamma:c}=this._options,d=new Float32Array(256);for(let p=0;p<256;p++)d[p]=255*Math.pow(p/255,c.r);let u=new Float32Array(256);for(let p=0;p<256;p++)u[p]=255*Math.pow(p/255,c.g);let m=new Float32Array(256);for(let p=0;p<256;p++)m[p]=255*Math.pow(p/255,c.b);for(let p=0;p<s.width*s.height;p++){let f=p*4;l.data[f]=d[l.data[f]],l.data[f+1]=u[l.data[f+1]],l.data[f+2]=m[l.data[f+2]]}a.putImageData(l,0,0)}};Rf.prototype.availableOptions={gamma:{type:g.COLOR,default:U.WHITE,uniformType:N.FLOAT3}};var w0=class extends Jt{constructor(...t){super(...t);this._filter=new Rf}update(){this._filter.setGamma(this._options.gamma)}};w0.prototype.availableOptions=Rf.prototype.availableOptions;var Pf=w0;var DI=`varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);

  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);
  textureCoord /= 0.75;

  float d = 1.0 - dot(textureCoord, textureCoord);
  d = clamp(d, 0.2, 1.0);
  vec3 newColor = texColor.rgb * d * u_color.rgb;
  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);
}
`;var Bf=class extends L.Filter{constructor(){super();this._fragmentSource=DI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{color:c}=this._options,d;for(let u=0;u<s.width;u++)for(let m=0;m<s.height;m++){let p=(s.width*m+u)*4,f=u/s.width,v=m/s.height,x=(f-.5)/.75,_=(v-.5)/.75,D=x*x,k=_*_;d=1-(D+k),d=Math.min(Math.max(d,.1),1),l.data[p]*=d*c.r,l.data[p+1]=l.data[p+1]*(d*c.g),l.data[p+2]=l.data[p+2]*(d*c.b),l.data[p+3]=255}a.putImageData(l,0,0)}};Bf.prototype.availableOptions={color:{type:g.COLOR,default:U.WHITE,uniformType:N.FLOAT3}};var k0=class extends Jt{constructor(...t){super(...t);this._filter=new Bf}update(){this._filter.setColor(this._options.color)}};k0.prototype.availableOptions=Bf.prototype.availableOptions;var Rc=k0;var II=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  texColor.b = texColor.g * 0.33;
  texColor.r = texColor.r * 0.6;
  texColor.b += texColor.r * 0.33;
  texColor.g = texColor.g * 0.7;
  gl_FragColor = texColor;
}
`;var EI=class extends L.Filter{constructor(){super();this._fragmentSource=II}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height);for(let c=0;c<s.width;c++)for(let d=0;d<s.height;d++){let u=(s.width*d+c)*4;l.data[u+2]=l.data[u+1]*.33,l.data[u]*=.6,l.data[u+2]+=l.data[u]*.33,l.data[u+1]=l.data[u+1]*.7,l.data[u+3]=255}a.putImageData(l,0,0)}},AI=class extends Jt{constructor(...t){super(...t);this._filter=new EI}},Mf=AI;var FI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
vec3 W = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, W);
  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);
}
`;var OI=class extends L.Filter{constructor(){super();this._fragmentSource=FI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height);for(let c=0;c<s.width;c++)for(let d=0;d<s.height;d++){let u=(s.width*d+c)*4,m=l.data[u]*.2125+l.data[u+1]*.7154+l.data[u+2]*.0721;l.data[u]=m,l.data[u+1]=m,l.data[u+2]=m}a.putImageData(l,0,0)}},RI=class extends Jt{constructor(...t){super(...t);this._filter=new OI}},Pc=RI;var PI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;
  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;
  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;

  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);
}
`;var T0=class extends L.Filter{constructor(...t){super(...t);this._fragmentSource=PI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),c=this._options.lookupTableData;for(let d=0;d<s.width*s.height;d++){let u=d*4,m=l.data[u];l.data[u]=c[m*4];let p=l.data[u+1];l.data[u+1]=c[1+p*4];let f=l.data[u+2];l.data[u+2]=c[2+f*4]}a.putImageData(l,0,0)}};T0.prototype.availableOptions={lookupTable:{type:g.NUMBER,default:1,uniformType:N.INT},lookupTableData:{type:g.ARRAY,default:[]}};var BI=class extends Jt{constructor(...t){super(...t);this._filter=new T0({lookupTable:this._options.textureGLUnit}),this._textures={},this._renderers={}}update(t){let e=t.getRenderer();e.isOfType(gt.WEBGL)?this._updateWebGLTexture(t):e.isOfType(gt.CANVAS)&&this._filter.setLookupTableData(this._options.data)}_updateWebGLTexture(t){if(typeof this._options.data=="undefined")throw new Error("LookupTable: No data specified.");let e=new Uint8Array(this._options.data),r=t.getRenderer(),{id:o}=r;this._renderers[o]=r,this._textures[o]||(this._textures[o]=new L.BaseTexture);let s=this._textures[o],n=new L.PixelArrayImage(256,1,e);s.setSource(n),s.setGLUnit(this._options.textureGLUnit),r.isOfType(gt.WEBGL)&&r.updateTexture(s)}dispose(){super.dispose();for(let t in this._textures)this._textures[t].dispose(),delete this._textures[t];delete this._options.data}},Lf=BI;var MI=`/**
 * Based off of GPUImage's LookupFilter:
 * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m
 */

varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float blueColor = texColor.b * 63.0;

  vec2 quad1;
  quad1.y = floor(floor(blueColor) / 8.0);
  quad1.x = floor(blueColor) - (quad1.y * 8.0);

  vec2 quad2;
  quad2.y = floor(ceil(blueColor) / 8.0);
  quad2.x = ceil(blueColor) - (quad2.y * 8.0);

  vec2 texCoord1;
  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec2 texCoord2;
  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);
  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);

  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);
}
`;var{Vector2:LI}=$,zI=3,D0=class extends L.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=MI}_precomputeQuads(){this._quads=[];for(let t=0;t<256;t++){let e=t/255*63,r=new LI;r.y=(e|0)*.125|0,r.x=(e|0)-r.y*8,this._quads.push(r)}}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=this._options.lookupTableImage,d=this._createImageCanvas(l).getContext("2d"),u=n.getImageData(0,0,s.width,s.height),m=d.getImageData(0,0,l.width,l.height),p=new LI;for(let f=0;f<s.width*s.height*4;f+=4){let v=u.data[f],x=u.data[f+1],_=u.data[f+2],D=u.data[f+3]/255,k=this._quads[_],A=64;p.x=k.x*A,p.y=k.y*A,p.x+=Math.floor(v/4),p.y+=Math.floor(x/4);let B=(l.width*p.y+p.x)*4|0,T=m.data[B];T=v*(1-D)+T*D;let F=m.data[B+1];F=x*(1-D)+F*D;let q=m.data[B+2];q=_*(1-D)+q*D,u.data[f]=T,u.data[f+1]=F,u.data[f+2]=q}a.putImageData(u,0,0)}_createImageCanvas(t){let e=z.createCanvas();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e}};D0.prototype.availableOptions={lookupTable:{type:g.NUMBER,default:zI,uniformType:N.INT},lookupTableImage:{type:g.IMAGE,uniformType:null}};var I0=class extends Jt{constructor(...t){super(...t);this._filter=new D0,this._textures={}}update(t){let e=t.getRenderer();e.isOfType(gt.WEBGL)?this._updateWebGLTexture(t):e.isOfType(gt.CANVAS)&&this._filter.setLookupTableImage(this._options.image)}_updateWebGLTexture(t){let e=t.getRenderer(),{id:r}=e;this._textures[r]||(this._textures[r]=new L.BaseTexture);let o=this._textures[r];o.setSource(this._options.image),o.setGLUnit(zI),e.updateTexture(o)}dispose(){super.dispose();for(let t in this._textures)delete this._textures[t]}};I0.prototype.availableOptions={image:{type:g.IMAGE}};var zf=I0;var UI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_saturation;

const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, luminanceWeighting);

  vec3 greyScaleColor = vec3(luminance);

  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);
}
`;var Uf=class extends L.Filter{constructor(){super();this._fragmentSource=UI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height),{saturation:c}=this._options;for(let d=0;d<s.width;d++)for(let u=0;u<s.height;u++){let m=(s.width*u+d)*4,p=l.data[m]*.2125+l.data[m+1]*.7154+l.data[m+2]*.0721;l.data[m]=p*(1-c)+l.data[m]*c,l.data[m+1]=p*(1-c)+l.data[m+1]*c,l.data[m+2]=p*(1-c)+l.data[m+2]*c}a.putImageData(l,0,0)}};Uf.prototype.availableOptions={saturation:{type:g.NUMBER,default:0,uniformType:N.FLOAT}};var E0=class extends Jt{constructor(...t){super(...t);this._filter=new Uf}update(){this._filter.setSaturation(this._options.saturation)}};E0.prototype.availableOptions=Uf.prototype.availableOptions;var Ni=E0;var NI=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec4 overlayVec4 = vec4(u_color, texColor.a);
  gl_FragColor = max(overlayVec4 * texColor.a, texColor);
}
`;var Nf=class extends L.Filter{constructor(){super();this._fragmentSource=NI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height);for(let c=0;c<s.width;c++)for(let d=0;d<s.height;d++){let u=(s.width*d+c)*4;l.data[u]=Math.max(this._options.color.r*255,l.data[u]),l.data[u+1]=Math.max(this._options.color.g*255,l.data[u+1]),l.data[u+2]=Math.max(this._options.color.b*255,l.data[u+2])}a.putImageData(l,0,0)}};Nf.prototype.availableOptions={color:{type:g.COLOR,default:U.WHITE,uniformType:N.FLOAT3}};var A0=class extends Jt{constructor(...t){super(...t);this._filter=new Nf}update(){this._filter.setColor(this._options.color)}};A0.prototype.availableOptions=Nf.prototype.availableOptions;var Hf=A0;var F0=class extends Lf{constructor(...t){super(...t);this._options.rgbControlPoints||(this._options.rgbControlPoints={red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}),this._updateLookupTable()}_updateLookupTable(){let t=this._calculateSplineCurve(this._options.rgbControlPoints.red),e=this._calculateSplineCurve(this._options.rgbControlPoints.green),r=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(t,e,r)}_buildLookupTable(t,e,r){let o=[];for(let s=0;s<256;s++)o.push(Math.min(Math.max(s+t[s],0),255)),o.push(Math.min(Math.max(s+e[s],0),255)),o.push(Math.min(Math.max(s+r[s],0),255)),o.push(255);return o}_calculateSplineCurve(t){t=t.sort(function(n,a){return n[0]>a[0]});let e=this._getSplineCurve(t),r=e[0],o;if(r[0]>0)for(o=0;o<r[0];o++)e.unshift([0,0]);let s=[];for(o=0;o<e.length;o++){let n=e[o],a=[n[0],n[0]],l=Math.sqrt(Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2));a[1]>n[1]&&(l=-l),s.push(l)}return s}_getSplineCurve(t){let e=this._secondDerivative(t),r=e.length,o=[],s;for(s=0;s<r;s++)o[s]=e[s];let n=[];for(s=0;s<r-1;s++){let a=t[s],l=t[s+1];for(let c=a[0];c<l[0];c++){let d=(c-a[0])/(l[0]-a[0]),u=1-d,m=d,p=l[0]-a[0],f=u*a[1]+m*l[1]+p*p/6*((u*u*u-u)*o[s]+(m*m*m-m)*o[s+1]);f>255?f=255:f<0&&(f=0),n.push([c,f])}}return n.length===255&&n.push(t[t.length-1]),n}_secondDerivative(t){let e=t.length;if(e<=0||e===1)return null;let r=[],o=[],s,n;for(r[0]=[0,1,0],s=1;s<e-1;s++){let l=t[s-1],c=t[s],d=t[s+1];r[s]=r[s]||[],r[s][0]=(c[0]-l[0])/6,r[s][1]=(d[0]-l[0])/3,r[s][2]=(d[0]-c[0])/6,o[s]=(d[1]-c[1])/(d[0]-c[0])-(c[1]-l[1])/(c[0]-l[0])}for(o[0]=0,o[e-1]=0,r[e-1]=[0,1,0],s=1;s<e;s++)n=r[1][0]/r[s-1][1],r[s][1]-=n*r[s-1][2],r[s][0]=0,o[s]-=n*o[s-1];for(s=e-2;s>0;s--)n=r[s][2]/r[s+1][1],r[s][1]-=n*r[s+1][0],r[s][2]=0,o[s]-=n*o[s+1];let a=[];for(s=0;s<e;s++)a[s]=o[s]/r[s][1];return a}};F0.prototype.availableOptions={rgbControlPoints:{type:g.OBJECT},controlPoints:{type:g.ARRAY,default:[]},textureGLUnit:{type:g.NUMBER,default:1}};var Dt=F0;var HI=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;
  gray -= 0.2;
  gray = clamp(gray, 0.0, 1.0);
  gray += 0.15;
  gray *= 1.4;
  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);
}
`;var WI=class extends L.Filter{constructor(){super();this._fragmentSource=HI}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=n.getImageData(0,0,s.width,s.height);for(let c=0;c<s.width;c++)for(let d=0;d<s.height;d++){let u=(s.width*d+c)*4,m=l.data[u]/255*.3+l.data[u+1]/255*.3+l.data[u+2]/255*.3;m-=.2,m=Math.max(0,Math.min(1,m)),m+=.15,m*=1.4,m*=255,l.data[u]=m,l.data[u+1]=m,l.data[u+2]=m}a.putImageData(l,0,0)}},GI=class extends Jt{constructor(...t){super(...t);this._filter=new WI}},Wf=GI;var VI=`precision highp float;

uniform sampler2D u_image;

uniform sampler2D u_lookupTable;

uniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096
uniform float u_horizontalTileCount; // Horizontal Blue Tiles
uniform float u_verticalTileCount; // Vertical Blue Tiles

varying vec2 v_texCoord;

const float EPSILON = 0.000001;

// Try to get the exact pixel of the lut map image
vec3 lutColor(int texPosX, int texPosY) {
    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;
}

vec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {
    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);
}

void main() {
    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);

    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); 

    vec3 ranges = vec3(
        floor(u_resolution / u_horizontalTileCount - 1.0),
        floor(u_resolution / u_verticalTileCount - 1.0),
        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)
    );
    
    vec3 tmp = sourceColor * ranges;
    ivec3 floors = ivec3(tmp);
    ivec3 ceils = ivec3(ceil(tmp));
    vec3 fracts = fract(tmp);

    // Map tile index to tile pixel pos.
    ivec2 pixelsPerTile = ivec2(
        u_resolution / u_horizontalTileCount, 
        u_resolution / u_verticalTileCount
      );

    ivec2 tileFloor; // Blue tile index
    tileFloor.y = floors.z / int(u_horizontalTileCount);
    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));

    ivec2 tileCeil; // Blue tile index
    tileCeil.y = ceils.z / int(u_horizontalTileCount);
    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));
    
    tileFloor *= pixelsPerTile;
    tileCeil *= pixelsPerTile; 
    
    
    // Interpolate between red and green
    vec3 lutColorFB = bilinearInterpolate(
        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),
        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),
        fracts.x, fracts.y
    );
    vec3 lutColorCB = bilinearInterpolate(
        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),
        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),
        fracts.x, fracts.y
    );

    // Interpolate between the blue values
    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);

    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;
    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);

    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);
}
`;var{Vector2:Gf,Vector3:jI}=$,$I=3,O0=class extends L.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=VI}_precomputeQuads(){this._quads=[];for(let t=0;t<256;t++){let e=t/255*63,r=new Gf;r.y=(e|0)*.125|0,r.x=(e|0)-r.y*8,this._quads.push(r)}}_applyCanvas(t,e,r,o=!1){let{resolution:s,horizontalTileCount:n,verticalTileCount:a}=this._options,l=e.getCanvas(),c=e.getContext(),d=r.getContext(),u=this._options.lookupTableImage,p=this._createImageCanvas(u).getContext("2d"),f={width:128,height:128};s?f={width:s,height:s}:u.width&&u.height&&(f={width:u.width,height:u.height});let v=c.getImageData(0,0,l.width,l.height),x=p.getImageData(0,0,f.width,f.height),_=new jI(f.width/n-1|0,f.height/a-1|0,n*a-1|0),D=new U,k=new U,A=new U,B=new U,T=new U,F=new U,q=new U,Z=new U,pt=new Gf,xt=new Gf,ht=(wt,ce,Qt,Xt)=>{wt.r=ce.r*(1-Xt)+Qt.r*Xt,wt.g=ce.g*(1-Xt)+Qt.g*Xt,wt.b=ce.b*(1-Xt)+Qt.b*Xt},ut=(wt,ce,Qt)=>{ce=.5+ce|0,Qt=.5+Qt|0;let Xt=(Qt*f.width+ce)*4;wt.r=x.data[Xt]/255,wt.g=x.data[Xt+1]/255,wt.b=x.data[Xt+2]/255,wt.a=x.data[Xt+3]/255},Yt=new U,ri=new U,Ve=(wt,ce,Qt,Xt,it,lt,mt)=>{ht(Yt,ce,Xt,lt),ht(ri,Qt,it,lt),ht(wt,Yt,ri,mt)},Sr=new Gf(f.width,f.height).divide(n,a).floor();for(let wt=0;wt<l.width*l.height*4;wt+=4){D.set(v.data[wt]/255,v.data[wt+1]/255,v.data[wt+2]/255,v.data[wt+3]/255);let ce=new jI(D.r*_.x,D.g*_.y,D.b*_.z),Qt=ce.clone().floor().toInt(),Xt=ce.clone().ceil().toInt(),it=ce.clone().fract();pt.y=Qt.z/n|0,pt.x=Qt.z-pt.y*n|0,xt.y=Xt.z/n|0,xt.x=Xt.z-xt.y*n|0,pt.multiply(Sr),xt.multiply(Sr),ut(T,pt.x+Qt.x,pt.y+Qt.y),ut(F,pt.x+Qt.x,pt.y+Xt.y),ut(q,pt.x+Xt.x,pt.y+Qt.y),ut(Z,pt.x+Xt.x,pt.y+Xt.y),Ve(A,T,F,q,Z,it.x,it.y),ut(T,xt.x+Qt.x,xt.y+Qt.y),ut(F,xt.x+Qt.x,xt.y+Xt.y),ut(q,xt.x+Xt.x,xt.y+Qt.y),ut(Z,xt.x+Xt.x,xt.y+Xt.y),Ve(B,T,F,q,Z,it.x,it.y),ht(k,A,B,it.z),v.data[wt]=Math.ceil(k.r*255),v.data[wt+1]=Math.ceil(k.g*255),v.data[wt+2]=Math.ceil(k.b*255)}d.putImageData(v,0,0)}_createImageCanvas(t){let e=z.createCanvas();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e}};O0.prototype.availableOptions={lookupTable:{type:g.NUMBER,default:$I,uniformType:N.INT},lookupTableImage:{type:g.IMAGE,uniformType:null},resolution:{type:g.NUMBER,uniformType:N.FLOAT},horizontalTileCount:{type:g.NUMBER,default:5,uniformType:N.FLOAT},verticalTileCount:{type:g.NUMBER,default:5,uniformType:N.FLOAT}};var R0=class extends Jt{constructor(...t){super(...t);this._filter=new O0,this._textures={}}update(t){let e=t.getRenderer();e.isOfType(gt.WEBGL)?this._updateWebGLTexture(t):e.isOfType(gt.CANVAS)&&this._filter.setLookupTableImage(this._options.image);let{resolution:r,verticalTileCount:o,horizontalTileCount:s,image:n}=this._options;this._filter.set({resolution:r||n.width,verticalTileCount:o,horizontalTileCount:s})}_updateWebGLTexture(t){let e=t.getRenderer(),{id:r}=e;this._textures[r]||(this._textures[r]=new L.BaseTexture);let o=this._textures[r];o.setSource(this._options.image),o.setGLUnit($I),o.setMinFilter(L.BaseTexture.NearestFilter),e.updateTexture(o)}dispose(){super.dispose();for(let t in this._textures)delete this._textures[t]}};R0.prototype.availableOptions={image:{type:g.IMAGE},resolution:{type:g.NUMBER},horizontalTileCount:{type:g.NUMBER,default:5},verticalTileCount:{type:g.NUMBER,default:5}};var Vf=R0;var jf=class extends nt{constructor(...t){super(...t);this._stack.push(new al({brightness:0}))}render(t,e,r){return this._stack.isEmpty()&&this._stack.push(new al({brightness:0})),super.render(t,e,r)}};jf.isIdentity=!0;jf.identifier="identity";var $f=jf;var B0=class extends nt{constructor(...t){super(...t);this._stack.push(new Ui({contrast:.63})),this._stack.push(new al({brightness:.12})),this._stack.push(new Dt({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}))}};B0.identifier="a15";var YI=B0;var M0=class extends nt{constructor(...t){super(...t);this._stack.push(new Uo({desaturation:.5})),this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}))}};M0.identifier="breeze";var KI=M0;var L0=class extends nt{constructor(...t){super(...t);this._stack.push(new Pc)}};L0.identifier="bw";var XI=L0;var z0=class extends nt{constructor(...t){super(...t);this._stack.push(new Pc),this._stack.push(new Ui({contrast:1.5}))}};z0.identifier="bwhard";var qI=z0;var U0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}))}};U0.identifier="celsius";var ZI=U0;var N0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}))}};N0.identifier="chest";var JI=N0;var Yf=class extends nt{constructor(...t){super(...t,{intensity:{type:g.NUMBER,default:.5,required:!0,setter(e){return this._filterPrimitive&&(this._filterPrimitive.setIntensity(e),this._stack.setIntensity(1)),this._dirty=!0,e}}});this._filterPrimitive=new Of({lightColor:this._options.lightColor||U.WHITE,darkColor:this._options.darkColor||U.BLACK,intensity:this._options.intensity||.5}),this._stack.push(this._filterPrimitive)}};Yf.prototype.availableOptions={lightColor:{type:g.COLOR,default:U.WHITE,required:!0,setter(i){return this._filterPrimitive&&this._filterPrimitive.setLightColor(i),this.setDirty&&this.setDirty(!0),i}},darkColor:{type:g.COLOR,default:U.BLACK,required:!0,setter(i){return this._filterPrimitive&&this._filterPrimitive.setDarkColor(i),this.setDirty&&this.setDirty(!0),i}},intensity:{type:g.NUMBER,default:.5,required:!0}};Yf.identifier="duotone";var QI=Yf;var H0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}))}};H0.identifier="fixie";var tE=H0;var W0=class extends nt{constructor(...t){super(...t);this._stack.push(new Ni({saturation:1.35})),this._stack.push(new Ui({contrast:1.1}))}};W0.identifier="food";var eE=W0;var G0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}))}};G0.identifier="fridge";var iE=G0;var V0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}))}};V0.identifier="front";var rE=V0;var j0=class extends nt{constructor(...t){super(...t);this._stack.push(new Ui({contrast:1.1})),this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}))}};j0.identifier="glam";var oE=j0;var $0=class extends nt{constructor(...t){super(...t);this._stack.push(new Mf)}};$0.identifier="gobblin";var sE=$0;var Y0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]})),this._stack.push(new Ni({saturation:.9}))}};Y0.identifier="k1";var nE=Y0;var K0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]})),this._stack.push(new Hf({color:new U(40/255,40/255,40/255)}))}};K0.identifier="k2";var aE=K0;var X0=class extends nt{constructor(...t){super(...t);this._stack.push(new Ni({saturation:.5}))}};X0.identifier="k6";var lE=X0;var q0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]})),this._stack.push(new Ni({saturation:.7}))}};q0.identifier="kdynamic";var cE=q0;var Z0=class extends nt{constructor(...t){super(...t);this._stack.push(new Uo({desaturation:.4})),this._stack.push(new Dt({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}))}};Z0.identifier="lenin";var dE=Z0;var J0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}))}};J0.identifier="lomo";var uE=J0;var Q0=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}))}};Q0.identifier="mellow";var mE=Q0;var{ColorMatrix:s9}=$,tv=class extends nt{constructor(...t){super(...t);let e=new s9(.8158218291630716,0,0,0,-.01779810181190647,0,.8098360655737704,0,0,.0916393442622953,0,0,.4596336773932402,0,.12760574782432707,0,0,0,1,0);this._stack.push(new Ef({colorMatrix:e}));let r=new U(.8,.6,.9);this._stack.push(new Pf({gamma:r}))}};tv.identifier="metal";var pE=tv;var ev=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}})),this._stack.push(new Rc)}};ev.identifier="morning";var hE=ev;var iv=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]},textureGLUnit:2})),this._stack.push(new Dt({controlPoints:[[0,0],[117,151],[189,217],[255,255]],textureGLUnit:3})),this._stack.push(new Uo({desaturation:.65}))}};iv.identifier="orchid";var fE=iv;var rv=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}})),this._stack.push(new Ni({saturation:.8})),this._stack.push(new Ui({contrast:1.5}))}};rv.identifier="pola";var gE=rv;var ov=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}})),this._stack.push(new Ni({saturation:.8})),this._stack.push(new Ui({contrast:1.5}))}};ov.identifier="pola669";var bE=ov;var sv=class extends nt{constructor(...t){super(...t);this._stack.push(new Uo({desaturation:.65})),this._stack.push(new Dt({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}))}};sv.identifier="quozi";var _E=sv;var nv=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}})),this._stack.push(new Rc)}};nv.identifier="semired";var yE=nv;var av=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]},textureGLUnit:2})),this._stack.push(new Dt({controlPoints:[[0,0],[55,20],[158,191],[255,255]],textureGLUnit:3}))}};av.identifier="sunny";var xE=av;var lv=class extends nt{constructor(...t){super(...t);this._stack.push(new Dt({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}))}};lv.identifier="texas";var vE=lv;var cv=class extends nt{constructor(...t){super(...t);this._stack.push(new Wf)}};cv.identifier="x400";var CE=cv;var Kf=class extends nt{constructor(...t){super(...t);this._lutPrimitive=new zf({image:this._options.image}),this._stack.push(this._lutPrimitive)}};Kf.prototype.availableOptions={image:{type:g.IMAGE,required:!0,setter(i){return this._lutPrimitive&&this._lutPrimitive.setImage(i),this.setDirty(!0),i}}};Kf.identifier="lut";var SE=Kf;var Xf=class extends nt{constructor(...t){super(...t);let{image:e,resolution:r,verticalTileCount:o,horizontalTileCount:s}=this._options;this._lutPrimitive=new Vf({image:e,resolution:r,verticalTileCount:o,horizontalTileCount:s}),this._stack.push(this._lutPrimitive)}};Xf.prototype.availableOptions={image:{type:g.IMAGE,required:!0,setter(i){return this._lutPrimitive&&this._lutPrimitive.setImage(i),this.setDirty(!0),i}},resolution:{type:g.NUMBER},horizontalTileCount:{type:g.NUMBER,default:5},verticalTileCount:{type:g.NUMBER,default:5}};Xf.identifier="3d-lut";var wE=Xf;var na=class extends Mt{_render(t){return this._selectedFilter.render(this._sdk,t,this._renderTexture)}render(t){return this._selectedFilter.getDirty()&&this.setDirty(!0),this.getEnabled()?super.render(t):(this.setDirtyForRenderer(!1,this._sdk.getRenderer()),Promise.resolve(t))}setDirtyForRenderer(t,e){super.setDirtyForRenderer(t,e),this._selectedFilter.setDirtyForRenderer(t,e)}disposeRenderTextures(){super.disposeRenderTextures(),this._selectedFilter&&this._selectedFilter.disposeRenderTextures()}dispose(){super.dispose(),this._selectedFilter&&this._selectedFilter.dispose()}restoreSnapshot(t){let e=b({},t);if(delete e.filter,t.filter){let r=t.filter.constructor;r.identifier==="3d-lut"?this.setFilter(new r({image:t.filter.getImage(),resolution:t.filter.getResolution(),horizontalTileCount:t.filter.getHorizontalTileCount(),verticalTileCount:t.filter.getVerticalTileCount()})):r.identifier==="duotone"?this.setFilter(new r({lightColor:t.filter.getLightColor(),darkColor:t.filter.getDarkColor(),intensity:t.filter.getIntensity()})):this.setFilter(new r)}this.set(e)}resetToDefaultFilterIntensity(){let t=this._selectedFilter&&this._selectedFilter.availableOptions,e=t&&t.intensity.default;this.setIntensity(e||1)}};na.identifier="filter";na.prototype.availableOptions={identifier:{type:g.STRING,default:"identity"},intensity:{type:g.NUMBER,default:1,setter(i){return this._selectedFilter&&this._selectedFilter.setIntensity(i),i}},filter:{type:g.OBJECT,default:new $f,setter(i){return this._selectedFilter&&(this._selectedFilter.dispose(),this._selectedFilter=null),this._selectedFilter=i,typeof this._options.intensity!="undefined"&&this._selectedFilter.set({intensity:this._options.intensity}),i}}};na.FilterPrimitives=P0;na.Filters=dv;na.Filter=nt;bt.Operations.FilterOperation=na;var kE=na;var om=class extends Mt{constructor(...t){super(...t);this._flipContainer=new L.Container}_render(t){let{outputResolution:e,flipHorizontally:r,flipVertically:o}=this._options;if(r||o){let s=t.getDimensions();this._flipRenderTexture?this._flipRenderTexture.resizeTo(s):(this._flipRenderTexture=new L.RenderTexture(this._sdk.getRenderer(),s.x,s.y),this._flipSprite=new L.Sprite(this._flipRenderTexture),this._flipContainer.addChild(this._flipSprite));let n=r?-1:1,a=o?-1:1;this._flipSprite.setScale(n,a),this._flipSprite.setPivot(0,0),this._flipSprite.setPosition(s.x*(1-n)*.5,s.y*(1-a)*.5),this._flipRenderTexture.clear(),this._flipRenderTexture.render(this._container),this._renderTexture.render(this._flipContainer)}else this._renderTexture.render(this._container);return Promise.resolve()}};om.identifier="flip";om.prototype.availableOptions={flipHorizontally:{type:g.BOOLEAN,default:!1},flipVertically:{type:g.BOOLEAN,default:!1}};bt.Operations.FlipOperation=om;var TE=om;var{Vector2:Bc}=$,Mc=class extends Mt{constructor(...t){super(...t);this._colorOverlayFilter=new L.Filters.ColorOverlayFilter({color:this.getTintColor()}),this._frameContainer=new L.Container,this._resetSprites(),this._options.frame&&this._createSpritesForFrame(this._options.frame)}_resetSprites(){this._spriteGroups={top:{},left:{},right:{},bottom:{}},this._sprites=[],this._repeatSprites={top:[],left:[],right:[],bottom:[]}}_createSpritesForFrame(t){if(!t)return this._disposeSprites();let{imageGroups:e,layoutMode:r}=t;this._layoutMode=r||"horizontal-inside",this._disposeSprites(),["top","left","right","bottom"].forEach(o=>{typeof e[o]!="undefined"&&["start","mid","end"].forEach(s=>{if(typeof e[o][s]=="undefined")return;let n=e[o][s];"image"in n&&(n=n.image);let a=L.Texture.fromImage(n),l=new L.Sprite(a);this._spriteGroups[o][s]=l,this._sprites.push(l),this._frameContainer.addChild(l)})})}_render(t){let e=this._renderTexture.getDimensions();return this._options.frame&&(this._colorOverlayFilter.setColor(this.getTintColor()),this._updateSprites(t)),this._frameRenderTexture?this._frameRenderTexture.resizeTo(e):(this._frameRenderTexture=new L.RenderTexture(this._sdk.getRenderer(),e.x,e.y),this._frameSprite=new L.Sprite(this._frameRenderTexture),this._container.addChild(this._frameSprite)),this._frameSprite.setAlpha(this._options.alpha),this._options.frame&&this._options.frame.tintable?this._frameSprite.setFilters([this._colorOverlayFilter]):this._frameSprite.setFilters([]),this._frameRenderTexture.clear(),this._frameRenderTexture.render(this._frameContainer),this._renderTexture.render(this._container),Promise.resolve()}_updateSprites(t){let e=t.getDimensions();this._frameWidth=Math.ceil(t.getDimensions().min()*this._options.scale),this._updateHorizontalSpriteGroup(t,"top",0),this._updateHorizontalSpriteGroup(t,"bottom",e.y-this._frameWidth),this._updateVerticalSpriteGroup(t,"left",0),this._updateVerticalSpriteGroup(t,"right",e.x-this._frameWidth)}_updateHorizontalSpriteGroup(t,e,r=0){let o=t.getDimensions(),s=this._layoutMode==="vertical-inside",n=this._spriteGroups[e].start,a=this._spriteGroups[e].mid,l=this._spriteGroups[e].end,c=0,d=0,u,m;if(n){u=n.getTexture().getDimensions(),m=u.y/u.x,c=Math.floor(this._frameWidth/m);let p=new Bc(0,r);p.x=s?this._frameWidth:0,n.setPosition(p),n.setHeight(this._frameWidth),n.setWidth(c)}if(l){u=l.getTexture().getDimensions(),m=u.y/u.x,d=Math.floor(this._frameWidth*m);let p=new Bc(o.x-d,r);p.x-=s?this._frameWidth:0,l.setPosition(p),l.setHeight(this._frameWidth),l.setWidth(d)}if(a){u=a.getTexture().getDimensions(),m=u.y/u.x;let p=new Bc(c,r),f=o.x-c-d;if(s&&(p.x+=this._frameWidth,f-=this._frameWidth*2),a.setPosition(p),a.setWidth(f),a.setHeight(this._frameWidth),this._options.frame.imageGroups[e].mid.mode==="repeat"){let v=this._frameWidth/m,x=Math.ceil(f/v),_=0;if(x!==-1){let D=Math.round(f/x);a.setWidth(D),_+=D,this._ensureRepeatSpritesExist(x-1,e,a);for(let k=0;k<x-1;k++){D=Math.round((f-_)/(x-k-1));let A=this._repeatSprites[e][k],B=p.clone().add(_,0).floor();A.setPosition(B),A.setWidth(D),A.setHeight(this._frameWidth),_+=D}}}}}_ensureRepeatSpritesExist(t,e,r){r.getTexture().setMaxListeners(t+1);let o=this._repeatSprites[e].length;if(t>o){let s=t-o;for(let n=0;n<s;n++){let a=new L.Sprite(r.getTexture());this._repeatSprites[e].push(a),this._frameContainer.addChild(a),this._sprites.push(a)}}else t<o&&this._repeatSprites[e].splice(t).forEach(n=>{let a=this._sprites.indexOf(n);a!==-1&&(this._sprites.splice(a,1),this._frameContainer.removeChild(n),n.dispose())})}_updateVerticalSpriteGroup(t,e,r=0){let o=t.getDimensions(),s=this._layoutMode==="horizontal-inside",n=this._spriteGroups[e].start,a=this._spriteGroups[e].mid,l=this._spriteGroups[e].end,c=0,d=0,u,m;if(n){u=n.getTexture().getDimensions(),m=u.y/u.x,c=Math.floor(this._frameWidth*m);let p=new Bc(r,0);p.y=s?this._frameWidth:0,n.setPosition(p),n.setWidth(this._frameWidth),n.setHeight(c)}if(l){u=l.getTexture().getDimensions(),m=u.y/u.x,d=Math.floor(this._frameWidth*m);let p=new Bc(r,o.y-d);p.y-=s?this._frameWidth:0,l.setPosition(p),l.setWidth(this._frameWidth),l.setHeight(d)}if(a){u=a.getTexture().getDimensions(),m=u.y/u.x;let p=new Bc(r,c),f=o.y-c-d;if(s&&(p.y+=this._frameWidth,f-=this._frameWidth*2),a.setPosition(p),a.setHeight(f),a.setWidth(this._frameWidth),this._options.frame.imageGroups[e].mid.mode==="repeat"){let v=this._frameWidth*m,x=Math.ceil(f/v),_=0;if(x!==-1){let D=Math.round(f/x);a.setHeight(D),_+=D,this._ensureRepeatSpritesExist(x-1,e,a);for(let k=0;k<x-1;k++){D=Math.round((f-_)/(x-k-1));let A=this._repeatSprites[e][k],B=p.clone().add(0,_).floor();A.setPosition(B),A.setHeight(D),A.setWidth(this._frameWidth),_+=D}}}}}_disposeSprites(){this._sprites.forEach(t=>{this._frameContainer.removeChild(t),t.getTexture().dispose(),t.dispose()}),this._resetSprites()}dispose(){super.dispose(),this._disposeSprites(),this._colorOverlayFilter&&this._colorOverlayFilter.dispose(),this._frameRenderTexture&&this._frameRenderTexture.dispose()}static validateFrame(t){if(!t)return;let{imageGroups:e,layoutMode:r}=t;if(typeof t.identifier!="string")throw new Error("Frame needs a property `identifier` of type String.");if(typeof t.imageGroups!="object")throw new Error("Frame needs a property `imageGroups` of type Object.");let o=s=>{let{start:n,end:a,mid:l}=e[s];if(typeof e[s]!="undefined"){if(typeof e[s]!="object")throw new Error(`Frame: \`imageGroups.${s}\` needs to be of type Object.`);if(typeof n!="undefined"&&!(n instanceof Li||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${s}.start\` needs to be of type Image.`);if(typeof l!="undefined"&&!(n instanceof Li||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement)&&typeof l!="object")throw new Error(`Frame: \`imageGroups.${s}.mid\` needs to be of type Image or Object.`);if(typeof a!="undefined"&&!(a instanceof Li||typeof HTMLImageElement!="undefined"&&a instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${s}.end\` needs to be of type Image.`)}};if(typeof r!="undefined"&&["vertical-inside","horizontal-inside"].indexOf(r)===-1)throw new Error("Frame: `layoutMode` must be one of vertical-inside, horizontal-inside");if(typeof tintable!="undefined"&&typeof tintable!="boolean")throw new Error("Frame: `tintable` needs to be of type Boolean.");o("top"),o("left"),o("right"),o("bottom")}};Mc.identifier="frame";Mc.prototype.availableOptions={frame:{type:g.OBJECT,validation:Mc.validateFrame,setter(i,t){return t||this._createSpritesForFrame(i),i},default:null},alpha:{type:g.NUMBER,default:1},tintColor:{type:g.COLOR,default:new U(1,1,1,0)},scale:{type:g.NUMBER,default:.1}};bt.Operations.FrameOperation=Mc;var DE=Mc;var n9="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDA4NDFGODc4N0ZCMTFFOEFCRjZEQ0E4MkRCQzYyNjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDA4NDFGODg4N0ZCMTFFOEFCRjZEQ0E4MkRCQzYyNjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMDg0MUY4NTg3RkIxMUU4QUJGNkRDQTgyREJDNjI2MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMDg0MUY4Njg3RkIxMUU4QUJGNkRDQTgyREJDNjI2MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ppk6b2UAAAASUExURQAAAP///8zMzDMzM2ZmZpmZmer1GSkAABunSURBVHja7F3rgt6mDlzr8v6v3O5ukqaJbQSS0GDjn+c0+9lomBkJEB8fD3tEPvbz5ocO3oPw6vgfx+aA9z56HBsBL37k+H50D8UrHz6OjYAd/42ANxvAjYC3G8BfD+0ReacB3AjYBmAj4IXPcfJQVVFQaFuQSgNYiwBW2uxTbADrEMDyA4p7RaLUABYhgP8D4i5H1xrAAgT8mvzbgWIYgLkI4D9VaGtAuQGYiAD5G4NbAxAEYAoCvmz/rkJAVQAmxoKvCGhrAIABSEeAXP/81oDiDDAfASx36NvFQAgDkIcA1kLh2U+HAKTMx1b4twlAyADTEMBUgLn9DAtAcDyYCo3HfroywAQEiFl2tgbgCEAYAuzh34lgUQaokheRnvBvE1BjAOiuNiATw79NQE0GyB9JCOgN/zYBJQIgd/+nIybcH/5tAgoEQO/hMYqAofBvDZgvANTOEAYWh1mPYwNgCQFgQ45Is8K/TcB0ARBTlaAPAY7wbxNQJgD3oevIz+3WX8+YYmtAlQDEIMAcfhI+p6WtAVUCcI8AEzWzPfyXvLQBME8A1F4ssiDA7P1Ibn5tV4PnCUBPubA9NcUafr79N9sEFArALY3flwOs4q/ceDPaGhD+aJev44Fk0Mr+ym2+2QCYIwDUSxg38iyD4T8FwK4EzHGA/BGFAKP3V7ZBZ5uAUgG4n9EyXPhTtmJtA2CGA6RBR89j5k+5g562CZggADJEG395dHaGf5uAIgfYrraoJRUQb/i3CUh/OkpAtoKQ9k1/5W6F2gBId4AmkqWGEZTOqp/domwTkOwA1fFvf8bHMv1NRb3tAqFKAFYEGKY/yShH7fWgXAcovn/+ObMNub+Mk9Q2AakOkLwAOgK83wZAnQNk91+IEf9tApAdYCsVCBD/XQoqcYAU8UdC9/XKdoHfbCs8gwAk5K9EiP82AX9NNSJhxiKATiNIEgPUF5qAX8NAGgMCiTp4I3nsv13gxTwg8usBhTVg0Azvf//35eUACGACCTx6SVnsf/mqLzQB5wEbBgEHUrTJCGog9l8JALo9QxVD2xQYoqjpf/7tGwBOIuDgo9eS2ttpu0CDzvYRgUaHSdOm//kffx0ALDJL5iJLNAHcAtRfttu1QHPBzSgGGt96gbOm/3aBvdWWthhwRvcdyWvtuAHQu+7awACl9F7RvKY+2wX2L7rdYCCFAD6MXWY2ACYB4AYDlDRROU0EZBeDx9oqnmIgiwDMjYZCoPWyNICP4cdy5D6KUTVJBLYLdADgz/oAZ3n1a6LShL+7ATAqBZrZf5OTROD1LlAO9/OjIpNKAGki8HoA0BHwfElBKgF8jJ4232nADAB80UAuAWSJwOvTgCgA5BXrGmql4QCglwOAhKJQoTPAKuED8B86fnvkt+f3//15ScDn97MQHAEMNh0acYGi9P1YtO/7UZUl8XAtgcxKWATgPnM8QwO/0SDLYIFvx9OJgfghoPjf0TQD9BMJqwHgj25c42KgU17X9UMBNGcGwjJ1II4aJZ7zvqO/xHFm14oDQBhYd0UOYCAnm4o5dzg7+L/DAAsDHZXQXgzwLM3q9IFTaH/6uGRkwT4M0DzO6vixoPzWQwEfCwOgBwNpFXXHr5VH/wEA+DDe0ZD3naOHT4uZH3OpabASbiBSmQlaw+8JRPThLMD4UkgLAzz1pVuvDRN+tIuJXIuhd5yauqTae/wIJ/xwFoCd3H05tDz5rW9GFin8cJsN2B26cxpIxrnYKQAr/HD7zSTgDaXA6lopgMHC/0gAaMFnim1sFS38cLuNAhokcInQWXRH4KY/3n7DgE3RFQpgoQD2Tf9f+3z+t//r/4+IdmwdgtxxHAAAquE5akwvGY770HaeH4jQFhoYHgC9weOie9hPA+yY/t+r9THx+cLCKRDgNhwHAKAK5nRDsNIZ+5yNGitcSeMHgFbBXK5toHbEXvM26axwHYEfAFQGc7rgHnPuTzK9XsmPA0DhV8q5DbTRf+bMv34/OAvgPxdV+JV8utamtujXMJQ+DwCVXzmY6CuX4ZMXAIC6ASCFb1+t+68DQO1XDnS4mze2uoAFcG8HKDY6ghv+Re6kcwOg9isZN/yLXEjl3g9S3GGnQwNmG/A1bqPxAqC6vYZZA+ZvxaQNACAKEISRRWw+5QVA+X0LBJT4N7mJnweA8iZ7Ajn9V0kCHwAAhpz+H8tcTC7hAKD6gUYY9VVuJXYCAKDHnmKew1pEARIAoABTDWDxbYWVwBwACBAA6kR3kSTQDQCpFzqGPIari1gAbwQB7t1UyBMYtIgF8AKgvtc+Qx7AWEYB4gGAkgUK2rCC3kKxOgAEswvHMgqwPAAwT+CuowCrA0AxD+CuowCLA4Ax47+QAiwOAELk/6UUYG0ABDYOf2cV6MO9HFwLAALtwLGQAiwNAFQCWEkBVgYAAxaAllOAlQGgmA5wLQVYGACwBLCUAngX9AsBQKgEsJQCrAsAVAe4mAJ493TVLQejpoBFXROrAFC2IWQpAgBWAO+23qotYbAO8LxtzQfw41NxLgIAbAq4mgIsCgBcAlhNARIAIEWjjEEADGpNJwJgwufiOsDFigABmXxJIQA2BTzdogZtAd2ZfAUAzveBQYymLKcArUz+99sRQAAA7ADXs4CnmP3tGgz6+woN+r5CI4ZAnpUCrlcE+BhrtvnzYo1/cTC/FMjA93DoakWAz/tfD9cznwGAHeDHsZACfM7ejquOeloxvzUFXMYCfoX+SHto+iRDGWV8C3h1k9E6AAB2gOAW8Cv2x5Rn9r3xKD4L1gJOjH02AGgxAqhXAD6/2zv1yUM9sgO8UCcpfLvJE3/CjEROAT+gGlUmG/0iAEATgMD0Kq1g/SkhgXaA9x1L50GAEW5MT4oJcgrYbFo9AwJVmj+JAhYmgAkQqOf9dF+GnALa1tT00byfTQHQDtB4hWXKtVVQUz9xYkKngOZF9WAIMGT0U6T5CQTwDQFeg/h/bglSVZHPPUKnm4Sun1c5wL5dNUFuUJOCLtcbAH/SDkt7K4FOmGIwS21aYZI1NvByG/SBaiNvAsi1AhwTehVmnw7RBB9IjyKAICtA3tAzx8xS1mwKwHaAg1PRbQWkatbPV2jkfWAOMZbpwPua9utVaYGPAvm02KkDhBD7CRyN7QDP4WnN0V06YL85O39fSmadDtsB8tXbMaXrAFVP/CkUwNAO8DwI329ng4BDB7Q98bl0HAidXBIJoAMCEjs3ZrH+JKGWZQnADoFhEiCM4GemgoydAkr7q00Q0Lifr7owK4kCsFPAJgF8h8li1sZGCokdU7h6xRTwhPYsENCoFyCo2aAJfxM7BTzHvOaQAD+cAlZ0gBeQZ00hAUJySPHTldZzgNfwNLjBfhKAooBwwX4QAVitgEa8RJlHCk4FV3SADXhqeE1AoLKk2KRdF3SALXgarID6x7xskoRyNjgBjDqetg70kQBUJhjq2lbcBybj/3QU5Qw1TQKX7lbcB2aEZzsf0GUpIE63sVNA8sGzqQMdMoDVmyZMuBWaADRl3g7+McKngKMOSBPNbt9XchgJCNZUiaFu6BSQYzZ2aJQXxKKAEPO2YjeI/iFvkoA+hwJo/t+YrHJDIy4xMoDllwNm74r9wMboqUkCsiAF+PUbeR+YBJ+FlAAZ4IdRAPI+MA4/Dd0iAYsMKBYFOBkc2QFyxjm/VjrAq1GAMxUEdoCccxi+RQLyKgoAPgp0GSj326nTCCxBATSDPkriH3EAhnxGAIwCODilgSCAy/jHoFNdCECjgOFU8GKdleufy3wtyp6IywgsQQHqnQeQD6dTjGX0GMw6DzI5rxd/ySZOYzjBKGDQy9Fy8dcJ88YEADQKGMrmZLn4R4/w3bZhHqAPAaMAehgBxM8wHfYaa1CAPIsABCf+eBTQvaazoAOMvhhOPVBDo4DuVd0FU8CvL2KM+ONRQO/x2WPVJ6otizP+eMsofT6QjuPdEFC31VCwgnCXD5Rj6ccPAfLXGuAooGdJgI7j1RAIiD/edvoOCtBj/cdjB0Pif2G80Sjg7IX4eMQzCgEOir+lcyHmkoAeD3mkNP4XA46fCvLxmGeg3RsHrjXBbaixpYJ0POhRros/3pY6kw+U41lPwDmo4bgtmQqef720n3N+kZyn455WLYs/3rZ6AwWMZ6+T4W6/q9d3ut/F23AHa5q2xPPG0ysfZgw43t+p27qED9QYzqqAu/VGqKL4412y0KAAX+JSkvbYaKAtA5QR/+VSQWfeUpT2mGiAR8s/zg9Yygd64VoGd0sHeBlL/70AFjQRuNkd5hfxOrizp+mnRNeT29oCeVDIb+Mr0x4e7veXGn9fJ9OpPjAieqWL4E0IaK/9D8GuFs6KLp6O4O/iygcPHO7Pjv8qIsAxlbzqtKcBAe2x/1HAFTQROJ/qQTlc+QrY/cFe7fiPw2CLJgIdK/4cxS/1LucMAXLMiP/VgIO1D4wCKUDl41YH1DYOofe+womAdR0tvNSEQAJqiv8E1S0UAckSgEapCcMJSFv+o00LnAhQGgF8oLSX1XsEyDEx/ldvUycCnEcAMCtgcvdlk+N/NeXq1gRy7s9FSQWbKKcjP/03vYwAU0B4qWn+Rw7tcJapU67MBkjmOMCcixtAAM99F7CbJYNeDGczZO8xJ+LZpKugFMAJ4/4BjwAteBWBpADN+OOKjgAtGfEqG8CZSgi0GVKr7V9rxMtsgGZOBaDNkAoS/8s3ITgKoKw/XqN3VGz/miNeZQRl+k6oIqwbEECV411mBClxMJAoIPaW+Iy8S6AogBP/eI3l5XL5b1kRBqIAyhz0Irnj6tFvkhDSzJBMxDMU2VXbv3J7pJM9QF3OI6jyXzwwaRRAaI63MAlXhDrkZKsmaEi/hKRU/TAIAmhiJbCWArjGfnFKP6PsYeE0AsBb/aAS2OEgIMMHMiDVXcNS5/8k0tBkpIKKmPNWpKbdfXcVZlQyaQ9tHxTBxH9OVcKUCmr4MANvhtWZcMNDQHQqaNC9MgqQeSJwb/8FSSGDU0HYlHeqCHBjmgsQQcamgibhqzsWN2nM22ePBGh+RKaCtsQX7lgcT4y/NP+b2UYgMhU0Oh+09gg0L/5s4UqIA/WZlS+0HjmhI25tPaE42UCYDzSnPnA9cubEX+1+SespgGO5D1sEdH78GwggqaYAiplcinZ7Tmrrvj5lV5SqUIwPvEgn0LqmZ/Zv7e08pyiFwYhU8BJFaF3T01r33ZX/LmLZ7HDL61DAZZzhbs+hHB94G//hytkkCPh5+uYvrHGXsibGXz3OeY4QuK3azR+Ao4CM+5yGL54w5E4zMoLUG0PgLtCa1RjFBHVL+YyESyiAfN8v4aWmVLhLSfytW0ezzYCPpxsyv+hdyiHx59Hhm00DHqvWRM+CF6nGlECNDs5aRE3FgMMbN+P7aB8YsbRrP0GQh4Fxnjb8S7RUMNCWSMyyZ8cmUkp6hn/MwB2rXaQaEv++z5OhfaS4T9aAg/nAyM1d+qT4Sx7nZvpALoz/aIdjyIfyOBch7THkf2MO9zE6wOm5d1LaI6Xxf4wOaHruneUDqTj+tuuwVyQApDbSd5wkxfF/BAQ0vNQ0zwdSefwfAIHs3BuBAm4ce4SsLQ0BmbQGk5QKOsATaWvWhQAl597ZqaBAxP9zuBZNCjk394agAHUt/z67LqDTlmGzKEBh4v8x2GkClQBW2R3Gw/Gfe9R8LQeIuSQgA++jARsA/Lnmcg5wpVSQxyelvDv+7e9HSwX7KaCRn+mrDQANglpWooBppzovf4cAnmETrMtTQNOaSeKbFXumADe3BgWMF4K/xiGCBHhaqhHHTjwObMaigDEvExokQo6/axov0TPCUQyK+R5Fjr9PyJ9BAS0j4DzSycj679VxtFSQxl6ntYdTw2kJJf7eCKL5QBl9nQYCHAmhQsffzeH6DAow9HiJFQDCiL9/bxfaQaFhCmgu1gySwHiZpS4FnMshKBTQPsyhYSOMEv8QBacFKIBd0XKQACMngEEenh9DAYY1e40YYRQDGMXeYD7QQwFtGeirCQi0AYwib7RUkFxf1SYBdo4MigGIs29gB4XE91kcd1uWQhuAwAQOTOi8b9Pcxm80g4wtAIHSDZYKipeQ2vs3TXgiaAEIVW6sJQF2f1lbBmh0iQlFAGJjBuYD1f9pAZ1/CVoAgllb8Smg89sMTV6UJ44waAq4EAVkdHqSKR57AQJAwzuHvIyBBK6tgEILQMKExVoSoJiXMZDAhRVgbAeYAE8sCpCg0pSl3ZuaLxHSBxMAmumlqA+0NHdQ4whjO0BCRFUoBYx9oYUE/rIC+i4HCGd7+PzUH0eO1x0EPB1r1ksBwSjg3+BT9L4+6oSArucAI/Sp3gfeBN83B03dHX5BgN+WAkKkgq3g+77S1unrBwT0bSlgufdlIdMBfM9n2ro8fUJgRQIIClJBKvg58e3dFzh86pxAQN+XAtb4QLZO/Cg9ctwC8NRVQNskgYh9SByGu/3BEED2GlX6Ghj3cf6cakcy86SngOkME3JDmjP0YeUOWpgAJmj01fCQMo9HXvyhD6x30LIEMMGl3zXEo08UcE/gP+d8bIc1zeM5fAKYUqprb6omEvkMLp/H/N/5/jnhKaW1XtAF7n0d4J92FGicAv6GgqllXVTwIy9r7YHAqwgA9bYsCr+13ewGUQhg2jZFekH0e9wgyirAtPV6rMbolHlTuwUC2ASQgk56+tTvgsCjukGE+8BVp74dAigEMHW3hr4l+AYIQBNAVoWK3xP8JgT4hQRQB4CK4N9DAKQKPHvDJtUYvtLZJgRMALO3bNP8ic+QLEvvJICJpQCqnvj3qAd+tVRw8stif/XNIAQwf8M+vyv2lzIrwASg838yKPQCF/tLzDMsNLPfjRIi37edBIFmH3EpSBgAnKv9uKFHt4Alp3blbDT4azf3IBDAAYBrAWvOa/Ed53xt+1I9u8VS9Wu3mCwHAFwLWNO5g32CyMsBAFYBis5ssw90jLuqZudZDAtYtUJB7wKAohJAWSv3cADoagRAqC82ZzKFA4CQASCoFrCudxv5KJHWAgCqBSxsV6dvAgCsAhQ27ZE3AQBVASrbdvGbAECYBFDauO9NAEAtApS27nwTAATTAtZ27nSWcpYCAKgC1LbvfhEAQBWguHGrs5anC60GgZaBi6/weBEAMBWgunPzewDAkEWA+t7tPhVfaEcIpgLU397wGgBAKgDA5Q1vAQCkAiDcW/0WACBWgQRgX63TBK4DAEAFEIST6m8BAKACXPVn+dgAeIUCEEavGmcpeBkAoCnAZfvK2W/lXA1cBQBoCiAwJ6vkHQAAUwDF6Van7wCAIinAXffi6W9F7wAAAa0EC9ThWueC/iIAYCAFUKiOtd6THYsAAEcBms3rdQPgyQrQbstG5S8kzqkFCACUJNB0d8Xc8fMGcA0AgCSBtq6Mc5FJrwAARBnQenXN1Ddzn+6lFQBwNvTTFcDemp/XBgDgtnCAJLDnEkuphaU+DwDlSWDfNbYz383N4EsAoDgJ7L7FmBfixhUAUKsAAzfZz0OnuPlnBQBIHcuyDHXb5HW4cQUAlCWBpmtrqdIG+tOjRQEgM6Jvmvxc2bYmQBwXAECBBWBj9A/i872BkyggID1aAACTLYA5+D/jXHiFkd8CrNAncGIS2BP87+n/+ZTZwABuXKFT6BQL8NlWvbO/vt4Q8ZxpFKAACwCAL641oa9+9+yP/NfdCv0Xq8j9G/Ia3LhAs2hp3nDzfb1RDxz4+yaF4Us1/hhoqqGAiF0SC9wX0BOi/12I8eP5N9I/nv+uzjicD0kbo1yhAN2/+jAATHrU8o4Vd4X0/yj+lkCGCz+xTaakQBvleQAQtPCfjnHFqnBI53T8HWEEzv5lFHBOjequBG8A3IWfu3LV6Rbwm6Ie1SqYVwj/VTikaGBINgDitf+eXKdfGSKet10IAIps/ZovqoXSaMMAPAAInfuLKEBssOX+t6atAGOmSqb6QIp5e/i1IF4k+le1gCwfyEHfAL8WJLW2j/3vmiMCGoRj+KUACVi5GQp+XzZ9Q8sEQoznH7REd4CBvRrzg39NAVJPANcYWOm2gO+NG9lAEM8Wk/OXQ3JGf+aGtA4AfgeC5gGB4wMTb6sljOAWuzn4DyD83NQTCQZJoOZwEYgray4MgL/BIPrfhqDWjiH93CnEEj5djxk+UOKczkMAcAGJkye7DiYzRCDQ7h5PBUDZWhjli0BubURfDgCvCeYEb2kgAO060ZJngjYALnwgJRMAfww1MjjWywLT7ZQkgCp0Yt3gK4IG3gWAjMWw5Iuk9P6Ps24A+ABAOSGKEoH25kN2ScG7koCcPJgz7bVp76EDAxsAARwoef7avPt41A5sAESIoKbJa8/m4yEM6MsAICkTlbNmV+/xg34MyMsAkLQpMutKUeqPWScGeAMgRAUpZX4N7jvtwcDbAJCzHHbdW5bjYWX6k9a84G0eMMcFStIA+zaef26o2gCw2GrvcpAmueyAoydNMXgfAML3hEiazdaQiN2LgbwOAMEu0FCK5zoC+PmXromANwBcAJBEn0WhinLhCN4HgEgXyJlOO+Hc0QkINgAco6Cp5VbKKdz+HwTv84BxLjD5VilNPHPyubv+vQCIMQGd+zA44C1jPfunMaTXLQVdDS0H0EgsAuacO+UXWoAIEzCw/YIiAPbKcE0BQBe1ju3C6yPbXbWb6wJ7hnZ0E6a6f2MTAIALNLA/uVOBWYeOtwb0Ti5L+PnDjYBZbQc2ADrX2MlG9OxMBeY1HnnpM3YBt8n7yW2SSDacbQcIaAJM4f/VjkU8ySBtB4hXCtLOgq+OpwKyHSCcCTAVfv7fjYlGEXBhIHbQkgGgzvD/2VyaR9eFaDtArFKQreyr1pnciqVsB1jkAtkRfmJzKBsImNBvZD92E2Bc9JFO48hbAAABIKPhv75boB8BWwBgTID5ZI10G7rrgtAWABQTYF7xlZGU7nJO0y4BQJgAc/h14IKWGwRsAYCoBJjDb6nsS8fuAN5ndwBMgNjv5hn9oSsEbAGoNQFHT/jt81KtCNDtAKsTQXtbhZ4Le40I2AJQDoAjI/x3P6VbAKBMQKD360fAFgAAExDo/Yy/JQ08bgEA0wCSYLTJ7X+wBQALADQ8IaWBANoCgG8CSFJ+Ta4NwBYAIBNAkoU32QKArwEkiYxzUX3aawDJj84M/0f/mcJtAEA0gGQ64rYATAEATQ1/JwK2AECYAIo14roFYKlEkLgAczsDRDEByjWsswUAQQNIefpv7oNgMIkgSQnqtgHA0ABKFWBD8rEzwEoN0Ozp10TANgB1GkAygX1bCNgCUKUBOmno7xGwM8CJAKAJvr8TAdsAlJgA5TLkbQNQ+Mg85TciYBuA2SaAtGTMeXcCwMgDykb8FAHbALy7CrENwLsRsOP/cgRsA/g+C7IN4EbANoAbAdsAbATs+L/2kW0ANwK2AXz1w4+L/z8CDADebzi4XHs84QAAAABJRU5ErkJggg==",IE=n9;var EE=`uniform sampler2D u_image;
uniform sampler2D u_watermarkTex;

varying vec2 v_texCoord;


void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 watermarkColor = texture2D(u_watermarkTex, v_texCoord);

  if (watermarkColor.r > 0.8) {
    gl_FragColor = mix(color, watermarkColor, 0.3);
  } else {
    gl_FragColor = color;
  }
}
`;var uv=class extends L.Filter{constructor(...t){super(...t);this._fragmentSource=EE}_applyWebGL(t,e,r,o=!1){let s=t.getContext(),{canvas:n}=s,a=this.getShaderForRenderer(t),l=e.getFrame(),c=this._watermarkCanvas;(!c||l.width!==c.width||l.height!==c.height)&&this._createWatermarkCanvas(l.width,l.height);let d=L.Texture.fromCanvas(this._watermarkCanvas),u=d.getBaseTexture();t.updateTexture(u),u.setGLUnit(1),t.setRenderTarget(r),o&&r.clear(),t.setShader(a);let m=t.getCurrentRenderTarget().getProjectionMatrix().toArray();a.setUniform("u_projMatrix",m),a.syncUniforms(),s.uniform1i(s.getUniformLocation(a.getProgram(),"u_watermarkTex"),1),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,e.getTexture()),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,u.getGLTextureForRenderer(t)),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),d.dispose()}_createWatermarkCanvas(t,e){let r=this._options.watermarkImage,o=z.createCanvas();o.width=t,o.height=e;let s=o.getContext("2d"),n,a,l,c,d;t>e?(n=t/r.width,l=(e-r.height*n)/2,a=0):(n=e/r.height,l=0,a=(t-r.width*n)/2),s.drawImage(r,0,0,r.width,r.height,a,l,r.width*n,r.height*n),this._watermarkCanvas=o,this._watermarkContext=s}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),l=this._options.watermarkImage;this._createWatermarkCanvas(s.width,s.height);let c=n.getImageData(0,0,s.width,s.height),d=this._watermarkContext.getImageData(0,0,s.width,s.height),u=new U,m=new U,p=new U;for(let f=0;f<s.width*s.height*4;f+=4)u.set(c.data[f]/255,c.data[f+1]/255,c.data[f+2]/255,c.data[f+3]/255),m.set(d.data[f]/255,d.data[f+1]/255,d.data[f+2]/255,d.data[f+3]/255),m.r>.8?p.copy(u.clone().mix(m,.3)):p.copy(u),c.data[f]=p.r*255,c.data[f+1]=p.g*255,c.data[f+2]=p.b*255,c.data[f+3]=p.a*255;a.putImageData(c,0,0)}};uv.prototype.availableOptions={watermarkImage:{type:g.OBJECT,required:!0}};var AE=uv;var sm=class extends Mt{constructor(...t){super(...t);V(this,"_applyWatermarkFilter",()=>(this._watermarkFilter||(this._watermarkFilter=new AE({watermarkImage:this._watermarkImage})),this._sprite.setFilters([this._watermarkFilter]),this._renderTexture.render(this._container),Promise.resolve()));V(this,"_loadWatermarkImage",()=>this._watermarkImage?Promise.resolve():new Promise((t,e)=>{this._watermarkImage=new Li,this._watermarkImage.onload=t,this._watermarkImage.src=IE}));this._watermarkFilter=null,this._watermarkImage=null}_render(t){return this._loadWatermarkImage().then(this._applyWatermarkFilter)}dispose(){this._watermarkFilter&&this._watermarkFilter.dispose(),super.dispose()}};sm.identifier="license-watermark";sm.prototype.availableOptions={};bt.Operations.LicenseWatermarkOperation=sm;var FE=sm;var OE=`/*!
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_controlPoint1;
uniform vec2 u_controlPoint2;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 vector = u_controlPoint2 - u_controlPoint1;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    float radius = smoothstep(0.0, 1.0,
      abs(
        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)
      )
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
      float percent = (t + offset - 0.5) / 30.0;
      float weight = 1.0 - abs(percent);
      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

      color += _sample * weight;
      total += weight;
    }

    gl_FragColor = color / total;
}
`;var{Vector2:Ys}=$,mv=class extends L.Filter{constructor(...t){super(...t);this._fragmentSource=OE,this._lastBlurRadius=null,this._lastControlPoint1=new Ys,this._lastControlPoint2=new Ys,this._blurFilter=new zi,this._blurredRenderTarget=new L.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new L.CanvasRenderTarget(100,100,1)}_applyCanvas(t,e,r,o=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(t,e,r,o);return}let s=e.getDimensions(),n=!r.getDimensions().equals(s);if(e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n){let l=new Ys(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(l);let c={blurRadius:this._options.blurRadius,texSize:s},d=(v,x,_)=>Math.min(Math.max(v,x),_),u=(v,x,_)=>{let D=d((_-v)/(x-v),0,1);return D*D*(3-2*D)},m=this._options.controlPoint2.clone().subtract(this._options.controlPoint1.clone()),{blurRadius:p}=this._options,f=(v,x)=>u(0,1,Math.abs(d(new Ys(v,x).subtract(this._options.controlPoint1).dot(m)/m.dot(m),0,1)))*p;this._blurFilter.set(c),this._blurFilter._applyCanvas(t,e,r,o,f),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(t,e,r,o=!1){let s=e.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(s);this._blurredRenderTarget.setPixelRatio(e.getPixelRatio()),this._blurredRenderTarget.resizeTo(e.getDimensions()),this._maskRenderTarget.setPixelRatio(e.getPixelRatio()),this._maskRenderTarget.resizeTo(e.getDimensions());let a=!this._lastControlPoint1.equals(this._options.controlPoint1)||!this._lastControlPoint2.equals(this._options.controlPoint2)||n,l=e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone()),l&&(this._blurImage(e,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(e,r)}_renderMask(){let t=this._maskRenderTarget.getCanvas(),e=this._maskRenderTarget.getContext(),r=new Ys(t.width,t.height),o=this._options.controlPoint1.clone().multiply(r),s=this._options.controlPoint2.clone().multiply(r),n=e.createLinearGradient(o.x,o.y,s.x,s.y);n.addColorStop(0,"#FFFFFF"),n.addColorStop(1,"#000000"),e.fillStyle=n,e.fillRect(0,0,t.width,t.height)}_applyMask(t,e){let r=e.getContext(),o=t.getCanvas(),s=t.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=s.getImageData(0,0,o.width,o.height),c=l.data,d=n.getImageData(0,0,o.width,o.height).data,u=a.getImageData(0,0,o.width,o.height).data,m;for(let p=0;p<o.width*o.height*4;p+=4)m=u[p]/255,c[p]=m*c[p]+(1-m)*d[p],c[p+1]=m*c[p+1]+(1-m)*d[p+1],c[p+2]=m*c[p+2]+(1-m)*d[p+2];r.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}};mv.prototype.availableOptions={blurRadius:{type:g.NUMBER,default:30,uniformType:N.FLOAT},controlPoint1:{type:g.VECTOR2,default:new Ys(0,.5),uniformType:N.FLOAT2},controlPoint2:{type:g.VECTOR2,default:new Ys(1,.5),uniformType:N.FLOAT2},delta:{type:g.VECTOR2,default:new Ys(1,1),uniformType:N.FLOAT2},texSize:{type:g.VECTOR2,default:new Ys(100,100),uniformType:N.FLOAT2}};var qf=mv;var{Vector2:Zf}=$,nm=class extends Mt{constructor(...t){super(...t);this._lastBlurRadius=this._options.blurRadius,this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone();let e={blurQuality:{type:g.STRING}};this._horizontalFilter=new qf({},e),this._verticalFilter=new qf({},e),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Zf(.5,.5)),this._verticalFilter.setDelta(new Zf(-.5,.5)),this._filter=new qf({},e)}rotate(t){let{controlPoint1:e}=this._options,{controlPoint2:r}=this._options;t===90?(e.flip(),e.x=1-e.x,r.flip(),r.x=1-r.x):t===-90&&(e.flip(),e.y=1-e.y,r.flip(),r.y=1-r.y),this.set({controlPoint1:e,controlPoint2:r})}flip(t){let{controlPoint1:e}=this._options,{controlPoint2:r}=this._options;switch(t){case"horizontal":e.x=1-e.x,r.x=1-r.x;break;case"vertical":e.y=1-e.y,r.y=1-r.y;break}this.set({controlPoint1:e,controlPoint2:r})}transform(t){let e={};["controlPoint1","controlPoint2"].forEach(r=>{let o=this.getOption(r);e[r]=t.applyToRelativePoint(o)}),["blurRadius"].forEach(r=>{let o=this.getOption(r);e[r]=t.applyToRelativeSize(o)}),this.set(e,!1)}_renderWebGL(t){return this._renderBlur(t)}_renderCanvas(t){return this._options.highQualityCanvasBlur?this._renderBlur(t):this._renderLQCanvasBlur(t)}_renderBlur(t){let e=t.getDimensions(),r=e.min(),{blurRadius:o,controlPoint1:s,controlPoint2:n}=this._options,a={blurRadius:o*r,controlPoint1:s.clone(),controlPoint2:n.clone(),texSize:e,blurQuality:"high"};return this._horizontalFilter.set(a),this._verticalFilter.set(a),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(t){let e=t.getDimensions(),{blurRadius:r,controlPoint1:o,controlPoint2:s}=this._options;return this._filter.set({blurRadius:r,controlPoint1:o.clone(),controlPoint2:s.clone(),texSize:e,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};nm.identifier="linear-focus";nm.prototype.availableOptions={controlPoint1:{type:g.VECTOR2,default:new Zf(0,.5)},controlPoint2:{type:g.VECTOR2,default:new Zf(1,.5)},blurRadius:{type:g.NUMBER,default:.025},highQualityCanvasBlur:{type:g.BOOLEAN,default:!1}};bt.Operations.LinearFocusOperation=nm;var RE=nm;var PE=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform float u_gradientSize;
uniform float u_size;
uniform vec2 u_start;
uniform vec2 u_end;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));
    float radius = smoothstep(0.0, 1.0,
      (abs(
        dot(v_texCoord * u_texSize - u_start, normal)
      ) - u_size) / u_gradientSize
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`;var{Vector2:Ks}=$,pv=class extends L.Filter{constructor(...t){super(...t);this._fragmentSource=PE,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastStart=new Ks,this._lastEnd=new Ks,this._blurFilter=new zi,this._blurredRenderTarget=new L.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new L.CanvasRenderTarget(100,100,1)}_applyCanvas(t,e,r,o=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(t,e,r,o);return}let s=e.getDimensions(),n=!r.getDimensions().equals(s);if(e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n){let l=new Ks(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(l);let c={blurRadius:this._options.blurRadius,texSize:s},d=(A,B,T)=>Math.min(Math.max(A,B),T),u=(A,B,T)=>{let F=d((T-A)/(B-A),0,1);return F*F*(3-2*F)},{blurRadius:m,gradientSize:p,size:f,start:v,end:x,texSize:_}=this._options,D=new Ks(v.y-x.y,x.x-v.x);D.divide(D.len());let k=(A,B)=>u(0,1,(Math.abs(_.clone().multiply(A,B).subtract(v).dot(D))-f)/p)*m;this._blurFilter.set(c),this._blurFilter._applyCanvas(t,e,r,o,k),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(t,e,r,o=!1){let s=e.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(s);this._blurredRenderTarget.setPixelRatio(e.getPixelRatio()),this._blurredRenderTarget.resizeTo(e.getDimensions()),this._maskRenderTarget.setPixelRatio(e.getPixelRatio()),this._maskRenderTarget.resizeTo(e.getDimensions());let a=!this._lastStart.equals(this._options.start)||!this._lastEnd.equals(this._options.end)||this._lastGradientRadius!==this._options.size||n,l=e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastStart=this._options.start.clone(),this._lastEnd=this._options.end.clone(),this._lastGradientRadius=this._options.size),l&&(this._blurImage(e,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(e,r)}_renderMask(){let t=this._maskRenderTarget.getCanvas(),e=this._maskRenderTarget.getContext(),r=this._maskRenderTarget.getPixelRatio(),o=new Ks(t.width,t.height),s=this._options.size*o.min()*r,n=this._options.gradientSize*o.min()*r,a=this._options.start.clone().multiply(o),c=this._options.end.clone().multiply(o).clone().subtract(a),d=a.clone().add(c.clone().divide(2)),u=c.len(),m=c.clone().divide(u),p=d.clone().add((s+n)*m.y,-(s+n)*m.x),f=d.clone().add(-(s+n)*m.y,(s+n)*m.x),v=e.createLinearGradient(p.x,p.y,f.x,f.y),x=f.clone().subtract(p).len();v.addColorStop(0,"#000000"),v.addColorStop(n/2/x,"#FFFFFF"),v.addColorStop(1-n/2/x,"#FFFFFF"),v.addColorStop(1,"#000000"),e.fillStyle=v,e.fillRect(0,0,t.width,t.height)}_applyMask(t,e){let r=e.getContext(),o=t.getCanvas(),s=t.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=s.getImageData(0,0,o.width,o.height),c=l.data,d=n.getImageData(0,0,o.width,o.height).data,u=a.getImageData(0,0,o.width,o.height).data,m;for(let p=0;p<o.width*o.height*4;p+=4)m=u[p]/255,c[p]=m*c[p]+(1-m)*d[p],c[p+1]=m*c[p+1]+(1-m)*d[p+1],c[p+2]=m*c[p+2]+(1-m)*d[p+2];r.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose()}};pv.prototype.availableOptions={blurRadius:{type:g.NUMBER,default:30,uniformType:N.FLOAT},size:{type:g.NUMBER,default:50,uniformType:N.FLOAT},gradientSize:{type:g.NUMBER,default:50,uniformType:N.FLOAT},start:{type:g.VECTOR2,default:new Ks(0,.5),uniformType:N.FLOAT2},end:{type:g.VECTOR2,default:new Ks(1,.5),uniformType:N.FLOAT2},delta:{type:g.VECTOR2,default:new Ks(1,1),uniformType:N.FLOAT2},texSize:{type:g.VECTOR2,default:new Ks(100,100),uniformType:N.FLOAT2}};var Jf=pv;var{Vector2:Qf}=$,am=class extends Mt{constructor(...t){super(...t);this._lastBlurRadius=this._options.blurRadius,this._lastSize=this._options.size,this._lastGradientSize=this._options.gradientSize;let e={blurQuality:{type:g.STRING}};this._horizontalFilter=new Jf({},e),this._verticalFilter=new Jf({},e),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Qf(.5,.5)),this._verticalFilter.setDelta(new Qf(-.5,.5)),this._filter=new Jf({},e),this._renderBlur.bind(this)}rotate(t){let{start:e}=this._options,{end:r}=this._options;t===90?(e.flip(),e.x=1-e.x,r.flip(),r.x=1-r.x):t===-90&&(e.flip(),e.y=1-e.y,r.flip(),r.y=1-r.y),this.set({start:e,end:r})}flip(t){let{start:e}=this._options,{end:r}=this._options;switch(t){case"horizontal":e.x=1-e.x,r.x=1-r.x;break;case"vertical":e.y=1-e.y,r.y=1-r.y;break}this.set({start:e,end:r})}transform(t){let e={};["start","end"].forEach(r=>{let o=this.getOption(r);e[r]=t.applyToRelativePoint(o)}),["blurRadius","size","gradientSize"].forEach(r=>{let o=this.getOption(r);e[r]=t.applyToRelativeSize(o)}),this.set(e,!1)}_renderWebGL(t){return this._renderBlur(t)}_renderCanvas(t){return this._options.highQualityCanvasBlur?this._renderBlur(t):this._renderLQCanvasBlur(t)}_renderBlur(t){let e=t.getDimensions(),r=e.min(),o=this._options.start.clone(),s=this._options.end.clone(),{blurRadius:n,size:a,gradientSize:l}=this._options,c={blurRadius:n*r,size:a*r,gradientSize:l*r,start:o.clone().multiply(e),end:s.clone().multiply(e),texSize:e,blurQuality:"high"};return this._horizontalFilter.set(c),this._verticalFilter.set(c),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(t){let e=t.getDimensions(),{blurRadius:r,size:o,gradientSize:s,start:n,end:a}=this._options;return this._filter.set({blurRadius:r,gradientSize:s,size:o,start:n.clone(),end:a.clone(),texSize:e,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};am.identifier="mirrored-focus";am.prototype.availableOptions={start:{type:g.VECTOR2,default:new Qf(0,.5)},end:{type:g.VECTOR2,default:new Qf(1,.5)},blurRadius:{type:g.NUMBER,default:.025},size:{type:g.NUMBER,default:.1},gradientSize:{type:g.NUMBER,default:.1},highQualityCanvasBlur:{type:g.BOOLEAN,default:!1}};bt.Operations.MirroredFocusOperation=am;var BE=am;var{Vector2:a9}=$,lm=class extends Mt{_render(t){let e=this._options.rotation%360,r=e*(Math.PI/180),o=e===90||e===270,s=this._options.flipHorizontally!==this._options.flipVertically,n=o&&s?!this._options.flipVertically:this._options.flipVertically,a=o&&s?!this._options.flipHorizontally:this._options.flipHorizontally;this._sprite.setScale(a?-1:1,n?-1:1),this._sprite.setRotation(r),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();let l=this._sprite.getBounds();return this._renderTexture.resizeTo(new a9(l.width,l.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round()),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(t){return t=t.clone(),this._options.rotation%180&&t.flip(),t}flip(t){let{rotation:e}=this._options;switch((e===90||e===270)&&(t==="vertical"?t="horizontal":t="vertical"),t){case"vertical":this.setFlipVertically(!this.getFlipVertically());break;case"horizontal":this.setFlipHorizontally(!this.getFlipHorizontally());break}}};lm.identifier="orientation";lm.prototype.availableOptions={rotation:{type:g.NUMBER,default:0,validation(i){if(i%90!=0)throw new Error("OrientationOperation: `rotation` has to be a multiple of 90.")},setter:i=>(i+360)%360},flipVertically:{type:g.BOOLEAN,default:!1},flipHorizontally:{type:g.BOOLEAN,default:!1}};bt.Operations.OrientationOperation=lm;var ME=lm;var{Vector2:tg}=$,cm=class extends Mt{constructor(...t){super(...t);this._flipContainer=new L.Container}_render(t){let{position:e,rotation:r,scale:o,pivot:s,outputResolution:n}=this._options,a=this._sdk.getTextureScale(),l=n.clone().multiply(a).ceil();return this._renderTexture.resizeTo(l),this._sprite.setRotation(r),this._sprite.setPosition(e),this._sprite.setPivot(s),this._sprite.setScale(o),this._renderTexture.render(this._container),Promise.resolve()}getNewDimensions(t){let e=this._sdk.getTextureScale();return this._options.outputResolution.clone().multiply(e).ceil()}};cm.identifier="output";cm.prototype.availableOptions={position:{type:g.VECTOR2,default:new tg(0,0)},rotation:{type:g.NUMBER,default:0},scale:{type:g.VECTOR2,default:new tg(1,1)},pivot:{type:g.VECTOR2,default:new tg(0,0)},outputResolution:{type:g.VECTOR2,default:new tg(100,100)}};bt.Operations.OutputOperation=cm;var LE=cm;var{OverlayFilter:eg}=L.Filters,{Vector2:zE}=$,l9=4,Lc=class extends Mt{constructor(...t){super(...t);this._overlayTexture=L.Texture.fromImage(this._options.image),this._overlayContainer=new L.Container,this._overlaySprite=new L.Sprite,this._overlaySprite.setTexture(this._overlayTexture),this._overlaySprite.setAnchor(0,0),this._overlayContainer.addChild(this._overlaySprite),this._overlayFilter=new L.Filters.OverlayFilter({overlayImage:this._overlayTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayTexture}),this._sprite.setFilters([this._overlayFilter]),this._renderedOverlaySprite=new L.Sprite,this._renderedOverlayContainer=new L.Container,this._renderedOverlayContainer.addChild(this._renderedOverlaySprite),this._overlayRendered=!1,this._lastInputDimensions=new zE(0,0)}setOption(t,e){if(super.setOption(t,e),t==="image"&&e&&this._sdk){let r=this._sdk.getRenderer(),o=this._overlayTexture.getBaseTexture();o.setSource(e),r.isOfType(gt.WEBGL)&&r.updateTexture(o),this._overlayRendered=!1}}_render(t){let e=t.getDimensions(),{image:r,alpha:o,blendMode:s}=this._options;return r?((!this._overlayRendered||!this._lastInputDimensions.equals(e))&&(this._renderOverlayToRenderTexture(t),this._overlayRendered=!0,this._lastInputDimensions.copy(e)),this._overlayFilter.set({blendMode:s,overlayImage:this._overlayRenderTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:o}),this._sprite.setFilters([this._overlayFilter]),this._renderTexture.render(this._container),Promise.resolve()):(this._sprite.setFilters([]),this._renderTexture.render(this._container),Promise.resolve())}_renderOverlayToRenderTexture(t){let e=this._sdk.getRenderer(),r=t.getDimensions();this._overlayRenderTexture||(this._overlayRenderTexture=new L.RenderTexture(e,r.x,r.y),this._renderedOverlaySprite.setTexture(this._overlayRenderTexture));let{width:o,height:s}=this._options.image,n=z.resizeVectorToFill(new zE(o,s),r),{flipHorizontally:a,flipVertically:l}=this._options,c=a?-1:1,d=l?-1:1;this._overlaySprite.setWidth(n.x*c),this._overlaySprite.setHeight(n.y*d),this._overlaySprite.setPosition(r.x*(1-c)*.5,r.y*(1-d)*.5);let u=this._overlayRenderTexture.getBaseTexture();this._overlayRenderTexture.resizeTo(r),e.isOfType(gt.WEBGL)&&(u.setGLUnit(l9),e.updateTexture(u,!1)),this._overlayRenderTexture.render(this._overlayContainer)}dispose(){super.dispose(),this._overlaySprite&&this._overlaySprite.dispose(),this._overlayRenderTexture&&this._renderedOverlaySprite.dispose(),this._overlayFilter&&this._overlayFilter.dispose(),this._overlayTexture&&this._overlayTexture.dispose(),this._overlayRenderTexture&&this._overlayRenderTexture.dispose(),this._renderedOverlaySprite&&this._renderedOverlaySprite.dispose()}};Lc.identifier="overlay";Lc.BLEND_MODES=eg.BLEND_MODES;Lc.prototype.availableOptions={identifier:{type:g.STRING},image:{type:g.IMAGE},blendMode:{type:g.NUMBER,default:eg.BLEND_MODES.MULTIPLY,available:Object.keys(eg.BLEND_MODES).map(i=>eg.BLEND_MODES[i])},alpha:{type:g.NUMBER,default:1},flipHorizontally:{type:g.BOOLEAN,default:!1},flipVertically:{type:g.BOOLEAN,default:!1}};bt.Operations.OverlayOperation=Lc;var UE=Lc;var NE=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_radius;
uniform float u_blurRadius;
uniform float u_gradientRadius;
uniform vec2 u_position;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

const float blurSteps = 30.0;
const float EPSILON = 0.000000001;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 coord = v_texCoord * u_texSize;
    vec2 diff = coord - u_position;
    float dist = sqrt(diff.x * diff.x + diff.y * diff.y);

    float blurPercentage = smoothstep( 
      0.0, 1.0,
      (abs(dist) - u_radius) / u_gradientRadius
    );

    float radius = blurPercentage * u_blurRadius;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    for (float t = -blurSteps; t <= blurSteps; t++) {
        float percent = (t + offset - 0.5) / blurSteps;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / max(total, EPSILON);
}
`;var{Vector2:zc}=$,hv=class extends L.Filter{constructor(...t){super(...t);this._fragmentSource=NE,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastPosition=new zc,this._blurFilter=new zi,this._blurredRenderTarget=new L.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new L.CanvasRenderTarget(100,100,1)}_applyCanvas(t,e,r,o=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(t,e,r,o);return}let s=e.getDimensions(),n=!r.getDimensions().equals(s),{blurRadius:a,position:l,texSize:c,gradientRadius:d}=this._options;if(e.getBaseTexture().isDirty()||this._lastBlurRadius!==a||n){let m=new zc(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(m);let p={blurRadius:a,texSize:s},f=(_,D,k)=>Math.min(Math.max(_,D),k),v=(_,D,k)=>{let A=f((k-_)/(D-_),0,1);return A*A*(3-2*A)},x=(_,D)=>v(0,1,(Math.abs(c.clone().multiply(_,D).subtract(l).len())-this._options.radius)/(d*2))*a;this._blurFilter.set(p),this._blurFilter._applyCanvas(t,e,r,o,x),this._lastBlurRadius=a}}_renderLQBlur(t,e,r,o=!1){let s=e.getDimensions(),n=!this._blurredRenderTarget.getDimensions().equals(s);this._blurredRenderTarget.setPixelRatio(e.getPixelRatio()),this._blurredRenderTarget.resizeTo(e.getDimensions()),this._maskRenderTarget.setPixelRatio(e.getPixelRatio()),this._maskRenderTarget.resizeTo(e.getDimensions());let a=!this._lastPosition.equals(this._options.position)||this._lastGradientRadius!==this._options.gradientRadius||n,l=e.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;a&&(this._renderMask(),this._lastPosition=this._options.position.clone(),this._lastGradientRadius=this._options.gradientRadius),l&&(this._blurImage(e,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(e,r)}_renderMask(){let t=this._maskRenderTarget.getCanvas(),e=this._maskRenderTarget.getContext(),r=new zc(t.width,t.height),o=this._maskRenderTarget.getPixelRatio(),s=this._options.position.clone().multiply(r),{radius:n,gradientRadius:a}=this._options;n*=t.height,a*=t.height;let l=e.createRadialGradient(s.x,s.y,0,s.x,s.y,(n+a)*o);l.addColorStop(0,"#FFFFFF"),l.addColorStop(n/(n+a),"#FFFFFF"),l.addColorStop(1,"#000000"),e.fillStyle=l,e.fillRect(0,0,r.x,r.y)}_applyMask(t,e){let r=e.getContext(),o=t.getCanvas(),s=t.getContext(),n=this._blurredRenderTarget.getContext(),a=this._maskRenderTarget.getContext(),l=s.getImageData(0,0,o.width,o.height),c=l.data,d=n.getImageData(0,0,o.width,o.height).data,u=a.getImageData(0,0,o.width,o.height).data,m;for(let p=0;p<o.width*o.height*4;p+=4)m=u[p]/255,c[p]=m*c[p]+(1-m)*d[p],c[p+1]=m*c[p+1]+(1-m)*d[p+1],c[p+2]=m*c[p+2]+(1-m)*d[p+2];r.putImageData(l,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}};hv.prototype.availableOptions={blurRadius:{type:g.NUMBER,default:30,uniformType:N.FLOAT},radius:{type:g.NUMBER,default:50,uniformType:N.FLOAT},gradientRadius:{type:g.NUMBER,default:25,uniformType:N.FLOAT},position:{type:g.VECTOR2,default:new zc(.5,.5),uniformType:N.FLOAT2},delta:{type:g.VECTOR2,default:new zc(1,1),uniformType:N.FLOAT2},texSize:{type:g.VECTOR2,default:new zc(100,100),uniformType:N.FLOAT2}};var ig=hv;var{Vector2:fv}=$,dm=class extends Mt{constructor(...t){super(...t);this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius;let e={blurQuality:{type:g.STRING}};this._horizontalFilter=new ig({},e),this._verticalFilter=new ig({},e),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new fv(.5,.5)),this._verticalFilter.setDelta(new fv(-.5,.5)),this._filter=new ig({},e)}rotate(t){let{position:e}=this._options;t===90?(e.flip(),e.x=1-e.x):t===-90&&(e.flip(),e.y=1-e.y),this.set({position:e})}flip(t){let{position:e}=this._options;switch(t){case"horizontal":e.x=1-e.x;break;case"vertical":e.y=1-e.y;break}this.set({position:e})}transform(t){let e={},r=this.getPosition();e.position=t.applyToRelativePoint(r),["radius","blurRadius","gradientRadius"].forEach(o=>{let s=this.getOption(o);e[o]=t.applyToRelativeSize(s)}),this.set(e,!1)}_renderWebGL(t){return this._renderBlur(t)}_renderCanvas(t){return this._options.highQualityCanvasBlur?this._renderBlur(t):this._renderLQCanvasBlur(t)}_renderBlur(t){let e=t.getDimensions(),r=e.min(),{position:o,blurRadius:s,radius:n,gradientRadius:a}=this._options,l={blurRadius:s*r,radius:n*r,gradientRadius:a*r,position:o.clone().multiply(e),texSize:e,blurQuality:"high"};return this._horizontalFilter.set(l),this._verticalFilter.set(l),this._renderTexture.render(this._container),Promise.resolve()}_renderLQCanvasBlur(t){let{blurRadius:e,radius:r,gradientRadius:o,position:s}=this._options,n=t.getDimensions();return this._filter.set({blurRadius:e,radius:r,gradientRadius:o,position:s,texSize:n,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}};dm.identifier="radial-focus";dm.prototype.availableOptions={position:{type:g.VECTOR2,default:new fv(.5,.5)},radius:{type:g.NUMBER,default:.25},gradientRadius:{type:g.NUMBER,default:.125},blurRadius:{type:g.NUMBER,default:.025},highQualityCanvasBlur:{type:g.BOOLEAN,default:!1}};bt.Operations.RadialFocusOperation=dm;var HE=dm;var WE=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filterImage;
uniform sampler2D u_maskImage;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filterImage, v_texCoord);
  vec4 mask = texture2D(u_maskImage, v_texCoord);
  gl_FragColor = mix(color0, color1, mask);
}
`;var gv=class extends L.Filter{constructor(){super();this._fragmentSource=WE}_applyCanvas(t,e,r,o=!1){let s=e.getCanvas(),n=e.getContext(),a=r.getContext(),{maskCanvas:l,filterCanvas:c}=this._options,d=l.getContext("2d"),u=c.getContext("2d"),m=d.getImageData(0,0,s.width,s.height).data,p=n.getImageData(0,0,s.width,s.height),f=p.data,v=u.getImageData(0,0,s.width,s.height).data,x;for(let _=0;_<s.width*s.height*4;_+=4)x=m[_]/255,f[_]=x*v[_]+(1-x)*f[_],f[_+1]=x*v[_+1]+(1-x)*f[_+1],f[_+2]=x*v[_+2]+(1-x)*f[_+2];a.putImageData(p,0,0)}};gv.prototype.availableOptions={maskImage:{type:g.NUMBER,default:1,uniformType:N.INT},maskCanvas:{type:g.OBJECT,default:null},filterImage:{type:g.NUMBER,default:2,uniformType:N.INT},filterCanvas:{type:g.OBJECT,default:null}};var GE=gv;var{Vector2:rg}=$,VE=class extends Ct{constructor(t,e){super(e);this._isDisposed=!1,this._operation=t,this._dirtiness={},this.id=z.getUUID(),this._renderTextures={},this._identitySprite=new L.Sprite,this._sprite=new L.Sprite,this._hitTestSprite=new L.Sprite,this._renderers=[]}applyScale(t){}applyRotation(t){let e=this._operation.getInputDimensions(),r=this.getRotation()*180/Math.PI;r+=t,this.setRotation(r*Math.PI/180);let s=(t+360)%360*Math.PI/180,n=Math.cos(s),a=Math.sin(s),l=this._options.position.clone().subtract(.5).multiply(e),c=new rg(l.x*n-l.y*a,l.x*a+l.y*n).divide(e.clone().flip());this.setPosition(new rg(.5,.5).add(c))}applyFlip(t){let e=this.getPosition().clone();switch(t){case"horizontal":e.x=1-this._options.position.x;break;case"vertical":e.y=1-this._options.position.y;break}this.setPosition(e)}applyTransform(t){let e={};e.rotation=t.applyToRotation(this.getRotation()),e.position=t.applyToRelativePoint(this.getPosition()),this._options.dimensions&&(e.dimensions=t.applyToDimensions(this.getDimensions())),this.set(e,!1)}getDisplayObject(){return this._sprite}getHitTestDisplayObject(){return this._sprite}_getTexture(){throw new Error("Sprite#_getTexture is abstract and not implemented in child class.")}_prepareRenderTexture(t){if(this._renderTexture)this._renderTexture.clear();else{let e=this._getTexture();this._renderTextureContainer=new L.Container,this._renderTextureSprite=new L.Sprite(e),this._renderTextureContainer.addChild(this._renderTextureSprite),this._renderTexture=this._getRenderTexture(t.getRenderer(),e.getDimensions())}}_rendersToRenderTexture(t){return t.getOptions().smoothDownscaling&&t.getRenderer().isOfType(gt.WEBGL)}_optionEquals(t,e){return t==="type"?!0:super._optionEquals(t,e)}update(t,e){this._isDisposed||(this._rendersToRenderTexture(t)&&(this._prepareRenderTexture(t),this._renderToRenderTexture(t)),this._updateSprite(e))}_updateSprite(t){[this._sprite,this._hitTestSprite].forEach(r=>{if(!r.getTexture())return;r.setAnchor(this._options.anchor),r.setPosition(this._options.position.clone().multiply(t)),typeof this._options.alpha!="undefined"&&r.setAlpha(this._options.alpha);let{dimensions:o}=this._options;o&&(o=o.clone().multiply(this._operation.getSDK().getTextureScale()),r.setWidth(o.x),r.setHeight(o.y)),r.updateTransform();let s=r.getTexture().getFrame(),n=new rg(s.width,s.height);r.setPivot(this._options.pivot.clone().multiply(n)),r.setRotation(this._options.rotation),r.updateTransform()})}_renderToRenderTexture(t){let e=this._getTexture().getDimensions(),r=this._getRenderTexture(t.getRenderer(),e),o=e.clone();if(this._options.smoothDownscaling&&(o.x=z.nextHighestPOT(o.x),o.y=z.nextHighestPOT(o.y)),this._renderTexture.resizeTo(o),this._renderTexture.render(this._renderTextureContainer),this._options.smoothDownscaling){let s=o.clone().subtract(e.x,e.y).divide(o),n=r.getUVs().getUVs();n[0].x=n[3].x=0,n[1].x=n[2].x=1-s.x,n[0].y=n[1].y=0,n[2].y=n[3].y=1-s.y}this._sprite.setTexture(r)}isDirtyForRenderer(t){return t.id in this._dirtiness||(this._dirtiness[t.id]=!0),this._dirtiness[t.id]}setDirtyForRenderer(t,e){this._renderers[e.id]=e,this._dirtiness[e.id]=t}setDirty(t){for(let e in this._dirtiness)this.setDirtyForRenderer(t,this._renderers[e])}_getRenderTexture(t,e=new rg(100,100)){return this._renderTextures[t.id]||(this._renderTextures[t.id]=new L.RenderTexture(t,e.x,e.y,1)),this._renderTextures[t.id]}dispose(){this._isDisposed=!0;for(let t in this._renderTextures)this._renderTextures[t].dispose()}canBeDuplicated(){return!0}canBeDeleted(){return!0}canMaskCanvas(){return!1}canAdjustPadding(){return!1}canBeTakenToFront(){return!0}canBeFlippedHorizontally(){return!0}},No=VE;var{Vector2:c9}=$,og=class extends Ct{constructor(...t){super(...t);this._lastOptions={},this._lastInputDimensions=new c9(0,0),this._brush=null}getBrushImage(t){if(this._brush&&this.optionsEqual(this._lastOptions)&&t.equals(this._lastInputDimensions))return this._brush;let{image:e,size:r}=this._options;e.width=e.height=Math.ceil(r*t.min());let o=z.createCanvas();o.width=e.width,o.height=e.height;let s=o.getContext("2d");s.drawImage(e,0,0,o.width,o.height);let n=this._tintImageData(s.getImageData(0,0,o.width,o.height),o.width,o.height);return s.putImageData(n,0,0),this._lastOptions=this.serializeOptions(["size","color"]),this._brush=o,this._lastInputDimensions=t.clone(),o}_tintImageData(t){let{color:e}=this._options;for(let r=0;r<t.data.length;r+=4)t.data[r]+=(e.r*255-t.data[r])*e.a,t.data[r+1]+=(e.g*255-t.data[r+1])*e.a,t.data[r+2]+=(e.b*255-t.data[r+2])*e.a;return t}clone(){let t=this.constructor;return new t(this._options)}},um=og;og.prototype.availableOptions={identifier:{type:g.STRING},image:{type:g.IMAGE},size:{type:g.NUMBER,default:.05},color:{type:g.COLOR,default:U.RED}};var mm=class extends um{getBrushImage(t){if(this._brush&&this.optionsEqual(this._lastOptions)&&t.equals(this._lastInputDimensions))return this._brush;let{size:e,hardness:r,color:o}=this._options,s=z.createCanvas();s.width=s.height=Math.ceil(e*t.min());let n=s.getContext("2d");if(o=o.clone(),o.a=1,s.width===1)n.fillStyle=o.toRGBA(),n.fillRect(0,0,1,1);else{let a=n.createRadialGradient(s.width/2,s.height/2,Math.min(s.width/2-1,s.width/2*r),s.width/2,s.height/2,s.width/2);a.addColorStop(0,o.toRGBA());let l=o.clone();l.a=0,a.addColorStop(1,l.toRGBA()),n.fillStyle=a,n.fillRect(0,0,s.width,s.height)}return this._lastOptions=this.serializeOptions(["size","color","hardness"]),this._brush=s,this._lastInputDimensions=t.clone(),s}},bv=mm;mm.identifier="imgly_brush_radial";mm.prototype.availableOptions=b(b({},um.prototype.availableOptions),{hardness:{type:g.NUMBER,default:1}});var{Vector2:d9,CubicBezierCurve:u9}=$,jE=class{constructor(t,e,r=3){this._path=t,this._drawnCanvases=[],this._position=e,this._smooth=r}getBezierCurve(t,e,r,o){if(!e)return null;let s,n;o?(s=(o.x-e.x)/this._smooth,n=(o.y-e.y)/this._smooth):(s=(r.x-e.x)/this._smooth,n=(r.y-e.y)/this._smooth);let a,l;t?(a=(r.x-t.x)/this._smooth,l=(r.y-t.y)/this._smooth):(a=(r.x-e.x)/this._smooth,l=(r.y-e.y)/this._smooth);let c=e.clone().add(a,l),d=r.clone().subtract(s,n);return new u9(e,c,d,r)}renderToCanvas(t,e,r,o,s,n=1){if(this._drawnCanvases.indexOf(e)!==-1)return;let a=new d9(e.width,e.height),l=e.getContext("2d"),c=this._position.clone().multiply(a),d=o?o.getPosition().clone().multiply(a):null,u=r?r.getPosition().clone().multiply(a):null,m=s?s.getPosition().clone().multiply(a):null,p=c.clone().subtract(d).len(),f=t.width/10,v=this.getBezierCurve(u,d,c,m),x;if(!v)x=[c];else{v.calculateSegments(20);let _=v.getLength();x=v.arcLengthApproxSample(Math.ceil(_/f))}for(let _=0;_<x.length;_++){let D=x[_],k=t.width*.5/(f*2);k*=1-n,k=1/(1+k),l.globalAlpha=k,l.drawImage(t,D.x-t.width/2,D.y-t.height/2,t.width,t.height)}l.globalAlpha=1,this._drawnCanvases.push(e)}setPosition(t){this._position=t}getPosition(){return this._position.clone()}setDirty(){this._drawnCanvases=[]}},$E=jE;var _v=class extends Ct{constructor(t,e,r){super(e);this._operation=t,this._canvas=r||z.createCanvas(),this._context=this._canvas.getContext("2d")}serializeOption(t,e=!1){return t==="controlPoints"?this._options.controlPoints.map(r=>{let o=r.getPosition();return e?o.toObject():o.clone()}):super.serializeOption(t,e)}_optionEquals(t,e){if(t==="controlPoints"){let{controlPoints:r}=this._options;for(let o=0,s=r.length;o<s;o++)if(!r[o].getPosition().equals(e[o]))return!1;return!0}return super._optionEquals(t,e)}render(t){let{controlPoints:e,size:r}=this._options;if(e.length<2)return;let o=this.getBrush(),s=o&&o.getHardness?o.getHardness():1;z.ensureCanvasDimensions(this._canvas,t),(!this._brush||this._lastBrushSize!==r||!t.equals(this._brushInputDimensions))&&(this._brushInputDimensions=t.clone(),this._lastBrushSize=r);let n,a,l,c;for(let d=0;d<e.length;d++)n=e[d-2],a=e[d-1],l=e[d],c=e[d+1],l.renderToCanvas(this._options.brush.getBrushImage(t),this._canvas,n,a,c,s)}_createBrush(t){let{size:e,hardness:r,color:o}=this._options,s=z.createCanvas();s.width=s.height=Math.ceil(e*t.min());let n=s.getContext("2d");if(o=o.clone(),o.a=1,s.width===1)n.fillStyle=o.toRGBA(),n.fillRect(0,0,1,1);else{let a=n.createRadialGradient(s.width/2,s.height/2,Math.min(s.width/2-1,s.width/2*r),s.width/2,s.height/2,s.width/2);a.addColorStop(0,o.toRGBA());let l=o.clone();l.a=0,a.addColorStop(1,l.toRGBA()),n.fillStyle=a,n.fillRect(0,0,s.width,s.height)}return s}addControlPoint(t){let e=new $E(this,t);this._options.controlPoints.push(e),this.emit("update",this)}getCanvas(){return this._canvas}setCanvas(t){this._canvas=t,this._context=t.getContext("2d")}setDirty(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._options.controlPoints.forEach(t=>{t.setDirty()})}forEachControlPoint(t){this._options.controlPoints.forEach(t)}renderToCanvas(t){let e=t.getContext("2d");e.save(),e.globalAlpha=this._options.brush.getColor().a,e.drawImage(this._canvas,0,0),e.restore()}getCanvasDimensions(){return this._canvasDimensions}};_v.prototype.availableOptions={id:{type:g.STRING,default:()=>z.getUUID()},brush:{type:g.OBJECT,required:!0},controlPoints:{type:g.ARRAY,default:[]},closed:{type:g.BOOLEAN,default:!1}};var pm=_v;var{Vector2:sg}=$,ll=class extends No{constructor(...t){super(...t);this._persistedPaths=[],this._outputCanvasDirty=!0,this._outputCanvas=z.createCanvas(),this._outputContext=this._outputCanvas.getContext("2d"),this._persistCanvas=z.createCanvas(),this._persistContext=this._persistCanvas.getContext("2d"),this._nextCanvas=z.createCanvas(),this._texture=L.Texture.fromCanvas(this._outputCanvas),this._sprite.setTexture(this._texture),this._onPathUpdate=this._onPathUpdate.bind(this)}applyFlip(t){this._options.paths.forEach(e=>{e.forEachControlPoint(r=>{let o=r.getPosition().clone();switch(t){case"horizontal":o.x=1-o.x;break;case"vertical":o.y=1-o.y;break}r.setPosition(o)}),e.setDirty(!0)}),this._reset()}applyRotation(t){this._options.paths.forEach(e=>{e.forEachControlPoint(r=>{let o=r.getPosition().clone();t===90?(o.flip(),o.x=1-o.x):t===-90&&(o.flip(),o.y=1-o.y),r.setPosition(o)}),e.setDirty(!0)}),this._reset()}applyTransform(t){let e=null;this._options.paths.forEach(r=>{r.forEachControlPoint(s=>{s.setPosition(t.applyToRelativePoint(s.getPosition()))});let o=r.getBrush();o!==e&&(o.setSize(t.applyToRelativeSize(o.getSize())),e=o),r.setDirty(!0)}),this._reset()}clearCanvas(){if(!this._outputCanvas)return;this._outputCanvasDirty=!0;let{width:t,height:e}=this._outputCanvas;this._outputContext.clearRect(0,0,t,e)}clearPersistCanvas(){if(!this._persistCanvas)return;let{width:t,height:e}=this._persistCanvas;this._persistContext.clearRect(0,0,t,e)}serializeOptions(t,e=!1){let r=super.serializeOptions(t,e);return t||(r.type="brush"),r}serializeOption(t,e=!1){return t==="paths"?this._options.paths.map(r=>r.serializeOptions(void 0,e)):super.serializeOption(t,e)}createPath(t){let e=new pm(this._operation,{brush:t},this._nextCanvas);return e.on("update",this._onPathUpdate),this._options.paths.push(e),this.setDirty(!0),e}_onPathUpdate(){this._operation.setDirty(!0),this.setDirty(!0)}_onPathPersist(t){t.renderToCanvas(this._persistCanvas),this._nextCanvas=t.getCanvas(),this._nextCanvas.getContext("2d").clearRect(0,0,this._nextCanvas.width,this._nextCanvas.height),this._persistedPaths.push(t)}_getTexture(){return this._texture}setDirtyForRenderer(t,e,r=!1){super.setDirtyForRenderer(t,e,r),t&&r&&(this._persistedPaths=[],this.clearPersistCanvas(),this._options.paths.forEach(o=>{o.setDirty(!0)}))}setDirty(t,e=!1){for(let r in this._dirtiness)this.setDirtyForRenderer(t,this._renderers[r],e)}render(t){let e=this._operation.getSDK().getRenderer();!this.isDirtyForRenderer(e)||(z.ensureCanvasDimensions(this._outputCanvas,t),z.ensureCanvasDimensions(this._persistCanvas,t),this._options.paths.forEach(r=>{r.render(t),r.getClosed()&&this._persistedPaths.indexOf(r)===-1&&this._onPathPersist(r)}),this.clearCanvas(),this._outputContext.drawImage(this._persistCanvas,0,0),this._options.paths.forEach(r=>{r.getClosed()||r.renderToCanvas(this._outputCanvas)}),this.setDirtyForRenderer(!1,e))}update(t,e){e&&(z.ensureCanvasDimensions(this._outputCanvas,e),z.ensureCanvasDimensions(this._persistCanvas,e),this._texture.getBaseTexture().update()),this.render(e);let r=t.getRenderer();r.isOfType(gt.WEBGL)&&r.updateTexture(this._texture.getBaseTexture()),super.update(t,e)}_reset(){this._persistedPaths=[],this._operation&&this._operation.setDirty(!0),this.setDirty(!0),this.clearCanvas(),this.clearPersistCanvas()}getCanvas(){return this._outputCanvas}_createRadialBrush(){return new bv}_getTempCanvas(){return this._nextCanvas}dispose(){super.dispose(),this._texture&&this._texture.getBaseTexture().dispose()}};ll.prototype.availableOptions={id:{type:g.STRING,default:()=>z.getUUID()},position:{type:g.VECTOR2,default:new sg(0,0)},scale:{type:g.VECTOR2,default:new sg(1,1)},anchor:{type:g.VECTOR2,default:new sg(0,0)},pivot:{type:g.VECTOR2,default:new sg(0,0)},rotation:{type:g.NUMBER,default:0},paths:{type:g.ARRAY,default:[],setter(i){return i=i.map(t=>{if(t instanceof pm)return t;let{brush:e,closed:r}=t,o=new pm(this._operation,{brush:e,closed:r},this._nextCanvas);return t.controlPoints.forEach(s=>{o.addControlPoint(s)}),o}),this._reset(),i}}};ll.type="brush";ll.Brush=um;ll.Path=pm;ll.Brushes={RadialBrush:bv};var cl=ll;var{Vector2:YE}=$,hm=class extends Mt{constructor(...t){super(...t);let e=this._sdk.getRenderer();this._lastBlurRadius=null,this._blurredRenderTexture=new L.RenderTexture(e,100,100,1),this._maskRenderTexture=new L.RenderTexture(e,100,100,1),this._brushSprite=new cl(this),this._brushSpriteContainer=new L.Container;let r=this._brushSprite.getDisplayObject();if(this._brushSpriteContainer.addChild(r),this._outputSprite=new L.Sprite,this._outputContainer=new L.Container,this._outputContainer.addChild(this._outputSprite),this._maskFilter=new GE,e.isOfType(gt.WEBGL)){this._horizontalFilter=new zi,this._verticalFilter=new zi,this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new YE(1,1)),this._verticalFilter.setDelta(new YE(-1,1));let o=this._maskRenderTexture.getBaseTexture();o.setGLUnit(this._maskFilter.getMaskImage()),e.updateTexture(o,!1),o=this._blurredRenderTexture.getBaseTexture(),o.setGLUnit(this._maskFilter.getFilterImage()),e.updateTexture(o,!1)}else e.isOfType(gt.CANVAS)&&(this._blurFilter=new zi,this._sprite.setFilters([this._blurFilter]),this._maskFilter.setMaskCanvas(this._maskRenderTexture.getRenderTarget().getCanvas()),this._maskFilter.setFilterCanvas(this._blurredRenderTexture.getRenderTarget().getCanvas()));this._outputSprite.setFilters([this._maskFilter])}flip(t){this._brushSprite.applyFlip(t),this.setDirty(!0,!0),this._lastBlurRadius=null}rotate(t){this._brushSprite.applyRotation(t),this.setDirty(!0,!0),this._lastBlurRadius=null}transform(t,e){this._brushSprite.applyTransform(t,e),this.setDirty(!0,!0),this._lastBlurRadius=null}_render(t){return this._renderBlur(t),this._renderMask(t),this._outputSprite.setTexture(t),this._renderTexture.render(this._outputContainer),Promise.resolve()}_renderMask(t){let e=t.getDimensions();this._maskRenderTexture.getDimensions().equals(e)||this._maskRenderTexture.resizeTo(e),this._brushSprite.update(this._sdk,e),this._maskRenderTexture.clear(U.BLACK),this._maskRenderTexture.render(this._brushSpriteContainer);let o=this._sdk.getRenderer();o.isOfType(gt.WEBGL)&&o.updateTexture(this._maskRenderTexture.getBaseTexture(),!1)}_renderBlur(t){let e=t.getDimensions(),r=this._blurredRenderTexture.getDimensions();r.equals(e)||this._blurredRenderTexture.resizeTo(e);let{blurRadius:o}=this._options;if(this._lastBlurRadius!==o||!r.equals(e)){let n=this._sdk.getRenderer(),a;if(n.isOfType(gt.WEBGL)){let l=e.min();a={blurRadius:o*l,texSize:e},this._horizontalFilter.set(a),this._verticalFilter.set(a)}else n.isOfType(gt.CANVAS)&&(a={blurRadius:o},this._blurFilter.set(a));this._blurredRenderTexture.render(this._container),this._lastBlurRadius=o}let s=this._sdk.getRenderer();s.isOfType(gt.WEBGL)&&s.updateTexture(this._blurredRenderTexture.getBaseTexture(),!1)}getBrush(){return this._brushSprite}createPath(t,e=1){let r=new cl.Brushes.RadialBrush({size:t,hardness:e,color:U.WHITE}),o=this._brushSprite.createPath(r);return this._options.paths.push(o),this.setDirty(!0),o}setDirtyForRenderer(t,e,r){super.setDirtyForRenderer(t,e,r),this._brushSprite.setDirtyForRenderer(t,e,r)}dispose(){super.dispose(),this._sdk.getRenderer().isOfType(gt.WEBGL)?(this._verticalFilter.dispose(),this._horizontalFilter.dispose()):this._blurFilter.dispose(),this._brushSprite.dispose(),this._maskFilter.dispose(),this._blurredRenderTexture.dispose(),this._maskRenderTexture.dispose()}hasChanges(){return!0}};hm.identifier="selective-blur";hm.prototype.availableOptions={blurRadius:{type:g.NUMBER,default:.05},paths:{type:g.ARRAY,default:[],setter(i){return this._brushSprite&&this._brushSprite.setPaths(i),i}}};bt.Operations.SelectiveBlurOperation=hm;var KE=hm;var{Vector2:dl,ColorMatrix:ng}=$,ag=class extends No{constructor(...t){super(...t);let{image:e}=this._options,r=e.src||e.filePath||e.toDataUrl&&e.toDataURL();this._isSVG=r&&(!!r.match(/\w+\.svg(?=\?|$)/i)||r.match(/data:image\/svg/i)),this._isSVG&&(this._canvas=z.createCanvas(),this._context=this._canvas.getContext("2d"),this._options.smoothDownscaling=!1),e&&this._onImageUpdate(),this._tintFilter=new L.Filters.TintFilter,this._adjustmentsFilter=new wf,this._lastRenderedDimensions=dl.NULL,this._lastRenderedInputDimensions=dl.NULL,this._onOptionsChange=this._onOptionsChange.bind(this),this._options.adjustments.on("update",this._onOptionsChange)}applyScale(t){this.setDimensions(this.getDimensions().multiply(t))}serializeOptions(t,e=!1){let r=super.serializeOptions(t,e);return t||(r.type="sticker"),r}_rendersToRenderTexture(t){return this._options.smoothDownscaling&&!this._isSVG&&t.getRenderer().isOfType(gt.WEBGL)||this._hasAdjustments()||this._options.tintMode!=="none"}_getTexture(){return this._inputTexture}update(t,e){let{dimensions:r,image:o}=this._options;if(r.equals(dl.NULL)&&r.set(o.width,o.height),this._sprite.setSmoothDownscaling(this._isSVG?!1:this.getSmoothDownscaling()),(!this._lastRenderedInputDimensions.equals(e)||!this._lastRenderedDimensions.equals(r)||this._lastRenderedImage!==o)&&this._isSVG&&t.getRenderer().isOfType(gt.WEBGL)){o.width=Math.round(r.x),o.height=Math.round(r.y);let a=4096,l=o.width/o.height;o.width>a&&(o.width=a,o.height=Math.round(o.width/l)),o.height>a&&(o.height=a,o.width=Math.round(o.height*l)),this._canvas.width=o.width,this._canvas.height=o.height,this._context.clearRect(0,0,o.width,o.height),this._context.drawImage(o,0,0,o.width,o.height),this._inputTexture.getBaseTexture().update()}this._rendersToRenderTexture(t)&&this._prepareRenderTexture(t);let n=[];if(this._rendersToRenderTexture(t)){if(this._hasAdjustments()){n.push(this._adjustmentsFilter);let{adjustments:a}=this._options,l=new ng;l.multiply(ng.createBrightnessMatrix(a.getBrightness())),l.multiply(ng.createSaturationMatrix(a.getSaturation())),l.multiply(ng.createContrastMatrix(a.getContrast())),this._adjustmentsFilter.set({colorMatrix:l})}this._options.tintMode&&this._options.tintMode!=="none"&&(n.push(this._tintFilter),this._tintFilter.set({mode:L.Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],color:this._options.tintColor}),this._sprite.getTexture()&&this._sprite.getTexture()._baseTexture&&this._sprite.getTexture()._baseTexture.setDirty(!0)),this._renderTextureSprite.setFilters(n)}this._rendersToRenderTexture(t)?this._renderToRenderTexture(t):this._sprite.setTexture(this._inputTexture),this._updateSprite(e),this._applyFlip(),this._lastRenderedDimensions.copy(r),this._lastRenderedInputDimensions.copy(e),this._lastRenderedImage=o}_applyFlip(){let t=this._sprite.getScale(),{flipHorizontally:e,flipVertically:r}=this._options;(e&&t.x>0||!e&&t.x<0)&&(t.x*=-1),(r&&t.y>0||!r&&t.y<0)&&(t.y*=-1),this._sprite.setScale(t)}applyFlip(t){super.applyFlip(t);let e={rotation:this._options.rotation},o=e.rotation/Math.PI*180*-1;switch(e.rotation=o*Math.PI/180,t){case"horizontal":e.flipHorizontally=!this._options.flipHorizontally,this.set(e);break;case"vertical":e.flipVertically=!this._options.flipVertically,this.set(e);break}}_hasAdjustments(){let{adjustments:t}=this._options;return t.getBrightness()!==0||t.getSaturation()!==1||t.getContrast()!==1}_onImageUpdate(){let t=this._options.image,e=this._operation.getSDK().getRenderer();this._isSVG&&e.isOfType(gt.WEBGL)&&(t=this._canvas),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._inputTexture=L.Texture.fromImage(t),this._identitySprite.setTexture(this._inputTexture),this._sprite.setTexture(this._inputTexture),this._renderTexture&&(this._renderTextureSprite.setTexture(this._inputTexture),this._renderTexture.resizeTo(this._inputTexture.getDimensions())),this.setDirty(!0)}scalesUniformly(){return this._options.resizeMode==="keepAspect"}setOption(t,e,r=!0){super.setOption(t,e,r),t==="image"&&this._identitySprite&&this._onImageUpdate()}_onOptionsChange(){let t=this._dirtiness;for(let e in t)t[e]=!0}dispose(){super.dispose(),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._tintFilter.dispose(),this._adjustmentsFilter.dispose(),this._options.adjustments.off("updated",this._onOptionsChange)}};ag.prototype.availableOptions={id:{type:g.STRING,default:()=>z.getUUID()},identifier:{type:g.STRING,default:""},image:{type:g.IMAGE,required:!0},position:{type:g.VECTOR2,default:dl.NULL},dimensions:{type:g.VECTOR2,default:dl.NULL},anchor:{type:g.VECTOR2,default:new dl(0,0)},pivot:{type:g.VECTOR2,default:new dl(.5,.5)},rotation:{type:g.NUMBER,default:0},flipHorizontally:{type:g.BOOLEAN,default:!1},flipVertically:{type:g.BOOLEAN,default:!1},smoothDownscaling:{type:g.BOOLEAN,default:!1},tintColor:{type:g.COLOR,default:U.WHITE},tintMode:{type:g.STRING,default:"none",available:["none","solid","colorized"]},resizeMode:{type:g.STRING,default:"keepAspect",available:["keepAspect","unrestricted"]},alpha:{type:g.NUMBER,default:1},adjustments:{type:g.CONFIGURABLE,structure:{brightness:{type:g.NUMBER,default:0},saturation:{type:g.NUMBER,default:1},contrast:{type:g.NUMBER,default:1}}}};ag.type="sticker";var lg=ag;var Ho=class{constructor(t){this._seed=t===void 0?Ho.TimeSeed():t}seed(t){this._seed=t===void 0?Ho.TimeSeed():t}next(){let t=this._seed|0,e=t/Ho.SEED_DIVIDER|0,r=t%Ho.SEED_DIVIDER|0;return t=Ho.SEED_LOW_MULTIPLY*r-Ho.SEED_HIGH_MULTIPLY*e,t<=0&&(t+=Ho.MAX),t===-1&&(t=Ho.MAX-1),this._seed=t,t}nextInRange(t,e){return e===void 0&&(e=t,t=0),t+this.next()%(e-t+1)}nextBool(t=1,e=1){return this.nextInRange(t+e-1)>=t}static TimeSeed(){return Date.now()}pickNext(t){return Array.isArray(t)?t[this.next()%t.length]:null}},Ft=Ho;V(Ft,"MAX",2147483647),V(Ft,"SEED_DIVIDER",127773),V(Ft,"SEED_LOW_MULTIPLY",16807),V(Ft,"SEED_HIGH_MULTIPLY",2836);var{Rectangle:m9}=$,he=class{constructor(t=0,e=0){this.width=t,this.height=e}set(t,e){this.width=t,this.height=e}aspect(){return this.width/this.height}rectangle(t,e){return new m9(t,e,this.width,this.height)}clone(){return new he(this.width,this.height)}scale(t,e){return e===void 0&&(e=t),this.width*=t,this.height*=e,this}copy(t){return this.width=t.width,this.height=t.height,this}fitInWidthWithOther(t,e=new he){return this.copy(he.fitTwoInWidth(t,this,e)[0]),this}static fitTwoInWidth(t,e,r){let o=e.width*r.height+e.height*r.width,s=r.height*t/o,n=e.width*s,a=e.height*s;return[new he(n,a),new he(t-n,a)]}};var nA=y(cg()),xv=class extends Ct{loadImages(t){return K(this,null,function*(){return nA.default(t,e=>K(this,null,function*(){return this.addImage(e.path,e.fullPath,e.image)}))})}addImage(t,e,r,o="anonymous"){let s=this.getImages();return r?(s[t]={fullPath:e,image:r},Promise.resolve({fullPath:e,image:r})):new Promise((n,a)=>{r=new Li,r.onload=()=>{s[t]={fullPath:e,image:r},n({fullPath:e,image:r})},r.crossOrigin=z.getCrossOriginValue(o),r.onerror=a,r.src=e})}getImage(t){let r=this.getImages()[t];return r?r.image:null}getVariation(t){return this.getFonts()[t]}addFont(t,e){let r=this.getFonts();return r[t]=e,e}};xv.prototype.availableOptions={images:{type:g.OBJECT,default:{}},fonts:{type:g.OBJECT,default:{}}};var Wt=new xv;var y9=(i,t,e,r)=>{let o=e*(r*4)+t*4;return{r:i[o],g:i[o+1],b:i[o+2],a:i[o+3]}},x9=i=>i.a<=254,aA=(i,t,e)=>{let r=!0;for(let o=0;o<e;o++){let s=y9(i,o,t,e);if(!x9(s)){r=!1;break}}return r},v9=(i,t,e,r,o=!1)=>{let s=0;for(let n=r+1;n<e;n++)if(!aA(i,n,t))s=n-r+1;else if(o)break;return s},C9=(i,t,e,r,o=!1)=>{let s=0;for(let n=r-1;n>=0;n--)if(!aA(i,n,t))s=r-n;else if(o)break;return s},S9=(i,t,e,r,o)=>{i.beginPath(),i.moveTo(t,e),i.lineTo(r,o),i.stroke()},w9=(i,t,e,r,o="red")=>{i.save(),i.strokeStyle=o,S9(i,e,t,r,t),i.restore()},k9=(i,t,e,r,o,s="blue")=>{i.save(),i.strokeStyle=s,i.strokeRect(t,e,r,o),i.restore()},Ti=class extends Ct{constructor(t){super(t);let e=Wt.getVariation(this.getFontIdentifier());e||j.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.set({fontVariation:e}),this._metrics=null,this._canvas=z.createCanvas(),this._context=this._canvas.getContext("2d"),this._isDirty=!0}_onOptionsChange(){this._isDirty=!0}setOption(t,e,r=!0,o=!1){super.setOption(t,e,r,o),t==="fontIdentifier"&&!o&&this.updateFontVariation()}updateFontVariation(){let t=Wt.getVariation(this.getFontIdentifier());return t||j.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(t),t}setOptions(t={}){this._options=b(b({},this._options),t),this._isDirty=!0}_applyTextOptions(t=this._context,e={}){let{fontSize:r,fontVariation:o,lineHeight:s,textColor:n,alignment:a}=b(b({},this._options),e),{fontStyle:l,fontWeight:c,fontFamily:d}=o.serializeOptions();t.font=`${l} ${c} ${r}px / ${s} ${d}`,t.fillStyle=n,t.textBaseline="alphabetic",t.textAlign=a||"left"}getTextMetrics(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),b({},this._metrics)}getSizeValue(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),new he(this._metrics.width,this._metrics.height)}fitWidth(t){if(!this.getFontVariation()){j.warn("TextDesignFont#fitText: missing font variation");return}this._applyTextOptions(this._context,{fontSize:50});let r=this._context.measureText(this.getText()).width,o=t/r,s=Math.floor(o*50);return this.setFontSize(s),this._calculateTextMetrics(),this.getTextMetrics()}fitHeight(t){if(!this.getFontVariation()){j.warn("TextDesignFont#fitText: missing font variation");return}let r=this._calculateTextMetrics({fontSize:50}).height,o=t/r,s=Math.floor(o*50);return this.setFontSize(s),this._calculateTextMetrics(),this.getTextMetrics()}_calculateTextMetrics(t={}){let e=this._canvas,r=this._context,o=b(b({},this._options),t),s=this.getText();this._applyTextOptions(r,o);let n=Math.ceil(r.measureText(s).width),a=Math.floor(n+o.fontSize*2),l=Math.floor(o.fontSize*3);e.width=a,e.height=l;let c=Math.floor(o.fontSize),d=Math.floor(l*(3/5));this._applyTextOptions(r,o),r.fillText(s,c,d);let u=r.getImageData(0,0,e.width,e.height).data,m=C9(u,a,l,d,this._options.excludeAccents),p=v9(u,a,l,d,this._options.excludeAccents),f=n,v=m+p;return this._metrics={width:f,height:v,ascender:m,descender:p},this._isDirty=!1,b({},this._metrics)}draw(t=this._context,e=0,r=0,o,s=!1){t.save(),(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),this._applyTextOptions(t,o),t.fillText(this.getText(),e,r+this._metrics.ascender),s&&(k9(t,e,r,this._metrics.width,this._metrics.height),w9(t,r+this._metrics.ascender,e,e+this._metrics.width)),t.restore()}};Ti.prototype.availableOptions={text:{type:g.STRING,default:""},fontIdentifier:{type:g.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:g.OBJECT,default:null},lineHeight:{type:g.NUMBER,default:1},fontSize:{type:g.NUMBER,default:22},textColor:{type:g.STRING,default:"black"},strokeStyle:{type:g.STRING,default:"black"},outlineWidth:{type:g.NUMBER,default:0},textBaseline:{type:g.STRING,default:"alphabetic"},excludeAccents:{type:g.BOOLEAN,default:!1}};var Di=class extends Ct{};Di.prototype.availableOptions={text:{type:g.STRING,default:""},frame:{type:g.OBJECT,default:null},font:{type:g.OBJECT,default:null}};var Mr=class extends Ct{};Mr.prototype.availableOptions={tintColor:{type:g.COLOR,default:U.BLACK},textColor:{type:g.COLOR,default:U.BLACK},alignment:{type:g.STRING,default:"left",available:["left","center","right"]},lineSpacing:{type:g.NUMBER,default:1},fontIdentifier:{type:g.STRING,default:"imgly_font_open_sans_bold"}};var{Rectangle:T9}=$,Hi=class extends Ct{constructor(t){super(t);this.setSize(new he(this.getWidth(),0)),this.serverImageSmoothingFix=!1}_getFrame(){let t=this.getSize();return new T9(0,0,t.width,t.height)}_getTextFrame(){return this._getFrame()}_getTextFrameForElement(t){return t.getFrame().clone()}_calculateLayoutElements(){j.warn("TextDesignRow is an abstract class.")}_getLayoutElements(){return this._options.elements.length<=0&&this.layout(),this.getElements()}_fontSize(t){return j.warn("TextDesignRow#_fontSize not implemented. @TODO: Is it necessary?"),0}layout(){return this.setElements(this._calculateLayoutElements()),this}textFrame(t,e){return t.getFrame().clone()}willRender(t){}didRender(t){}render(t){t.save(),this._getLayoutElements().forEach(e=>{let{text:r,frame:o,font:s}=e.serializeOptions(),n=this.getAttributes();s.draw(t,o.x,o.y,{textColor:n.getTextColor().toRGBA(),alignment:n.getAlignment()})}),t.restore()}};Hi.prototype.availableOptions={words:{type:g.OBJECT,default:null},width:{type:g.NUMBER,default:100},attributes:{type:g.CONFIGURABLE,default:new Mr},shearingAngle:{type:g.NUMBER,default:0},elements:{type:g.ARRAY,default:[]},size:{type:g.OBJECT,default:null}};var{Rectangle:D9}=$,fm=class extends Hi{_calculateLayoutElements(){if(this.getWords().size()<=0)return[];let{orientation:t,width:e,size:r,relativeRowOffset:o,attributes:s}=this.serializeOptions(),{fontIdentifier:n}=s,a=this.getWords().joined(3),l=t===fm.Orientations.Left?[a[0],a[1],a[2]]:[a[1],a[2],a[0]],c=z.Array.range(0,2).map(ht=>new Ti({text:l[ht],fontIdentifier:n,fontSize:60})),d=c.map(ht=>ht.getSizeValue()),u=d[0].width>d[1].width?0:1,m=(u+1)%2;c[m].fitWidth(d[u].width),d[m]=c[m].getSizeValue();let p=(d[m].height+d[u].height)/(1-o),f=new Ti({text:l[2],fontIdentifier:n});f.fitHeight(p);let v=f.getSizeValue().width,x=d[u].width,_=e/(v+x),D=_*v,k=_*x,A=_*p,B=o*A;r.set(e,A);let T=z.Array.range(0,3).map(ht=>new Ti({text:l[ht],fontIdentifier:n}));T[0].fitWidth(k),T[1].fitWidth(k),T[2].fitWidth(D);let F=t===fm.Orientations.Left?0:D,q=t===fm.Orientations.Left?k:0,Z=[F,F,q],pt=[0,T[0].getSizeValue().height+B,0],xt=T.map((ht,ut)=>new D9(Z[ut],pt[ut],ht.getSizeValue().width,ht.getSizeValue().height));return T.map((ht,ut)=>new Di({text:l[ut],font:T[ut],frame:xt[ut]}))}},oo=fm;V(oo,"Orientations",{Right:"RIGHT",Left:"LEFT"});oo.prototype.availableOptions=b(b({},Hi.prototype.availableOptions),{orientation:{type:g.STRING,default:oo.Orientations.Left,available:[oo.Orientations.Right,oo.Orientations.Left]},relativeRowOffset:{type:g.NUMBER,default:.05}});var{Rectangle:I9}=$,kt=class{constructor(t=0,e=0,r=0,o=0){this.top=t,this.left=e,this.bottom=r,this.right=o}multiply(t){this.top*=t,this.left*=t,this.bottom*=t,this.right*=t}toObject(){return b({},this)}equals(t,e=0){return Math.abs(t.top-this.top)<=e&&Math.abs(t.left-this.left)<=e&&Math.abs(t.bottom-this.bottom)<=e&&Math.abs(t.right-this.right)<=e}scale(t=1,e){return e===void 0&&(e=t),this.top*=e,this.bottom*=e,this.left*=t,this.right*=t,this}clone(){return new kt(this.top,this.left,this.bottom,this.right)}applyToRectangle(t){return new I9(t.x+this.left,t.y+this.top,t.width-this.left-this.right,t.height-this.top-this.bottom)}static get ZERO(){return new kt(0,0,0,0)}};var xe=class extends Hi{_calculateLayoutElements(){let{attributes:t,imageInsets:e,size:r,width:o}=this.serializeOptions(),s=this.getWords().joined(1)[0]||"",{fontIdentifier:n}=t,a=new Ti({text:s,fontIdentifier:n});a.fitWidth(this._getTextFrame().width);let l=a.getTextMetrics().height+e.top+e.bottom;r.height=l;let c=this._getTextFrame();return[new Di({text:s,frame:c,font:a})]}};xe.prototype.availableOptions=b(b({},Hi.prototype.availableOptions),{imageInsets:{type:g.OBJECT,default:new kt}});var{Rectangle:Xs,Vector2:mi}=$,vv=(i,t,e,r)=>{i.drawImage(t,e.x,e.y,e.width,e.height,r.x,r.y,r.width,r.height)},Lr=(i,t,e,r="source-over",o=!1)=>{i.save(),i.fillStyle=e.toRGBA(),i.globalCompositeOperation=r,i.fillRect(t.x,t.y,t.width,t.height),o&&(i.strokeStyle=e.toRGBA(),i.strokeWith=1,i.strokeRect(t.x,t.y,t.width,t.height)),i.restore()},dg=(i,t,e,r,o="source-over",s=!1)=>{i.save(),i.fillStyle=r.toRGBA(),i.globalCompositeOperation=o,e=Math.min(Math.max(e,0),Math.min(t.height,t.width)*.5);let n=t.x,a=t.x+t.width,l=t.y,c=t.y+t.height;i.beginPath(),i.moveTo(n+e,l),i.arcTo(a,l,a,c,e),i.arcTo(a,c,n,c,e),i.arcTo(n,c,n,l,e),i.arcTo(n,l,a,l,e),i.closePath(),i.fill(),s&&i.stroke(),i.restore()},Uc=(i,t,e,r=4)=>{i.save(),i.strokeStyle=e.toRGBA(),i.lineWidth=r,i.strokeRect(t.x,t.y,t.width,t.height),i.restore()},Cv=(i,t,e,r="source-over")=>{i.save();let o=t.height/2,s=t.y+o,n=t.x+o,a=t.x+t.width;for(i.fillStyle=e.toRGBA(),i.globalCompositeOperation=r;n<a;)i.beginPath(),i.arc(n,s,o,0,2*Math.PI),i.fill(),n+=o*4;i.restore()},lA=(i,t)=>{let e=t.applyToRectangle(i),{x:r,y:o,width:s,height:n}=i,a=[Xs.FromDiagonalPoints(new mi(0,0),new mi(e.x,e.y)),Xs.FromDiagonalPoints(new mi(0,e.y+e.height),new mi(e.x,n)),Xs.FromDiagonalPoints(new mi(e.x+e.width,e.y+e.height),new mi(s,n)),Xs.FromDiagonalPoints(new mi(e.x+e.width,0),new mi(s,e.y))].map(c=>c.translate(r,o)),l=[Xs.FromDiagonalPoints(new mi(e.x,0),new mi(e.x+e.width,e.y)),Xs.FromDiagonalPoints(new mi(0,e.y),new mi(e.x,e.y+e.height)),Xs.FromDiagonalPoints(new mi(e.x,e.y+e.height),new mi(e.x+e.width,n)),Xs.FromDiagonalPoints(new mi(e.x+e.width,e.y),new mi(s,e.y+e.height))].map(c=>c.translate(r,o));return{corners:a,bars:l,center:e}},cA=(i,t,e,r)=>{let o=t.naturalWidth||t.width,s=t.naturalHeight||t.height,n=lA(new Xs(0,0,o,s),r),a=lA(e,r);vv(i,t,n.center,a.center),z.Array.zip(n.corners,a.corners).forEach(([l,c])=>vv(i,t,l,c)),z.Array.zip(n.bars,a.bars).forEach(([l,c])=>vv(i,t,l,c))},qs=(i,t,e,r,o="source-atop")=>{if(i.save(),r&&(i.globalAlpha=r.a),i.drawImage(t,e.x,e.y,e.width,e.height),r&&(i.globalAlpha=1),r){let s=r.clone();s.a=1,Lr(i,e,s,o)}i.restore()};var Zs=class extends xe{_getTextColor(){return this.getAutoAdjustTextColor()&&!this.getIsMasked()?this.getBackgroundColor().equals(U.WHITE)?U.BLACK:U.WHITE:this.getAttributes().getTextColor().clone()}_getTextFrame(){return this.getImageInsets().applyToRectangle(this._getFrame())}_getTextFrameForElement(t){let e=super._getTextFrameForElement(t),r=this.getImageInsets();return(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&(e.y-=r.top),e}willRender(t){this.getAttributes().setTextColor(this._getTextColor());let r=this.getImage();if(r){let o=this.getCapInsets(),s=this._getFrame();o&&!o.equals(kt.ZERO)?cA(t,r,s,o):t.drawImage(r,s.x,s.y,s.width,s.height),Lr(t,s,this.getBackgroundColor(),"source-atop",!0)}(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&r&&(t.save(),t.globalCompositeOperation="destination-out")}didRender(t){super.didRender(t),(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&t.restore()}};Zs.prototype.availableOptions=b(b({},xe.prototype.availableOptions),{image:{type:g.IMAGE,default:null},capInsets:{type:g.OBJECT,default:new kt},backgroundColor:{type:g.COLOR,default:U.WHITE},autoAdjustTextColor:{type:g.BOOLEAN,default:!0},isMasked:{type:g.BOOLEAN,default:!0},isUsedInInvertedLayout:{type:g.BOOLEAN,default:!1}});var dr=class extends Ct{insetsForWidth(t){return this.getRelativeInsets().clone().scale(t)}static get Small(){return new dr({imagePath:"text-design/images/imgly_text_design_asset_banderole_small.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new kt(.05,.2,.05,.2)})}static get Rectangle(){return new dr({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new kt(.05,.05,.05,.05),needsImageSmoothingFix:!0})}static get Celebrate1(){return new dr({imagePath:"text-design/images/imgly_text_design_asset_celebrate_01.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new kt(.05,.2,.05,.2)})}static get Celebrate2(){return new dr({imagePath:"text-design/images/imgly_text_design_asset_celebrate_02.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new kt(.05,.2,.05,.2)})}};dr.prototype.availableOptions={image:{type:g.IMAGE,default:null},imagePath:{type:g.STRING,default:null},relativeInsets:{type:g.OBJECT,default:new kt},fontIdentifier:{type:g.STRING,default:"imgly_font_open_sans_bold"},needsImageSmoothingFix:{type:g.BOOLEAN,default:!1}};var ug=class extends Ct{getSize(){let t=this.getRows(),e=this.getWidth(),r=t.length-1,o=t.reduce((n,a)=>n+a.getSize().height,0);o+=(r+1)*this.getRelativeLineSpacing()*e;let s=this.getRelativeInsets().clone().scale(e);return o+=s.top+s.bottom,new he(e,o)}};ug.prototype.availableOptions={text:{type:g.STRING,default:""},lines:{type:g.ARRAY,default:[]},relativeInsets:{type:g.OBJECT,default:new kt},relativeLineSpacing:{type:g.NUMBER,default:0},rows:{type:g.OBJECT,default:[]},background:{type:g.OBJECT,default:null},width:{type:g.NUMBER,default:0}};var ci=class{constructor(t){this.words=[],t&&this.splitIntoWords(t)}splitIntoWords(t){return this.words=t.match(/\S+/g)||[],[...this.words]}get(){return[...this.words]}getWord(t){return this.words[t]}set(t){return this.words=[...t],this}slice(t,e){return ci.fromWords(this.words.slice(t,e))}getLowerCase(){return this.words.map(t=>t.toLowerCase())}getUpperCase(){return this.words.map(t=>t.toUpperCase())}size(){return this.words.length}countNumberOfCharacters(){return this.words.reduce((t,e)=>t+e.length,0)}joined(t){let e=this.size(),r=Math.floor(e/t),o=e%t,s=0,n=0;return z.Array.range(0,t).map(a=>{s=n;let l=r+(a<o?1:0);return n=Math.min(s+l,e),z.Array.range(s,n).reduce((c,d)=>c+(d===s?"":" ")+this.words[d],"")})}static fromWords(t){let e=new ci;return e.words=[...t],e}};var E9=10,A9=4,F9=.4,je=class extends Ct{constructor(t){super(t);this._relativeInsets=new kt,this._background=null,this._fontRandomizer=new Ft(0),this._lineNumberRandomizer=new Ft(0),this._wordsPerLineRandomizer=new Ft(0),this._seedPool=[this._fontRandomizer,this._lineNumberRandomizer,this._wordsPerLineRandomizer]}seed(t){this._seedPool.forEach(e=>e.seed(t))}getImagePaths(){return[]}onImagesLoaded(){}getMaximumNumberOfTries(){return E9}getMinLineCountOfRandom(){return A9}getRandomAdditionalLinePercentage(){return F9}_fontForRow(t,e){return this._fontRandomizer.pickNext(this.getFontIdentifiers())}_modifiedText(t){return t.replace(`
`," ").replace("	"," ")}_minimumNumberOfLines(t){return Math.ceil(Math.sqrt(t.size()))}_maximumNumberOfLines(t){return t.size()}_calculatedNumberOfLines(t){let e=this._minimumNumberOfLines(t);if(t.size()>=this.getMinLineCountOfRandom()){let r=Math.floor(Math.max(1,e*this.getRandomAdditionalLinePercentage()));e+=this._lineNumberRandomizer.nextInRange(0,r)}return Math.min(e,this._maximumNumberOfLines(t))}_randomizedNumberOfWordsPerLine(t,e){if(t>e)return j.warn("TextDesign#_randomizedNumberOfWordsPerLine: Invalid number of lines"),e;let r=z.Array.repeat(1,t);return z.Array.range(t,e).forEach(o=>{let s=this._wordsPerLineRandomizer.nextInRange(0,t-1);r[s]+=1}),r}_textLines(t){let e=new ci(t),r=this._calculatedNumberOfLines(e);return this._randomizedNumberOfWordsPerLine(r,e.size()).reduce((s,n)=>({index:s.index+n,lines:[...s.lines,e.slice(s.index,Math.min(s.index+n,e.size()))]}),{index:0,lines:[]}).lines}_validTextLines(t){let e=this._textLines(t),r=0;do if(r=z.Array.findIndex(e,o=>o.countNumberOfCharacters()<3),r>=0){let o=e[r-1],s=e[r+1],n=o?o.countNumberOfCharacters():Number.MAX_SAFE_INTEGER,a=s?s.countNumberOfCharacters():Number.MAX_SAFE_INTEGER;n<a&&o?(o.words=[...o.words,...e[r].words],e=[...e.slice(0,r),...e.slice(r+1)]):s&&(s.words=[...e[r].words,...s.words],e=[...e.slice(0,r),...e.slice(r+1)])}while(r>-1&&e.length>1);return e}_modifiedLines(t){return t}_getBackground(){return this._background}generateLayoutData(t,e){let r=this._modifiedText(t),o=this._modifiedLines(this._validTextLines(r)),s=e*(1-this._relativeInsets.left-this._relativeInsets.right),n=this._layoutRows(o,s);return new ug({text:r,relativeInsets:this._relativeInsets.clone(),relativeLineSpacing:this.getRelativeLineSpacing(),background:this._background||this._getBackground(),lines:o,rows:n,width:e})}_layoutRows(t,e){return t.map((r,o)=>this._randomLayoutRow(r,o,e,new Mr({fontIdentifier:this._fontForRow(o,r)})).layout())}_randomLayoutRow(t,e,r,o){return new xe({words:t,width:r,attributes:o})}};V(je,"defaultFontIdentifiers",[]),V(je,"identifier","textdesign");je.prototype.availableOptions={fontIdentifiers:{type:g.ARRAY,default:[]},relativeLineSpacing:{type:g.NUMBER,default:0}};var ti=class extends je{constructor(...t){super(...t);V(this,"getImagePaths",()=>{let t=this.getBanderoles();return t&&t.map(e=>e.getImagePath())||[]});V(this,"onImagesLoaded",()=>{let t=this.getBanderoles();t&&t.forEach(e=>{let r=Wt.getImage(e.getImagePath());if(!r){j.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${e.getImagePath()}'`);return}e.setImage(r)})});this._rowTypeLessThan3WordsRandomizer=new Ft(0),this._rowTypeMoreThan3WordsRandomizer=new Ft(0),this._banderolesRandomizer=new Ft(0),this._seedPool=[...this._seedPool,this._rowTypeLessThan3WordsRandomizer,this._rowTypeMoreThan3WordsRandomizer,this._banderolesRandomizer]}_modifiedText(t){return super._modifiedText(t).toUpperCase()}generateLayoutData(t,e){return this._options.hasMaskedText=!1,super.generateLayoutData(t,e)}_randomLayoutRow(t,e,r,o){if(t.size()<3){let n=this._rowTypeLessThan3WordsRandomizer.nextInRange(0,2)===0;return this._layoutRow(t,r,o,n)}let s=this._rowTypeMoreThan3WordsRandomizer.nextInRange(0,3);switch(s){case 0:return new oo({words:t,width:r,attributes:o,orientation:oo.Orientations.Left});case 1:return new oo({words:t,width:r,attributes:o,orientation:oo.Orientations.Right});case 2:return this._layoutRow(t,r,o,!0);case 3:return new xe({words:t,width:r,attributes:o});default:throw new Error(`TextDesignBlocks#_randomLayoutRow: Invalid randomValue generated: ${s}.`)}}_layoutRow(t,e,r,o){if(this.getHasMaskedText()&&(o=!1),o){this.setHasMaskedText(!0);let s=this._banderolesRandomizer.pickNext(this.getBanderoles()),n=new Zs({words:t,width:e,attributes:new Mr({alignment:"left",fontIdentifier:s.getFontIdentifier()}),image:s.getImage(),imageInsets:s.insetsForWidth(e),capInsets:null,backgroundColor:U.WHITE});return s.getNeedsImageSmoothingFix()&&(n.serverImageSmoothingFix=!0),n}return new xe({words:t,width:e,attributes:r})}};V(ti,"defaultFontIdentifiers",["imgly_font_campton_bold"]),V(ti,"identifier","imgly_text_design_blocks"),V(ti,"defaultBanderoles",[dr.Rectangle,dr.Small]);ti.prototype.availableOptions=b(b({},je.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:ti.defaultFontIdentifiers},relativeLineSpacing:{type:g.NUMBER,default:.025/3},hasMaskedText:{type:g.BOOLEAN,default:!1},banderoles:{type:g.ARRAY,default:ti.defaultBanderoles}});var ul=class extends ti{constructor(...t){super(...t);this._exclusiveFont=null}generateLayoutData(t,e){return this._exclusiveFont=this._fontRandomizer.pickNext(this.getFontIdentifiers()),super.generateLayoutData(t,e)}_fontForRow(t,e){return this._exclusiveFont||super._fontForRow(t,e)}_layoutRow(t,e,r,o){return new xe({words:t,width:e,attributes:r})}};V(ul,"defaultFontIdentifiers",["imgly_font_ostrich_sans_heavy","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_black"]),V(ul,"identifier","imgly_text_design_blocks_condensed");ul.prototype.availableOptions=b(b({},ti.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:ul.defaultFontIdentifiers}});var{Rectangle:gm}=$,aa=class extends Hi{constructor(...t){super(...t);this.setSize(new he(this.getWidth(),this.getHeight()))}_calculateLayoutElements(){return[new Di({frame:this._getTextFrame()})]}render(t){let e=this._getFrame(),r=this.getType(),s=this.getAttributes().getTextColor(),n=e.height/3,a=new gm(e.x,e.y,e.width,n),l=new gm(e.x,e.y+n*2,e.width,n);switch(r){case aa.FormType.Rect:Lr(t,e,s);break;case aa.FormType.DoubleRect:Lr(t,a,s),Lr(t,l,s);break;case aa.FormType.DoubleRectFirstPunctuated:Cv(t,a,s),Lr(t,l,s);break;case aa.FormType.DoubleRectSecondPunctuated:Lr(t,a,s),Cv(t,l,s);break;case aa.FormType.LongLine:{let c=e.height/2,d=new gm(e.x,e.y,e.width,c);dg(t,d,d.height*.5,s);break}case aa.FormType.LongAndShortLine:{let c=e.height*.2,d=c*.75;a=new gm(e.x,e.y+c,e.width,c);let u=e.x+e.width*.25,m=e.y+e.height-d;l=new gm(u,m,e.width*.5,d),dg(t,a,a.height*.5,s),dg(t,l,l.height*.5,s);break}default:break}}},Wi=aa;V(Wi,"FormType",{Rect:"RECT",DoubleRect:"DOUBLE_RECT",DoubleRectFirstPunctuated:"DOUBLE_RECT_FIRST_PUNCTUATED",DoubleRectSecondPunctuated:"DOUBLE_RECT_SECOND_PUNCTUATED",LongLine:"LONG_LINE",LongAndShortLine:"LONG_AND_SHORT_LINE"});Wi.prototype.availableOptions=b(b({},Hi.prototype.availableOptions),{height:{type:g.NUMBER,default:100},type:{type:g.STRING,default:Wi.FormType.Rect,available:z.values(Wi.FormType)}});var Wo=class extends ti{_layoutRow(t,e,r,o){return new xe({words:t,width:e,attributes:r})}_layoutRows(t,e){let r=super._layoutRows(t,e),o=.032*e,s=.08*e,n=new Wi({width:e,height:o,type:Wi.FormType.LongLine,shearingAngle:0}).layout(),a=new Wi({width:e,height:s,type:Wi.FormType.LongAndShortLine,shearingAngle:0}).layout();return[n,...r,a]}};V(Wo,"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]),V(Wo,"identifier","imgly_text_design_blocks_light");Wo.prototype.availableOptions=b(b({},ti.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:Wo.defaultFontIdentifiers}});var ml=class extends Wo{_layoutRows(t,e){return t.map((r,o)=>this._randomLayoutRow(r,o,e,new Mr({fontIdentifier:this._fontForRow(o,r)})).layout())}_layoutRow(t,e,r,o){return new xe({words:t,width:e,attributes:r})}};V(ml,"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]),V(ml,"identifier","imgly_text_design_blocks_light-v3_1_0");ml.prototype.availableOptions=b(b({},Wo.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:ml.defaultFontIdentifiers}});var{Rectangle:O9}=$,mg=class extends xe{getImageSize(){let t=this.getLeftImage(),e=this.getRightImage(),r=this.getWords(),s=this.getAttributes().getFontIdentifier(),n=t?new he(t.width,t.height):new he,a=r.joined(1)[0];if(!a)return n;let c=new Ti({text:a,fontIdentifier:s,fontSize:50}).getSizeValue(),d=e?2:1;n.scale(d,1);let u=n.clone().fitInWidthWithOther(this._getFrame().width,c);return u.scale(1/d,1),u}_getTextFrame(){let t=super._getTextFrame().clone(),e=this.getImageSize(),r=this.getRightImage(),o=this.getImagePosition();return r?(t.x+=e.width,t.width-=2*e.width):o===mg.ImagePosition.Left&&(t.x+=e.width),t}_calculateLayoutElements(){let t=super._calculateLayoutElements(),e=this._getFrame(),r=this.getRightImage(),o=this.getImageSize(),s=this.getImagePosition(),n=this._getTextFrame(),l=this.getAttributes().getFontIdentifier(),c=new Ti({text:"stickerClock",fontIdentifier:l});c.fitWidth(this._getTextFrame().width);let d=new O9().set(e.x,e.y,o.width,o.height);if(!r&&s===mg.ImagePosition.Right&&(d.x+=n.width),t.push(new Di({text:"stickerClock",frame:d,font:c})),r){let u=t[0];if(u){let m=d.clone();m.translate(u.getFrame().width+m.width,0),t.push(new Di({text:"stickerClock",frame:m,font:c}))}}return t}render(t){let e=this._getLayoutElements(),r=this.getAttributes(),o=r.getTextColor(),s=this.getLeftImage(),n=this.getRightImage(),a=e[0],l=e[1],{font:c}=a.serializeOptions(),d=this._getTextFrameForElement(a);if(c.draw(t,d.x,d.y,{textColor:r.getTextColor().toRGBA(),alignment:r.getAlignment()}),s){let u=l.getFrame();t.drawImage(s,u.x,u.y,u.width,u.height),Lr(t,u,o,"source-atop")}if(e.length>2){let m=e[2].getFrame().clone();t.drawImage(n,m.x,m.y,m.width,m.height),Lr(t,m,o,"source-atop")}}},Go=mg;V(Go,"ImagePosition",{Left:"LEFT",right:"RIGHT"});Go.prototype.availableOptions=b(b({},xe.prototype.availableOptions),{leftImage:{type:g.IMAGE,default:null},rightImage:{type:g.IMAGE,default:null},imagePosition:{type:g.STRING,default:Go.ImagePosition.Left,available:[Go.ImagePosition.Left,Go.ImagePosition.Right]}});var bm=class extends ti{_fontForRow(t,e){let r=this.getFontIdentifiers();return r[t%r.length]}_minimumNumberOfLines(t){return Math.max(Math.floor(super._minimumNumberOfLines(t)*.7),1)}_maximumNumberOfLines(t){return Math.max(Math.floor(t.countNumberOfCharacters()/5),1)}_randomLayoutRow(t,e,r,o){return this._createSingleRow(bm.RowType.Single,t,r,o)}_createSingleRow(t,e,r,o){let s=o.getFontIdentifier(),n=s==="imgly_font_amberlight"||s==="imgly_font_handycheera_regular"?new ci().set(e.getLowerCase()):e;switch(t){case bm.RowType.Single:return new xe({words:n,width:r,attributes:o});case bm.RowType.SingleImage:return new Go({words:n,width:r,attributes:o});default:return j.warn(`TextDesignCelebrate#_createSingleRow: Invalid row type '${t}'`),null}}},ur=bm;V(ur,"defaultFontIdentifiers",["imgly_font_handycheera_regular","imgly_font_rasa_regular"]),V(ur,"defaultBanderoles",[dr.Celebrate1,dr.Celebrate2]),V(ur,"identifier","imgly_text_design_celebrate"),V(ur,"RowType",{Single:"SINGLE",SingleImage:"SINGLE_IMAGE"});ur.prototype.availableOptions=b(b({},ti.prototype.availableOptions),{relativeLineSpacing:{type:g.NUMBER,default:.01875},fontIdentifiers:{type:g.ARRAY,default:ur.defaultFontIdentifiers},banderoles:{type:g.ARRAY,default:ur.defaultBanderoles}});var $e=class extends Hi{constructor(...t){super(...t);this.setSize(new he(this.getWidth(),this.getHeight()))}_getImageFrame(){let t=this._getTextFrame().clone(),e=this.getImage();if(this.getDrawingModeAspectFit()&&e){let r=Math.min(t.width/e.width,t.height/e.height),o=e.width*r,s=e.height*r;t.x+=(t.width-o)/2,t.y+=(t.height-s)/2,t.width=o,t.height=s}return t}_calculateLayoutElements(){return[new Di({text:"",frame:this._getImageFrame(),font:new Ti})]}render(t){let e=this.getImage(),r=this._getImageFrame(),s=this.getAttributes().getTextColor();qs(t,e,r,s)}};V($e,"RowImages",{decorative1:"text-design/images/imgly_text_design_asset_decorative_01.png",decorative2:"text-design/images/imgly_text_design_asset_decorative_02.png",decorative3:"text-design/images/imgly_text_design_asset_decorative_05.png",decorative4:"text-design/images/imgly_text_design_asset_decorative_06.png",celebrate1:"text-design/images/imgly_text_design_asset_celebrate_03.png",celebrate2:"text-design/images/imgly_text_design_asset_celebrate_04.png",celebrate3:"text-design/images/imgly_text_design_asset_celebrate_05.png"});$e.prototype.availableOptions=b(b({},Hi.prototype.availableOptions),{words:{type:g.OBJECT,default:new ci},height:{type:g.NUMBER,default:0},image:{type:g.IMAGE,default:null},imagePath:{type:g.STRING,default:$e.RowImages.decorative1},drawingModeAspectFit:{type:g.BOOLEAN,default:!1},attributes:{type:g.CONFIGURABLE,default:new Mr}});var pl=class extends ur{constructor(...t){super(...t);V(this,"getImagePaths",()=>{let t=this.getBanderoles();return[...t&&t.map(e=>e.getImagePath())||[],...this._celebrateTypes]});V(this,"onImagesLoaded",()=>{let t=this.getBanderoles();t&&t.forEach(e=>{let r=Wt.getImage(e.getImagePath());if(!r){j.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${e.getImagePath()}'`);return}e.setImage(r)})});this._celebrateTypes=[$e.RowImages.celebrate1,$e.RowImages.celebrate2,$e.RowImages.celebrate3],this._exclusiveFont=null,this._typeRandomizer=new Ft(0),this._useMaskedRandomizer=new Ft(0),this._seedPool.push(this._typeRandomizer),this._seedPool.push(this._useMaskedRandomizer)}_fontForRow(t,e){let r=this.getFontIdentifiers();return r[t%(r.length-1)]}_layoutRows(t,e){let r=this._typeRandomizer.pickNext(this._celebrateTypes),o=Wt.getImage(r);o||j.warn(`TextDesignCelebrateSimple#_layoutRows: Image not fount '${r}'`);let s=new $e({width:e,height:e*.5,drawingModeAspectFit:!0,image:o}).layout(),n=super._layoutRows(t,e);return[s,...n]}_randomLayoutRow(t,e,r,o){let s=t.countNumberOfCharacters(),n=13;s<4&&o.setFontIdentifier("imgly_font_rasa_regular");let l=this._useMaskedRandomizer.nextBool(2,1);return s<n&&l&&!this.getHasMaskedText()?this._layoutRow(t,r,o,!0):super._randomLayoutRow(t,e,r,o)}};V(pl,"identifier","imgly_text_design_celebrate_simple"),V(pl,"defaultFontIdentifiers",["imgly_font_amberlight","imgly_font_rasa_regular","imgly_font_rasa_500"]);pl.prototype.availableOptions=b(b({},ur.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:pl.defaultFontIdentifiers}});var hl=class extends Ct{render(t,e,r,o,s){j.warn("TextDesignBackground#render: Abstract class")}};hl.prototype.availableOptions={};var{Rectangle:pg}=$,Vo=class extends hl{getImagePaths(){let{topImagePath:t,bottomImagePath:e,leftImagePath:r,rightImagePath:o}=this._options;return[t,e,r,o].filter(s=>s!=="")}render(t,e,r,o,s){let n=r.clone().scale(e.width),a=e.rectangle(0,0),l=Wt.getImage(this.getTopImagePath()),c=Wt.getImage(this.getLeftImagePath()),d=Wt.getImage(this.getRightImagePath()),u=Wt.getImage(this.getBottomImagePath());if(l){let m=l.width/l.height,p=n.top*this.getTopImageFillRate(),f=p*m,x=a.width/2-f/2,_=new pg(x,0,f,p);qs(t,l,_,o)}if(u){let m=u.width/u.height,p=n.bottom*this.getBottomImageFillRate(),f=p*m,x=a.width/2-f/2,_=new pg(x,a.height-p,f,p);qs(t,u,_,o)}if(c){let m=c.width/c.height,p=n.left*this.getLeftImageFillRate(),f=p/m,x=a.height/2-f/2,_=new pg(0,x,p,f);qs(t,c,_,o)}if(d){let m=d.width/d.height,p=n.right*this.getRightImageFillRate(),f=p/m,x=a.height/2-f/2,_=new pg(a.width-p,x,p,f);qs(t,d,_,o)}}};Vo.prototype.availableOptions={topImagePath:{type:g.STRING,default:""},leftImagePath:{type:g.STRING,default:""},bottomImagePath:{type:g.STRING,default:""},rightImagePath:{type:g.STRING,default:""},topImageFillRate:{type:g.NUMBER,default:1},leftImageFillRate:{type:g.NUMBER,default:1},bottomImageFillRate:{type:g.NUMBER,default:1},rightImageFillRate:{type:g.NUMBER,default:1}};Vo.Backgrounds=[new Vo({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_3.png",topImageFillRate:.8,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.8}),new Vo({leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_2.png",leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6}),new Vo({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_2.png",topImageFillRate:.6,bottomImageFillRate:.6}),new Vo({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_2.png",topImageFillRate:.1,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6})];var jo=class extends je{constructor(...t){super(...t);this._relativeInsets=new kt(.1,.1,.1,.1),this._alreadyContainsARowWithScriptFont=!1,this._backgroundsRandomizer=new Ft(0),this._seedPool.push(this._backgroundsRandomizer)}getImagePaths(){return z.Array.flatten(Vo.Backgrounds.map(t=>t.getImagePaths()))}_getBackground(){return this._backgroundsRandomizer.pickNext(Vo.Backgrounds)}generateLayoutData(t,e){return this._alreadyContainsARowWithScriptFont=!1,this._background=this._getBackground(),super.generateLayoutData(t,e)}_modifiedText(t){return super._modifiedText(t).toUpperCase()}_fontForRow(t,e){let r=super._fontForRow(t,e);return r==="imgly_font_petit_formal_script"&&(this._alreadyContainsARowWithScriptFont&&(r="imgly_font_bungee_inline"),this._alreadyContainsARowWithScriptFont=!0),r}_randomLayoutRow(t,e,r,o){let s=o.getFontIdentifier()==="imgly_font_petit_formal_script";return new xe({words:s?new ci().set(t.getLowerCase()):t,width:r,attributes:o})}};V(jo,"identifier","imgly_text_design_equal_width"),V(jo,"defaultFontIdentifiers",["imgly_font_ultra","imgly_font_bungee_inline","imgly_font_petit_formal_script"]);jo.prototype.availableOptions=b(b({},je.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:jo.defaultFontIdentifiers},relativeLineSpacing:{type:g.NUMBER,default:.025}});var fl=class extends jo{constructor(...t){super(...t);this._relativeInsets=new kt}_getBackground(){return null}};V(fl,"defaultFontIdentifiers",["imgly_font_ultra"]),V(fl,"identifier","imgly_text_design_equal_width_fat");fl.prototype.availableOptions=b(b({},jo.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:fl.defaultFontIdentifiers}});var St=class extends Ct{insetsForWidth(t){return this.getRelativeInsets().clone().scale(t)}};St.prototype.availableOptions={imagePath:{type:g.STRING,default:""},minimumHeightRatio:{type:g.NUMBER,default:0},sizeToFitContent:{type:g.BOOLEAN,default:!0},capInsets:{type:g.OBJECT,default:new kt},relativeInsets:{type:g.OBJECT,default:new kt}};St.Box=new St({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",relativeInsets:new kt(.1,.1,.1,.1)});St.Badge1=new St({imagePath:"text-design/images/imgly_text_design_asset_badge1.png",relativeInsets:new kt(.3,.18,.2,.18)});St.Badge2=new St({imagePath:"text-design/images/imgly_text_design_asset_badge2.png",relativeInsets:new kt(.3,.18,.2,.18)});St.Badge3=new St({imagePath:"text-design/images/imgly_text_design_asset_badge3.png",relativeInsets:new kt(.3,.18,.2,.18)});St.Badge4=new St({imagePath:"text-design/images/imgly_text_design_asset_badge4.png",relativeInsets:new kt(.3,.18,.2,.18)});St.SpeechBubble1=new St({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small2.png",relativeInsets:new kt(.04,.07,.12,.07),capInsets:new kt(19*3,57*3,41*3,17*3)});St.SpeechBubble2=new St({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble3.png",relativeInsets:new kt(.04,.07,.12,.07),capInsets:new kt(2*3,35*3,29*3,5*3)});St.SpeechBubble3=new St({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small.png",relativeInsets:new kt(.165664675,.2,.165664675,.2),minimumHeightRatio:.7});St.SpeechBubble4=new St({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble4.png",relativeInsets:new kt(.124800224,.2,.291200523,.2),minimumHeightRatio:.7});St.SpeechBubble5=new St({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble5.png",relativeInsets:new kt(.114892823,.27,.15984926,.27)});St.Watercolor1=new St({imagePath:"text-design/images/imgly_text_design_asset_watercolor_01.png",minimumHeightRatio:.7,relativeInsets:new kt(.2,.25,.2,.25)});St.Watercolor2=new St({imagePath:"text-design/images/imgly_text_design_asset_watercolor_02.png",minimumHeightRatio:.7,relativeInsets:new kt(.08,.25,.3,.25)});St.Watercolor3=new St({imagePath:"text-design/images/imgly_text_design_asset_watercolor_03.png",minimumHeightRatio:.7,relativeInsets:new kt(.1,.2,.15,.2)});var dA=class{constructor(t){this._context=t,this._lastFontStyle={}}getLines(){let t=[],e=[],r=this._lines.length;for(let o=0;o<r;o++){let s=this._lines[o],n=this._buildWords(s),a=n.length;for(let l=0;l<a;l++){let c=n[l],d=e.concat(c).join("").replace(/\s+$/i,"");if(this._getWidth(d)>this._maxWidth){e.length>0&&(t.push(e.join("")),e=[c]);let m=c.replace(/\s+$/i,"");if(this._getWidth(m)>this._maxWidth){let p=this._splitWord(c);t=t.concat(p.lines),p.rest&&(e=[p.rest])}}else e.push(c)}t.push(e.join("")),e=[]}return t.map(o=>this._trimLine(o,this._context.textAlign))}_trimLine(t,e){return t}_buildWords(t){let e=[],r="",o=t.length;for(let s=0;s<o;s++){let n=t[s];r+=n,(n===" "||n==="-"||s===o-1)&&(e.push(r),r="")}return e}_splitWord(t){let e={lines:[],rest:null},r=t.length,o=[];for(let s=0;s<r;s++){let n=t[s];this._getWidth(o.concat(n).join(""))>this._maxWidth?(o.length>0&&e.lines.push(o.join("")),o=[n]):o.push(n),s===r-1&&o.length>0&&(e.rest=o.join(""))}return e}_fontStyleChanged(){return this._context.font!==this._lastFontStyle?(this._lastFontStyle=this._context.font,!0):!1}_getWidth(t){return this._context.measureText(t).width}setText(t){this._text=t,this._lines=t.split(`
`)}setMaxWidth(t){this._maxWidth=t}},hg=dA;var{Vector2:Sv}=$,uA=class{constructor(t,e){this._text=t,this._operation=e,this._textOptions={},this.rotation=0,this._createCanvas(),this._createTexture()}_createCanvas(){this._canvas=z.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new hg(this._context),this._finalCanvas=z.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d")}_createTexture(){this._texture=L.Texture.fromCanvas(this._canvas),this._finalTexture=L.Texture.fromCanvas(this._finalCanvas)}_applyTextOptions(t,e){e.font=`${this._text.getFontStyle()} ${this._text.getFontWeight()} ${t.fontSize}px "${this._text.getFontFamily()}"`,this._text.getTextMetrics()?e.textBaseline="alphabetic":e.textBaseline="top",e.textAlign=this._text.getAlignment(),e.fillStyle=this._text.getColor().toRGBA(),e.strokeStyle=this._text.getOutlineColor().toRGBA();let r=this._text.getOutlineWidth();r>0&&(e.lineWidth=r)}_buildOutputLines(t){return this._textSplitter.setText(this._text.getText()),this._textSplitter.setMaxWidth(t),this._textSplitter.getLines().map(e=>e.replace(/\s+$/i,""))}_renderTextLine(t,e,r){let o=this._text.getAlignment(),s=new Sv(0,e);switch(o){case"left":s.x=r;break;case"center":s.x=this._canvas.width/2;break;case"right":s.x=this._canvas.width-r;break}this._context.save(),this._context.translate(s.x,s.y),this._context.fillText(t,0,0),this._context.restore(),this._text.getOutlineWidth()>0&&(this._context.miterLimit=2,this._context.strokeText(t,s.x,s.y))}update(t,e){let r=this.calculateFontStyles(t,e);if(r){let{dimensions:o,lines:s}=this._calculateText(t,r,e);this._renderText(t,o,s,r,e),this._updateFinalTexture()}}_updateFinalTexture(){let{width:t,height:e}=this._canvas,{rotation:r}=this,o=Math.cos(r),s=Math.sin(r),n=new Sv(Math.abs(t*o)+Math.abs(e*s),Math.abs(t*s)+Math.abs(e*o));this._finalCanvas.width=n.x,this._finalCanvas.height=n.y,this._finalContext.save(),this._finalContext.translate(this._finalCanvas.width/2,this._finalCanvas.height/2),this._finalContext.rotate(r),this._finalContext.drawImage(this._canvas,-t/2,-e/2),this._finalContext.restore()}_renderText(t,e,r,o,s){this._canvas.width=e.x,this._canvas.height=e.y,this._text.getMaxHeight()&&(this._canvas.height=Math.min(this._text.getMaxHeight()*s.y,this._canvas.height)),this._context=this._canvas.getContext("2d"),this._context.fillStyle=this._text.getBackgroundColor().toRGBA(),this._context.fillRect(0,0,e.x,e.y),this._applyTextOptions(o,this._context);let n=this._padding(s),a=this._text.getTextMetrics(),l=this._text.getFontSize()*s.y,c=1/a.unitsPerEm*l,d=a.ascender*c;for(let u=0;u<r.length;u++){let m=r[u];this._renderTextLine(m,o.topPadding+o.lineHeight*u+n+d,n)}}calculateFontStyles(t,e){let r=this._text.getFontFamily(),o=this._text.getFontSize()*e.y,s=this._text.getAbsoluteTextHeight(e),n=s*this._text.getLineHeight(),a=s*(this._text.getLineHeight()-1)/2,l={fontFamily:r,fontSize:o,lineHeight:n,topPadding:a};return(this._textOptions.fontFamily!==r||this._textOptions.fontSize!==o||this._textOptions.lineHeight!==n)&&(this._textOptions=l),l}_calculateText(t,e,r){let o=this._text.getMaxWidth()*r.x;this._applyTextOptions(e,this._context);let s=new Sv,n=this._text.getText().split(`
`);typeof o!="undefined"&&(s.x=o,n=this._buildOutputLines(o));for(let c=0;c<n.length;c++){let d=n[c];s.x=Math.max(s.x,this._context.measureText(d).width)}let{lineHeight:a}=e;s.y=n.length*a;let l=this._padding(r);return s.y+=l*2,s.x+=l*2,{dimensions:s,lines:n}}_padding(t){return this._text.getAbsoluteTextHeight(t)*.2}getTexture(){return this._texture}getFinalTexture(){return this._finalTexture}getDimensions(t,e){let r=this.calculateFontStyles(t,e),{dimensions:o}=this._calculateText(t,r,e);return o}dispose(){this._measurementElement&&document.body.removeChild(this._measurementElement),this._texture&&(this._texture.dispose(),this._texture=null),this._finalTexture&&(this._finalTexture.dispose(),this._finalTexture=null)}},mA=uA;var{Vector2:pA}=$,_m=class extends Ct{constructor(t){super(t);this._textOptions={},this._createCanvas()}_createCanvas(){this._canvas=z.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new hg(this._context),this._finalCanvas=z.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d"),this.updateFontVariation()}setOption(t,e,r=!0,o=!1){super.setOption(t,e,r,o),t==="fontIdentifier"&&!o&&this.updateFontVariation()}updateFontVariation(){let t=Wt.getVariation(this.getFontIdentifier());return t||j.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(t),t}_applyTextOptions(t={},e=this._context){let{fontSize:r,fontVariation:o,lineHeight:s,textColor:n,alignment:a}=b(b({},this._options),t),{fontStyle:l,fontWeight:c,fontFamily:d}=o.serializeOptions();e.font=`${l} ${c} ${r}px "${d}"`,e.fillStyle=n,e.textBaseline="top",e.textAlign=a||"left"}_buildOutputLines(t){return this._textSplitter.setText(this.getText()),this._textSplitter.setMaxWidth(t),this._textSplitter.getLines()}_renderTextLine(t,e){let r=this.getAlignment(),o=new pA(0,e);switch(r){case"center":o.x=this._canvas.width/2;break;case"right":o.x=this._canvas.width;break}this._context.fillText(t,o.x,o.y)}update(){let t=this.calculateFontStyles();if(t){let{dimensions:e,lines:r}=this._calculateText(t);this._dimensions=e,this._renderText(e,r,t)}}draw(t,e=0,r=0){this.update(),t.drawImage(this._canvas,e,r,this._dimensions.x,this._dimensions.y)}_renderText(t,e,r){this._canvas.width=t.x,this._canvas.height=t.y,this._context=this._canvas.getContext("2d"),this._applyTextOptions(r,this._context);for(let o=0;o<e.length;o++){let s=e[o];this._renderTextLine(s,r.topPadding+r.lineHeight*o)}}getFontFamily(){return this.getFontVariation().getFontFamily()}calculateFontStyles(){let t=this.getFontFamily(),e=this.getFontSize(),r=this.getAbsoluteTextHeight(),o=r*this.getLineHeight(),s=r*(this.getLineHeight()-1)/2,n={fontFamily:t,fontSize:e,textHeight:r,lineHeight:o,topPadding:s};return this._textOptions=b({},n),n}getTextMetrics(){return this.getFontVariation().getTextMetrics()}getAbsoluteTextHeight(){let t=this.getFontSize(),e=this.getTextMetrics();if(e){let r=1/e.unitsPerEm*t,o=e.ascender*r,s=e.descender*r;return o+Math.abs(s)}return t*this.getLineHeight()*1.1}_calculateText(t){this._applyTextOptions(t,this._context);let e=new pA,r=this.getText().split(`
`),o;if(typeof o!="undefined")e.x=o,r=this._buildOutputLines(o);else for(let n=0;n<r.length;n++){let a=r[n];e.x=Math.max(e.x,this._context.measureText(a).width)}let{lineHeight:s}=t;return e.y=r.length*s,{dimensions:e,lines:r}}getDimensions(){let t=this.calculateFontStyles(),{dimensions:e}=this._calculateText(t);return e}fitMaxHeight(){this.update();let t=this.getDimensions(),e=this.getText().split(`
`),r=this.getMaxHeight()/t.y}fitMaxWidth(){let t=this.getDimensions().x,e=this.getMaxWidth()/t;this.setFontSize(this.getFontSize()*e),this._textOptions.fontSize=this.getFontSize()}fitInFrame(t){this.setMaxWidth(t.width),this.setMaxHeight(t.height),this.fitMaxWidth(),this.fitMaxHeight()}getSize(){let t=this.getDimensions();return new he(t.x,t.y)}};_m.prototype.availableOptions={text:{type:g.STRING,default:""},fontIdentifier:{type:g.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:g.OBJECT,default:null},lineHeight:{type:g.NUMBER,default:1},fontSize:{type:g.NUMBER,default:22},textColor:{type:g.STRING,default:"black"},strokeStyle:{type:g.STRING,default:"black"},outlineWidth:{type:g.NUMBER,default:0},textBaseline:{type:g.STRING,default:"alphabetic"},excludeAccents:{type:g.BOOLEAN,default:!0},maxWidth:{type:g.NUMBER,default:100},maxHeight:{type:g.NUMBER,default:0},alignment:{type:g.STRING,default:"left",available:["left","center","right"]}};var la=class extends Zs{_calculateLayoutElements(){let t=this.getWords(),e=this._getTextFrame(),o=this.getAttributes().getFontIdentifier(),s=this.getImageInsets(),n=new Ti({text:t.getWord(0),fontIdentifier:o});n.fitWidth(e.width);let a=new Di({text:t.getWord(0),frame:e,font:n});a.setFrame(this._getTextFrameForElement(a));let l=this.getSize();return(this.getSizeToFitContent()||l.height<=1)&&(l.height=s.top+a.getFrame().height+s.bottom),l.height=Math.max(l.height,this.getMinimumHeight()),[a]}_getTextFrameForElement(t){let r=this.getWords().getWord(0),o=this.getAttributes(),s=o.getFontIdentifier(),n=this.getImageInsets(),a=this.getImageInsets().applyToRectangle(this._getFrame()).scale(this.getTextScaleFactor()),l=new _m({text:r,fontIdentifier:s,alignment:o.getAlignment(),lineHeight:1});l.fitInFrame(a);let c=l.getSize();a.height=c.height;let d=c.height*this.getRowScaleFactor();this.getSizeToFitContent()&&(d+=n.top+n.bottom);let u=this._getFrame(),m=o.getAlignment();if(this.getCenteredVertically())a.y=u.height/2-d/2+n.top;else switch(m){case"left":a.y=u.height-d-n.bottom;break;case"center":a.y=u.height/2-d/2+d*this.getCenterOffset(),a.x=(u.width-a.width)/2;break;case"right":a.x=u.width-a.width-n.right;break;default:break}return a}render(t){t.save(),this._getLayoutElements().forEach(e=>{let{text:r,frame:o}=e.serializeOptions(),s=this.getAttributes(),n=s.getFontIdentifier(),a=new _m({text:r,fontIdentifier:n,alignment:s.getAlignment(),lineHeight:1,textColor:s.getTextColor().toRGBA()});o=this._getTextFrameForElement(e),a.fitInFrame(o),a.draw(t,o.x,o.y)}),t.restore()}};la.prototype.availableOptions=b(b({},Zs.prototype.availableOptions),{centerOffset:{type:g.NUMBER,default:0},sizeToFitContent:{type:g.BOOLEAN,default:!1},textScaleFactor:{type:g.NUMBER,default:.95},rowScaleFactor:{type:g.NUMBER,default:1},minimumHeight:{type:g.NUMBER,default:0},centeredVertically:{type:g.BOOLEAN,default:!1}});var Nc=class extends je{constructor(...t){super(...t);this._rowType=St.Box,this._alignmentRandomizer=new Ft(0),this._isMaskedRandomizer=new Ft(0),this._seedPool.push(this._alignmentRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return[St.Box.getImagePath()]}_modifiedText(t){return super._modifiedText(t).toLowerCase()}_modifiedLines(t){let e=new ci;return e.set([t.reduce((r,o)=>`${r}${r===""?"":`
`}${o.joined(1)[0]}`,"")]),[e]}_layoutRows(t,e){let r=super._layoutRows(t,e),o=r[0];if(o&&this.getSquareLayout()){let s=o.getSize();s.height=s.width}return r}getAlignment(){return this._alignmentRandomizer.pickNext(this.constructor.ValidAlignments||Nc.ValidAlignments)}_randomLayoutRow(t,e,r,o){let s=this.getAlignment(),n=this._rowType,a=Wt.getImage(n.getImagePath());o.setAlignment(s);let l=new la({words:t,width:r,attributes:o,image:a,imageInsets:n.insetsForWidth(r),capInsets:n.getCapInsets(),backgroundColor:U.WHITE,centerOffset:0,textScaleFactor:.7,isMasked:this._isMaskedRandomizer.nextBool()});this._rowType===St.Box&&(l.serverImageSmoothingFix=!0);let c=l.getSize();return this.getSquareLayout()?c.height=c.width:c.height=Math.max(c.height,c.width*n.getMinimumHeightRatio()),l}},De=Nc;V(De,"defaultFontIdentifiers",["imgly_font_galano_grotesque_bold"]),V(De,"Alignment",{Left:"left",Center:"center",Right:"right"}),V(De,"ValidAlignments",[Nc.Alignment.Left,Nc.Alignment.Center,Nc.Alignment.Right]),V(De,"identifier","imgly_text_design_masked");De.prototype.availableOptions=b(b({},je.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:De.defaultFontIdentifiers},squareLayout:{type:g.BOOLEAN,default:!0}});var ca=class extends De{constructor(...t){super(...t);this._possibleRowTypes=[St.Badge1,St.Badge2,St.Badge3,St.Badge4],this._rowTypesRandomizer=new Ft(0),this._isMaskedRandomizer=new Ft(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(t=>t.getImagePath())}_randomLayoutRow(t,e,r,o){this._rowType=this._rowTypesRandomizer.pickNext(this._possibleRowTypes),o.setLineSpacing(.9);let s=super._randomLayoutRow(t,e,r,o);return s.set({textScaleFactor:.9}),s}};V(ca,"defaultFontIdentifiers",["imgly_font_campton_bold"]),V(ca,"identifier","imgly_text_design_masked_badge"),V(ca,"ValidAlignments",[De.Alignment.Center]);ca.prototype.availableOptions=b(b({},De.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:ca.defaultFontIdentifiers}});var mr=class extends De{constructor(...t){super(...t);this._possibleRowTypes=[St.SpeechBubble1,St.SpeechBubble3],this._rowTypesRandomizer=new Ft(0),this._isMaskedRandomizer=new Ft(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(t=>t.getImagePath())}_rowTypes(t){return this._possibleRowTypes}_randomLayoutRow(t,e,r,o){this._rowType=this._rowTypesRandomizer.pickNext(this._rowTypes(t)),o.setLineSpacing(.9);let s=super._randomLayoutRow(t,e,r,o);return s.set({textScaleFactor:1,minimumHeight:r*this._rowType.getMinimumHeightRatio(),sizeToFitContent:this._rowType.getSizeToFitContent(),centeredVertically:!0}),s}};V(mr,"defaultFontIdentifiers",["imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_roboto_black","imgly_font_roboto_light"]),V(mr,"identifier","imgly_text_design_masked_speech_bubble");mr.prototype.availableOptions=b(b({},De.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:mr.defaultFontIdentifiers},squareLayout:{type:g.BOOLEAN,default:!1},alignment:{type:g.STRING,default:"left",available:De.ValidAlignments}});var gl=class extends mr{constructor(...t){super(...t);this._possibleRowTypes=[St.SpeechBubble2,St.SpeechBubble4,St.SpeechBubble2,St.SpeechBubble4,St.SpeechBubble5],this._possibleRowTypesForMin15=this._possibleRowTypes.slice(0,2),this._possibleRowTypesForMax14=this._possibleRowTypes.slice(2)}_rowTypes(t){return t.countNumberOfCharacters()<15?this._possibleRowTypesForMax14:this._possibleRowTypesForMin15}};V(gl,"defaultFontIdentifiers",["imgly_font_permanent_marker"]),V(gl,"identifier","imgly_text_design_masked_speech_bubble_comic");gl.prototype.availableOptions=b(b({},mr.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:gl.defaultFontIdentifiers}});var bl=class extends De{_modifiedText(t){return super._modifiedText(t).toUpperCase()}_randomLayoutRow(t,e,r,o){let s=this._alignmentRandomizer.pickNext(De.ValidAlignments);return o.setAlignment(s),new la({words:t,width:r,attributes:o,image:null,backgroundColor:U.WHITE,centerOffset:0,sizeToFitContent:!0,isMasked:!1,autoAdjustTextColor:!1})}};V(bl,"defaultFontIdentifiers",["imgly_font_abril_fatface_regular"]),V(bl,"identifier","imgly_text_design_multiline");bl.prototype.availableOptions=b(b({},De.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:bl.defaultFontIdentifiers}});var{Rectangle:R9}=$,fg=class extends Ct{getContentFrame(){let t=this.getFrame().clone(),e=t.width*.1;return t.insetBy(e,e)}intersects(t){return this.getFrame().intersects(t.getFrame())}};fg.prototype.availableOptions={frame:{type:g.OBJECT,default:new R9}};var{Rectangle:hA}=$,so=class extends hl{constructor(...t){super(...t);this._MAX_TRIES=1e3,this._PRECISION=1e3}render(t,e,r,o,s){let{imagePaths:n,relativeParticleSize:a}=this._options;if(n.length<=0)return;let l=e.width/e.height,c=new hA(Math.round(r.left*this._PRECISION),Math.round(r.top*this._PRECISION*l),this._PRECISION,this._PRECISION);c.width-=c.x+Math.round(r.right*this._PRECISION),c.height-=c.y+Math.round(r.bottom*this._PRECISION*l);let d=[],u=0,m=0;for(;u<this.getParticleCount()&&m<this._MAX_TRIES;){let p=a/2,f=Math.round(p*this._PRECISION),v=Math.round(p*this._PRECISION*l),x=Math.floor(this._PRECISION)-f,_=Math.floor(this._PRECISION)-v,D=s.nextInRange(f,x),k=s.nextInRange(v,_),A=new hA(D-f,k-v,2*f,2*v);!A.intersects(c)&&!this.hasCollision(d,A)&&(d.push(new fg({frame:A})),u+=1),m+=1}for(let p=0;p<d.length;p++){let f=d[p],v=s.pickNext(n),x=Wt.getImage(v),_=s.nextInRange(140,230)/255,D=e.width/this._PRECISION,k=e.height/this._PRECISION,A=f.getContentFrame();A.x*=D,A.y*=k,A.width*=D,A.height*=k;let B=o.clone();B.a=_,qs(t,x,A,B,"source-atop")}}hasCollision(t,e){for(let r=0;r<t.length;r++)if(e.intersects(t[r].getFrame()))return!0;return!1}};so.prototype.availableOptions=b(b({},hl.prototype.availableOptions),{particleCount:{type:g.NUMBER,default:50},relativeParticleSize:{type:g.NUMBER,default:.08},imagePaths:{type:g.ARRAY,default:[]}});var Hc=class extends so{};V(Hc,"Images",["text-design/images/imgly_text_design_particle_brush_01.png","text-design/images/imgly_text_design_particle_brush_02.png","text-design/images/imgly_text_design_particle_brush_03.png","text-design/images/imgly_text_design_particle_brush_04.png","text-design/images/imgly_text_design_particle_brush_05.png","text-design/images/imgly_text_design_particle_brush_06.png","text-design/images/imgly_text_design_particle_brush_07.png","text-design/images/imgly_text_design_particle_brush_08.png","text-design/images/imgly_text_design_particle_brush_09.png","text-design/images/imgly_text_design_particle_brush_10.png"]);Hc.prototype.availableOptions=b(b({},so.prototype.availableOptions),{imagePaths:{type:g.ARRAY,default:[...Hc.Images]},relativeParticleSize:{type:g.NUMBER,default:.12}});var Wc=class extends so{};V(Wc,"Images",["text-design/images/imgly_text_design_particle_circle_01.png","text-design/images/imgly_text_design_particle_circle_02.png","text-design/images/imgly_text_design_particle_circle_03.png","text-design/images/imgly_text_design_particle_circle_04.png","text-design/images/imgly_text_design_particle_circle_05.png","text-design/images/imgly_text_design_particle_circle_06.png","text-design/images/imgly_text_design_particle_circle_07.png","text-design/images/imgly_text_design_particle_circle_08.png","text-design/images/imgly_text_design_particle_circle_09.png","text-design/images/imgly_text_design_particle_circle_10.png"]);Wc.prototype.availableOptions=b(b({},so.prototype.availableOptions),{imagePaths:{type:g.ARRAY,default:[...Wc.Images]},relativeParticleSize:{type:g.NUMBER,default:.12}});var Gc=class extends so{};V(Gc,"Images",["text-design/images/imgly_text_design_particle_triangle_01.png","text-design/images/imgly_text_design_particle_triangle_02.png","text-design/images/imgly_text_design_particle_triangle_03.png","text-design/images/imgly_text_design_particle_triangle_04.png","text-design/images/imgly_text_design_particle_triangle_05.png","text-design/images/imgly_text_design_particle_triangle_06.png","text-design/images/imgly_text_design_particle_triangle_07.png","text-design/images/imgly_text_design_particle_triangle_08.png","text-design/images/imgly_text_design_particle_triangle_09.png","text-design/images/imgly_text_design_particle_triangle_10.png"]);Gc.prototype.availableOptions=b(b({},so.prototype.availableOptions),{imagePaths:{type:g.ARRAY,default:[...Gc.Images]}});var da=class extends je{constructor(...t){super(...t);this._relativeInsets=new kt(0,0,0,0),this._INVALID_FONTS_IF_LESS_THEN_5_CHARS=["imgly_font_montserrat_light"],this._INVALID_FONTS_IF_LESS_THEN_4_CHARS=["imgly_font_montserrat_light","imgly_font_wolesbro"],this._lineCount=0,this._decorativeRowCreated=!1,this._useImageRowRandomizer=new Ft(0),this._rowTypeRandomizer=new Ft(0),this._lineDecorativeTypeRandomizer=new Ft(0),this._seedPool.push(this._useImageRowRandomizer),this._seedPool.push(this._rowTypeRandomizer),this._seedPool.push(this._lineDecorativeTypeRandomizer)}getImagePaths(){return[...da.DecoratorImages,...da.RowImages]}_fontForRow(t,e){let r=e.countNumberOfCharacters(),o=this.getFontIdentifiers();return r<4?o=o.filter(s=>this._INVALID_FONTS_IF_LESS_THEN_4_CHARS.indexOf(s)<0):r<5&&(o=o.filter(s=>this._INVALID_FONTS_IF_LESS_THEN_5_CHARS.indexOf(s)<0)),o[t%o.length]}_modifiedText(t){return super._modifiedText(t).toUpperCase()}_modifiedLines(t){return this._lineCount=t.length,t}generateLayoutData(t,e){return this._decorativeRowCreated=!1,super.generateLayoutData(t,e)}_randomLayoutRow(t,e,r,o){let s=o.getFontIdentifier(),n=t;switch(s){case"imgly_font_wolesbro":n=new ci().set(t.getLowerCase());break;case"imgly_font_permanent_marker":n=new ci().set(t.getUpperCase());break;default:break}let a=this.getDecorativeRowsInTheMiddleOnly()&&(e===0||e===this._lineCount-1);if(this._useImageRowRandomizer.nextBool()||this._decorativeRowCreated||a)return new xe({words:n,width:r,attributes:o});this._decorativeRowCreated=!0;let[l,c]=this._randomDecoratorImages();return new Go({words:t,width:r,attributes:o,leftImage:l,rightImage:c})}_layoutRows(t,e){let r=super._layoutRows(t,e);if(!this.getDecorationsVisible())return r;let o=.0625*e,s=new $e({width:e,height:o,image:Wt.getImage(this._rowTypeRandomizer.pickNext(da.RowImages))}).layout(),n=new $e({width:e,height:o,image:Wt.getImage(this._rowTypeRandomizer.pickNext(da.RowImages))}).layout();return[s,...r,n]}_randomDecoratorImages(){return this._lineDecorativeTypeRandomizer.nextInRange(0,1)?da.DecoratorImages.slice(0,2).map(t=>Wt.getImage(t)):da.DecoratorImages.slice(2).map(t=>Wt.getImage(t))}},di=da;V(di,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]),V(di,"identifier","imgly_text_design_sunshine"),V(di,"RowImages",[$e.RowImages.decorative1,$e.RowImages.decorative2,$e.RowImages.decorative3,$e.RowImages.decorative4]),V(di,"DecoratorImages",["text-design/images/imgly_text_design_asset_decorative_03.png","text-design/images/imgly_text_design_asset_decorative_04.png","text-design/images/imgly_text_design_asset_decorative_07.png","text-design/images/imgly_text_design_asset_decorative_08.png"]);di.prototype.availableOptions=b(b({},je.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:di.defaultFontIdentifiers},relativeLineSpacing:{type:g.NUMBER,default:.025/3*4},decorationsVisible:{type:g.BOOLEAN,default:!0},decorativeRowsInTheMiddleOnly:{type:g.BOOLEAN,default:!1}});var ua=class extends di{constructor(...t){super(...t);this._relativeInsets=new kt(.3,.3,.3,.3),this._backgroundRandomizer=new Ft(0),this._decoTypeRandomizer=new Ft(0),this._seedPool.push(this._backgroundRandomizer),this._seedPool.push(this._decoTypeRandomizer)}getImagePaths(){return[...di.RowImages,...z.Array.flatten(ua.Backgrounds.map(t=>t.getImagePaths())),...ua.DecoratorImages]}_getBackground(){return this._backgroundRandomizer.pickNext(ua.Backgrounds)}_randomDecoratorImages(){switch(this._decoTypeRandomizer.nextInRange(0,2)){case 0:return ua.DecoratorImages.slice(0,2).map(t=>Wt.getImage(t));case 1:case 2:return ua.DecoratorImages.slice(2).map(t=>Wt.getImage(t));default:return j.warn("TextDesignParticles#_randomDecoratorImages: Number generated not in valid range."),ua.DecoratorImages.slice(2).map(t=>Wt.getImage(t))}}},Js=ua;V(Js,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]),V(Js,"identifier","imgly_text_design_particles"),V(Js,"Backgrounds",[new Hc,new Wc,new Gc]),V(Js,"DecoratorImages",["text-design/images/imgly_text_design_particle_holder_01.png","text-design/images/imgly_text_design_particle_holder_02.png","text-design/images/imgly_text_design_particle_holder_03.png","text-design/images/imgly_text_design_particle_holder_04.png"]);Js.prototype.availableOptions=b(b({},di.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:Js.defaultFontIdentifiers},decorationsVisible:{type:g.BOOLEAN,default:!1},decorativeRowsInTheMiddleOnly:{type:g.BOOLEAN,default:!0}});var _l=class extends je{constructor(...t){super(...t);this._relativeInsets=new kt(.1,0,0,0),this._rowTypeRandomizer=new Ft(0),this._seedPool.push(this._rowTypeRandomizer)}_modifiedText(t){return super._modifiedText(t).toUpperCase()}_randomLayoutRow(t,e,r,o){let s=super._randomLayoutRow(t,e,r,o);return s.setShearingAngle(this.getShearingAngle()),s}_layoutRows(t,e){let r=super._layoutRows(t,e),o=z.values(Wi.FormType),s=30,n=new Wi({width:e,height:s,type:this._rowTypeRandomizer.pickNext(o),shearingAngle:this.getShearingAngle()}).layout(),a=new Wi({width:e,height:s,type:this._rowTypeRandomizer.pickNext(o),shearingAngle:this.getShearingAngle()}).layout();return[n,...r,a]}};V(_l,"defaultFontIdentifiers",["imgly_font_campton_bold"]),V(_l,"identifier","imgly_text_design_rotated");_l.prototype.availableOptions=b(b({},je.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:_l.defaultFontIdentifiers},relativeLineSpacing:{type:g.NUMBER,default:.025/3},shearingAngle:{type:g.NUMBER,default:-.1}});var gg=class extends di{constructor(...t){super(...t);this._relativeInsets=new kt(0,.3,0,.3)}_layoutRows(t,e){let r=super._layoutRows(t,e);if(!this.getDecorationsVisible())return r;let o=25,s=new $e({width:e,height:o,image:Wt.getImage(this._rowTypeRandomizer.pickNext(di.RowImages))}).layout(),n=new $e({width:e,height:o,image:Wt.getImage(this._rowTypeRandomizer.pickNext(di.RowImages))}).layout();return[s,...r,n]}};V(gg,"identifier","imgly_text_design_sunshine-v3_1_0");var yl=class extends mr{constructor(...t){super(...t);this._possibleRowTypes=[St.Watercolor1,St.Watercolor2,St.Watercolor3]}};V(yl,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro"]),V(yl,"identifier","imgly_text_design_watercolor");yl.prototype.availableOptions=b(b({},mr.prototype.availableOptions),{fontIdentifiers:{type:g.ARRAY,default:yl.defaultFontIdentifiers},alignment:{type:g.STRING,default:De.Alignment.Center,available:De.ValidAlignments}});var{Rectangle:P9}=$,bg=1e3,wv=class{constructor(){this._layoutData=null,this._layout=null,this._text="",this._seed=0,this._debugMode=!1,this.randomizer=new Ft}createLayout(t,e,r){this._layout=t,this._text=e,this._seed=r,t.seed(r),this._layoutData=t.generateLayoutData(e,bg)}calculateAspect(){return this._layoutData?this._layoutData.getSize().aspect():(j.warn("TextDesignRenderer#calculateAspect: No layout data"),1)}draw(t,e,r,o){let s=this._layoutData;if(this._layoutData){let n=new he(bg,bg/e.aspect()),a=e.width/bg,l=s.getRelativeInsets().clone().scale(n.width),c=s.getRelativeLineSpacing()*n.width,d=l.top;t.save(),this.randomizer.seed(this._seed);let u=s.getBackground();u&&u.render(t,e,s.getRelativeInsets(),o?U.WHITE:r,this.randomizer),t.scale(a,a),s.getRows().forEach(m=>{t.save();let p=m.getAttributes();if(t.transform(1,m.getShearingAngle(),0,1,l.left,d),p.setTextColor(o?U.WHITE:r.clone()),p.setTintColor(o?U.WHITE:r.clone()),(m instanceof Zs||m instanceof la)&&(m.setBackgroundColor(o?U.WHITE:r.clone()),m.setIsUsedInInvertedLayout(o)),this._debugMode&&(m._debugMode=!0),m.willRender(t),m.render(t),m.didRender(t),this._debugMode){let f=m._getFrame(),v=m._getTextFrame();Uc(t,f,U.GREEN),Uc(t,v,U.BLUE),m._getLayoutElements().forEach(x=>{let _=x.getFrame(),D=m._getTextFrameForElement(x);Uc(t,_,new U(1,1,0)),Uc(t,D,new U(0,1,1))})}d+=m.getSize().height+c,t.restore()}),this._debugMode&&Uc(t,new P9(0,0,n.width,n.height),U.RED),t.restore()}}};var{Vector2:ma}=$,Vc=class extends No{constructor(t,e){super(t,e);this._isDisposed=!1,this._renderer=new wv,this._canvas=z.createCanvas(),this._context=this._canvas.getContext("2d"),this._texture=L.Texture.fromCanvas(this._canvas),this._sprite.setTexture(this._texture),this._aspect=1,this._isLayoutDirty=!0,this.getSeed()<0&&this.setSeed(Ft.TimeSeed())}seed(t){this.setSeed(t||Ft.TimeSeed()),this._isLayoutDirty=!0}_updateLayout(){let t=this.getLayout();return t?(this._renderer.createLayout(t,this.getText(),this.getSeed()),this._aspect=this._renderer.calculateAspect(),this._isLayoutDirty=!1,!0):null}applyTransform(t){super.applyTransform(t);let e={};this._options.dimensions&&(e.width=t.applyToRelativeSize(this.getWidth())),this.set(e,!1)}applyFlip(t){super.applyFlip(t);let{rotation:e}=this._options;switch(t){case"horizontal":e+=(Math.PI-e)*2,this.setRotation(e);break;case"vertical":e+=(Math.PI/2-e)*2,this.setRotation(e);break}}update(t,e){let r=this._isLayoutDirty;if(this._isDisposed||r&&!this._updateLayout())return;let o=this.getWidth()*e.min()/t.getTextureScale(),s=o/this._aspect,n=new ma(o,s),a=new ma(Math.round(o*2),Math.round(s*2)).clamp(new ma(1,1),new ma(Infinity,Infinity)),l=t.getRenderer(),c=l.getMaxDimensions()||Infinity;a.x>c&&(a.x=c,a.y=Math.round(a.x/this._aspect)),a.y>c&&(a.y=c,a.x=Math.round(a.y*this._aspect));let d=z.ensureCanvasDimensions(this._canvas,a);(r||d)&&(this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._renderer.draw(this._context,new he(a.x,a.y),this.getColor(),this.getInverted()),this.setDimensions(n),this._texture.getBaseTexture().update(),l.isOfType(gt.WEBGL)&&l.updateTexture(this._texture.getBaseTexture())),super.update(t,e),this._applyFlip()}_applyFlip(){let t=this._sprite.getScale(),{flipHorizontally:e,flipVertically:r}=this._options;(e&&t.x>0||!e&&t.x<0)&&(t.x*=-1),(r&&t.y>0||!r&&t.y<0)&&(t.y*=-1),this._sprite.setScale(t)}_optionEquals(t,e){if(t==="layout"){let{layout:r}=this._options;return!(!r&&e||!e&&r||!e.constructor||!r.constructor||r.constructor.identifier!==e.constructor.identifier)}return super._optionEquals(t,e)}serializeOptions(t,e=!1){if(t&&this.getPadding()<0){let o=t.indexOf("padding");o>-1&&t.splice(o,1)}let r=super.serializeOptions(t,e);return t||(r.type="textdesign"),r}_getTexture(){return this._texture}canBeFlippedHorizontally(){return!1}canBeDuplicated(){return!0}canMaskCanvas(){return!0}canAdjustPadding(){return!0}dispose(){this._isDisposed=!0,this._texture.dispose(),this._sprite.dispose()}};Vc.Layouts={TextDesignBlocks:ti,TextDesignBlocksCondensed:ul,TextDesignBlocksLight:Wo,TextDesignCelebrate:ur,TextDesignCelebrateSimple:pl,TextDesignEqualWidth:jo,TextDesignEqualWidthFat:fl,TextDesignMasked:De,TextDesignMaskedBadge:ca,TextDesignMaskedSpeechBubble:mr,TextDesignMaskedSpeechBubbleComic:gl,TextDesignMultiline:bl,TextDesignWatercolor:yl,TextDesignSunshine:di,TextDesignParticles:Js,TextDesignRotated:_l};Vc.LegacyLayouts={TextDesignBlocksLightV310:ml,TextDesignSunshineV310:gg};Vc.AssetManager=Wt;Vc.prototype.availableOptions={id:{type:g.STRING,default:()=>z.getUUID()},position:{type:g.VECTOR2,default:new ma(.5,.5)},dimensions:{type:g.VECTOR2,default:ma.NULL},anchor:{type:g.VECTOR2,default:new ma(0,0)},pivot:{type:g.VECTOR2,default:new ma(.5,.5)},rotation:{type:g.NUMBER,default:0},flipHorizontally:{type:g.BOOLEAN,default:!1},flipVertically:{type:g.BOOLEAN,default:!1},layout:{type:g.OBJECT,default:null,setter(i){return this._isLayoutDirty=!0,i}},text:{type:g.STRING,default:"",setter(i){return this._isLayoutDirty=!0,i}},color:{type:g.COLOR,default:U.BLACK,setter(i){return this._isLayoutDirty=!0,i}},padding:{type:g.NUMBER,default:.01,minValue:.01},width:{type:g.NUMBER,default:.8},inverted:{type:g.BOOLEAN,default:!1,setter(i){return this._isLayoutDirty=!0,i}},seed:{type:g.NUMBER,default:-1}};var _g=Vc;var{Vector2:kv}=$,yg=class extends No{constructor(...t){super(...t);this._textRenderer=new mA(this,this._operation),this._textRenderer.rotation=this.getRotation(),this._sprite.setTexture(this._textRenderer.getFinalTexture()),this._hitTestSprite.setTexture(this._textRenderer.getTexture())}serializeOptions(t,e=!1){let r=super.serializeOptions(t,e);return t||(r.type="text"),r}getDOMStyle(t,e){let r=this.getFontSize()*e.y;return{fontWeight:this._options.fontWeight,fontSize:`${r}px`,fontStyle:this._options.fontStyle,fontFamily:this._options.fontFamily,lineHeight:`${this.getAbsoluteTextHeight(e)*this.getLineHeight()}px`,color:this._options.color.toRGBA(),backgroundColor:this._options.backgroundColor.toRGBA(),textAlign:this._options.alignment}}getAbsoluteTextHeight(t){let e=this.getFontSize()*t.y,r=this.getTextMetrics();if(r){let o=1/r.unitsPerEm*e,s=r.ascender*o,n=r.descender*o;return s+Math.abs(n)}return e*this.getLineHeight()*1.1}getDimensions(t,e){return this._textRenderer.getDimensions(t,e)}applyFlip(t){super.applyFlip(t);let{rotation:e}=this._options;switch(t){case"horizontal":e+=(Math.PI-e)*2,this.setRotation(e);break;case"vertical":e+=(Math.PI/2-e)*2,this.setRotation(e);break}}applyTransform(t){super.applyTransform(t),this.set({fontSize:t.scaleSize(this.getFontSize(),"y"),maxWidth:t.scaleSize(this.getMaxWidth(),"x")},!1)}applyRotation(t){super.applyRotation(t);let e=(t+360)%360,r=this._operation.getInputDimensions();(e===90||e===270)&&(this.setMaxWidth(this.getMaxWidth()/r.x*r.y),this.setFontSize(this.getFontSize()/r.y*r.x))}setOption(t,e){let{flipHorizontally:r,flipVertically:o}=this._options;if(t==="rotation"){let s=e;r&&(s=Math.PI*2-s),o&&(s=Math.PI*2-s),this._options.rotation=s,this._textRenderer&&(this._textRenderer.rotation=s),this._rotation=s,this.emit("update");return}super.setOption(t,e)}getOption(t){return t==="rotation"?this._rotation:super.getOption(t)}getHitTestDisplayObject(){return this._hitTestSprite}update(t,e){if(this._sprite.setVisible(this._options.visible),!this._options.visible)return;this._textRenderer.update(t,e);let r=this._textRenderer.getFinalTexture();r.getBaseTexture().update();let s=t.getRenderer();s.isOfType(gt.WEBGL)&&s.updateTexture(r.getBaseTexture()),super.update(t,e),this._sprite.setRotation(0),this._textRenderer.getTexture().getBaseTexture().update(),this._hitTestSprite.setRotation(this._rotation),this._hitTestSprite.updateTransform(),this._applyFlip()}_applyFlip(){let t=this._sprite.getScale(),{flipHorizontally:e,flipVertically:r}=this._options;(e&&t.x>0||!e&&t.x<0)&&(t.x*=-1,this.setRotation(this._rotation)),(r&&t.y>0||!r&&t.y<0)&&(t.y*=-1,this.setRotation(this._rotation)),this._sprite.setScale(t)}_getTexture(){return this._textRenderer.getFinalTexture()}dispose(){super.dispose(),this._textRenderer.dispose(),this._hitTestSprite.dispose(),this._sprite.dispose()}canBeFlippedHorizontally(){return!1}canAdjustPadding(){return!1}};yg.prototype.availableOptions={id:{type:g.STRING,default:()=>z.getUUID()},fontSize:{type:g.NUMBER,default:.1},characterSpacing:{type:g.NUMBER,default:0},lineHeight:{type:g.NUMBER,default:1.1},fontIdentifier:{type:g.STRING},fontFamily:{type:g.STRING,default:"Times New Roman"},fontWeight:{type:g.ALL,default:"normal"},fontStyle:{type:g.STRING,default:"normal"},textMetrics:{type:g.OBJECT,default:null},outlineWidth:{type:g.NUMBER,default:0},outlineColor:{type:g.COLOR,default:U.BLACK},alignment:{type:g.STRING,default:"left",available:["left","center","right"]},verticalAlignment:{type:g.STRING,default:"top",available:["top","center","bottom"]},color:{type:g.COLOR,default:new U(1,0,0,1)},backgroundColor:{type:g.COLOR,default:U.TRANSPARENT},position:{type:g.VECTOR2,default:new kv(.5,.5)},anchor:{type:g.VECTOR2,default:new kv(0,0)},pivot:{type:g.VECTOR2,default:new kv(.5,.5)},rotation:{type:g.NUMBER,default:0},text:{type:g.STRING,required:!0},maxWidth:{type:g.NUMBER,default:.5},maxHeight:{type:g.NUMBER,default:0},visible:{type:g.BOOLEAN,default:!0},flipHorizontally:{type:g.BOOLEAN,default:!1},flipVertically:{type:g.BOOLEAN,default:!1}};yg.type="text";var xg=yg;var{Vector2:Tv}=$,Qs=class extends Mt{constructor(...t){super(...t);this.setSmoothDownscaling(this._sdk.getOptions().smoothDownscaling),this._onSpriteUpdate=this._onSpriteUpdate.bind(this),this._maskCanvas=z.createCanvas(),this._options.sprites.slice().forEach(r=>{this.removeSprite(r),this.addSprite(r)})}getSpritesOfType(t){return this._options.sprites.filter(e=>e instanceof t)}rotate(t){this._options.sprites.forEach(e=>{e.applyRotation(t)})}flip(t){this._options.sprites.forEach(e=>{e.applyFlip(t)})}_onSpriteUpdate(t,e){this.emit("update",this),this.setDirty(!0)}_applyRotation(t,e){this._options.sprites.forEach(r=>r.applyRotation(t,e))}transform(t){this._options.sprites.forEach(e=>e.applyTransform(t))}scale(t){this._options.sprites.forEach(e=>e.applyScale(t))}serializeOption(t,e=!1){return t==="sprites"?this._options.sprites.map(r=>r.serializeOptions(void 0,e)):super.serializeOption(t,e)}createSticker(t){return new lg(this,t)}createText(t){return new xg(this,t)}createBrush(t){return new cl(this,t)}createTextDesign(t){return new _g(this,t)}addSprite(t){this._options.sprites.push(t);let e=this.getSmoothDownscaling();t.setSmoothDownscaling&&t.setSmoothDownscaling(e),this._container.addChild(t.getDisplayObject()),this.setDirty(!0),t.on("update",this._onSpriteUpdate),this.emit("update",this,this._options.sprites)}removeSprite(t){let{sprites:e}=this._options,r=e.indexOf(t);return r!==-1?(t.off("update",this._onSpriteUpdate),this._container.removeChild(t.getDisplayObject()),e.splice(r,1),this.setDirty(!0),!0):!1}_getOrientatedStageSize(){let t=this._sdk.getSprite().getTexture().getFrame(),e=this._sdk.getOperationsStack().getByIdentifier("orientation");if(e){let o=e?e.getRotation():0;return o===270||o===90?new Tv(t.height,t.width):new Tv(t.width,t.height)}let r=this._sdk.getOperationsStack().getByIdentifier("output");return r?r.getOutputResolution():new Tv(t.width,t.height)}_render(t){let e=this._container,{sprites:r}=this._options,o=t.getDimensions().clone().floor(),s=new L.Container;return s.addChild(this._sprite),Promise.all(r.map(n=>n.validateSettings())).then(()=>{r.forEach(n=>n.update(this._sdk,o))}).then(()=>{this._renderTexture.clear(),r.forEach(n=>{n.getInverted&&n.getInverted()?(this._renderTexture.render(s),this._renderTexture.render(this._renderMaskedSprite(n.getDisplayObject(),n.getColor?n.getColor():U.WHITE,n.getPadding?n.getPadding():-1)),s=new L.Container):s.addChild(n.getDisplayObject())}),this._renderTexture.render(s),e.addChild(this._sprite),r.forEach(n=>e.addChild(n.getDisplayObject()))})}_renderMaskedSprite(t,e,r){let o=this._maskCanvas,s=t.getWorldTransform(),n=this._getOrientatedStageSize();z.ensureCanvasDimensions(o,n);let a=o.getContext("2d");if(a.clearRect(0,0,o.width,o.height),a.save(),a.fillStyle=e.toRGBA(),r<0)a.fillRect(0,0,n.x,n.y);else{let d=Math.abs(t.getWidth()/t.getScale().x),u=Math.abs(t.getHeight()/t.getScale().y),m=d*r;a.transform(s.a,s.b,s.c,s.d,s.tx,s.ty),a.fillRect(-m,-m,d+m*2,u+m*2)}a.restore(),a.save(),a.globalCompositeOperation="destination-out",t._renderCanvas({getCurrentRenderTarget:()=>({getPixelRatio:()=>1}),beforeDraw:d=>{let u=t.getWidth(),m=t.getHeight(),p=t.getScale(),f=p.x<0,v=p.y<0;d.translate(u,m),d.scale(f?-1:1,v?-1:1),d.translate(-u,-m)},getContext:()=>a}),a.restore();let l=new L.Container,c=new L.Sprite(L.Texture.fromCanvas(o));return l.addChild(c),l}takeSpriteToFront(t){let{sprites:e}=this._options,r=e.indexOf(t);if(r===-1)return;z.moveArrayItem(e,r,e.length-1);let o=t.getDisplayObject();this._container.removeChild(o),this._container.addChild(o),this.setDirty(!0)}getSpritesAtPosition(t,e){let r=[];this._options.sprites.forEach(d=>d.update(this._sdk,e));let o=this._sdk.getSprite(),s=o.getWorldTransform().applyInverseToVector(t),{width:n,height:a}=o.getTexture().getFrame(),l=o.getAnchor().clone().multiply(-n,-a);s.subtract(l);let c=this._options.sprites.slice(0).reverse();for(let d=0,u=c.length;d<u;d++){let m=c[d];m.getHitTestDisplayObject().isAtPosition(s)&&r.push(m)}return r}setDirtyForRenderer(t,e,r){super.setDirtyForRenderer(t,e,r),this._options.sprites.forEach(o=>{o.setDirtyForRenderer(t,e,r)})}dispose(){super.dispose(),this._options.sprites.forEach(t=>{t.dispose()})}};Qs.StickerSprite=lg;Qs.TextSprite=xg;Qs.BrushSprite=cl;Qs.TextDesignSprite=_g;Qs.identifier="sprite";Qs.prototype.availableOptions={sprites:{type:g.ARRAY,default:[],setter(i,t){return i=i.map((e,r)=>{if(e instanceof No)return e;let o=b({},e);switch(delete o.type,e.type){case"text":return new xg(this,o);case"sticker":return new lg(this,o);case"brush":return new cl(this,o);case"textdesign":return new _g(this,o);default:return j.error(this.constructor.name,`Invalid sprite type: ${e.type}`),null}}),t||(this._options.sprites&&this._options.sprites.slice().forEach(r=>{r.dispose(),this.removeSprite(r)}),i.forEach(e=>{this.addSprite(e)})),i}},smoothDownscaling:{type:g.BOOLEAN,default:!1}};bt.Operations.SpriteOperation=Qs;var fA=Qs;var{Vector2:gA}=$,bA=class{constructor(t,e){this._options=e,this._oldOptions={start:t.getStart().clone(),end:t.getEnd().clone(),rotation:t.getRotation(),textureScale:t.getTextureScale()},this._inputDimensions=t.getInputDimensions(!1),this._rotationDelta=e.rotation-t.getRotation(),this._deltaCos=Math.cos(this._rotationDelta),this._deltaSin=Math.sin(this._rotationDelta),this._oldAbsoluteSize=this._oldOptions.end.clone().subtract(this._oldOptions.start).multiply(this._inputDimensions),this._newAbsoluteSize=e.end.clone().subtract(e.start).multiply(this._inputDimensions),this._absoluteStartDiff=this._oldOptions.start.clone().subtract(e.start).multiply(this._inputDimensions),this._scaleRatio=t.calculateScale(e.rotation)/t.calculateScale(),this._sizeFactor=this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize),this._textureScaleFactor=this._options.textureScale/t.getTextureScale()}applyToRelativePoint(t){let e=this._oldOptions.start,r=this._oldOptions.end,s=e.clone().add(r.clone().subtract(e).divide(2)).multiply(this._inputDimensions),n=t.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2)),l=s.clone().add(n).clone().subtract(this._inputDimensions.clone().divide(2)),c=new gA(l.x*this._deltaCos-l.y*this._deltaSin,l.x*this._deltaSin+l.y*this._deltaCos),d=this._inputDimensions.clone().divide(2).add(c),u=this._options.start.clone().multiply(this._inputDimensions);return d.clone().subtract(u).divide(this._newAbsoluteSize)}applyToRelativeSize(t){return t*this._oldAbsoluteSize.min()/this._newAbsoluteSize.min()}applyToDimensions(t){return t=t.clone().multiply(this._scaleRatio),this._options.textureScale&&t.multiply(this._textureScaleFactor),t}scaleSize(t,e="y"){return t/this._sizeFactor[e]}applyToRotation(t){return(t+this._rotationDelta)%(Math.PI*2)}invert(){let t=this._options.start.clone(),e=this._options.end.clone(),r=this._inputDimensions,o=-this._rotationDelta,s=Math.cos(o),n=Math.sin(o),a=this._oldAbsoluteSize,l=this._newAbsoluteSize,c=t.clone().subtract(e).multiply(r),d=1/this._scaleRatio,u=new gA(1/this._sizeFactor.x,1/this._sizeFactor.y),m=1/this._textureScaleFactor,p=this._oldOptions;return this._oldOptions=this._options,this._options=p,this._inputDimensions=r,this._rotationDelta=o,this._deltaCos=s,this._deltaSin=n,this._oldAbsoluteSize=l,this._newAbsoluteSize=a,this._absoluteStartDiff=c,this._scaleRatio=d,this._sizeFactor=u,this._textureScaleFactor=m,this}},_A=bA;var{Vector2:Dv}=$,jc=class extends Mt{_render(t){this._sprite.setRotation(0);let e=t.getDimensions(),{start:r,end:o,rotation:s,textureScale:n}=this._options,l=o.clone().subtract(r).clone().divide(2),c=r.clone().add(l),u=this.calculateScale()*n,m=e.clone().multiply(u).multiply(l);return this._sprite.setAnchor(c),this._sprite.setRotation(s),this._sprite.setScale(u,u),this._sprite.setPosition(m),this._renderTexture.render(this._container),Promise.resolve()}calculateScale(t=this._options.rotation){let e=this.getInputDimensions(!1),r=new Dv(Math.abs(e.x*Math.cos(t))+Math.abs(e.y*Math.sin(t)),Math.abs(e.x*Math.sin(t))+Math.abs(e.y*Math.cos(t))),o=e.clone().subtract(r.clone()).divide(2).abs(),s=1;return o.y>o.x?s=o.y*2/e.y+1:s=o.x*2/e.x+1,s}getNewDimensions(t){let{start:e,end:r,textureScale:o}=this._options,s=this.calculateScale();return t.clone().multiply(o*s).multiply(r.clone().subtract(e)).round()}flip(t){let{start:e,end:r}=this._options,o=e.clone();t==="horizontal"?(e.set(1-r.x,e.y),r.set(1-o.x,r.y)):t==="vertical"&&(e.set(e.x,1-r.y),r.set(r.x,1-o.y))}rotate(t){let{start:e,end:r}=this._options,o=(t+360)%360,s=Math.floor(o/90);for(let n=0;n<s;n++){let a=e.clone();e.set(1-r.y,a.x),r.set(1-a.y,r.x)}}_onBeforeExport(){this._wasEnabledBeforeExport=this.getEnabled(),this.setEnabled(!0)}_onAfterExport(){this.setEnabled(this._wasEnabledBeforeExport,!0)}};jc.identifier="transform";jc.prototype.availableOptions={start:{type:g.VECTOR2,default:new Dv(0,0)},end:{type:g.VECTOR2,default:new Dv(1,1)},textureScale:{type:g.NUMBER,default:1},rotation:{type:g.NUMBER,default:0}};jc.TransformChange=_A;bt.Operations.TransformOperation=jc;var yA=jc;var{Vector2:B9}=$,ym=class extends Mt{constructor(...t){super(...t);this._watermarkSprite=new L.Sprite,this._watermarkSprite.setAnchor(.5,.5),this._container.addChild(this._watermarkSprite)}_render(t){this._watermarkTexture||(this._watermarkTexture=L.Texture.fromImage(this._options.image),this._watermarkSprite.setTexture(this._watermarkTexture));let e=t.getDimensions(),{width:r,height:o}=this._options.image,s=z.resizeVectorToFit(new B9(r,o),e);return this._watermarkSprite.setPosition(e.clone().divide(2)),this._watermarkSprite.setWidth(s.x),this._watermarkSprite.setHeight(s.y),this._renderTexture.render(this._container),Promise.resolve()}dispose(){super.dispose(),this._watermarkSprite.dispose()}};ym.identifier="watermark";ym.prototype.availableOptions={image:{type:g.OBJECT,required:!0}};bt.Operations.WatermarkOperation=ym;var xA=ym;var M9=[hI,bI,kE,DE,FE,RE,BE,ME,UE,HE,KE,fA,yA,xA,LE,TE];bt.AllOperations=M9;var vA=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}}]},{fontFamily:"Archivo",variations:[{identifier:"imgly_font_archivo_black",fontWeight:"normal",filePath:"fonts/imgly_font_archivo_black.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_bungee_inline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_campton_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Carter",variations:[{identifier:"imgly_font_carter_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_carter_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}}]},{fontFamily:"Codystar",variations:[{identifier:"imgly_font_codystar",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_codystar.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}}]},{fontFamily:"Fira Sans",variations:[{identifier:"imgly_font_fira_sans_regular",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_fira_sans_regular.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Krona One",variations:[{identifier:"imgly_font_krona_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_krona_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}}]},{fontFamily:"Kumar One Outline",variations:[{identifier:"imgly_font_kumar_one_outline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_kumar_one_outline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}}]},{fontFamily:"Molle",variations:[{identifier:"imgly_font_molle",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_molle.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}}]},{fontFamily:"Monoton",variations:[{identifier:"imgly_font_monoton",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_monoton.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}}]},{fontFamily:"Nixie One",variations:[{identifier:"imgly_font_nixie_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_nixie_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}}]},{fontFamily:"Notable",variations:[{identifier:"imgly_font_notable",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_notable.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}}]},{fontFamily:"Oswald SemiBold",variations:[{identifier:"imgly_font_oswald_semi_bold",fontWeight:600,fontStyle:"normal",filePath:"fonts/imgly_font_oswald_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}}]},{fontFamily:"Palanquin Dark SemiBold",variations:[{identifier:"imgly_font_palanquin_dark_semi_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_palanquin_dark_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}}]},{fontFamily:"Poppins",variations:[{identifier:"imgly_font_poppins",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_poppins.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_permanent_marker.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sancreek",variations:[{identifier:"imgly_font_sancreek",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sancreek.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}}]},{fontFamily:"Stint Ultra Expanded",variations:[{identifier:"imgly_font_stint_ultra_expanded",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_stint_ultra_expanded.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}}]},{fontFamily:"VT323",variations:[{identifier:"imgly_font_vt323",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_vt323.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Yeseva One",variations:[{identifier:"imgly_font_yeseva_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_yeseva_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}}]}];var CA=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Abril Fatface",variations:[{identifier:"imgly_font_abril_fatface_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_abril_fatface_regular.woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}}]},{fontFamily:"Amberlight",variations:[{identifier:"imgly_font_amberlight",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_amberlight.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_bungee_inline.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_campton_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Handycheera",variations:[{identifier:"imgly_font_handycheera_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_handycheera_regular.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}}]},{fontFamily:"Montserrat Light",variations:[{identifier:"imgly_font_montserrat_light",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_montserrat_light.woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_heavy",fontWeight:900,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_heavy.woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_permanent_marker.woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Petit Formal Script",variations:[{identifier:"imgly_font_petit_formal_script",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_petit_formal_script.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}}]},{fontFamily:"Rasa",variations:[{identifier:"imgly_font_rasa_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_regular.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_500",fontWeight:500,fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_500.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_black.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_light.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sue Ellen Francisco",variations:[{identifier:"imgly_font_sue_ellen_francisco",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sue_ellen_francisco.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}}]},{fontFamily:"Ultra",variations:[{identifier:"imgly_font_ultra",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_ultra.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}}]},{fontFamily:"Wolesbro",variations:[{identifier:"imgly_font_wolesbro",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_wolesbro.woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}]}];var SA=[{identifier:"imgly_transforms_common",defaultName:"Common Ratios",ratios:[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:4/3},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:16/9}]},{identifier:"imgly_transforms_facebook",defaultName:"Facebook",ratios:[{identifier:"imgly_transform_facebook_profile",defaultName:"Profile Pic",dimensions:{x:300,y:300},forceDimensions:!1,lockDimensions:!0},{identifier:"imgly_transform_facebook_ad",defaultName:"Ad",dimensions:{x:1200,y:627}},{identifier:"imgly_transform_facebook_post",defaultName:"Post",dimensions:{x:940,y:788}},{identifier:"imgly_transform_facebook_cover",defaultName:"Cover",dimensions:{x:851,y:315}}]}];var wA=[];typeof bt.Operations.SpriteOperation!="undefined"&&wA.push(bt.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush);var kA={TRANSFORM_RATIO_CATEGORIES:SA,FONTS:vA,TEXT_DESIGN_FONTS:CA,BRUSHES:wA};var L9=b(b({},Tc),{LOAD:"load",SAVE:"save",EDITOR_RESIZE:"editor:resize",ZOOM:"editor:zoom",ZOOM_CHANGED:"editor:zoom_changed",HISTORY_REDO:"history:redo",HISTORY_BEFORE_REDO:"history:before-redo",TEXT_SCALED:"editor:text:scaled",TRANSFORM_RESIZE:"transform:resize",TRANSFORM_AFTER_EDIT:"transform:after-edit",ADDED_STICKER:"sticker:added-sticker",SPRITES_DESELECTED:"editor:sprite:deselected-all",CANVAS_FOCUS:"canvas:focus"}),TA=L9;var ae={EVENTS:TA,DEFAULTS:kA};function z9(){let{userAgent:i,appVersion:t}=navigator;return t.indexOf("MSIE")!==-1?t.match(/MSIE\s+?([0-9]+)/i)[1]:i.indexOf("Trident")!==-1?i.match(/rv:([0-9]+)/i)[1]:!1}var DA={getIEVersion:z9};var U9=bt.Utils,{Vector2:vg}=bt.Math,N9={getInnerDimensionsForElement(i){let t=new vg(i.offsetWidth,i.offsetHeight),e=window.getComputedStyle(i,null);return t.x-=parseInt(e.getPropertyValue("padding-left"),10),t.x-=parseInt(e.getPropertyValue("padding-right"),10),t.y-=parseInt(e.getPropertyValue("padding-top"),10),t.y-=parseInt(e.getPropertyValue("padding-bottom"),10),t},getEventPosition(i){let t=i.clientX,e=i.clientY;if(i.type.indexOf("touch")!==-1){if(!i.touches.length)return;t=i.touches[0].clientX,e=i.touches[0].clientY}return new vg(t,e)},createTransparentPatternCanvas(){let i=document.createElement("canvas"),t=i.getContext("2d");return i.width=10,i.height=10,t.fillStyle="white",t.fillRect(0,0,i.width,i.height),t.fillStyle="#cccccc",t.fillRect(0,0,i.width/2,i.height/2),t.fillRect(i.width/2,i.height/2,i.width,i.height),i},supportsMSBlob(){return typeof document.createElement("canvas").msToBlob!="undefined"},translate(i,t,e={}){let r=this.fetch(i,t);if(!r)return j.info("Utils#translate",`Unable to translate \`${t}\``),null;for(let o in e)r=r.replace(`\${${o}}`,e[o]);return r},fetch(i,t,e){t=t.replace(/\[(\w+)]/g,".$1"),t=t.replace(/^\./,"");let r=t.split(".");for(let o=0;o<r.length;o++){let s=r[o];if(i=i[s],!i)break}return typeof i=="undefined"?!1:i},isMobile(){let i=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4))},select(i,t,e=null){e||(e=o=>o);let r=[];return t.forEach(o=>{i.forEach(s=>{e(s)===o&&r.push(s)})}),r},getJSONP(i){return new Bo(i).load()},cloneCategories(i,t){return i.map(e=>(e=U9.clone(e),e[t]=e[t].slice(0),e))},mergeCategories(i,t,e){i=this.cloneCategories(i,e);let r=null;return t.forEach(o=>{i.forEach(s=>{o.identifier===s.identifier&&(r=s)}),r?r[e]=r[e].concat(o[e]):i.push(o)}),i},wrapFiltersInCategories(i,t){return i.map(e=>{let r=e;return t in r||(r={identifier:`imgly_filters_wrapped-${e.identifier}`,displayFlat:!0,[t]:[e]}),r})},getStyleObject(i){let t=window.getComputedStyle(i),e={};for(let r in t){let o=t.getPropertyValue(r),s=r.replace(/-([a-z])/g,(n,a)=>a.toUpperCase());o!==""&&(e[s]=o)}return e},styleElement(i,t){for(let e in t)i.style[e]=t[e]},debounce(i,t,e){let r;return function(...o){let s=()=>{r=null,e||i.apply(this,o)},n=e&&!r;clearTimeout(r),r=setTimeout(s,t),n&&i.apply(this,o)}},getScrollbarWidth(){let i=document.createElement("div");i.style.visibility="hidden",i.style.width="100px",i.style.msOverflowStyle="scrollbar",document.body.appendChild(i);let t=i.offsetWidth;i.style.overflow="scroll";let e=document.createElement("div");e.style.width="100%",i.appendChild(e);let r=e.offsetWidth;return i.parentNode.removeChild(i),t-r},findIntegerFraction(i,t=100){let e=Number.MAX_VALUE,r=0,o=0,s=1,n=1;for(let a=0;a<t;a++){let l=s/n-i;if(l<0)s++;else if(l>0)n++;else return new vg(s,n);let c=Math.abs(s/n-i);c<e&&(e=c,r=s,o=n)}return new vg(r,o)},toFixed(i,t=2){let e=i.toFixed(t);return parseFloat(e)},capitalize(i){return i.charAt(0).toUpperCase()+i.slice(1)},flipObject(i){let t={};for(let e in i)t[i[e]]=e;return t},Browser:DA},Ii=N9;var{Base64:Cg}=bt,{Color:Ut}=bt,{ColorMatrix:Gvt}=bt.Math,{EventEmitter:xm}=bt;var Kt=bt.Utils,{RenderType:pa}=bt,{ImageFormat:Iv}=bt,Q=bt;var{Vector2:Ot}=bt.Math,{Rectangle:Vvt}=bt.Math,{Range:jvt}=bt.Math,$vt=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Vu();var $c=class{constructor(t,e,r=!1){this._ui=t,this._options=e,this._categoriesById={},this._filtersByIdentifier={identity:Q.Operations.FilterOperation.Filters.IdentityFilter},this._categories=Ii.wrapFiltersInCategories(js.DEFAULTS.FILTERS.slice(0),$c.CATEGORY_ITEMS_PROPERTY),this._customAssetsAllowed=r||t.getEditor().getSDK()._l.areCustomAssetsAllowed(),this._customAssetsAllowed&&this._options.categories&&(this._options.categories=Ii.wrapFiltersInCategories(this._options.categories,$c.CATEGORY_ITEMS_PROPERTY)),this._initCategories()}instantiateFilterWithIdentifier(t){let e={value:this._ui._options.crossOrigin,cors:!0},r=this.getFilterByIdentifier(t);if(!r)return Promise.reject(new Error(`Unknown filter with identifier \`${t}\`!`));if(!(r.prototype instanceof Q.Operations.FilterOperation.Filter)){let{lutImage:o,resolution:s,horizontalTileCount:n,verticalTileCount:a}=r,{lightColor:l,darkColor:c}=r;if(l&&c)return l=Ut.fromHex(l),c=Ut.fromHex(c),Promise.resolve(new Q.Operations.FilterOperation.Filters.DuoToneFilter({lightColor:l,darkColor:c}));let d;this._ui.getPreloader&&(d=this._ui.getPreloader().getAsset(o));let u;return d?u=Promise.resolve(d):u=cr.loadImage(this._ui.getAssetPath(o),e),u.then(()=>cr.loadImage(this._ui.getAssetPath(o),e).then(m=>new Q.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:m,resolution:s,horizontalTileCount:n,verticalTileCount:a})))}return Promise.resolve(new r)}_initCategories(){if(this._customAssetsAllowed&&this._options.categories&&(this._options.replaceCategories?this._categories=Ii.wrapFiltersInCategories(this._options.categories,$c.CATEGORY_ITEMS_PROPERTY):this._categories=Ii.mergeCategories(this._categories,this._options.categories,$c.CATEGORY_ITEMS_PROPERTY)),this._customAssetsAllowed&&this._options.availableFilters){let e=[];this._categories.forEach(r=>{let o=r.filters.filter(s=>this._options.availableFilters.indexOf(s.identifier)!==-1);o.length>0&&e.push({identifier:r.identifier,defaultName:r.defaultName,filters:o})}),this._categories=e}let t={identifier:"all",defaultName:"All",visible:!1,filters:this._categories.length<=0?[]:this._categories.map(e=>e.filters).reduce((e,r)=>e.concat(r))};this._categories.unshift(t),this._categoriesById.all=t,this._categories.forEach(e=>{this._categoriesById[e.identifier]=e}),t.filters.forEach(e=>{this._filtersByIdentifier[e.identifier]=e})}getFiltersForCategory(t){if(!this._categoriesById[t])throw new Error(`Unknown filter category '${t}'`);return this._categoriesById[t].filters}getItemsByCategory(t){return this.getFiltersForCategory(t)}getFilterByIdentifier(t){return this._filtersByIdentifier[t]}getCategories(){return this._categories}getCategoryByIdentifier(t){return this._categoriesById[t]}},Sg=$c;V(Sg,"CATEGORY_ITEMS_PROPERTY","filters");var wg=Sg;var kg=class extends Ct{},IA=kg;kg.prototype.availableOptions={fontFamily:{type:g.STRING,required:!0},variations:{type:g.ARRAY,required:!0}};var H9={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"},Tg=class extends Ct{getLabel(){let t=H9[this._options.fontWeight];switch(this._options.fontStyle){case"italic":t+=" Italic";break}return t}},Dg=Tg;Tg.prototype.availableOptions={identifier:{type:g.STRING,required:!0},fontFamily:{type:g.STRING,required:!0},fontWeight:{type:g.ALL,default:400},fontStyle:{type:g.STRING,default:"normal"},textMetrics:{type:g.OBJECT,default:null},provider:{type:g.STRING,available:["google","file"]},filePath:{type:g.STRING},default:{type:g.BOOLEAN,default:!1},font:{type:g.OBJECT}};var Ev=class{constructor(t,e){this._ui=t,this._options=e,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}_initFonts(){let{fonts:t,replaceFonts:e,availableVariations:r,isTextDesign:o}=this._options,s=!0;s=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed(),t&&s&&t.forEach(({variations:l},c)=>{l&&l.forEach((d,u)=>{if(_s[d.identifier]){let m=In(d.identifier,!0);t[c].variations[u].identifier=m;let{fontFamily:p}=ae.DEFAULTS.FONTS.find(f=>f.variations.some(v=>v.identifier===m));t[c].fontFamily=p}})});let n=o?ae.DEFAULTS.TEXT_DESIGN_FONTS:ae.DEFAULTS.FONTS;s&&(e?n=t:n=n.concat(t||[]));let a;n=n.map(l=>{let{fontFamily:c}=l,{variations:d}=l;if(s&&r&&(d=d.filter(m=>r.indexOf(m.identifier)!==-1)),d.length===0)return null;let u=new IA({fontFamily:c});return d=d.map(m=>{let p=new Dg(m);return p.setFontFamily(c),p.setFont(u),m.default&&!a&&(a=p),p.getTextMetrics()==null&&j.warn(`Missing font metrics for ${p.getIdentifier()}. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.`),this._variationsByIdentifier[p.getIdentifier()]=p,p}),u.setVariations(d),this._fontsByFontFamily[c]=u,u}).filter(l=>l),a||([a]=n[0].getVariations()),this._defaultVariation=a,this._fonts=n}getFonts(){return this._fonts}getFontByFontFamily(t){return this._fontsByFontFamily[t]}getVariationByIdentifier(t){return this._variationsByIdentifier[In(t)]}getVariationsByIdentifier(){return b({},this._variationsByIdentifier)}getDefaultVariation(){return this._defaultVariation}},Gi=Ev;var Av=class{constructor(t,e={}){this._ui=t,this._options=e,this._defaultLayouts=Q.Operations.SpriteOperation.TextDesignSprite.Layouts,this._legacyLayouts=Q.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts,this._layouts=[],this._init()}_init(){let{availableLayouts:t}=this._options,e=b(b({},this._defaultLayouts),this._legacyLayouts);this._layouts=Object.keys(e).map(r=>({identifier:e[r].identifier,layout:e[r]})),t&&(t.push(...Object.values(this._legacyLayouts).map(r=>r.identifier)),this._layouts=this._layouts.filter(r=>t.indexOf(r.identifier)>=0))}getLayoutByIdentifier(t){let e=Kt.Array.find(this._layouts,r=>r.identifier===t);return e&&e.layout}getLayouts(){return[...this._layouts]}getDefaultLayout(){return this.getLayouts()[0]}},$o=Av;var Fv=class{static downloadDataURL(t,e="photoeditorsdk-export"){let r=this.createBlobURLFromDataURL(t),o=this.getExtensionFromDataURL(t),s=document.createElement("a");s.download=`${e}.${o}`,s.href=r,document.body.appendChild(s),s.click(),document.body.removeChild(s)}static downloadMSBlob(t,e="photoeditorsdk-export"){navigator.msSaveBlob&&navigator.msSaveBlob(t,`${e}.png`)}static getExtensionFromDataURL(t){return t.split(",")[0].split(":")[1].split(";")[0].split("/").pop()}static createBlobURLFromDataURL(t){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array)return t;let e=Cg.decode(t.split(",")[1]),r=t.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(e.length),s=new Uint8Array(o);for(let a=0;a<e.length;a++)s[a]=e[a];let n=new window.Blob([o],{type:r});return window.URL.createObjectURL(n)}},vm=Fv;var Ov=class{constructor(t,e,r){this._sdk=t,this._options=e,this._download=r}export(){let t=this._getRenderType();return this._sdk.export(t,this._options.format,this._options.quality).then(e=>(this._download&&this._downloadData(t,e),e))}_downloadData(t,e){switch(t){case pa.DATAURL:vm.downloadDataURL(e,this._options.fileBasename);break;case pa.MSBLOB:vm.downloadMSBlob(e,this._options.fileBasename);break}}_getRenderType(){let t=this._options;return t.type!==pa.IMAGE||!this._download?t.type:Ii.supportsMSBlob()?pa.MSBLOB:pa.DATAURL}},EA=Ov;var Rv=class{constructor(t,e,r){this._editor=t,this._sdk=e,this._mediator=r,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack()}exists(t){return!!this._map[t]}add(t){let{identifier:e}=t.constructor;t.on("update",()=>{this._mediator.emit(ae.EVENTS.OPERATION_UPDATED,t)});let r=this._preferredOrder.indexOf(e);if(r===-1)throw new Error(`EditorOperations#add: \`${e}\` does not appear in \`operationsOrder\``);this._stack.set(r,t),this._map[e]=t,this._mediator.emit(ae.EVENTS.OPERATION_CREATED,t)}remove(t,e=!0){let r=typeof t=="object"?t.constructor.identifier:t,o=this._stack.getStack();t=this.get(r),delete this._map[r];let s=o.map(n=>n.constructor.identifier).indexOf(r);if(s!==-1){this._stack.removeAt(s);for(let n=s+1;n<o.length;n++){let a=o[n];!a||a.setDirty(!0)}e&&this._mediator.emit(ae.EVENTS.OPERATION_REMOVED,t)}}get(t){return this._map[t]}getOrCreate(t,e={}){if(this._map[t]){let s=this._map[t];return s.set(e,!1),s}let r=this._available[t],o=new r(this._sdk,e);return this.add(o),o}getStack(){return this._stack}reset(){this._map={}}_fixStack(){let t=this._stack.getStack().slice();this._stack.clear(),t.forEach(e=>{this.add(e)})}},AA=Rv;var Pv=class{constructor(t,e,r){this._image=t,this._maxPixels=e,this._maxDimensions=r}needsResize(){let t=new Ot(this._image.width,this._image.height),r=t.x*t.y>this._maxPixels,o=this._maxDimensions!==null&&(t.x>this._maxDimensions||t.y>this._maxDimensions);return r||o}resize(){let t=null,e=null,r=this._maxDimensions;return new Promise((o,s)=>{window.setTimeout(()=>{let a=new Ot(this._image.width,this._image.height).clone();if(a.x*a.y>this._maxPixels&&(a.copy(this._getDimensionsByMaxPixels()),t="maxMegaPixels"),r!==null&&(a.x>r||a.y>r)){let l=Math.min(r/a.x,r/a.y);a.multiply(l),t="maxDimensions"}a.floor(),e=this._createResizedImageCanvas(a),o({canvas:e,dimensions:a,reason:t})},1e3)})}_createResizedImageCanvas(t,e=t){let r=this._image,o=document.createElement("canvas");o.width=t.x,o.height=t.y;let s=t.clone().subtract(e).divide(2);return o.getContext("2d").drawImage(r,0,0,r.width,r.height,s.x,s.y,e.x,e.y),o}_getDimensionsByMaxPixels(){let t=this._image,e=this._maxPixels,r=t.width/t.height,o=t.height/t.width;return new Ot(Math.sqrt(e*r),Math.sqrt(e*o)).floor()}},FA=Pv;var W9=30,G9="abcdefghijklmnopqrstuvwxzy",Bv=class{constructor(t){this._fontVariation=t||new Dg({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}_createRuler(){this._ruler=document.createElement("div"),this._ruler.innerText=G9,document.body.appendChild(this._ruler),this._setRulerStyle()}_setRulerStyle(){this._ruler.style.cssText=`
      position: absolute;
      top: -9999px;
      left: -9999px;
      opacity: 0;
      display: inline-block;
      font: ${this._fontVariation.getFontStyle()} ${this._fontVariation.getFontWeight()} ${W9}px ${this._fontVariation.getFontFamily()};
    `}setFontVariation(t){this._fontVariation=t,this._setRulerStyle()}getWidth(){return this._ruler?this._ruler.offsetWidth:-1}dispose(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)}},Mv=Bv;var OA=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Vu(),V9=50,j9=5e3,Lv=class{constructor(t){this._fontVariation=t,this._defaultFontRuler=new Mv,this._customFontRuler=new Mv(this._fontVariation)}observe(){let t=OA();return new Promise((e,r)=>{let o=window.setInterval(()=>{if(this._defaultFontRuler.getWidth()!==this._customFontRuler.getWidth())return window.clearInterval(o),e();if(OA()-t>=j9){let n=new Error(`Failed to load font ${this._fontVariation.getFontFamily()}.`);return n.font=this._fontVariation,r(n)}},V9)})}dispose(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()}},RA=Lv;var zv=class{constructor(t){this._ui=t,this._fonts=[],this._observers=[]}add(t){this._fonts.push(t)}load(){return this._fonts.length===0?Promise.resolve():(this._observers=[],this._fonts.forEach(t=>{this._observers.push(new RA(t))}),z.executePromises(this._observers.map(t=>t.observe())))}dispose(){this._observers.forEach(t=>t.dispose())}},Ig=zv;var Uv=class extends Ig{load(){return Promise.resolve()}},PA=Uv;var $9={italic:"i"},Nv=class extends Ig{load(){return this._fonts.length&&this._addStylesheetTag(),super.load()}_addStylesheetTag(){let t=this._getFamiliesString(),e=document.createElement("link");e.rel="stylesheet",e.href=`https://fonts.googleapis.com/css?family=${t}`,document.getElementsByTagName("head")[0].appendChild(e)}_getFamiliesString(){let t={};this._fonts.forEach(r=>{let o=r.getFontFamily(),s=r.getFontStyle(),n=r.getFontWeight();t[o]=t[o]||[],typeof n!="undefined"?t[o].push(`${n}${$9[s]||""}`):t[o].push(400)});let e=[];for(let r in t){let o=t[r],s=o.length?`:${o.join(",")}`:"",n=r.replace(" ","+")+s;e.push(n)}return e.join("|")}},BA=Nv;var Hv=class{constructor(t,e){this._ui=t,this._fonts=e,this._loadedFonts=[]}setFonts(t){this._fonts=t}needsToLoad(){for(let t=0;t<this._fonts.length;t++){let e;if(this._fonts[t].getVariations().forEach(r=>{e=e||r.getProvider()}),!!e)return!0}}fontLoaded(t){let e=t.getFontFamily();return this._loadedFonts.indexOf(e)!==-1}setFontLoaded(t){if(!this.fontLoaded(t)){let e=t.getFontFamily();this._loadedFonts.push(e)}}load(){let t=this._fonts,e={google:new BA(this._ui),file:new PA(this._ui)},r=()=>{for(let s in e)e[s].dispose()};t.filter(s=>!this.fontLoaded(s)).forEach(s=>{s.getVariations().forEach(n=>{let a=n.getProvider();if(!a)return;e[a].add(n)})});let o=[];for(let s in e)o.push(e[s].load());return Promise.all(o).then(()=>{r(),t.forEach(s=>{this.setFontLoaded(s)})}).catch(s=>{throw r(),s})}},Yc=Hv;var Wv=class{constructor(t,e){this._ui=t,this._options=e,this._brushes=[],this._brushesById={},this._addBrushes(ae.DEFAULTS.BRUSHES);let{brushes:r,replaceBrushes:o,availableBrushes:s}=this._options;this._options.brushes&&this._addBrushes(r,o),s&&(this._brushes=this._brushes.filter(n=>s.indexOf(n.identifier)!==-1))}_addBrushes(t,e){e&&(this._brushes=[],this._brushesById={}),t.forEach(r=>{this._brushes.push(r),this._brushesById[r.identifier]=r})}getBrushByIdentifier(t){return this._brushesById[t]}getBrushes(){return this._brushes}getFirstBrush(){return this._brushes[0]}},MA=Wv;var LA=class{constructor(){this._assetsByGroupId={}}addAsset(t,e,r=!1){this._assetsByGroupId[t]?r?this._assetsByGroupId[t].unshift(e):this._assetsByGroupId[t].push(e):this._assetsByGroupId[t]=[e]}setAssets(t,e){this._assetsByGroupId[t]=e}getAssets(t){return this._assetsByGroupId[t]=this._assetsByGroupId[t]||[],this._assetsByGroupId[t]}},zA=LA;var Gv="imgly_sticker_custom",Vv=class{constructor(t,e,r){this._ui=t,this._options=e,this._dynamicAssetsLibrary=r||this._ui.getEditor().getDynamicAssetsLibrary()||new zA,this._categoriesById={},this._categories=[],this._stickersById={},this._customStickerCanvas=z.createCanvas(),this.reload()}reload(){this._categoriesById={},this._categories=[],this._stickersById={};let t=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();this._addCategories(js.DEFAULTS.STICKER_CATEGORIES);let{categories:e,replaceCategories:r}=this._options;if(t&&this._options.categories?this._addCategories(e,r):(this._updateCategoriesMap(),this._updateAllCategory()),t){let o=this._dynamicAssetsLibrary.getAssets("sticker");if(o.length>0){let s=this._createCustomStickerCategory(o);this._addCategories([s],!1,!0)}}}loadExternal(t){return new Bo(t).load().then(r=>{this._addCategories(r.categories,this._options.replaceCategories)})}_addCategories(t,e=!1,r=!1){e?this._categories=t.slice(0):r?this._categories=this._mergeCategories(t,this._categories):this._categories=this._mergeCategories(this._categories,t),this._updateCategoriesMap(),this._updateAllCategory()}_mergeCategories(t,e){t=Ii.cloneCategories(t,"stickers");for(let r of e){let o=!1;for(let s of t)if(r.identifier===s.identifier){for(let n of r.stickers){let a=!1;for(let l of s.stickers)if(n.identifier===l.identifier){Object.assign(l,n),a=!0;break}a||s.stickers.push(n)}o=!0;break}o||t.push(r)}return t}_updateCategoriesMap(){this._categoriesById={},this._categories.forEach(t=>{this._categoriesById[t.identifier]=t}),this._categories.forEach(t=>{t.stickers.forEach(e=>{this._stickersById[e.identifier]=e})}),typeof this._options.availableStickers!="undefined"&&this._options.availableStickers!==null&&(this._categories.forEach(t=>{t.identifier!==Gv&&(t.stickers=t.stickers.filter(e=>this._options.availableStickers.indexOf(e.identifier)!==-1))}),this._categories=this._categories.filter(t=>t.stickers.length>0)),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(t=>t.stickers).reduce((t,e)=>t.concat(e),[])},this._categoriesById.all=this._allCategory}renderStickerThumbnailFromImage(t){let e=this._customStickerCanvas,r=e.getContext("2d");r.save();let o=62,s=o/t.width,n=s*t.height;e.width=o,e.height=o,r.clearRect(0,0,t.width,t.height),r.translate(0,.5*(e.height-n)),r.scale(s,s),r.drawImage(t,0,0);let a=e.toDataURL("image/png");return r.restore(),{data:a,width:o,height:n}}addCustomStickerFromImage(t,e,r="none"){let o=_=>{let k=this._ui.getEditor().getSDK().getRenderer(),A=new Ot(_.width,_.height),B=this._ui.getEditor().getMaxMegapixels()*1e6,T=k.getMaxDimensions(),F=A.x*A.y>B,q=T!==null&&(A.x>T||A.y>T);if(F){let pt=_.width/_.height,xt=_.height/_.width;T=new Ot(Math.sqrt(B*pt),Math.sqrt(B*xt)).floor().max()}let Z=A.clone();return(F||q)&&(A.x/A.y>1?(Z.x=T,Z.y=T/A.x*A.y):(Z.x=T/A.y*A.x,Z.y=T)),Z},s=(_,D)=>{let k=_.x/_.y;return k>1?new Ot(D,D/k):new Ot(D*k,D)},n=t.src.substring(0,14)==="data:image/svg";t=this._ui.getEditor().getSDK().correctExifOrientation(t);let l=s(new Ot(t.width,t.height),2048),c=n?l:o(t),d=this._customStickerCanvas,u=d.getContext("2d");u.save();let m=this.renderStickerThumbnailFromImage(t);n?(t.width>t.height?(d.width=2048,d.height=2048/t.width*t.height):(d.height=2048,d.width=2048/t.height*t.width),t.width=d.width,t.height=d.height):(d.width=c.x,d.height=c.y,u.scale(c.x/t.width,c.y/t.height)),u.drawImage(t,0,0,t.width,t.height);let p=d.toDataURL();u.restore();let f={identifier:z.generateUUID(),defaultName:e||"",tintMode:r,images:{mediaThumb:{uris:[m.data],rawData:!0,width:m.width,height:m.height},mediaBase:{uris:n?[p,t.src]:[p],rawData:!0,isSVG:n,width:c.x,height:c.y}}},v=this._dynamicAssetsLibrary;v.addAsset("sticker",f,!0);let x=v.getAssets("sticker");if(x.length===1){let _=this._createCustomStickerCategory(x);this._addCategories([_],!1,!0)}else this.getCategory(Gv).stickers=x,this._updateAllCategory();this._updateCategoriesMap()}_createCustomStickerCategory(t){return{identifier:Gv,defaultName:"Custom",metaData:{backgroundImage:t[t.length-1].images.mediaBase.uris[0],rawData:!0},stickers:t}}getStickersForCategory(t){if(!this._categoriesById[t])throw new Error(`Unknown sticker category '${t}'`);return this._categoriesById[t].stickers}getStickerByIdentifier(t){return this._stickersById[t]}getCategories(t=!1){return t?[this._allCategory].concat(this._categories):this._categories}getCategory(t){return this._categoriesById[t]}static getURLForSticker(t,e="base"){let{images:r}=t,o=e==="base"&&r.mediaBase||r.mediaThumb,s=o.uris||[o.uri];if(!Ii.Browser.getIEVersion()){let a=s.filter(l=>/\.svg$/i.test(l));return a.length?a[0]:s[0]}let n=s.filter(a=>!/\.svg$/i.test(a));return n.length?n[0]:s[0]}},Kc=Vv;var UA=y(cg()),jv;typeof Q.Operations.SpriteOperation!="undefined"&&(jv=Q.Operations.SpriteOperation.BrushSprite);var Eg=class{constructor(t,e){this._editor=t,this._ui=this._editor.getUI(),this._data=e,this._filterManager=new wg(this._ui,this._getOptions("filter")),this._stickerManager=new Kc(this._ui,this._getOptions("sticker")),this._brushManager=new MA(this._ui,this._getOptions("brush")),this._fontManager=new Gi(this._ui,this._getOptions("text"))}_getOptions(t){let{controls:e}=this._editor,r={};e&&e.get(t)&&(r=e.get(t).defaultOptions);let o=this._editor.getOptions();return Kt.deepDefaults({},o.editor.controlsOptions[t]||{},r)}deserialize(){return this._validateVersion().then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_validateVersion(){return this._data.version!==this.constructor.version?Promise.reject(new Error(`Invalid version ${this._data.version}, expected ${this.constructor.version}`)):Promise.resolve()}_deserializeInputImage(){return new Promise((t,e)=>{let{data:r,type:o}=this._data.inputImage;if(r&&o){let s=new window.Image;s.addEventListener("load",()=>{this._editor.setImage(s),t()}),s.src=`data:${o};base64,${r}`}else t()})}_deserializeOperations(){return K(this,null,function*(){let{operations:t}=this._data;return UA.default(t,e=>K(this,null,function*(){return this._deserializeOperation(e)}))})}_deserializeOperation(t){switch(t.type){case"crop":return this._deserializeCropOperation(t);case"orientation":return this._deserializeOrientationOperation(t);case"filter":return this._deserializeFilterOperation(t);case"adjustments":return this._deserializeAdjustmentsOperation(t);case"sprite":return this._deserializeSpriteOperation(t);case"focus":return this._deserializeFocusOperation(t)}}_deserializeCropOperation(t){let{options:e}=t,{rotation:r}=e,o=Ot.fromObject(e.start),s=Ot.fromObject(e.end);r>Math.PI&&(r-=Math.PI*2);let n={start:o,end:s};typeof r!="undefined"&&(n.rotation=r);let a=this._editor.operations.getOrCreate("transform");return this._editor.broadcastTransform(a,n),a.set(n),Promise.resolve(a)}_deserializeOrientationOperation(t){let{options:e}=t,r=this._editor.operations.getOrCreate("orientation");return r?(r.set(e),Promise.resolve(r)):Promise.resolve()}_deserializeFilterOperation(t){let{options:e}=t;return this._filterManager.getFilterByIdentifier(e.name)?this._filterManager.instantiateFilterWithIdentifier(e.name).then(r=>{let o=this._editor.operations.getOrCreate("filter");return o.set({identifier:e.name,filter:r,intensity:e.intensity}),o}):(j.warn("Deserializer",`Unknown filter \`${e.name}\``),Promise.resolve())}_deserializeAdjustmentsOperation(t){let{AdjustmentsOperation:e}=Q.Operations,{options:r}=t,o=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],s={};return o.forEach(n=>{if(typeof r[n]=="undefined")return;let{minValue:a,midValue:l,maxValue:c}=e.prototype.availableOptions[n],d=r[n];d=d<0?l+(l-a)*d:l+(c-l)*d,s[n]=d}),Promise.resolve(this._editor.operations.getOrCreate("adjustments",s))}_deserializeSpriteOperation(t){let{options:e}=t,r=this._editor.operations.getOrCreate("sprite");if(!r)return Promise.resolve();let o=e.sprites.map(s=>this._deserializeSprite(r,s)).filter(s=>s);return Promise.all(o).then(s=>(r.setSprites(s.filter(n=>n)),r))}_deserializeSprite(t,e){switch(e.type){case"sticker":return this._deserializeSticker(t,e);case"text":return this._deserializeText(t,e);case"brush":return this._deserializeBrush(t,e);case"textdesign":return this._deserializeTextDesign&&this._deserializeTextDesign(t,e)}}_deserializeSticker(t,e){let{SpriteOperation:r}=Q.Operations,{options:o}=e,s=this._stickerManager.getStickerByIdentifier(o.name),n=this._stickerManager.getURLForSticker(s);return s?new Promise((a,l)=>{let c=new window.Image;c.addEventListener("load",()=>{let d=r.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:u,flipHorizontally:m,flipVertically:p}=o,f={identifier:o.name,image:c,position:Ot.fromObject(o.position),dimensions:Ot.fromObject(o.dimensions),rotation:u,flipHorizontally:m,flipVertically:p,adjustments:{}};typeof o.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(v=>{typeof o.adjustments[v]!="undefined"&&(f.adjustments[v]=o.adjustments[v]+d[v].default)}),a(t.createSticker(f))}),c.crossOrigin=this._editor.getCrossOrigin(),c.src=this._editor.getUI().getAssetPath(n)}):(j.warn("Deserializer",`Unknown sticker '${o.name}'. Skipping sprite.`),Promise.resolve())}_deserializeText(t,e){let{options:r}=e,{fontSize:o,lineHeight:s,fontFamily:n,fontWeight:a,alignment:l,rotation:c,maxWidth:d,color:u,backgroundColor:m}=r,p=new Yc(this._ui),f=this._fontManager.getFontByFontFamily(n);return f||(f=this._fontManager.getDefaultFont()),p.setFonts([f]),p.load().then(()=>{let v=t.createText({fontSize:o,lineHeight:s,fontFamily:n,fontWeight:a,alignment:l,rotation:c,maxWidth:d,text:r.text,color:Ut.fromArray(u),backgroundColor:Ut.fromArray(m),position:Ot.fromObject(r.position)});return v._edited=!0,v})}_deserializeBrush(t,e){let{options:r}=e,{paths:o}=r,s=t.createBrush();return o.forEach(n=>{this._deserializeBrushPath(s,n)}),Promise.resolve(s)}_deserializeBrushPath(t,e){let{points:r}=e,o=this._createBrushForPath(e),s=t.createPath(o);s.setClosed(!0),r.forEach(n=>{s.addControlPoint(Ot.fromObject(n))})}_createBrushForPath(t){let{color:e,size:r}=t,s={color:Ut.fromArray(e),size:r},n=this._brushManager.getFirstBrush();if(n.prototype&&n.prototype instanceof jv){let c=n;return new c(s)}let a=b({},n);delete a.image;class l extends jv{}return l.identifier=n.identifier,new l(b(b({},a),s))}_deserializeFocusOperation(t){let{options:e}=t.options;switch(t.options.type){case"radial":{let{position:r,radius:o,gradientRadius:s,blurRadius:n}=e;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:Ot.fromObject(r),radius:o,gradientRadius:s,blurRadius:n}))}case"linear":{let{start:r,end:o,size:s,gradientSize:n,blurRadius:a}=e;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:Ot.fromObject(r),end:Ot.fromObject(o),size:s,gradientSize:n,blurRadius:a}))}}}_getInputDimensionsForOperation(t){let e=!1,r=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(o=>{o===t&&(e=!0),!e&&(r=o.getNewDimensions(r))}),r}},Ag=Eg;Eg.version="1.0.0";var Xc=Math.PI*2,Fg=class{constructor(t){this._editor=t,this._serializeOperations=this._serializeOperations.bind(this)}serialize(t={}){this._options=b(b({},t),{image:!0});let e={version:this.constructor.version};return this._serializeInputImage(e).then(this._serializeOperations)}_serializeInputImage(t){let e=this._editor.getImage(),{width:r,height:o}=e;if(!this._options.image)return t.inputImage={width:r,height:o},Promise.resolve(t);let s=Kt.createCanvas();s.width=e.width,s.height=e.height,s.getContext("2d").drawImage(e,0,0);let a=s.toDataURL(Iv.PNG);return t.inputImage={type:Iv.PNG,data:a.replace(/^data:image\/(.*?);base64,/,""),width:r,height:o},Promise.resolve(t)}_serializeOperations(t){let e=[];return this._editor.operations.getStack().forEach(o=>{let s=this._serializeOperation(o,e);s&&e.push(s)}),t.operations=e.filter(o=>o),Promise.resolve(t)}_serializeOperation(t,e){switch(t.constructor.identifier){case"transform":return this._serializeTransformOperation(t);case"orientation":return this._serializeOrientationOperation(t);case"filter":return this._serializeFilterOperation(t);case"adjustments":return this._serializeAdjustmentsOperation(t);case"sprite":return this._serializeSpriteOperation(t,e);case"radial-focus":return this._serializeRadialFocusOperation(t);case"mirrored-focus":return this._serializeLinearFocusOperation(t);default:j.warn(`Unable to serialize operation of type ${t.constructor.identifier}`)}}_serializeTransformOperation(t){let e=t.serializeOptions(["start","end","rotation"],!0);return e.rotation=(e.rotation+Xc)%Xc,{type:"crop",options:e}}_serializeOrientationOperation(t){return{type:"orientation",options:t.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeFilterOperation(t){return t.getIdentifier()==="identity"?null:{type:"filter",options:{intensity:t.getIntensity(),name:t.getIdentifier()}}}_serializeAdjustmentsOperation(t){let{availableOptions:e}=t,r=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],o={};return r.forEach(s=>{let n=e[s],a=t.getOption(s),{minValue:l,midValue:c,maxValue:d}=n;o[s]=a<=c?(a-l)/(c-l)-1:(a-c)/(d-c)}),{type:"adjustments",options:o}}_serializeSpriteOperation(t,e){let r=e.filter(n=>n.type==="sprite"),o,s=!0;if(r.length?(o=r.pop(),s=!1):o={type:"sprite",options:{sprites:[]}},t.getSprites().forEach(n=>{let a=null;n instanceof t.constructor.StickerSprite?a=this._serializeSticker(t,n):n instanceof t.constructor.TextSprite?a=this._serializeText(t,n):n instanceof t.constructor.BrushSprite?a=this._serializeBrush(t,n):n instanceof t.constructor.TextDesignSprite&&(a=this._serializeTextDesign&&this._serializeTextDesign(t,n)),a&&o.options.sprites.push(a)}),s)return o}_serializeSticker(t,e){let r=e.getAdjustments(),o=e.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);o.name=o.identifier,delete o.identifier,o.rotation=(o.rotation+Xc)%Xc;let s=r.availableOptions;return o.adjustments={brightness:r.getBrightness()-s.brightness.default,saturation:r.getSaturation()-s.saturation.default,contrast:r.getContrast()-s.contrast.default},{type:"sticker",options:o}}_serializeText(t,e){let r=e.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return r.rotation=(r.rotation+Xc)%Xc,{type:"text",options:r}}_serializeBrush(t,e){return{type:"brush",options:{paths:e.getPaths().map(r=>this._serializePath(r))}}}_serializePath(t){let e=t.getBrush().serializeOptions(["color","size"],!0);return e.points=t.getControlPoints().map(r=>r.getPosition().toObject()),e}_serializeRadialFocusOperation(t){return{type:"focus",options:{type:"radial",options:t.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}}_serializeLinearFocusOperation(t){return{type:"focus",options:{type:"linear",options:t.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_getInputDimensionsForOperation(t){let e=!1,r=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(o=>{o===t&&(e=!0),!e&&(r=o.getNewDimensions(r))}),r}},Og=Fg;Fg.version="1.0.0";var Pg=class extends Ag{_deserializeOperation(t){return t.type==="selective-blur"?this._deserializeSelectiveBlurOperation(t):super._deserializeOperation(t)}_deserializeCropOperation(t){let{options:e}=t,{rotation:r}=e,o=Ot.fromObject(e.start),s=Ot.fromObject(e.end),n=e.dimensions?Ot.fromObject(e.dimensions):null;if(s.x-o.x<=0||s.y-o.y<=0)throw new Error(`A crop should not result in negative or zero dimensions - start: ${o} - end: ${s}`);r>Math.PI&&(r-=Math.PI*2);let a={start:o,end:s};typeof r!="undefined"&&(a.rotation=r);let l=this._editor.operations.getOrCreate("transform");if(!l)return Promise.resolve();if(this._editor.broadcastTransform(l,a),l.set(a),n){let c=s.clone().subtract(o),d=l.getInputDimensions(!1).multiply(c);l.setTextureScale(n.x/d.x)}return Promise.resolve(l)}},Bg=Pg;Pg.version="1.0.1";var HA=Math.PI*2,Mg=class extends Og{_serializeTransformOperation(t){let e=t.serializeOptions(["start","end","rotation","textureScale"],!0);return e.rotation=(e.rotation+HA)%HA,e.textureScale!==1&&(e.dimensions=t.getNewDimensions(t.getInputDimensions(!1))),delete e.textureScale,{type:"crop",options:e}}},Lg=Mg;Mg.version="1.0.1";var{OptionType:qc}=Q,Ug=class extends Q.Configurable{constructor(t,e={}){super(e);this._loaded=!1,this._loading=!1,this._ui=t,this._frame=Q.Utils.deepClone(this._options)}load(){if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=!0;let{imageGroups:t}=this._frame,e=[];return["top","left","right","bottom"].forEach(r=>{if(!(r in t))return;let o=t[r];["start","mid","end"].forEach(s=>{s in o&&e.push(this._loadPart(r,s))})}),Promise.all(e).then(()=>{this._loaded=!0,this._loading=!1}).catch(r=>{this._loaded=!1,this._loading=!1})}_loadPart(t,e){let{imageGroups:r}=this._frame,o=r[t][e],s=o;return typeof o!="string"&&"image"in o&&(s=o.image),cr.load(this._ui.getAssetPath(s)).then(n=>(typeof o!="string"?this._frame.imageGroups[t][e].image=n:this._frame.imageGroups[t][e]=n,n))}getFrame(){return this._frame}},GA=Ug;Ug.prototype.availableOptions={identifier:{type:qc.STRING,required:!0},defaultName:{type:qc.STRING},thumbnail:{type:qc.STRING},tintable:{type:qc.BOOLEAN,default:!1},layoutMode:{type:qc.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:qc.OBJECT,required:!0}};var $v=class{constructor(t,e){this._ui=t,this._options=e,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(js.DEFAULTS.FRAME_CATEGORIES),this._customAssetsAllowed=t.getEditor().getSDK()._l.areCustomAssetsAllowed();let{categories:r,replaceCategories:o}=this._options;this._customAssetsAllowed&&this._options.categories?this._addCategories(r,o):this._updateAllCategory()}_addCategories(t,e=!1){e?this._categories=t.slice(0):this._categories=Ii.mergeCategories(this._categories,t,"frames"),this._categoriesById={},this._categories.forEach(o=>{this._categoriesById[o.identifier]=o});let{availableFrames:r}=this._options;this._customAssetsAllowed&&r&&this._categories.forEach(o=>{o.frames=o.frames.filter(s=>r.indexOf(s.identifier)!==-1)}),this._categories.forEach(o=>{o.frames.forEach(s=>{this._framesById[s.identifier]=s})}),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(t=>t.frames).reduce((t,e)=>t.concat(e),[])},this._categoriesById.all=this._allCategory}getFramesForCategory(t){if(!this._categoriesById[t])throw new Error(`Unknown frame category '${t}'`);return this._categoriesById[t].frames}getFrameByIdentifier(t){return this._framesById[t]}getCategories(){return this._categories}getCategory(t){return this._categoriesById[t]}},VA=$v;var Yv=class{constructor(t,e){this._ui=t,this._options=e,this._overlays=js.DEFAULTS.OVERLAYS.slice(0),this._overlaysByIdentifier={};let r=t.getEditor().getSDK()._l.areCustomAssetsAllowed();r&&e.overlays&&(e.replaceOverlays?this._overlays=e.overlays:this._overlays=this._overlays.concat(e.overlays)),r&&e.availableOverlays&&(this._overlays=this._overlays.filter(o=>e.availableOverlays.indexOf(o.identifier)!==-1)),this._overlays.forEach(o=>{this._overlaysByIdentifier[o.identifier]=o})}getOverlays(){return this._overlays}getOverlayByIdentifier(t){return this._overlaysByIdentifier[t]}},jA=Yv;var{OverlayFilter:tn}=Q.Engine.Filters,Zc={[tn.BLEND_MODES.NORMAL]:"normal",[tn.BLEND_MODES.OVERLAY]:"overlay",[tn.BLEND_MODES.HARD_LIGHT]:"hard light",[tn.BLEND_MODES.SOFT_LIGHT]:"soft light",[tn.BLEND_MODES.MULTIPLY]:"multiply",[tn.BLEND_MODES.DARKEN]:"darken",[tn.BLEND_MODES.LIGHTEN]:"lighten",[tn.BLEND_MODES.SCREEN]:"screen",[tn.BLEND_MODES.COLOR_BURN]:"color burn"};var Z9=Kt.flipObject(Zc),Ng=class extends Bg{constructor(...t){super(...t);this._frameManager=new VA(this._ui,this._getOptions("frame"));let e=this._getOptions("overlay");e&&(this._overlayManager=new jA(this._ui,e))}_deserializeSprite(t,e){return e.type==="frame"?this._deserializeFrame(t,e):e.type==="overlay"?this._deserializeOverlay(t,e):super._deserializeSprite(t,e)}_deserializeOperation(t){return t.type==="transform"?this._deserializeTransformOperation(t):super._deserializeOperation(t)}_deserializeOrientationOperation(t){if(this._data.meta&&this._data.meta.platform!=="html5")return super._deserializeOrientationOperation(t);let{rotation:e,flipHorizontally:r,flipVertically:o}=t.options,s=e===90&&!r&&!o;return s|=e===90&&r&&o,s|=e===270&&!r&&!o,s|=e===270&&r&&o,s&&(t.options.flipHorizontally=!t.options.flipHorizontally,t.options.flipVertically=!t.options.flipVertically),super._deserializeOrientationOperation(t)}_deserializeTransformOperation(t){return super._deserializeCropOperation(t).then(e=>{if(!e)return;let r=Kt.Array.find(this._data.operations,o=>o.type==="orientation");if(r){let{options:o}=r,{rotation:s,flipHorizontally:n,flipVertically:a}=o;(s===90||s===270)&&(!n&&a||n&&!a)&&(n=!n,a=!a),e.rotate(o.rotation),n&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1)),a&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1))}return e})}_deserializeFrame(t,e){let{identifier:r}=e.options,o=this._frameManager.getFrameByIdentifier(r);if(!o)return j.warn("Deserializer",`Unknown frame \`${r}\`. Skipping frame.`),Promise.resolve();let s=new GA(this._ui,o);return s.load().then(()=>{this._editor.operations.getOrCreate("frame",{frame:s.getFrame()})})}_deserializeOverlay(t,e){let{blendMode:r,intensity:o,identifier:s}=e.options,n=this._overlayManager.getOverlayByIdentifier(s);if(!n)return j.warn("Deserializer",`Unknown overlay \`${s}\`. Skipping overlay.`),Promise.resolve();let a=this._editor.getUI().getAssetPath(n.image);return cr.load(a).then(l=>{this._editor.operations.getOrCreate("overlay",{alpha:o,identifier:s,blendMode:parseInt(Z9[r||n.blendMode],10),image:l})})}_createBrushForPath(t){let e=super._createBrushForPath(t);return typeof t.hardness!="undefined"&&e.hasOption("hardness")&&e.setHardness(t.hardness),e}_deserializeSticker(t,e){let{SpriteOperation:r}=Q.Operations,{options:o}=e,s=this._stickerManager.getStickerByIdentifier(o.identifier),n=Kc.getURLForSticker(s,"base");if(!s)return j.warn("Deserializer",`Unknown sticker \`${o.identifier}\`. Skipping sprite.`),Promise.resolve();let a=t.getInputDimensions(!1);return new Promise((l,c)=>{let d=new window.Image;d.addEventListener("load",()=>{let u=r.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:m,flipHorizontally:p,flipVertically:f}=o,v={identifier:o.identifier,image:d,position:Ot.fromObject(o.position),dimensions:Ot.fromObject(o.dimensions).multiply(a.min()),rotation:m,flipHorizontally:p,flipVertically:f,adjustments:{}};typeof o.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(x=>{typeof o.adjustments[x]!="undefined"&&(v.adjustments[x]=o.adjustments[x]+u[x].default)}),typeof o.tintColor!="undefined"&&typeof s.tintMode!="undefined"&&(v.tintColor=Ut.fromArray(o.tintColor),v.tintMode=s.tintMode),l(t.createSticker(v))}),d.crossOrigin=this._editor.getCrossOrigin(),d.src=this._editor.getUI().getAssetPath(n)})}_deserializeFilterOperation(t){let{options:e}=t;return this._filterManager.getFilterByIdentifier(e.identifier)?this._filterManager.instantiateFilterWithIdentifier(e.identifier).then(r=>{let o=this._editor.operations.getOrCreate("filter");if(!!o)return o.set({identifier:e.identifier,filter:r,intensity:e.intensity}),o}):(j.warn("Deserializer",`Unknown filter \`${e.identifier}\``),Promise.resolve())}_deserializeFocusOperation(t){let{options:e,type:r}=t.options;if(r!=="radial")return super._deserializeFocusOperation(t);let o=this._editor.getImage(),s=o.width/o.height,{start:n,end:a,gradientRadius:l,blurRadius:c}=e,d=Ot.fromObject(a).subtract(Ot.fromObject(n)).multiply(s,1).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:Ot.fromObject(n),radius:d,gradientRadius:l,blurRadius:c}))}_deserializeText(t,e){let{options:r}=e,{fontSize:o,lineHeight:s,fontIdentifier:n,alignment:a,rotation:l,maxWidth:c,color:d,backgroundColor:u}=r,m=new Yc(this._ui),p=this._fontManager.getVariationByIdentifier(n);return p?m.setFonts([p.getFont()]):p=this._fontManager.getDefaultFont(),m.load().then(()=>{let f=t.getInputDimensions(!1),v=c*f.min()/f.x,x=t.createText({fontSize:o,lineHeight:s,fontFamily:p.getFontFamily(),fontWeight:p.getFontWeight(),fontIdentifier:p.getIdentifier(),alignment:a,rotation:l,maxWidth:v,text:r.text,color:Ut.fromArray(d),backgroundColor:Ut.fromArray(u),position:Ot.fromObject(r.position)});return x._edited=!0,x})}},Hg=Ng;Ng.version="2.0.0";var Wg=class extends Lg{_serializeSticker(t,e){let r=t.getInputDimensions(!1),o=super._serializeSticker(t,e);return e.getTintMode()!=="none"&&(o.options.tintColor=e.serializeOption("tintColor",!0)),o.options.dimensions=e.getDimensions().clone().divide(r.min()).toObject(),o.options.identifier=o.options.name,delete o.options.name,o}_serializePath(t){let e=super._serializePath(t),r=t.getBrush();return r.hasOption("hardness")&&(e.hardness=r.getOption("hardness")),e}_serializeOperation(t,e){return t.constructor.identifier==="frame"?(this._serializeFrameOperation(t,e),null):t.constructor.identifier==="overlay"?(this._serializeOverlayOperation(t,e),null):super._serializeOperation(t,e)}_serializeFrameOperation(t,e){let r=e.filter(s=>s.type==="sprite"),o;r.length?o=r.pop():(o={type:"sprite",options:{sprites:[]}},e.push(o)),o.options.sprites.push({type:"frame",options:this._getFrameOptions(t)})}_serializeOverlayOperation(t,e){if(!t.getIdentifier())return;let r=e.filter(s=>s.type==="sprite"),o;r.length?o=r.pop():(o={type:"sprite",options:{sprites:[]}},e.push(o)),o.options.sprites.push({type:"overlay",options:{identifier:t.getIdentifier(),intensity:t.getAlpha(),blendMode:Zc[t.getBlendMode()]}})}_getFrameOptions(t){return{identifier:t.getFrame().identifier}}_serializeOrientationOperation(t){let e=super._serializeOrientationOperation(t);return(e.options.rotation===90||e.options.rotation===270)&&(e.options.flipHorizontally=!e.options.flipHorizontally,e.options.flipVertically=!e.options.flipVertically),e}_serializeTransformOperation(t){let{operations:e}=this._editor;if(e.exists("orientation")){t=t.clone();let o=e.get("orientation");t.rotate(-o.getRotation()),o.getFlipVertically()&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1)),o.getFlipHorizontally()&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1))}let r=super._serializeTransformOperation(t);return r.type="transform",r}_serializeText(t,e){let r=super._serializeText(t,e),o=t.getInputDimensions(!1);return r.options.fontIdentifier=e.getFontIdentifier(),r.options.maxWidth=r.options.maxWidth*o.x/o.min(),delete r.options.fontFamily,r}_serializeFilterOperation(t){let e=super._serializeFilterOperation(t);return e?(e.options.identifier=e.options.name,delete e.options.name,e):null}_serializeRadialFocusOperation(t){let e=super._serializeRadialFocusOperation(t),r=e.options.options;return r.start=r.position,delete r.position,r.end={x:r.start.x+r.radius,y:r.start.y},delete r.radius,e}},Gg=Wg;Wg.version="2.0.0";var Kv;typeof Q.Operations.SpriteOperation!="undefined"&&(Kv=Q.Operations.SpriteOperation.BrushSprite.Brush);var jg=class extends Hg{_deserializeSticker(t,e){let{SpriteOperation:r}=Q.Operations,{options:o}=e,s=this._stickerManager.getStickerByIdentifier(o.identifier);if(!s)return j.warn("Deserializer",`Unknown sticker \`${o.identifier}\`. Skipping sprite.`),Promise.resolve();let{mediaBase:n}=s.images,a=Kc.getURLForSticker(s,"base"),l=n.rawData?n.uris[0]:this._editor.getUI().getAssetPath(a),c=t.getInputDimensions(!1);return cr.load(l).then(d=>{let u=r.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:m,flipHorizontally:p,flipVertically:f}=o,v={identifier:o.identifier,image:d,position:Ot.fromObject(o.position),dimensions:Ot.fromObject(o.dimensions).multiply(c.min()),rotation:m||0,flipHorizontally:p,flipVertically:f,resizeMode:s.resizeMode||"keepAspect",adjustments:{}};return typeof o.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(x=>{typeof o.adjustments[x]!="undefined"&&(v.adjustments[x]=o.adjustments[x]+u[x].default)}),typeof o.tintMode!="undefined"&&typeof o.tintColor!="undefined"?(v.tintColor=Ut.fromArray(o.tintColor.rgba),v.tintMode=o.tintMode):typeof o.tintColor!="undefined"&&typeof s.tintMode!="undefined"&&(v.tintColor=Ut.fromArray(o.tintColor.rgba),v.tintMode=s.tintMode),typeof o.alpha!="undefined"&&(v.alpha=o.alpha),t.createSticker(v)})}_deserializeTransformOperation(t){return super._deserializeTransformOperation(t).then(e=>{if(!!e)return e._ratio=null,e})}_deserializeInputImage(){let{data:t,type:e,uri:r}=this._data.image;return t&&e&&(r=`data:${e};base64,${t}`),r?cr.load(r).then(o=>{this._editor.setImage(o)}):Promise.resolve()}_deserializeAdjustmentsOperation(t){let{AdjustmentsOperation:e}=Q.Operations;return super._deserializeAdjustmentsOperation(t).then(r=>{if(!r)return null;let{options:o}=t,s=["gamma","whites","blacks","temperature"],n={};return s.forEach(a=>{if(typeof o[a]=="undefined")return;let{minValue:l,midValue:c,maxValue:d}=e.prototype.availableOptions[a],u=o[a];u=u<0?c+(c-l)*u:c+(d-c)*u,n[a]=u}),r.set(n),r})}_deserializeFocusOperation(t){let{options:e}=t.options;switch(t.options.type){case"radial":return super._deserializeFocusOperation(t);case"linear":{let{start:r,end:o,blurRadius:s}=e;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:Ot.fromObject(r),controlPoint2:Ot.fromObject(o),blurRadius:s}))}case"mirrored":{let{start:r,end:o,size:s,gradientSize:n,blurRadius:a}=e;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:Ot.fromObject(r),end:Ot.fromObject(o),size:s,gradientSize:n,blurRadius:a}))}case"gaussian":{let{blurRadius:r}=e;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:r}))}}}_deserializeText(t,e){let{options:r}=e,{fontSize:o,lineHeight:s,fontIdentifier:n,alignment:a,rotation:l,maxWidth:c,color:d,backgroundColor:u}=r,m=this._ui.getFontLoader(),p=this._fontManager.getVariationByIdentifier(n);return p?m.setFonts([p.getFont()]):p=this._fontManager.getDefaultVariation(),m.load().then(()=>{let f=t.getInputDimensions(!1),v=c*f.min()/f.x,x=t.createText({fontSize:o,lineHeight:s,fontFamily:p.getFontFamily(),fontWeight:p.getFontWeight(),fontIdentifier:p.getIdentifier(),textMetrics:p.getTextMetrics(),alignment:a,rotation:l,maxWidth:v,text:r.text,color:Ut.fromArray(d.rgba),backgroundColor:Ut.fromArray(u.rgba),position:Ot.fromObject(r.position)});return x._edited=!0,x})}_createBrushForPath(t){let{identifier:e,color:r,size:o,hardness:s}=t.brush,a={color:Ut.fromArray(r.rgba),size:o};typeof s!="undefined"&&(a.hardness=s);let l=this._brushManager.getBrushByIdentifier(e);if(l||(l=this._brushManager.getFirstBrush()),l.prototype&&l.prototype instanceof Kv){let u=l;return new u(a)}let c=b({},l);delete c.image;class d extends Kv{}return d.identifier=l.identifier,new d(b(b({},c),a))}_deserializeFrame(t,e){return super._deserializeFrame(t,e).then(()=>{let r=this._editor.operations.get("frame"),{size:o,alpha:s,tintColor:n}=e.options,a={};typeof o!="undefined"&&(a.scale=o),typeof s!="undefined"&&(a.alpha=s),typeof n!="undefined"&&(a.tintColor=Ut.fromArray(n.rgba)),r.set(a)})}_deserializeTextDesign(t,e){let{options:r}=e,{position:o,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:c,width:d,seed:u,inverted:m}=r,{identifier:p}=r;p===Q.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?p=Q.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:p===Q.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(p=Q.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f=new $o(this._ui,this._getOptions("textdesign")),v=new Gi(this._ui,{fonts:ae.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:x}=t.constructor.TextDesignSprite,_=this._ui.getFontLoader(),D=f.getLayoutByIdentifier(p),k=new D;return _.setFonts(v.getFonts()),x.setFonts(b(b({},x.getFonts()),v.getVariationsByIdentifier())),_.load().then(()=>{let A=k.getImagePaths().map(B=>({path:B,fullPath:this._ui.getAssetPath(B),image:null}));return x.loadImages(A).then(()=>(k.onImagesLoaded(),t.createTextDesign({position:o,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:Ut.fromArray(c.rgba),width:d,seed:u,inverted:m,layout:k})))})}},$g=jg;jg.version="3.0.0";var Yg=class extends Ct{},Kg=Yg;Yg.prototype.availableOptions={identifier:{type:g.STRING,required:!0},defaultName:{type:g.STRING,required:!0},ratio:{type:g.ALL,required:!1,default:null},selected:{type:g.BOOLEAN,required:!1},dimensions:{type:g.VECTOR2,required:!1},lockDimensions:{type:g.BOOLEAN,required:!1,default:null},forceDimensions:{type:g.BOOLEAN,required:!1,default:null}};var Xg=class extends Gg{serialize(t={}){return super.serialize(t).then(e=>(e.meta={platform:"html5",version:this._editor.getSDK().version,createdAt:Kt.ISODateString(new Date)},e.image=e.inputImage,delete e.inputImage,e))}_serializeSticker(t,e){let r=super._serializeSticker(t,e);return r.options.alpha=e.getAlpha(),r.options.tintColor&&(r.options.tintColor={rgba:r.options.tintColor}),r}_serializeText(t,e){let r=super._serializeText(t,e);return r.options.color={rgba:r.options.color},r.options.backgroundColor={rgba:r.options.backgroundColor},r.options.flipHorizontally=!1,r.options.flipVertically=!1,delete r.options.fontWeight,r}_serializePath(t){let e=super._serializePath(t);delete e.hardness,delete e.size,delete e.color;let r=t.getBrush();e.brush=r.serializeOptions(["identifier","size","color"],!0),typeof e.brush.identifier=="undefined"&&delete e.brush.identifier,e.brush.color={rgba:e.brush.color};let o=r.getOption("hardness");return o!=="undefined"&&(e.brush.hardness=o),e}_serializeFrameOperation(t,e){super._serializeFrameOperation(t,e);let r=e.filter(s=>s.type==="sprite"),o;if(r.length){o=r.pop();let s=o.options.sprites.filter(l=>l.type==="frame")[0];t.getTintColor().equals(new Ut(1,1,1,0))||(s.options.tintColor={rgba:t.serializeOption("tintColor",!0)});let a=t.serializeOptions(["scale","alpha"],!0);s.options=b(b({},s.options),a),s.options.size=s.options.scale,delete s.options.scale}}_serializeTransformOperation(t){let e=super._serializeTransformOperation(t);if(t._ratio){let r;t._ratio instanceof Kg?r=t._ratio.getIdentifier():r=t._ratio.identifier,e.options.meta={identifier:r}}return delete e.options.scale,e}_serializeAdjustmentsOperation(t){let e=super._serializeAdjustmentsOperation(t),r=["gamma","whites","blacks","temperature"],{availableOptions:o}=t,s={};return r.forEach(n=>{let a=o[n],l=t.getOption(n),{minValue:c,midValue:d,maxValue:u}=a;s[n]=l<=d?(l-c)/(d-c)-1:(l-d)/(u-d)}),e.options=b(b({},e.options),s),e}_serializeOperation(t,e){switch(t.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(t);case"linear-focus":return this._serializeLinearFocusOperation(t);case"blur":return this._serializeBlurOperation(t);default:return super._serializeOperation(t,e)}}_serializeMirroredFocusOperation(t){return{type:"focus",options:{type:"mirrored",options:t.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_serializeLinearFocusOperation(t){let e=t.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],!0);return e.start=e.controlPoint1,delete e.controlPoint1,e.end=e.controlPoint2,delete e.controlPoint2,{type:"focus",options:{type:"linear",options:e}}}_serializeBlurOperation(t){return{type:"focus",options:{type:"gaussian",options:t.serializeOptions(["blurRadius"],!0)}}}},qg=Xg;Xg.version="3.0.0";var Jg=class extends $g{_deserializeTextDesign(t,e){let{options:r}=e,{position:o,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:c,width:d,seed:u,inverted:m}=r,{identifier:p}=r;p===Q.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?p=Q.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:p===Q.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(p=Q.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f=new $o(this._ui,this._getOptions("textdesign")),v=new Gi(this._ui,{fonts:ae.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:x}=t.constructor.TextDesignSprite,_=this._ui.getFontLoader(),D=f.getLayoutByIdentifier(p),k=new D;return _.setFonts(v.getFonts()),x.setFonts(b(b({},x.getFonts()),v.getVariationsByIdentifier())),_.load().then(()=>{let A=k.getImagePaths().map(B=>({path:B,fullPath:this._ui.getAssetPath(B),image:null}));return x.loadImages(A).then(()=>(k.onImagesLoaded(),t.createTextDesign({position:o,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:Ut.fromArray(c.rgba),width:d,seed:u,inverted:m,layout:k})))})}},Qg=Jg;Jg.version="3.1.0";var tb=class extends qg{_serializeTextDesign(t,e){let r=e.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted"],!0);r.color={rgba:r.color};let o=e.getLayout();return o&&(r.identifier=o.constructor.identifier),{type:"textdesign",options:r}}},eb=tb;tb.version="3.1.0";var rb=class extends Qg{_deserializeTextDesign(t,e){let{options:r}=e,{position:o,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:c,width:d,seed:u,inverted:m}=r,{identifier:p}=r;p===Q.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?p=Q.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:p===Q.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(p=Q.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);let f="padding"in r?r.padding/d:-1,v=new $o(this._ui,this._getOptions("textdesign")),x=new Gi(this._ui,{fonts:ae.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:_}=t.constructor.TextDesignSprite,D=this._ui.getFontLoader(),k=v.getLayoutByIdentifier(p),A=new k;return D.setFonts(x.getFonts()),_.setFonts(b(b({},_.getFonts()),x.getVariationsByIdentifier())),D.load().then(()=>{let B=A.getImagePaths().map(T=>({path:T,fullPath:this._ui.getAssetPath(T),image:null}));return _.loadImages(B).then(()=>(A.onImagesLoaded(),t.createTextDesign({position:o,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:Ut.fromArray(c.rgba),width:d,seed:u,inverted:m,layout:A,padding:f})))})}},ob=rb;rb.version="3.2.0";var sb=class extends eb{_serializeTextDesign(t,e){let r=e.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted","padding"],!0);r.color={rgba:r.color};let o=e.getLayout();return o&&(r.identifier=o.constructor.identifier),r.padding*=r.width,{type:"textdesign",options:r}}},nb=sb;sb.version="3.2.0";var lb=class extends ob{_deserializeOperation(t){return super._deserializeOperation(t)}_deserializeOrientationOperation(t){let{options:e}=t,r=this._editor.operations.getOrCreate("orientation");return r?(r.set(e),Promise.resolve(r)):Promise.resolve()}},cb=lb;lb.version="3.4.0";var db=class extends nb{_serializeOperation(t,e){switch(t.constructor.identifier){case"artfilter":return this._serializeStyle(t);default:return super._serializeOperation(t,e)}}_serializeOrientationOperation(t){return{type:"orientation",options:t.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeStyle(t){let{identifier:e,intensity:r,blendMode:o}=t.getOptions(),{tileEdgeLength:s,overlappingFactor:n}=t.getStyleTransferModel().getOptions();return{type:"artFilter",options:{identifier:e,intensity:r,blendMode:Zc[o],tileEdgeLength:s,overlappingFactor:n}}}},ub=db;db.version="3.4.0";var pb=class extends cb{_deserializeTextDesign(t,e){let{options:r}=e,{position:o,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:c,width:d,seed:u,inverted:m,identifier:p}=r,f="padding"in r?r.padding/d:-1,v=new $o(this._ui,this._getOptions("textdesign")),x=new Gi(this._ui,{fonts:ae.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:_}=t.constructor.TextDesignSprite,D=this._ui.getFontLoader(),k=v.getLayoutByIdentifier(p),A=new k;return D.setFonts(x.getFonts()),_.setFonts(b(b({},_.getFonts()),x.getVariationsByIdentifier())),D.load().then(()=>{let B=A.getImagePaths().map(T=>({path:T,fullPath:this._ui.getAssetPath(T),image:null}));return _.loadImages(B).then(()=>(A.onImagesLoaded(),t.createTextDesign({position:o,rotation:s,flipHorizontally:n,flipVertically:a,text:l,color:Ut.fromArray(c.rgba),width:d,seed:u,inverted:m,layout:A,padding:f})))})}},hb=pb;pb.version="3.5.0";var fb=class extends ub{},gb=fb;fb.version="3.5.0";var _b=class extends hb{_deserializeAdjustmentsOperation(t){let{AdjustmentsOperation:e}=Q.Operations;return super._deserializeAdjustmentsOperation(t).then(r=>{if(!r)return null;let{options:o}=t,s="sharpness",n={};if(typeof o[s]=="undefined")return;let{minValue:a,midValue:l,maxValue:c}=e.prototype.availableOptions[s],d=o[s];return d=d<0?l+(l-a)*d:l+(c-l)*d,n[s]=d,r.set(n),r})}},yb=_b;_b.version="3.6.0";var xb=class extends gb{_serializeAdjustmentsOperation(t){let e=super._serializeAdjustmentsOperation(t),r="sharpness",{availableOptions:o}=t,s={},n=o[r],a=t.getOption(r),{minValue:l,midValue:c,maxValue:d}=n;return s[r]=a<=c?(a-l)/(c-l)-1:(a-c)/(d-c),e.options=b(b({},e.options),s),e}},vb=xb;xb.version="3.6.0";var Sb=class extends yb{deserialize(){return this._validateVersion().then(()=>this._deserializeAssetLibrary()).then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_deserializeAssetLibrary(){return new Promise((t,e)=>{let r=this._data;if(!r.assetLibrary){t();return}let{assets:o}=r.assetLibrary,s=[];for(let n in o)s.push(this._deserializeCustomAssets(n,o[n]));return Promise.all(s).then(()=>{t()}).catch(n=>{console.error(n),e(n)})})}_deserializeCustomAssets(t,e){switch(t){case"stickers":return this._deserializeCustomStickerAssets(e);default:return Promise.reject(new Error(`Unknown asset type: ${t}`))}}_deserializeCustomStickerAssets(t){let e="none",r=this._editor.getOptions().editor;r&&r.controlsOptions&&r.controlsOptions.sticker&&(e=r.controlsOptions.sticker.customStickerTintMode||"none");let o=t.map(s=>new Promise((n,a)=>{let{identifier:l,raster:c}=s,d=s.svg!==void 0,u=`data:${c.type};base64,${c.data}`,m=new Li;m.onload=()=>{m=this._editor.getSDK().correctExifOrientation(m),m.toDataURL&&(u=m.toDataURL());let f={data:"",width:1,height:1};f=this._stickerManager.renderStickerThumbnailFromImage(m);let v={identifier:l,defaultName:s.name||"",tintMode:e,images:{mediaBase:{uris:[u],rawData:!0,isSVG:d,width:m.width,height:m.height},mediaThumb:{uris:[f.data],rawData:!0,width:f.width,height:f.height}}};if(d){let x=`data:image/svg+xml;base64,${s.svg.data}`;v.images.mediaBase.uris.push(x)}n(v)},m.onerror=()=>{a(new Error(`Invalid base64 data: ${u}`))},m.src=u}));return Promise.all(o).then(s=>{this._editor.getDynamicAssetsLibrary().setAssets("sticker",s),this._stickerManager.reload()})}},wb=Sb;Sb.version="3.7.0";var kb=class extends vb{serialize(t={}){return super.serialize(t).then(e=>this._serializeAssetLibrary(e).then(r=>r))}_serializeAssetLibrary(t){if(!this._editor.getDynamicAssetsLibrary)return Promise.resolve(t);let e=this._editor.getDynamicAssetsLibrary(),r=this._serializeCustomStickerAssets(t,e);return r.length===0||(t.assetLibrary={assets:{stickers:r}}),Promise.resolve(t)}_serializeCustomStickerAssets(t,e){let r=e.getAssets("sticker");if(r.length===0)return[];let o=t.operations.filter(a=>a.type==="sprite").flatMap(a=>a.options.sprites).filter(a=>a.type==="sticker").map(a=>a.options.identifier),s={};return o.forEach(a=>{s[a]=!0}),r.filter(a=>s[a.identifier]).map(a=>{let{identifier:l,defaultName:c,images:d}=a,u=d.mediaBase.uris[0],{isSVG:m}=d.mediaBase,f=/^data:(image\/(jpeg|png));base64,(.*)$/g.exec(u),v=f[1],x=f[3],_={identifier:l,name:c,raster:{type:v,data:x}};return c&&(_.name=c),m&&(_.svg={data:d.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}),_})}},Tb=kb;kb.version="3.7.0";var Ib=class extends wb{},Eb=Ib;Ib.version="3.8.0";var Ab=class extends Tb{_serializeSticker(t,e){let r=super._serializeSticker(t,e);return r.options.tintMode=e.getTintMode(),r}},Fb=Ab;Ab.version="3.8.0";var Rb=class extends Eb{_deserializeTransformOperation(t){return super._deserializeCropOperation(t).then(e=>{if(!e)return;let r=Kt.Array.find(this._data.operations,o=>o.type==="orientation");if(r){let{options:o}=r;e.rotate(o.rotation),o.flipHorizontally&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1)),o.flipVertically&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1))}return e._ratio=null,e})}_deserializeText(t,e){let{options:r}=e,{fontSize:o,lineHeight:s,fontIdentifier:n,alignment:a,rotation:l,maxWidth:c,color:d,backgroundColor:u}=r,m=this._ui.getFontLoader(),p=this._fontManager.getVariationByIdentifier(n);return p?m.setFonts([p.getFont()]):p=this._fontManager.getDefaultVariation(),m.load().then(()=>{let f=t.getInputDimensions(!1),v=f.min(),x=f.x,_=f.y,D=c*v/x,k=o*v/_,A=t.createText({fontSize:k,lineHeight:s,fontFamily:p.getFontFamily(),fontWeight:p.getFontWeight(),fontIdentifier:p.getIdentifier(),textMetrics:p.getTextMetrics(),alignment:a,rotation:l,maxWidth:D,text:r.text,color:Ut.fromArray(d.rgba),backgroundColor:Ut.fromArray(u.rgba),position:Ot.fromObject(r.position)});return A._edited=!0,A})}},eF=Rb;Rb.version="3.9.0";var iF=Math.PI*2,Pb=class extends Fb{_serializeTransformOperation(t){let{operations:e}=this._editor;if(e.exists("orientation")){t=t.clone();let s=e.get("orientation");s.getFlipVertically()&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1)),s.getFlipHorizontally()&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),t.rotate(-s.getRotation())}let r=t.serializeOptions(["start","end","rotation","textureScale"],!0);r.rotation=(r.rotation+iF)%iF,r.textureScale!==1&&(r.dimensions=t.getNewDimensions(t.getInputDimensions(!1))),delete r.textureScale;let o={type:"transform",options:r};if(t._ratio){let s;t._ratio instanceof Kg?s=t._ratio.getIdentifier():s=t._ratio.identifier,o.options.meta={identifier:s}}return delete o.options.scale,o}_serializeText(t,e){let r=t.getInputDimensions(!1),o=super._serializeText(t,e);return o.options.fontSize=o.options.fontSize*r.y/r.min(),o}},rF=Pb;Pb.version="3.9.0";var sF=class extends xm{constructor(t,e,r,o=!1){super();this._ui=t,this._options=e,this._mediator=r,this._shallow=o,o||(this._initSDK(),this.operations=new AA(this,this._sdk,this._mediator))}_initFonts(){let t=Kt.defaults(this._options.editor.controlsOptions.text,{additionalFonts:[],replaceFonts:!1,availableVariations:null});this._fontManager=new Gi(this._ui,t);let e=this._fontManager.getFonts(),r=this._ui.getFontLoader();r.setFonts(e),r.load()}setImage(t=this._options.editor.image,e=!0){e&&this.reset();let r=null;r=this._sdk.parseExif(t),this._setImage(t,r),this._initWatermark()}_initWatermark(){this._options.editor.watermarkImage&&(this._watermarkOperation=this.operations.getOrCreate("watermark",{image:this._options.editor.watermarkImage}))}_initSDK(){let{logLevel:t,displayWelcomeMessage:e,debug:r,license:o,crossOrigin:s}=this._options,{smoothDownscaling:n,smoothUpscaling:a,preferredRenderer:l,pixelRatio:c,transparent:d,clearColor:u}=this._options.editor,m;Array.isArray(u)?m=Ut.fromArray(u):typeof u=="string"?m=Ut.fromHex(u):u instanceof Ut&&(m=u.clone());let p={logLevel:t,debug:r,displayWelcomeMessage:e,pixelRatio:c,smoothDownscaling:n,smoothUpscaling:a,transparent:d,crossOrigin:s,clearColor:m,license:o};this._sdk=new Q(l,p)}getMaxMegapixels(){let{maxMegaPixels:t}=this._options.editor;return t}getCrossOrigin(){return Kt.getCrossOriginValue(this._options.crossOrigin||"anonymous")}getOutputDimensions(t=!1){return this._sdk.getOutputDimensions(t)}getOutputTextureDimensions(t=!1){return this._sdk.getOutputTextureDimensions(t)}getFinalDimensions(t=!1){return this._sdk.getFinalDimensions(t)}_setImage(t=this._options.editor.image,e=null){this._sdk.setAllOperationsToDirty(),this._options.editor.image=t,this._sdk.setImage(t,e)}_ensureImageIsResized(){let t=this._sdk.getImage(),e=this._sdk.getRenderer(),r=this.getMaxMegapixels(),o=r?r*1e6:null,s=e.getMaxDimensions(),n=new FA(t,o,s);return!this._resizedImage&&n.needsResize()?n.resize().then(({canvas:a,dimensions:l,reason:c})=>(this._resizedImage=a,this._sdk.setImage(a),a)):Promise.resolve(t)}export(t=!1){return this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty(),this._ensureImageIsResized().then(e=>{let r=this._options.editor.export;return new EA(this._sdk,r,t).export().then(s=>(this.emit("export",s),this._mediator.emit(ae.EVENTS.EXPORT,s,this),this._watermarkOperation&&(this._watermarkOperation.setEnabled(!0),this._sdk.render()),this._sdk.setAllOperationsToDirty(),s))})}broadcastTransform(t,e){let r=new Q.Operations.TransformOperation.TransformChange(t,e);["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"].forEach(s=>{let n=this.operations.get(s);!n||n.transform(r)})}broadcastFlip(t){["mirrored-focus","radial-focus","linear-focus","sprite","selective-blur"].forEach(r=>{let o=this.operations.get(r);!o||o.flip(t)})}broadcastRotate(t){["transform","mirrored-focus","linear-focus","radial-focus","sprite","selective-blur"].forEach(r=>{let o=this.operations.get(r);!o||o.rotate(t)})}_initSerializers(){this._serializers={"1.0.0":NA().default,"1.0.1":WA().default,"2.0.0":$A().default,"3.0.0":YA().default,"3.1.0":KA().default,"3.2.0":XA().default,"3.4.0":qA().default,"3.5.0":ZA().default,"3.6.0":JA().default,"3.7.0":QA().default,"3.8.0":tF().default,"3.9.0":oF().default}}serialize(t={},e="3.9.0"){let r=this._serializers[e];return r?new r(this).serialize(t):Promise.reject(new Error(`No serializer for version ${e} found.`))}deserialize(t){let e=this._serializers[t.version];return e?new e(this).deserialize(t):Promise.reject(new Error(`No serializer for version ${t.version} found.`))}save(t=!1,e=!1){let r=this._options.editor.save;return this.serialize({image:e}).then(o=>{let s=JSON.stringify(o,null,2);if(t){let n=`data:text/json;charset=utf-8;base64,${window.encodeURI(window.btoa(s))}`;vm.downloadDataURL(n,r.fileBasename)}return s})}reset(){this._sdk.reset(),this.operations.reset()}dispose(){this.stop(),this._sdk.dispose()}getRenderer(){return this._sdk.getRenderer()}getSDK(){return this._sdk}getInputDimensions(){return this._sdk.getInputDimensions()}getImage(){return this._sdk.getImage()}getOptions(){return this._options}getUI(){return this._ui}getMediator(){return this._mediator}},nF=sF;var Jc=i=>Kt.byteArrayToString(Cg.decode(i)),en=class extends xm{constructor(t={}){super();this._mediator=new xm,this._fontLoader=new Yc(this),this._options=t,this._initOptions(),this._initEvents(),this._disposed=!1,this._isReady=!1,this._editor=new nF(this,this._options,this._mediator),this._options.editor.image&&this._editor.setImage(this._options.editor.image),this._mediator.once(ae.EVENTS.EDITOR_READY,()=>{this._isReady=!0}),j.setLevel(this._options.logLevel),this._v()}export(...t){return this._editor.export(...t)}serialize(...t){return this._editor.serialize(...t)}deserialize(t){return this._editor.deserialize(t)}getEditor(){return this._editor}isReady(){return this._isReady}onReady(t){this._isReady?t():this._mediator.once(ae.EVENTS.EDITOR_READY,t)}createFilter(t){return new wg(this,this._getOptions("filter")).instantiateFilterWithIdentifier(t)}getTextDesignLayoutByID(t){let e=new $o(this,this._getOptions("textDesign"));return new(e.getLayoutByIdentifier(t))}getTextDesignAssetManager(){return Q.Operations.SpriteOperation.TextDesignSprite.AssetManager}getTextDesignFontManager(){return new Gi(this,{fonts:ae.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0,isTextDesign:!0})}_getOptions(t){let e=this.getEditor(),{controls:r}=e,o={};r&&r.get(t)&&(o=r.get(t).defaultOptions);let s=e.getOptions();return Kt.deepDefaults({},s.editor.controlsOptions[t]||{},o)}_initOptions(){if(this._options=Kt.defaults(this._options,{language:"en",logLevel:"warn",crossOrigin:"anonymous",editor:{},assets:{},responsive:!1,preloader:!0,autoRun:!0}),this._options.editor=Kt.defaults(this._options.editor||{},{enableZoom:!0,enableDrag:!0,enableExport:!0,enableKeyboardControls:!0,enablePositionSnapping:!0,enableRotationSnapping:!0,enableSave:!1,enableLoad:!1,pixelRatio:typeof window!="undefined"&&window.devicePixelRatio||1,preferredRenderer:"webgl",transparent:!0,clearColor:[0,0,0,0],displayResizeMessage:!0,maxMegaPixels:{},displayCloseButton:!1,undoMode:"global",defaultControl:"filter",forceCrop:!1,snappingOptions:{},tools:["transform","filter","adjustments","focus","text","textdesign","sticker","brush","frame","overlay","library","artfilter"],controlsOrder:[["library"],["artfilter","transform","filter","adjustments","focus"],["text","textdesign","sticker","brush","frame","overlay"]],operationsOrder:["exif-orientation","artfilter","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","linear-focus","blur","selective-blur","overlay","sprite","frame","watermark"],controlsOptions:{focus:{highQualityCanvasBlur:!1}}}),this._options.editor.snappingOptions=Kt.defaults(this._options.editor.snappingOptions,{position:{},rotation:{}}),this._options.editor.snappingOptions.position=Kt.defaults(this._options.editor.snappingOptions.position,{padding:{},threshold:20}),this._options.editor.snappingOptions.position.padding=Kt.defaults(this._options.editor.snappingOptions.position.padding,{left:.1,right:.1,top:.1,bottom:.1}),this._options.editor.snappingOptions.rotation=Kt.defaults(this._options.editor.snappingOptions.rotation,{angles:[0,45,90,135,180,225,270,315],threshold:20}),this._options.editor.controlsOptions.focus=Kt.defaults(this._options.editor.controlsOptions.focus,{highQualityCanvasBlur:!1}),this._options.editor.maxMegaPixels=Kt.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=Kt.defaults(this._options.editor.export||{},{format:"image/png",type:pa.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.editor.save=Kt.defaults(this._options.editor.save||{},{format:"text/json",download:!0,fileBasename:"photoeditorsdk-save"}),this._options.extensions=Kt.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=Kt.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null}),!(this._options.editor.image instanceof window.Image)){let t=new window.Image;this._options.editor.image&&(t.src=this._options.editor.image,this._options.editor.image=t)}}_v(){return this[Jc("X29wdGlvbnM=")][Jc("bGljZW5zZQ==")]?!0:(j.error(Jc("TGljZW5zaW5n"),Jc("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbg==")),j.error(Jc("TGljZW5zaW5n"),Jc("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)}_initEvents(){this._mediator.pipeEvents(this)}_disposeEvents(){this._mediator.unpipeEvents(this)}setImage(t){this._editor.setImage(t)}getAssetPath(t,e=!1,r=!1){let{baseUrl:o,resolver:s}=this._options.assets,n=`${o}/${t}`;s=s||(d=>d),t.match(/(ftp|http|https):\/\//)&&(n=t);let a=t.replace(/assets\//,"").split("/"),l=a[0],c={};switch(l){case"art-filters":return c={identifier:a[1],type:a[2].split(".")[0]},s("art-filter",c);case"filters":return c={identifier:a[1].replace(/\.png$/g,"")},s("filter",c);case"fonts":return c={identifier:a[1].replace(/\.(woff|otf|ttf)$/g,"")},s("font",c);case"frames":return c={identifier:a[1],filename:a[2]},s("frame",c);case"overlays":return c={identifier:a[1].replace(/\.(png|jpg|jpeg)$/g,"")},s("overlay",c);case"stickers":{let d=a[3].endsWith(".svg"),u=a[3]==="thumbs";return c={category:a[1],identifier:(d?a[3]:a[4]).replace(/\.(png|svg)$/g,""),variant:d?"svg":u?"thumb":"base"},s("sticker",c)}case"text-design":return c={type:a[1]==="fonts"?"font":"image",identifier:a[2].replace(/\.(png|otf|ttf|woff2?)$/g,"")},s("text-design",c)}return typeof s!="undefined"&&s!==null&&(n=s(n)),n}getFontLoader(){return this._fontLoader}dispose(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._disposeEvents()}render(t){return this.deserialize(t).then(()=>this.export())}};en.prototype.identifier="engine-wrapper";en.Constants=ae;en.Events=ae.EVENTS;en.Utils=Ii;en.JSONLoader=Bo;en.SDK=Q;var st={};ne(st,{absoluteToRelativePoint:()=>k7,absoluteToRelativeSize:()=>S7,getBaseLocalToWorldMatrix:()=>Mb,getLocalToParentMatrix:()=>lF,getLocalToWorldMatrix:()=>Qc,getPointInWorldSpace:()=>Zv,getRotationBetweenCoordinateSpaces:()=>T7,getScalarInWorldSpace:()=>x7,getSizeInOutputSpace:()=>v7,getSizeInWorldSpace:()=>cF,pointFromSpaceToSpace:()=>Cm,rectTransformToAffineTransform:()=>Xv,relativeToAbsolutePoint:()=>w7,relativeToAbsoluteSize:()=>C7,scalarFromSpaceToSpace:()=>qv,sizeFromSpaceToSpace:()=>y7});function aF(i){return i.x!==void 0}function Xv(i){return It.fromTRS(i.position.x,i.position.y,i.rotation,i.scale.x,i.scale.y)}function _7(i){return i.getBaseLocalToParentMatrix?i.getBaseLocalToParentMatrix():Xv(i.getTransform())}function Mb(i){let t=i.getParent(),e=_7(i);if(t===void 0)return e;let r=Mb(t);return It.multiply(r,e)}function lF(i){return i.getLocalToParentMatrix?i.getLocalToParentMatrix():Xv(i.getTransform())}function Qc(i){let t=i.getParent(),e=lF(i);if(t===void 0)return e;let r=Qc(t);return It.multiply(r,e)}function Cm(i,t,e,r=!1){let o=t.type==="output"&&r?Mb(t):Qc(t),s=e.type==="output"&&r?Mb(e):Qc(e),n=It.getInverted(s);return It.transformPoint(n,It.transformPoint(o,i))}function qv(i,t,e){let r=new R(i,0),o=new R(Cm(r,t,e)),s=new R(Cm(R.ZERO,t,e));return R.distance(s,o)}function y7(i,t,e){let r=aF(i)?i.x:i.width,o=aF(i)?i.y:i.height,s=qv(r,t,e),n=qv(o,t,e);return{width:s,height:n}}function Zv(i,t){let e=Qc(t);return It.transformPoint(e,i)}function x7(i,t){let e=new R(i,0),r=new R(Zv(e,t)),o=new R(Zv(R.ZERO,t));return R.distance(r,o)}function cF(i){let t=Qc(i),e=i.getBounds(),r={x:e.width,y:0},o={x:0,y:e.height},s=new R(It.transformPoint(t,R.ZERO)),n=new R(It.transformPoint(t,r)),a=new R(It.transformPoint(t,o)),l=R.distance(s,n),c=R.distance(s,a);return{width:l,height:c}}function v7(i,t){let e=cF(i),r=t.getTransform().scale,o={x:1/r.x,y:1/r.y};return{width:e.width*o.x,height:e.height*o.y}}function C7(i,t){let e=t.getBounds();return{width:i.width*e.width,height:i.height*e.height}}function S7(i,t){let e=t.getBounds();return{width:i.width/e.width,height:i.height/e.height}}function w7(i,t,e=!0){let r=t.getBounds();return{x:i.x*r.width+(e?0:r.minX),y:i.y*r.height+(e?0:r.minY)}}function k7(i,t,e=!0){let r=t.getBounds();return{x:(i.x-(e?0:r.minX))/r.width,y:(i.y-(e?0:r.minY))/r.height}}function T7(i,t){let r=Cm({x:1,y:0},i,t,!0),o=Cm(R.ZERO,i,t,!0);return Math.atan2(r.y-o.y,r.x-o.x)}function Lb(i){return typeof i!="string"&&!Array.isArray(i)&&i.a===void 0}function zb(i){return typeof i!="string"&&Array.isArray(i)&&i.length===3}function Ub(i){return typeof i!="string"&&!Array.isArray(i)&&i.a!==void 0}function Nb(i){return typeof i!="string"&&Array.isArray(i)&&i.length===4}function dF(i){return typeof i=="string"}var ha;(function(i){i.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",i.IMAGE_DOWNSCALED="imageDownscaled"})(ha||(ha={}));var Jv=class{constructor(t,e){this.engine=e;this.transform=qt.IDENTITY;this.canvasPivot={x:0,y:0};this.previewQuality=1;this.canvas=t}get quality(){return this.previewQuality}setQuality(t){this.previewQuality=Math.min(Math.max(t,.01),1)}getTransform(){return this.transform}setTransform(t){this.transform=t}getPosition(){return this.transform.position}setPosition(t,e){let r;typeof t=="number"?r={x:t,y:e===void 0?t:e}:r=t;let{scale:o}=this.transform,{rotation:s}=this.transform;this.setTransform(new qt(r,o,s))}getScale(){return this.transform.scale}setScale(t,e){let r;typeof t!="number"?r=t:r={x:t,y:e===void 0?t:e};let{position:o}=this.transform,{rotation:s}=this.transform;this.setTransform(new qt(o,r,s))}getRotation(){return this.transform.rotation}setRotation(t){let{position:e}=this.transform,{scale:r}=this.transform;this.setTransform(new qt(e,r,t))}getCanvasPivot(){return this.canvasPivot}setCanvasPivot(t,e){typeof t=="number"?this.canvasPivot={x:t,y:typeof e===void 0?t:e}:this.canvasPivot=t}getCanvasBounds(){let t=this.canvasPivot,{width:e,height:r}=this.canvas;return new ze(-t.x*e,-t.y*r,e,r)}};function Hb(i){return i.getTransform!==void 0}function uF(i){return i.getContainer!==void 0}var Qv=class extends Ri{constructor(t){super();this.config=t}getOutputDimensions(){let t=this.getOutputContainer();return t?t.getResolution():{width:0,height:0}}getSmallerOutputSide(){let t=this.getOutputContainer();if(!t)return 0;let e=t.getResolution();return Math.min(e.width,e.height)}convertPointFromPreviewIntoOutputSpace(t,e){let r=It.getInverted(st.rectTransformToAffineTransform(e));return It.transformPoint(r,t)}convertPointFromPreviewIntoWorldSpace(t,e,r){let o=It.getInverted(st.rectTransformToAffineTransform(e)),s=r?this.getOutputContainer().getBaseLocalToParentMatrix():this.getOutputContainer().getLocalToParentMatrix(),n=It.multiply(s,o);return It.transformPoint(n,t)}convertPointFromPreviewIntoFlippedPreviewSpace(t){let e=this.getOutputContainer().getFlipTransformMatrix();return It.transformPoint(e,t)}convertPointFromWorldIntoPreviewSpace(t,e){let r=st.rectTransformToAffineTransform(e),o=It.getInverted(this.getOutputContainer().getLocalToParentMatrix()),s=It.multiply(r,o);return It.transformPoint(s,t)}convertPointFromOutputIntoPreviewSpace(t,e){let r=st.rectTransformToAffineTransform(e);return It.transformPoint(r,t)}getContainersAtPreviewPoint(t,e){let r=new Array,o=this.convertPointFromPreviewIntoWorldSpace(t,e),s=this.getRootContainers();for(let n of s)this.accumulateContainersAtWorldPointInHierarchy(o,n,r);return r}isPreviewPointInContainer(t,e,r){let o=this.convertPointFromPreviewIntoWorldSpace(t,r);return this.isWorldPointInContainer(o,e)}isWorldPointInContainer(t,e){let r=st.getLocalToWorldMatrix(e),o=It.getInverted(r),s=It.transformPoint(o,t);return ze.contains(e.getBounds(),s)}accumulateContainersAtWorldPointInHierarchy(t,e,r){this.isWorldPointInContainer(t,e)&&r.push(e);let o=e.getChildren();for(let s of o)Hb(s)&&this.accumulateContainersAtWorldPointInHierarchy(t,s,r)}};var Ye=class{constructor(t){this.engine=t;this.id=Vr()}getID(){return this.id}getContainer(){return this.engine.getRootContainers()[0]}getIndexInParent(){let{rootOperations:t}=this.engine;for(let e=0;e<t.length;e+=1)if(t[e].getID()===this.id)return e;return-1}setIndexInParent(t){this.engine.moveIndex(this,t)}isValid(){return this.getIndexInParent()!==-1}};var tC=class extends Ye{constructor(t,e,r){super(e);this.operation=r;this.type="adjustments";this.setProperties(t)}getProperties(){let t=this.operation.getOptions(),e=t.gamma-1;return{brightness:t.brightness||0,saturation:t.saturation||0,contrast:t.contrast||0,gamma:(e<0?2*e:e)||0,clarity:t.clarity||0,exposure:t.exposure||0,shadows:t.shadows*.5||0,highlights:t.highlights||0,whites:t.whites||0,blacks:t.blacks||0,temperature:t.temperature||0,sharpness:t.sharpness||0}}setProperties(t){t.gamma!==void 0&&(t.gamma=1+(t.gamma<0?.5*t.gamma:t.gamma)),t.shadows&&(t.shadows=t.shadows*2),this.operation.set(t)}getOperation(){return this.operation}getTypeIdentifier(){return"adjustments"}};var Vi=i=>{if(Ub(i))return new Q.Color(i.r,i.g,i.b,i.a);if(Nb(i))return new Q.Color(i[0],i[1],i[2],i[3]);if(Lb(i))return new Q.Color(i.r,i.g,i.b,1);if(zb(i))return new Q.Color(i[0],i[1],i[2],1);if(dF(i)){let[t,e,r]=i.match(/[0-9A-fa-f]{1,2}/g);return new Q.Color(parseInt(t,16)/255,parseInt(e,16)/255,parseInt(r,16)/255,1)}throw new Error("Invalid color type")};var Ht=class{get x(){return this._x}get y(){return this._y}constructor(t=0,e=0){this._x=t,this._y=e}set(t,e){return this._x=t,this._y=e,this}clone(){return new Ht(this._x,this._y)}copy(t){return this._x=t.x,this._y=t.y,this}clamped(t=this,e=this){let r=typeof t=="number"?{x:t,y:t}:t,o=typeof e=="number"?{x:e,y:e}:e;return this._x=Math.max(r.x,this._x),this._y=Math.max(r.y,this._y),this._x=Math.min(o.x,this._x),this._y=Math.min(o.y,this._y),this}divide(t,e){return typeof t=="number"||t===null?(this._x/=t,this._y/=typeof e=="undefined"?t:e):(this._x/=t.x,this._y/=t.y),this}subtract(t,e){return typeof t=="number"||t===null?(this._x-=t,this._y-=typeof e=="undefined"?t:e):(this._x-=t.x,this._y-=t.y),this}multiply(t,e){return typeof t=="number"||t===null?(this._x*=t,this._y*=typeof e=="undefined"?t:e):(this._x*=t.x,this._y*=t.y),this}add(t,e){return typeof t=="number"||t===null?(this._x+=t,this._y+=typeof e=="undefined"?t:e):(this._x+=t.x,this._y+=t.y),this}dot(t,e){return typeof t=="number"||t===null?this._x*t+this._y*(typeof e=="undefined"?t:e):this._x*t.x+this._y*t.y}equals(t,e){return typeof t=="number"||t===null?t===this._x&&e===this._y:t.x===this._x&&t.y===this._y}flip(){let t=this._x;return this._x=this._y,this._y=t,this}round(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this}ceil(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this}floor(){return this._x=this._x|0,this._y=this._y|0,this}abs(){return this._x=Math.abs(this._x),this._y=Math.abs(this._y),this}len(){return Math.sqrt(this._x*this._x+this._y*this._y)}min(){return Math.min(this._x,this._y)}max(){return Math.max(this._x,this._y)}toObject(){return{x:this._x,y:this._y}}toString(){return`Vector2({ x: ${this._x}, y: ${this._y} })`}roundDecimal(t){return this._x=parseFloat(this._x.toFixed(t)),this._y=parseFloat(this._y.toFixed(t)),this}asArray(t=!1){return t?[this._y,this._x]:[this._x,this._y]}static fromObject(t){return new Ht(t.x,t.y)}static fromSize(t){return new Ht(t.width,t.height)}static get NULL(){return new Ht(0,0)}};var pr=class{constructor(t){this.engine=t;this.id=Vr(),this.transform=qt.IDENTITY,this.bounds=ze.ZERO}getID(){return this.id}getParent(){let t=this.engine.getRootContainers();if(!(t.length===0||this.id===t[0].id))return t[0]}getIndexInParent(){let{rootOperations:t}=this.engine;for(let e=0;e<t.length;e+=1)if(t[e].getID()===this.id)return e;return-1}setIndexInParent(t){this.engine.moveIndex(this,t)}getChildren(){let t=this.engine.getRootContainers();return t.length>0&&(this.id===t[0].id||this.id===this.engine.getOutputContainer().id)?this.engine.rootOperations:[]}getBounds(){return this.bounds}setPivotOnSelfAndSprite(t,e,r){typeof e=="number"?(this.setPivotInternal(e,r),t.setPivot(new Ht(e,r))):(this.setPivotInternal(e),t.setPivot(Ht.fromObject(e)))}setPivot(t,e){this.setPivotInternal(t,e)}getPivot(){let t=this.getBounds();return{x:-t.minX/t.width,y:-t.minY/t.height}}getTransform(){return this.transform}setTransform(t){this.transform=t}updateTransform(){this.setTransform(this.transform)}getPosition(){return this.transform.position}setPosition(t,e){let r;typeof t=="number"?r={x:t,y:e===void 0?t:e}:r=t;let{scale:o}=this.transform,{rotation:s}=this.transform;this.setTransform(new qt(r,o,s))}getScale(){return this.transform.scale}setScale(t,e){let r;typeof t!="number"?r=t:r={x:t,y:e===void 0?t:e};let{position:o,rotation:s}=this.transform;this.setTransform(new qt(o,r,s))}getRotation(){return this.transform.rotation}setRotation(t){let{position:e,scale:r}=this.transform;this.setTransform(new qt(e,r,t))}getSizeInWorldSpace(){return st.getSizeInWorldSpace(this)}getSizeInOutputSpace(){return st.getSizeInOutputSpace(this,this.engine.getOutputContainer())}setSizeInWorldSpace(t){let e=this.getBounds();this.setScale(t.width/e.width,t.height/e.height)}setSizeInOutputSpace(t){let e=this.engine.getOutputContainer().getScale();this.setSizeInWorldSpace({width:t.width/e.x,height:t.height/e.y})}isValid(){return this.getIndexInParent()!==-1}setPivotInternal(t,e){let r=this.getBounds();typeof t=="number"?this.setBoundsFromSize(r.width,r.height,{x:t,y:e}):this.setBoundsFromSize(r.width,r.height,t)}setBoundsFromSize(t,e,r=this.getPivot()){this.bounds=new ze(-r.x*t,-r.y*e,t,e)}};var eC=class extends pr{constructor(t,e){super(e);this.type="drawing";this.drawing=t,this.operation=e.createSpriteOperation(),this.sprite=this.operation.createBrush({}),this.operation.addSprite(this.sprite),this.radialBrush=this.sprite._createRadialBrush();let o=e.getRootContainers()[0].getBounds();this.bounds=new ze(0,0,o.width,o.height),this.setTransform(qt.IDENTITY),this.operation.setDirty(!0),this.setData(t)}beginStroke(t){if(this.currentStroke)throw new Error("A brush stroke has already been started but not finished.");if(t.id!=="imgly_brush_radial")throw new Error("This adapter does not support any brush faces other than the radial img.ly brush.");this.currentBrush=t,this.currentStroke={brush:t,path:{controlPoints:[]}},this.radialBrush.setColor(Vi(t.color)),this.radialBrush.setHardness(t.hardness),this.radialBrush.setSize(t.size),this.currentPath=this.sprite.createPath(this.radialBrush.clone())}addPointToCurrentStroke(t,e=!0){if(!this.currentStroke||!this.currentBrush||!this.currentPath)throw new Error('A brush stroke has to first be started with a call to "beginStroke(brush:Brush)"');if(this.currentStroke.path.controlPoints.length){let l=this.currentStroke.path.controlPoints,c=l[l.length-1],d=this.currentBrush.size/10;if(Math.sqrt(t.x-c.x**2+(t.y-c.y**2))<d)return}let r=this.engine.getOutputContainer(),o=this.engine.getRootContainers()[0],s=st.pointFromSpaceToSpace(t,o,r,!0),n=st.absoluteToRelativePoint(s,r,!1),a=r.getBounds();this.currentPath.addControlPoint(Ht.fromObject(n)),this.currentStroke.path.controlPoints.push(t),e&&this.sprite.render(Ht.fromObject({x:a.width,y:a.height}))}endStroke(){if(!this.currentStroke||!this.currentPath||!this.currentBrush)return;this.currentStroke.path.controlPoints.length&&this.drawing.strokes.push(this.currentStroke),this.currentStroke=void 0,this.currentBrush=void 0,this.currentPath.setClosed(!0);let t=this.engine.getOutputContainer().getBounds();this.sprite.render(Ht.fromObject({x:t.width,y:t.height})),this.currentPath=void 0}setData(t){this.drawing=b(b({},this.drawing),t),this.drawing.strokes&&(this.drawing.strokes=[]),this.sprite.clearPersistCanvas(),this.sprite.clearCanvas(),this.sprite.setPaths([]),this.drawStrokes(t.strokes)}getData(){return this.drawing}updateData(){this.setData(this.getData())}getOperation(){return this.operation}drawStrokes(t){t.forEach(e=>{this.beginStroke(e.brush),e.path.controlPoints.forEach(r=>{this.addPointToCurrentStroke(r,!0)}),this.endStroke()})}};var iC=class extends Ye{constructor(t,e,r,o){super(o);this.filterOperation=e;this.type="duotone-filter";e.set({intensity:r.colorIntensity}),e.set({filter:t}),o.pesdk.setAllOperationsToDirty()}getProperties(){return{colorIntensity:this.filterOperation.getOptions().intensity}}setProperties(t){let r=this.filterOperation.getOptions().intensity;t.colorIntensity!==void 0&&(r=Math.min(Math.max(t.colorIntensity,0),1)),this.filterOperation.set({intensity:r})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}};var rC=class{constructor(t,e){this.engine=e;this.loaded=!1;this.loading=!1;this.asset=b({},t)}load(){return K(this,null,function*(){if(this.loaded)return Promise.resolve();if(this.loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this.loading=!0;let{imageGroups:t}=this.asset,e=[];return["top","left","right","bottom"].forEach(r=>{if(!t[r])return;let o=t[r];["start","mid","end"].forEach(s=>{s in o&&e.push(this.loadPart(r,s))})}),Promise.all(e).then(()=>{this.loaded=!0,this.loading=!1}).catch(()=>{this.loaded=!1,this.loading=!1})})}getFrame(){return b(b({},this.asset),{defaultName:this.asset.name,thumbnail:this.asset.thumbnailURI})}getIdentifier(){return this.asset.identifier}getDefaultName(){return this.asset.name}getThumbnail(){return this.asset.thumbnailURI}getTintable(){return this.asset.tintable||!1}getLayoutMode(){return this.asset.layoutMode}getImageGroups(){return this.asset.imageGroups}loadPart(t,e){return K(this,null,function*(){return new Promise((r,o)=>{let{imageGroups:s}=this.asset,n=s[t][e],a=n;typeof n!="string"&&"image"in n&&(a=n.image);let l=new Image;l.addEventListener("load",()=>{typeof n!="string"?this.asset.imageGroups[t][e].image=l:this.asset.imageGroups[t][e]=l,r(l)}),l.addEventListener("error",()=>{o(new Error(`Failed to load image at ${l.src}`))}),l.crossOrigin=this.engine.configuration.crossOrigin||"anonymus",l.src=this.engine.assetProvider.getAssetSource("frame",a)})})}};var oC=class extends Ye{constructor(t,e,r){super(r);this.frameOperation=t;this.type="frame";this.setProperties(e),r.pesdk.setAllOperationsToDirty()}setProperties(t){if(this.props=b(b({},this.props),t),typeof t.opacity=="number"&&this.frameOperation.set({alpha:t.opacity}),t.tintColor&&this.frameOperation.set({tintColor:Vi(t.tintColor)}),t.width){let e=this.engine.getOutputContainer().getBounds(),r=Math.min(e.width,e.height),o=t.width/r;this.frameOperation.set({scale:o})}this.frameOperation.setDirty(!0)}getProperties(){return this.props}getOperation(){return this.frameOperation}getTypeIdentifier(){return"frame"}};var sC=class extends Ye{constructor(t,e,r){super(e);this.blurOperation=r;this.type="gaussian-blur";this.setProperties(t)}getProperties(){let t=this.engine.getOutputContainer(),e=t.getBounds(),r=Math.min(e.size.width,e.size.height);return{blurRadius:st.scalarFromSpaceToSpace(this.blurOperation.getOptions().blurRadius*r,t,this.getContainer())}}setProperties(t){if(t.blurRadius!==void 0){let e=this.engine.pesdk.getOutputDimensions(),r=Math.min(e.x,e.y),o=this.getContainer(),s=this.engine.getOutputContainer(),a=st.scalarFromSpaceToSpace(t.blurRadius,o,s)/r;this.blurOperation.set({blurRadius:a})}}getOperation(){return this.blurOperation}getTypeIdentifier(){return"blur"}};var Wb=class extends pr{constructor(t,e){super(e);this.data=t;this.type="image";let r=e.configuration.downscaleOptions;if(!r)this.downscaleOptions={maxDimensions:{width:e.maxTextureDimension,height:e.maxTextureDimension}};else{let{maxDimensions:s}=r;this.downscaleOptions={maxMegaPixels:r.maxMegaPixels,maxDimensions:{width:Math.min(e.maxTextureDimension,s?s.width:Number.MAX_VALUE),height:Math.min(e.maxTextureDimension,s?s.height:Number.MAX_VALUE)}}}this.setData(t);let{image:o}=this.data;this.bounds=new ze(R.ZERO,{width:o.width,height:o.height})}setData(t){if(this.data=b(b({},this.data),t),t.image){let{image:e}=t,r;if(e instanceof HTMLImageElement&&(r=this.engine.pesdk.parseExif(e),r)){let s=r.getTags();if(s&&s.Orientation){let n=s.Orientation!==1&&s.Orientation!==2,a=[2,4,5,7].indexOf(s.Orientation)!==-1;if(n||a){if(Se()||kr()||!CSS.supports("image-orientation","from-image")){let l=this.engine.pesdk.createOperation("exif-orientation",{},!1);l.setTags(s),e=l.applyTo(e)}r.setOrientation(1),s.Orientation=1}}}let o=new du(e,this.downscaleOptions);o.on(ys.IMAGE_DOWNSCALED,({width:s,height:n})=>{this.engine.emit(ha.IMAGE_DOWNSCALED,{width:s,height:n})}),o.on(ys.BEGAN_IMAGE_DOWNSCALING,()=>{this.engine.emit(ha.BEGAN_IMAGE_DOWNSCALING)}),e=o.downscaleIfNecessary(),this.data.image=e,this.engine.pesdk.setImage(e,r),this.setBoundsFromSize(e.width,e.height)}}getData(){return this.data}setPivot(t,e){throw new Error("This container does not support modifying the pivot")}getOperation(){throw new Error("This container has no associated operation")}};var nC=class extends Ye{constructor(t,e,r){super(e);this.props=t;this.blurOperation=r;this.type="linear-blur";this.setProperties(t)}getProperties(){return this.props}setProperties(t){this.props=b(b({},this.props),t);let e=this.blurOperation.getOptions(),r=this.engine.getOutputContainer(),o=r.getBounds(),s=this.getContainer(),n=r.getBaseLocalToParentMatrix(),a=st.getBaseLocalToWorldMatrix(s),l=It.multiply(It.getInverted(n),a),c=Math.min(o.size.width,o.size.height);if(t.blurRadius!==void 0){let d=st.scalarFromSpaceToSpace(t.blurRadius,s,r);e.blurRadius=d/c}if(t.start!==void 0){let d=It.transformPoint(l,t.start),u=st.absoluteToRelativePoint(d,r,!1);e.controlPoint1=u}if(t.end!==void 0){let d=It.transformPoint(l,t.end),u=st.absoluteToRelativePoint(d,r,!1);e.controlPoint2=u}this.blurOperation.set(e)}updateProperties(){let t=this.getProperties();this.setProperties(t)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"linear-focus"}};var aC=class extends Ye{constructor(t,e,r,o){super(o);this.filter=t;this.filterOperation=e;this.props=r;this.type="lut-filter";e.set({intensity:r.intensity}),e.set({filter:t}),o.pesdk.setAllOperationsToDirty()}getProperties(){return{intensity:this.filterOperation.getOptions().intensity,lutImage:this.props.lutImage,horizontalTileCount:this.props.horizontalTileCount,verticalTileCount:this.props.verticalTileCount}}setProperties(t){let e=this.filterOperation.getOptions(),r=typeof t.intensity=="number"?t.intensity:e.intensity;this.filterOperation.set({intensity:r})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}};var lC=class extends Ye{constructor(t,e,r){super(e);this.props=t;this.blurOperation=r;this.type="mirrored-blur";this.setProperties(t)}getProperties(){return this.props}setProperties(t){this.props=b(b({},this.props),t);let e=this.blurOperation.getOptions(),r=this.engine.getOutputContainer(),o=r.getBounds(),s=this.getContainer(),n=r.getBaseLocalToParentMatrix(),a=st.getBaseLocalToWorldMatrix(s),l=It.multiply(It.getInverted(n),a),c=Math.min(o.size.width,o.size.height);if(t.blurRadius!==void 0){let d=st.scalarFromSpaceToSpace(t.blurRadius,s,r);e.blurRadius=d/c}if(t.gradientSize!==void 0){let u=st.scalarFromSpaceToSpace(t.gradientSize,s,r)/c;e.gradientSize=u}if(t.clearAreaWidth!==void 0){let u=st.scalarFromSpaceToSpace(t.clearAreaWidth,s,r)/c;e.size=u*.5}if(t.mirrorAxisOrigin!==void 0){let d=It.transformPoint(l,t.mirrorAxisOrigin),u=st.absoluteToRelativePoint(d,r,!1);e.start=u}if(t.mirrorAxisDirection!==void 0){let d=It.transformPoint(l,t.mirrorAxisDirection),u=st.absoluteToRelativePoint(d,r,!1);e.end=u}this.blurOperation.set(e)}updateProperties(){let t=this.getProperties();this.setProperties(t)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"mirrored-focus"}};var Gb=class extends pr{constructor(t,e,r,o){super(o);this.settings=t;this.operation=e;this.flipOperation=r;this.type="output";this.flipTransform=It.IDENTITY;this.blockTransformUpdate=!1;this.transformUpdateWhileBlock=!1;this.bounds=new ze({x:0,y:0},this.settings.resolution),this.setData(t)}pauseChildrenUpdates(){this.transformUpdateWhileBlock=!1,this.blockTransformUpdate=!0}resumeChildrenUpdates(){this.blockTransformUpdate=!1,this.transformUpdateWhileBlock&&this.updateChildrenContainers()}setData(t){if(this.settings=b(b({},this.settings),t),t.resolution&&(this.setBoundsFromSize(t.resolution.width,t.resolution.height),this.setTransform(this.transform),this.operation.set({outputResolution:new Ht(t.resolution.width,t.resolution.height)})),t.flipHorizontally!==void 0){let e=t.flipHorizontally;this.updateFlipTransform(),this.flipOperation.set({flipHorizontally:e})}if(t.flipVertically!==void 0){let e=t.flipVertically;this.updateFlipTransform(),this.flipOperation.set({flipVertically:e})}this.operation.setDirty(!0),this.flipOperation.setDirty(!0)}getData(){return this.settings}setResolution(t){this.setData({resolution:t})}getResolution(){return this.getData().resolution}setTransform(t){if(this.transform.rotation!==t.rotation||this.transform.position!==t.position||this.transform.scale!==t.scale){this.transform=t;let e=this.flipTransform;this.flipTransform=It.IDENTITY;let r=this.engine.getRootContainers()[0],o=st.pointFromSpaceToSpace({x:0,y:0},r,this),s=-t.rotation,n=Ht.fromObject(o).clone().subtract(Ht.fromObject(this.getBounds().origin));this.operation.set({pivot:new Ht(0,0),position:n,scale:new Ht(1/t.scale.x,1/t.scale.y),rotation:s}),this.flipTransform=e,this.operation.setDirty(!0),this.updateChildrenContainers()}}rotate90(t=!1){let e=t?-Math.PI*.5:Math.PI*.5,r=this.getResolution(),o=this.getPivot(),s=this.getBounds(),n={x:s.midX,y:s.midY},a=st.getPointInWorldSpace(n,this);this.setPivot(.5,.5),this.setPosition(a),this.setRotation(this.getRotation()-e);let l={width:r.height,height:r.width};this.setResolution(l);let c={x:-l.width*(.5-o.x),y:-l.height*(.5-o.y)},d=st.getPointInWorldSpace(c,this);this.setPivot(o),this.setPosition(d),this.updateChildrenContainers()}setPivot(t,e){super.setPivotInternal(t,e),this.setTransform(this.transform)}getTransform(){return this.transform}getBaseLocalToParentMatrix(){return st.rectTransformToAffineTransform(this.getTransform())}getLocalToParentMatrix(){let t=st.rectTransformToAffineTransform(this.getTransform());return It.multiply(t,this.flipTransform)}getFlipTransformMatrix(){return this.flipTransform}isValid(){return!0}getOperation(){return this.operation}updateFlipTransform(){let{flipHorizontally:t,flipVertically:e}=this.settings;if(!t&&!e)this.flipTransform=It.IDENTITY;else{let r=this.getPivot(),o=this.getBounds(),s=t?-1:1,n=t?-2*(r.x-.5)*o.width:0,a=e?-1:1,l=e?-2*(r.y-.5)*o.height:0;this.flipTransform=new It(s,0,0,a,n,l)}}updateChildrenContainers(){if(this.blockTransformUpdate){this.transformUpdateWhileBlock=!0;return}this.engine.rootOperations.forEach(t=>{Hb(t)?(t.updateTransform(),"updateData"in t&&t.updateData()):"updateProperties"in t&&t.updateProperties()})}};var Vb=class extends Ye{constructor(t,e,r){super(r);this.overlayOperation=t;this.type="overlay";let o=e.blendMode||r.mapBlendMode(t.getBlendMode());t.set({blendMode:r.reverseMapBlendMode(o)}),t.set({image:e.image}),r.pesdk.setAllOperationsToDirty()}getProperties(){let t=this.overlayOperation.getOptions();return{image:t.image,blendMode:this.engine.mapBlendMode(t.blendMode),opacity:t.alpha}}setProperties(t){let e=this.overlayOperation.getOptions();typeof t.opacity=="number"&&(e.alpha=t.opacity),t.blendMode!==void 0&&(e.blendMode=this.engine.reverseMapBlendMode(t.blendMode)),this.overlayOperation.set(e),this.overlayOperation.setDirty(!0)}getOperation(){return this.overlayOperation}getTypeIdentifier(){return"overlay"}setFlipHorizontally(t){this.overlayOperation.setFlipHorizontally(t)}setFlipVertically(t){this.overlayOperation.setFlipVertically(t)}getFlipHorizontally(){return this.overlayOperation.getFlipHorizontally()}getFlipVertically(){return this.overlayOperation.getFlipVertically()}};var cC=class extends Ye{constructor(t,e,r){super(e);this.props=t;this.blurOperation=r;this.type="radial-blur";this.setProperties(t)}getProperties(){return this.props}setProperties(t){this.props=b(b({},this.props),t);let e=this.blurOperation.getOptions(),r=this.engine.getOutputContainer(),o=r.getBounds(),s=this.getContainer(),n=r.getBaseLocalToParentMatrix(),a=st.getBaseLocalToWorldMatrix(s),l=It.multiply(It.getInverted(n),a),c=Math.min(o.size.width,o.size.height);if(t.blurRadius!==void 0){let d=st.scalarFromSpaceToSpace(t.blurRadius,s,r);e.blurRadius=d/c}if(t.center!==void 0){let d=It.transformPoint(l,t.center),u=st.absoluteToRelativePoint(d,r,!1);e.position=u}if(t.radius!==void 0){let u=st.scalarFromSpaceToSpace(t.radius,s,r)/c;e.radius=u}if(t.gradientSize!==void 0){let u=st.scalarFromSpaceToSpace(t.gradientSize,s,r)/c;e.gradientRadius=u}this.blurOperation.set(e)}updateProperties(){let t=this.getProperties();this.setProperties(t)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"radial-focus"}};var jb=class extends pr{constructor(t,e){super(e);this.data=t;this.type="sticker";let r=t.image,o=this.engine.pesdk.parseExif(t.image);if(o){let n=o.getTags();if(n&&n.Orientation){let a=n.Orientation!==1&&n.Orientation!==2,l=[2,4,5,7].indexOf(n.Orientation)!==-1;if(a||l){let c=this.engine.pesdk.createOperation("exif-orientation",{},!1);c.setTags(n),r=c.applyTo(t.image),o.setOrientation(1),n.Orientation=1}}}r=new du(r,{maxMegaPixels:{desktop:10,mobile:5}}).downscaleImageIfNecessary(),this.operation=e.createSpriteOperation(),this.sprite=this.operation.createSticker({identifier:"",image:r,position:new Ht(0,0),dimensions:new Ht(1,1),rotation:0,smoothDownscaling:!1}),this.operation.addSprite(this.sprite),this.bounds=new ze({x:0,y:0},{width:r.width,height:r.height}),this.setTransform(qt.IDENTITY),this.sprite.setPivot(new Ht(0,0)),this.operation.setDirty(!0),this.setData(t)}setData(t){this.data=b(b({},this.data),t),t.id&&(this.id=t.id),Tr(t.opacity)&&t.opacity>=0&&this.sprite.setAlpha(t.opacity),t.tintColor&&this.sprite.setTintColor(Vi(t.tintColor)),t.tintMode&&this.sprite.setTintMode(t.tintMode),this.operation.setDirty(!0)}getData(){return this.data}updateData(){this.setData(this.getData())}setTransform(t){super.setTransform(t);let e=this.engine.getOutputContainer(),r=this.getParent(),o={width:this.bounds.width*t.scale.x,height:this.bounds.height*t.scale.y},s=st.sizeFromSpaceToSpace(o,r,e);this.sprite.setDimensions(Ht.fromSize(s));let n=st.pointFromSpaceToSpace(t.position,r,e,!0),a=st.absoluteToRelativePoint(n,e,!1);this.sprite.setPosition(new Ht(a.x,a.y));let l=st.getRotationBetweenCoordinateSpaces(r,e),c=t.rotation+l;this.sprite.setRotation(c),this.operation.setDirty(!0)}setPivot(t,e){this.setPivotOnSelfAndSprite(this.sprite,t,e)}getOperation(){return this.operation}setFlipHorizontally(t){this.sprite.setFlipHorizontally(t)}setFlipVertically(t){this.sprite.setFlipVertically(t)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}};var td=i=>2*Math.PI-i,D7=i=>-i,Sm=({rotation:i,flipHorizontally:t,flipVertically:e})=>{let r=i;return t&&(r=td(r)),e&&(r=D7(r)),r};function I7(i,t){if(t){let e=1/t.unitsPerEm*i,r=t.ascender*e,o=t.descender*e;return r+Math.abs(o)}return i*1.1}var $b=class{constructor(t){this.context=t;this.sourceLines=[];this.maxWidth=100}static buildWords(t){let e=[],r="",o=t.length;for(let s=0;s<o;s+=1){let n=t[s];r+=n,(n===" "||n==="-"||s===o-1)&&(e.push(r),r="")}return e}getLines(){let t=[],e=[],r=this.sourceLines.length;for(let o=0;o<r;o+=1){let s=this.sourceLines[o],n=$b.buildWords(s),a=n.length;for(let l=0;l<a;l+=1){let c=n[l],d=e.concat(c).join("").replace(/\s+$/i,"");if(this.getWidth(d)>this.maxWidth){e.length>0&&(t.push(e.join("")),e=[c]);let m=c.replace(/\s+$/i,"");if(this.getWidth(m)>this.maxWidth){let p=this.splitWord(c);t=t.concat(p.lines),p.rest&&(e=[p.rest])}}else e.push(c)}t.push(e.join("")),e=[]}return t}splitWord(t){let e={lines:[],rest:null},r=t.length,o=[];for(let s=0;s<r;s+=1){let n=t[s];this.getWidth(o.concat(n).join(""))>this.maxWidth?(o.length>0&&e.lines.push(o.join("")),o=[n]):o.push(n),s===r-1&&o.length>0&&(e.rest=o.join(""))}return e}getWidth(t){return this.context.measureText(t).width}setText(t){this.sourceLines=t.split(`
`)}setMaxWidth(t){this.maxWidth=t}};function xl(i,t,e,r,o,s,n){i.font=`${e.fontStyle||"normal"} ${e.fontWeight||"normal"} ${r}px "${e.fontFamily}"`;let a=new $b(i);a.setText(t),a.setMaxWidth(s);let l=a.getLines().map(m=>m.replace(/\s+$/i,"")),c=I7(r,n),d=c*o,u=c/5;return{width:s+u*2,height:l.length*d+u*2}}var rn=class extends pr{constructor(t,e){super(e);this.text=t;this.type="text";if(!rn.measureContext){let l=document.createElement("canvas");rn.measureContext=l.getContext("2d")}this.operation=e.createSpriteOperation();let r=this.engine.getOutputContainer(),o=this.getParent(),s=r.getBounds();this.sprite=this.operation.createText({text:t.text,position:new Ht(0,0),rotation:0,fontSize:st.scalarFromSpaceToSpace(t.fontSize/s.height,o,r),lineHeight:t.lineHeight,fontIdentifier:t.fontIdentifier,alignment:t.alignment,color:Vi(t.textColor),backgroundColor:Vi(t.backgroundColor),maxWidth:st.scalarFromSpaceToSpace(t.width/s.width,o,r)});let n=e.assetProvider.getFontManager().getFontWithId(t.fontIdentifier);this.sprite.setFontFamily(n.fontFamily),this.sprite.setFontWeight(n.fontWeight||"normal"),this.sprite.setFontStyle(n.fontStyle||"normal"),this.sprite.setFontIdentifier(n.identifier),this.sprite.setTextMetrics(n.textMetrics),this.sprite.setPivot(new Ht(0,0)),this.operation.addSprite(this.sprite);let a=xl(rn.measureContext,t.text,n,t.fontSize,t.lineHeight,t.width,n.textMetrics);this.bounds=new ze(0,0,a.width,a.height),this.setTransform(qt.IDENTITY),this.operation.setDirty(!0)}setData(t){this.text=b(b({},this.text),t);let e=this.engine.assetProvider.getFontManager().getFontWithId(t.fontIdentifier||this.text.fontIdentifier);if(t.fontIdentifier&&(this.sprite.setFontFamily(e.fontFamily),this.sprite.setFontWeight(e.fontWeight||"normal"),this.sprite.setFontStyle(e.fontStyle||"normal"),this.sprite.setFontIdentifier(e.identifier),this.sprite.setTextMetrics(e.textMetrics)),t.id&&(this.id=t.id),t.text&&this.sprite.setText(t.text),t.fontSize){let o=this.engine.getOutputContainer(),s=this.getParent(),n=st.scalarFromSpaceToSpace(t.fontSize,s,o),a=o.getBounds();this.sprite.setFontSize(n/a.height)}if(t.alignment&&this.sprite.setAlignment(t.alignment),t.lineHeight&&this.sprite.setLineHeight(t.lineHeight),t.textColor&&this.sprite.setColor(Vi(t.textColor)),t.backgroundColor&&this.sprite.setBackgroundColor(Vi(t.backgroundColor)),t.width){let o=this.engine.getOutputContainer(),s=this.getParent(),n=st.scalarFromSpaceToSpace(t.width,s,o),a=o.getBounds();this.sprite.setMaxWidth(n/a.width)}let r=xl(rn.measureContext,this.text.text,e,this.text.fontSize,this.text.lineHeight,this.text.width,e.textMetrics);this.setBoundsFromSize(r.width,r.height),this.operation.setDirty(!0)}getData(){return this.text}updateData(){this.setData(this.getData())}setTransform(t){super.setTransform(t);let e=this.engine.getOutputContainer(),r=this.getParent(),o=st.pointFromSpaceToSpace(t.position,r,e,!0),s=st.absoluteToRelativePoint(o,e,!1);this.sprite.setPosition(new Ht(s.x,s.y));let n=st.getRotationBetweenCoordinateSpaces(r,e);this.sprite.setRotation(t.rotation+n),this.operation.setDirty(!0)}setPivot(t,e){this.setPivotOnSelfAndSprite(this.sprite,t,e)}getOperation(){return this.operation}setFlipHorizontally(t){this.sprite.setRotation(this.getFlippedRotation({flipHorizontally:t})),this.sprite.setFlipHorizontally(t)}setFlipVertically(t){this.sprite.setRotation(this.getFlippedRotation({flipVertically:t})),this.sprite.setFlipVertically(t)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}getFlippedRotation({flipVertically:t,flipHorizontally:e}){let r=t||this.getFlipVertically(),o=e||this.getFlipHorizontally(),s=this.getRotation();return(r||o)&&(s=td(s)),s}};var dC=1e3,vl=class extends pr{constructor(t,e,r){super(r);this.textDesign=t;this.layout=e;this.type="text-design";this.currentLayoutSize=void 0;this.layoutID=e.identifier,this.operation=r.createSpriteOperation();let o=this.engine.getOutputContainer(),s=this.getParent(),n=o.getBounds(),a=Math.min(n.width,n.height);e.seed(t.seed),this.bounds=this.calculateBounds(this.textDesign,this.layout);let l=t.width;this.sprite=this.operation.createTextDesign({text:t.text,layout:e,inverted:t.inverted,color:Vi(t.color),width:st.scalarFromSpaceToSpace(t.width/a,s,o),padding:t.padding/l,seed:t.seed}),this.updatePivot(),this.operation.addSprite(this.sprite),this.setTransform(qt.IDENTITY),this.operation.setDirty(!0)}static stringify(t){return JSON.stringify(t,vl.serializer())}static serializer(){let t=[],e=[],r=(o,s)=>t[0]===s?"[Circular ~]":`[Circular ~.${e.slice(0,t.indexOf(s)).join(".")}]`;return function(s,n){let a=this;if(t.length>0){let l=t.indexOf(a);~l?(t.splice(l+1),e.splice(l,Infinity,s)):(t.push(a),e.push(s)),~t.indexOf(n)&&(n=r.call(a,s,n))}else t.push(n);return n}}calculateBounds(t,e,r=!0){let o=t.inverted&&r?Math.max(0,2*t.padding):0,s=t.width/dC;if(this.currentLayoutSize===void 0){e.seed(t.seed);let n=e.generateLayoutData(t.text,dC);this.currentLayoutData=n,this.currentLayoutSize=n.getSize()}return new ze(0,0,this.currentLayoutSize.width*s+o,this.currentLayoutSize.height*s+o)}findNextUniqueSeed(t,e,r){let o=r,s=this.currentLayoutData?vl.stringify(this.currentLayoutData.getRows()):"",n;for(let a=0;a<20&&(e.seed(o),n=e.generateLayoutData(t.text,dC),s===vl.stringify(n.getRows()));a+=1)o+=1;return e.seed(o),this.currentLayoutData=n,o}setData(t){if(this.textDesign=b(b({},this.textDesign),t),t.id&&(this.id=t.id),t.padding!==void 0){let e=this.textDesign.width;this.sprite.setPadding(t.padding/e)}else t.width&&(this.textDesign.padding=this.sprite.getPadding()*this.textDesign.width);if(t.seed!==void 0&&(t.seed<0&&(t.seed=this.findNextUniqueSeed(this.textDesign,this.layout,Date.now()),this.textDesign.seed=t.seed),this.currentLayoutSize=void 0,this.layout.seed(t.seed),this.sprite.setSeed(t.seed),this.sprite.setLayout(this.layout)),t.color&&this.sprite.setColor(Vi(t.color)),t.inverted!==void 0&&this.sprite.setInverted(t.inverted),t.text&&(this.currentLayoutSize=void 0,this.sprite.setText(t.text)),t.width){let e=this.engine.getOutputContainer(),r=this.getParent(),o=e.getBounds(),s=Math.min(o.width,o.height),n=st.scalarFromSpaceToSpace(t.width/s,r,e);this.sprite.setWidth(n)}if(t.padding!==void 0||t.seed!==void 0||t.inverted!==void 0||t.text||t.width){let e=this.calculateBounds(this.textDesign,this.layout);this.setBoundsFromSize(e.width,e.height),this.updatePivot()}this.operation.setDirty(!0)}getData(){return this.textDesign}updateData(){this.setData(this.getData())}setTransform(t){super.setTransform(t);let e=this.engine.getOutputContainer(),r=this.getParent();if(t.scale.x!==1||t.scale.y!==1)throw new Error("This engine doesn't support scaling TextDesign containers! You can change the bounds using the width property of the TextDesign data.");let o=st.pointFromSpaceToSpace(t.position,r,e,!0),s=st.absoluteToRelativePoint(o,e,!1);this.sprite.setPosition(new Ht(s.x,s.y));let n=st.getRotationBetweenCoordinateSpaces(r,e);this.sprite.setRotation(t.rotation+n),this.operation.setDirty(!0)}setPivot(t,e){typeof t=="number"?super.setPivot(t,e):super.setPivot(t),this.updatePivot()}getOperation(){return this.operation}getLayoutID(){return this.layoutID}setFlipHorizontally(t){this.sprite.setFlipHorizontally(t)}setFlipVertically(t){this.sprite.setFlipVertically(t)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}updatePivot(){let t=this.textDesign.inverted?Math.max(0,this.textDesign.padding):0,e=new R(this.bounds.width-2*t,this.bounds.height-2*t),r=this.getPivot(),o=new R(r.x*this.bounds.width,r.y*this.bounds.height),s=new R(t,t),a=o.subtract(s).divide(e);this.sprite.setPivot(new Ht(a.x,a.y))}};var{BLEND_MODES:Ke}=Q.Operations.OverlayOperation,Yb="imgly_font_open_sans_bold",ed=class extends Qv{constructor(t){super(t);this.previews=Array();this.rootOperationStack=[];this.deferredRenderQueue=[];this.operationStackOffset=1;this.enforceOperationOrder=()=>{this.refreshFlipIndex(),this.refreshFrameIndex()};if(this.assetProvider=t.assetProvider||new mu,this.wrapper=new en({license:t.license,crossOrigin:t.crossOrigin,assets:{resolver:(e,r)=>this.resolveAssetForSDK(e,r)},editor:{preferredRenderer:t.preferredRenderer,pixelRatio:1}}),this.editor=this.wrapper.getEditor(),this.sdk=this.editor.getSDK(),this.sdk.setRenderMode("adapter"),this.tempCanvas=document.createElement("canvas"),this.sdk.setCanvas(this.tempCanvas),t.preferredRenderer==="webgl"){let e=document.createElement("canvas"),r=e.getContext("webgl")||e.getContext("experimental-webgl");this.maxTextureDimension=r.getParameter(r.MAX_TEXTURE_SIZE)}else this.maxTextureDimension=Infinity}get configuration(){return this.config}get pesdk(){return this.sdk}get rootOperations(){return this.rootOperationStack}dispose(){this.pesdk.dispose(),this.wrapper.dispose()}render(t){return new Promise(e=>{let r=()=>new Promise(o=>{let{canvas:s}=t,n=t.getTransform(),a=this.outputContainer.getPivot(),l=t.getCanvasBounds(),c=t.quality,{tempCanvas:d}=this;this.sdk.setTextureQuality(c);let u=this.sdk.getOutputDimensions();return d.width=u.x,d.height=u.y,this.sdk.getRenderer().resizeTo(new Ht(d.width,d.height)),this.sdk.render(!0).then(()=>{let m=s.getContext("2d");m.clearRect(0,0,s.width,s.height),m.save(),m.translate(-l.minX,-l.minY),m.translate(n.position.x,n.position.y),m.rotate(n.rotation),m.scale(n.scale.x,n.scale.y),m.translate(-a.x*d.width,-a.y*d.height),m.scale(1/t.quality,1/t.quality),m.drawImage(d,0,0),m.restore(),e(),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?(this.sdk.setAllOperationsToDirty(),Promise.resolve(this.deferredRenderQueue[0]().then(o))):o()})});this.deferredRenderQueue.push(r),this.deferredRenderQueue.length===1&&r()})}createPreview(t){let e=new Jv(t,this);return this.previews.push(e),e}export(){return K(this,arguments,function*(t=qe.IMAGE,e=Le.PNG,r=1){return new Promise(o=>{let s=()=>new Promise(n=>this.sdk.export(this.mapToRenderType(t),this.mapToImageFormat(e),r).then(a=>{o(a),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?Promise.resolve(this.deferredRenderQueue[0]().then(n)):n()}));this.deferredRenderQueue.push(s),this.deferredRenderQueue.length===1&&s()})})}getRootContainers(){return[this.rootContainer]}getOutputContainer(){return this.outputContainer}findContainerByID(t){return t===this.rootContainer.getID()?this.rootContainer:this.rootOperationStack.find(e=>e.getID()===t)}findEffectByID(t){return this.rootOperationStack.find(e=>e.getID()===t)}addImage(t,e,r){if(this.rootContainer)throw new Error("A background image already exists - did you mean to use addSticker?");let o=new Wb(t,this);if(this.rootContainer=o,!this.outputContainer){let{width:s,height:n}=o.getBounds(),a={resolution:{width:s,height:n},flipHorizontally:!1,flipVertically:!1},l=this.sdk.createOperation("output",{},!1),c=this.sdk.createOperation("flip",{},!1);this.insertIntoOperationsStack(l,this.operationStackOffset-1),this.insertIntoOperationsStack(c,this.operationStackOffset),this.outputContainer=new Gb(a,l,c,this)}return o}addSticker(t,e,r){if(!e)throw new Error("This engine does not support adding stickers as root elements.");this.ensureContainerIsRoot(e);let o=new jb(t,this);return this.addToStackAtIndex(o,r),o}addStickerFromAssets(t,e,r){if(!e)throw new Error("This engine does not support adding stickers as root elements.");return this.ensureContainerIsRoot(e),new Promise((o,s)=>{let n=new Image;n.onload=()=>{let a={image:n,opacity:1},l=new jb(a,this);this.addToStackAtIndex(l,r),o(l)},n.onerror=a=>{s(a)},n.crossOrigin=this.config.crossOrigin||null,n.src=this.assetProvider.getAssetSource("sticker",t)})}addText(t,e,r){if(!e)throw new Error("This engine does not support adding text as root elements.");if(!this.assetProvider.getFontManager().isFontLoaded(t.fontIdentifier||Yb))throw new Error("Adding text synchronously only works if the required font is already loded! Consider using the asynchronous addTextWithFontLoading function instead!");this.ensureContainerIsRoot(e);let s=b({text:"",fontIdentifier:Yb,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},t),n=new rn(s,this);return this.addToStackAtIndex(n,r),n}addTextWithFontLoading(t,e,r){if(!e)throw new Error("This engine does not support adding text as root elements.");let o=this.assetProvider.getFontManager(),s=t.fontIdentifier||Yb;return new Promise((n,a)=>{o.loadFontWithIdentifier(s).then(()=>{this.ensureContainerIsRoot(e);let l=b({text:"",fontIdentifier:Yb,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},t),c=new rn(l,this);this.addToStackAtIndex(c,r),n(c)}).catch(a)})}addTextDesignAsync(t="imgly_text_design_blocks",e,r,o){return K(this,null,function*(){if(!r)throw new Error("This engine does not support adding TextDesign as a root element.");let s=b({seed:Date.now(),padding:0,text:"",color:[0,0,0],inverted:!1,width:100},e),n=this.wrapper.getTextDesignLayoutByID(t);if(!n)throw new Error(`The layout could not be loaded for the given id: ${t}`);let a=n.getImagePaths().map(p=>{let f=p.split("/").pop()||"";return{path:p,fullPath:this.assetProvider.getAssetSource("textdesign",f)}}),l=this.wrapper.getTextDesignAssetManager(),d=this.wrapper.getTextDesignFontManager().getVariationsByIdentifier();l.setFonts(d),yield l.loadImages(a),n.onImagesLoaded();let u=Object.keys(d);return this.assetProvider.getFontManager().loadFontsWithIdentifiers(u).then(()=>{this.ensureContainerIsRoot(r);let p=new vl(s,n,this);return this.addToStackAtIndex(p,o),Promise.resolve(p)})})}addDrawing(t,e,r){if(!e)throw new Error("This engine does not support DrawingContainers as root elements.");this.ensureContainerIsRoot(e);let o=new eC(t,this);return this.addToStackAtIndex(o,r),o}addGaussianBlur(t,e,r){this.ensureContainerIsRoot(e);let o=new sC(t,this,this.sdk.createOperation("blur",{},!1));return this.addToStackAtIndex(o,r),o}addRadialBlur(t,e,r){this.ensureContainerIsRoot(e);let o=new cC(t,this,this.sdk.createOperation("radial-focus",{},!1));return this.addToStackAtIndex(o,r),o}addMirroredBlur(t,e,r){this.ensureContainerIsRoot(e);let o=new lC(t,this,this.sdk.createOperation("mirrored-focus",{},!1));return this.addToStackAtIndex(o,r),o}addLinearBlur(t,e,r){this.ensureContainerIsRoot(e);let o=new nC(t,this,this.sdk.createOperation("linear-focus",{},!1));return this.addToStackAtIndex(o,r),o}addDuoToneFilter(t,e,r){throw new Error("Not supported! Use addDuoToneFilterFromAssets instead")}addDuoToneFilterFromAssets(t,e,r){this.ensureContainerIsRoot(e);let s=this.sdk.getOperationsStack().getByIdentifier("filter");if(s&&s.getIdentifier()!==t)throw new Error("This engine doesn't support multiple types of filter operations at once!");let n=s||this.sdk.createOperation("filter",{},!1);return new Promise((a,l)=>{try{let c=this.assetProvider.getDuotoneFilterAsset(t),d={colorIntensity:c.defaultIntensity||0},u=new Q.Operations.FilterOperation.Filters.DuoToneFilter({intensity:d.colorIntensity,lightColor:Q.Color.fromHex(c.lightColor),darkColor:Q.Color.fromHex(c.darkColor)}),m=new iC(u,n,d,this);this.addToStackAtIndex(m,r),a(m)}catch(c){c&&l(c)}})}addLUTFilter(t,e,r){throw new Error("Not supported! Use addLUTFilterFromAssets instead")}addLUTFilterFromAssets(t,e,r){this.ensureContainerIsRoot(e);let s=this.sdk.getOperationsStack().getByIdentifier("filter");if(s&&s.getIdentifier()!==t)throw new Error("This engine doesn't support multiple types filter operations at once!");let n=s||this.sdk.createOperation("filter",{},!1);return this.getLutFilterImage(t).then(a=>{let l=this.assetProvider.getLUTFilterAsset(t),c={horizontalTileCount:l.horizontalTileCount||5,verticalTileCount:l.verticalTileCount||5,intensity:l.defaultIntensity||1},d=new Q.Operations.FilterOperation.Filters.ThreeDLUTFilter(b(b({},c),{image:a})),u=b(b({},c),{lutImage:new Image}),m=new aC(d,n,u,this);return this.addToStackAtIndex(m,r),m})}getLutFilterImage(t){return new Promise((e,r)=>{let o=new Image;o.addEventListener("load",()=>{e(o)}),o.addEventListener("error",s=>{r(s)}),o.crossOrigin=this.config.crossOrigin||null,o.src=this.assetProvider.getAssetSource("filter",t)})}addAdjustments(t,e,r){this.ensureContainerIsRoot(e);let o=new tC(t,this,this.sdk.createOperation("adjustments",{},!1));return this.addToStackAtIndex(o,r),o}addOverlay(t,e,r){this.ensureContainerIsRoot(e);let o=new Vb(this.sdk.createOperation("overlay",{},!1),t,this);return this.addToStackAtIndex(o,r),o}addOverlayFromAssets(t,e,r){return this.ensureContainerIsRoot(e),new Promise((o,s)=>{let n=this.sdk.getOperationsStack(),a=n.getByIdentifier("overlay");a&&a.getIdentifier()!==t&&n.remove(a);let l=a||this.sdk.createOperation("overlay",{},!1),c=new Image;c.onload=()=>{let d={image:c,opacity:1,blendMode:vt.NORMAL},u=new Vb(l,d,this);this.addToStackAtIndex(u,r),o(u)},c.onerror=d=>{s(d)},c.crossOrigin=this.config.crossOrigin||null,c.src=this.assetProvider.getAssetSource("overlay",t)})}addFrame(t,e,r){throw new Error("Not supported!")}addFrameFromAssets(t,e,r){return K(this,null,function*(){this.ensureContainerIsRoot(e);let o=this.assetProvider.getFrameAsset(t);if(!o)throw new Error(`The requested asset does not exist! ${t}`);let s=new rC(o,this);yield s.load();let n=this.getOutputContainer().getBounds(),a=Math.min(n.width,n.height),l=this.sdk.createOperation("frame",{},!1);l.setFrame(s.getFrame());let c={opacity:1,tintColor:[1,1,1],tintable:!1,width:Math.max(1,.1*a),imageGroups:s.getFrame().imageGroups},d=new oC(l,c,this);return this.addToStackAtIndex(d,r),Promise.resolve(d)})}removeEffect(t){if(!t.isValid())return;let r=t.getOperation();this.sdk.removeOperation(r),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(t.getIndexInParent(),1)}removeContainer(t){if(!t.isValid()||t.type==="output")return;let r=t.getOperation();this.sdk.removeOperation(r),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(t.getIndexInParent(),1)}refreshOutputIndex(){let t=this.sdk.getOperationsStack().getIndexByIdentifier("output");this.moveInOperationsStack(t,this.operationStackOffset-1)}refreshFlipIndex(){let t=this.sdk.getOperationsStack().getIndexByIdentifier("flip"),e=this.sdk.getOperationsStack().getStack().length-1;t!==e&&this.moveInOperationsStack(t,e)}refreshFrameIndex(){let t=this.sdk.getOperationsStack().getIndexByIdentifier("frame"),e=this.sdk.getOperationsStack().getStack().length-1;t!==-1&&t!==e&&this.moveInOperationsStack(t,e)}mapToRenderType(t){switch(t){case qe.IMAGE:return Q.RenderType.IMAGE;case qe.DATA_URL:return Q.RenderType.DATAURL;case qe.BLOB:return Q.RenderType.BLOB;case qe.MSBLOB:return Q.RenderType.MSBLOB;default:return Q.RenderType.IMAGE}}mapToImageFormat(t){switch(t){case Le.PNG:return Q.ImageFormat.PNG;case Le.JPEG:return Q.ImageFormat.JPEG;default:return null}}mapBlendMode(t){switch(t){case Ke.NORMAL:return vt.NORMAL;case Ke.OVERLAY:return vt.OVERLAY;case Ke.HARD_LIGHT:return vt.HARD_LIGHT;case Ke.SOFT_LIGHT:return vt.SOFT_LIGHT;case Ke.MULTIPLY:return vt.MULTIPLY;case Ke.DARKEN:return vt.DARKEN;case Ke.LIGHTEN:return vt.LIGHTEN;case Ke.SCREEN:return vt.SCREEN;case Ke.COLOR_BURN:return vt.COLOR_BURN;default:return vt.NORMAL}}reverseMapBlendMode(t){switch(t){case vt.NORMAL:return Ke.NORMAL;case vt.OVERLAY:return Ke.OVERLAY;case vt.HARD_LIGHT:return Ke.HARD_LIGHT;case vt.SOFT_LIGHT:return Ke.SOFT_LIGHT;case vt.MULTIPLY:return Ke.MULTIPLY;case vt.DARKEN:return Ke.DARKEN;case vt.LIGHTEN:return Ke.LIGHTEN;case vt.SCREEN:return Ke.SCREEN;case vt.COLOR_BURN:return Ke.COLOR_BURN;default:return Ke.NORMAL}}createSpriteOperation(){return this.sdk.createOperation("sprite",{},!1)}moveIndex(t,e){let r=this.getSiblingIndex(t);if(r===-1)throw new Error("The item to be moved is not part of any stack.");this.moveInStack(this.rootOperationStack,r,e);let o=this.operationStackOffset;this.moveInOperationsStack(r+o,e+o),this.enforceOperationOrder()}ensureContainerIsRoot(t){if(t.getID()!==this.rootContainer.getID())throw new Error("This engine doesn't support adding this effect/container to anything other than the root image container")}addToStackAtIndex(t,e){if(e&&e<0)throw new Error(`The given index may not be negative: ${e}`);e===void 0?this.rootOperationStack.push(t):this.rootOperationStack.splice(e,0,t);let r=this.rootOperationStack.length-1,o=e!==void 0?e:r;o+=this.operationStackOffset,uF(t)?this.insertIntoOperationsStack(t.getOperation(),o):this.insertIntoOperationsStack(t.getOperation(),o),this.sdk.setAllOperationsToDirty()}insertIntoOperationsStack(t,e){let r=this.sdk.getOperationsStack().getStack(),o=r.length,s=Math.max(Math.min(e,o),0);for(let n=o-1;n>=s;n-=1){let a=r[n];r[n+1]=a}r[s]=t,this.sdk.setAllOperationsToDirty(),this.enforceOperationOrder()}moveInStack(t,e,r){let o=t.length,s=Math.max(Math.min(e,o-1),0),n=Math.max(Math.min(r,o-1),0);if(s===n)return;let a=t[s];if(s<n)for(let l=s+1;l<=n;l+=1)t[l-1]=t[l];else for(let l=s-1;l>=n;l-=1)t[l+1]=t[l];t[n]=a}moveInOperationsStack(t,e){let r=this.sdk.getOperationsStack().getStack(),o=r.length,s=Math.min(Math.max(0,t),o-1),n=Math.min(Math.max(0,e),o-1);if(s===n)return;let a=r[s];if(s<n)for(let l=s+1;l<=n;l+=1)r[l-1]=r[l];else for(let l=s-1;l>=n;l-=1)r[l+1]=r[l];r[n]=a,this.sdk.getOperationsStack().setAllToDirty()}getSiblingIndex(t){return t.getIndexInParent()}resolveAssetForSDK(t,e){switch(e=e,t){case"filter":return this.assetProvider.getAssetSource("filter",e.identifier);case"overlay":return this.assetProvider.getAssetSource("overlay",e.identifier);case"font":return this.assetProvider.getAssetSource("font",e.identifier)}return""}};var Kb=class{constructor(t){this.isEmpty=!1;this.isValid=!1;this.isWhiteLabel=()=>this.isValid&&this.licenseChecker.isWhiteLabel();this.areCustomAssetsAllowed=()=>this.isEmpty||this.isValid&&this.licenseChecker.areCustomAssetsAllowed();t&&t.length!==0?(this.licenseChecker=new Q.LicenseChecker(t),this.isValid=this.licenseChecker.validate()):t===""&&(this.isEmpty=!0)}isToolAllowed(t){return this.licenseChecker&&this.isValid&&t!==C.CUSTOM?this.licenseChecker.isToolAllowed(t):!0}};var uC=i=>{let t=Number(i).toString(16);return t.length<2&&(t=`0${t}`),t},mF=(i,t,e)=>{let r=uC(i*255),o=uC(t*255),s=uC(e*255);return`#${r}${o}${s}`},on=i=>{if(Nb(i)){let[t,e,r,o]=i;return`rgba(${t*255}, ${e*255}, ${r*255}, ${o})`}if(Ub(i)){let{r:t,g:e,b:r,a:o}=i;return`rgba(${t*255}, ${e*255}, ${r*255}, ${o})`}if(zb(i)){let[t,e,r]=i;return mF(t,e,r)}if(Lb(i)){let{r:t,g:e,b:r}=i;return mF(t,e,r)}return i},no=i=>i.map(t=>({identifier:t.name,color:t.color,colorString:on(t.color)})),ji={black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],gray:[191/255,191/255,191/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]},mC={transparent:[0/255,0/255,0/255,0],black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]};var Xb=[C.LIBRARY,[C.TRANSFORM,C.FILTER,C.ADJUSTMENT],[C.FOCUS,C.FRAME,C.OVERLAY],[C.TEXT,C.TEXT_DESIGN,C.STICKER,C.BRUSH]];var id={license:"",order:"default",language:"en",theme:"dark",layout:"advanced",mainCanvasActions:[ct.UNDO,ct.REDO,ct.EXPORT,ct.CLOSE],displayResizeWarning:!1,displayCloseWarning:!0,displayCanvasRendererWarning:!0,displayToolControlBarTitle:!0,engine:{crossOrigin:"anonymous",downscaleOptions:{maxMegaPixels:{desktop:10,mobile:5}},preferredRenderer:Iw()?"webgl":"canvas"},enableZoom:!0,forceCrop:!1,assetBaseUrl:"assets/",defaultTool:C.FILTER,tools:Xb,snapping:new Zd,filter:new Qd,focus:new tu,adjustment:new Jd,library:new iu,overlay:new ru,sticker:new ou,text:new su,textdesign:new au,frame:new eu,brush:new nu,transform:new lu,export:{image:{exportType:qe.IMAGE,format:Le.PNG,quality:.9,enableDownload:!0},filename:"photoeditorsdk-export"},custom:{}};var qb={[Et.BRIGHTNESS]:0,[Et.SATURATION]:0,[Et.CONTRAST]:0,[Et.GAMMA]:0,[Et.CLARITY]:0,[Et.EXPOSURE]:0,[Et.SHADOWS]:0,[Et.HIGHLIGHTS]:0,[Et.WHITES]:0,[Et.BLACKS]:0,[Et.TEMPERATURE]:0,[Et.SHARPNESS]:0};var rd=class{constructor(){this.snapshots=[];this.observeIndex=Y.box(-1)}addSnapshot(t){this.index===this.snapshots.length-1?this.snapshots=this.snapshots.concat(JSON.stringify(t)):this.snapshots=[...this.snapshots.slice(0,this.index+1),JSON.stringify(t)],this.observeIndex.set(this.snapshots.length-1)}getCurrentState(){return this.snapshots[this.index]}reset(){this.snapshots=[],this.observeIndex.set(-1)}undo(){return this.canUndo?(this.observeIndex.set(this.index-1),JSON.parse(this.getCurrentState())):null}redo(){return this.canRedo?(this.observeIndex.set(this.index+1),JSON.parse(this.getCurrentState())):null}discardSnapshotsfromIndex(t){t>0&&t<this.snapshots.length-1&&(this.snapshots=this.snapshots.slice(0,t),this.observeIndex.set(this.snapshots.length-1))}get index(){return this.observeIndex.get()}get canUndo(){return this.index>0}get canRedo(){return this.snapshots.length-1>this.index}};h([S],rd.prototype,"index",1),h([S],rd.prototype,"canUndo",1),h([S],rd.prototype,"canRedo",1);var _t;(function(i){i.ADD="add",i.EDIT="edit",i.DELETE="delete"})(_t||(_t={}));var Cl=class{constructor(t){this.localTransformStartIndex=null;this.awaitHistoryChange=!1;this.isDirtySinceSave=!1;this.undo=()=>K(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;let t=this.appHistoryManager.undo();yield this.applyState(t),this.awaitHistoryChange=!1,this.canUndo||(this.isDirtySinceSave=!1)}});this.redo=()=>K(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;let t=this.appHistoryManager.redo();yield this.applyState(t),this.awaitHistoryChange=!1}});this.editor=t,this.appHistoryManager=new rd}get canUndo(){return this.appHistoryManager.canUndo}get canRedo(){return this.appHistoryManager.canRedo}getHistoryState(){let t=at(this.editor.adjustmentsToolStore.state),e=at(this.editor.filterToolStore.state),r=this.editor.focusToolStore.getFocusStateForHistory(),o=at(this.editor.overlayToolStore.state),s=at(this.editor.frameToolStore.state),n=this.editor.brushToolStore.strokes||{strokes:[]},a=this.editor.spriteStore.getSpriteHistoryState(),l=this.editor.transformToolStore.serializableState;return{[C.ADJUSTMENT]:t,[C.FILTER]:e,[C.FOCUS]:r,[C.OVERLAY]:o,[C.FRAME]:s,[C.BRUSH]:n,sprite:a,[C.TRANSFORM]:l}}addInitialSnapshot(){let t=this.getHistoryState();this.appHistoryManager.addSnapshot({state:t,type:_t.ADD,description:"Initial State"})}addSnapshot(t=this.getHistoryState(),e,r){t&&((t.sprite||t.transform)&&(t=b(b({},this.getHistoryState()),t)),this.appHistoryManager.addSnapshot({state:t,type:e,description:r}),this.editor.configStore.events.onHistoryChange(),this.isDirtySinceSave||(this.isDirtySinceSave=!0))}saveTransformLocalSnapshotIndex(){this.localTransformStartIndex===null&&(this.localTransformStartIndex=this.appHistoryManager.snapshots.length)}removeTransformLocalSnapshots(){this.localTransformStartIndex!==null&&(this.appHistoryManager.discardSnapshotsfromIndex(this.localTransformStartIndex-1),this.localTransformStartIndex=null)}applyState(e){return K(this,arguments,function*({state:t}){try{if(t){let r=Object.keys(t);for(let o of r)switch(o){case C.FILTER:yield this.editor.filterToolStore.updateStateFromHistory(t[o]);break;case C.ADJUSTMENT:yield this.editor.adjustmentsToolStore.updateStateFromHistory(t[o]);break;case C.OVERLAY:yield this.editor.overlayToolStore.updateStateFromHistory(t[o]);break;case C.FRAME:yield this.editor.frameToolStore.updateStateFromHistory(t[o]);break;case C.FOCUS:yield this.editor.focusToolStore.updateStateFromHistory(t[o],this.editor.canvasStore.sizeVector);break;case C.BRUSH:yield this.editor.brushToolStore.updateStateFromHistory(t[o]);break;case"sprite":yield this.editor.spriteStore.updateStateFromHistory(t[o]);break;case"localTransform":yield this.editor.transformToolStore.updateLocalStateFromHistory(t.localTransform);break;case C.TRANSFORM:this.editor.outputContainer.pauseChildrenUpdates(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(t[o],!1),this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.onLeave(),this.editor.outputContainer.resumeChildrenUpdates(),yield this.editor.wait();break}yield this.editor.renderPromise()}}catch(r){console.error(r),this.editor.modalStore.showActionModal({type:Vt.ERROR,identifier:"unexpectedError",error:r,handleConfirm:()=>{window.location.reload()}})}})}isDirty(){return this.appHistoryManager.snapshots.length>1}reset(){this.appHistoryManager.reset(),this.isDirtySinceSave=!1}};h([w],Cl.prototype,"undo",2),h([w],Cl.prototype,"redo",2),h([S],Cl.prototype,"canUndo",1),h([S],Cl.prototype,"canRedo",1);var Pe=class{constructor(t,e){this.assets=[];this.entityMapper=t=>"items"in t?this.categoryMapper(t):this.itemMapper(t);this.categoryMapper=t=>t?b(b({},t),{thumbnailURI:this.getCategoryURI(t),name:this.config.locale[t.identifier]||t.name,items:t.items.map(this.itemMapper)}):null;this.itemMapper=t=>b(b({},t),{thumbnailURI:this.getItemURI(t),name:this.config.locale[t.identifier]||("name"in t?t.name:"")});this.getCategoryURI=t=>t.thumbnailURI&&(Dn(t.thumbnailURI)||t.thumbnailURI.substr(0,10)==="data:image")?t.thumbnailURI:this.config.getAssetPath(t[this.config.categoryKey]||"");this.getItemURI=t=>"thumbnailURI"in t&&(Dn(t.thumbnailURI)||t.thumbnailURI.substr(0,10)==="data:image")?t.thumbnailURI:this.config.getAssetPath(t[this.config.itemKey]||"");this.config=e,this.assets=t.map(this.entityMapper).filter(Boolean)}static isCategory(t){return Object.prototype.hasOwnProperty.call(t,"items")}get categories(){return this.assets.reduce((t,e)=>{if(Pe.isCategory(e))return[...t,e]},[]).filter(Boolean)}get items(){return this.assets.reduce((t,e)=>Pe.isCategory(e)?[...t,...e.items]:[...t,e],[]).filter(Boolean)}};var sn=class{constructor(t,e){this.from=t,this.to=e}contains(t){return this.from<=t&&t<=this.to}clamp(t){return Math.min(Math.max(this.from,t),this.to)}};var E7=new sn(-1,1),od=class{constructor(t){this.editAdjustments=({type:t,value:e})=>{let r=E7.clamp(e);this.state[t]=r};this.reset=()=>{Me(()=>{this.indexInContainer===-1&&(Object.keys(qb).forEach(t=>{this.state[t]=qb[t]}),this.orderHelper.removeIndex(C.ADJUSTMENT))})};this.setAdjustmentEffect=t=>{let e=this.orderHelper.addIndex(C.ADJUSTMENT);return this.effect?this.effect.setProperties(t):this.effect=this.engineMediator.engine.addAdjustments(t,this.engineMediator.image.container,e),this.effect.getProperties()};this.removeAdjustmentEffect=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))};this.engineMediator=t,this.state=qb}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get orderHelper(){return this.engineMediator.orderHelper}};h([Y],od.prototype,"state",2),h([w],od.prototype,"editAdjustments",2),h([w],od.prototype,"reset",2);var $t=class{constructor(t){this.dirty=Y.box(!1);this.editAdjustments=({type:t,value:e})=>{this.pureSetAdjustment({type:t,value:e}),this.editor.render()};this.toolSnapshot=()=>{this.dirty.set(!0),this.addSnapshot(_t.EDIT,C.ADJUSTMENT)};this.addSnapshot=(t,e)=>{this.editor.addSnapshot(void 0,t,e)};this.toggleOptionSelection=t=>{this.selectedOption=t};this.pureSetAdjustment=({type:t,value:e})=>{let r=this.adjustmentsStore.setAdjustmentEffect({[t]:e});this.adjustmentsStore.editAdjustments({type:t,value:r[t]})};this.pureReset=()=>{this.dirty.set(!1),this.adjustmentsStore.removeAdjustmentEffect(),this.adjustmentsStore.reset(),this.selectedOption=""};this.reset=()=>{this.pureReset(),this.addSnapshot(_t.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromHistory=t=>{Me(()=>{Object.keys(t).forEach(e=>{this.pureSetAdjustment({type:e,value:t[e]})})})};this.updateStateFromSerialization=t=>{this.updateStateFromHistory(t)};this.editor=t,this.adjustmentsStore=new od(this.editor.engineMediator),this.selectedOption="";let e=this.editor.assetProvider.getAssets("adjustment");this.entityManager=new Pe(e,b(b({},this.config),{categoryKey:"",itemKey:"thumbnailURI",locale:b(b({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("adjustment")}))}get selectedAdjustmentType(){return this.selectedOption}get isDirty(){return this.dirty.get()}get state(){return this.adjustmentsStore.state}get selectedOptionLabel(){let t=this.items.find(e=>e?e.identifier===this.selectedOption:!1);return t?t.name:""}get brightness(){return this.state.brightness}get saturation(){return this.state.saturation}get contrast(){return this.state.contrast}get gamma(){return this.state.gamma}get clarity(){return this.state.clarity}get exposure(){return this.state.exposure}get shadows(){return this.state.shadows}get highlights(){return this.state.highlights}get whites(){return this.state.whites}get blacks(){return this.state.blacks}get temperature(){return this.state.temperature}get sharpness(){return this.state.sharpness}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}get config(){return this.editor.configStore.config[C.ADJUSTMENT]}get locale(){return this.editor.configStore.locale[C.ADJUSTMENT]}};h([Y],$t.prototype,"selectedOption",2),h([Y],$t.prototype,"dirty",2),h([w],$t.prototype,"editAdjustments",2),h([w],$t.prototype,"toggleOptionSelection",2),h([w],$t.prototype,"pureSetAdjustment",2),h([w],$t.prototype,"pureReset",2),h([w],$t.prototype,"reset",2),h([w],$t.prototype,"updateStateFromHistory",2),h([w],$t.prototype,"updateStateFromSerialization",2),h([S],$t.prototype,"selectedAdjustmentType",1),h([S],$t.prototype,"isDirty",1),h([S],$t.prototype,"state",1),h([S],$t.prototype,"selectedOptionLabel",1),h([S],$t.prototype,"brightness",1),h([S],$t.prototype,"saturation",1),h([S],$t.prototype,"contrast",1),h([S],$t.prototype,"gamma",1),h([S],$t.prototype,"clarity",1),h([S],$t.prototype,"exposure",1),h([S],$t.prototype,"shadows",1),h([S],$t.prototype,"highlights",1),h([S],$t.prototype,"whites",1),h([S],$t.prototype,"blacks",1),h([S],$t.prototype,"temperature",1),h([S],$t.prototype,"sharpness",1),h([S],$t.prototype,"categories",1),h([S],$t.prototype,"items",1),h([S],$t.prototype,"config",1),h([S],$t.prototype,"locale",1);var Zb={identifier:"identity",intensity:1,isDuotone:!1};var A7=new sn(0,1),fa=class{constructor(t){this.changeIdentifier=t=>{this.state.identifier=t};this.changeIfDuotone=t=>{this.state.isDuotone=t};this.changeIntensity=t=>{let e=A7.clamp(t);this.state.intensity=e};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=Zb.identifier,this.state.intensity=Zb.intensity,this.removeIndex())};this.setFilterEffect=({identifier:t,intensity:e,isDuotone:r})=>{let o=this.state;this.changeIdentifier(t),this.changeIntensity(e),this.changeIfDuotone(r),this.removeFilterEffect();let s=this.engineMediator.orderHelper.addIndex(C.FILTER);return r?new Promise((n,a)=>{this.engineMediator.engine.addDuoToneFilterFromAssets(t,this.engineMediator.image.container,s).then(l=>{this.effect=l,this.effect.setProperties({colorIntensity:e}),n()}).catch(l=>{this.fallbackOnError(o),a(l)})}):new Promise((n,a)=>{this.engineMediator.engine.addLUTFilterFromAssets(t,this.engineMediator.image.container,s).then(l=>{this.effect=l,this.effect.setProperties({intensity:e}),n()}).catch(l=>{this.fallbackOnError(o),a(l)})})};this.removeFilterEffect=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))};this.setEffectProperties=({intensity:t})=>this.effect?(this.state.isDuotone?this.effect.setProperties({colorIntensity:t}):this.effect.setProperties({intensity:t}),this.effect.getProperties()):null;this.removeIndex=()=>{this.engineMediator.orderHelper.removeIndex(C.FILTER)};this.fallbackOnError=t=>{this.changeIdentifier(t.identifier),this.changeIntensity(t.intensity),t.identifier==="identity"&&this.removeIndex()};this.engineMediator=t,this.state=Zb}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}};h([Y],fa.prototype,"state",2),h([w],fa.prototype,"changeIdentifier",2),h([w],fa.prototype,"changeIfDuotone",2),h([w],fa.prototype,"changeIntensity",2),h([w],fa.prototype,"reset",2);var pC="identity",Be=class{constructor(t){this.selectFilter=(t,e=1)=>K(this,null,function*(){t!==this.identifier&&(yield this.filterStore.setFilterEffect({identifier:t,intensity:e,isDuotone:this.isOptionDuoTone(t)}),this.editor.render(),this.addSnapshot(_t.ADD,C.FILTER))});this.changeIntensity=t=>{let e=this.isOptionDuoTone(this.identifier),r=this.filterStore.setEffectProperties({intensity:t});if(r){let o=e?r.colorIntensity:r.intensity;this.filterStore.changeIntensity(o),this.editor.render()}};this.setImageAndGetPreviews=()=>K(this,null,function*(){let{image:t}=this.editor.activeStore.state;yield this.editor.previewThumbnails.addImageToContainer(t),yield this.getAllFilterPreview()});this.getAllFilterPreview=()=>K(this,null,function*(){let t=this.entityManager.items.map(s=>({identifier:s.identifier,isDuotone:this.isOptionDuoTone(s.identifier)})),e=yield this.editor.previewThumbnails.getAllFilterPreviewThumbnails(t);yield this.editor.wait();let{config:r}=this,o=this.editor.configStore.assetProvider.getAssets("filter").map(s=>b(b({},s),{items:s.items.map(n=>b(b({},n),{thumbnailURI:e[n.identifier]}))}));this.entityManager=new Pe(o,b(b({},r),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))});this.toolSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.controls.sliderIntensity)};this.addSnapshot=(t,e)=>{this.editor.addSnapshot(void 0,t,e)};this.pureReset=()=>{this.selectedCategory=pC,this.filterStore.removeFilterEffect(),this.filterStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(_t.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.toggleCategorySelection=t=>{this.selectedCategory=this.selectedCategory===t?pC:t};this.updateStateFromSerialization=({identifier:t,intensity:e})=>{let r=this.doesFilterAssetExist(t);if(r){let o=La(r);return this.filterStore.setFilterEffect({identifier:t,intensity:e,isDuotone:o})}return new Promise((o,s)=>{s(new Error(`Filter Asset ${t} doesn't exist`))})};this.updateStateFromHistory=t=>K(this,null,function*(){return t.identifier==="identity"?(this.pureReset(),new Promise(e=>{e()})):this.filterStore.setFilterEffect(t)});this.doesFilterAssetExist=t=>this.entityManager.items.find(e=>t===e.identifier);this.isOptionDuoTone=t=>{let e=this.doesFilterAssetExist(t);return e?La(e):!1};this.editor=t,this.selectedCategory=pC,this.filterStore=new fa(this.editor.engineMediator);let{config:e}=this,r=this.editor.configStore.assetProvider.getAssets("filter");this.entityManager=new Pe(r,b(b({},e),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))}get state(){return this.filterStore.state}get identifier(){return this.state.identifier}get intensity(){return this.state.intensity}get isDuotone(){return this.state.isDuotone}get selectedCategoryIdentifier(){return this.selectedCategory}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[C.FILTER]}get locale(){return this.editor.configStore.locale[C.FILTER]}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}};h([Y],Be.prototype,"selectedCategory",2),h([Y],Be.prototype,"entityManager",2),h([w],Be.prototype,"selectFilter",2),h([w],Be.prototype,"changeIntensity",2),h([w],Be.prototype,"pureReset",2),h([w],Be.prototype,"reset",2),h([w],Be.prototype,"toggleCategorySelection",2),h([w],Be.prototype,"updateStateFromSerialization",2),h([w],Be.prototype,"updateStateFromHistory",2),h([S],Be.prototype,"state",1),h([S],Be.prototype,"identifier",1),h([S],Be.prototype,"intensity",1),h([S],Be.prototype,"isDuotone",1),h([S],Be.prototype,"selectedCategoryIdentifier",1),h([S],Be.prototype,"isOptionSelected",1),h([S],Be.prototype,"config",1),h([S],Be.prototype,"locale",1),h([S],Be.prototype,"categories",1),h([S],Be.prototype,"items",1);function hC(i){return i&&typeof i=="object"&&Object.prototype.toString.call(i)!=="[object RegExp]"&&Object.prototype.toString.call(i)!=="[object Date]"}function F7(i){return Array.isArray(i)?[]:{}}function gC(i,t){return t&&t.clone===!0&&hC(i)?fC(F7(i),i,t):i}function O7(i,t,e){let r={};return hC(i)&&Object.keys(i).forEach(o=>{r[o]=gC(i[o],e)}),Object.keys(t).forEach(o=>{let s=hC(t[o])&&i[o];r[o]=s?fC(i[o],t[o],e):gC(t[o],e)}),r}function fC(i,t,e){return Array.isArray(t)?Array.isArray(i)?t:gC(t,e):O7(i,t,e)}function hr(i,t=null){if(!Array.isArray(i)||i.length<2)throw new Error("first argument should be an array with at least two elements");return i.reduce((e,r)=>fC(e,r,t))}var bC=class extends Ri{onExport(t){this.emit(rt.EXPORT,t)}onClose(){this.emit(rt.CLOSE)}onHistoryChange(){this.emit(rt.HISTORY_CHANGE)}onEditorReady(){this.emit(rt.EDITOR_READY)}onErrorImageLoading(t){this.emit(rt.ERROR_IMAGE_LOADING,t)}onImageLoaded(){this.emit(rt.IMAGE_LOAD)}onStickerUploadedAdd(t){this.emit(rt.STICKER_UPLOAD_ADD,t)}onToolChanged(t){this.emit(rt.TOOL_ENTER,t)}};var _C={common:{error:"Fehler",warning:"Warnung",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Farbe",sliderOpacity:"Farbe Transparenz"}}},mainCanvasActions:{buttonExport:"Bild Exportieren",buttonUndo:"R\xFCckg\xE4ngig machen",buttonRedo:"Wiederholen",buttonClose:"Schlie\xDFen"},infoModals:{exporting:{heading:"Exportieren...",body:"Einen Moment bitte..."},saving:{heading:"Speichere...",body:"Einen Moment bitte..."},loading:{heading:"Lade...",body:"Einen Moment bitte..."},resizing:{heading:"Bild wird bearbeitet...",body:"Einen Moment bitte..."},loadingFonts:{heading:"Lade Schriftarten...",body:"Einen Moment bitte..."},stickerLoading:{heading:"Lade Sticker...",body:"Einen Moment bitte..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Laden des Bildes fehlgeschlagen. Dies kann verschiedene Gr\xFCnde haben, beispielsweise kann die Datei defekt sein oder der Dateityp wird nicht unterst\xFCtzt",buttonYes:"Neu Laden"},rendering:{headingDelimiter:":",body:"Beim Rendern des Bildes ist ein Fehler aufgetreten",buttonYes:"Neu Laden"},fontLoading:{headingDelimiter:":",heading:"Laden von Schriftarten ist fehlgeschlagen",body:"Die folgenden Schriftarten konnten nicht geladen werden: ${error}",buttonNo:"Schlie\xDFen"},webcamUnavailable:{headingDelimiter:":",body:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})",buttonYes:"Schlie\xDFen"},stickerLoading:{headingDelimiter:":",body:"Laden des Stickers fehlgeschlagen.",buttonNo:"Schlie\xDFen"},unexpectedError:{headingDelimiter:":",body:"Ein unerwarteter Fehler ist aufgetreten, ${error}",buttonYes:"Neu Laden"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Bild verkleinert",body:"Ihr Bild \xFCbersteigt die maximale Gr\xF6sse von ${megapixels} megapixels und wurde auf ${width}x${height} Pixel verkleinert",buttonYes:"Weiter"},discardChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die \xC4nderungen verwerfen wollen?",buttonYes:"\xC4nderungen verwerfen",buttonNo:"\xC4nderungen beibehalten"},unsavedChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die \xC4nderungen verwerfen wollen?",buttonYes:"Beenden ohne zu speichern",buttonNo:"Schlie\xDFen"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Ihre Daten wurden von einem veralteten Format geladen und k\xF6nnten anders aussehen",buttonYes:"\xC4nderungen anwenden",buttonNo:"Abbrechen"},unsupportedWebGLRenderer:{body:"Es wurde ein Problem im Browser festgestellt, welches zu langen Ladezeiten f\xFChren kann. Bitte probieren sie einen anderen Browser.",buttonYes:"Weiter"}},library:{title:"Bibliothek",controls:{buttonUpload:"Bild Hochladen",buttonWebcamOpen:"Webcam \xD6ffnen",buttonWebcamClose:"Webcam Schlie\xDFen",placeholderSearch:"Bibliothek durchsuchen",noResults:"Keine Ergebnisse"}},filter:{title:"Filter",controls:{buttonReset:"Zur\xFCcksetzen",sliderIntensity:"Filter Intensit\xE4t"},categories:{[oe.DuoTone]:"DuoTone",[oe.BW]:"B & W",[oe.Vintage]:"Vintage",[oe.Smooth]:"Smooth",[oe.Cold]:"Cold",[oe.Warm]:"Warm",[oe.Legacy]:"Legacy"},items:{[I.Inferno]:"Inferno",[I.Chestnut]:"Chestnut",[I.Fixie]:"Fixie",[I.Fridge]:"Fridge",[I.Sunny70s]:"Sunny 70s",[I.FlatBlack]:"Flat Black",[I.Mellow]:"Mellow",[I.HardStuff]:"Hard Stuff",[I.Oldtimer]:"Oldtimer",[I.AD1920]:"1920 A.D.",[I.Ancient]:"Ancient",[I.Kalmen]:"Kalmen",[I.Joran]:"Joran",[I.Polaroid]:"Polaroid",[I.Zephyr]:"Zephyr",[I.Levante]:"Levante",[I.Greyed]:"Greyed",[I.Classic]:"Classic",[I.Colorful]:"Colorful",[I.Snappy]:"Snappy",[I.Candy]:"Candy",[I.Creamy]:"Creamy",[I.LowFire]:"Low Fire",[I.Colla]:"Colla",[I.Sunrise]:"Sunrise",[I.Moss]:"Moss",[I.Food]:"Food",[I.Glam]:"Glam",[I.Gobblin]:"Gobblin",[I.HighCarb]:"High Carb",[I.Hicon]:"Hicon",[I.K1]:"K1",[I.K6]:"K6",[I.Pebble]:"Pebble",[I.Keen]:"Keen",[I.Lemon]:"Lemon",[I.Litho]:"Litho",[I.Lomo]:"Lomo",[I.Lomo100]:"Lomo 100",[I.Lucid]:"Lucid",[I.Neat]:"Neat",[I.Pumpkin]:"Pumpkin",[I.Solanus]:"Solanus",[I.Pale]:"Pale",[I.Pitched]:"Pitched",[I.Weathered]:"Weathered",[I.GreenGap]:"Green Gap",[I.PolaSX]:"Pola SX",[I.Pro400]:"Pro 400",[I.Quozi]:"Quozi",[I.Sepia]:"Sepia",[I.Settled]:"Settled",[I.Seventies]:"Seventies",[I.Soft]:"Soft",[I.Steel]:"Steel",[I.Summer]:"Summer",[I.Golden]:"Golden",[I.Tender]:"Tender",[I.Twilight]:"Twilight",[I.Softy]:"Softy",[I.Dusty]:"Dusty",[I.Desert]:"Desert",[I.Peach]:"Peach",[I.Clash]:"Clash",[I.Plum]:"Plum",[I.Breezy]:"Breezy",[I.DeepBlue]:"Deep Blue",[I.Frog]:"Frog",[I.Sunset]:"Sunset"}},adjustment:{title:"Korrekturen",controls:{buttonReset:"Zur\xFCcksetzen"},categories:{basics:"Grundlagen",refinements:"Feinheiten"},items:{brightness:"Helligkeit",saturation:"S\xE4ttigung",contrast:"Kontrast",gamma:"Gamma",sharpness:"Sch\xE4rfe",clarity:"Klarheit",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",whites:"Wei\xDF",blacks:"Schwarz",temperature:"Temperatur"}},focus:{title:"Weichzeichnen",controls:{buttonReset:"Zur\xFCcksetzen",sliderIntensity:"Focus Intensit\xE4t"},items:{radial:"Kreisf\xF6rmig",mirrored:"Gespiegelt",linear:"Linear",gaussian:"Gau\xDFsch"},history:{focusPosition:"Focus Position",focusSize:"Focus Gr\xF6\xDFe"}},overlay:{title:"Overlays",controls:{buttonReset:"Zur\xFCcksetzen",sliderOpacity:"Overlay Transparenz",carouselBlendMode:"Overlay Mischmodus",blendModeNormal:"Normal",blendModeOverlay:"\xDCberblenden",blendModeHardLight:"Hartes Licht",blendModeSoftLight:"Weiches Licht",blendModeMultiply:"Multiplizieren",blendModeDarken:"Abdunkeln",blendModeLighten:"Aufhellen",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Transparenz",tabBlendMode:"Mischmodus"},items:{[dt.Bokeh]:"Bokeh",[dt.Chop]:"Chop",[dt.Clouds]:"Clouds",[dt.Golden]:"Golden",[dt.Grain]:"Grain",[dt.Hearts]:"Hearts",[dt.LightLeak1]:"Light Leak 1",[dt.LightLeak2]:"Light Leak 2",[dt.Metal]:"Metal",[dt.Mosaic]:"Mosaic",[dt.Painting]:"Painting",[dt.Paper]:"Paper",[dt.Rain]:"Rain",[dt.Vintage]:"Vintage",[dt.Wall1]:"Wall",[dt.Wall2]:"Wall 2",[dt.Wood]:"Wood"}},sticker:{title:"Sticker",controls:{buttonUpload:"Sticker Hochladen",sliderOpacity:"Sticker Transparenz",selectColor:"Stickerfarbe",tabColor:"Farbe",tabOpacity:"Transparenz"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren",buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"Neuer Text",dropdownFontFamily:"Schriftart",textFontSize:"Schriftgr\xF6\xDFe",selectAlignment:"Ausrichtung",selectFontColor:"Schriftfarbe",selectBackgroundColor:"Hintergrundfarbe",sliderLineSpacing:"Zeilenabstand",tabColor:"Farbe",tabBgColor:"Hintergrund",tabAlignment:"Ausrichtung",tabLineHeight:"Zeilenh\xF6he",tabFontSize:"Schriftgr\xF6\xDFe"},canvasControls:{placeholderText:"Etwas aufschreiben",buttonSave:"Fertig",buttonClose:"Abbrechen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"Neues Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Textfarbe",tabColor:"Farbe",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Etwas aufschreiben mit Style",buttonSave:"Done",buttonClose:"Schlie\xDFen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonInvert:"Invertieren",buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Rahmen",controls:{buttonReset:"Zur\xFCcksetzen",sliderOpacity:"Rahmen Transparenz",sliderSize:"Rahmen Dicke",selectColor:"Rahmen Farbe",tabColor:"Farbe",tabOpacity:"Transparenz",tabSize:"Dicke"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Malen",controls:{buttonReset:"Zur\xFCcksetzen",sliderSize:"Dicke",sliderHardness:"H\xE4rte",selectColor:"Farbe",tabSize:"Dicke",tabHardness:"H\xE4rte",tabColor:"Farbe"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Zuschneiden",controls:{buttonReset:"Zur\xFCcksetzen",checkboxKeepResolution:"Fixiere Aufl\xF6sung",inputCropSize:"Bildgr\xF6\xDFe",inputHeight:"h",inputWidth:"b",tabFlipAndRotate:"Spiegeln & Drehen",tabResolution:"Aufl\xF6sung",tabCropSize:"Bildgr\xF6\xDFe"},categories:{imgly_transforms_common:"Standard",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Frei",imgly_transform_common_square:"Quadratisch",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Titel",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln",buttonRotateClockwise:"Drehe im Uhrzeigersinn",buttonRotateAntiClockwise:"Drehe gegen Uhrzeigersinn"}},[C.CUSTOM]:{title:"Benutzerdefiniert"}};var Sl={common:{error:"Error",warning:"Warning",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Color",sliderOpacity:"Color Opacity"}}},mainCanvasActions:{buttonExport:"Export Image",buttonUndo:"Undo",buttonRedo:"Redo",buttonClose:"Close"},infoModals:{exporting:{heading:"Exporting...",body:"Just a few seconds..."},saving:{heading:"Saving...",body:"Just a few seconds..."},loading:{heading:"Loading...",body:"Just a few seconds..."},resizing:{heading:"Resizing...",body:"Just a few seconds..."},loadingFonts:{heading:"Loading Fonts...",body:"Just a few seconds..."},stickerLoading:{heading:"Loading Sticker...",body:"Just a few seconds..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Failed to load image. This can have multiple reasons, e.g. the file is corrupted or the file type is not supported",buttonYes:"Reload"},rendering:{headingDelimiter:":",body:"An error has occurred while rendering the image",buttonYes:"Reload"},fontLoading:{headingDelimiter:":",heading:"Failed to load font",body:"The following fonts could not be loaded: ${error}",buttonNo:"Close"},webcamUnavailable:{headingDelimiter:":",body:"Unable to display webcam image (Error: ${error})",buttonYes:"Close"},stickerLoading:{headingDelimiter:":",body:"Unable to load the sticker",buttonNo:"Close"},unexpectedError:{headingDelimiter:":",body:"An unexpected error has occured ${error}",buttonYes:"Reload"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Image resized",body:"Your image exceeds the maximum size of ${megapixels} megapixels and has been resized to ${width}x${height} pixels",buttonYes:"Continue"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Your data was restored from a legacy data format and might look different",buttonYes:"Apply changes",buttonNo:"Cancel"},discardChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to discard the changes?",buttonYes:"Discard changes",buttonNo:"Keep Changes"},unsavedChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to exit?",buttonYes:"Exit without saving",buttonNo:"Cancel"},unsupportedWebGLRenderer:{body:"A problem has been detected in the browser that could cause long loading times. Please try a different browser.",buttonYes:"Continue"}},library:{title:"Library",controls:{buttonUpload:"Upload Image",buttonWebcamOpen:"Open Webcam",buttonWebcamClose:"Close Webcam",placeholderSearch:"Search Library",noResults:"No Results"}},filter:{title:"Filters",controls:{buttonReset:"Remove Filter",sliderIntensity:"Filter Intensity"},categories:{[oe.DuoTone]:"DuoTone",[oe.BW]:"B & W",[oe.Vintage]:"Vintage",[oe.Smooth]:"Smooth",[oe.Cold]:"Cold",[oe.Warm]:"Warm",[oe.Legacy]:"Legacy"},items:{[I.Inferno]:"Inferno",[I.Chestnut]:"Chestnut",[I.Fixie]:"Fixie",[I.Fridge]:"Fridge",[I.Sunny70s]:"Sunny 70s",[I.FlatBlack]:"Flat Black",[I.Mellow]:"Mellow",[I.HardStuff]:"Hard Stuff",[I.Oldtimer]:"Oldtimer",[I.AD1920]:"1920 A.D.",[I.Ancient]:"Ancient",[I.Kalmen]:"Kalmen",[I.Joran]:"Joran",[I.Polaroid]:"Polaroid",[I.Zephyr]:"Zephyr",[I.Levante]:"Levante",[I.Greyed]:"Greyed",[I.Classic]:"Classic",[I.Colorful]:"Colorful",[I.Snappy]:"Snappy",[I.Candy]:"Candy",[I.Creamy]:"Creamy",[I.LowFire]:"Low Fire",[I.Colla]:"Colla",[I.Sunrise]:"Sunrise",[I.Moss]:"Moss",[I.Food]:"Food",[I.Glam]:"Glam",[I.Gobblin]:"Gobblin",[I.HighCarb]:"High Carb",[I.Hicon]:"Hicon",[I.K1]:"K1",[I.K6]:"K6",[I.Pebble]:"Pebble",[I.Keen]:"Keen",[I.Lemon]:"Lemon",[I.Litho]:"Litho",[I.Lomo]:"Lomo",[I.Lomo100]:"Lomo 100",[I.Lucid]:"Lucid",[I.Neat]:"Neat",[I.Pumpkin]:"Pumpkin",[I.Solanus]:"Solanus",[I.Pale]:"Pale",[I.Pitched]:"Pitched",[I.Weathered]:"Weathered",[I.GreenGap]:"Green Gap",[I.PolaSX]:"Pola SX",[I.Pro400]:"Pro 400",[I.Quozi]:"Quozi",[I.Sepia]:"Sepia",[I.Settled]:"Settled",[I.Seventies]:"Seventies",[I.Soft]:"Soft",[I.Steel]:"Steel",[I.Summer]:"Summer",[I.Golden]:"Golden",[I.Tender]:"Tender",[I.Twilight]:"Twilight",[I.Softy]:"Softy",[I.Dusty]:"Dusty",[I.Desert]:"Desert",[I.Peach]:"Peach",[I.Clash]:"Clash",[I.Plum]:"Plum",[I.Breezy]:"Breezy",[I.DeepBlue]:"Deep Blue",[I.Frog]:"Frog",[I.Sunset]:"Sunset"}},adjustment:{title:"Adjust",controls:{buttonReset:"Reset Adjustment"},categories:{basics:"Basic",refinements:"Refinements"},items:{brightness:"Brightness",saturation:"Saturation",contrast:"Contrast",gamma:"Gamma",sharpness:"Sharpness",clarity:"Clarity",exposure:"Exposure",shadows:"Shadows",highlights:"Highlights",whites:"Whites",blacks:"Blacks",temperature:"Temperature"}},focus:{title:"Focus",controls:{buttonReset:"Remove Focus",sliderIntensity:"Focus Intensity"},items:{radial:"Radial",mirrored:"Mirrored",linear:"Linear",gaussian:"Gaussian"},history:{focusPosition:"Focus Position",focusSize:"Focus Size"}},overlay:{title:"Overlays",controls:{buttonReset:"Remove Overlay",sliderOpacity:"Overlay Opacity",carouselBlendMode:"Overlay Blend mode",blendModeNormal:"Normal",blendModeOverlay:"Overlay",blendModeHardLight:"Hard Light",blendModeSoftLight:"Soft Light",blendModeMultiply:"Multiply",blendModeDarken:"Darken",blendModeLighten:"Lighten",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Opacity",tabBlendMode:"Blend Mode"},items:{[dt.Bokeh]:"Bokeh",[dt.Chop]:"Chop",[dt.Clouds]:"Clouds",[dt.Golden]:"Golden",[dt.Grain]:"Grain",[dt.Hearts]:"Hearts",[dt.LightLeak1]:"Light Leak 1",[dt.LightLeak2]:"Light Leak 2",[dt.Metal]:"Metal",[dt.Mosaic]:"Mosaic",[dt.Painting]:"Painting",[dt.Paper]:"Paper",[dt.Rain]:"Rain",[dt.Vintage]:"Vintage",[dt.Wall1]:"Wall",[dt.Wall2]:"Wall 2",[dt.Wood]:"Wood"}},sticker:{title:"Stickers",controls:{buttonUpload:"Upload Sticker",sliderOpacity:"Sticker Opacity",selectColor:"Sticker Color",tabColor:"Color",tabOpacity:"Opacity"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate",buttonFlipHorizontal:"Flip",buttonFlipVertical:"Flip"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"New Text",dropdownFontFamily:"Font Family",textFontSize:"Font Size",selectAlignment:"Alignment",selectFontColor:"Font Color",selectBackgroundColor:"Background Color",sliderLineSpacing:"Line Spacing",tabColor:"Color",tabBgColor:"Bg Color",tabAlignment:"Alignment",tabLineHeight:"Line Height",tabFontSize:"Font Size"},canvasControls:{placeholderText:"Write Something",buttonSave:"Done",buttonClose:"Cancel",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"New Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Text Color",tabColor:"Color",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Write Something With Style",buttonSave:"Done",buttonClose:"Schlie\xDFen",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonInvert:"Invert",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Frames",controls:{buttonReset:"Remove Frame",sliderOpacity:"Frame Opacity",sliderSize:"Frame Size",selectColor:"Frame Color",tabColor:"Color",tabOpacity:"Opacity",tabSize:"Size"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Brush",controls:{buttonReset:"Remove Brush",sliderSize:"Brush Size",sliderHardness:"Brush Hardness",selectColor:"Brush Color",tabSize:"Size",tabHardness:"Hardness",tabColor:"Color"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Transform",controls:{buttonReset:"Reset to default",checkboxKeepResolution:"Keep Resolution",inputCropSize:"Crop Size",inputHeight:"h",inputWidth:"w",tabFlipAndRotate:"Flip & Rotate",tabResolution:"Resolution",tabCropSize:"Crop Size"},categories:{imgly_transforms_common:"Common",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Custom",imgly_transform_common_square:"Square",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Title",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Flip Horizontal",buttonFlipVertical:"Flip Vertical",buttonRotateClockwise:"Rotate Clockwise",buttonRotateAntiClockwise:"Rotate Counterclockwise"}},[C.CUSTOM]:{title:"Custom"}};var pF=i=>i==="de"?_C:Sl,hF=(i,t)=>t&&t[i]?hr([pF(i),t[i]]):pF(i)||Sl;var R7={headline1:{size:16,letterSpacing:1.5,case:"uppercase"},headline2:{size:14,letterSpacing:.8,case:"uppercase"},body:{size:13,letterSpacing:0,case:"none"},label:{size:13,letterSpacing:0,case:"capitalize"},basicUICardLabel:{size:12,letterSpacing:0,case:"capitalize"},button1:{size:12,letterSpacing:1.2,case:"uppercase"},button2:{size:14,letterSpacing:0,case:"capitalize"},basicUITabLabel:{size:14,letterSpacing:.8,case:"uppercase"}},P7={toast:2,controlsBar:5,buttonGroup:5,toolControlBar:6,toolbar:7,label:10,disable:11,canvas:{knob:4,bar:5,controls:5,snappingGuide:1,crop:{grid:2,dragImage:3,backdrop:4},webcam:{backdrop:7}},input:{list:6},button:{float:5},dialog:{base:100,backdrop:1,container:2},colorItem:{overlay:2,background:1,tiledBackground:0}},Jb=()=>{let i=8,t=230,e=3*i,r=t-2*e,o=(r-2*i)/3,s=(r-i)/2;return{advancedUIToolbar:{width:55,itemHeight:48,seperatorHeight:20,marginBottom:0},advancedUIToolControlBar:{width:t,padding:`${2*i}px ${e}px`,marginBottom:0},advancedCard:{small:{height:o,width:o},medium:{height:s,width:s},large:{height:86,width:r}},advancedSpacer:8,basicCanvasOffset:40+76-88,basicUIToolbar:{openHeight:88,closeHeight:40},basicToolControlBar:{itemsBarHeight:72,controlsBarHeight:80,maxHeight:72+40+4,maxWidth:300},basicCard:{medium:{height:56,width:90},large:{height:60,width:110}},basicSpacer:8,mainCanvasActionBar:{height:50},crop:{minSize:50},canvas:{marginTop:0,transform:{minSliderWidth:435,minValueWidth:235,minFlipWidth:160}},canvasControls:{sprite:{controlOffset:16,rotateHandle:{height:16},minSize:30,controlPadding:16},knob:{size:16,touchable:{desktop:24}},corner:{size:14,touchable:{desktop:24,mobile:48},borderWidth:4},width:{size:14}},buttons:{float:{size:56}},colorItem:{size:20},color:{colorPicker:{width:214,height:370,saturationSlider:{height:150},thumb:{size:14},arrow:{width:36}}},fontSystem:R7,zIndex:P7}};var B7=({primary:i="#365afc",background:t="#0B0B0B",foreground:e="#FFFFFF"}={primary:"#365afc",background:"#0B0B0B",foreground:"#FFFFFF"})=>{let r="rgba(255, 255, 255, 0.90)",o="rgba(255, 255, 255, 0.60)",s="rgba(255, 255, 255, 0.38)",n="#424242",a="#333333",l="#242424",c="#171717",d="#0B0B0B",u="rgba(255, 255, 255, 0.08)",m="rgba(0, 0, 0, 0.3)",p="rgba(89, 121, 252, 0.20)",f="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:t,foreground:e,primary:i,warning:"#ffba5c",error:"#c2393a",success:"#39c26c",focusOutlineColor:"rgba(255, 255, 255, 0.12)",scrollbar:{handleColor:"rgba(255, 255, 255, 0.2)"},button:{outlinedBorderColor:a,activeForeground:i,containedPrimaryBackground:i,containedPrimaryForeground:r,outlinedPrimaryBackground:l,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:i,textSecondaryForeground:o,outlinedInactiveOverlayColor:m,textInactiveOpacity:"0.5",hoverOverlayColor:u},checkbox:{background:a,foreground:e,activeForeground:e,activeBackground:i,inactiveOpacity:f,hoverOpacity:"0.8"},modal:{background:l,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:a,foreground:r,activeBorderColor:i,activeOverlayColor:p,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:r,inactiveOverlayColor:m,hoverOverlayColor:u},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:i,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:a,caretColor:s,listBackground:a,listBorderColor:a,listItemHoverBackground:n,listForeground:o,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,inactiveOpacity:f},textInput:{foreground:r,hoverBorderColor:"rgba(255, 255, 255, 0.40)",background:"transparent",borderColor:a,inactiveOpacity:f},slider:{trackColor:"rgba(255, 255, 255, 0.4)",activeTrackColor:i,thumbBackground:c,thumbBorderColor:i,inactiveOpacity:f,hoverOpacity:"0.7"},selectColor:{activeBorderColor:i,inactiveOpacity:f},toolbar:{foreground:r,background:l,activeBackground:"transparent",activeForeground:i,borderColor:"transparent"},tooltip:{background:n,foreground:r},toolControlBar:{background:"rgba(23, 23, 23, 0.9)",borderColor:"transparent",shadow:"none",separatorColor:a,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:f},mainCanvasActionBar:{background:"linear-gradient(0deg, transparent 0%,  rgba(0, 0, 0, 0.6) 98%)",foreground:r,borderColor:"none"},canvasActionBar:{background:n,foreground:r,separatorColor:s},canvas:{background:d,controlsOutline:"rgba(255, 255, 255, 0.5)",controlsColor:"#ffffff",cropBackdrop:"rgba(0, 0, 0, 0.5)"},colorPicker:{listBackground:a,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:n},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:e,background:d},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#424242",highlight:"#565656",shadow:"#333333"}}}},Qb=B7;var M7=({primary:i="#1e47fb",background:t="#FBFBFB",foreground:e="#000000"}={primary:"#1e47fb",background:"#FBFBFB",foreground:"#000000"})=>{let r="rgba(0, 0, 0, 0.90)",o="rgba(0, 0, 0, 0.60)",s="rgba(0, 0, 0, 0.38)",n="#CCCCCC",a="#D4D4D4",l="#E6E6E6",c="#EEEEEE",d="#FBFBFB",u="rgba(125, 125, 125, 0.12)",m="rgba(30, 71, 251, 0.2)",p="rgba(0, 0, 0, 0.3)",f="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:t,foreground:e,primary:i,warning:"#ffb045",error:"#c01a1b",success:"#17c658",focusOutlineColor:"rgba(125, 125, 125, 0.12)",scrollbar:{handleColor:"rgba(0, 0, 0, 0.2)"},button:{outlinedBorderColor:a,activeForeground:i,containedPrimaryBackground:i,containedPrimaryForeground:"rgba(255, 255, 255, 0.9)",outlinedPrimaryBackground:l,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:i,textSecondaryForeground:o,outlinedInactiveOverlayColor:p,textInactiveOpacity:"0.5",hoverOverlayColor:u},checkbox:{background:a,foreground:e,activeForeground:e,activeBackground:i,inactiveOpacity:f,hoverOpacity:"0.8"},modal:{background:l,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:a,foreground:r,activeBorderColor:i,activeOverlayColor:m,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:"rgba(255, 255, 255, 0.87)",inactiveOverlayColor:p,hoverOverlayColor:u},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:i,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:a,listBackground:a,caretColor:s,listForeground:o,listBorderColor:a,listItemHoverBackground:n,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,inactiveOpacity:f},textInput:{foreground:r,hoverBorderColor:r,background:"transparent",borderColor:a,inactiveOpacity:f},slider:{trackColor:n,activeTrackColor:i,thumbBackground:c,thumbBorderColor:i,inactiveOpacity:f,hoverOpacity:"0.7"},selectColor:{activeBorderColor:i,inactiveOpacity:f},toolbar:{foreground:r,background:a,activeBackground:"transparent",activeForeground:i,borderColor:"transparent"},tooltip:{background:n,foreground:r},toolControlBar:{background:"rgba(238, 238, 238, 0.9)",borderColor:c,shadow:"none",separatorColor:a,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:f},mainCanvasActionBar:{background:"transparent",foreground:r,borderColor:"none"},canvasActionBar:{background:n,foreground:r,separatorColor:s},canvas:{background:d,controlsOutline:"rgba(255, 255, 255, 0.6)",controlsColor:"#ffffff",cropBackdrop:"rgba(255, 255, 255, 0.3)"},colorPicker:{listBackground:a,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:n},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:e,background:d},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#B8B8B8",highlight:"#E6E6E6",shadow:"#D4D4D4"}}}},yC=M7;var wm=Qb(),xC=Jb(),fr=b(b({},wm),{measurements:xC});var L7=i=>i==="light"?yC:Qb,fF=(i,t)=>{let e=L7(i);if(t&&t[i]){let{primary:r,background:o,foreground:s}=t[i],n={primary:r,background:o,foreground:s},a=Object.keys(n).reduce((l,c)=>n[c]?b(b({},l),{[c]:n[c]}):l,{});return hr([e(a),t[i]])}return e()||wm};var z7=["canvas","advancedUIToolbar","advancedUIToolControlBar","basicUIToolbar","mainCanvasActionBar","colorItem","fontSystem"],gF=i=>{let t=Jb();if(i){let e={};return Object.keys(i).forEach(r=>{z7.indexOf(r)!==-1&&(e[r]=i[r])}),hr([t,e])}return t};var U7={config:id,locale:Sl,theme:wm,measurements:xC},gr=class{constructor(){this.checkDefaultToolAvailability=(t,e)=>e.indexOf(t)!==-1;this.state=Y(U7),this.events=new bC,this.licenseChecker=null}saveConfig(t){t.mainCanvasActions&&t.mainCanvasActions.length!==4&&(t.mainCanvasActions.length=4);let r=hr([id,t]);this.licenseChecker=new Kb(r.license),this.licenseChecker.areCustomAssetsAllowed()||(r.sticker.enableCustomUpload=!1);let o=hF(r.language,r.custom.languages),s=fF(r.theme,r.custom.themes),n=gF(r.custom.measurements),{provider:a}=r.library,l=[];r.adjustment.categories=r.adjustment.categories.reduce((m,p)=>(m.push(b(b({},p),{items:p.items.filter(f=>rh[f.identifier]?!0:(l.push(f.identifier),!1))})),m),[]),l.length!==0&&console.error(`The following identifier are incorrect for the adjustment tool: ${l.join(", ")}`),delete r.language,delete r.custom.languages,delete r.custom.themes,delete r.library.provider;let c=r.tools.reduce((m,p)=>typeof p=="object"?[...m,...p]:[...m,p],[]);c.length||(console.error("Empty list input for tools"),c=Xb.reduce((m,p)=>typeof p=="object"?[...m,...p]:[...m,p],[])),c=c.filter(m=>this.licenseChecker.isToolAllowed(m)),this.checkDefaultToolAvailability(r.defaultTool,c)||(this.licenseChecker.isToolAllowed(r.defaultTool)&&console.warn(`Configured default tool ${r.defaultTool} is not a part of configured list of tools: [${c.join(" ")}]`),[r.defaultTool]=c),r.tools=c,this.state.config=r,this.state.locale=o,this.state.theme=s,this.state.measurements=n;let u=this.buildCustomAssetsConfig();return this.assetProvider=new mu(u,this.licenseChecker.areCustomAssetsAllowed()),this.loadThemeFont(),a}get config(){return this.state.config}get locale(){return this.state.locale}get theme(){return this.state.theme}get measurements(){return this.state.measurements}get tools(){return this.config.tools.reduce((t,e)=>typeof e=="string"?[...t,e]:[...t,"",...e],[])}get defaultTool(){return this.config.defaultTool}get isOrderDefault(){return this.config.order==="default"}get isLayoutAdvanced(){return this.config.layout==="advanced"}get displayCloseButton(){return this.config.mainCanvasActions.indexOf(ct.CLOSE)!==-1}loadThemeFont(){let{typography:t}=this.theme;t.skipLoading||this.assetProvider.getFontManager().injectFonts([t])}buildCustomAssetsConfig(){let t=this.tools,e=at(this.state.config),r=this.state.config.assetBaseUrl,{theme:o}=this.state,s=t.indexOf(C.FILTER)!==-1?e[C.FILTER]:void 0,n=t.indexOf(C.FOCUS)!==-1?e[C.FOCUS]:void 0,a=t.indexOf(C.ADJUSTMENT)!==-1?e[C.ADJUSTMENT]:void 0,l=t.indexOf(C.STICKER)!==-1?e[C.STICKER]:void 0,c=t.indexOf(C.FRAME)!==-1?e[C.FRAME]:void 0,d=t.indexOf(C.OVERLAY)!==-1?e[C.OVERLAY]:void 0,u=t.indexOf(C.TRANSFORM)!==-1?e[C.TRANSFORM]:void 0,m=t.indexOf(C.TEXT)!==-1?e[C.TEXT]:void 0,p=t.indexOf(C.TEXT_DESIGN)!==-1?e[C.TEXT_DESIGN]:void 0;return{basePath:r,theme:o,filter:s,focus:n,sticker:l,frame:c,overlay:d,transform:u,text:m,adjustment:a,textdesign:p}}};h([w],gr.prototype,"saveConfig",1),h([S],gr.prototype,"config",1),h([S],gr.prototype,"locale",1),h([S],gr.prototype,"theme",1),h([S],gr.prototype,"measurements",1),h([S],gr.prototype,"tools",1),h([S],gr.prototype,"defaultTool",1),h([S],gr.prototype,"isOrderDefault",1),h([S],gr.prototype,"isLayoutAdvanced",1),h([S],gr.prototype,"displayCloseButton",1);var vC=class{constructor(t){this.editor=t}setBackgroundImage(t){this.container?this.container.setData({image:t,originalImage:t}):this.container=this.engine.addImage({image:t,originalImage:t,blendMode:vt.NORMAL,opacity:1})}getchildren(){return this.container.getChildren()}addImageToContainer(){return new Promise((t,e)=>{let{image:r}=this.editor.activeStore;if(Aw(r))this.setBackgroundImage(r),t();else{let o=this.editor.libraryStore.getRawUrl(r);this.getImageElement(o).then(s=>{this.setBackgroundImage(s),t()}).catch(s=>{e({identifier:"imageLoading",message:s.message})})}})}getImageElement(t){return new Promise((e,r)=>{let o=new Image;o.addEventListener("load",()=>{e(o)}),o.addEventListener("error",s=>{r(s)}),o.crossOrigin=this.editor.configStore.config.engine.crossOrigin,o.src=t})}getImgageContainerId(){return this.container?this.container.getID():""}get engine(){return this.editor.engine}};var CC=class{constructor(t){this.applyNewImageTransform=()=>{let{size:t,width:e,height:r}=this.editor.engineMediator.image.container.getBounds(),o=this.container;o.setTransform(qt.IDENTITY),o.setResolution(t),o.setPivot(.5,.5),o.setPosition({x:e/2,y:r/2})};this.editor=t}get engine(){return this.editor.engine}get container(){return this.engine.getOutputContainer()}};var N7=(i,t)=>new Promise((e,r)=>{let o=new XMLHttpRequest;o.onload=()=>{let s=new FileReader;s.onloadend=()=>{typeof s.result=="string"&&s.result.substr(0,10)==="data:image"?e(s.result):r(new Error(`The image could not be loaded from ${i}`))},s.onerror=n=>{r(n)},s.readAsDataURL(o.response)},o.open("GET",i),o.responseType="blob",o.withCredentials=t==="use-credentials",o.send()}),bF=(i,t)=>new Promise((e,r)=>{let o=new Image;o.onload=()=>{e(o)},o.onerror=()=>{r(new Error(`Failed to load image with src:${i}`))},o.crossOrigin=t,o.src=i}),H7=(i,t)=>new Promise((e,r)=>{N7(i,t).then(o=>{let s=new Image;s.addEventListener("load",()=>{e(s)}),s.src=o}).catch(()=>{bF(i,t).then(o=>e(o)).catch(o=>{r(o)})})}),SC=r=>K(void 0,[r],function*({url:i,image:t,crossOrigin:e="anonymous"}){try{return t&&t.src&&t.src.substr(0,5)==="data:"||t&&t.src&&t.src.includes(".svg")?t:typeof i=="string"&&i.substr(0,5)==="data:"||typeof i=="string"&&i.includes(".svg")?bF(i,e):H7(i||t.src,e)}catch(o){throw new Error(o)}});var W7={tool:null,isWebcam:!1,image:""},ao=class{constructor(t){this.setImage=t=>K(this,null,function*(){let{crossOrigin:e}=this.editor.configStore.config.engine;typeof t=="string"&&(this.state.image=yield SC({url:Dn(t)?t:this.editor.assetProvider.getPath(t),crossOrigin:e})),t instanceof HTMLImageElement&&(this.state.image=yield SC({image:t,crossOrigin:e})),this.isWebcam&&(this.state.isWebcam=!1)});this.newImage=t=>{this.editor.init(t)};this.editor=t,this.state=Y(W7)}selectTool(t){let{licenseChecker:e}=this.editor.configStore;if(this.state.tool!==t&&(e==null?void 0:e.isToolAllowed(t)))switch(this.editor.onToolChange(this.state.tool,t),this.state.tool=t,this.editor.configStore.events.onToolChanged(t),t){case C.TEXT:this.editor.spriteStore.textToolStore.addOrselect();break;case C.TEXT_DESIGN:this.editor.spriteStore.textDesignToolStore.addOrselect();break;case C.BRUSH:{this.editor.brushToolStore.initSize();break}case C.TRANSFORM:this.editor.transformToolStore.applyDefaultCrop();break;default:break}}selectWebcam(t){this.state.isWebcam=t}get webcamLabel(){return this.editor.libraryStore.locale.controls.buttonWebcamClose}get tool(){return this.state.tool}get isWebcam(){return this.state.isWebcam}get image(){return this.state.image}};h([w],ao.prototype,"selectTool",1),h([w],ao.prototype,"selectWebcam",1),h([w],ao.prototype,"setImage",2),h([w],ao.prototype,"newImage",2),h([S],ao.prototype,"webcamLabel",1),h([S],ao.prototype,"tool",1),h([S],ao.prototype,"isWebcam",1),h([S],ao.prototype,"image",1);var wC={height:150,width:150},kC=class{constructor(t){this.canvasClickDisabled=Y.box(!1);this.editor=t,this.state=Y(kC.initialState)}setCanvasElement(t){this.canvas=t,this.editor.engineMediator.preview.createPreview(t),this.updateCanvasDimensions(),this.editor.init(this.editor.configStore.config.image)}updateCanvasDimensions(){let t=fe.devicePixelRatio;this.canvas.width=this.canvasSize.width*t,this.canvas.height=this.canvasSize.height*t,this.canvas.style.width=`${this.canvasSize.width}px`,this.canvas.style.height=`${this.canvasSize.height}px`}saveDimensions({height:t,width:e,render:r}){let o=this.editor.configStore.isLayoutAdvanced?0:this.editor.configStore.measurements.basicCanvasOffset;t-o>wC.height&&e>wC.width&&(this.state.canvasSize.height=t-o,this.state.canvasSize.width=e,r&&this.editor.resize())}disableCanvasClick(){this.canvasClickDisabled.set(!0)}enableCanvasClick(){this.canvasClickDisabled.set(!1)}get isCanvasClickable(){return!this.canvasClickDisabled.get()}get canvasSize(){return this.state.canvasSize}get sizeVector(){return R.fromSize(this.state.canvasSize)}get sizeVectorMagnitude(){return this.sizeVector.magnitude}getContainersAtPreviewPoint(t){let e=this.editor.engine.getContainersAtPreviewPoint(t,this.editor.engineMediator.preview.previewTransformWithoutDpr).map(r=>r.getID()).filter(r=>r!==this.editor.engineMediator.image.getImgageContainerId());this.editor.spriteStore.onCanvasClick(e)}},br=kC;br.initialState={canvasSize:wC},h([w],br.prototype,"setCanvasElement",1),h([w],br.prototype,"updateCanvasDimensions",1),h([w],br.prototype,"saveDimensions",1),h([w],br.prototype,"disableCanvasClick",1),h([w],br.prototype,"enableCanvasClick",1),h([S],br.prototype,"isCanvasClickable",1),h([S],br.prototype,"canvasSize",1),h([S],br.prototype,"sizeVector",1),h([S],br.prototype,"sizeVectorMagnitude",1);var G7={type:null,identifier:null,isVisible:!1,error:""},zr=class{constructor(t){this.showActionModal=({type:t,identifier:e,error:r,handleConfirm:o,handleDismiss:s})=>{this.resetHandlers(),this.state.isVisible=!0,this.state.identifier=e,this.state.type=t,this.state.error=r||"",this.handleConfirm=o,this.handleDismiss=s};this.hideModal=()=>{this.state.isVisible=!1,this.state.type=null,this.state.error="",this.state.identifier=null,this.resetHandlers()};this.resetHandlers=()=>{this.handleConfirm=null,this.handleDismiss=null};this.configStore=t.configStore,this.state=Y(G7)}showInfoModal(t){this.resetHandlers(),this.state.isVisible=!0,this.state.type=Vt.INFO,this.state.identifier=t,this.state.error=""}showTextEditModal(){this.resetHandlers(),this.state.isVisible=!0,this.state.type=Vt.TEXT_EDIT,this.state.identifier="inputText",this.state.error=""}get modalProps(){let{isVisible:t}=this.state,e=this.getModalLocale();if(e){let{bodyLabel:r,headerLabel:o,buttonYes:s,buttonNo:n}=e;return{headerLabel:o,bodyLabel:r,confirmLabel:s,dismissLabel:n,isVisible:t,handleClose:this.hideModal,handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss}}return{isVisible:!1}}get isVisible(){return this.state.isVisible}get type(){return this.state.type}get identifier(){return this.state.identifier}get positionOffset(){let{isLayoutAdvanced:t,measurements:{basicCanvasOffset:e,advancedUIToolControlBar:r,advancedUIToolbar:o},isOrderDefault:s}=this.configStore,n=(r.width+o.width)*(s?1:-1);return t?{x:n/2,y:0}:{x:0,y:-e}}getModalLocale(){let{identifier:t,error:e,type:r}=this.state,{locale:o}=this.configStore;if(!r||!t||r===Vt.TEXT_EDIT)return null;if(r&&t&&o[`${r}Modals`]&&o[`${r}Modals`][t]){let s=o[`${r}Modals`][t],{body:n}=s;n&&typeof e=="object"?Object.keys(e).forEach(l=>{n=n.replace(`\${${l}}`,e[l])}):n&&(n=n.replace("${error}",e));let a=s.heading;if(r===Vt.ERROR||r===Vt.WARNING){let l={error:o.common.error,warning:o.common.warning};a=`${r==="error"?l.error:l.warning}${s.headingDelimiter||""} ${s.header||""}`}return{bodyLabel:n,headerLabel:a,buttonYes:s.buttonYes,buttonNo:s.buttonNo}}return null}};h([w],zr.prototype,"showActionModal",2),h([w],zr.prototype,"showInfoModal",1),h([w],zr.prototype,"showTextEditModal",1),h([w],zr.prototype,"hideModal",2),h([S],zr.prototype,"modalProps",1),h([S],zr.prototype,"isVisible",1),h([S],zr.prototype,"type",1),h([S],zr.prototype,"identifier",1),h([S],zr.prototype,"positionOffset",1);var He=class{constructor(t){this.defaultScale=1;this.SCALE_LEVELS=[8.33,12.5,16.66,25,33.33,50,66.66,100,125,150,200,300,400,500,600].map(t=>t/100);this.state={position:{x:0,y:0},scaleIndex:-1};this.offset={x:0,y:0};this.in=()=>{this.canZoomIn&&(this.state.scaleIndex+=1,this.scaleRender())};this.out=()=>{if(this.canZoomOut){this.state.scaleIndex-=1;let{canDragX:t,canDragY:e,maxOffsetX:r,maxOffsetY:o}=this.checkOffset({x:0,y:0});e||(this.offset.y=o),t||(this.offset.x=r),this.savePosition(),this.scaleRender()}};this.setOffset=t=>{let{canDragX:e,canDragY:r}=this.checkOffset(t);e&&(this.offset.x=t.x),r&&(this.offset.y=t.y),this.scaleRender()};this.editor=t}setInitialTransform(t=0){let{transform:e}=this.editor.engineMediator.preview;Me(()=>{this.setDefaultScale(Math.abs(t||e.scale.x)),this.setPosition(e.position)})}resetScale(){this.state.scaleIndex=-1}resetPosition(){let{width:t,height:e}=this.editor.canvasStore.canvas;this.setPosition({x:t/2,y:e/2})}resetOffset(){this.offset={x:0,y:0}}setPosition(t){this.state.position.x=t.x,this.state.position.y=t.y}savePosition(){this.setPosition(this.getPositionWithOffset()),this.offset={x:0,y:0}}setDefaultScale(t){if(this.defaultScale!==1){let r=this.SCALE_LEVELS.findIndex(o=>o===this.defaultScale);r!==-1&&(this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,r),...this.SCALE_LEVELS.slice(r+1)])}let e=this.SCALE_LEVELS.findIndex((r,o)=>o===0?t<r:o===this.SCALE_LEVELS.length-1?r<t:this.SCALE_LEVELS[o-1]<t&&t<r);if(e!==-1)this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,e),t,...this.SCALE_LEVELS.slice(e)],e===this.state.scaleIndex&&this.resetScale(),this.state.scaleIndex=e,this.defaultScale=t;else{let r=this.SCALE_LEVELS.findIndex(o=>o===t);r===this.state.scaleIndex&&this.resetScale(),r!==-1&&(this.state.scaleIndex=r,this.defaultScale=t)}}setScaleToDefault(){this.state.scaleIndex=this.defaultIndex}checkOffset(t){let e=window.devicePixelRatio||1,{scaledSize:r}=this,{previewSize:o}=this,s=this.editor.engineMediator.preview.initialTransform.position,n=this.getPositionWithOffset(t),a=(r.width-o.width)*e/2,l=(r.height-o.height)*e/2,c=s.x-n.x,d=s.y-n.y,u=Math.abs(c),m=Math.abs(d),p=c>0,f=d>0,v=u-a,x=m-l;return{canDragX:v<0,canDragY:x<0,maxOffsetX:p?-v:v,maxOffsetY:f?-x:x}}calculateScale(t=0,e=this.previewSize,r=this.defaultScale){let{width:o,height:s}=e,n=new R({x:o,y:s}),a=new R(Math.abs(n.x*Math.cos(t))+Math.abs(n.y*Math.sin(t)),Math.abs(n.x*Math.sin(t))+Math.abs(n.y*Math.cos(t))),l=n.subtract(a).divide(2).multiply(r).abs;return l.y>l.x?l.y*2/n.y+r:l.x*2/n.x+r}get defaultIndex(){return this.SCALE_LEVELS.findIndex(t=>t===this.defaultScale)}getPositionWithOffset(t=this.offset){let{position:e}=this;return{x:e.x-t.x,y:e.y-t.y}}scaleRender(t=!1){let e=this.editor.scale.getPositionWithOffset(),r=t?this.defaultScale:this.scale,o={x:r,y:r};this.editor.engineMediator.preview.container.setScale(o),this.editor.engineMediator.preview.container.setPosition(e),this.editor.engineMediator.preview.savePreviewTransform({scale:o,position:e,rotation:0}),t||this.editor.render()}get scale(){let t=this.state.scaleIndex;return t!==-1?this.SCALE_LEVELS[t]:this.defaultScale}get zoomLevel(){let t=window.devicePixelRatio||1;return(this.scale/t*100).toFixed(1)}get canDrag(){return this.defaultScale<this.scale}get canZoomOut(){return this.state.scaleIndex>this.defaultIndex}get canZoomIn(){return this.SCALE_LEVELS.length-1>this.state.scaleIndex}get position(){return this.state.position}get scaledSize(){let t=this.state.scaleIndex,e=t!==-1?this.SCALE_LEVELS[t]:this.defaultScale,{previewSize:r}=this;return{width:r.width*e/this.defaultScale,height:r.height*e/this.defaultScale}}get previewSize(){return this.editor.getPreviewSize()}};h([Y],He.prototype,"state",2),h([w],He.prototype,"in",2),h([w],He.prototype,"out",2),h([w],He.prototype,"setInitialTransform",1),h([w],He.prototype,"resetScale",1),h([w],He.prototype,"resetPosition",1),h([w],He.prototype,"setPosition",1),h([w],He.prototype,"savePosition",1),h([w],He.prototype,"setDefaultScale",1),h([w],He.prototype,"setScaleToDefault",1),h([S],He.prototype,"scale",1),h([S],He.prototype,"zoomLevel",1),h([S],He.prototype,"canDrag",1),h([S],He.prototype,"canZoomOut",1),h([S],He.prototype,"canZoomIn",1),h([S],He.prototype,"position",1),h([S],He.prototype,"scaledSize",1);var xF=/^data:image\/(.+?);base64,/,nU=i=>xF.test(i),aU=i=>i.match(/^data:([^;]+)/)[1],lU=i=>i.replace(xF,"");var V7="@photoeditorsdk/root",j7="5.9.0",$7="The most comprehensive photo editor SDK for HTML5",Y7="http://github.com/imgly/pesdk-html5",K7="PhotoEditorSDK (img.ly GmbH) <contact@img.ly>",X7="SEE LICENSE IN LICENSE.md",q7=!0,Z7={},J7={start:"yarn workspace @example/react start",build:"yarn sdk-script build","build:rollup":"yarn sdk-script build rollup","package:release":"cd dist/photoeditorsdk && npm publish","package:pre-release":"cd dist/photoeditorsdk && npm publish --tag next","lint:css":"stylelint './packages/**/*.tsx'","lint:ts":"eslint ./packages","lint:ts-engine":"eslint ./engine","lint:types":"tsc --noEmit -p tsconfig.json --skipLibCheck","lint:types-engine":"tsc --noEmit -p engine/tsconfig.json --skipLibCheck",lint:"run-p lint:*",test:"$(npm bin)/jest",e2e:"cypress open","e2e:server":"sdk-script ui -P 3000 -D build","e2e:ci":"CYPRESS_RETRIES=2 cypress run --browser chrome --headless",deploy:"yarn workspace examp run deploy:pages",docs:"rm -rf ./docs && typedoc",postinstall:"yarn sdk-script server:build"},Q7={"@elv1n/cypress-plugin-snapshots":"1.4.4","@types/jest":"^24.0.11","@types/pixelmatch":"^5.2.2","@types/pngjs":"^3.4.2","@types/react":"^16.8.13","@types/react-dom":"^16.8.4","@types/styled-components":"4.4.0","@typescript-eslint/eslint-plugin":"4.6.0","@typescript-eslint/parser":"4.6.0",autoprefixer:"^9.7.4","cross-env":"^7.0.2",cypress:"5.6.0",eslint:"7.10.0","eslint-config-airbnb":"18.2.0","eslint-config-prettier":"6.12.0","eslint-import-resolver-typescript":"^2.3.0","eslint-plugin-cypress":"^2.11.2","eslint-plugin-import":"2.22.1","eslint-plugin-jsx-a11y":"6.3.1","eslint-plugin-no-only-tests":"^2.4.0","eslint-plugin-prettier":"3.1.4","eslint-plugin-react":"7.21.3",husky:"4.3.0",jest:"24.9.0",jsdoc:"^3.6.3","lint-staged":"10.4.0","lodash.defaults":"^4.2.0","mobx-react-devtools":"^6.1.1","npm-run-all":"^4.1.5","native-url":"0.3.4",prettier:"^2.0.5",react:"16.8.6","react-dom":"16.8.6","start-server-and-test":"1.11.5","styled-components":"4.4.1",stylelint:"^13.7.2","stylelint-config-recommended":"^3.0.0","stylelint-config-standard":"^20.0.0","stylelint-config-styled-components":"^0.1.1","stylelint-processor-styled-components":"^1.10.0","ts-jest":"24.3.0",typedoc:"^0.17.8",typescript:"3.8.3","utility-types":"^3.10.0"},tU={"@juggle/resize-observer":"3.2.0","can-use-dom":"0.1.0","lodash.debounce":"4.0.8","lodash.memoize":"4.1.2","lodash.throttle":"4.1.1",mobx:"4.15.7","mobx-react":"6.3.1",photoeditorsdk:"1.0.0","react-app-polyfill":"1.0.6"},eU={node:"10.x || 11.x || 12.x || 13.x || 14.x || 15.x"},iU={eslint:"7.10.0"},rU=["examples/server","examples/material-ui","examples/react","packages/*","!packages/ui","packages/ui/*","!packages/ui/components","packages/ui/components/*","engine/*","test/*","scripts"],oU={hooks:{"pre-commit":"lint-staged","pre-push":"true"}},_F={name:V7,version:j7,description:$7,repository:Y7,author:K7,license:X7,private:q7,bin:Z7,scripts:J7,devDependencies:Q7,dependencies:tU,devEngines:eU,resolutions:iU,workspaces:rU,husky:oU};var wl=class{constructor(t,e,r,o,s,n){this.mapImagePointToRelativeCropPoint=t=>{let e=st.pointFromSpaceToSpace(t,this.imageSpace,this.cropSpace,!1);return st.absoluteToRelativePoint(e,this.cropSpace,!1)};this.mapSizeToRelativeUnscaledCropSize=t=>t/Math.min(this.outputSize.height,this.outputSize.width);this.mapSizeToRelativeScaledCropSize=t=>t/Math.min(this.outputSize.height*this.outputScale.x,this.outputSize.width*this.outputScale.y);this.getPointInDirection=(t,e=0,r=3)=>{let o=Math.tan(e),s=Math.sqrt(o**2+1);return{x:t.x+r/s,y:t.y+r*o/s}};this.previewPosition=t,this.previewSize=e,this.outputSize=r,this.imageSize=o,this.imageSpace=s,this.cropSpace=n,this.outputScale=n.getScale()}static serializeFilters(t){return{type:"filter",options:{intensity:t.intensity,identifier:t.identifier}}}static serializeAdjustments(t){return{type:"adjustments",options:t}}static serializeOverlay(t){return{type:"overlay",options:{identifier:t.identifier,intensity:t.opacity,blendMode:t.blendMode.replace(/[A-Z]/g,e=>` ${e.toLowerCase()}`)}}}static serializeMetaData(){return{platform:"html5",version:_F.version,createdAt:new Date().toISOString()}}serialise(t,e,r){let o=wl.serializeMetaData(),s={width:this.imageSize.width,height:this.imageSize.height};e&&(s.type=r,s.data=e);let n=[],a=[],{adjustment:l}=t;Object.keys(l).map(v=>l[v]).filter(Boolean).length&&n.push(wl.serializeAdjustments(l));let{filter:c}=t;c.identifier!=="identity"&&n.push(wl.serializeFilters(c));let{overlay:d}=t;if(d.identifier!=="identity"&&a.push(wl.serializeOverlay(d)),t.transform){let{transform:v,orientation:x}=this.serializeTransform(t.transform),_=[v.options.start.x!==0,v.options.start.y!==0,v.options.end.x!==1,v.options.end.y!==1,v.options.rotation!==0],D=[x.options.rotation!==0,x.options.flipVertically!==!1,x.options.flipHorizontally!==!1];_.some(k=>k)&&n.push(v),D.some(k=>k)&&n.push(x)}let{frame:u}=t;u.identifier!=="identity"&&a.push(this.serialzeFrame(u));let{focus:m}=t;if(m.identifier!=="identity"&&n.push(this.serializeFocus(m)),t.sprite&&t.sprite.spriteIdList.forEach(v=>{let x=t.sprite.common[v];switch(x.tool){case"sticker":let _=t.sprite.sticker[v];a.push(this.serializeSticker(_,x,t.transform));break;case"text":let D=t.sprite.text[v];a.push(this.serializeText(D,x));break;case"textdesign":let k=t.sprite.textdesign[v];a.push(this.serializeTextDesign(k,x));break}}),t.brush.strokes.length&&a.push({type:"brush",options:{paths:t.brush.strokes.map(v=>({points:v.path.controlPoints.map(this.mapImagePointToRelativeCropPoint),brush:{color:{rgba:v.brush.color},size:v.brush.size,hardness:v.brush.hardness}}))}}),a.length){let v={type:"sprite",options:{sprites:a}};n.push(v)}let f={assets:{stickers:t.customStickers}};return{version:wl.version,meta:o,image:s,operations:n,assetLibrary:f}}serialzeFrame(t){return{type:"frame",options:{identifier:t.identifier,alpha:t.opacity,tintColor:{rgba:t.color},size:this.mapSizeToRelativeUnscaledCropSize(t.width)}}}serializeFocus(t){let e=Math.sqrt(this.previewSize.width**2+this.previewSize.height**2);switch(t.identifier){case Tt.LINEAR:return{type:"focus",options:{type:"linear",options:{start:this.mapImagePointToRelativeCropPoint(t.linear.start),end:this.mapImagePointToRelativeCropPoint(t.linear.end),blurRadius:this.mapSizeToRelativeScaledCropSize(t.linear.blurRadius)}}};case Tt.RADIAL:return{type:"focus",options:{type:"radial",options:{start:this.mapImagePointToRelativeCropPoint(t.radial.center),end:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(t.radial.center,0,t.radial.radius)),blurRadius:this.mapSizeToRelativeScaledCropSize(t.radial.blurRadius),gradientRadius:.1}}};case Tt.MIRRORED:let{mirrored:r}=t;return{type:"focus",options:{type:"mirrored",options:{start:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(r.origin,r.rotation,e/2)),end:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(r.origin,r.rotation,-e/2)),size:this.mapSizeToRelativeScaledCropSize(t.mirrored.size),blurRadius:this.mapSizeToRelativeScaledCropSize(t.mirrored.blurRadius),gradientSize:.1}}};default:return{type:"focus",options:{type:"gaussian",options:{blurRadius:this.mapSizeToRelativeScaledCropSize(t.gaussian.blurRadius)}}}}}serializeSticker(t,e,r){return{type:"sticker",options:{position:this.mapImagePointToRelativeCropPoint(e.position),dimensions:{x:this.mapSizeToRelativeScaledCropSize(e.size.width),y:this.mapSizeToRelativeScaledCropSize(e.size.height)},rotation:e.rotation,flipVertically:(e.flipVertically||!1)!==(r.flipVertically||!1),flipHorizontally:(e.flipHorizontally||!1)!==(r.flipHorizontally||!1),identifier:t.identifier,alpha:t.opacity,tintColor:{rgba:t.tintColor},tintMode:t.tintMode}}}serializeText(t,e){return{type:"text",options:{position:this.mapImagePointToRelativeCropPoint(e.position),rotation:e.rotation,flipVertically:!1,flipHorizontally:!1,fontIdentifier:t.identifier,fontSize:this.mapSizeToRelativeScaledCropSize(t.fontSize),maxWidth:this.mapSizeToRelativeScaledCropSize(t.width),text:t.text,lineHeight:t.lineHeight,color:{rgba:t.textColor},backgroundColor:{rgba:t.backgroundColor},alignment:t.alignment}}}serializeTextDesign(t,e){return{type:"textdesign",options:{position:this.mapImagePointToRelativeCropPoint(e.position),rotation:e.rotation,flipVertically:!1,flipHorizontally:!1,identifier:t.identifier,inverted:t.isInverted,text:t.text,seed:t.seed,width:this.mapSizeToRelativeScaledCropSize(t.width),padding:this.mapSizeToRelativeScaledCropSize(t.padding),color:{rgba:t.color}}}}serializeTransform(t){let{start:e,end:r}=t,o={type:"transform",options:{start:e,end:r,rotation:t.rotation,meta:{identifier:t.identifier}}},s={type:"orientation",options:{rotation:t.outputRotation,flipHorizontally:t.flipHorizontally,flipVertically:t.flipVertically}};return{transform:o,orientation:s}}},TC=wl;TC.version="3.9.0";var yF=(i=Le.PNG)=>`data:${i};base64,`,pi=class{constructor(t){this.spriteOrder=0;this.mapRelativeCropPointToImageSpace=t=>{let e=st.relativeToAbsolutePoint(t,this.cropSpace,!1);return st.pointFromSpaceToSpace(e,this.cropSpace,this.imageSpace,!1)};this.mapRelativeCropSizeToScaledImageSize=t=>t*Math.min(this.outputSize.height*this.outputScale.x,this.outputSize.width*this.outputScale.y);this.mapRelativeCropSizeToUnscaledImageSize=t=>t*Math.min(this.outputSize.height,this.outputSize.width);this.editor=t}static deserializeFilter(t){return{intensity:t.intensity,identifier:t.identifier}}static deserializeAdjustments(t){return b({},t)}static deserializeOverlay(t){return{identifier:t.identifier,opacity:t.intensity,blendMode:t.blendMode.replace(/([ _][a-z])/g,e=>e.toUpperCase().replace(" ","").replace("_",""))}}static initializeEmptyTransform(){return{outputRotation:0,flipHorizontally:!1,flipVertically:!1,start:{x:0,y:0},end:{x:1,y:1},rotation:0}}static deserialzeColor(t){return t&&t.rgba?t.rgba:[0,0,0,0]}static validateVersion(t){return pi.version===t}static checkIfPlatformHTML(t){return t==="html5"}static deserializeStickers(t){return{identifier:t.identifier,opacity:t.alpha||0,tintMode:t.tintMode||"none",tintColor:pi.deserialzeColor(t.tintColor)}}static checkIsSerialisationValid(t){if(typeof t!="string"&&pi.validateVersion(t.version))return!0;if(typeof t=="string")throw new Error("Invalid input of type string, please provide an object");return!1}static deserializeImage(t){let e={};return t.image&&(e.image={width:t.image.width,height:t.image.height,data:t.image.data?t.image.data.replace(yF(),""):""},e.image.data=e.image.data?yF()+e.image.data:""),e}deserializeTransformation(t){let e={},r=t.operations.find(n=>n.type==="orientation"),o=t.operations.find(n=>n.type==="transform"),[s]=this.editor.engine.getRootContainers();return this.previewPosition=this.editor.transformToolStore.defaultCropMaskPosition,this.previewSize=this.editor.transformToolStore.maxCropMaskSize,this.imageSpace=s,e.transform=pi.initializeEmptyTransform(),r!=null&&(e.transform.outputRotation=r.options.rotation,e.transform.flipHorizontally=r.options.flipHorizontally||!1,e.transform.flipVertically=r.options.flipVertically||!1),o&&(e.transform.start=o.options.start,e.transform.end=o.options.end,e.transform.rotation=o.options.rotation||0,e.transform.identifier=o.options.meta?o.options.meta.identifier:""),e}deserialize(t){var s,n;let e={};(t.meta?!pi.checkIfPlatformHTML(t.meta.platform):!1)&&console.warn("Read serialisation from another Platform");let r=this.editor.engineMediator.output.container.getResolution(),{size:o}=this.editor.engineMediator.image.container.getBounds();return this.outputSize=r,this.imageSize=o,this.cropSpace=this.editor.engine.getOutputContainer(),this.outputScale=this.cropSpace.getScale(),t.operations.forEach(a=>{switch(a.type){case"filter":e.filter=pi.deserializeFilter(a.options);break;case"adjustments":e.adjustment=pi.deserializeAdjustments(a.options);break;case"focus":e.focus=this.deserializeFocus(a.options);break;case"sprite":let{sprites:l}=a.options;l.forEach(c=>{switch(c.type){case"frame":e.frame=this.deserializeFrame(c.options);break;case"overlay":e.overlay=pi.deserializeOverlay(c.options);break;case"brush":e.brush?e.brush.strokes.push(...this.deserializeBrush(c.options).strokes):e.brush=this.deserializeBrush(c.options);break;case"sticker":case"text":case"textdesign":e.sprite||(e.sprite={spriteIdList:[],sticker:{},text:{},textdesign:{},common:{}});let d=Vr();e.sprite.spriteIdList.push(d),e.sprite.common[d]={order:this.spriteOrder,position:this.mapRelativeCropPointToImageSpace(c.options.position),tool:C.STICKER,rotation:c.options.rotation||0,flipHorizontally:c.options.flipHorizontally,flipVertically:c.options.flipVertically},this.spriteOrder+=1,c.type===C.STICKER?(e.sprite.common[d].tool=C.STICKER,e.sprite.common[d].size={width:this.mapRelativeCropSizeToScaledImageSize(c.options.dimensions.x),height:this.mapRelativeCropSizeToScaledImageSize(c.options.dimensions.y)},e.sprite.sticker[d]=pi.deserializeStickers(c.options)):c.type===C.TEXT?(e.sprite.common[d].tool=C.TEXT,e.sprite.text[d]=this.deserializeTexts(c.options)):c.type===C.TEXT_DESIGN&&(e.sprite.common[d].tool=C.TEXT_DESIGN,e.sprite.textdesign[d]=this.deserializeTextDesign(c.options));break;default:break}});break;default:break}}),t.assetLibrary&&(e.customStickers=((n=(s=t.assetLibrary)==null?void 0:s.assets)==null?void 0:n.stickers)||[]),e}deserializeFrame(t){return{identifier:t.identifier,opacity:t.alpha,width:this.mapRelativeCropSizeToUnscaledImageSize(t.size),color:pi.deserialzeColor(t.tintColor)}}deserializeFocus(t){switch(t.type){case"linear":return{identifier:"linear",linear:this.deserializeLinearFocus(t.options)};case"gaussian":return{identifier:"gaussian",gaussian:this.deserializeGaussianFocus(t.options)};case"radial":return{identifier:"radial",radial:this.deserializeRadialFocus(t.options)};case"mirrored":return{identifier:"mirrored",mirrored:this.deserializeMirroredFocus(t.options)}}}deserializeRadialFocus(t){return{center:this.mapRelativeCropPointToImageSpace(t.start),radius:new R(this.mapRelativeCropPointToImageSpace(t.start)).subtract(new R(this.mapRelativeCropPointToImageSpace(t.end))).magnitude,blurRadius:this.mapRelativeCropSizeToScaledImageSize(t.blurRadius)}}deserializeLinearFocus(t){return{start:this.mapRelativeCropPointToImageSpace(t.start),end:this.mapRelativeCropPointToImageSpace(t.end),blurRadius:this.mapRelativeCropSizeToScaledImageSize(t.blurRadius)}}deserializeGaussianFocus(t){return{blurRadius:this.mapRelativeCropSizeToScaledImageSize(t.blurRadius)}}deserializeMirroredFocus(t){let e=new R(this.mapRelativeCropPointToImageSpace(t.start)).subtract(new R(this.mapRelativeCropPointToImageSpace(t.end)));return{origin:new R(this.mapRelativeCropPointToImageSpace(t.start)).add(new R(this.mapRelativeCropPointToImageSpace(t.end))).divide(2),rotation:Math.atan2(e.y,e.x),size:this.mapRelativeCropSizeToScaledImageSize(t.size),blurRadius:this.mapRelativeCropSizeToScaledImageSize(t.blurRadius)}}deserializeTexts(t){return{identifier:In(t.fontIdentifier),fontSize:this.mapRelativeCropSizeToScaledImageSize(t.fontSize),width:this.mapRelativeCropSizeToScaledImageSize(t.maxWidth),alignment:t.alignment,textColor:pi.deserialzeColor(t.color),backgroundColor:pi.deserialzeColor(t.backgroundColor),lineHeight:t.lineHeight,text:t.text}}deserializeTextDesign(t){return{identifier:t.identifier,width:this.mapRelativeCropSizeToScaledImageSize(t.width),padding:this.mapRelativeCropSizeToScaledImageSize(t.padding),color:pi.deserialzeColor(t.color),seed:t.seed,text:t.text,isInverted:t.inverted}}deserializeBrush(t){return{strokes:t.paths.map(e=>({path:{controlPoints:e.points.map(this.mapRelativeCropPointToImageSpace)},brush:{id:"imgly_brush_radial",color:pi.deserialzeColor(e.brush.color),size:e.brush.size,hardness:e.brush.hardness}}))}}},DC=pi;DC.version="3.9.0";var km=class{constructor(t){this.applySerialization=(t,e,r,o)=>K(this,null,function*(){this.editor.resetToolStates();let s=this.editor.activeStore.tool===C.TRANSFORM;s||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.reset(),s||this.editor.transformToolStore.onLeave();let n=new e(this.editor),a="Unexpected error occured",l=e.deserializeImage(t);if(l.image&&l.image.data){let d=l.image.data;yield this.editor.setImage(d),this.editor.scale.defaultScale=1,this.editor.scale.resetOffset(),this.editor.transformToolStore.reset(),this.editor.activeStore.setImage(d),yield this.editor.engineMediator.image.addImageToContainer(),this.editor.engineMediator.output.applyNewImageTransform(),this.editor.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.editor.transformToolStore.setCropDefaults(),this.editor.historyStore.addInitialSnapshot(),this.editor.transformToolStore.saveTransforms()}let c=n.deserializeTransformation(t);if(c){yield this.applyStateOnUI(c);let d=n.deserialize(t);d?(yield this.applyStateOnUI(d),yield this.editor.render(),this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),r()):o(a)}else o(a)});this.editor=t}serialize({image:t}={image:!1}){let e=this.editor.activeStore.tool===C.TRANSFORM;return this.editor.modalStore.showInfoModal("saving"),new Promise((r,o)=>{Promise.resolve().then(()=>y(IC())).then(n=>K(this,[n],function*({Serializer:s}){try{e&&this.editor.transformToolStore.onLeave(),yield this.editor.wait(),this.editor.transformToolStore.applyDefaultCrop(!1);let{originalImage:a}=this.editor.imageContainer.getData(),l=this.editor.engineMediator.output.container.getResolution(),c={width:a.width,height:a.height},d=new s(this.editor.transformToolStore.defaultCropMaskPosition,this.editor.transformToolStore.maxCropMaskSize,l,c,this.editor.engine.getRootContainers()[0],this.editor.engine.getOutputContainer()),u={[C.ADJUSTMENT]:at(this.editor.adjustmentsToolStore.state),[C.FILTER]:at(this.editor.filterToolStore.state),[C.FOCUS]:at(this.editor.focusToolStore.serializableState),[C.OVERLAY]:at(this.editor.overlayToolStore.state),[C.FRAME]:at(this.editor.frameToolStore.state),[C.BRUSH]:this.editor.brushToolStore.strokes||{strokes:[]}},{sprite:m,customStickers:p}=yield this.editor.spriteStore.serializableState();m.spriteIdList=m.spriteIdList.sort((x,_)=>{let D=m.common[x].order,k=m.common[_].order;return D-k}),u.sprite=m,u.customStickers=p,u.transform=this.editor.transformToolStore.serializableState;let f,v;if(t){let x=km.getDataURL(a);v=aU(x),f=lU(x)}this.editor.modalStore.hideModal(),r(d.serialise(u,f,v)),e&&this.editor.transformToolStore.onEnter()}catch(a){this.editor.modalStore.hideModal(),o(a)}}))})}deserialize(t){return this.editor.modalStore.showInfoModal("loading"),new Promise((e,r)=>{try{Promise.resolve().then(()=>y(IC())).then(({Deserializer:o})=>{o.checkIsSerialisationValid(t)?this.applySerialization(t,o,e,r):(this.editor.modalStore.hideModal(),this.editor.modalStore.showActionModal({type:Vt.WARNING,identifier:"unsupportedSerializationVersion",handleConfirm:()=>this.applySerialization(t,o,e,r)}))})}catch(o){this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),r(o)}})}static getDataURL(t){if(t instanceof HTMLImageElement){let{src:o}=t;if(nU(o))return o}if(t instanceof HTMLCanvasElement)return t.toDataURL(Le.PNG);let e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e.toDataURL(Le.PNG)}applyStateOnUI(t){return K(this,null,function*(){let e=this.editor.activeStore.tool===C.TRANSFORM;try{t.transform&&(e||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(t.transform,!0),yield this.editor.wait(),e||(this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),yield this.editor.wait(),this.editor.transformToolStore.onLeave())),t.filter&&(yield this.editor.filterToolStore.updateStateFromSerialization(t.filter)),t.adjustment&&this.editor.adjustmentsToolStore.updateStateFromSerialization(t.adjustment),t.focus&&(yield this.editor.focusToolStore.updateStateFromSerialization(t.focus)),t.overlay&&(yield this.editor.overlayToolStore.updateStateFromSerialization(t.overlay)),t.sprite&&(t.sprite.spriteIdList=t.sprite.spriteIdList.sort((r,o)=>{let s=t.sprite.common[r].order,n=t.sprite.common[o].order;return s-n}),yield this.editor.spriteStore.updateStateFromSerialization(t.sprite,t.customStickers)),t.brush&&this.editor.brushToolStore.updateStateFromHistory(t.brush),t.frame&&(yield this.editor.frameToolStore.updateStateFromSerialization(t.frame)),this.editor.outputContainer.updateChildrenContainers()}catch(r){console.error(r),this.editor.modalStore.showActionModal({type:Vt.ERROR,identifier:"unexpectedError",error:r,handleConfirm:()=>{window.location.reload()}})}})}};var Yo={identifier:"identity",opacity:1,width:0,color:ji.white};var cU=new sn(0,1),nn=class{constructor(t){this.changeIdentifier=t=>{this.state.identifier=t};this.changeOpacity=t=>{let e=cU.clamp(t);this.state.opacity=e};this.changeWidth=t=>{this.state.width=t};this.changeColor=t=>{this.state.color=t};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=Yo.identifier,this.state.opacity=Yo.opacity,this.state.width=Yo.width,this.state.color=Yo.color,this.removeIndex())};this.removeFrameEffect=()=>{this.effect&&(this.engine.removeEffect(this.effect),this.effect=void 0)};this.setEffectProperties=t=>this.effect?(this.removeIndex(),this.effect.setProperties(t),this.effect.getProperties()):null;this.setFrameEffect=({identifier:t,width:e,opacity:r,color:o})=>{let s=b({},this.state);this.changeIdentifier(t),this.changeWidth(e),this.changeOpacity(r),this.changeColor(o),this.removeFrameEffect();let n=this.engineMediator.orderHelper.addSprite(t);return new Promise((a,l)=>{this.engine.addFrameFromAssets(t,this.engineMediator.image.container,n).then(c=>{this.effect=c,this.effect.setProperties({tintColor:o,opacity:r,width:e}),a()}).catch(c=>{this.changeIdentifier(s.identifier),this.changeOpacity(s.opacity),this.changeWidth(s.width),this.changeColor(s.color),s.identifier==="identity"&&this.removeIndex(),l(c)})})};this.removeIndex=()=>{this.engineMediator.orderHelper.removeSprite(this.state.identifier)};this.engineMediator=t,this.state=Yo}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}};h([Y],nn.prototype,"state",2),h([w],nn.prototype,"changeIdentifier",2),h([w],nn.prototype,"changeOpacity",2),h([w],nn.prototype,"changeWidth",2),h([w],nn.prototype,"changeColor",2),h([w],nn.prototype,"reset",2);var Ie=class{constructor(t){this.colorList=fe.defaultColors;this.selectFrame=t=>K(this,null,function*(){if(t!==this.identifier){let e=.1*this.editor.shortestOutputSide;yield this.frameStore.setFrameEffect({identifier:t,width:e,opacity:1,color:Yo.color}),this.editor.render(),this.addSnapshot(_t.ADD,C.FRAME)}});this.changeOpacity=t=>{let e=this.frameStore.setEffectProperties({opacity:t});e&&(this.frameStore.changeOpacity(e.opacity),this.editor.render())};this.changeWidth=t=>{let e=this.frameStore.setEffectProperties({width:t});e&&(this.frameStore.changeWidth(e.width),this.editor.render())};this.changeColor=t=>{let e=this.frameStore.setEffectProperties({tintColor:t});e&&(this.frameStore.changeColor(e.tintColor),this.editor.render())};this.colorSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.controls.selectColor)};this.toolSnapshot=t=>{this.addSnapshot(_t.EDIT,t)};this.addSnapshot=(t,e)=>{this.editor.addSnapshot(void 0,t,e)};this.pureReset=()=>{this.frameStore.removeFrameEffect(),this.frameStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(_t.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromHistory=t=>t.identifier==="identity"?(this.pureReset(),new Promise(e=>{e()})):this.frameStore.setFrameEffect(t);this.updateStateFromSerialization=t=>K(this,null,function*(){return this.entityManager.items.find(r=>r.identifier===t.identifier)?this.frameStore.setFrameEffect(t):new Promise((r,o)=>{o(new Error("Frame Asset doesn't exist"))})});this.editor=t,this.frameStore=new nn(this.editor.engineMediator);let e=this.editor.assetProvider.getAssets("frame"),{config:r}=this;this.entityManager=new Pe(e,b(b({},r),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("frame")})),Yo.color=at(jr(this.config,"defaultColor",Yo.color)),this.config.colors&&this.config.colors.length>0&&(this.colorList=no(at(this.config.colors)))}get state(){return this.frameStore.state}get identifier(){return this.state.identifier}get color(){return this.state.color}get size(){return this.state.width}get tintable(){let t=this.entityManager.items.find(e=>e.identifier===this.identifier);return t&&t.tintable||!1}get opacity(){return this.state.opacity}get minSize(){return this.editor.shortestOutputSide*.05}get maxSize(){return this.editor.shortestOutputSide*.3}get config(){return this.editor.configStore.config[C.FRAME]}get locale(){return this.editor.configStore.locale[C.FRAME]}get localeColor(){return this.editor.configStore.locale.common.color}get items(){return this.entityManager.items}get isOptionSelected(){return this.identifier!=="identity"}};h([w],Ie.prototype,"selectFrame",2),h([w],Ie.prototype,"changeOpacity",2),h([w],Ie.prototype,"changeWidth",2),h([w],Ie.prototype,"changeColor",2),h([w],Ie.prototype,"pureReset",2),h([w],Ie.prototype,"reset",2),h([w],Ie.prototype,"updateStateFromHistory",2),h([w],Ie.prototype,"updateStateFromSerialization",2),h([S],Ie.prototype,"state",1),h([S],Ie.prototype,"identifier",1),h([S],Ie.prototype,"color",1),h([S],Ie.prototype,"size",1),h([S],Ie.prototype,"tintable",1),h([S],Ie.prototype,"opacity",1),h([S],Ie.prototype,"minSize",1),h([S],Ie.prototype,"maxSize",1),h([S],Ie.prototype,"config",1),h([S],Ie.prototype,"locale",1),h([S],Ie.prototype,"localeColor",1),h([S],Ie.prototype,"items",1),h([S],Ie.prototype,"isOptionSelected",1);var dU={categories:[],query:""},_r=class{constructor(t){this.initProvider=t=>{t&&(this.libraryProvider=new t)};this.fetchImages=(t="")=>K(this,null,function*(){if(this.libraryProvider){let e=null;try{let r=yield this.libraryProvider.getCategories(),o=yield this.libraryProvider.searchImages(t);e=r.map((s,n)=>{let a=o.filter(l=>l.category===s.name);return{identifier:s.name,name:s.name,thumbnailURI:s.coverImageUrl,items:a.map(l=>({name:l.title||`image${n}`,identifier:`${s.name}-${l.title}-${n}`,thumbnailURI:l.thumbUrl,rawUrl:l.rawUrl,authorName:l.authorName,authorAvatar:l.authorAvatar}))}}).filter(s=>s.items.length)}catch(r){console.log(r)}Me(()=>{this.state.query=t,this.state.categories=e})}});this.toggleCategorySelection=t=>{this.selectedCategory=this.selectedCategory!==t?t:""};this.getRawUrl=t=>{let e=this.items.findIndex(r=>r.identifier===t);return e!==-1?this.items[e].rawUrl:t};this.configStore=t.configStore,this.state=Y(dU),this.selectedCategory=""}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.state.categories}get items(){return this.state.categories.map(t=>t.items).reduce((t,e)=>[...t,...e],[])}get query(){return this.state.query}get config(){return this.configStore.config[C.LIBRARY]}get locale(){return this.configStore.locale[C.LIBRARY]}};h([Y],_r.prototype,"selectedCategory",2),h([w],_r.prototype,"initProvider",2),h([w],_r.prototype,"fetchImages",2),h([w],_r.prototype,"toggleCategorySelection",2),h([S],_r.prototype,"selectedCategoryIdentifier",1),h([S],_r.prototype,"categories",1),h([S],_r.prototype,"items",1),h([S],_r.prototype,"query",1),h([S],_r.prototype,"config",1),h([S],_r.prototype,"locale",1);var Tm={identifier:"identity",opacity:1,blendMode:vt.LIGHTEN};var uU=new sn(0,1),an=class{constructor(t,e){this.changeIdentifier=t=>{this.state.identifier=t};this.changeOpacity=t=>{let e=uU.clamp(t);this.state.opacity=e};this.changeBlendMode=t=>{this.state.blendMode=t};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=Tm.identifier,this.state.opacity=Tm.opacity,this.state.blendMode=Tm.blendMode,this.removeIndex())};this.correctOverlayFlip=()=>{let{flipHorizontally:t,flipVertically:e}=this.editor.outputContainer.getData();this.effect&&(this.effect.setFlipHorizontally(t),this.effect.setFlipVertically(e))};this.removeOverlayEffect=()=>{this.effect&&(this.removeIndex(),this.engineMediator.engine.removeEffect(this.effect),this.effect=void 0)};this.setEffectProperties=t=>this.effect?(this.effect.setProperties(t),this.effect.getProperties()):null;this.setOverlayEffect=({identifier:t,blendMode:e,opacity:r})=>{let o=b({},this.state);this.changeIdentifier(t),this.changeOpacity(r),this.changeBlendMode(e),this.removeOverlayEffect();let s=this.engineMediator.orderHelper.addIndex(C.OVERLAY);return new Promise((n,a)=>{this.engineMediator.engine.addOverlayFromAssets(t,this.engineMediator.image.container,s).then(l=>{this.effect=l,this.effect.setProperties({blendMode:e,opacity:r}),this.correctOverlayFlip(),n()}).catch(l=>{this.changeIdentifier(o.identifier),this.changeOpacity(o.opacity),this.changeBlendMode(o.blendMode),o.identifier==="identity"&&this.removeIndex(),a(l)})})};this.removeIndex=()=>{this.engineMediator.orderHelper.removeIndex(C.OVERLAY)};this.engineMediator=t,this.editor=e,this.state=Tm}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}};h([Y],an.prototype,"state",2),h([w],an.prototype,"changeIdentifier",2),h([w],an.prototype,"changeOpacity",2),h([w],an.prototype,"changeBlendMode",2),h([w],an.prototype,"reset",2),h([w],an.prototype,"correctOverlayFlip",2);var We=class{constructor(t){this.selectOverlay=t=>K(this,null,function*(){if(t!==this.identifier){let e=this.defaultBlendModeForIdentifier(t);yield this.overlayStore.setOverlayEffect({identifier:t,opacity:1,blendMode:e}),this.addSnapshot(_t.ADD,C.OVERLAY),this.editor.render()}});this.changeOpacity=t=>{let e=this.overlayStore.setEffectProperties({opacity:t});e&&(this.overlayStore.changeOpacity(e.opacity),this.editor.render())};this.toolSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.controls.sliderOpacity)};this.addSnapshot=(t,e)=>{this.editor.addSnapshot(void 0,t,e)};this.changeBlendMode=t=>{let e=this.overlayStore.setEffectProperties({blendMode:t});e&&(this.overlayStore.changeBlendMode(e.blendMode),this.addSnapshot(_t.EDIT,this.locale.controls.carouselBlendMode),this.editor.render())};this.pureReset=()=>{this.overlayStore.removeOverlayEffect(),this.overlayStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(_t.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromSerialization=t=>K(this,null,function*(){return this.entityManager.items.find(r=>r.identifier===t.identifier)?this.overlayStore.setOverlayEffect(t):new Promise((r,o)=>{o(new Error(`Overlay Asset ${t.identifier} doesn't exist`))})});this.updateStateFromHistory=t=>K(this,null,function*(){return t.identifier==="identity"?(this.pureReset(),new Promise(e=>{e()})):this.overlayStore.setOverlayEffect(t)});this.correctOverlayFlip=()=>{this.overlayStore.correctOverlayFlip()};this.defaultBlendModeForIdentifier=t=>{let e=this.entityManager.items.findIndex(r=>r.identifier===t);return e!==-1?this.entityManager.items[e].defaultBlendMode:vt.LIGHTEN};this.editor=t,this.overlayStore=new an(this.editor.engineMediator,t);let e=this.editor.assetProvider.getAssets("overlay"),{config:r}=this;this.entityManager=new Pe(e,b(b({},r),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("overlay")}))}get state(){return this.overlayStore.state}get identifier(){return this.overlayStore.state.identifier}get opacity(){return this.overlayStore.state.opacity}get blendMode(){return this.overlayStore.state.blendMode}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[C.OVERLAY]}get locale(){return this.editor.configStore.locale[C.OVERLAY]}get items(){return this.entityManager.items}get allBlendModes(){let t=this.locale.controls;return Object.keys(vt).map(e=>{let r=vt[e],o=`blendMode${r.charAt(0).toUpperCase()}${r.slice(1)}`;return{identifier:r,value:t[o]}})}};h([w],We.prototype,"selectOverlay",2),h([w],We.prototype,"changeOpacity",2),h([w],We.prototype,"changeBlendMode",2),h([w],We.prototype,"pureReset",2),h([w],We.prototype,"reset",2),h([w],We.prototype,"updateStateFromSerialization",2),h([w],We.prototype,"updateStateFromHistory",2),h([w],We.prototype,"correctOverlayFlip",2),h([S],We.prototype,"state",1),h([S],We.prototype,"identifier",1),h([S],We.prototype,"opacity",1),h([S],We.prototype,"blendMode",1),h([S],We.prototype,"isOptionSelected",1),h([S],We.prototype,"config",1),h([S],We.prototype,"locale",1),h([S],We.prototype,"items",1),h([S],We.prototype,"allBlendModes",1);var mU=i=>{let t=atob(i.split(",")[1]),e=i.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r);for(let s=0;s<t.length;s+=1)o[s]=t.charCodeAt(s);return new Blob([r],{type:e})},EC=mU;var t_=y(cg());var Dm=class{static isImageElement(t){return t instanceof HTMLImageElement}constructor({license:t,assetProvider:e,crossOrigin:r}){this.crossOrigin=r,this.engine=new ed({license:t,crossOrigin:r,assetProvider:e,downscaleOptions:{maxDimensions:{width:100,height:100}}})}getAllFilterPreviewThumbnails(t){return new Promise((e,r)=>{let o=[],s=[];t.forEach(n=>{n.isDuotone?o.push(n.identifier):s.push(n.identifier)}),this.getAllDuotonePreview(o).then(n=>{this.getAllLutPreview(s).then(a=>{e(Object.assign(n,a))})}).catch(n=>{r(n)})})}getAllDuotonePreview(t){return K(this,null,function*(){let e={};if(!t.length)return e;let r=yield this.engine.addDuoToneFilterFromAssets(t[0],this.container);return yield t_.default(t,o=>K(this,null,function*(){let s=this.engine.assetProvider.getDuotoneFilterAsset(o);r.filterOperation.getFilter().set({intensity:.5,lightColor:Q.Color.fromHex(s.lightColor),darkColor:Q.Color.fromHex(s.darkColor)});let a=yield this.engine.export(qe.DATA_URL,Le.PNG);e[o]=a}),{concurrency:1}),this.engine.removeEffect(r),e})}loadLutAssets(t){return K(this,null,function*(){let e={};return yield t_.default(t,r=>K(this,null,function*(){e[r]=yield this.engine.getLutFilterImage(r)})),e})}getAllLutPreview(t){return K(this,null,function*(){let e={};if(!t.length)return e;let r=yield this.loadLutAssets(t),o=yield this.engine.addLUTFilterFromAssets(t[0],this.container);return yield t_.default(t,s=>K(this,null,function*(){let n=this.engine.assetProvider.getLUTFilterAsset(s),a=o.filterOperation.getFilter(),l={horizontalTileCount:n.horizontalTileCount||5,verticalTileCount:n.verticalTileCount||5,image:r[s]};a.set(b(b({},l),{intensity:n.defaultIntensity||1})),o.setProperties({intensity:1}),a._lutPrimitive.set(l);let c=yield this.engine.export(qe.DATA_URL,Le.PNG);e[s]=c}),{concurrency:1}),this.engine.removeEffect(o),e})}addImageToContainer(t){return new Promise((e,r)=>{let o;Dm.isImageElement(t)?(o=t,this.setBackgroundImage(o),e()):this.getImageElement(t).then(s=>{o=s,this.setBackgroundImage(o),e()}).catch(s=>{r({identifier:"imageLoading",message:s.message})})})}getImageElement(t){return new Promise((e,r)=>{let o=new Image;o.addEventListener("load",()=>{e(o)}),o.addEventListener("error",s=>{r(s)}),o.crossOrigin=this.crossOrigin,o.src=t})}setBackgroundImage(t){this.container?this.container.setData({image:t}):this.container=this.engine.addImage({image:t,blendMode:vt.NORMAL,opacity:1});let{size:e}=this.container.getBounds();this.engine.getOutputContainer().setResolution(e)}};var Im={size:0,color:ji.white,hardness:0,maximumSize:.125,minimumSize:0,maximumHardness:1,minimumHardness:0};var ve=class{constructor(t){this.colorList=fe.defaultColors;this.dirty=Y.box(!1);this.id="";this.containerId=()=>this.id;this.initSize=()=>{let{minimumSize:t,maximumSize:e}=this.state,{size:r}=this;r===0&&this.changeSize(jy(this.config,"defaultSize",[t,e]))};this.changeColor=t=>{this.state.color=t};this.changeSize=t=>{this.state.size=t};this.changeRelativeSize=t=>{let{maximumSize:e,minimumSize:r}=this.state;this.state.size=(e-r)*t/100+r};this.changeHardness=t=>{this.state.hardness=t};this.reset=()=>{this.pureReset(),this.addSnapshot(_t.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.editor=t,this.state=b(b({},Im),{hardness:jy(this.config,"defaultHardness",[Im.minimumHardness,Im.maximumHardness]),color:at(jr(this.config,"defaultColor",Im.color))}),this.config.colors&&this.config.colors.length>0&&(this.colorList=no(at(this.config.colors)))}addSnapshot(t,e){this.editor.addSnapshot(void 0,t,e)}clickableCanvas(t){this.editor.clickableCanvas(t)}beginStroke(t=[]){if(!this.drawingContainer){let e=this.editor.orderHelper.addSprite(C.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:t},this.editor.imageContainer,e)}this.id=this.drawingContainer.getID(),this.drawingContainer.beginStroke({id:"imgly_brush_radial",color:at(this.state.color),size:this.state.size,hardness:this.state.hardness})}strokePosition(t){if(this.drawingContainer){let e=this.editor.previewToWorld(t,!1);this.drawingContainer.addPointToCurrentStroke(e),this.editor.render()}}endStroke(){this.drawingContainer&&(this.drawingContainer.endStroke(),this.editor.render(),this.strokes=this.drawingContainer.getData(),this.addSnapshot(_t.EDIT,this.locale.history.brushStroke),this.dirty.set(!0))}updateStateFromHistory(t){if(t=t||{strokes:[]},this.drawingContainer){if(this.strokes&&this.strokes.strokes.length===t.strokes.length)return;this.strokes=t,this.drawingContainer.setData(this.strokes),t.strokes.length!==0&&this.dirty.set(!0)}else{let e=this.editor.orderHelper.addSprite(C.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:t.strokes},this.editor.imageContainer,e),this.strokes=this.drawingContainer.getData()}this.id=this.drawingContainer.getID()}pureReset(){this.dirty.set(!1),this.strokes={strokes:[]},this.drawingContainer&&(this.editor.engine.removeContainer(this.drawingContainer),this.drawingContainer=void 0)}get config(){return this.editor.configStore.config[C.BRUSH]}get locale(){return this.editor.configStore.locale[C.BRUSH]}get localeColor(){return this.editor.configStore.locale.common.color}get color(){return this.state.color}get size(){return this.state.size}get relativeSize(){let{size:t,maximumSize:e,minimumSize:r}=this.state;return(t-r)*100/(e-r)}get sizeOnScreenSpace(){let t=this.editor.engineMediator.engine.getSmallerOutputSide();return this.editor.worldToPreview(this.state.size*t)}get hardness(){return this.state.hardness}get isDirty(){return this.dirty.get()}};h([Y],ve.prototype,"state",2),h([Y],ve.prototype,"dirty",2),h([w],ve.prototype,"initSize",2),h([w],ve.prototype,"changeColor",2),h([w],ve.prototype,"changeSize",2),h([w],ve.prototype,"changeRelativeSize",2),h([w],ve.prototype,"changeHardness",2),h([w],ve.prototype,"clickableCanvas",1),h([w],ve.prototype,"beginStroke",1),h([w],ve.prototype,"strokePosition",1),h([w],ve.prototype,"endStroke",1),h([w],ve.prototype,"updateStateFromHistory",1),h([w],ve.prototype,"reset",2),h([S],ve.prototype,"config",1),h([S],ve.prototype,"locale",1),h([S],ve.prototype,"localeColor",1),h([S],ve.prototype,"color",1),h([S],ve.prototype,"size",1),h([S],ve.prototype,"relativeSize",1),h([S],ve.prototype,"sizeOnScreenSpace",1),h([S],ve.prototype,"hardness",1),h([S],ve.prototype,"isDirty",1);var lo;(function(i){i.LEADING="leading",i.CENTER="center",i.TRAILING="trailing"})(lo||(lo={}));var pU={horizontalGuides:[],verticalGuides:[],rotationGuides:[]},Ko=class{constructor(t){this.previewTopLeftPosition={x:0,y:0};this.getGuideValue=(t,e)=>{let{height:r,width:o}=this.editor.getPreviewSize(),{snapToLeft:s,snapToRight:n,snapToTop:a,snapToBottom:l}=this.configStore.config.snapping.position,c=Math.min(r,o),d=0;return e==="bottom"?d=Math.round(r-c*l):e==="top"?d=Math.round(c*a):e==="right"?d=Math.round(o-c*n):e==="left"?d=Math.round(c*s):t==="vertical"&&e==="center"?d=Math.round(o/2):t==="horizontal"&&e==="center"&&(d=Math.round(r/2)),d};this.getVerticalGuidesFromConfig=()=>{let{snapToVerticalCenter:t,snapToLeft:e,snapToRight:r}=this.configStore.config.snapping.position,o=[];return t&&o.push({value:this.getGuideValue("vertical","center"),edge:lo.CENTER,isVisible:!1,direction:"vertical"}),e&&o.push({value:this.getGuideValue("vertical","left"),edge:lo.LEADING,isVisible:!1,direction:"vertical"}),r&&o.push({value:this.getGuideValue("vertical","right"),edge:lo.TRAILING,isVisible:!1,direction:"vertical"}),o};this.getHorizontalGuidesFromConfig=()=>{let{snapToHorizontalCenter:t,snapToTop:e,snapToBottom:r}=this.configStore.config.snapping.position,o=[];return t&&o.push({value:this.getGuideValue("horizontal","center"),edge:lo.CENTER,isVisible:!1,direction:"horizontal"}),e&&o.push({value:this.getGuideValue("horizontal","top"),edge:lo.LEADING,isVisible:!1,direction:"horizontal"}),r&&o.push({value:this.getGuideValue("horizontal","bottom"),edge:lo.TRAILING,isVisible:!1,direction:"horizontal"}),o};this.getRotationGuidesFromConfig=()=>{let{angles:t}=this.configStore.config.snapping.rotation,e=[];return t.forEach(o=>{e.push(o),e.push(o+360),e.push(o-360)}),e.filter((o,s)=>e.indexOf(o)===s).map(o=>({value:o*Math.PI/180,edge:lo.CENTER,isVisible:!1,position:{x:0,y:0}}))};this.getSpriteDimensions=({leftTop:t,leftBottom:e,rightTop:r,rightBottom:o})=>{let s=Math.min(t.y,r.y,e.y,o.y),n=Math.max(t.y,r.y,e.y,o.y),a=Math.min(t.x,r.x,e.x,o.x),l=Math.max(t.x,r.x,e.x,o.x);return{height:Math.round(n-s),width:Math.round(l-a)}};this.mapRange=({value:t,fromMin:e,fromLength:r,toMin:o,toLength:s})=>(t-e)*s/r+o;this.updateGuides=()=>{this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig()};this.mapToSnapSystem=(t,e,r,o)=>{if(e.length===0)return t;if(e[0]>t)return t-r;for(let s=0;s<e.length-1;s+=1){let n=e[s],a=e[s+1],l=n+r,c=a-r,d=0;o&&(d=s*r*2,l+=d,c+=d+r*2);let u=1e-5;if(n<=t&&t<=a)return t<=n+u?n+d:t>=a-u?a+d+(o?r*2:0):this.mapRange({value:t,fromMin:n,fromLength:a-n,toMin:l,toLength:c-l})}return o?t+(e.length-1)*r*2+r:t};this.mapFromSnapSystem=(t,e,r,o)=>{if(e.length===0)return t;if(e[0]>t)return t>=e[0]-r?e[0]:t+r;let s=t;for(let a=0;a<e.length-1;a+=1){let l=e[a],c=e[a+1],d=l+r,u=c-r,m=c;if(o&&(u+=r*2,m+=r*2,s=t-a*r*2),l<=s&&s<=m)return d<=s&&s<=u?this.mapRange({value:s,fromMin:d,fromLength:u-d,toMin:l,toLength:c-l}):s<d?l:c}s-=r*3;let n=e[e.length-1];return s<=n?n:s};this.centerSnapValue=(t,e)=>{let r=e*.5,{value:o,edge:s}=t,n=o;return s===lo.LEADING?n+=r:s===lo.TRAILING&&(n-=r),n};this.mapSnappingGuidesToCenter=(t,e)=>{let r=[];return t.forEach(o=>{r.push(this.centerSnapValue(o,e))}),r};this.calcSnapThresholdInRadians=(t,e)=>t===0?0:e/t;this.calculatePreviewTopLeftPosition=()=>{let t=this.editor.engineMediator.preview.container.getPosition(),e=this.editor.getPreviewSize(),r=fe.devicePixelRatio;this.previewTopLeftPosition={x:t.x/r-e.width/2,y:t.y/r-e.height/2}};this.snapToRotation=(t,e,r)=>{let{rotationGuides:o}=this.state,{enabled:s,threshold:n}=this.configStore.config.snapping.rotation,{x:a,y:l}=this.previewTopLeftPosition,{width:c}=this.editor.getPreviewSize(),d=(t+Math.PI*2)%(Math.PI*2);if(s){let u=new R(e).magnitude,m=o.map(v=>v.value).sort((v,x)=>v-x),p=this.calcSnapThresholdInRadians(u,n);if(!this.rotationOffset){let v=this.mapToSnapSystem(t,m,p,!1);this.rotationOffset=v-d}d=this.mapFromSnapSystem(d+this.rotationOffset,m,p,!1);let f={x:r.position.x-a-c,y:r.position.y-l};return o.forEach(v=>{v.isVisible=v.value===d,v.position=f}),d}return t};this.snapToPosition=(t,e)=>{let{horizontalGuides:r,verticalGuides:o}=this.state,{enabled:s,threshold:n}=this.configStore.config.snapping.position,a=new R(this.previewTopLeftPosition),{height:l,width:c}=this.getSpriteDimensions(e),{x:d,y:u}=new R(t).subtract(a);if(s){let m=this.mapSnappingGuidesToCenter(r,l).sort((x,_)=>x-_),p=this.mapSnappingGuidesToCenter(o,c).sort((x,_)=>x-_);if(!this.positionOffset){let x=this.mapToSnapSystem(d,p,n,!0),_=this.mapToSnapSystem(u,m,n,!0);this.positionOffset=new R(x,_).subtract(new R(d,u))}let f=this.mapFromSnapSystem(d+this.positionOffset.x,p,n,!0),v=this.mapFromSnapSystem(u+this.positionOffset.y,m,n,!0);return f=Math.round(f),v=Math.round(v),r.forEach(x=>{let _=Math.round(this.centerSnapValue(x,l));x.isVisible=_===v}),o.forEach(x=>{let _=Math.round(this.centerSnapValue(x,c));x.isVisible=_===f}),new R(f,v).add(a)}return{x:d,y:u}};this.editor=t,this.configStore=t.configStore,this.state=Y(pU),this.rotationOffset=null,this.positionOffset=null,this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig(),this.state.rotationGuides=this.getRotationGuidesFromConfig()}hidePositionGuides(){this.positionOffset=null,this.state.verticalGuides=this.state.verticalGuides.map(t=>b(b({},t),{isVisible:!1})),this.state.horizontalGuides=this.state.horizontalGuides.map(t=>b(b({},t),{isVisible:!1}))}hideRotationGuides(){this.rotationOffset=null,this.state.rotationGuides=this.state.rotationGuides.map(t=>b(b({},t),{isVisible:!1}))}get positionGuides(){let{verticalGuides:t,horizontalGuides:e}=this.state;return[...t,...e]}get rotationGuides(){return this.state.rotationGuides}};h([Y],Ko.prototype,"state",2),h([w],Ko.prototype,"snapToRotation",2),h([w],Ko.prototype,"snapToPosition",2),h([w],Ko.prototype,"hidePositionGuides",1),h([w],Ko.prototype,"hideRotationGuides",1),h([S],Ko.prototype,"positionGuides",1),h([S],Ko.prototype,"rotationGuides",1);function e_(i,t=null){return new Promise((e,r)=>{let o=new Image;o.addEventListener("load",()=>{let s=document.createElement("canvas"),n=s.getContext("2d");s.width=o.width,s.height=o.height,t&&(s.width=t,s.height=t*o.height/o.width),n.drawImage(o,0,0,s.width,s.height),e(s.toDataURL(ir.PNG))}),o.addEventListener("error",()=>{r()}),o.src=i})}var vF=i=>new Promise((t,e)=>{let r=new FileReader;r.onload=o=>K(void 0,null,function*(){try{let{result:s}=o.target,n=yield e_(s,150);t({stickerURI:s,thumbnailURI:n,name:i.name||"",type:i.type,identifier:Vr()})}catch(s){e(s)}}),r.onerror=o=>{e(o)},r.readAsDataURL(i)});var hU="white",yr={identifier:"identity",opacity:1,tintColor:ji[hU],tintMode:"none",resizeMode:"keepAspect"},AC={};var CF="identity",FC="imgly_sticker_custom",Lt=class{constructor(t){this.state=Y.map(AC);this.customStickers=[];this.colorList=fe.defaultColors;this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.doesStickerAssetExist=t=>this.entityManager.items.findIndex(e=>e.identifier===t)!==-1;this.add=t=>{let e=this.entityManager.items.find(s=>s.identifier===t),r=e?e.tintMode:yr.tintMode,o=e?e.resizeMode:yr.resizeMode;this.editor.spriteStore.addSticker({state:{identifier:t,tintMode:r,tintColor:yr.tintColor,opacity:yr.opacity,resizeMode:o}})};this.duplicate=()=>{if(this.id){let t=this.editor.spriteStore.getDuplicateContainerTransform(this.id),e=this.editor.spriteStore.getDuplicateContainerFlip(this.id),{flipHorizontally:r,flipVertically:o}=this.editor.outputContainer.getData();this.editor.spriteStore.addSticker({state:{identifier:this.identifier,tintColor:at(this.tintColor),tintMode:this.tintMode,resizeMode:this.resizeMode,opacity:this.opacity,flipHorizontally:r!==e.flipHorizontally,flipVertically:o!==e.flipVertically},transform:t})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.flipHorizontally=()=>{this.id&&this.editor.spriteStore.flipHorizontally(this.id)};this.delete=()=>{if(this.id){let t=this.id;this.editor.spriteStore.removeSprite(t),this.state.delete(t),this.selectLast()}};this.updateStateFromHistory=(t,e)=>{this.setState(t,e),this.editor.spriteStore.setContainerProperties(t,e)};this.setState=(t,e)=>{let r=this.state.get(t);r?("opacity"in e&&(r.opacity=e.opacity),e.tintColor&&(r.tintColor=e.tintColor),e.tintMode&&(r.tintMode=e.tintMode),e.resizeMode&&(r.resizeMode=e.resizeMode),this.state.set(t,r)):this.state.set(t,{identifier:e.identifier,opacity:e.opacity,tintMode:e.tintMode,resizeMode:e.resizeMode,tintColor:e.tintColor?e.tintColor:yr.tintColor})};this.changeOpacity=t=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{opacity:t});let r=this.editor.spriteStore.getContainerProperties(this.id);e.opacity=r.opacity,this.state.set(this.id,e)}}};this.changeTintColor=t=>{if(this.id){let e=this.state.get(this.id);if(e){let{tintMode:r}=this.entityManager.items.find(s=>s.identifier===this.identifier);this.editor.spriteStore.setContainerProperties(this.id,{tintColor:t,tintMode:r});let o=this.editor.spriteStore.getContainerProperties(this.id);e.tintColor=o.tintColor,e.tintMode=o.tintMode||yr.tintMode,this.state.set(this.id,e)}}};this.tintColorSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.history.color)};this.addFiles=t=>K(this,null,function*(){if(this.editor.modalStore.showInfoModal("loading"),t.length){let e=0,r=[];for(e=0;e<t.length;e+=1)r.push(vF(t[e]));try{let o=yield Promise.all(r);this.addCustomStickerAsset(o),this.editor.configStore.events.onStickerUploadedAdd(o.map(({identifier:s,stickerURI:n},a)=>({identifier:s,stickerURI:n,file:t[a]})))}catch(o){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}}});this.addCustomStickerAsset=t=>K(this,null,function*(){let e=[];t.forEach(({stickerURI:n,thumbnailURI:a,name:l,identifier:c,type:d})=>{e.push({stickerURI:n,thumbnailURI:a,name:l,tintMode:this.customStickerTintMode,resizeMode:"keepAspect",identifier:c}),this.customStickers.push({identifier:c,type:d,stickerURI:n,name:l})});let r=this.locale.categories[FC];this.editor.assetProvider.addCustomStickerAsset(e,FC,r);let o=this.editor.assetProvider.getAssets("sticker"),{config:s}=this;this.entityManager=new Pe(o,b(b({},s),{categoryKey:"thumbnailURI",itemKey:"stickerURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("sticker")})),this.selectedCategory=FC,this.editor.modalStore.hideModal()});this.toolSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.history.opacity)};this.addSnapshot=(t,e)=>{this.currentSticker&&this.editor.spriteStore.addSnapshot(t,e)};this.toggleCategorySelection=t=>{this.selectedCategory=this.selectedCategory===t?CF:t};this.pureReset=()=>{this.state=Y.map(AC)};this.editor=t,this.selectedCategory=CF;let{config:e}=this,r=this.editor.assetProvider.getAssets("sticker");this.entityManager=new Pe(r,b(b({},e),{categoryKey:"thumbnailURI",itemKey:"stickerURI",locale:b(b({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("sticker")})),yr.tintColor=at(jr(this.config,"defaultTintColor",yr.tintColor)),this.config.colors&&this.config.colors.length>0&&(this.colorList=no(at(this.config.colors)))}get isStickerSelected(){return this.editor.spriteStore.isSpriteSticker}get isCustomStickerEnabled(){return this.config.enableCustomUpload}get customStickerTintMode(){return this.config.customStickerTintMode}get currentSticker(){if(this.isStickerSelected){let t=this.state.get(this.id);if(t)return t}}get identifier(){if(this.isStickerSelected){let t=this.state.get(this.id);if(t)return t.identifier}return"none"}get id(){if(this.isStickerSelected)return this.editor.spriteStore.id}get opacity(){return this.currentSticker?this.currentSticker.opacity:yr.opacity}get tintMode(){return this.currentSticker?this.currentSticker.tintMode:yr.tintMode}get resizeMode(){return this.currentSticker?this.currentSticker.resizeMode:yr.resizeMode}get tintable(){return this.currentSticker?this.currentSticker.tintMode==="solid"||this.currentSticker.tintMode==="colorized":!1}get tintColor(){return this.currentSticker?this.currentSticker.tintColor:yr.tintColor}get config(){return this.editor.configStore.config[C.STICKER]}get locale(){return this.editor.configStore.locale[C.STICKER]}get localeColor(){return this.editor.configStore.locale.common.color}get selectedCategoryIdentifier(){return this.selectedCategory}get items(){return this.entityManager.items}get categories(){return this.entityManager.categories}};h([Y],Lt.prototype,"selectedCategory",2),h([Y],Lt.prototype,"entityManager",2),h([w],Lt.prototype,"selectLast",2),h([w],Lt.prototype,"add",2),h([w],Lt.prototype,"duplicate",2),h([w],Lt.prototype,"bringToFront",2),h([w],Lt.prototype,"flipHorizontally",2),h([w],Lt.prototype,"delete",2),h([w],Lt.prototype,"updateStateFromHistory",2),h([w],Lt.prototype,"setState",2),h([w],Lt.prototype,"changeOpacity",2),h([w],Lt.prototype,"changeTintColor",2),h([w],Lt.prototype,"addFiles",2),h([w],Lt.prototype,"addCustomStickerAsset",2),h([w],Lt.prototype,"toggleCategorySelection",2),h([w],Lt.prototype,"pureReset",2),h([S],Lt.prototype,"isStickerSelected",1),h([S],Lt.prototype,"isCustomStickerEnabled",1),h([S],Lt.prototype,"customStickerTintMode",1),h([S],Lt.prototype,"currentSticker",1),h([S],Lt.prototype,"identifier",1),h([S],Lt.prototype,"id",1),h([S],Lt.prototype,"opacity",1),h([S],Lt.prototype,"tintMode",1),h([S],Lt.prototype,"resizeMode",1),h([S],Lt.prototype,"tintable",1),h([S],Lt.prototype,"tintColor",1),h([S],Lt.prototype,"config",1),h([S],Lt.prototype,"locale",1),h([S],Lt.prototype,"localeColor",1),h([S],Lt.prototype,"selectedCategoryIdentifier",1),h([S],Lt.prototype,"items",1),h([S],Lt.prototype,"categories",1);var fU="imgly_font_open_sans_bold",ee={text:"Write Something",identifier:fU,fontSize:73.3,defaultFontSize:73.3,fontFamily:"Open Sans",fontStyle:"",fontWeight:"bold",lineHeight:1,alignment:"center",textColor:ji.white,backgroundColor:ji.transparent||[0,0,0,0],width:0},OC={};var SF={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"SemiBold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular",lighter:"Lighter"},sd=class{constructor(t){this.state=Y.map(OC);this.colorList=fe.defaultColors;this.backgroundColorList=fe.defaultBackgroundColors;this.loadingObservable=Y.box(!1);this.loadfonts=t=>{if(this.fontsLoaded)t();else{let e=this.editor.assetProvider.getFontManager(),r=this.editor.assetProvider.getFontAssetsForText().map(o=>o.identifier);e.loadFontsWithIdentifiers(r).then(()=>{this.loadingObservable.set(!0),t()}).catch(o=>{console.error(o),this.editor.modalStore.showActionModal({type:Vt.ERROR,identifier:"fontLoading",error:o})})}};this.doesTextAssetExist=t=>this.editor.assetProvider.getFontAssets().findIndex(e=>e.identifier===t)!==-1;this.validFontWithConfig=t=>this.fonts.find(e=>e.identifier===t)||this.fonts[0];this.addOrselect=()=>{this.state.size?this.selectLast():this.add()};this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.add=()=>{let t=()=>{this.editor.spriteStore.addText({state:{identifier:ee.identifier,text:ee.text,textColor:ee.textColor,backgroundColor:ee.backgroundColor,lineHeight:ee.lineHeight,alignment:ee.alignment,fontSize:0}})};this.loadfonts(t)};this.duplicate=()=>{if(this.id){let t=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addText({state:{identifier:this.identifier,text:this.text,textColor:at(this.textColor),lineHeight:this.lineHeight,alignment:this.alignment,fontSize:this.fontSize,backgroundColor:at(this.backgroundColor),width:this.width},transform:t})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.delete=()=>{if(this.id){let t=this.id;this.editor.spriteStore.removeSprite(t),this.state.delete(t),this.selectLast()}};this.setEditMode=t=>{this.editor.spriteStore.setEditMode(t)};this.changeFont=t=>{let e=this.fonts.find(r=>r.identifier===t);this.changeIdentifier(e,this.id),this.id&&this.addSnapshot(_t.EDIT,this.locale.history.fontFamily)};this.changeIdentifier=(t,e)=>{Me(()=>{if(t&&e){let r=this.state.get(e);if(r){this.editor.spriteStore.setContainerProperties(e,{fontIdentifier:t.identifier},!0);let o=this.editor.spriteStore.getContainerProperties(e);r.identifier=o.fontIdentifier,r.fontFamily=t.fontFamily,r.fontStyle=t.fontStyle,r.fontWeight=t.fontWeight,r.fontSize=o.fontSize,r.width=o.width,r.defaultFontSize=r.fontSize,this.state.set(e,r)}}})};this.changeFontSize=(t,e=!1)=>{if(this.id){let r=this.state.get(this.id);r&&(r.fontSize=t,e&&(r.defaultFontSize=t),this.state.set(this.id,r))}};this.updateDefaultFontSize=()=>{if(this.id){let t=this.state.get(this.id);t&&(t.defaultFontSize=t.fontSize,this.state.set(this.id,t))}};this.changeSize=(t,e)=>{let r=this.state.get(t);r&&(r.width=e.width,r.fontSize=e.fontSize,r.defaultFontSize=e.fontSize,this.state.set(t,r))};this.changeWidth=t=>{if(this.id){let e=this.state.get(this.id);e&&(e.width=t,this.state.set(this.id,e))}};this.changeText=t=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{text:t},!0);let r=this.editor.spriteStore.getContainerProperties(this.id),o=this.editor.outputContainer.getSizeInOutputSpace(),s=this.editor.spriteStore.getSize(this.id);this.config.disableAutoScaling||s.height>o.height&&this.editor.spriteStore.setContainerProperties(this.id,{fontSize:this.calculateFitFontSize(this.id,o.height)},!0),r=this.editor.spriteStore.getContainerProperties(this.id),e.text=r.text,e.fontSize=r.fontSize,e.defaultFontSize=r.fontSize,this.state.set(this.id,e),this.addSnapshot(_t.EDIT,this.locale.history.edit)}}};this.calculateFitFontSize=(t,e)=>{if(!sd.measureContext){let p=document.createElement("canvas");sd.measureContext=p.getContext("2d")}let r=this.editor.spriteStore.getContainerProperties(t),o=this.editor.engine.assetProvider.getFontManager().getFontWithId(r.fontIdentifier),s=this.config.minFontSizeForAutoScaling,n=xl(sd.measureContext,r.text,o,r.fontSize,r.lineHeight,r.width,o.textMetrics),a=Math.min(Math.floor(r.fontSize*(e/n.height)),1),l=Math.round(r.fontSize),c=0,d=l-a,u=Math.floor((l-a)*2),m=d;for(;c<=u;){d=c+Math.floor((u-c)/2);let p=xl(sd.measureContext,r.text,o,d,r.lineHeight,r.width,o.textMetrics);if(e<p.height)u=d-1,m=d-1;else if(e>p.height){if(c=d+1,a+d>=l)return l}else{m=d;break}}return s&&m<s?s:m};this.changeLineHeight=t=>{if(this.id){let e=this.state.get(this.id);if(e&&t){this.editor.spriteStore.setContainerProperties(this.id,{lineHeight:t},!0);let r=this.editor.spriteStore.getContainerProperties(this.id);e.lineHeight=r.lineHeight,this.state.set(this.id,e)}}};this.changeColor=t=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{textColor:t});let r=this.editor.spriteStore.getContainerProperties(this.id);e.textColor=r.textColor,this.state.set(this.id,e)}}};this.changeBackgroundColor=t=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{backgroundColor:t});let r=this.editor.spriteStore.getContainerProperties(this.id);e.backgroundColor=r.backgroundColor,this.state.set(this.id,e)}}};this.colorSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.history.textColor)};this.backgroundColorSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.history.backgroundColor)};this.changeAlignment=t=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{alignment:t});let r=this.editor.spriteStore.getContainerProperties(this.id);e.alignment=r.alignment,this.state.set(this.id,e),this.addSnapshot(_t.EDIT,this.locale.history.alignment)}}};this.toolSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.history.lineSpacing)};this.addSnapshot=(t,e)=>{this.currentText&&this.editor.spriteStore.addSnapshot(t,e)};this.updateStateFromHistory=(t,e)=>{this.setState(t,e),this.editor.spriteStore.setContainerProperties(t,e)};this.setState=(t,e)=>{let r=this.state.get(t);if(r)e.alignment&&(r.alignment=e.alignment),e.text&&(r.text=e.text),e.lineHeight&&(r.lineHeight=e.lineHeight),e.textColor&&(r.textColor=e.textColor),e.backgroundColor&&(r.backgroundColor=e.backgroundColor),e.fontIdentifier&&(r.identifier=e.fontIdentifier),e.fontSize&&(r.fontSize=e.fontSize,r.defaultFontSize=e.fontSize),e.width&&(r.width=e.width);else{let o=this.validFontWithConfig(e.fontIdentifier);o&&this.state.set(t,{text:e.text,identifier:o.identifier,alignment:e.alignment,textColor:e.textColor?e.textColor:ee.textColor,backgroundColor:e.backgroundColor?e.backgroundColor:ee.backgroundColor,fontFamily:o.fontFamily,fontStyle:o.fontStyle,fontSize:e.fontSize,fontWeight:o.fontWeight,lineHeight:e.lineHeight,width:e.width,defaultFontSize:e.fontSize})}};this.setFontSize=t=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{fontSize:t},!0);let r=this.editor.spriteStore.getContainerProperties(this.id);e.fontSize=r.fontSize,e.defaultFontSize=r.fontSize,this.state.set(this.id,e)}}};this.pureReset=()=>{this.state=Y.map(OC)};this.editor=t,this.fonts.find(e=>e.identifier===ee.identifier)||(ee.identifier=this.fonts[0].identifier),ee.textColor=at(jr(this.config,"defaultColor",ee.textColor)),ee.backgroundColor=at(jr(this.config,"defaultBackgroundColor",ee.backgroundColor)),ee.text=this.locale.canvasControls.placeholderText,this.config.colors&&this.config.colors.length>0&&(this.colorList=no(at(this.config.colors))),this.config.backgroundColors&&this.config.backgroundColors.length>0&&(this.backgroundColorList=no(at(this.config.backgroundColors)))}static defaultText(){return ee.text}static getDisplayFontStyle(t){let e=t.fontWeight&&SF[t.fontWeight].toLowerCase()!=="regular"?SF[t.fontWeight]:"",r=t.fontStyle&&t.fontStyle.toLowerCase()!=="normal"?t.fontStyle:"";return`${t.fontFamily.toLowerCase().includes(e.toLowerCase())?"":e} ${r}`.trim()}get isEditMode(){return this.editor.spriteStore.isEditMode}get isTextSelected(){return this.editor.spriteStore.isSpriteText}get fontsLoaded(){return this.loadingObservable.get()}get currentText(){if(this.isTextSelected){let t=this.state.get(this.id);if(t)return t}}get text(){return this.currentText?this.currentText.text:ee.text}get fontSize(){return this.currentText?this.currentText.fontSize:ee.fontSize}get defaultFontSize(){return this.currentText?this.currentText.defaultFontSize:ee.defaultFontSize}get width(){return this.currentText?this.currentText.width:ee.width}get fontFamily(){return this.currentText?this.currentText.fontFamily:ee.fontFamily}get fontStyle(){return this.currentText?this.currentText.fontStyle:ee.fontStyle}get fontWeight(){return this.currentText?this.currentText.fontWeight:ee.fontWeight}get lineHeight(){return this.currentText?this.currentText.lineHeight:ee.lineHeight}get identifier(){return this.currentText?this.currentText.identifier:ee.identifier}get id(){if(this.isTextSelected)return this.editor.spriteStore.id}get alignment(){return this.currentText?this.currentText.alignment:ee.alignment}get textColor(){return this.currentText?this.currentText.textColor:ee.textColor}get backgroundColor(){return this.currentText?this.currentText.backgroundColor:ee.backgroundColor}get config(){return this.editor.configStore.config[C.TEXT]}get locale(){return this.editor.configStore.locale[C.TEXT]}get localeColor(){return this.editor.configStore.locale.common.color}get rawOptions(){return this.editor.assetProvider.getFontAssetsForText()}get fonts(){return this.rawOptions.reduce((t,e)=>this.rawOptions.find(r=>r.identifier===e.identifier)?[...t,{identifier:e.identifier,fontFamily:e.fontFamily,fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||""}]:t,[])}get fontFamilies(){return[...new Set(this.fonts)]}},yt=sd;h([w],yt.prototype,"addOrselect",2),h([w],yt.prototype,"selectLast",2),h([w],yt.prototype,"add",2),h([w],yt.prototype,"duplicate",2),h([w],yt.prototype,"bringToFront",2),h([w],yt.prototype,"delete",2),h([w],yt.prototype,"setEditMode",2),h([w],yt.prototype,"changeFont",2),h([w],yt.prototype,"changeIdentifier",2),h([w],yt.prototype,"changeFontSize",2),h([w],yt.prototype,"updateDefaultFontSize",2),h([w],yt.prototype,"changeSize",2),h([w],yt.prototype,"changeWidth",2),h([w],yt.prototype,"changeText",2),h([w],yt.prototype,"changeLineHeight",2),h([w],yt.prototype,"changeColor",2),h([w],yt.prototype,"changeBackgroundColor",2),h([w],yt.prototype,"changeAlignment",2),h([w],yt.prototype,"updateStateFromHistory",2),h([w],yt.prototype,"setState",2),h([w],yt.prototype,"setFontSize",2),h([w],yt.prototype,"pureReset",2),h([S],yt.prototype,"isEditMode",1),h([S],yt.prototype,"isTextSelected",1),h([S],yt.prototype,"fontsLoaded",1),h([S],yt.prototype,"currentText",1),h([S],yt.prototype,"text",1),h([S],yt.prototype,"fontSize",1),h([S],yt.prototype,"defaultFontSize",1),h([S],yt.prototype,"width",1),h([S],yt.prototype,"fontFamily",1),h([S],yt.prototype,"fontStyle",1),h([S],yt.prototype,"fontWeight",1),h([S],yt.prototype,"lineHeight",1),h([S],yt.prototype,"identifier",1),h([S],yt.prototype,"id",1),h([S],yt.prototype,"alignment",1),h([S],yt.prototype,"textColor",1),h([S],yt.prototype,"backgroundColor",1),h([S],yt.prototype,"config",1),h([S],yt.prototype,"locale",1),h([S],yt.prototype,"localeColor",1),h([S],yt.prototype,"rawOptions",1),h([S],yt.prototype,"fonts",1),h([S],yt.prototype,"fontFamilies",1);var gU="imgly_text_design_blocks",Ge={identifier:gU,color:ji.white,isInverted:!1,text:"Write Something With Style",seed:0,padding:0,width:0},RC={imgly_text_design_blocks:835,imgly_text_design_rotated:6,imgly_text_design_blocks_light:3,imgly_text_design_equal_width:727,imgly_text_design_masked:259,imgly_text_design_celebrate:579,imgly_text_design_sunshine:77,imgly_text_design_masked_badge:683,imgly_text_design_blocks_condensed:673,imgly_text_design_celebrate_simple:425,imgly_text_design_equal_width_fat:961,imgly_text_design_watercolor:671,imgly_text_design_particles:683,imgly_text_design_masked_speech_bubble:317,imgly_text_design_masked_speech_bubble_comic:229,imgly_text_design_multiline:831},PC={};var Bt=class{constructor(t){this.state=Y.map(PC);this.colorList=fe.defaultColors;this.fontsLoaded=!1;this.loadfonts=t=>{if(this.fontsLoaded)t();else{let e=this.editor.assetProvider.getFontManager(),r=this.editor.assetProvider.getFontAssetsForTextDesign().map(o=>o.identifier);e.loadFontsWithIdentifiers(r).then(()=>{this.fontsLoaded=!0,t()}).catch(o=>{console.error(o),this.editor.modalStore.showActionModal({type:Vt.ERROR,identifier:"fontLoading",error:r[0]})})}};this.doesTextDesignAssetExist=t=>this.entityManager.items.findIndex(e=>e.identifier===t)!==-1;this.addOrselect=()=>{this.state.size?this.selectLast():this.add()};this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.add=()=>{let t=()=>{this.editor.spriteStore.addTextDesign({state:{identifier:Ge.identifier,text:Ge.text,color:Ge.color,isInverted:Ge.isInverted,seed:RC[Ge.identifier]||Ge.seed,padding:0}})};this.loadfonts(t)};this.updateStateFromHistory=(t,e)=>{let r=this.state.get(t);e.identifier===r.identifier?(this.setState(t,e),this.editor.spriteStore.setContainerProperties(t,e)):this.changeIdentifier(e.identifier,!1,e.seed,t)};this.setState=(t,e)=>{let r=this.state.get(t);r?(e.inverted&&(r.isInverted=e.inverted),e.seed&&(r.seed=e.seed),e.color&&(r.color=e.color),e.padding&&(r.padding=e.padding),e.width&&(r.width=e.width)):this.state.set(t,{width:e.width,text:e.text,isInverted:e.inverted,identifier:e.identifier,seed:e.seed,color:e.color?e.color:Ge.color,padding:e.padding})};this.changeText=t=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{text:t},!0);let r=this.editor.spriteStore.getContainerProperties(this.id);e.text=r.text,this.state.set(this.id,e),this.addSnapshot(_t.EDIT,this.locale.history.edit)}}};this.setEditMode=t=>{this.editor.spriteStore.setEditMode(t)};this.duplicate=()=>{if(this.id){let t=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addTextDesign({state:{identifier:this.identifier,text:this.text,color:at(this.color),isInverted:this.isInverted,seed:this.seed,padding:this.padding,width:this.width},transform:t})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.addSnapshot=(t,e)=>{this.currentTextDesign&&this.editor.spriteStore.addSnapshot(t,e)};this.delete=(t=this.id)=>{t&&(this.editor.spriteStore.removeSprite(t),this.state.delete(t),this.selectLast())};this.changeSeed=()=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{seed:-1},!0);let e=this.editor.spriteStore.getContainerProperties(this.id);t.seed=e.seed,this.state.set(this.id,t),this.addSnapshot(_t.EDIT,this.locale.history.shuffle)}}};this.changeIdentifier=(t,e=!0,r=null,o=this.id)=>{if(o&&t!==this.identifier){let s=this.state.get(o),n=this.editor.spriteStore.getContainerTransform(o);this.editor.spriteStore.addTextDesign({spriteId:o,state:{identifier:t,text:s.text,color:at(s.color),isInverted:s.isInverted,seed:r||RC[t]||s.seed,padding:s.padding,width:s.width},transform:n},e,!0)}};this.changeColor=t=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{color:t});let r=this.editor.spriteStore.getContainerProperties(this.id);e.color=r.color,this.state.set(this.id,e)}}};this.colorSnapshot=()=>{this.addSnapshot(_t.EDIT,this.locale.history.color)};this.invertBackground=()=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{inverted:!t.isInverted},!0);let e=this.editor.spriteStore.getContainerProperties(this.id);t.isInverted=e.inverted,this.state.set(this.id,t),this.addSnapshot(_t.EDIT,this.locale.history.invert)}}};this.changeWidth=t=>{if(this.id){let e=this.state.get(this.id);e&&(e.width=t,this.state.set(this.id,e))}};this.changePadding=t=>{if(this.id){let e=this.state.get(this.id);e&&(e.padding=t,this.state.set(this.id,e))}};this.pureReset=()=>{this.state=Y.map(PC)};this.editor=t;let e=this.editor.assetProvider.getAssets("textdesign");this.entityManager=new Pe(e,b(b({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:{},getAssetPath:this.editor.getAssetPath("textdesign")})),this.entityManager.items.find(r=>r.identifier===Ge.identifier)||(Ge.identifier=this.entityManager.items[0].identifier),Ge.text=this.locale.canvasControls.placeholderText,Ge.color=at(jr(this.config,"defaultColor",Ge.color)),this.config.colors&&this.config.colors.length>0&&(this.colorList=no(at(this.config.colors)))}static defaultText(){return Ge.text}get isTextDesignSelected(){return this.editor.spriteStore.isSpriteTextDesign}get isEditMode(){return this.editor.spriteStore.isEditMode}get currentTextDesign(){if(this.isTextDesignSelected&&this.id){let t=this.state.get(this.id);if(t)return t}}get id(){if(this.isTextDesignSelected)return this.editor.spriteStore.id}get text(){return this.currentTextDesign?this.currentTextDesign.text:Ge.text}get seed(){return this.currentTextDesign?this.currentTextDesign.seed:Ge.seed}get padding(){return this.currentTextDesign?this.currentTextDesign.padding:Ge.padding}get width(){return this.currentTextDesign?this.currentTextDesign.width:Ge.width}get identifier(){return this.currentTextDesign?this.currentTextDesign.identifier:null}get isInverted(){return this.currentTextDesign?this.currentTextDesign.isInverted:Ge.isInverted}get color(){return this.currentTextDesign?this.currentTextDesign.color:Ge.color}get config(){return this.editor.configStore.config[C.TEXT_DESIGN]}get locale(){return this.editor.configStore.locale[C.TEXT_DESIGN]}get localeColor(){return this.editor.configStore.locale.common.color}get items(){return this.entityManager.items}};h([w],Bt.prototype,"addOrselect",2),h([w],Bt.prototype,"selectLast",2),h([w],Bt.prototype,"add",2),h([w],Bt.prototype,"updateStateFromHistory",2),h([w],Bt.prototype,"setState",2),h([w],Bt.prototype,"changeText",2),h([w],Bt.prototype,"setEditMode",2),h([w],Bt.prototype,"duplicate",2),h([w],Bt.prototype,"bringToFront",2),h([w],Bt.prototype,"delete",2),h([w],Bt.prototype,"changeSeed",2),h([w],Bt.prototype,"changeIdentifier",2),h([w],Bt.prototype,"changeColor",2),h([w],Bt.prototype,"invertBackground",2),h([w],Bt.prototype,"changeWidth",2),h([w],Bt.prototype,"changePadding",2),h([w],Bt.prototype,"pureReset",2),h([S],Bt.prototype,"isTextDesignSelected",1),h([S],Bt.prototype,"isEditMode",1),h([S],Bt.prototype,"currentTextDesign",1),h([S],Bt.prototype,"id",1),h([S],Bt.prototype,"text",1),h([S],Bt.prototype,"seed",1),h([S],Bt.prototype,"padding",1),h([S],Bt.prototype,"width",1),h([S],Bt.prototype,"identifier",1),h([S],Bt.prototype,"isInverted",1),h([S],Bt.prototype,"color",1),h([S],Bt.prototype,"config",1),h([S],Bt.prototype,"locale",1),h([S],Bt.prototype,"localeColor",1),h([S],Bt.prototype,"items",1);var bU=i=>({height:i.y,width:i.x}),_U={},i_="none",yU={position:{x:0,y:0},rotation:0},Em=class{constructor(t){this.state=Y.map(_U);this.selectedId=Y.box(i_);this.editMode=Y.box(!1);this.dragMode=Y.box(!1);this.minLength=0;this.addSticker=(t,e=!0)=>K(this,null,function*(){yield this.addStickerAsync(t,e)});this.addStickerAsync=(s,...n)=>K(this,[s,...n],function*({spriteId:t,state:e,transform:r},o=!0){return new Promise((a,l)=>{r=this.getInitialTransform(r);let{identifier:c}=e,d=this.editor.orderHelper.addSprite(c);this.editor.engine.addStickerFromAssets(c,this.editor.engineMediator.image.container,d).then(u=>K(this,null,function*(){t&&u.setData({id:t});let m=u.getID();this.container[m]=u,this.editor.orderHelper.renameSprite(c,m);let p=this.getSize(m);p.width*=u.getScale().x,p.height*=u.getScale().y,u.setPivot(.5,.5);let f;if(r.scale)f=r.scale;else if(r.size)f={x:r.size.width/p.width,y:r.size.height/p.height};else{let D=this.editor.shortestOutputSide*.4,k=Em.magnitude(D)/Em.sizeMagnitude(u.getSizeInWorldSpace());f={x:k,y:k}}let{flipHorizontally:v,flipVertically:x}=this.editor.outputContainer.getData();u.setFlipHorizontally(v),u.setFlipVertically(x),u.setTransform({position:r.position,scale:f,rotation:r.rotation}),e.flipHorizontally!==void 0&&u.setFlipHorizontally(e.flipHorizontally!==v),e.flipVertically!==void 0&&u.setFlipVertically(e.flipVertically!==x),this.setContainerProperties(m,b({},e));let _=u.getData();this.setInitialSpriteState(m,C.STICKER),this.stickerToolStore.setState(m,b(b({},_),{identifier:c})),yield this.editor.renderPromise(),o&&(this.selectedId.set(m),this.addSnapshot(_t.ADD,this.stickerLocale.add)),a()})).catch(u=>{console.error(u),l()})})});this.addText=(t,e=!0)=>K(this,null,function*(){yield this.addTextAsync(t,e)});this.addTextAsync=({spriteId:t,state:e,transform:r},o=!0)=>new Promise((s,n)=>{r=this.getInitialTransform(r);let a=this.editor.orderHelper.addSprite(e.identifier),l=this.editor.shortestOutputSide,c={fontIdentifier:e.identifier,text:e.text,width:e.width||l*.6,fontSize:e.fontSize||l*.1,lineHeight:e.lineHeight,alignment:e.alignment,textColor:e.textColor,backgroundColor:e.backgroundColor};this.editor.engine.addTextWithFontLoading(c,this.editor.engineMediator.image.container,a).then(d=>K(this,null,function*(){t&&d.setData({id:t});let u=d.getID();this.container[u]=d,this.editor.orderHelper.renameSprite(e.identifier,this.id);let{flipHorizontally:m,flipVertically:p}=this.editor.outputContainer.getData();d.setFlipHorizontally(m),d.setFlipVertically(p),d.setPivot(.5,.5),d.setPosition(r.position),d.setRotation(r.rotation),this.setInitialSpriteState(u,C.TEXT);let f=d.getData();this.textToolStore.setState(u,b({},f)),yield this.editor.renderPromise(),o&&(this.selectedId.set(u),this.addSnapshot(_t.ADD,this.textLocale.add)),s()})).catch(d=>{console.error(d),n()})});this.addTextDesign=(t,e=!0,r=!1)=>K(this,null,function*(){yield this.addTextDesignAsync(t,e,r)});this.addTextDesignAsync=({spriteId:t,state:e,transform:r},o=!0,s=!1)=>new Promise((n,a)=>{r=this.getInitialTransform(r);let l=this.editor.orderHelper.addSprite(e.identifier),c=this.editor.shortestOutputSide,d={width:e.width||c*.6,text:e.text,color:e.color,inverted:e.isInverted,seed:e.seed,padding:e.padding};this.editor.engine.addTextDesignAsync(e.identifier,d,this.editor.engineMediator.image.container,l).then(u=>K(this,null,function*(){t&&(s&&(this.pureRemoveSprite(t),this.textDesignToolStore.state.delete(t)),u.setData({id:t}));let m=u.getID();this.container[m]=u,this.editor.orderHelper.renameSprite(e.identifier,this.id);let{flipHorizontally:p,flipVertically:f}=this.editor.outputContainer.getData();u.setFlipHorizontally(p),u.setFlipVertically(f),u.setPivot(.5,.5),u.setPosition(r.position),u.setRotation(r.rotation),this.setInitialSpriteState(m,C.TEXT_DESIGN);let v=u.getData();this.textDesignToolStore.setState(m,b(b({},v),{identifier:e.identifier})),yield this.editor.renderPromise(),o&&(this.selectedId.set(m),this.addSnapshot(_t.ADD,this.textDesignLocale.add)),n()})).catch(u=>{console.error(u),a()})});this.spriteLocalTransform=()=>({position:this.editor.previewToOutput(this.position),size:this.size,rotation:this.rotation});this.clickableCanvas=t=>{this.editor.clickableCanvas(t)};this.setContainerProperties=(t,e,r=!1)=>{this.container[t].setData(e),r&&this.updatePositionAndSize(),this.editor.render()};this.setContainerPosition=(t,e)=>{this.container[t].setPosition(e)};this.pureRemoveSprite=t=>(this.editor.engine.removeContainer(this.container[t]),this.container[t].getIndexInParent()===-1?(delete this.container[t],this.state.delete(t),this.editor.orderHelper.removeSprite(t),!0):!1);this.deleteSprite=(t=this.id)=>{let e=this.state.get(t);e.tool===C.STICKER?this.stickerToolStore.delete():e.tool===C.TEXT?this.textToolStore.delete():e.tool===C.TEXT_DESIGN&&this.textDesignToolStore.delete()};this.removeSprite=t=>{this.pureRemoveSprite(t)&&(this.selectLast(),this.spriteSnapshot("delete"),this.editor.render())};this.addSnapshot=(t,e)=>{this.editor.addSnapshot(void 0,t,e)};this.spriteSnapshot=t=>{this.addSnapshot(_t.EDIT,this.historyLocale[t])};this.updateStateFromHistory=t=>K(this,null,function*(){let e=Object.keys(this.container),r=t.spriteIdList;if(r.length!==e.length){let o=e.filter(n=>r.indexOf(n)===-1),s=r.filter(n=>e.indexOf(n)===-1);o.forEach(n=>{this.pureRemoveSprite(n)});for(let n=0;n<s.length;n+=1){let a=s[n],l=t.common?t.common[a]:void 0,c=t.text?t.text[a]:void 0,d=t.sticker?t.sticker[a]:void 0,u=t.textdesign?t.textdesign[a]:void 0;if(l){let m={spriteId:a,transform:{size:l.size?bU(R.fromSize(l.size)):void 0,position:new R(l.position),rotation:l.rotation}};c?yield this.addNewText(m,c):u?yield this.addNewTextDesign(m,u):d&&(yield this.addNewSticker(m,b(b({},d),{flipHorizontally:l.flipHorizontally,flipVertically:l.flipVertically})))}}}else this.updateSpriteStateFromHistory(t)});this.addNewText=(t,e)=>K(this,null,function*(){if(this.textToolStore.doesTextAssetExist(e.identifier))yield this.addTextAsync(b(b({},t),{state:e}),!1);else throw new Error(`Text identifier ${e.identifier} doesn't exist`)});this.addNewTextDesign=(t,e)=>K(this,null,function*(){if(this.textDesignToolStore.doesTextDesignAssetExist(e.identifier))yield this.addTextDesignAsync(b(b({},t),{state:e}),!1);else throw new Error(`TextDesign identifier ${e.identifier} doesn't exist`)});this.addNewSticker=(t,e)=>K(this,null,function*(){if(this.stickerToolStore.doesStickerAssetExist(e.identifier))yield this.addStickerAsync(b(b({},t),{state:e}),!1);else throw new Error(`Sticker identifier ${e.identifier} doesn't exist`)});this.updateSpriteStateFromHistory=t=>K(this,null,function*(){Object.keys(this.container).forEach(e=>{let r=t.common?t.common[e]:void 0,o=t.sticker?t.sticker[e]:void 0,s=t.text?t.text[e]:void 0,n=t.textdesign?t.textdesign[e]:void 0,a=this.state.get(e);if(a&&r){this.state.set(e,a);let l=this.container[e];l.setPosition(new R(r.position)),l.setRotation(r.rotation),a.rotation=l.getRotation(),r.flipHorizontally!==void 0&&l.setFlipHorizontally(r.flipHorizontally),r.flipVertically!==void 0&&l.setFlipVertically(r.flipVertically),o?(l.setSizeInWorldSpace(r.size),this.stickerToolStore.updateStateFromHistory(e,o)):s?this.textToolStore.updateStateFromHistory(e,b(b({},s),{fontIdentifier:s.identifier})):n&&this.textDesignToolStore.updateStateFromHistory(e,b(b({},n),{inverted:n.isInverted})),this.updatePositionAndSize(e)}})});this.getSpriteHistoryState=()=>{let t=at(this.state),e=at(this.textToolStore.state),r=at(this.textDesignToolStore.state),o={common:t,[C.STICKER]:at(this.stickerToolStore.state),[C.TEXT]:e,[C.TEXT_DESIGN]:r,spriteIdList:Object.keys(this.container)};return Object.keys(o.common).forEach(s=>{o.common[s].size=this.container[s].getSizeInWorldSpace(),o.common[s].position=this.container[s].getPosition(),o.common[s].order=this.container[s].getIndexInParent()}),o};this.updateStateFromSerialization=(t,e)=>K(this,null,function*(){if(e&&e.length)try{let r=yield Promise.all(e.map(l=>K(this,[l],function*({svg:o,raster:s,name:n,identifier:a}){let c=(o==null?void 0:o.data)?ir.SVG:s.type,d=`data:${c};base64,${(o==null?void 0:o.data)||s.data}`,u=yield e_(d,150);return{stickerURI:d,thumbnailURI:u,name:n,type:c,identifier:a}})));yield this.stickerToolStore.addCustomStickerAsset(r)}catch(r){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}for(let r=0;r<t.spriteIdList.length;r+=1){let o=t.spriteIdList[r],s=t.common?t.common[o]:void 0,n=t.sticker?t.sticker[o]:void 0,a=t.text?t.text[o]:void 0,l=t.textdesign?t.textdesign[o]:void 0;if(s){let{size:c}=s;c&&(c={width:this.editor.worldToPreview(s.size.width),height:this.editor.worldToPreview(s.size.height)});let{flipHorizontally:d,flipVertically:u}=this.editor.outputContainer.getData(),m=this.editor.outputContainer.getRotation(),p=u!==d?s.rotation-m:s.rotation+m,f=u!==d?-p:p,v={spriteId:o,transform:{size:c,position:s.position,rotation:f}};if(a){let x=this.textToolStore.validFontWithConfig(a.identifier);a.identifier=x==null?void 0:x.identifier,yield this.addNewText(v,a)}else l?yield this.addNewTextDesign(v,l):n&&(yield this.addNewSticker(v,b(b({},n),{flipHorizontally:s.flipHorizontally,flipVertically:s.flipVertically})))}}});this.serializableState=()=>K(this,null,function*(){let t=this.editor.spriteStore.getSpriteHistoryState();Object.keys(t.common).forEach(r=>{let{flipHorizontally:o,flipVertically:s}=this.editor.outputContainer.getData(),n=this.editor.outputContainer.getRotation(),a=s!==o?-t.common[r].rotation:t.common[r].rotation;t.common[r].rotation=s!==o?a+n:a-n});let e=yield Promise.all(this.editor.spriteStore.stickerToolStore.customStickers.map(a=>K(this,[a],function*({identifier:r,type:o,stickerURI:s,name:n}){let l={identifier:r,name:n,raster:{data:"",type:ir.JPEG}};if(o===ir.SVG&&(l.svg={data:s.split(",")[1]}),o===ir.JPEG||o===ir.PNG)[,l.raster.data]=s.split(","),l.raster.type=o;else{let c=yield e_(s);[,l.raster.data]=c.split(","),l.raster.type=ir.PNG}return l})));return{sprite:t,customStickers:e}});this.updateCanvasControls=()=>{Object.keys(this.container).forEach(t=>{this.updatePositionAndSize(t,!0);let e=this.state.get(t);if(e){if(e.tool===C.TEXT){let r=this.getContainerProperties(t);this.textToolStore.changeSize(t,r)}else if(e.tool===C.TEXT_DESIGN){let r=this.getContainerProperties(t);this.textToolStore.changeWidth(r.width)}}})};this.setEditMode=t=>{this.currentSprite&&[C.TEXT,C.TEXT_DESIGN].indexOf(this.tool)!==-1&&(t?this.editor.modalStore.showTextEditModal():this.editor.modalStore.hideModal(),this.editMode.set(t))};this.setDragMode=t=>{this.dragMode.set(t)};this.setPosition=t=>{let e=this.currentSprite,r=this.container[this.id];if(e&&r){r.setPosition(this.editor.previewToWorld(t));let{position:o}=this.getSizePositionFromContainer();e.position.x=o.x,e.position.y=o.y,this.state.set(this.id,e),this.editor.render()}};this.setSize=t=>{let e=this.currentSprite;e&&(e.size.width=t.width,e.size.height=t.height,this.state.set(this.id,e))};this.setRotation=t=>{let e=this.currentSprite;if(e){let{flipHorizontally:r,flipVertically:o}=this.editor.outputContainer.getData(),s=this.editor.outputContainer.getRotation(),n=Sm({rotation:t+s,flipHorizontally:r,flipVertically:o});this.container[this.id].setRotation(n),e.rotation=this.container[this.id].getRotation(),this.state.set(this.id,e),this.editor.render()}};this.onCanvasClick=t=>{this.isEditMode||this.selectHighestOrderSprite(t)};this.select=t=>{let e=this.state.get(t);e&&(this.editor.activeStore.tool!==e.tool&&this.editor.activeStore.selectTool(e.tool),this.selectedId.set(t))};this.selectLast=()=>{let t=this.editor.orderHelper.getLastSpriteId();t&&this.select(t)};this.selectNext=()=>{if(this.currentSprite){let e=this.container[this.id].getIndexInParent();if(e){let r=Object.keys(this.container).find(o=>this.container[o].getIndexInParent()===e-1);r&&this.select(r)}}};this.deselect=()=>{this.selectedId.set(i_)};this.bringToFront=t=>{let e=this.editor.orderHelper.bringToFront(t);this.container[t].setIndexInParent(e),this.spriteSnapshot("order"),this.editor.render()};this.flipHorizontally=t=>{let e=this.state.get(t),r=this.container[t];r.setFlipHorizontally(!r.getFlipHorizontally()),e.flipHorizontally=r.getFlipHorizontally(),this.spriteSnapshot("flip"),this.state.set(t,e),this.editor.render()};this.pureReset=()=>{this.selectedId.set(i_),Array.from(this.state.keys()).forEach(t=>{this.pureRemoveSprite(t)}),this.stickerToolStore.pureReset(),this.textToolStore.pureReset(),this.textDesignToolStore.pureReset()};this.selectHighestOrderSprite=t=>{let e=this.editor.brushToolStore.containerId();if(t=t.filter(s=>s!==e),t.length<1){this.deselect();return}let r="",o=0;t.forEach(s=>{let n=this.container[s],a=n&&n.getIndexInParent()||0;a>=o&&(o=a,r=s)}),this.select(r)};this.onCornerDrag=({x:t,y:e})=>{if(this.currentSprite){let r=new R(this.currentSprite.position),o=new R(t,e),s=o.subtract(r).magnitude,n=this.getSize(),a=s*2/Em.sizeMagnitude(n);if(s>this.minLength)if(this.isSpriteSticker)if(this.stickerToolStore.resizeMode!=="unrestricted")this.setStickerSize({width:n.width*a,height:n.height*a});else{let l=this.rotationWRTOutputRotation,c=o.subtract(r),d=Math.cos(l),u=Math.sin(l),m=Math.max(Math.abs(c.x*d*2+c.y*u*2),this.minLength),p=Math.max(Math.abs(c.x*-u*2+c.y*d*2),this.minLength);this.setStickerSize({width:m,height:p})}else this.isSpriteText?this.setTextSize(n.width*a):this.isSpriteTextDesign&&this.setTextDesignScale(a);this.editor.render()}};this.onWidthDrag=({x:t,y:e})=>{let r=new R(this.currentSprite.position),s=new R(t,e).subtract(r).magnitude,n=this.editor.previewToWorld(2*s);if(n>this.minLength&&(this.setContainerProperties(this.id,{width:n},!0),this.isSpriteText)){let a=this.getContainerProperties(this.id);this.textToolStore.changeWidth(a.width)}};this.onPaddingDrag=({x:t,y:e})=>{if(this.isSpriteTextDesign){let r=this.getContainerProperties(this.id),o=new R(this.currentSprite.position),n=new R(t,e).subtract(o).magnitude,a=Math.max(this.editor.previewToWorld(n)-r.width/2,0);this.setContainerProperties(this.id,{padding:a},!0),this.isSpriteTextDesign&&(r=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(r.padding))}};this.correctTextFlip=()=>{let{flipHorizontally:t,flipVertically:e}=this.editor.outputContainer.getData();Object.values(this.container).forEach(r=>{(r.type==="text"||r.type==="text-design")&&(r.setFlipHorizontally(t),r.setFlipVertically(e))})};this.reverseTextHorizontally=()=>{Object.values(this.container).forEach(t=>{(t.type==="text"||t.type==="text-design")&&t.setFlipHorizontally(!t.getFlipHorizontally())})};this.reverseTextVertically=()=>{Object.values(this.container).forEach(t=>{(t.type==="text"||t.type==="text-design")&&t.setFlipVertically(!t.getFlipVertically())})};this.getOutputProperties=()=>this.editor.outputContainer.getData();this.getContainerProperties=t=>this.container[t].getData();this.getContainerTransform=t=>this.container[t].getTransform();this.getDuplicateContainerTransform=t=>{let e=this.container[t].getTransform(),r=this.editor.shortestOutputSide*.1,o=new R(e.position).add(new R(r,r));return b(b({},e),{position:o})};this.getDuplicateContainerFlip=t=>{let e=this.container[t].getFlipHorizontally(),r=this.container[t].getFlipVertically();return{flipHorizontally:e,flipVertically:r}};this.updatePositionAndSize=(t=this.id,e=!1)=>{let{position:r,size:o}=this.getSizePositionFromContainer(t),s=this.state.get(t);if(s){if(s.position.x=r.x,s.position.y=r.y,s.size.width=o.width,s.size.height=o.height,e){let n=this.container[t].getRotation();this.container[t].setRotation(n),s.rotation=this.container[t].getRotation()}this.state.set(t,s)}};this.getInitialTransform=t=>{let e=this.editor.outputToWorld(yU.position);return t?b({position:e},t):{rotation:this.editor.outputContainer.getRotation(),position:e}};this.setInitialSpriteState=(t,e)=>{let r=this.container[t],{position:o,size:s}=this.getSizePositionFromContainer(t),n=r.getRotation(),a=e!==C.STICKER?!1:r.getFlipHorizontally(),l=e!==C.STICKER?!1:r.getFlipVertically();this.state.set(t,{tool:e,position:o,rotation:n,size:s,flipHorizontally:a,flipVertically:l})};this.setStickerSize=t=>{let e=this.container[this.id];e.setSizeInWorldSpace(this.editor.previewSizeToWorld(t));let r=this.currentSprite;r&&(r.size=this.editor.worldSizeToPreview(e.getSizeInWorldSpace()),this.state.set(this.id,r))};this.setTextSize=t=>{let e=this.getContainerProperties(this.id),r={width:this.editor.previewToWorld(t)},o=r.width/e.width,s={fontSize:Math.round(e.fontSize*o)},n=this.isSpriteText?b(b({},r),s):r;r.width>this.minLength&&s.fontSize&&(this.setContainerProperties(this.id,n,!0),e=this.getContainerProperties(this.id),this.textToolStore.changeFontSize(e.fontSize,!0),this.textToolStore.changeWidth(e.width))};this.setTextDesignScale=t=>{let e=this.getContainerProperties(this.id),r=e.width*t;if(r>this.minLength){this.setContainerProperties(this.id,{width:r},!0);let{width:o}=this.getContainerProperties(this.id);this.textDesignToolStore.changeWidth(o),e=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(e.padding)}};this.getSizePositionFromContainer=(t=this.id)=>{let e=this.container[t];if(e){let r=this.editor.worldToPreview(e.getPosition()),o=this.editor.worldSizeToPreview(e.getSizeInWorldSpace());return{position:r,size:o}}return{position:{x:0,y:0},size:{height:1,width:1}}};this.getSize=(t=this.id)=>{let e=this.container[t];return e?this.editor.worldSizeToPreview(e.getSizeInWorldSpace()):{width:0,height:0}};this.editor=t,this.container={},this.stickerToolStore=new Lt(t),this.textToolStore=new yt(t),this.textDesignToolStore=new Bt(t),this.rect=new Fe(this.editor,this),this.minLength=this.editor.configStore.measurements.canvasControls.sprite.minSize/Math.sqrt(2)}static magnitude(t,e){return new R(t,e||t).magnitude}static sizeMagnitude(t){return Math.sqrt(t.width*t.width+t.height*t.height)}get currentSprite(){if(this.isSpriteSelected)return this.state.get(this.id)}get padding(){return this.textDesignToolStore.padding}get isEditMode(){return this.editMode.get()}get isDragMode(){return this.dragMode.get()}get id(){return this.selectedId.get()}get isSpriteSelected(){return this.id!==i_}get position(){if(this.currentSprite)return this.currentSprite.position}get tool(){if(this.currentSprite)return this.currentSprite.tool}get size(){if(this.currentSprite)return this.currentSprite.size}get rotation(){if(this.currentSprite)return this.currentSprite.rotation}get rotationWRTOutputRotation(){if(this.currentSprite){let{flipHorizontally:t,flipVertically:e}=this.editor.outputContainer.getData(),r=this.editor.outputContainer.getRotation();return Sm({rotation:this.currentSprite.rotation-r,flipHorizontally:t,flipVertically:e})}}get flipHorizontal(){if(this.currentSprite)return this.currentSprite.flipHorizontally}get isSpriteSticker(){return this.tool===C.STICKER}get isSpriteText(){return this.tool===C.TEXT}get isSpriteTextDesign(){return this.tool===C.TEXT_DESIGN}get spritePosition(){if(this.currentSprite){let{x:t,y:e}=this.currentSprite.position,{height:r,width:o}=this.currentSprite.size;return{x:Math.round(t-o/2),y:Math.round(e-r/2)}}}get currentRect(){if(this.currentSprite)return this.rect}get leftTopPosition(){if(this.currentSprite)return this.rect.leftTop}get leftBottomPosition(){if(this.currentSprite)return this.rect.leftBottom}get leftMidPosition(){if(this.currentSprite)return this.rect.leftMid}get leftMidPadPosition(){if(this.currentSprite){let{leftMid:t}=this.rect;return{x:t.x-this.editor.worldToPreview(this.padding),y:t.y}}}get rightTopPosition(){if(this.currentSprite)return this.rect.rightTop}get rightBottomPosition(){if(this.currentSprite)return this.rect.rightBottom}get rightMidPosition(){if(this.currentSprite)return this.rect.rightMid}get rightMidPadPosition(){if(this.currentSprite){let{rightMid:t}=this.rect;return{x:t.x+this.editor.worldToPreview(this.padding),y:t.y}}}get leftBottomHandlePosition(){if(this.currentSprite)return this.rect.leftBottomHandle}get rightBottomHandlePosition(){if(this.currentSprite)return this.rect.rightBottomHandle}get historyLocale(){return this.isSpriteSticker?this.stickerLocale:this.isSpriteText?this.textDesignLocale:this.textLocale}get stickerLocale(){return this.editor.configStore.locale[C.STICKER].history}get textLocale(){return this.editor.configStore.locale[C.TEXT].history}get textDesignLocale(){return this.editor.configStore.locale[C.TEXT_DESIGN].history}},J=Em;h([w],J.prototype,"addSticker",2),h([w],J.prototype,"addStickerAsync",2),h([w],J.prototype,"addText",2),h([w],J.prototype,"addTextAsync",2),h([w],J.prototype,"addTextDesign",2),h([w],J.prototype,"addTextDesignAsync",2),h([w],J.prototype,"clickableCanvas",2),h([w],J.prototype,"setContainerProperties",2),h([w],J.prototype,"setContainerPosition",2),h([w],J.prototype,"pureRemoveSprite",2),h([w],J.prototype,"deleteSprite",2),h([w],J.prototype,"removeSprite",2),h([w],J.prototype,"addSnapshot",2),h([w],J.prototype,"updateStateFromHistory",2),h([w],J.prototype,"addNewText",2),h([w],J.prototype,"addNewTextDesign",2),h([w],J.prototype,"addNewSticker",2),h([w],J.prototype,"updateSpriteStateFromHistory",2),h([w],J.prototype,"updateStateFromSerialization",2),h([w],J.prototype,"updateCanvasControls",2),h([w],J.prototype,"setEditMode",2),h([w],J.prototype,"setDragMode",2),h([w],J.prototype,"setPosition",2),h([w],J.prototype,"setSize",2),h([w],J.prototype,"setRotation",2),h([w],J.prototype,"onCanvasClick",2),h([w],J.prototype,"select",2),h([w],J.prototype,"selectLast",2),h([w],J.prototype,"selectNext",2),h([w],J.prototype,"deselect",2),h([w],J.prototype,"bringToFront",2),h([w],J.prototype,"flipHorizontally",2),h([w],J.prototype,"pureReset",2),h([w],J.prototype,"onCornerDrag",2),h([w],J.prototype,"onWidthDrag",2),h([w],J.prototype,"onPaddingDrag",2),h([w],J.prototype,"correctTextFlip",2),h([w],J.prototype,"reverseTextHorizontally",2),h([w],J.prototype,"reverseTextVertically",2),h([S],J.prototype,"currentSprite",1),h([S],J.prototype,"padding",1),h([S],J.prototype,"isEditMode",1),h([S],J.prototype,"isDragMode",1),h([S],J.prototype,"id",1),h([S],J.prototype,"isSpriteSelected",1),h([S],J.prototype,"position",1),h([S],J.prototype,"tool",1),h([S],J.prototype,"size",1),h([S],J.prototype,"rotation",1),h([S],J.prototype,"rotationWRTOutputRotation",1),h([S],J.prototype,"flipHorizontal",1),h([S],J.prototype,"isSpriteSticker",1),h([S],J.prototype,"isSpriteText",1),h([S],J.prototype,"isSpriteTextDesign",1),h([S],J.prototype,"spritePosition",1),h([S],J.prototype,"currentRect",1),h([S],J.prototype,"leftTopPosition",1),h([S],J.prototype,"leftBottomPosition",1),h([S],J.prototype,"leftMidPosition",1),h([S],J.prototype,"leftMidPadPosition",1),h([S],J.prototype,"rightTopPosition",1),h([S],J.prototype,"rightBottomPosition",1),h([S],J.prototype,"rightMidPosition",1),h([S],J.prototype,"rightMidPadPosition",1),h([S],J.prototype,"leftBottomHandlePosition",1),h([S],J.prototype,"rightBottomHandlePosition",1),h([S],J.prototype,"historyLocale",1),h([S],J.prototype,"stickerLocale",1),h([S],J.prototype,"textLocale",1),h([S],J.prototype,"textDesignLocale",1);var co={position:{x:0,y:0},size:{height:0,width:0},lockResolution:!1,forceDimensions:!1,ratio:"*"},wF={identifier:"identity",outputRotation:0,rotationInDegrees:0,flipHorizontally:!1,flipVertically:!1,cropState:Y.map({})};var Pt=class{constructor(t,e){this.minCropSize=0;this.state=wF,this.configStore=t.configStore,this.minCropSize=this.configStore.measurements.crop.minSize,this.defaults=e}changeIdentifier(t){this.state.identifier=t,this.state.cropState.get(t)||this.state.cropState.set(t,b({},co))}changeRatio(t){let e=this.state.cropState.get(this.identifier);e&&this.state.cropState.set(this.identifier,b(b({},e),{ratio:t}))}changeSize(t){let e=this.state.cropState.get(this.identifier);e&&(t.width&&t.width>0&&(e.size.width=Math.round(t.width)),t.height&&t.height>0&&(e.size.height=Math.round(t.height)),this.state.cropState.set(this.identifier,e))}changeHeight(t){let e=this.state.cropState.get(this.identifier);e&&t&&(e.size.height=Math.round(t),this.state.cropState.set(this.identifier,e))}changeWidth(t){let e=this.state.cropState.get(this.identifier);e&&t&&(e.size.width=Math.round(t),this.state.cropState.set(this.identifier,e))}changePositionX(t,e){let r=this.state.cropState.get(this.identifier);return r&&t<=e-this.minCropSize&&t>=0?(r.position.x=Math.round(t),this.state.cropState.set(this.identifier,r),!0):!1}changePositionY(t,e){let r=this.state.cropState.get(this.identifier);return r&&t<=e-this.minCropSize&&t>=0?(r.position.y=Math.round(t),this.state.cropState.set(this.identifier,r),!0):!1}changePosition(t,e){let r=this.state.cropState.get(this.identifier);return r&&t.x<=e.width-this.minCropSize&&t.x>=0&&t.y<=e.height-this.minCropSize&&t.y>=0?(r.position.x=Math.round(t.x),r.position.y=Math.round(t.y),this.state.cropState.set(this.identifier,r),!0):!1}changeLockResolution(t){let e=this.state.cropState.get(this.identifier);e&&(e.lockResolution=t!==void 0?t:!e.lockResolution,this.state.cropState.set(this.identifier,e))}changeForceDimensions(t){let e=this.state.cropState.get(this.identifier);e&&(e.forceDimensions=t,this.state.cropState.set(this.identifier,e))}setRotation(t){this.state.rotationInDegrees=t}resetRotation(){this.state.rotationInDegrees=0}resetOutputRotation(){this.state.outputRotation=0}resetFlip(){this.state.flipHorizontally=!1,this.state.flipVertically=!1}updateFlip({flipHorizontally:t,flipVertically:e}){this.state.flipHorizontally=t,this.state.flipVertically=e}setOutputRotation(t){this.state.outputRotation=t}flipHorizontally(){this.state.flipHorizontally=!this.state.flipHorizontally}flipVertically(){this.state.flipVertically=!this.state.flipVertically}get flipCenter(){let{width:t,height:e}=this.defaults.maxCropMaskSize;return new R(t/2,e/2)}get isFlippedHorizontal(){return this.state.flipHorizontally}get isFlippedVertical(){return this.state.flipVertically}get identifier(){return this.state.identifier}get height(){return this.selectedCrop?this.selectedCrop.size.height:co.size.height}get width(){return this.selectedCrop?this.selectedCrop.size.width:co.size.width}get position(){return this.selectedCrop?this.selectedCrop.position:co.position}get ratio(){return this.selectedCrop?this.selectedCrop.ratio:co.ratio}get size(){return this.selectedCrop?this.selectedCrop.size:co.size}get x(){return this.selectedCrop?this.selectedCrop.position.x:co.position.x}get y(){return this.selectedCrop?this.selectedCrop.position.y:co.position.y}get lockResolution(){return this.selectedCrop?this.selectedCrop.lockResolution:co.lockResolution}get forceDimensions(){return this.selectedCrop?this.selectedCrop.forceDimensions:co.forceDimensions}get selectedCrop(){return this.state.cropState.get(this.identifier)}get rotationInDegrees(){return this.state.rotationInDegrees}get outputRotation(){return this.state.outputRotation}};h([Y],Pt.prototype,"state",2),h([w],Pt.prototype,"changeIdentifier",1),h([w],Pt.prototype,"changeRatio",1),h([w],Pt.prototype,"changeSize",1),h([w],Pt.prototype,"changeHeight",1),h([w],Pt.prototype,"changeWidth",1),h([w],Pt.prototype,"changePositionX",1),h([w],Pt.prototype,"changePositionY",1),h([w],Pt.prototype,"changePosition",1),h([w],Pt.prototype,"changeLockResolution",1),h([w],Pt.prototype,"changeForceDimensions",1),h([w],Pt.prototype,"setRotation",1),h([w],Pt.prototype,"resetRotation",1),h([w],Pt.prototype,"resetOutputRotation",1),h([w],Pt.prototype,"resetFlip",1),h([w],Pt.prototype,"updateFlip",1),h([w],Pt.prototype,"setOutputRotation",1),h([w],Pt.prototype,"flipHorizontally",1),h([w],Pt.prototype,"flipVertically",1),h([S],Pt.prototype,"flipCenter",1),h([S],Pt.prototype,"isFlippedHorizontal",1),h([S],Pt.prototype,"isFlippedVertical",1),h([S],Pt.prototype,"identifier",1),h([S],Pt.prototype,"height",1),h([S],Pt.prototype,"width",1),h([S],Pt.prototype,"position",1),h([S],Pt.prototype,"ratio",1),h([S],Pt.prototype,"size",1),h([S],Pt.prototype,"x",1),h([S],Pt.prototype,"y",1),h([S],Pt.prototype,"lockResolution",1),h([S],Pt.prototype,"forceDimensions",1),h([S],Pt.prototype,"selectedCrop",1),h([S],Pt.prototype,"rotationInDegrees",1),h([S],Pt.prototype,"outputRotation",1);var BC=class{constructor(t){this.transforms={output:JSON.stringify(qt.IDENTITY),preview:JSON.stringify(qt.IDENTITY)};this.editor=t,this.overlayOpacity=0,this.frameOpacity=0}static rotateOutput(t,e){switch(t%=360,t){case 90:case-270:return e.swapped.multiply(-1,1);case 180:case-180:return e.multiply(-1);case 270:case-90:return e.swapped.multiply(1,-1);default:return e}}onLeave(){let{flipHorizontally:t,flipVertically:e,rotation:r,outputRotation:o}=this.transformToolStore.rotateFlipState;this.editor.overlayToolStore.identifier!=="identity"&&this.editor.overlayToolStore.changeOpacity(this.overlayOpacity),this.editor.frameToolStore.identifier!=="identity"&&this.editor.frameToolStore.changeOpacity(this.frameOpacity);let s=this.editor.previewToWorld(new R(this.transformToolStore.leftTopRespectFlip).add(new R(this.transformToolStore.rightBottomRespectFlip)).divide(2).add(new R(this.transformToolStore.unRotatedDefaults.cropMaskPosition)),!0),n=this.engineMediator.preview.container,{outputContainer:a}=this.editor;a.setResolution(at(this.transformToolStore.localOutputImageSize)),a.setData({flipVertically:e,flipHorizontally:t});let l=n.getScale();this.editor.overlayToolStore.correctOverlayFlip(),this.saveTransforms();let c=1;if(this.transformToolStore.lockResolution){let{cropMaskSize:f,defaultImageSize:v}=this.transformToolStore,x=this.transformToolStore.maxCropMaskSize;c={height:f.height*v.height/x.height,width:f.width*v.width/x.width}.width/this.transformToolStore.localOutputImageSize.width}let d=Math.abs(l.x),u=c/(d/this.transformToolStore.defaultScale),m={x:u,y:u},p=-(r-o);a.setTransform({scale:m,position:s,rotation:p}),this.editor.engineMediator.preview.updateTransform(0,!1),this.editor.scale.setInitialTransform(),this.editor.spriteStore.updateCanvasControls(),this.editor.focusToolStore.updateCanvasControls()}onEnter(){this.editor.overlayToolStore.identifier!=="identity"&&(this.overlayOpacity=this.editor.overlayToolStore.opacity,this.editor.overlayToolStore.changeOpacity(0)),this.editor.frameToolStore.identifier!=="identity"&&(this.frameOpacity=this.editor.frameToolStore.opacity,this.editor.frameToolStore.changeOpacity(0)),this.editor.scale.setScaleToDefault();let t=this.engineMediator.preview.container,{outputContainer:e}=this.editor,r=JSON.parse(this.transforms.preview);e.setResolution(at(this.transformToolStore.defaultImageSize)),t.setTransform(r),e.setTransform(JSON.parse(this.transforms.output));let o=r.scale;e.setData({flipVertically:!1,flipHorizontally:!1}),this.transformToolStore.transformStore.updateFlip({flipVertically:o.y<0,flipHorizontally:o.x<0}),this.engineMediator.preview.savePreviewTransform(r);let{scale:s}=this.engineMediator.preview.calculateTransform();this.editor.scale.setInitialTransform(s.x)}rotateOutputContainer(t=!1){this.editor.outputContainer.rotate90(t),this.transformToolStore.transformStore.setOutputRotation(this.editor.outputContainer.getRotation());let{rotation:e}=this.transformToolStore.rotateFlipState;this.engineMediator.preview.updateTransform(e),Me(()=>{this.editor.scale.setInitialTransform();let r=this.getScaleWithFlip(e);this.engineMediator.preview.container.setScale(r),this.transformToolStore.setCropDefaults(!0),this.transformToolStore.updateCropMask()}),this.editor.render()}applyPreviewTransform(){let{rotation:t,flipHorizontally:e,flipVertically:r}=this.transformToolStore.rotateFlipState,o=this.editor.scale.getPositionWithOffset(),s=this.getScaleWithFlip(),n=t;e&&(n=td(n)),r&&(n=td(n));let a={position:o,rotation:n,scale:s};this.engineMediator.preview.savePreviewTransform(a),this.engineMediator.preview.container.setTransform(a)}getScaleWithFlip(t=this.transformToolStore.rotateFlipState.rotation){let{flipHorizontally:e,flipVertically:r}=this.transformToolStore.rotateFlipState,o=e?-1:1,s=r?-1:1,n=this.editor.scale.calculateScale(t);return{x:n*o,y:n*s}}saveTransforms(){let t=JSON.stringify(this.engineMediator.preview.container.getTransform()),e=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:t,output:e}}saveTransformsBasedOnFlip(){let t=this.engineMediator.preview.container.getTransform(),{scale:e}=t,{flipVertically:r,flipHorizontally:o}=this.editor.outputContainer.getData(),s=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:JSON.stringify(b(b({},t),{scale:{x:o?-e.x:e.x,y:r?-e.y:e.y}})),output:s}}get engineMediator(){return this.editor.engineMediator}get transformToolStore(){return this.editor.transformToolStore}};var kF="identity",kl=class{constructor(t){this.unRotatedDefaults={cropMaskPosition:{x:0,y:0},scale:1};this.defaultAngle=0;this.dragMode=Y.box(!1);this.minCropSize=0;this.localSnapshotEnabled=!0;this.defaults={cropMaskPosition:{x:0,y:0},maxCropMaskSize:{width:0,height:0},imageSize:{width:0,height:0},scale:1};this.localOutputSize={width:0,height:0};this.checkIfTransformThumbnailExits=t=>{let e=this.editor.configStore.config.assetBaseUrl,{length:r}=e;if(e[r-1]!=="/"&&(e+="/"),`${e}transform/`===t)return!1;let o=new Image;try{return o.src=t,!0}catch(s){return!1}};this.reset=()=>{this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.setDefaultAngle(0),this.editor.outputContainer.getRotation()!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop(),this.editor.render()};this.changeLocalOutputSize=t=>{this.localOutputSize.height=Math.round(t.height),this.localOutputSize.width=Math.round(t.width)};this.changeDefaultScale=t=>{this.defaults.scale=t};this.changeLocalOutputHeight=t=>{this.localOutputSize.height=Math.round(t)};this.changeLocalOutputWidth=t=>{this.localOutputSize.width=Math.round(t)};this.changeLockResolution=()=>{this.transformStore.changeLockResolution(),this.addLocalSnapshot()};this.rotateClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical!==this.isFlippedHorizontal)};this.rotateAntiClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical===this.isFlippedHorizontal)};this.flipHorizontally=(t=!0)=>{this.transformStore.flipHorizontally(),this.editor.spriteStore.reverseTextHorizontally(),this.transformRender(t),t&&this.addLocalSnapshot()};this.flipVertically=(t=!0)=>{this.transformStore.flipVertically(),this.editor.spriteStore.reverseTextVertically(),this.transformRender(t),t&&this.addLocalSnapshot()};this.applyDefaultCrop=(t=!1)=>{if(this.identifier==="identity"){let{identifier:e}=this.getMatchingItem();this.changeIdentifier(e,t)}};this.updateCropMask=()=>{this.changeIdentifier(this.identifier,!0)};this.onLeftTop=({x:t,y:e})=>{let r=this.getRatio(),o=this.rightBottom,{minCropMaskSize:s,maxCropMaskSize:n}=this,a=Math.min(Math.max(0,t),o.x-s.width),l=Math.min(Math.max(0,e),o.y-s.height),c=o.x-a,d=o.y-l,u={width:Math.max(this.minCropSize,Math.min(c,n.width-a)),height:Math.max(this.minCropSize,Math.min(d,n.height-l))};if(r==="*")this.changePosition({x:a,y:l})&&this.changeCropAndOutputSize(u);else{let m=this.proportionalSize(r,u),p=new R(o).rounded.subtract({x:m.width,y:m.height});this.changePosition(p)&&this.changeCropAndOutputSize(m)}};this.onLeftBottom=({x:t,y:e})=>{let r=this.getRatio(),o=this.rightTop,{minCropMaskSize:s,maxCropMaskSize:n}=this,a=Math.min(Math.max(0,t),o.x-s.width),l=Math.max(0,e,o.y+s.height),c=o.x-a,d=l-o.y,u={width:Math.max(1,Math.min(c,n.width-a)),height:Math.max(1,Math.min(d,n.height-o.y))};if(r==="*")this.changeCropAndOutputSize(u)&&this.changePositionX(a);else{let m=this.proportionalSize(r,u);this.changePositionX(Math.round(o.x)-m.width)&&this.changeCropAndOutputSize(m)}};this.onRightTop=({x:t,y:e})=>{let r=this.getRatio(),o=this.leftBottom,{minCropMaskSize:s,maxCropMaskSize:n}=this,a=Math.max(0,t,o.x+s.width),l=Math.min(Math.max(0,e),o.y-s.height),c=a-o.x,d=o.y-l,u={width:Math.max(1,Math.min(c,n.width-o.x)),height:Math.max(1,Math.min(d,n.height-l))};if(r==="*")this.changePositionY(l)&&this.changeCropAndOutputSize(u);else{let m=this.proportionalSize(r,u);this.changePositionY(Math.round(o.y)-m.height)&&this.changeCropAndOutputSize(m)}};this.onRightBottom=({x:t,y:e})=>{let r=this.getRatio(),o=this.leftTop,{minCropMaskSize:s,maxCropMaskSize:n}=this,a=Math.max(0,t,o.x+s.width),l=Math.max(0,e,o.y+s.height),c=a-o.x,d=l-o.y,u={width:Math.max(1,Math.min(c,n.width-o.x)),height:Math.max(1,Math.min(d,n.height-o.y))};if(r==="*")this.changeCropAndOutputSize(u);else{let m=this.proportionalSize(r,u);this.changeCropAndOutputSize(m)}};this.onPixelWidth=t=>{let e=JSON.stringify(at(this.localOutputSize)),r=this.entityManager.items.find(s=>s.identifier===this.identifier),o=this.defaults.imageSize;if(r&&r.ratio){let s=t,n=this.localOutputSize.height,{ratio:a}=r;if(a==="*"&&this.lockResolution&&(a=this.localOutputSize.width/this.localOutputSize.height),a==="*"&&!this.lockResolution)s=Math.max(Math.min(t,o.width),this.minCropSize),this.changeLocalOutputWidth(s);else{let l=kl.placeCropMask(a,o);s=Math.max(Math.min(s,l.width),this.minCropSize),n=s/a,this.changeLocalOutputSize({height:n,width:s})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(e)),Math.round(s)}return t};this.onPixelHeight=t=>{let e=JSON.stringify(at(this.localOutputSize)),r=this.entityManager.items.find(s=>s.identifier===this.identifier),o=this.defaults.imageSize;if(r&&r.ratio){let s=t,n=this.localOutputSize.width,{ratio:a}=r;if(a==="*"&&this.lockResolution&&(a=this.localOutputSize.width/this.localOutputSize.height),a==="*"&&!this.lockResolution)s=Math.max(Math.min(t,o.height),this.minCropSize),this.changeLocalOutputHeight(s);else{let l=kl.placeCropMask(a,o);s=Math.max(Math.min(s,l.height),this.minCropSize),n=s*a,this.changeLocalOutputSize({height:s,width:n})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(e)),Math.round(s)}return t};this.closestRatioReducer=t=>(e,r)=>r===null||Math.abs(t-e.ratio)<Math.abs(t-r.ratio)?-1:1;this.closestDimensionsReducer=t=>(e,r)=>{if(r===null)return-1;let o=Math.abs(e.dimensions.x/e.dimensions.y),s=Math.abs(r.dimensions.x/r.dimensions.y);return o===s?e.dimensions.x*e.dimensions.y>r.dimensions.x*r.dimensions.y?-1:1:Math.abs(t-o)<Math.abs(t-s)?-1:1};this.getMatchingItem=()=>{let t=this.entityManager.items.findIndex(l=>l.identifier==="imgly_transform_common_custom");if(t!==-1)return this.entityManager.items[t];let e=this.entityManager.items.findIndex(l=>l.ratio==="*");if(e!==-1)return this.entityManager.items[e];let r=at(this.editor.outputContainer.getResolution()),o=Math.abs(r.width/r.height),[s]=this.entityManager.items.filter(l=>l.ratio&&typeof l.ratio=="number").sort(this.closestRatioReducer(o)),[n]=this.entityManager.items.filter(l=>l.dimensions&&!l.ratio).sort(this.closestDimensionsReducer(o));if(!s||!n||!s.ratio&&!n.dimensions)return this.entityManager.items[0];if(!n||!n.dimensions)return s;if(!s||!s.ratio)return n;let a=Math.abs(n.dimensions.x/n.dimensions.y);return a===s.ratio||Math.abs(o-s.ratio)<Math.abs(o-a)?s:n};this.getTransform=t=>{let e=this.entityManager.items.find(r=>r.identifier===t);return e||(e=this.getMatchingItem()),e};this.editor=t,this.selectedCategory=kF,this.transformStore=new Pt(t,this.defaults),this.transformations=new BC(t);let n=this.config,{enableRotation:e,enableFlip:r}=n,o=_i(n,["enableRotation","enableFlip"]),s=this.editor.assetProvider.getAssets("transform");this.entityManager=new Pe(s,b(b({},o),{categoryKey:"",itemKey:"thumbnailURI",locale:b(b({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("transform")})),this.rect=new Fe(this.editor,this.transformStore,"topLeft",!1,!1),this.rectForUi=new Fe(this.editor,this.transformStore,"topLeft",!1,!0),this.minCropSize=this.editor.configStore.measurements.crop.minSize}static inRadians(t){return t*Math.PI/180}static placeCropMask(t,e){if(e.height*t>e.width)return{height:e.width/t,width:e.width,yChanged:!0};let r=e.height*t;return{height:e.height,width:r,yChanged:!1}}changeIdentifier(t,e=!1){this.transformStore.changeIdentifier(t);let r=this.getCropMask(t,this.defaults.imageSize);r&&(this.transformStore.changeRatio(r.ratio),this.changeLocalOutputSize(r),this.updatePreviewSizeWRTImageSize(),r.yChanged!==void 0&&this.updateInitialCropMaskPosition(r.yChanged),r.dimensions&&this.changeLocalOutputSize({width:r.dimensions.x,height:r.dimensions.y}),e&&this.addLocalSnapshot())}setDragMode(t){this.dragMode.set(t)}getCropMask(t,e){let r=this.getTransform(t);if(r){let{ratio:o,forceDimensions:s,lockDimensions:n,dimensions:a=null}=r;if(s&&this.transformStore.changeForceDimensions(s),n&&this.transformStore.changeLockResolution(n),o)switch(o){case"*":return this.changePosition({x:0,y:0}),b(b({},e),{yChanged:void 0,ratio:"*",dimensions:a});default:return b(b({},kl.placeCropMask(r.ratio,e)),{ratio:r.ratio,dimensions:a})}else{let{x:l,y:c}=r.dimensions;return b(b({},kl.placeCropMask(l/c,e)),{ratio:null,dimensions:a})}}return null}setCropDefaults(t=!1){let e=this.editor.outputContainer.getResolution();this.setDefaultImageSize(e);let r=this.editor.getPreviewSize(),{position:o}=this.editor.engineMediator.preview.previewTransformWithoutDpr;this.setMaxCropSize(r),this.setDefaultCropPosition({x:o.x-r.width/2,y:o.y-r.height/2}),this.changeDefaultScale(this.editor.scale.defaultScale),t||(this.unRotatedDefaults.cropMaskPosition=this.defaultCropMaskPosition,this.unRotatedDefaults.scale=this.defaultScale)}setDefaultImageSize(t){this.defaults.imageSize=b({},at(t)),this.lockResolution||(this.localOutputSize=b({},at(t)))}setMaxCropSize(t){this.defaults.maxCropMaskSize.height=t.height,this.defaults.maxCropMaskSize.width=t.width}setDefaultCropPosition(t){this.defaults.cropMaskPosition.x=t.x,this.defaults.cropMaskPosition.y=t.y}resetCrop(){this.state.cropState=Y.map({}),this.state.identifier="identity"}toggleCategorySelection(t){this.selectedCategory=this.selectedCategory===t?kF:t}pureReset(){this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.resetCrop()}changePosition(t){return this.transformStore.changePosition(t,this.defaults.maxCropMaskSize)}changePositionX(t){return this.transformStore.changePositionX(t,this.defaults.maxCropMaskSize.width)}changePositionY(t){return this.transformStore.changePositionY(t,this.defaults.maxCropMaskSize.height)}changeCropAndOutputHeight(t){return t&&t>=this.minCropSize?(this.transformStore.changeHeight(t),this.lockResolution||this.changeLocalOutputHeight(t*this.defaults.imageSize.height/this.defaults.maxCropMaskSize.height),!0):!1}changeCropAndOutputWidth(t){return t&&t>=this.minCropSize?(this.transformStore.changeWidth(t),this.lockResolution||this.changeLocalOutputWidth(t*this.defaults.imageSize.width/this.defaults.maxCropMaskSize.width),!0):!1}changeCropAndOutputSize(t){let e=this.changeCropAndOutputHeight(t.height),r=this.changeCropAndOutputWidth(t.width);return{widthChanged:e,heightChanged:r}}transformRender(t=!0){this.transformations.applyPreviewTransform(),t&&this.editor.render()}addLocalSnapshot(t=`Local ${this.locale.title}`){if(this.localSnapshotEnabled){let e=this.state,{cropState:r}=e,o=_i(e,["cropState"]);this.editor.addLocalTransformSnapshot(b(b(b({},o),this.cropState),{localOutputSize:at(this.localOutputSize),outputSize:this.engineMediator.output.container.getResolution(),defaults:at(this.defaults),previewTransform:this.engineMediator.preview.container.getTransform(),outputTransform:this.engineMediator.output.container.getTransform()}),t)}}updateLocalStateFromHistory(t){let{tool:e}=this.editor.activeStore;e===C.TRANSFORM&&(this.transformStore.changeLockResolution(t.lockResolution),this.transformStore.changeForceDimensions(t.forceDimensions),this.transformStore.changeIdentifier(t.identifier),this.transformStore.setRotation(t.rotationInDegrees),this.setDefaultAngle(t.rotationInDegrees),this.transformStore.setOutputRotation(t.outputRotation),this.transformStore.updateFlip(t),this.engineMediator.output.container.setRotation(t.outputRotation),this.setDefaultImageSize(t.defaults.imageSize),this.localOutputSize=t.defaults.imageSize,this.changeLocalOutputSize(t.localOutputSize),this.transformStore.changeSize(t.size),this.changePosition(t.position),this.setMaxCropSize(t.defaults.maxCropMaskSize),this.setDefaultCropPosition(t.defaults.cropMaskPosition),this.changeDefaultScale(t.defaults.scale),this.engineMediator.output.container.setResolution(t.outputSize),this.engineMediator.preview.container.setTransform(t.previewTransform),this.engineMediator.output.container.setTransform(t.outputTransform))}updateStateFromHistory(t){let{tool:e}=this.editor.activeStore;e!==C.TRANSFORM&&(this.engineMediator.output.container.setTransform(t.outputTransform),this.engineMediator.preview.container.setTransform(t.previewTransform),this.engineMediator.output.container.setResolution(t.outputSize),this.changeLocalOutputSize(t.outputSize))}get serializableState(){let{flipHorizontally:t,flipVertically:e}=this.rotateFlipState,r=this.editor.engineMediator.output.container.getRotation()*180/Math.PI%360,{identifier:o,rotationInDegrees:s}=this,n=s*Math.PI/180,a=r+s;a=Math.round(a/90)*90,a=a<0?a+360:a,a=(360-a)%360;let{start:l,end:c}=this.convertUIToOperationOptions(n,a);return{flipHorizontally:t,flipVertically:e,rotation:n,start:l,end:c,identifier:o,outputRotation:a}}getStartEndForOperation(t){let{leftTop:e,rightBottom:r,maxCropMaskSize:o}=this,s=e.y,n=e.x,a=r.x,l=r.y;switch(t){case 270:return{leftTop:{x:o.height-l,y:n},rightBottom:{x:o.height-s,y:a}};case 180:return{leftTop:{x:o.width-a,y:o.height-l},rightBottom:{x:o.width-n,y:o.height-s}};case 90:return{leftTop:{x:s,y:o.width-a},rightBottom:{x:l,y:o.width-n}};default:return{leftTop:{x:n,y:s},rightBottom:{x:a,y:l}}}}getStartEndForUI(t,e,r){let{maxCropMaskSize:o}=this,s=e.y,n=e.x,a=r.x,l=r.y;switch(t){case 90:return{leftTop:{x:s,y:o.height-a},rightBottom:{x:l,y:o.height-n}};case 180:return{leftTop:{x:o.width-a,y:o.height-l},rightBottom:{x:o.width-n,y:o.height-s}};case 270:return{leftTop:{x:o.width-l,y:n},rightBottom:{x:o.width-s,y:a}};default:return{leftTop:{x:n,y:s},rightBottom:{x:a,y:l}}}}convertOperationOptionsToUI({start:t,end:e,rotation:r,outputRotation:o}){let s=o===90||o===270,n=s?R.fromSize(this.defaultImageSize).swapped:R.fromSize(this.defaultImageSize),a=Math.cos(r),l=Math.sin(r),c=this.calculateScale(r),d=new R(Math.min(t.x,e.x),Math.min(t.y,e.y)),m=new R(Math.max(t.x,e.x),Math.max(t.y,e.y)).subtract(d).divide(2),f=d.add(m).multiply(n).subtract(n.multiply(.5)),v=new R(f.x*a-f.y*l,f.x*l+f.y*a).multiply(c),_=n.multiply(.5).add(v).divide(n),D=_.subtract(m.multiply(c)),k=_.add(m.multiply(c)),A=s?R.fromSize(this.maxCropMaskSize).swapped:R.fromSize(this.maxCropMaskSize),B=D.multiply(A),T=k.multiply(A),{leftTop:F,rightBottom:q}=this.getStartEndForUI(o,B,T);return{start:new R(F),end:new R(q)}}convertUIToOperationOptions(t,e){let r=e===90||e===270,o=r?R.fromSize(this.defaultImageSize).swapped:R.fromSize(this.defaultImageSize),s=r?R.fromSize(this.maxCropMaskSize).swapped:R.fromSize(this.maxCropMaskSize),n=Math.cos(-t),a=Math.sin(-t),l=this.calculateScale(t,r),{leftTop:c,rightBottom:d}=this.getStartEndForOperation(e),u=new R(c).divide(s),p=new R(d).divide(s).subtract(u).divide(2),v=u.add(p).multiply(o).subtract(o.multiply(.5)),x=new R(v.x*n-v.y*a,v.x*a+v.y*n).divide(l),D=o.multiply(.5).add(x).divide(o),k=D.subtract(p.divide(l)),A=D.add(p.divide(l));return{start:k,end:A}}calculateScale(t,e=!1){let r=e?R.fromSize(this.defaultImageSize).swapped:R.fromSize(this.defaultImageSize),o=new R(Math.abs(r.x*Math.cos(t))+Math.abs(r.y*Math.sin(t)),Math.abs(r.x*Math.sin(t))+Math.abs(r.y*Math.cos(t))),s=r.subtract(o.clone()).divide(2).abs;return s.y>s.x?s.y*2/r.y+1:s.x*2/r.x+1}updateStateFromSerialization(t,e){this.localSnapshotEnabled=e,this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.setDefaultAngle(0),this.editor.outputContainer.getRotation()!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop();let r=Math.round(t.rotation*180/Math.PI);this.transformStore.setRotation(r>180?r-360:r),this.applyOutputRotationFromSerialization(t),t.identifier&&this.transformStore.changeIdentifier(t.identifier);let o=t.outputRotation<0?t.outputRotation+360:t.outputRotation;if(o=(360-o)%360,t.start&&t.end){(t.end.x===0||t.end.y===0)&&(t.end.x=1,t.end.y=1);let{start:s,end:n}=this.convertOperationOptionsToUI({start:new R(t.start),end:new R(t.end),rotation:t.rotation,outputRotation:o});this.changePositionX(s.x),this.changePositionY(s.y);let a=n.x-s.x,l=n.y-s.y;this.transformStore.changeSize({width:a,height:l});let{maxCropMaskSize:c,imageSize:d}=this.defaults,u={height:l*d.height/c.height,width:a*d.width/c.width};this.changeLocalOutputSize(u)}this.editor.outputContainer.setData({flipHorizontally:t.flipHorizontally,flipVertically:t.flipVertically}),t.flipHorizontally&&this.flipHorizontally(!1),t.flipVertically&&this.flipVertically(!1),this.editor.overlayToolStore.correctOverlayFlip(),this.localSnapshotEnabled=!0}applyOutputRotationFromSerialization(t){if(t.outputRotation!==void 0)switch(t.outputRotation){case 90:this.transformations.rotateOutputContainer();break;case 180:this.transformations.rotateOutputContainer(),this.transformations.rotateOutputContainer();break;case 270:this.transformations.rotateOutputContainer(!0);break;default:break}this.transformations.rotateOutputContainer(!0),this.transformations.rotateOutputContainer()}setDefaultAngle(t){this.defaultAngle=t}updateCanvasControls(t){let e=at(this.cropMaskPosition),r=at(this.cropMaskSize),o=at(this.defaults.maxCropMaskSize);this.changeCropAndOutputSize({height:o.height*r.height/t.height,width:o.width*r.width/t.width}),this.changePosition({y:o.height*e.y/t.height,x:o.width*e.x/t.width})}onLeave(){this.transformations.onLeave()}onEnter(){this.transformations.onEnter()}saveTransforms(){this.transformations.saveTransforms()}saveTransformsBasedOnFlip(){this.transformations.saveTransformsBasedOnFlip()}setRotation(t){this.transformStore.setRotation(t),this.transformRender()}rotateOutputContainer(t=!1){return K(this,null,function*(){this.setDragMode(!0),this.transformations.rotateOutputContainer(t),yield this.editor.wait(),this.setDragMode(!1)})}applyInitialCrop(){let{identifier:t}=this.getMatchingItem();this.changeIdentifier(t,!1)}clickableCanvas(t){this.editor.clickableCanvas(t)}proportionalSize(t,e,r=this.defaults.maxCropMaskSize,o=this.minCropSize){let s={width:e.height*t,height:e.height};return(s.width>r.width||s.width<o||s.height<o)&&(s.width=e.width,s.height=e.width/t),s.width=Math.round(s.width),s.height=Math.round(s.height),s}checkAndAddSnapshot(t){let e=at(this.localOutputSize);(t.width!==e.width||t.height!==e.height)&&this.addLocalSnapshot()}updateInitialCropMaskPosition(t){let{cropMaskSize:e}=this,r=this.defaults.maxCropMaskSize;t?this.changePosition({x:0,y:Math.abs(r.height-e.height)/2}):this.changePosition({x:Math.abs(r.width-e.width)/2,y:0})}updatePreviewSizeWRTImageSize(){let t=at(this.localOutputSize),e=at(this.defaults.imageSize),r=at(this.defaults.maxCropMaskSize),o={height:r.height*t.height/e.height,width:r.width*t.width/e.width};this.transformStore.changeSize(o)}getScaleWithFlip(t=this.rotateFlipState.rotation){return this.transformations.getScaleWithFlip(t)}get cropState(){return this.transformStore.selectedCrop}get identifier(){return this.transformStore.identifier}get ratio(){return this.transformStore.ratio}get height(){return this.transformStore.height}get width(){return this.transformStore.width}get localOutputImageSize(){return this.localOutputSize}get localOutputHeight(){return this.localOutputSize.height}get localOutputWidth(){return this.localOutputSize.width}get lockResolution(){return this.transformStore.lockResolution}get forceDimensions(){return this.transformStore.forceDimensions}get rotationInDegrees(){return this.transformStore.rotationInDegrees}get outputRotation(){return this.transformStore.outputRotation}get isDragMode(){return this.dragMode.get()}get rotateFlipState(){let{flipHorizontally:t,flipVertically:e,rotationInDegrees:r,outputRotation:o}=this.transformStore.state;return{flipHorizontally:t,flipVertically:e,rotation:kl.inRadians(r),outputRotation:o}}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}get config(){return this.editor.configStore.config[C.TRANSFORM]}get locale(){return this.editor.configStore.locale[C.TRANSFORM]}get isOptionSelected(){return this.identifier!=="identity"}get leftTop(){return this.rect.leftTop}get leftBottom(){return this.rect.leftBottom}get rightTop(){return this.rect.rightTop}get rightBottom(){return this.rect.rightBottom}get isFlippedHorizontal(){return this.transformStore.isFlippedHorizontal}get isFlippedVertical(){return this.transformStore.isFlippedVertical}get leftTopRespectFlip(){return this.rectForUi.leftTop}get leftBottomRespectFlip(){return this.rectForUi.leftBottom}get rightTopRespectFlip(){return this.rectForUi.rightTop}get rightBottomRespectFlip(){return this.rectForUi.rightBottom}get cropMaskPosition(){return this.transformStore.position}get cropMaskSize(){return this.transformStore.size}get state(){return this.transformStore.state}get defaultImageSize(){return this.defaults.imageSize}get maxCropMaskSize(){return this.defaults.maxCropMaskSize}get minCropMaskSize(){let t=this.getRatio();return t==="*"||t===1?{width:this.minCropSize,height:this.minCropSize}:t>1?{width:this.minCropSize*t,height:this.minCropSize}:{width:this.minCropSize,height:this.minCropSize*t}}get defaultCropMaskPosition(){return this.defaults.cropMaskPosition}get defaultScale(){return this.defaults.scale}get engineMediator(){return this.editor.engineMediator}getRatio(){let t=this.getTransform(this.identifier);if(t){if(Object.prototype.hasOwnProperty.call(t,"ratio"))return this.lockResolution?this.localOutputWidth/this.localOutputHeight:t.ratio;let{x:e,y:r}=t.dimensions;return e/r}return"*"}},X=kl;h([Y],X.prototype,"selectedCategory",2),h([Y],X.prototype,"defaults",2),h([Y],X.prototype,"localOutputSize",2),h([w],X.prototype,"changeIdentifier",1),h([w],X.prototype,"setDragMode",1),h([w],X.prototype,"setCropDefaults",1),h([w],X.prototype,"setDefaultImageSize",1),h([w],X.prototype,"setMaxCropSize",1),h([w],X.prototype,"setDefaultCropPosition",1),h([w],X.prototype,"resetCrop",1),h([w],X.prototype,"toggleCategorySelection",1),h([w],X.prototype,"pureReset",1),h([w],X.prototype,"reset",2),h([w],X.prototype,"changePosition",1),h([w],X.prototype,"changePositionX",1),h([w],X.prototype,"changePositionY",1),h([w],X.prototype,"changeCropAndOutputHeight",1),h([w],X.prototype,"changeCropAndOutputWidth",1),h([w],X.prototype,"changeCropAndOutputSize",1),h([w],X.prototype,"onLeave",1),h([w],X.prototype,"onEnter",1),h([w],X.prototype,"changeLocalOutputSize",2),h([w],X.prototype,"changeDefaultScale",2),h([w],X.prototype,"changeLocalOutputHeight",2),h([w],X.prototype,"changeLocalOutputWidth",2),h([w],X.prototype,"changeLockResolution",2),h([w],X.prototype,"setRotation",1),h([w],X.prototype,"rotateClockwise",2),h([w],X.prototype,"rotateAntiClockwise",2),h([w],X.prototype,"rotateOutputContainer",1),h([w],X.prototype,"flipHorizontally",2),h([w],X.prototype,"flipVertically",2),h([w],X.prototype,"applyDefaultCrop",2),h([w],X.prototype,"applyInitialCrop",1),h([w],X.prototype,"updateCropMask",2),h([w],X.prototype,"clickableCanvas",1),h([w],X.prototype,"onLeftTop",2),h([w],X.prototype,"onLeftBottom",2),h([w],X.prototype,"onRightTop",2),h([w],X.prototype,"onRightBottom",2),h([w],X.prototype,"proportionalSize",1),h([w],X.prototype,"onPixelWidth",2),h([w],X.prototype,"onPixelHeight",2),h([w],X.prototype,"updateInitialCropMaskPosition",1),h([w],X.prototype,"updatePreviewSizeWRTImageSize",1),h([S],X.prototype,"cropState",1),h([S],X.prototype,"identifier",1),h([S],X.prototype,"ratio",1),h([S],X.prototype,"height",1),h([S],X.prototype,"width",1),h([S],X.prototype,"localOutputImageSize",1),h([S],X.prototype,"localOutputHeight",1),h([S],X.prototype,"localOutputWidth",1),h([S],X.prototype,"lockResolution",1),h([S],X.prototype,"forceDimensions",1),h([S],X.prototype,"rotationInDegrees",1),h([S],X.prototype,"outputRotation",1),h([S],X.prototype,"isDragMode",1),h([S],X.prototype,"rotateFlipState",1),h([S],X.prototype,"selectedCategoryIdentifier",1),h([S],X.prototype,"categories",1),h([S],X.prototype,"items",1),h([S],X.prototype,"config",1),h([S],X.prototype,"locale",1),h([S],X.prototype,"isOptionSelected",1),h([S],X.prototype,"leftTop",1),h([S],X.prototype,"leftBottom",1),h([S],X.prototype,"rightTop",1),h([S],X.prototype,"rightBottom",1),h([S],X.prototype,"isFlippedHorizontal",1),h([S],X.prototype,"isFlippedVertical",1),h([S],X.prototype,"leftTopRespectFlip",1),h([S],X.prototype,"leftBottomRespectFlip",1),h([S],X.prototype,"rightTopRespectFlip",1),h([S],X.prototype,"rightBottomRespectFlip",1),h([S],X.prototype,"cropMaskPosition",1),h([S],X.prototype,"cropMaskSize",1),h([S],X.prototype,"state",1),h([S],X.prototype,"defaultImageSize",1),h([S],X.prototype,"maxCropMaskSize",1),h([S],X.prototype,"minCropMaskSize",1),h([S],X.prototype,"defaultCropMaskPosition",1),h([S],X.prototype,"defaultScale",1);var fe=class{constructor(t){this.checkImageResize=()=>{this.engine.on(ha.BEGAN_IMAGE_DOWNSCALING,()=>{this.modalStore.showInfoModal("resizing")}),this.engine.on(ha.IMAGE_DOWNSCALED,({width:t,height:e})=>{let{maxMegaPixels:r}=this.configStore.config.engine.downscaleOptions,o=hh.isMobile()?r.mobile:r.desktop;this.modalStore.hideModal(),this.modalStore.showActionModal({type:Vt.WARNING,identifier:"imageResized",handleConfirm:()=>{this.modalStore.hideModal()},error:{megapixels:`${o}`,width:`${t}`,height:`${e}`}})})};this.init=t=>{this.historyStore.isDirty()?this.modalStore.showActionModal({type:Vt.WARNING,identifier:"discardChanges",handleConfirm:()=>{this.setImage(t),this.resetToolStates()},handleDismiss:()=>{this.setImage(t,!0)}}):this.setImage(t,!0).then(()=>{let{engine:r,displayCanvasRendererWarning:o}=this.configStore.config;r.preferredRenderer==="canvas"&&o&&this.modalStore.showActionModal({type:Vt.WARNING,identifier:"unsupportedWebGLRenderer",handleConfirm:()=>{this.modalStore.hideModal()}})}),this.historyStore.reset(),this.libraryStore.fetchImages()};this.setImage=(t,e=!1)=>K(this,null,function*(){try{this.modalStore.showInfoModal(this.configStore.config.displayResizeWarning?"resizing":"loading"),this.scale.defaultScale=1,this.scale.resetOffset(),yield this.activeStore.setImage(t),yield this.engineMediator.image.addImageToContainer(),this.engineMediator.output.applyNewImageTransform(),this.engineMediator.preview.updateTransform(),this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.historyStore.addInitialSnapshot();let{flipHorizontally:r,flipVertically:o}=this.transformToolStore.rotateFlipState;this.outputContainer.setData({flipVertically:o,flipHorizontally:r}),e?(this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls(),this.transformToolStore.resetCrop(),this.transformToolStore.applyDefaultCrop(),this.transformToolStore.saveTransformsBasedOnFlip(),this.transformToolStore.onEnter(),this.transformToolStore.setRotation(this.transformToolStore.rotationInDegrees),this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()):this.transformToolStore.saveTransforms(),this.snappingStore.calculatePreviewTopLeftPosition(),yield this.renderPromise(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"&&this.filterToolStore.setImageAndGetPreviews(),this.activeStore.tool?this.configStore.events.onImageLoaded():this.onReady(),this.modalStore.identifier!=="imageResized"&&this.modalStore.hideModal()}catch(r){this.configStore.events.onErrorImageLoading(r),this.modalStore.hideModal(),this.modalStore.showActionModal({type:Vt.ERROR,identifier:r.identifier?r.identifier:"rendering",error:r,handleConfirm:()=>{window.location.reload()}})}});this.onToolChange=(t,e=null,r=!0)=>{if(t!==e&&this.engineMediator.preview.container){if([t,e].indexOf(C.TRANSFORM)!==-1){let{canvasSize:o}=this.canvasStore,s=this.configStore.measurements.basicToolControlBar.controlsBarHeight;if(t===C.TRANSFORM){this.transformToolStore.onLeave(),this.historyStore.removeTransformLocalSnapshots();let n=this.engineMediator.preview.container.getScale().x,a=this.engineMediator.output.container.getResolution(),{defaultImageSize:l}=this.transformToolStore;(n!==1||l.width!==a.width||l.height!==a.height)&&this.addSnapshot(void 0,_t.EDIT,this.configStore.locale.transform.title),this.snappingStore.calculatePreviewTopLeftPosition(),this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=o.height+s,this.resize(!0))}else e===C.TRANSFORM&&(this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=o.height-s,this.resize(),this.render()),this.transformToolStore.onEnter(),this.transformToolStore.addLocalSnapshot(),this.historyStore.saveTransformLocalSnapshotIndex())}else this.scale.resetOffset(),this.scale.resetPosition(),this.scale.setScaleToDefault(),this.scale.scaleRender(!0);r&&this.render()}};this.resize=(t=!1)=>{try{this.transformToolStore.applyDefaultCrop(),this.canvasStore.updateCanvasDimensions();let e=at(this.transformToolStore.maxCropMaskSize),r=this.activeStore.tool===C.TRANSFORM;(!r||t)&&this.transformToolStore.onEnter();let o=this.engineMediator.preview.container.getRotation();if(this.engineMediator.preview.updateTransform(o)){this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.transformToolStore.updateCanvasControls(e),this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls();let n=this.transformToolStore.getScaleWithFlip(o);this.engineMediator.preview.container.setScale(n),(!r||t)&&(this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()),this.snappingStore.calculatePreviewTopLeftPosition(),this.render()}}catch(e){this.modalStore.showActionModal({type:Vt.ERROR,identifier:"rendering",handleConfirm:()=>{window.location.reload()}})}};this.export=(r={})=>{var{preventExportEvent:t}=r,e=_i(r,["preventExportEvent"]);return new Promise((o,s)=>{this.modalStore.showInfoModal("exporting");let n=this.activeStore.tool===C.TRANSFORM;n&&this.transformToolStore.onLeave();let{config:a}=this.configStore,l=b(b({},a.export.image),e),{exportType:c,format:d,quality:u,enableDownload:m}=l;this.engineMediator.engine.export(c,d,u).then(p=>{m&&this.triggerFileDownload(a.export.filename,d,c,p),t||this.configStore.events.onExport(p),o(p),n&&this.transformToolStore.onEnter(),this.modalStore.hideModal(),this.historyStore.isDirtySinceSave=!1}).catch(p=>{s(p),n&&this.transformToolStore.onEnter(),this.modalStore.hideModal()})})};this.serialize=({image:t}={image:!0})=>this.serializationMediator.serialize({image:t});this.deserialize=t=>this.serializationMediator.deserialize(t);this.close=()=>{this.historyStore.isDirtySinceSave&&this.configStore.config.displayCloseWarning?this.modalStore.showActionModal({type:Vt.WARNING,identifier:"unsavedChanges",handleConfirm:()=>{this.configStore.events.onClose()}}):this.configStore.events.onClose()};this.hasChanges=()=>this.historyStore.isDirty();this.wait=(t=0)=>new Promise(e=>setTimeout(e,t));this.clickableCanvas=t=>K(this,null,function*(){t?(yield new Promise(e=>setTimeout(e,0)),this.canvasStore.enableCanvasClick()):this.canvasStore.disableCanvasClick()});this.onReady=()=>K(this,null,function*(){let{layout:t,forceCrop:e}=this.configStore.config;if(t==="advanced"&&this.activeStore.selectTool(this.configStore.defaultTool),e){let r=this.transformToolStore.localOutputImageSize,o=r.width/r.height,s=this.transformToolStore.entityManager.items.map(n=>n.ratio?n.ratio:n.dimensions.x/n.dimensions.y);s.indexOf("*")!==-1?console.error('ForceCrop will not work if "*" is one of the ratios'):s.indexOf(parseFloat(o.toFixed(2)))===-1&&this.activeStore.selectTool(C.TRANSFORM)}this.configStore.events.onEditorReady()});this.addSnapshot=(t,e,r)=>{this.historyStore.addSnapshot(t,e,r)};this.addLocalTransformSnapshot=(t,e,r=_t.EDIT)=>{this.historyStore.addSnapshot({localTransform:t},r,e)};this.resetToolStates=()=>{this.filterToolStore.pureReset(),this.focusToolStore.pureReset(),this.adjustmentsToolStore.pureReset(),this.overlayToolStore.pureReset(),this.frameToolStore.pureReset(),this.brushToolStore.pureReset(),this.spriteStore.pureReset(),this.transformToolStore.pureReset(),this.historyStore.reset(),this.render()};this.getAssetPath=t=>this.assetProvider.getPathForCategory(t);this.render=()=>K(this,null,function*(){yield this.renderPromise()});this.applyFlipToPreview=t=>this.engineMediator.previewSpaceToFlippedPreviewSpace(t);this.getPreviewSize=()=>{let{width:t,height:e}=this.engine.getOutputDimensions();return t&&e?{width:Math.round(this.worldToPreview(this.outputToWorld(t))),height:Math.round(this.worldToPreview(this.outputToWorld(e)))}:{height:e,width:t}};this.triggerFileDownload=(t,e,r,o)=>{let s=e===Le.JPEG&&r!==qe.MSBLOB?".jpeg":".png",n=t+s,a=this.blobFromExportData(o);this.triggerBlobDownload(n,a)};this.triggerBlobDownload=(t,e)=>{if(navigator.msSaveBlob)navigator.msSaveBlob(e,t);else{let r=document.createElement("a"),o=URL.createObjectURL(e);r.href=o,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),Dw()||URL.revokeObjectURL(o)}};this.blobFromExportData=t=>typeof t=="string"?EC(t):t instanceof HTMLImageElement?EC(t.src):t;this.configStore=new gr;let e=this.configStore.saveConfig(t);if(this.engineMediator=new MC(this),this.serializationMediator=new km(this),this.spriteStore=new J(this),this.scale=new He(this),this.filterToolStore=new Be(this),this.adjustmentsToolStore=new $t(this),this.focusToolStore=new Rt(this),this.overlayToolStore=new We(this),this.frameToolStore=new Ie(this),this.brushToolStore=new ve(this),this.transformToolStore=new X(this),this.libraryStore=new _r(this),this.modalStore=new zr(this),this.snappingStore=new Ko(this),this.activeStore=new ao(this),this.canvasStore=new br(this),this.historyStore=new Cl(this),this.modalStore.showInfoModal("loading"),this.libraryStore.initProvider(e),this.configStore.config.displayResizeWarning&&this.checkImageResize(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"){let r=this.configStore.config.engine;this.previewThumbnails=new Dm(b(b({},r),{license:this.configStore.config.license,assetProvider:this.configStore.assetProvider}))}}static get defaultColors(){return Object.keys(ji).map(t=>{let e=ji[t];return{identifier:t,color:e,colorString:on(e)}})}static get defaultBackgroundColors(){return Object.keys(mC).map(t=>{let e=mC[t];return{identifier:t,color:e,colorString:on(e)}})}static get devicePixelRatio(){return window.devicePixelRatio||1}get shortestOutputSide(){let t=this.outputContainer.getBounds();return Math.min(t.width,t.height)}get assetProvider(){return this.configStore.assetProvider}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get orderHelper(){return this.engineMediator.orderHelper}renderPromise(){return this.engineMediator.render(this.engineMediator.preview.container)}previewToWorld(t,e){return Tr(t)?this.engineMediator.previewSpaceToWorldSpace(t,e):this.engineMediator.previewSpaceToWorldSpace(t,e)}worldToPreview(t){return Tr(t)?this.engineMediator.worldSpaceToPreviewSpace(t):this.engineMediator.worldSpaceToPreviewSpace(t)}worldSizeToPreview(t){return{width:this.engineMediator.worldSpaceToPreviewSpace(t.width),height:this.engineMediator.worldSpaceToPreviewSpace(t.height)}}previewSizeToWorld(t,e){return{width:this.engineMediator.previewSpaceToWorldSpace(t.width,e),height:this.engineMediator.previewSpaceToWorldSpace(t.height,e)}}outputToWorld(t){return Tr(t)?this.engineMediator.outputSpaceToWorldSpace(t):this.engineMediator.outputSpaceToWorldSpace(t)}previewToOutput(t){return Tr(t)?this.engineMediator.previewSpaceToOutputSpace(t):this.engineMediator.previewSpaceToOutputSpace(t)}get outputContainer(){return this.engineMediator.output.container}};h([w],fe.prototype,"resize",2),h([w],fe.prototype,"export",2),h([w],fe.prototype,"clickableCanvas",2);function LC(i,t){let e=i.width/i.height,r=t.width/t.height;return e>r?i.height/t.height:i.width/t.width}var xU={transform:qt.IDENTITY},ln=class{constructor(t){this.initialTransform=qt.IDENTITY;this.editor=t,this.state=Y(xU)}createPreview(t){this.container=this.editor.engine.createPreview(t)}updateTransform(t=0,e=!0){let r=this.calculateTransform(t);return r.scale.x?(e?this.saveInitialTransform(r):this.savePreviewTransform(r),this.container.setTransform(this.state.transform),!0):!1}saveInitialTransform(t){this.initialTransform=t,this.savePreviewTransform(t)}savePreviewTransform(t){Me(()=>{this.state.transform.position=t.position,this.state.transform.scale=t.scale,this.state.transform.rotation=t.rotation;let e=fe.devicePixelRatio;this.previewTransformWithoutDpr={position:new R(t.position).divide(e),scale:new R(t.scale).divide(e),rotation:t.rotation}})}get transform(){return this.state.transform}get position(){return this.state.transform.position}get scale(){return this.state.transform.scale}get rotation(){return this.state.transform.rotation}calculateTransform(t=0){let e=fe.devicePixelRatio,{width:r,height:o}=this.editor.canvasStore.canvasSize,s=this.editor.engine.getOutputDimensions(),n=LC({width:r,height:o},s),a=.95;window.innerWidth<600&&(a=.98),n*=a;let l=o-s.height*n,c=this.editor.configStore.measurements.mainCanvasActionBar.height*2;l<c&&(n=LC({width:r,height:o-c},s),n*=a),n*=e;let d={x:r*e/2,y:o*e/2},u={x:n,y:n};return new qt(d,u,t)}};h([w],ln.prototype,"updateTransform",1),h([w],ln.prototype,"savePreviewTransform",1),h([S],ln.prototype,"transform",1),h([S],ln.prototype,"position",1),h([S],ln.prototype,"scale",1),h([S],ln.prototype,"rotation",1);var ga=class{constructor(){this.imageContainerOrder=[];this.spriteContainerOrder=[]}static checkTool(t){if([C.STICKER,C.TEXT,C.TEXT_DESIGN,C.BRUSH,C.FRAME].indexOf(t)!==-1)throw new Error("addIndex is used for non sprites, for sprites use addSprite")}static remove(t,e){let r=e.findIndex(o=>o===t);r!==-1&&e.splice(r,1)}static indexForOrder(t,e,r){let o=t[r],s=e.findIndex(a=>a===r);if(s!==-1)return{index:s,order:e};let{length:n}=e;if(n){let a;for(a=0;a<n;a+=1){let l=e[a],c=t[l];if(o<c)return e=[...e.slice(0,a),r,...e.slice(a)],{index:a,order:e}}}return e.push(r),{index:e.length-1,order:e}}addIndex(t){ga.checkTool(t);let{index:e,order:r}=ga.indexForOrder(ga.IMAGE_CONTAINER_INDEX,this.imageContainerOrder,t);return this.imageContainerOrder=r,e}removeIndex(t){ga.checkTool(t),ga.remove(t,this.imageContainerOrder)}addSprite(t){return this.spriteContainerOrder.push(t),this.imageContainerOrder.length+this.spriteContainerOrder.length-1}removeSprite(t){ga.remove(t,this.spriteContainerOrder)}renameSprite(t,e){let r=this.spriteContainerOrder.findIndex(o=>o===t);r!==-1&&(this.spriteContainerOrder[r]=e)}bringToFront(t){let e=this.spriteContainerOrder.findIndex(r=>r===t);return e!==-1&&(this.spriteContainerOrder.splice(e,1),this.spriteContainerOrder.push(t)),this.getLastSpriteIndex()}getLastSpriteId(){let{length:t}=this.spriteContainerOrder;return this.spriteContainerOrder[t-1]}getSpriteIndex(t){return this.spriteContainerOrder.findIndex(r=>r===t)+this.imageContainerOrder.length-1}getLastSpriteIndex(){return this.imageContainerOrder.length+this.spriteContainerOrder.length-1}},r_=ga;r_.IMAGE_CONTAINER_INDEX={[C.ART_FILTER]:0,[C.FILTER]:1,[C.ADJUSTMENT]:2,[C.FOCUS]:3,[C.OVERLAY]:4};var MC=class{constructor(t){this.orderHelper=new r_;let e=t.configStore.config.engine;this.engine=new ed(b(b({},e),{license:t.configStore.config.license,assetProvider:t.configStore.assetProvider})),this.image=new vC(t),this.output=new CC(t),this.preview=new ln(t),this.editor=t}render(t){return this.engine.render(t)}previewSpaceToWorldSpace(t,e){let r=this.preview.previewTransformWithoutDpr;if(Tr(t)){let o=this.editor.engine.convertPointFromPreviewIntoWorldSpace(R.ZERO,r,e),s=this.editor.engine.convertPointFromPreviewIntoWorldSpace({x:t,y:0},r,e);return R.distance(new R(o),new R(s))}return this.editor.engine.convertPointFromPreviewIntoWorldSpace(t,r,e)}worldSpaceToPreviewSpace(t){let e=this.preview.previewTransformWithoutDpr;if(Tr(t)){let r=this.editor.engine.convertPointFromWorldIntoPreviewSpace(R.ZERO,e),o=this.editor.engine.convertPointFromWorldIntoPreviewSpace({x:t,y:0},e);return R.distance(new R(r),new R(o))}return this.editor.engine.convertPointFromWorldIntoPreviewSpace(t,e)}outputSpaceToWorldSpace(t){return Tr(t)?st.getScalarInWorldSpace(t,this.editor.engine.getOutputContainer()):st.getPointInWorldSpace(t,this.editor.engine.getOutputContainer())}previewSpaceToOutputSpace(t){let e=this.preview.previewTransformWithoutDpr;if(Tr(t)){let r=this.editor.engine.convertPointFromPreviewIntoOutputSpace(R.ZERO,e),o=this.editor.engine.convertPointFromPreviewIntoOutputSpace({x:t,y:0},e);return R.distance(new R(r),new R(o))}return this.editor.engine.convertPointFromPreviewIntoOutputSpace(t,e)}previewSpaceToFlippedPreviewSpace(t){return this.editor.engine.convertPointFromPreviewIntoFlippedPreviewSpace(t)}};var TF=[[0,0],[0,1],[1,0],[1,1]],vU=[[0,1,2,3],[2,3,0,1],[1,0,3,2],[3,2,1,0]],Xo=class{constructor(t,e,r="center",o=!0,s=!1){this.considerRotation=!0;this.considerFlip=!0;this.store=e,this.m=r==="center"?Xo.movePivotTo([.5,.5]):TF,this.considerRotation=o,this.considerFlip=s,this.configStore=t.configStore}static getFlippedEdgeIndex(t,e,r){return vU[(e?1:0)+(r?2:0)][t]}static movePivotTo(t){return TF.map(e=>[e[0]-t[0],e[1]-t[1]])}get position(){return this.store.position}get size(){return this.store.size}get rotation(){return this.considerRotation?this.store.rotationWRTOutputRotation:0}get flipHorizontally(){return this.considerFlip?this.store.isFlippedHorizontal:!1}get flipVertically(){return this.considerFlip?this.store.isFlippedVertical:!1}get flipCenter(){return this.considerFlip?this.store.flipCenter:null}handleOrigin(t,e,r){let o=Xo.getFlippedEdgeIndex(t,e,r),s=this.m[o][0]*this.size.width,n=this.m[o][1]*this.size.height;return{width:s,height:n}}get leftTop(){let{position:t,flipHorizontally:e,flipVertically:r}=this,o=this.handleOrigin(0,e,r);return Xo.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,t)}get leftBottom(){let{position:t,flipHorizontally:e,flipVertically:r}=this,o=this.handleOrigin(1,e,r);return Xo.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,t)}get rightTop(){let{position:t,flipHorizontally:e,flipVertically:r}=this,o=this.handleOrigin(2,e,r);return Xo.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,t)}get rightBottom(){let{position:t,flipHorizontally:e,flipVertically:r}=this,o=this.handleOrigin(3,e,r);return Xo.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,t)}get leftBottomHandle(){let{position:t,flipHorizontally:e,flipVertically:r}=this,o=this.handleOrigin(1,e,r);return o.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,Xo.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,t)}get rightBottomHandle(){let{position:t,flipHorizontally:e,flipVertically:r}=this,o=this.handleOrigin(3,e,r);return o.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,Xo.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,t)}get leftMid(){let t=new R(this.leftTop),e=new R(this.leftBottom);return t.add(e).divide(2)}get rightMid(){let t=new R(this.rightTop),e=new R(this.rightBottom);return t.add(e).divide(2)}},Fe=Xo;Fe.coordinatesWithRotation=({width:t,height:e},r,o,s,n,a)=>{let l=t*Math.cos(r)-e*Math.sin(r)+a.x,c=t*Math.sin(r)+e*Math.cos(r)+a.y;return o&&(l=n.x*2-l),s&&(c=n.y*2-c),new R({x:l,y:c}).rounded},h([S],Fe.prototype,"position",1),h([S],Fe.prototype,"size",1),h([S],Fe.prototype,"rotation",1),h([S],Fe.prototype,"flipHorizontally",1),h([S],Fe.prototype,"flipVertically",1),h([S],Fe.prototype,"flipCenter",1),h([S],Fe.prototype,"leftTop",1),h([S],Fe.prototype,"leftBottom",1),h([S],Fe.prototype,"rightTop",1),h([S],Fe.prototype,"rightBottom",1),h([S],Fe.prototype,"leftBottomHandle",1),h([S],Fe.prototype,"rightBottomHandle",1),h([S],Fe.prototype,"leftMid",1),h([S],Fe.prototype,"rightMid",1);var nd=(i,t=0,e=3)=>{let r=Math.tan(t),o=Math.sqrt(r**2+1);return{x:i.x+e/o,y:i.y+e*r/o}};var o_={blurRadius:40,gradientSize:.2},CU=b({start:{x:0,y:0},end:{x:0,y:0}},o_),SU=b({center:{x:0,y:0},radius:0},o_),wU=b({origin:{x:0,y:0},rotation:0,size:0},o_),kU=o_,Tl={identifier:"identity",linear:CU,radial:SU,mirrored:wU,gaussian:kU};var hi=class{constructor(t){this.selectFocus=(t,e)=>{Me(()=>{this.state.identifier=t,e&&(this.state[t].blurRadius=e)})};this.changeBlurRadius=(t,e)=>{t!=="identity"&&(this.state[t].blurRadius=e)};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=Tl.identifier,this.state.identifier!=="identity"&&(this.state[this.state.identifier].blurRadius=Tl[this.state.identifier].blurRadius))};this.setLinear=({start:t,end:e})=>{this.state.linear.start.x=t.x,this.state.linear.start.y=t.y,this.state.linear.end.x=e.x,this.state.linear.end.y=e.y};this.setLinearStart=t=>{this.state.linear.start.x=t.x,this.state.linear.start.y=t.y};this.setLinearEnd=t=>{this.state.linear.end.x=t.x,this.state.linear.end.y=t.y};this.setRadialCenter=t=>{this.state.radial.center.x=t.x,this.state.radial.center.y=t.y};this.setRadialRadius=t=>{this.state.radial.radius=t};this.setMirroredOrigin=t=>{this.state.mirrored.origin.x=t.x,this.state.mirrored.origin.y=t.y};this.setMirroredRotation=t=>{this.state.mirrored.rotation=t};this.setMirroredSize=t=>{this.state.mirrored.size=t};this.getEffectProperties=()=>this.effect?this.effect.getProperties():null;this.setLinearFocus=t=>{this.effect=this.engineMediator.engine.addLinearBlur(t,this.imageContainer,this.order),this.updateLinearState(this.effect.getProperties())};this.setGaussianFocus=t=>{this.effect=this.engineMediator.engine.addGaussianBlur(t,this.imageContainer,this.order),this.updateGaussianState(this.effect.getProperties())};this.setRadialFocus=t=>{this.effect=this.engineMediator.engine.addRadialBlur(t,this.imageContainer,this.order),this.updateRadialState(this.effect.getProperties())};this.setMirroredFocus=t=>{this.effect=this.engineMediator.engine.addMirroredBlur(t,this.imageContainer,this.order),this.updateMirroredState(this.effect.getProperties())};this.updateFromEngineState=t=>{let e=this.getEffectProperties();if(e&&t!=="identity")switch(t){case Tt.LINEAR:this.updateLinearState(e);break;case Tt.RADIAL:this.updateRadialState(e);break;case Tt.MIRRORED:this.updateMirroredState(e);break;default:break}};this.updateGaussianState=t=>{this.changeBlurRadius(Tt.GAUSSIAN,t.blurRadius)};this.updateMirroredState=t=>{let e=this.editor.worldToPreview(t.mirrorAxisOrigin),o=new R(this.editor.worldToPreview(t.mirrorAxisDirection)).subtract(e),s=Math.atan2(o.y,o.x);this.setMirroredOrigin(this.editor.worldToPreview(t.mirrorAxisOrigin)),this.setMirroredRotation(s),this.setMirroredSize(this.editor.worldToPreview(t.clearAreaWidth)),this.changeBlurRadius(Tt.MIRRORED,t.blurRadius)};this.updateRadialState=t=>{this.setRadialCenter(this.editor.worldToPreview(t.center)),this.setRadialRadius(this.editor.worldToPreview(t.radius)),this.changeBlurRadius(Tt.RADIAL,t.blurRadius)};this.updateLinearState=t=>{this.setLinearStart(this.editor.worldToPreview(t.start)),this.setLinearEnd(this.editor.worldToPreview(t.end)),this.changeBlurRadius(Tt.LINEAR,t.blurRadius)};this.setEffectProperties=t=>this.effect?(this.effect.setProperties(t),this.effect.getProperties()):null;this.removeFocus=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.engineMediator.orderHelper.removeIndex(C.FOCUS))};this.editor=t,this.engineMediator=this.editor.engineMediator,this.state=Tl}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get order(){return this.engineMediator.orderHelper.addIndex(C.FOCUS)}get imageContainer(){return this.engineMediator.image.container}};h([Y],hi.prototype,"state",2),h([w],hi.prototype,"selectFocus",2),h([w],hi.prototype,"changeBlurRadius",2),h([w],hi.prototype,"reset",2),h([w],hi.prototype,"setLinear",2),h([w],hi.prototype,"setLinearStart",2),h([w],hi.prototype,"setLinearEnd",2),h([w],hi.prototype,"setRadialCenter",2),h([w],hi.prototype,"setRadialRadius",2),h([w],hi.prototype,"setMirroredOrigin",2),h([w],hi.prototype,"setMirroredRotation",2),h([w],hi.prototype,"setMirroredSize",2),h([w],hi.prototype,"updateFromEngineState",2);var Dl=class{constructor(t){this.selectFocus=t=>{if(t!==this.identifier){this.focusStore.removeFocus();let e=this.maxIntensity*.2,{width:r}=this.editor.engine.getOutputContainer().getBounds(),o=this.editor.shortestOutputSide*.2;switch(t){case Tt.LINEAR:let s=this.editor.outputToWorld({x:-r/2,y:0}),n=this.editor.outputToWorld({x:r/2,y:0});this.setLinearFocus({start:s,end:n,blurRadius:e});break;case Tt.RADIAL:let a=this.editor.outputToWorld({x:0,y:0});this.setRadialFocus({center:a,radius:o,blurRadius:e});break;case Tt.MIRRORED:let l=this.editor.outputToWorld({x:0,y:0}),c=o,d=this.editor.outputToWorld(nd({x:0,y:0},0));this.setMirroredFocus({mirrorAxisOrigin:l,clearAreaWidth:c,blurRadius:e,mirrorAxisDirection:d});break;case Tt.GAUSSIAN:this.setGaussianFocus({blurRadius:e});break;default:break}this.focusStore.selectFocus(t,e),this.editor.render(),this.addSnapshot(_t.ADD,C.FOCUS)}};this.changeIntensity=t=>{let e=this.focusStore.setEffectProperties({blurRadius:t});e&&(this.focusStore.changeBlurRadius(this.identifier,e.blurRadius),this.editor.render())};this.changeRelativeIntensity=t=>{let e=(this.maxIntensity-Dl.minIntensity)*t/100+Dl.minIntensity,r=this.focusStore.setEffectProperties({blurRadius:e});r&&(this.focusStore.changeBlurRadius(this.identifier,r.blurRadius),this.editor.render())};this.toolSnapshot=t=>{this.addSnapshot(_t.EDIT,t)};this.addSnapshot=(t,e)=>{this.editor.addSnapshot(void 0,t,e)};this.clickableCanvas=t=>{this.editor.clickableCanvas(t)};this.pureReset=()=>{this.focusStore.removeFocus(),this.focusStore.reset()};this.reset=()=>{this.pureReset(),this.editor.render(),this.addSnapshot(_t.DELETE,this.locale.controls.buttonReset)};this.setStart=t=>{let e=this.focusStore.setEffectProperties({start:this.editor.previewToWorld(t)});e&&(this.focusStore.setLinearStart(this.editor.worldToPreview(e.start)),this.editor.render())};this.setEnd=t=>{let e=this.focusStore.setEffectProperties({end:this.editor.previewToWorld(t)});e&&(this.focusStore.setLinearEnd(this.editor.worldToPreview(e.end)),this.editor.render())};this.setCenter=t=>{let e=this.focusStore.setEffectProperties({center:this.editor.previewToWorld(t)});e&&(this.focusStore.setRadialCenter(this.editor.worldToPreview(e.center)),this.editor.render())};this.setRadius=t=>{let e=this.focusStore.setEffectProperties({radius:this.editor.previewToWorld(t)});e&&(this.focusStore.setRadialRadius(this.editor.worldToPreview(e.radius)),this.editor.render())};this.setOrigin=t=>{let e=this.focusStore.setEffectProperties({mirrorAxisOrigin:this.editor.previewToWorld(t),mirrorAxisDirection:this.editor.previewToWorld(nd(t,this.rotation))});e&&(this.focusStore.setMirroredOrigin(this.editor.worldToPreview(e.mirrorAxisOrigin)),this.editor.render())};this.setSize=t=>{let e=this.focusStore.setEffectProperties({clearAreaWidth:this.editor.previewToWorld(t)});e&&(this.focusStore.setMirroredSize(this.editor.worldToPreview(e.clearAreaWidth)),this.editor.render())};this.setRotation=t=>{this.focusStore.setEffectProperties({mirrorAxisDirection:this.editor.previewToWorld(nd(this.origin,t))}),this.focusStore.setMirroredRotation(t),this.editor.render()};this.updateStateFromHistory=(t,e)=>{this.focusStore.removeFocus();let{magnitude:r}=e;Me(()=>{switch(t.identifier){case Tt.LINEAR:this.focusStore.selectFocus(Tt.LINEAR),this.setLinearFocus({start:this.editor.previewToWorld(new R(t.linear.start).multiply(e)),end:this.editor.previewToWorld(new R(t.linear.end).multiply(e)),blurRadius:t.linear.blurRadius});break;case Tt.GAUSSIAN:this.focusStore.selectFocus(Tt.GAUSSIAN),this.setGaussianFocus({blurRadius:t.gaussian.blurRadius});break;case Tt.RADIAL:this.focusStore.selectFocus(Tt.RADIAL),this.setRadialFocus({center:this.editor.previewToWorld(new R(t.radial.center).multiply(e)),radius:this.editor.previewToWorld(t.radial.radius*r),blurRadius:t.radial.blurRadius});break;case Tt.MIRRORED:this.focusStore.selectFocus(Tt.MIRRORED),this.setMirroredFocus({mirrorAxisOrigin:this.editor.previewToWorld(new R(t.mirrored.origin).multiply(e)),clearAreaWidth:this.editor.previewToWorld(t.mirrored.size*r),blurRadius:t.mirrored.blurRadius,mirrorAxisDirection:this.editor.previewToWorld(nd(t.mirrored.origin,t.mirrored.rotation))});break;case"identity":this.pureReset();break;default:break}})};this.updateStateFromSerialization=t=>K(this,null,function*(){if(Dl.doesFocusIdentifierExist(t.identifier))this.focusStore.removeFocus(),Me(()=>{switch(this.focusStore.selectFocus(t.identifier),t.identifier){case Tt.LINEAR:this.setLinearFocus(t.linear);break;case Tt.GAUSSIAN:this.setGaussianFocus(t.gaussian);break;case Tt.RADIAL:this.setRadialFocus(t.radial);break;case Tt.MIRRORED:this.setMirroredFocus({mirrorAxisOrigin:t.mirrored.origin,clearAreaWidth:t.mirrored.size,blurRadius:t.mirrored.blurRadius,mirrorAxisDirection:nd(t.mirrored.origin,t.mirrored.rotation)});break;default:break}});else throw new Error(`Focus identifier ${t.identifier} doesn't exist`)});this.updateCanvasControls=()=>{this.focusStore.updateFromEngineState(this.identifier)};this.getFocusStateForHistory=()=>{let t=this.editor.canvasStore.sizeVector,{linear:e}=this.focusStore.state,{radial:r}=this.focusStore.state,{mirrored:o}=this.focusStore.state,s=t,{magnitude:n}=s;return b(b({},this.focusStore.state),{linear:b(b({},e),{start:new R(e.start).divide(s),end:new R(e.end).divide(s)}),radial:b(b({},r),{center:new R(r.center).divide(s),radius:r.radius/n}),mirrored:b(b({},o),{origin:new R(o.origin).divide(s),size:o.size/n}),gaussian:b({},this.focusStore.state.gaussian)})};this.editor=t,this.focusStore=new hi(this.editor);let e=this.editor.assetProvider.getAssets("focus");this.entityManager=new Pe(e,b(b({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("focus")}))}static get minIntensity(){return 0}static doesFocusIdentifierExist(t){return Object.keys(Tt).map(e=>Tt[e]).findIndex(e=>e===t)!==-1}get state(){return this.focusStore.state}get serializableState(){switch(this.identifier){case Tt.LINEAR:return{identifier:this.identifier,linear:this.focusStore.getEffectProperties()};case Tt.RADIAL:return{identifier:this.identifier,radial:this.focusStore.getEffectProperties()};case Tt.MIRRORED:let t=this.focusStore.getEffectProperties();return{identifier:this.identifier,mirrored:{blurRadius:t.blurRadius,origin:t.mirrorAxisOrigin,rotation:at(this.state.mirrored.rotation),size:t.clearAreaWidth}};case Tt.GAUSSIAN:return{identifier:this.identifier,gaussian:this.focusStore.getEffectProperties()};default:return Tl}}get start(){return this.focusStore.state.linear.start}get startOnPreview(){let t=this.editor.applyFlipToPreview(this.focusStore.state.linear.start);return{x:Math.abs(t.x),y:Math.abs(t.y)}}get end(){return this.focusStore.state.linear.end}get endOnPreview(){let t=this.editor.applyFlipToPreview(this.focusStore.state.linear.end);return{x:Math.abs(t.x),y:Math.abs(t.y)}}get center(){return this.focusStore.state.radial.center}get radius(){return this.focusStore.state.radial.radius}get origin(){return this.focusStore.state.mirrored.origin}get rotation(){return this.focusStore.state.mirrored.rotation}get rotationOnPreview(){let{flipHorizontally:t,flipVertically:e}=this.editor.outputContainer.getData();return Sm({rotation:this.focusStore.state.mirrored.rotation,flipHorizontally:t,flipVertically:e})}get size(){return this.focusStore.state.mirrored.size}get mirroredAreaWidth(){let{width:t,height:e}=this.editor.canvasStore.canvasSize;return Math.sqrt(t**2+e**2)*2}get identifier(){return this.state.identifier}get intensity(){return this.identifier==="identity"?Tl.gaussian.blurRadius:this.state[this.identifier].blurRadius}get relativeIntensity(){let{blurRadius:t}=this.identifier==="identity"?this.state.gaussian:this.state[this.identifier];return(t-Dl.minIntensity)*100/(this.maxIntensity-Dl.minIntensity)}get maxIntensity(){return this.editor.shortestOutputSide/10}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[C.FOCUS]}get locale(){return this.editor.configStore.locale[C.FOCUS]}get items(){return this.entityManager.items}setGaussianFocus({blurRadius:t}){this.focusStore.setGaussianFocus({blurRadius:t})}setLinearFocus({start:t,end:e,blurRadius:r}){this.focusStore.setLinearFocus({start:t,end:e,blurRadius:r})}setRadialFocus({center:t,radius:e,blurRadius:r}){this.focusStore.setRadialFocus({center:t,radius:e,blurRadius:r})}setMirroredFocus({mirrorAxisOrigin:t,clearAreaWidth:e,blurRadius:r,mirrorAxisDirection:o}){this.focusStore.setMirroredFocus({mirrorAxisOrigin:t,clearAreaWidth:e,blurRadius:r,mirrorAxisDirection:o})}},Rt=Dl;h([w],Rt.prototype,"selectFocus",2),h([w],Rt.prototype,"changeIntensity",2),h([w],Rt.prototype,"changeRelativeIntensity",2),h([w],Rt.prototype,"clickableCanvas",2),h([w],Rt.prototype,"pureReset",2),h([w],Rt.prototype,"reset",2),h([w],Rt.prototype,"setStart",2),h([w],Rt.prototype,"setEnd",2),h([w],Rt.prototype,"setCenter",2),h([w],Rt.prototype,"setRadius",2),h([w],Rt.prototype,"setOrigin",2),h([w],Rt.prototype,"setSize",2),h([w],Rt.prototype,"setRotation",2),h([w],Rt.prototype,"updateStateFromHistory",2),h([w],Rt.prototype,"updateStateFromSerialization",2),h([w],Rt.prototype,"updateCanvasControls",2),h([S],Rt.prototype,"state",1),h([S],Rt.prototype,"start",1),h([S],Rt.prototype,"startOnPreview",1),h([S],Rt.prototype,"end",1),h([S],Rt.prototype,"endOnPreview",1),h([S],Rt.prototype,"center",1),h([S],Rt.prototype,"radius",1),h([S],Rt.prototype,"origin",1),h([S],Rt.prototype,"rotation",1),h([S],Rt.prototype,"rotationOnPreview",1),h([S],Rt.prototype,"size",1),h([S],Rt.prototype,"mirroredAreaWidth",1),h([S],Rt.prototype,"identifier",1),h([S],Rt.prototype,"intensity",1),h([S],Rt.prototype,"relativeIntensity",1),h([S],Rt.prototype,"maxIntensity",1),h([S],Rt.prototype,"isOptionSelected",1),h([S],Rt.prototype,"config",1),h([S],Rt.prototype,"locale",1),h([S],Rt.prototype,"items",1);var IF=ot.Button.TextSecondary,EF=DF.default.span`
  font-size: 14px;
  padding: 3px 1px 2px;
  color: ${i=>i.theme.canvasActionBar.foreground};
  display: flex;
  align-self: center;
`,TU=({scale:i,active:t})=>{let{canZoomIn:e}=i,{canZoomOut:r}=i,{zoomLevel:o}=i;return[C.TRANSFORM,C.BRUSH,C.FOCUS,C.STICKER,C.TEXT,C.TEXT_DESIGN].indexOf(t.tool)!==-1?null:Am.default.createElement(ot.Bar.ButtonGroup,null,Am.default.createElement(IF,{"data-test":H.MainBarButtonZoom,ariaLabel:"Zoom out",isDisabled:!r,onClick:i.out},"-"),Am.default.createElement(EF,null,o," %"),Am.default.createElement(IF,{ariaLabel:"Zoom in",isDisabled:!e,onClick:i.in},"+"))},AF=P("scale","active")(O(TU));EF.defaultProps={theme:fr};var OF=FF.default(ot.Bar.ButtonGroup)`
  > :last-child {
    margin-left: 10px;
  }
  > :first-child {
    margin-left: 0;
  }
`,DU=({config:i,editor:t,history:e,custom:r})=>{let o=i.locale.mainCanvasActions,{canUndo:s}=e,{canRedo:n}=e,a=i.config.mainCanvasActions,l=()=>{t.export()},c=()=>{if(t.activeStore.tool===C.TRANSFORM)return null;let f=r.getButton("mainCanvasActionUndo");return xr.default.createElement(f,{key:"mainCanvasActionUndo","data-test":H.MainBarButtonUndo,onClick:e.undo,isDisabled:!s,label:o.buttonUndo,ariaLabel:o.buttonUndo,icon:xr.default.createElement(Pu.undo,null)})},d=()=>{if(t.activeStore.tool===C.TRANSFORM)return null;let f=r.getButton("mainCanvasActionRedo");return xr.default.createElement(f,{key:"mainCanvasActionRedo","data-test":H.MainBarButtonRedo,onClick:e.redo,isDisabled:!n,label:o.buttonRedo,ariaLabel:o.buttonRedo,icon:xr.default.createElement(Pu.redo,null)})},u=()=>{let f=r.getButton("mainCanvasActionExport");return xr.default.createElement(f,{key:"mainCanvasActionExport","data-test":H.MainBarButtonExport,onClick:l,label:o.buttonExport,ariaLabel:o.buttonExport,icon:xr.default.createElement(Pu.export,null)})},m=()=>{if(!i.displayCloseButton)return null;let f=r.getButton("mainCanvasActionClose");return xr.default.createElement(f,{key:"mainCanvasActionClose","data-test":H.MainBarButtonClose,onClick:t.close,label:o.buttonClose,ariaLabel:o.buttonClose,icon:xr.default.createElement(Pu.close,null)})},p=a.map(f=>{switch(f){case ct.UNDO:return c;case ct.REDO:return d;case ct.EXPORT:return u;case ct.CLOSE:return m;default:return null}});return xr.default.createElement(ot.Bar.Index,null,xr.default.createElement(OF,null,p[0]&&p[0]()||null,p[1]&&p[1]()||null),i.config.enableZoom?xr.default.createElement(AF,null):null,xr.default.createElement(OF,null,p[2]&&p[2]()||null,p[3]&&p[3]()||null))},ad=P("config","editor","history","custom")(O(DU));var qC=y(require("react"));var Pm=y(require("react"));var tO=y(require("styled-components"));var tN=tO.default.div`
  position: relative;
`;function IU(i){return typeof i=="string"&&i.includes("%")}function EU(i){return typeof i=="string"&&i.includes(".")&&parseFloat(i)===1}function Xe(i,t){EU(i)&&(i="100%");let e=IU(i);return i=t===360?i:Math.min(t,Math.max(0,parseFloat(i))),e&&(i=parseInt(String(i*t),10)/100),Math.abs(i-t)<1e-6?1:(t===360?i=(i<0?i%t+t:i%t)/parseFloat(String(t)):i=i%t/parseFloat(String(t)),i)}function s_(i){return i=parseFloat(i),(Number.isNaN(i)||i<0||i>1)&&(i=1),i}function Fm(i){return i<=1?`${Number(i)*100}%`:i}function ba(i){return i.length===1?`0${i}`:String(i)}function zC(i,t,e){return{r:Xe(i,255)*255,g:Xe(t,255)*255,b:Xe(e,255)*255}}function UC(i,t,e){i=Xe(i,255),t=Xe(t,255),e=Xe(e,255);let r=Math.max(i,t,e),o=Math.min(i,t,e),s=0,n=0,a=(r+o)/2;if(r===o)n=0,s=0;else{let l=r-o;switch(n=a>.5?l/(2-r-o):l/(r+o),r){case i:s=(t-e)/l+(t<e?6:0);break;case t:s=(e-i)/l+2;break;case e:s=(i-t)/l+4;break;default:break}s/=6}return{h:s,s:n,l:a}}function RF(i,t,e){let r,o,s;i=Xe(i,360),t=Xe(t,100),e=Xe(e,100);function n(a,l,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+(l-a)*(6*c):c<1/2?l:c<2/3?a+(l-a)*(2/3-c)*6:a}if(t===0)o=e,s=e,r=e;else{let a=e<.5?e*(1+t):e+t-e*t,l=2*e-a;r=n(l,a,i+1/3),o=n(l,a,i),s=n(l,a,i-1/3)}return{r:r*255,g:o*255,b:s*255}}function NC(i,t,e){i=Xe(i,255),t=Xe(t,255),e=Xe(e,255);let r=Math.max(i,t,e),o=Math.min(i,t,e),s=0,n=r,a=r-o,l=r===0?0:a/r;if(r===o)s=0;else{switch(r){case i:s=(t-e)/a+(t<e?6:0);break;case t:s=(e-i)/a+2;break;case e:s=(i-t)/a+4;break;default:break}s/=6}return{h:s,s:l,v:n}}function PF(i,t,e){i=Xe(i,360)*6,t=Xe(t,100),e=Xe(e,100);let r=Math.floor(i),o=i-r,s=e*(1-t),n=e*(1-o*t),a=e*(1-(1-o)*t),l=r%6,c=[e,n,s,s,a,e][l],d=[a,e,e,n,s,s][l],u=[s,s,a,e,e,n][l];return{r:c*255,g:d*255,b:u*255}}function HC(i,t,e,r){let o=[ba(Math.round(i).toString(16)),ba(Math.round(t).toString(16)),ba(Math.round(e).toString(16))];return r&&o[0].charAt(0)===o[0].charAt(1)&&o[1].charAt(0)===o[1].charAt(1)&&o[2].charAt(0)===o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function AU(i){return Math.round(parseFloat(i)*255).toString(16)}function $i(i){return parseInt(i,16)}function WC(i){return $i(i)/255}function BF(i,t,e,r,o){let s=[ba(Math.round(i).toString(16)),ba(Math.round(t).toString(16)),ba(Math.round(e).toString(16)),ba(AU(r))];return o&&s[0].charAt(0)===s[0].charAt(1)&&s[1].charAt(0)===s[1].charAt(1)&&s[2].charAt(0)===s[2].charAt(1)&&s[3].charAt(0)===s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}var ld={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};var FU="[-\\+]?\\d+%?",OU="[-\\+]?\\d*\\.\\d+%?",_a=`(?:${OU})|(?:${FU})`,GC=`[\\s|\\(]+(${_a})[,|\\s]+(${_a})[,|\\s]+(${_a})\\s*\\)?`,VC=`[\\s|\\(]+(${_a})[,|\\s]+(${_a})[,|\\s]+(${_a})[,|\\s]+(${_a})\\s*\\)?`,uo={CSS_UNIT:new RegExp(_a),rgb:new RegExp(`rgb${GC}`),rgba:new RegExp(`rgba${VC}`),hsl:new RegExp(`hsl${GC}`),hsla:new RegExp(`hsla${VC}`),hsv:new RegExp(`hsv${GC}`),hsva:new RegExp(`hsva${VC}`),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Ur(i){return Boolean(uo.CSS_UNIT.exec(String(i)))}function RU(i){if(i=i.trim().toLowerCase(),i.length===0)return!1;let t=!1;if(ld[i])i=ld[i],t=!0;else if(i==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};let e=uo.rgb.exec(i);return e?{r:e[1],g:e[2],b:e[3]}:(e=uo.rgba.exec(i),e?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=uo.hsl.exec(i),e?{h:e[1],s:e[2],l:e[3]}:(e=uo.hsla.exec(i),e?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=uo.hsv.exec(i),e?{h:e[1],s:e[2],v:e[3]}:(e=uo.hsva.exec(i),e?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=uo.hex8.exec(i),e?{r:$i(e[1]),g:$i(e[2]),b:$i(e[3]),a:WC(e[4]),format:t?"name":"hex8"}:(e=uo.hex6.exec(i),e?{r:$i(e[1]),g:$i(e[2]),b:$i(e[3]),format:t?"name":"hex"}:(e=uo.hex4.exec(i),e?{r:$i(e[1]+e[1]),g:$i(e[2]+e[2]),b:$i(e[3]+e[3]),a:WC(e[4]+e[4]),format:t?"name":"hex8"}:(e=uo.hex3.exec(i),e?{r:$i(e[1]+e[1]),g:$i(e[2]+e[2]),b:$i(e[3]+e[3]),format:t?"name":"hex"}:!1)))))))))}function MF(i){let t={r:0,g:0,b:0},e=1,r=null,o=null,s=null,n=!1,a=!1;if(typeof i=="string"&&(i=RU(i)),Array.isArray(i)){let[l,c,d]=i;Ur(l)&&Ur(c)&&Ur(d)&&(t=zC(l*255,c*255,d*255),n=!0,a="rgb"),i.length===4&&(e=i[3])}return typeof i=="object"&&(Ur(i.r)&&Ur(i.g)&&Ur(i.b)?(t=zC(i.r,i.g,i.b),n=!0,a=String(i.r).substr(-1)==="%"?"prgb":"rgb"):Ur(i.h)&&Ur(i.s)&&Ur(i.v)?(r=Fm(i.s),o=Fm(i.v),t=PF(i.h,r,o),n=!0,a="hsv"):Ur(i.h)&&Ur(i.s)&&Ur(i.l)&&(r=Fm(i.s),s=Fm(i.l),t=RF(i.h,r,s),n=!0,a="hsl"),Object.prototype.hasOwnProperty.call(i,"a")&&(e=i.a)),e=s_(e),{ok:n,format:i.format||a,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:e}}var cd=class{constructor(t="",e={}){if(t instanceof cd)return t;this.originalInput=t;let r=MF(t);this.originalInput=t,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=e.format||r.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}getAlpha(){return this.a}setAlpha(t){return this.a=s_(t),this.roundA=Math.round(100*this.a)/100,this}toHsv(){let t=NC(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}}toHsvString(){let t=NC(this.r,this.g,this.b),e=Math.round(t.h*360),r=Math.round(t.s*100),o=Math.round(t.v*100);return this.a===1?`hsv(${e}, ${r}%, ${o}%)`:`hsva(${e}, ${r}%, ${o}%, ${this.roundA})`}toHsl(){let t=UC(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}}toHslString(){let t=UC(this.r,this.g,this.b),e=Math.round(t.h*360),r=Math.round(t.s*100),o=Math.round(t.l*100);return this.a===1?`hsl(${e}, ${r}%, ${o}%)`:`hsla(${e}, ${r}%, ${o}%, ${this.roundA})`}toHex(t=!1){return HC(this.r,this.g,this.b,t)}toHexString(t=!1){return`#${this.toHex(t)}`}toHex8(t=!1){return BF(this.r,this.g,this.b,this.a,t)}toHex8String(t=!1){return`#${this.toHex8(t)}`}toRgb(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}}toRgbArray(){return[Math.round(this.r),Math.round(this.g),Math.round(this.b),this.a]}toRgbString(){let t=Math.round(this.r),e=Math.round(this.g),r=Math.round(this.b);return`rgba(${t}, ${e}, ${r}, ${this.roundA})`}toPercentageRgb(){let t=e=>`${Math.round(Xe(e,255)*100)}%`;return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}}toPercentageRgbString(){let t=e=>Math.round(Xe(e,255)*100);return this.a===1?`rgb(${t(this.r)}%, ${t(this.g)}%, ${t(this.b)}%)`:`rgba(${t(this.r)}%, ${t(this.g)}%, ${t(this.b)}%, ${this.roundA})`}toName(){if(this.a===0)return"transparent";if(this.a<1)return!1;let t=`#${HC(this.r,this.g,this.b,!1)}`;for(let e of Object.keys(ld))if(ld[e]===t)return e;return!1}toString(t){let e=Boolean(t);t=t||this.format;let r=this.a<1&&this.a>=0;if(!e&&r&&t&&(t.startsWith("hex")||t==="name"))return t==="name"&&this.a===0?this.toName():this.toRgbString();switch(t){case"rgb":return this.toRgbString();case"prgb":return this.toPercentageRgbString();case"hex":case"hex6":return this.toHexString();case"hex3":return this.toHexString(!0);case"hex4":return this.toHex8String(!0);case"hex8":return this.toHex8String();case"hsl":return this.toHslString();case"hsv":return this.toHsvString();case"name":return this.toName();default:return this.toHexString()}}clone(){return new cd(this.toString())}},cn=cd;var Oe=y(require("react")),qo=y(require("styled-components"));var Il=y(require("styled-components")),PU=Il.default.div`
  position: absolute;
  width: ${i=>i.theme.measurements.color.colorPicker.arrow.width}px;
  height: ${i=>i.theme.measurements.color.colorPicker.arrow.width/2}px;
  overflow: hidden;
  pointer-events: none;
  ${i=>i.direction==="bottom"?Il.css`
          bottom: 100%;
        `:Il.css`
          top: 100%;
        `}
  left: ${i=>i.arrowOffset}px;
  :after {
    content: '';
    position: absolute;
    width: ${i=>i.theme.measurements.color.colorPicker.arrow.width/2}px;
    height: ${i=>i.theme.measurements.color.colorPicker.arrow.width/2}px;
    left: 50%;
    ${i=>i.direction==="bottom"?Il.css`
            transform: translate(-50%, 50%) rotate(45deg);
          `:Il.css`
            transform: translate(-50%, -50%) rotate(45deg);
          `}
    background-color: ${i=>i.theme.colorPicker.listBackground};
    pointer-events: none;
  }
`,LF=PU;var n_=y(require("react")),jC=y(require("styled-components"));var BU=jC.default.div`
  text-align: center;
  width: 28px;
  padding-left: 4px;
`,MU=jC.default(E.Input.Text)`
  input {
    text-align: center;
    border-bottom: 1px solid
      ${i=>i.theme.colorPicker.inputBorderColor};
  }
`,LU=({value:i,label:t,onChange:e})=>n_.default.createElement(BU,null,n_.default.createElement(E.Input.Label,{label:t}),n_.default.createElement(MU,{min:0,max:255,value:i,onChange:e})),a_=LU;var l_=y(require("react")),$C=y(require("styled-components"));var zU=$C.default.div`
  text-align: left;
  width: 62px;
`,UU=$C.default(E.Input.Text)`
  input {
    text-align: left;
    border-bottom: 1px solid
      ${i=>i.theme.colorPicker.inputBorderColor};
  }
`,NU=({value:i,label:t,onChange:e})=>l_.default.createElement(zU,null,l_.default.createElement(E.Input.Label,{label:t}),l_.default.createElement(UU,{value:i.toUpperCase(),onChange:e})),zF=NU;var Om=y(require("react"));var jF=y(require("styled-components"));var UF=y(require("styled-components"));var NF=UF.default.div.attrs(i=>({style:{left:i.position.x||`${0}px`,top:i.position.y||`${0}px`}}))`
  &&& {
    position: absolute;
    height: ${i=>i.theme.measurements.color.colorPicker.thumb.size}px;
    width: ${i=>i.theme.measurements.color.colorPicker.thumb.size}px;
    border-radius: 50%;
    border: 2px solid ${i=>i.theme.colorPicker.controlsColor};
    box-sizing: border-box;
    cursor: pointer;
    box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.11), 0 1px 3px 0 rgba(0, 0, 0, 0.46);
    z-index: 2;
    pointer-events: none;
  }
`,dd=NF;NF.defaultProps={theme:fr};var c_=y(require("react")),HF=y(Py());var WF=y(require("react-dom")),GF=y(require("styled-components"));var HU=GF.default.div`
  position: relative;
  height: 14px;
  width: 100%;
`,YC=class extends c_.default.Component{constructor(t){super(t);this.onDragStart=t=>{this.setState({dragging:!0}),this.onPositionChange(t)};this.onPositionChange=t=>{let{onChange:e,config:r}=this.props,o=r.measurements.color.colorPicker.thumb.size/2,s=r.measurements.color.colorPicker.thumb.size,n=0,a=0;n=t.clientX,a=t.clientY;let l=WF.default.findDOMNode(this);if(l&&l instanceof HTMLElement){let{top:c,left:d,width:u,height:m}=l.getBoundingClientRect(),p=n-d-o,f=a-c-o;p=Math.max(0,Math.min(u-s,p)),f=Math.max(0,Math.min(m-s,f)),e&&e({x:p,y:f}),this.setState({x:p,y:f})}};this.onDrag=t=>{this.state.dragging&&this.onPositionChange(t)};this.onDragStop=()=>{this.state.dragging&&this.setState({dragging:!1})};this.state={dragging:!1,x:t.defaultPosition.x,y:t.defaultPosition.y},this.debouncedOnDrag=HF.default(this.onDrag,10)}componentWillUnmount(){this.setState({dragging:!1})}render(){let{surface:t,setInnerRef:e,className:r,children:o}=this.props;return c_.default.createElement(HU,{ref:e,className:r},c_.default.createElement(E.DraggableCore,{onStart:this.onDragStart,onDrag:this.debouncedOnDrag,onStop:this.onDragStop},t),o)}};YC.defaultProps={defaultPosition:{x:0,y:0}};var ud=P("config","active")(O(YC));var VF=y(require("styled-components")),WU=VF.css`
  position: absolute;
  top: 3px;
  left: 0;
  width: 100%;
  height: 8px;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
`,El=WU;var GU=jF.default.div`
  ${El}
  background: linear-gradient(90deg, #F00 0%, #FF0 16.66%, #0F0 33.33%, #0FF 50%, #00F 66.66%, #F0F 83.33%, #F00 100%);
  height: 8px;
`,$F=class extends Om.default.Component{constructor(t){super(t);this.onKnob=({x:t})=>{let{onChange:e,config:r}=this.props,{offsetWidth:o}=this.node,s=o-r.measurements.color.colorPicker.thumb.size,n=t*o/s,a=Math.max(0,Math.min(360,n/o*360));e(a),this.setState({x:t})};this.setPositionFromColor=t=>{let{config:e}=this.props,{offsetWidth:r}=this.node,o=0,s=r-e.measurements.color.colorPicker.thumb.size;this.node&&(o=t.toHsv().h*r/360),this.setState({x:o*s/r})};this.nodeRef=e=>{this.node=e},this.state={x:0}}render(){let{x:t}=this.state;return Om.default.createElement(ud,{surface:Om.default.createElement(GU,null),setInnerRef:this.nodeRef,onChange:this.onKnob},Om.default.createElement(dd,{position:{x:t,y:0}}))}},YF=P("config")(O($F));var md=y(require("react"));var KC=y(require("styled-components"));var VU=KC.default.div.attrs(i=>({style:{background:`linear-gradient(to left, ${i.transparentColor} 0%, ${i.opaqueColor} 100%)`}}))`
  ${El}
  z-index: 1;
`,jU=KC.default.div.attrs(i=>({style:{backgroundImage:`url(${i.url})`}}))`
  ${El}
  z-index: 0;
  background-repeat: repeat-x;
  background-size: contain;
  background-position: left;
`,KF=class extends md.default.Component{constructor(t){super(t);this.onKnob=({x:t})=>{let{onChange:e,config:r}=this.props,{offsetWidth:o}=this.node,s=o-r.measurements.color.colorPicker.thumb.size,n=t*o/s,a=(o-n)/o,l=Math.round((a+Number.EPSILON)*100)/100,c=Math.min(1,Math.max(0,l));e(c),this.setState({x:t})};this.setPositionFromColor=t=>{let{config:e}=this.props,{offsetWidth:r}=this.node,o=0,s=r-e.measurements.color.colorPicker.thumb.size;this.node&&(o=(1-t.toHsv().a)*r),this.setState({x:o*s/r})};this.nodeRef=e=>{this.node=e},this.state={x:0}}render(){let{opaqueColor:t,transparentColor:e,config:r}=this.props,{x:o}=this.state,s=r.assetProvider.getPath("controls","/tiled-background.png");return md.default.createElement(ud,{surface:md.default.createElement(VU,{opaqueColor:t,transparentColor:e}),setInnerRef:this.nodeRef,onChange:this.onKnob},md.default.createElement(jU,{url:s}),md.default.createElement(dd,{position:{x:o,y:0}}))}},XF=P("config")(O(KF));var Rm=y(require("react"));var XC=y(require("styled-components"));var $U=XC.default.div.attrs(i=>({style:{backgroundColor:`hsl(${i.hue}, 100%, 50%)`}}))`
  ${El}
  background: linear-gradient(to top, rgb(0, 0, 0), rgba(0, 0, 0, 0)),
   linear-gradient(to right, rgb(255, 255, 255), rgba(255, 255, 255, 0));
  height: ${i=>i.theme.measurements.color.colorPicker.saturationSlider.height}px;
  top: 0px;
`,YU=XC.default(ud)`
  height: ${i=>i.theme.measurements.color.colorPicker.saturationSlider.height}px;
  margin-top: 0px;
`,qF=class extends Rm.default.Component{constructor(t){super(t);this.setPositionFromColor=t=>{let{config:e}=this.props,r={x:0,y:0};if(this.node){let{s:o,v:s}=t.toHsv(),{offsetWidth:n,offsetHeight:a}=this.node,l=n-e.measurements.color.colorPicker.thumb.size,c=a-e.measurements.color.colorPicker.thumb.size,d=o*n,u=(1-s)*a;r.x=d*l/n,r.y=u*c/a}this.setState({position:r})};this.onChange=({x:t,y:e})=>{let{onChange:r,config:o}=this.props,{offsetHeight:s,offsetWidth:n}=this.node,a=n-o.measurements.color.colorPicker.thumb.size,l=s-o.measurements.color.colorPicker.thumb.size,c=t*n/a,d=e*s/l,u=Math.min(1,Math.max(0,c/n)),m=Math.min(1,Math.max(0,(s-d)/s));r(u,m),this.setState({position:{x:t,y:e}})};this.nodeRef=e=>{this.node=e},this.state={position:{x:0,y:0}}}render(){let{hue:t}=this.props,{position:e}=this.state;return Rm.default.createElement(YU,{surface:Rm.default.createElement($U,{hue:t}),setInnerRef:this.nodeRef,onChange:this.onChange},Rm.default.createElement(dd,{position:e}))}},ZF=P("config")(O(qF));var KU=qo.default.div`
  position: absolute;
  left: ${i=>i.leftOffset}px;
  top: ${i=>i.topOffset}px;
  z-index: ${i=>i.theme.measurements.zIndex.input.list};
  display: none;
  opacity: 0;
  transition: opacity 0.3s ease-out;
  ${i=>i.show&&qo.css`
      display: block;
      opacity: 1;
      transition: opacity 0.3s ease-out;
    `}
`,JF=qo.default.div`
  &&& {
    position: absolute;
    ${i=>i.direction==="top"&&qo.css`
        transform: translate(0, -100%);
      `}
    padding: 16px;
    box-sizing: border-box;
    box-shadow: ${i=>i.theme.colorPicker.listShadow};
    background: ${i=>i.theme.colorPicker.listBackground};
    border-radius: ${i=>i.theme.shape.radiusMedium}px;
    width: ${i=>i.theme.measurements.color.colorPicker.width}px;
    height: ${i=>i.theme.measurements.color.colorPicker.height}px;
    left: 8px;
    z-index: 1;
  }
`,XU=qo.default(YF)`
  margin-top: 8px;
`,qU=qo.default(XF)`
  margin-top: 8px;
`,ZU=qo.default.div`
  display: flex;
  justify-content: space-between;
  margin-top: 30px;
`,JU=qo.default.div`
  display: flex;
`,d_=class extends Oe.default.Component{constructor(t){super(t);this.node=Oe.default.createRef();this.saturationRef=null;this.hueRef=null;this.opacityRef=null;this.checkId=(t,e,r)=>{let o=t,s=0;for(;o.parentElement&&s<r;)if(o=o.parentElement,s+=1,o.id===e)return!0;return!1};this.handleOutsideClick=t=>{var s;let{onRequestClose:e,onAddSnapshot:r}=this.props,{color:o}=this.state;((s=this.node.current)==null?void 0:s.contains(t.target))||(this.setState({hexInputValue:o.toHexString()}),e&&e(),r&&r())};this.onChange=t=>{let{onChange:e}=this.props;e({color:t.toRgbArray(),colorString:t.toRgbString()})};this.onHexValueChange=t=>{if(t.match(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/i)){let e=new cn(t);this.onChange(e),this.setState({color:e,hue:e.toHsl().h}),this.saturationRef.current.setPositionFromColor(e),this.hueRef.current.setPositionFromColor(e)}this.setState({hexInputValue:t})};this.onAlphaChange=t=>{let{color:e}=this.state,r=e.setAlpha(t);this.onChange(r),this.setState({color:r,hexInputValue:r.toHexString()})};this.onHueChange=t=>{let{color:e}=this.state,{s:r,v:o,a:s}=e.toHsv(),n=new cn({h:t,s:r,v:o,a:s});this.onChange(n),this.setState({color:n,hexInputValue:n.toHexString(),hue:t})};this.onSaturationBrightnessChange=(t,e)=>{let{color:r,hue:o}=this.state,{a:s}=r.toHsv(),n=new cn({h:o,s:t,v:e,a:s});this.onChange(n),this.setState({color:n,hexInputValue:n.toHexString()})};this.onInputChange=t=>e=>{let{color:r}=this.state;if(e.match(/0*([0-9]|[1-8][0-9]|9[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])/g)||!e.trim()){let o=r.toRgb();o[t]=parseInt(e,10)||0;let s=new cn(o);this.onChange(s),this.saturationRef.current.setPositionFromColor(s),this.hueRef.current.setPositionFromColor(s),this.setState({color:s,hexInputValue:s.toHexString(),hue:s.toHsl().h})}};let{color:e}=this.props,r=new cn(e);this.state={color:r,hue:r.toHsl().h,hexInputValue:r.toHexString()},this.saturationRef=Oe.default.createRef(),this.hueRef=Oe.default.createRef(),this.opacityRef=Oe.default.createRef()}componentDidMount(){let{color:t}=this.state;document.addEventListener("mousedown",this.handleOutsideClick,!1),document.addEventListener("touchstart",this.handleOutsideClick,!1),document.addEventListener("keydown",this.handleOutsideClick,!1),this.saturationRef.current.setPositionFromColor(t),this.hueRef.current.setPositionFromColor(t),this.opacityRef.current.setPositionFromColor(t)}componentDidUpdate(t){let{color:e,show:r}=this.props;if(r&&!t.show){let o=new cn(e);this.saturationRef.current.setPositionFromColor(o),this.hueRef.current.setPositionFromColor(o),this.opacityRef.current.setPositionFromColor(o),this.setState({color:o,hue:o.toHsl().h,hexInputValue:o.toHexString()})}}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1),document.removeEventListener("touchstart",this.handleOutsideClick,!1),document.removeEventListener("keydown",this.handleOutsideClick,!1)}render(){let{show:t,showArrow:e,direction:r,arrowOffset:o,topOffset:s,leftOffset:n,labelHex:a,labelR:l,labelG:c,labelB:d,labelSliderHue:u,labelSliderOpacity:m}=this.props,{color:p,hexInputValue:f,hue:v}=this.state,{r:x,g:_,b:D}=p.toRgb(),k=p.clone().setAlpha(1).toRgbString(),A=p.clone().setAlpha(0).toRgbString();return Oe.default.createElement("div",{ref:this.node},Oe.default.createElement(KU,{show:t,direction:r,leftOffset:n,topOffset:s},Oe.default.createElement(JF,{direction:r},e&&Oe.default.createElement(LF,{direction:r,arrowOffset:o}),Oe.default.createElement(ZF,{ref:this.saturationRef,hue:v,onChange:this.onSaturationBrightnessChange}),Oe.default.createElement(E.Spacer,{count:2}),Oe.default.createElement(E.Input.Label,{label:u}),Oe.default.createElement(XU,{ref:this.hueRef,onChange:this.onHueChange}),Oe.default.createElement(E.Spacer,{count:2}),Oe.default.createElement(E.Input.Label,{label:m}),Oe.default.createElement(qU,{ref:this.opacityRef,opaqueColor:k,transparentColor:A,onChange:this.onAlphaChange}),Oe.default.createElement(ZU,null,Oe.default.createElement(zF,{value:f,label:a,onChange:this.onHexValueChange}),Oe.default.createElement(JU,null,Oe.default.createElement(a_,{value:x,label:l,onChange:this.onInputChange("r")}),Oe.default.createElement(a_,{value:_,label:c,onChange:this.onInputChange("g")}),Oe.default.createElement(a_,{value:D,label:d,onChange:this.onInputChange("b")}))))))}};d_.defaultProps={direction:"bottom",showArrow:!0};JF.defaultProps={theme:fr};var pd=class extends Pm.default.Component{constructor(t){super(t);this.onClick=t=>e=>{let{onAddSnapshot:r,config:o,onChange:s,colorPickerDirection:n,rect:a}=this.props,{activeIdentifier:l,showColorPicker:c,colorList:d}=this.state,u=d.find(m=>m.identifier===t);if(l===u.identifier&&!c){this.UIComponent||Promise.resolve().then(()=>y(QF())).then(({ColorPicker:Z})=>{this.UIComponent=Z,this.forceUpdate()});let{left:m,width:p,top:f,height:v}=e.currentTarget.getBoundingClientRect(),{left:x,top:_}=e.currentTarget.parentElement.getBoundingClientRect(),{colorPicker:D}=o.measurements.color,k=D.arrow.width/2,A=m-x+p/2-2,B=n==="bottom"?f-_+v+k:f-_-k,T=-24,F=D.width-D.arrow.width-12;A>F&&(T+=A-F,A-=T);let q=!0;if(n==="bottom"&&a){let Z=a.height,pt=a.top,xt=f-pt,ht=Z-(xt+v),ut=o.measurements.color.colorPicker.height+k;ht<ut&&(B=ht-ut),xt+B<xt+v/2&&(B+=k,q=!1)}this.setState({showColorPicker:!0,showColorPickerArrow:q,arrowOffset:A,topOffset:B,leftOffset:T})}else c?this.setState({showColorPicker:!1}):(s(u.color),this.setState({activeIdentifier:t}),r&&r())};this.onChange=({color:t,colorString:e})=>{let{onChange:r}=this.props,{activeIdentifier:o,colorList:s}=this.state,n=s.findIndex(a=>a.identifier===o);if(n!==-1){let a=[...s];a[n]={identifier:s[n].identifier,colorString:e,color:t},this.setState({colorList:a})}r(t)};this.onChangeColorPicker=({color:t,colorString:e})=>{this.onChange({color:[t[0]/255,t[1]/255,t[2]/255,t[3]],colorString:e})};this.closeColorPicker=()=>{this.setState({showColorPicker:!1})};this.getColorPicker=()=>{let{activeColor:t,labelsColor:e,colorPickerDirection:r,onAddSnapshot:o}=this.props,{showColorPicker:s,showColorPickerArrow:n,arrowOffset:a,leftOffset:l,topOffset:c}=this.state;if(!this.UIComponent)return null;let d=this.UIComponent;return Pm.default.createElement(d,{color:at(t),show:s,showArrow:n,direction:r,arrowOffset:a,leftOffset:l,topOffset:c,labelHex:e.hex,labelR:e.r,labelG:e.g,labelB:e.b,labelSliderOpacity:e.sliderOpacity,labelSliderHue:e.sliderHue,onChange:this.onChangeColorPicker,onRequestClose:this.closeColorPicker,onAddSnapshot:o})};let{colors:e}=this.props;this.state={activeIdentifier:"",activeSprite:"",colorList:[...e],showColorPicker:!1,showColorPickerArrow:!1,arrowOffset:0,leftOffset:0,topOffset:0},this.UIComponent=null}static getDerivedStateFromProps({activeSprite:t,activeColor:e},{activeSprite:r,colorList:o}){if(t!==r||!t){let s=on(at(e)),n=o.find(({colorString:a})=>a===s);return{activeSprite:t,activeIdentifier:n?n.identifier:""}}return null}render(){let{isDisabled:t,custom:e,config:r}=this.props,{activeIdentifier:o,colorList:s}=this.state,n=e.getColorItem(),a=r.assetProvider.getPath("controls","/tiled-background.png"),l=s.map(c=>Pm.default.createElement(n,{key:`${c.colorString}-item-${c.identifier}`,isActive:c.identifier===o,isDisabled:t,onClick:this.onClick(c.identifier),color:c.colorString,label:c.identifier,tiledBackgroundUrl:a}));return Pm.default.createElement(tN,{"data-test":H.ColorList},l,this.getColorPicker())}};pd.defaultProps={colorPickerDirection:"bottom",isDisabled:!1},pd=h([P("config","custom"),O],pd);var Re=i=>qC.default.createElement(eh.Consumer,null,({rect:t})=>qC.default.createElement(pd,b(b({},i),{rect:t})));var po=y(require("react"));var eO=y(require("react"));function Ee(){return eO.useContext(jd)}var ts=y(require("react"));var Bm=y(require("react"));var ZC=y(require("styled-components"));var eN=ZC.default(ot.Controls.Container)`
  cursor: none;
`,iN=ZC.default.div`
  position: absolute;
  width: 20px;
  height: 20px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  border-width: 2px;
  border-style: solid;
  box-shadow: 0 0 0 0.5px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 255, 255, 1);
`,iO=class extends Bm.default.Component{constructor(t){super(t);this.INITIAL_POSITION={x:void 0,y:void 0};this.state=b(b({},this.INITIAL_POSITION),{isDrawing:!1});this.containerElementRef=null;this.getCursorCoordinates=t=>{let e=0,r=0;if(t.type.indexOf("touch")!==-1){let a=t;if(!a.touches.length)return b(b({},this.INITIAL_POSITION),{height:0,width:0});e=a.touches[0].clientX,r=a.touches[0].clientY}else{let a=t;e=a.clientX,r=a.clientY}let o=this.containerElementRef.current.getBoundingClientRect(),s=e-o.left,n=r-o.top;return{x:s,y:n,height:o.height,width:o.width}};this.draw=t=>{t.preventDefault(),t.stopPropagation(),this.touchDraw(t)};this.touchDraw=t=>{let{x:e,y:r}=this.getCursorCoordinates(t);e!==void 0&&r!==void 0&&(this.setState({x:e,y:r}),this.state.isDrawing&&this.brushTool.strokePosition({x:e,y:r}))};this.start=()=>{this.brushTool.clickableCanvas(!1),this.setState({isDrawing:!0}),this.brushTool.beginStroke()};this.stop=t=>{this.state.isDrawing&&(t.preventDefault(),t.stopPropagation(),this.setState({isDrawing:!1}),this.brushTool.endStroke(),this.brushTool.clickableCanvas(!0))};this.setInitialPosition=()=>{this.setState(b({},this.INITIAL_POSITION))};this.mouseOut=t=>{let{config:e}=this.props;t.preventDefault(),t.stopPropagation();let r=this.brushTool.sizeOnScreenSpace/2,{x:o,y:s,height:n,width:a}=this.getCursorCoordinates(t);o&&s&&(o<0||s<0||o>a-r||s>n-r||s<e.measurements.mainCanvasActionBar.height)&&this.setInitialPosition()};this.touchEnd=t=>{t.preventDefault(),t.stopPropagation();let{x:e,y:r}=this.state;e&&r&&this.setInitialPosition()};this.getCursor=()=>{let{x:t,y:e}=this.state;if(t&&e){let r=on(this.brushTool.color),o=`${this.brushTool.sizeOnScreenSpace}px`,s={left:`${this.state.x}px`,top:`${this.state.y}px`,borderColor:r,height:o,width:o};return Bm.default.createElement(iN,{style:s,"data-test":H.Cursor})}return null};this.containerElementRef=Bm.default.createRef()}componentDidMount(){document.addEventListener("mouseup",this.stop,!1),document.addEventListener("touchend",this.stop,{passive:!1})}componentWillUnmount(){document.removeEventListener("mouseup",this.stop,!1),document.removeEventListener("touchend",this.stop,!1)}get brushTool(){return this.props.brushTool}render(){return Bm.default.createElement(eN,{ref:this.containerElementRef,"data-test":H.CursorContainer,onMouseMove:this.draw,onTouchMove:this.touchDraw,onMouseDown:this.start,onTouchStart:this.start,onMouseOut:this.mouseOut,onTouchEnd:this.touchEnd},this.getCursor())}},rO=P("brushTool","config")(O(iO));var aO=y(require("react"));var Zo=y(require("react"));var oO=y(require("styled-components"));var Nr=(i,t)=>i!==void 0&&t!==void 0&&!Number.isNaN(i)&&!Number.isNaN(t);var JC=oO.default(ot.Controls.Knob)`
  margin-top: -${i=>i.theme.measurements.canvasControls.knob.touchable.desktop/2}px;
  margin-left: -${i=>i.theme.measurements.canvasControls.knob.touchable.desktop/2}px;
`,{Container:rN}=ot.Controls,sO=class extends Zo.default.Component{constructor(){super(...arguments);this.start=(t,{x:e,y:r})=>{Nr(e,r)&&this.focusTool.setStart({x:e,y:r})};this.end=(t,{x:e,y:r})=>{Nr(e,r)&&this.focusTool.setEnd({x:e,y:r})};this.onKnob1DragStart=(t,e)=>{this.focusTool.clickableCanvas(!1),this.start(t,e)};this.onKnob1DragStop=(t,e)=>{this.addSnapshot(e,this.historyLocale.focusPosition),this.start(t,e),this.focusTool.clickableCanvas(!0)};this.onKnob2DragStart=(t,e)=>{this.focusTool.clickableCanvas(!1),this.end(t,e)};this.onKnob2DragStop=(t,e)=>{this.addSnapshot(e,this.historyLocale.focusPosition),this.end(t,e),this.focusTool.clickableCanvas(!0)};this.addSnapshot=({x:t,y:e},r)=>{Nr(t,e)&&this.focusTool.toolSnapshot(r)};this.getLine=()=>{let{height:t,width:e}=this.props.canvas.canvasSize,r=this.focusTool.startOnPreview,o=this.focusTool.endOnPreview;return Zo.default.createElement("svg",{focusable:"false",height:t,width:e},Zo.default.createElement("line",{x1:r.x,y1:r.y,x2:o.x,y2:o.y,strokeWidth:"2",stroke:"currentColor"}))}}get focusTool(){return this.props.focusTool}get historyLocale(){return this.focusTool.locale.history}render(){return Zo.default.createElement(rN,null,Zo.default.createElement(ot.Controls.Line,null,this.getLine()),Zo.default.createElement(E.Draggable,{bounds:"parent",position:this.focusTool.startOnPreview,onStart:this.onKnob1DragStart,onDrag:this.start,onStop:this.onKnob1DragStop},Zo.default.createElement(JC,null)),Zo.default.createElement(E.Draggable,{bounds:"parent",onStart:this.onKnob2DragStart,onDrag:this.end,onStop:this.onKnob2DragStop,position:this.focusTool.endOnPreview},Zo.default.createElement(JC,null)))}};JC.defaultProps={theme:fr};var nO=P("canvas","focusTool")(O(sO));var Al=y(require("react"));var Mm=class extends Al.default.Component{constructor(){super(...arguments);this.getKnobPosition=()=>{let{focusTool:t}=this.props,{origin:e,size:r}=t,o=r/2,s=Math.PI/2+t.rotation;return{x:e.x+o*Math.cos(s),y:e.y+o*Math.sin(s)}};this.onArea=(t,{x:e,y:r})=>{let{editor:o}=this.props,s=o.configStore.measurements.canvasControls.knob.size;if(Nr(e,r)){let{canvas:n,focusTool:a}=this.props,{size:l,mirroredAreaWidth:c}=a,d=e+c/2,u=r+l/2,m=new R(this.getKnobPosition()),f=new R({x:e,y:r}).subtract(new R(this.areaPosition)),v=m.add(f);v.x>s&&v.x<n.canvasSize.width-s&&v.y>s&&v.y<n.canvasSize.height-s&&a.setOrigin({x:d,y:u})}};this.onKnob=(t,{x:e,y:r})=>{let{focusTool:o}=this.props;if(Nr(e,r)){o.clickableCanvas(!1);let s=new R(o.origin),n=new R(e,r),a=s.subtract(n),l=a.magnitude,c=Math.PI/2+Math.atan2(a.y,a.x);o.setSize(l*2),o.setRotation(c)}};this.onAreaDragStop=(t,e)=>{let{focusTool:r}=this.props;this.addSnapshot(e,r.locale.history.focusPosition),this.onArea(t,e),r.clickableCanvas(!0)};this.onKnobDragStop=(t,e)=>{let{focusTool:r}=this.props;this.addSnapshot(e,r.locale.history.focusSize),this.onKnob(t,e),r.clickableCanvas(!0)};this.addSnapshot=({x:t,y:e},r)=>{let{focusTool:o}=this.props;Nr(t,e)&&o.toolSnapshot(r)}}get areaPosition(){let{focusTool:t}=this.props,{origin:e,size:r,mirroredAreaWidth:o}=t;return{x:e.x-o/2,y:e.y-r/2}}render(){let{x:t,y:e}=this.areaPosition,{focusTool:r}=this.props;return Al.default.createElement(ot.Controls.Container,null,Al.default.createElement(E.Draggable,{bounds:"parent",onStart:this.onKnob,onDrag:this.onKnob,onStop:this.onKnobDragStop,position:this.getKnobPosition()},Al.default.createElement(ot.Controls.Knob,null)),Al.default.createElement(E.Draggable,{onStart:this.onArea,onDrag:this.onArea,onStop:this.onAreaDragStop,position:{x:t,y:e},rotation:r.rotation},Al.default.createElement(ot.Controls.Area,{"data-test":H.Focus,height:r.size,width:r.mirroredAreaWidth})))}};Mm=h([P("focusTool","canvas","editor"),O],Mm);var Fl=y(require("react"));var Lm=class extends Fl.default.Component{constructor(){super(...arguments);this.state={knobAngle:2.35};this.onCircle=(t,{x:e,y:r})=>{if(Nr(e,r)){let{focusTool:o}=this.props;o.setCenter({x:e+o.radius,y:r+o.radius})}};this.onKnob=(t,{x:e,y:r})=>{if(Nr(e,r)){let{focusTool:o}=this.props,s=new R(e,r),a=new R(o.center.x,o.center.y).subtract(s),l=a.magnitude,c=-Math.atan2(a.y,a.x);this.setState({knobAngle:c}),o.setRadius(l)}};this.onCircleDragStart=(t,e)=>{let{focusTool:r}=this.props;r.clickableCanvas(!1),this.onCircle(t,e)};this.onCircleDragStop=(t,e)=>{let{focusTool:r}=this.props;this.addSnapshot(e,r.locale.history.focusPosition),this.onCircle(t,e),r.clickableCanvas(!0)};this.onKnobDragStart=(t,e)=>{let{focusTool:r}=this.props;r.clickableCanvas(!1),this.onKnob(t,e)};this.onKnobDragStop=(t,e)=>{let{focusTool:r}=this.props;this.addSnapshot(e,r.locale.history.focusSize),this.onKnob(t,e),r.clickableCanvas(!0)};this.addSnapshot=({x:t,y:e},r)=>{let{focusTool:o}=this.props;Nr(t,e)&&o.toolSnapshot(r)}}componentDidMount(){this.setState({knobAngle:2.35})}render(){let{focusTool:t}=this.props,{knobAngle:e}=this.state,{center:r,radius:o}=t,s={x:r.x-o,y:r.y-o},n=Math.PI-e,a={x:r.x+o*Math.cos(n),y:r.y+o*Math.sin(n)};return Fl.default.createElement(ot.Controls.Container,null,Fl.default.createElement(E.Draggable,{bounds:"parent",onStart:this.onKnobDragStart,onDrag:this.onKnob,onStop:this.onKnobDragStop,position:a},Fl.default.createElement(ot.Controls.Knob,null)),Fl.default.createElement(E.Draggable,{onStart:this.onCircleDragStart,onDrag:this.onCircle,onStop:this.onCircleDragStop,position:s},Fl.default.createElement(ot.Controls.Circle,{"data-test":H.Focus,radius:o})))}};Lm=h([P("focusTool","canvas"),O],Lm);var lO=O(()=>{let{focusTool:i}=Ee(),{state:t}=i,r=(()=>{switch(t.identifier){case Tt.LINEAR:return nO;case Tt.RADIAL:return Lm;case Tt.MIRRORED:return Mm;default:return null}})();return i.isOptionSelected&&r?aO.default.createElement(r,null):null});var Jo=y(require("react"));var Pl=y(require("react"));var Ol=y(require("react"));var oN=({stickerTool:i,custom:t})=>{let e=i.locale.canvasActions,r=c=>{c.stopPropagation(),i.delete()},o=c=>{c.stopPropagation(),i.bringToFront()},s=c=>{c.stopPropagation(),i.flipHorizontally()},n=({key:c,customButtonKey:d,onClick:u,label:m,icon:p})=>{let f=t.getButton(d);return Ol.default.createElement(f,{key:c,onClick:u,label:m,ariaLabel:m,icon:p})},a={[ct.BRING_TO_FRONT]:{key:ct.BRING_TO_FRONT,customButtonKey:"canvasActionBringToFront",onClick:o,label:e.buttonBringToFront,icon:Ol.default.createElement(Nt.bringToFront,null)},[ct.FLIP]:{key:ct.FLIP,customButtonKey:"canvasActionFlip",onClick:s,label:e.buttonFlipHorizontal,icon:Ol.default.createElement(Nt.flipHorizontal,null)},[ct.DUPLICATE]:{key:ct.DUPLICATE,customButtonKey:"canvasActionDuplicate",onClick:()=>i.duplicate(),label:e.buttonDuplicate,icon:Ol.default.createElement(Nt.duplicate,null)},[ct.DELETE]:{key:ct.DELETE,customButtonKey:"canvasActionDelete",onClick:r,label:e.buttonDelete,icon:Ol.default.createElement(Nt.delete,null)}},l=i.config.canvasActions.map(c=>a[c]?n(a[c]):null);return i.isStickerSelected?Ol.default.createElement(ot.Bar.ButtonGroup,null,l):null},cO=P("stickerTool","custom")(O(oN));var Rl=y(require("react"));var sN=({textTool:i,sprite:t,custom:e})=>{let r=i.locale.canvasActions,o=c=>{c.stopPropagation(),i.delete()},s=c=>{c.stopPropagation(),i.bringToFront()},n=({key:c,customButtonKey:d,onClick:u,label:m,icon:p})=>{let f=e.getButton(d);return Rl.default.createElement(f,{key:c,onClick:u,label:m,ariaLabel:m,icon:p})},a={[ct.EDIT]:{key:ct.EDIT,customButtonKey:"canvasActionEdit",onClick:()=>i.setEditMode(!0),label:r.buttonEdit,icon:Rl.default.createElement(Nt.edit,null)},[ct.BRING_TO_FRONT]:{key:ct.BRING_TO_FRONT,customButtonKey:"canvasActionBringToFront",onClick:s,label:r.buttonBringToFront,icon:Rl.default.createElement(Nt.bringToFront,null)},[ct.DUPLICATE]:{key:ct.DUPLICATE,customButtonKey:"canvasActionDuplicate",onClick:()=>i.duplicate(),label:r.buttonDuplicate,icon:Rl.default.createElement(Nt.duplicate,null)},[ct.DELETE]:{key:ct.DELETE,customButtonKey:"canvasActionDelete",onClick:o,label:r.buttonDelete,icon:Rl.default.createElement(Nt.delete,null)}},l=i.config.canvasActions.map(c=>a[c]?n(a[c]):null);return t.isSpriteText?Rl.default.createElement(ot.Bar.ButtonGroup,null,l):null},dO=P("textTool","sprite","custom")(O(sN));var ya=y(require("react"));var nN=({textDesignTool:i,custom:t})=>{let e=i.locale.canvasActions,r=c=>{c.stopPropagation(),i.delete()},o=c=>{c.stopPropagation(),i.bringToFront()},s=c=>{c.stopPropagation(),i.invertBackground()},n=({key:c,customButtonKey:d,onClick:u,label:m,icon:p})=>{let f=t.getButton(d);return ya.default.createElement(f,{key:c,onClick:u,label:m,ariaLabel:m,icon:p})},a={[ct.EDIT]:{key:ct.EDIT,customButtonKey:"canvasActionEdit",onClick:()=>i.setEditMode(!0),label:e.buttonEdit,icon:ya.default.createElement(Nt.edit,null)},[ct.BRING_TO_FRONT]:{key:ct.BRING_TO_FRONT,customButtonKey:"canvasActionBringToFront",onClick:o,label:e.buttonBringToFront,icon:ya.default.createElement(Nt.bringToFront,null)},[ct.INVERT]:{key:ct.INVERT,customButtonKey:"canvasActionInvert",onClick:s,label:e.buttonInvert,icon:ya.default.createElement(Nt.flipHorizontal,null)},[ct.DUPLICATE]:{key:ct.DUPLICATE,customButtonKey:"canvasActionDuplicate",onClick:()=>i.duplicate(),label:e.buttonDuplicate,icon:ya.default.createElement(Nt.duplicate,null)},[ct.DELETE]:{key:ct.DELETE,customButtonKey:"canvasActionDelete",onClick:r,label:e.buttonDelete,icon:ya.default.createElement(Nt.delete,null)}},l=i.config.canvasActions.map(c=>a[c]?n(a[c]):null);return i.isTextDesignSelected?ya.default.createElement(ot.Bar.ButtonGroup,null,l):null},uO=P("textDesignTool","custom")(O(nN));var zm=class extends Pl.default.Component{constructor(t){super(t);this.actionsRef=null;this.spriteControlPosition=()=>{let{config:t,sprite:e,canvas:{canvasSize:r}}=this.props,{controlPadding:o,controlOffset:s}=t.measurements.canvasControls.sprite,{x:n,y:a}=e.position,{height:l,width:c}=e.currentSprite.size,d=e.rotationWRTOutputRotation,u=this.actionsRef.current,m=new R(0,0);if(u){let v=u.getBoundingClientRect();m=new R(v.width/2+s,v.height+s)}let p=Math.abs(c*Math.sin(d))+Math.abs(l*Math.cos(d)),f=new R(n,a-p/2-o-s).clamp(m,new R(r.width,r.height).subtract(m));return{left:f.x,top:f.y}};this.getSpriteControls=()=>{let{sprite:t}=this.props;switch(t.tool){case C.TEXT:return Pl.default.createElement(dO,null);case C.TEXT_DESIGN:return Pl.default.createElement(uO,null);case C.STICKER:return Pl.default.createElement(cO,null);default:return null}};this.actionsRef=Pl.default.createRef(),this.state={isMounted:!1}}componentDidMount(){this.setState({isMounted:!0})}render(){let{sprite:t}=this.props,{isMounted:e}=this.state,r=!t.isDragMode&&!t.isEditMode,o=this.spriteControlPosition();return Pl.default.createElement(ot.Controls.SpriteActionsWrapper,{"data-test":H.SpriteActions,ref:this.actionsRef,show:r&&e,style:b({},o)},this.getSpriteControls())}};zm=h([P("sprite","config","editor","canvas"),O],zm);var mo=y(require("react"));var{Corner:u_}=ot.Controls,{Draggable:m_}=E,QC=new R(0,0),t1=new R(0,0),mO=O(()=>{let{config:i,sprite:t}=Ee(),{leftTopPosition:e,leftBottomPosition:r,rightTopPosition:o,rightBottomPosition:s}=t,{borderWidth:n}=i.measurements.canvasControls.corner,a=({clientX:u,clientY:m})=>{u!==void 0&&m!==void 0&&t.onCornerDrag(t1.subtract(QC.subtract(new R(u,m))))},l=u=>{switch(u){case"leftTop":return e;case"leftBottom":return r;case"rightTop":return o;case"rightBottom":return s;default:return e}},c=(u,m)=>{let{clientX:p,clientY:f}=u;QC=new R(p,f),t1=new R(l(m)),t.clickableCanvas(!1),t.setDragMode(!0)},d=()=>{t.clickableCanvas(!0),t.setDragMode(!1),t.spriteSnapshot("size"),QC=new R(0,0),t1=new R(0,0)};return mo.default.createElement(mo.default.Fragment,null,mo.default.createElement(m_,{onStop:d,onDrag:a,onStart:u=>c(u,"leftTop")},mo.default.createElement(u_,{"data-test":H.SpriteTopLeft,vertical:"top",horizontal:"left",borderWidth:n})),mo.default.createElement(m_,{onStop:d,onDrag:a,onStart:u=>c(u,"leftBottom")},mo.default.createElement(u_,{"data-test":H.SpriteBottomLeft,vertical:"bottom",horizontal:"left",borderWidth:n})),mo.default.createElement(m_,{onStop:d,onDrag:a,onStart:u=>c(u,"rightTop")},mo.default.createElement(u_,{"data-test":H.SpriteTopRight,vertical:"top",horizontal:"right",borderWidth:n})),mo.default.createElement(m_,{onStop:d,onDrag:a,onStart:u=>c(u,"rightBottom")},mo.default.createElement(u_,{"data-test":H.SpriteBottomRight,vertical:"bottom",horizontal:"right",borderWidth:n})))});var Bl=y(require("react"));var e1=y(require("styled-components"));var aN=e1.default.img`
  position: absolute;
  left: -24px;
  top: calc(50% - 12px);
  cursor: ew-resize;
`,lN=e1.default.img`
  position: absolute;
  right: -24px;
  top: calc(50% - 12px);
  cursor: ew-resize;
`,i1=new R(0,0),r1=new R(0,0),cN=({sprite:i,config:t})=>{let e=i.leftMidPosition,r=i.rightMidPosition,o=t.assetProvider.getPath("controls","/arrow-left.png"),s=t.assetProvider.getPath("controls","/arrow-right.png"),n=(c,d)=>{i.setDragMode(!0),i.clickableCanvas(!1);let{clientX:u,clientY:m}=c;i1=new R(u,m),r1=new R(d==="left"?e:r)},a=()=>{i.clickableCanvas(!0),i.setDragMode(!1),i.addSnapshot(_t.EDIT,i.textDesignLocale.padding),i1=new R(0,0),r1=new R(0,0)},l=({clientX:c,clientY:d})=>{if(c!==void 0&&d!==void 0){let u=r1.subtract(i1.subtract(new R(c,d)));i.onPaddingDrag(u)}};return Bl.default.createElement(Bl.default.Fragment,null,Bl.default.createElement(E.Draggable,{onStart:c=>n(c,"left"),onDrag:l,onStop:a},Bl.default.createElement(aN,{src:o})),Bl.default.createElement(E.Draggable,{onStart:c=>n(c,"right"),onDrag:l,onStop:a},Bl.default.createElement(lN,{src:s})))},pO=P("sprite","config")(O(cN));var o1=y(require("react"));var hO=y(require("styled-components"));var fO=hO.default(ot.Controls.Knob)`
  margin-left: -11px;
  margin-top: 0px;
  cursor: url(${i=>i.url}) 9 9, ew-resize;
  &:before {
    top: unset;
    bottom: 0px;
    left: calc(
      50% - ${i=>i.theme.measurements.canvasControls.knob.size/2}px
    );
  }
`,s1=new R(0,0),n1=new R(0,0),dN=({config:i,sprite:t,snapping:e})=>{let r=t.rightBottomHandlePosition,o=t.leftBottomHandlePosition,s={x:(r.x+o.x)/2,y:(r.y+o.y)/2},n=({clientX:u,clientY:m})=>{s1=new R(u,m),n1=new R(s),t.setDragMode(!0),t.clickableCanvas(!1)},a=()=>{t.clickableCanvas(!0),t.setDragMode(!1),t.spriteSnapshot("rotation"),e.hideRotationGuides(),s1=new R(0,0),n1=new R(0,0)},l=({clientX:u,clientY:m})=>{if(u!==void 0&&m!==void 0){let p=n1.subtract(s1.subtract(new R(u,m))),f=t.position,v=new R(f.x,f.y),x=p.subtract(v),_=Math.atan2(x.y,x.x)-Math.PI/2,D=e.snapToRotation(_,x,t.currentRect);t.setRotation(D)}},c=u=>{l(u)},d=i.assetProvider.getPath("controls",`/${kw()?"rotate-windows":"rotate-osx"}.png`);return o1.default.createElement(E.Draggable,{onStart:n,onDrag:c,onStop:a},o1.default.createElement(fO,{url:d}))};fO.defaultProps={theme:fr};var gO=P("sprite","snapping","config")(O(dN));var Ml=y(require("react"));var p_=y(require("styled-components"));var bO=p_.default(ot.Controls.Width)`
  cursor: ew-resize;
  @media all and (min-width: 0) and (max-width: 599px) {
    display: none;
  }
`,_O=p_.default(bO)`
  left: -3px;
  top: calc(
    50% - ${i=>i.theme.measurements.canvasControls.width.size/2}px
  );
`,yO=p_.default(bO)`
  right: -3px;
  top: calc(
    50% - ${i=>i.theme.measurements.canvasControls.width.size/2}px
  );
`,a1=new R(0,0),l1=new R(0,0),uN=({sprite:i,textTool:t})=>{let e=i.leftMidPadPosition,r=i.rightMidPadPosition,o=(a,l)=>{i.setDragMode(!0),i.clickableCanvas(!1);let{clientX:c,clientY:d}=a;a1=new R(c,d),l1=new R(l==="left"?e:r)},s=()=>{i.clickableCanvas(!0),i.setDragMode(!1),i.addSnapshot(_t.EDIT,i.textLocale.width),t.updateDefaultFontSize(),a1=new R(0,0),l1=new R(0,0)},n=({clientX:a,clientY:l})=>{if(a!==void 0&&l!==void 0){let c=l1.subtract(a1.subtract(new R(a,l)));i.onWidthDrag(c)}};return Ml.default.createElement(Ml.default.Fragment,null,Ml.default.createElement(E.Draggable,{onStart:a=>o(a,"left"),onDrag:n,onStop:s},Ml.default.createElement(_O,null)),Ml.default.createElement(E.Draggable,{onStart:a=>o(a,"right"),onDrag:n,onStop:s},Ml.default.createElement(yO,null)))};_O.defaultProps={theme:fr};yO.defaultProps={theme:fr};var xO=P("sprite","textTool")(O(uN));var{Draggable:mN}=E,c1=new R(0,0),d1=new R(0,0),vO=O(()=>{let{active:i,config:t,snapping:e,sprite:r}=Ee(),o=({clientX:x,clientY:_})=>{let D=d1.subtract(c1.subtract(new R(x,_))),{x:k,y:A}=e.snapToPosition({x:D.x,y:D.y},r.currentRect);r.setPosition({x:k,y:A})},s=x=>{let{clientX:_,clientY:D}=x;c1=new R(_,D),d1=new R(r.position),r.setDragMode(!0),e.updateGuides()},n=()=>{c1=new R(0,0),d1=new R(0,0),r.setDragMode(!1),r.spriteSnapshot("position"),e.hidePositionGuides()},a=x=>{x.preventDefault(),x.stopPropagation(),r.setEditMode(!0)};if(!(()=>{let x=i.tool,_=r.tool;return r.isSpriteSelected&&x===_})())return null;let{isSpriteText:c}=r,d=r.isSpriteTextDesign&&r.textDesignToolStore.isInverted,{height:u,width:m}=r.size,p=r.spritePosition,f=r.rotationWRTOutputRotation,{controlPadding:v}=t.measurements.canvasControls.sprite;return Jo.default.createElement(ot.Controls.Container,null,Jo.default.createElement(mN,{onStart:s,onDrag:o,onStop:n,rotation:f,position:p},Jo.default.createElement(ot.Controls.Sprite,{"data-test":H.Sprite,onDoubleClick:a,height:u,width:m},c&&Jo.default.createElement(xO,null)||null,d&&Jo.default.createElement(pO,null)||null,Jo.default.createElement(mO,null),Jo.default.createElement(ot.Controls.RotateHandle,{x:m/2+v/2},Jo.default.createElement(gO,null)))),Jo.default.createElement(zm,null))});var un=y(require("react"));var fi=y(require("react"));var dn=y(require("styled-components"));var{GridLine:h_}=ot.Crop,pN=ot.Crop.Mask,{Draggable:Um}=E,xa=3,hN=dn.default(Xa)`
  left: ${xa}px;
  top: ${xa}px;
  @media all and (min-width: 0) and (max-width: 599px) {
    left: 6px;
    top: 6px;
  }
`,fN=dn.default(Xa)(i=>{let{desktop:t}=i.theme.measurements.canvasControls.corner.touchable,e=t/4-i.borderWidth;return dn.css`
    left: ${e-t}px;
    top: ${xa}px;
    @media all and (min-width: 0) and (max-width: 599px) {
      left: -30px;
      top: 6px;
    }
  `}),gN=dn.default(Xa)(i=>{let{desktop:t}=i.theme.measurements.canvasControls.corner.touchable,e=t/4-i.borderWidth;return dn.css`
    left: ${e-t}px;
    top: ${e-t}px;
    @media all and (min-width: 0) and (max-width: 599px) {
      left: -30px;
      top: -30px;
    }
  `}),bN=dn.default(Xa)(i=>{let{desktop:t}=i.theme.measurements.canvasControls.corner.touchable,e=t/4-i.borderWidth;return dn.css`
    top: ${e-t}px;
    left: ${xa}px;
    @media all and (min-width: 0) and (max-width: 599px) {
      top: -30px;
      left: 6px;
    }
  `}),_N=({transformTool:i})=>{let{leftTopRespectFlip:t,leftBottomRespectFlip:e,rightTopRespectFlip:r,rightBottomRespectFlip:o}=i,{height:s,width:n}=i.cropMaskSize,{maxCropMaskSize:a,defaultCropMaskPosition:l}=i,{isFlippedHorizontal:c,isFlippedVertical:d}=i,u=a.width/2,m=a.height/2,p=b(b({},a),{left:l.x,top:l.y}),f={height:s,width:n},v=i.isDragMode?{transition:"unset"}:{},x=it=>c?u*2-it:it,_=it=>d?m*2-it:it,D=(it,lt,mt)=>{let bi=x(it),Ji=_(lt);switch(Fe.getFlippedEdgeIndex(mt,c,d)){case 0:i.onLeftTop({x:bi,y:Ji});break;case 1:i.onLeftBottom({x:bi,y:Ji});break;case 2:i.onRightTop({x:bi,y:Ji});break;case 3:i.onRightBottom({x:bi,y:Ji});break}},k=(it,lt,mt)=>{i.setDragMode(!0),i.clickableCanvas(!1),D(it,lt,mt)},A=(it,lt,mt)=>{D(it,lt,mt)},B=(it,lt,mt)=>{i.setDragMode(!1),D(it,lt,mt),i.clickableCanvas(!0),i.addLocalSnapshot()},T=(it,{x:lt,y:mt})=>{k(lt,mt,0)},F=(it,{x:lt,y:mt})=>{A(lt,mt,0)},q=(it,{x:lt,y:mt})=>{B(lt,mt,0)},Z=(it,{x:lt,y:mt})=>{k(lt,mt,1)},pt=(it,{x:lt,y:mt})=>{A(lt,mt,1)},xt=(it,{x:lt,y:mt})=>{B(lt,mt,1)},ht=(it,{x:lt,y:mt})=>{k(lt,mt,2)},ut=(it,{x:lt,y:mt})=>{A(lt,mt,2)},Yt=(it,{x:lt,y:mt})=>{B(lt,mt,2)},ri=(it,{x:lt,y:mt})=>{k(lt,mt,3)},Ve=(it,{x:lt,y:mt})=>{A(lt,mt,3)},Sr=(it,{x:lt,y:mt})=>{B(lt,mt,3)},wt=(it,lt)=>{let mt=x(it+n/2)-n/2,bi=_(lt+s/2)-s/2;i.changePosition({x:mt,y:bi})},ce=(it,{x:lt,y:mt})=>{i.setDragMode(!0),i.clickableCanvas(!1),wt(lt,mt)},Qt=(it,{x:lt,y:mt})=>{wt(lt,mt)},Xt=(it,{x:lt,y:mt})=>{i.setDragMode(!1),wt(lt,mt),i.clickableCanvas(!0),i.addLocalSnapshot()};return fi.default.createElement("div",{style:b(b({},p),{position:"absolute"})},fi.default.createElement(Um,{bounds:"parent",position:t,onStart:ce,onDrag:Qt,onStop:Xt},fi.default.createElement(pN,{style:b(b({},f),v)})),fi.default.createElement(h_,{style:b({left:t.x+n/3,top:t.y,height:s,width:1},v)}),fi.default.createElement(h_,{style:b({left:t.x+n/3*2,top:t.y,height:s,width:1},v)}),fi.default.createElement(h_,{style:b({left:t.x,top:t.y+s/3,height:1,width:n},v)}),fi.default.createElement(h_,{style:b({left:t.x,top:t.y+s/3*2,height:1,width:n},v)}),fi.default.createElement(Um,{bounds:"parent",position:b({},t),onStart:T,onDrag:F,onStop:q},fi.default.createElement(hN,{"data-test":H.CropTopLeft,vertical:"top",horizontal:"left",borderWidth:xa,style:v})),fi.default.createElement(Um,{bounds:"parent",position:e,onStart:Z,onDrag:pt,onStop:xt},fi.default.createElement(bN,{"data-test":H.CropBottomLeft,vertical:"bottom",horizontal:"left",borderWidth:xa,style:v})),fi.default.createElement(Um,{bounds:"parent",position:r,onStart:ht,onDrag:ut,onStop:Yt},fi.default.createElement(fN,{"data-test":H.CropTopRight,vertical:"top",horizontal:"right",borderWidth:xa,style:v})),fi.default.createElement(Um,{bounds:"parent",position:o,onStart:ri,onDrag:Ve,onStop:Sr},fi.default.createElement(gN,{"data-test":H.CropBottomRight,vertical:"bottom",horizontal:"right",borderWidth:xa,style:v})))},CO=P("transformTool")(O(_N));var Ca=y(require("react"));var hd=y(require("styled-components"));var Qo=y(require("react"));var va=y(require("styled-components"));var SO=va.default.div`
  overflow: hidden;
  display: none;
  position: relative;
  transform: unset !important;
  vertical-align: bottom;
  ${i=>i.isVisible&&va.css`
      display: inline-block;
    `}
`,yN=va.default.div`
  position: relative;
  cursor: pointer;
  display: flex;
  align-self: center;
`,xN=va.default.div`
  font-size: 15px;
  display: none;
  width: 33px;
  text-align: right;
  color: ${i=>i.theme.foreground};
  z-index: 1;
  margin: 2px;
  ${i=>i.isVisible&&va.css`
      display: inline-block;
    `}
`,vN=va.default.div`
  transform: translate(0, 0) !important;
`,wO=class extends Qo.default.Component{constructor(){super(...arguments);this.SLIDER_WIDTH=213;this.MAX_ROTATION=45;this.DEGREES_PER_PIXEL=this.MAX_ROTATION*2/this.SLIDER_WIDTH;this.drag=(t,{x:e})=>{let{flipHorizontally:r,flipVertically:o}=this.transformTool.rotateFlipState;r!==o&&(e*=-1);let s=this.transformTool.defaultAngle-e*this.DEGREES_PER_PIXEL,n=Math.min(this.MAX_ROTATION,Math.max(s,this.MAX_ROTATION*-1));this.transformTool.setRotation(parseInt(`${n}`,10))};this.stop=()=>{this.transformTool.setDefaultAngle(this.transformTool.rotationInDegrees),this.transformTool.addLocalSnapshot()}}get transformTool(){return this.props.transformTool}render(){let{config:t,canvasWidth:e,transformTool:r}=this.props,{flipHorizontally:o,flipVertically:s}=this.transformTool.rotateFlipState,n=!t.isLayoutAdvanced||t.isLayoutAdvanced&&e>t.measurements.canvas.transform.minSliderWidth,a=!t.isLayoutAdvanced||t.isLayoutAdvanced&&e>t.measurements.canvas.transform.minValueWidth,l=this.transformTool.rotationInDegrees-this.transformTool.defaultAngle,c=o===s?l*-1:l,d=o!==s?r.rotationInDegrees*-1:r.rotationInDegrees;return Qo.default.createElement(yN,{"data-test":H.RotateSlider},Qo.default.createElement(E.Draggable,{axis:"x",position:{x:0,y:0},onStart:this.drag,onDrag:this.drag,onStop:this.stop,updateOnPosition:!0,disabled:!n},Qo.default.createElement(vN,null,Qo.default.createElement(SO,{isVisible:n},Qo.default.createElement(Nt.dots,{width:90,height:15,x:c})),Qo.default.createElement(xN,{isVisible:a},d,"\xB0"),Qo.default.createElement(SO,{isVisible:n},Qo.default.createElement(Nt.dots,{width:90,height:15,x:c})))))}},kO=P("transformTool","config")(O(wO));var CN=hd.default(Nt.rotate)`
  height: 16px;
  width: 16px;
  transform: scaleX(-1);
`,SN=hd.default(Nt.rotate)`
  height: 16px;
  width: 16px;
`,wN=hd.default(Nt.flipHorizontal)`
  height: 16px;
  width: 16px;
`,kN=hd.default(Nt.flipVertical)`
  height: 16px;
  width: 16px;
`,TN=hd.default.div`
  display: inline-flex;
  transform: scale(0.9);
`,DN=({transformTool:i,config:t,custom:e,canvas:r})=>{let o=i.locale.transformActions,s=r.canvasSize.width,n=!t.isLayoutAdvanced||t.isLayoutAdvanced&&s>t.measurements.canvas.transform.minFlipWidth,a=({customButtonKey:p,onClick:f,label:v,icon:x})=>{let _=e.getButton(p);return Ca.default.createElement(_,{key:v,onClick:f,label:v,ariaLabel:v,icon:x,style:{margin:"0 5px"}})},l=a({label:o.buttonFlipHorizontal,icon:Ca.default.createElement(wN,null),onClick:()=>{i.flipHorizontally()},customButtonKey:"transformActionFlipHorizontal"}),c=a({label:o.buttonFlipVertical,icon:Ca.default.createElement(kN,null),onClick:()=>{i.flipVertically()},customButtonKey:"transformActionFlipVertical"}),d=a({label:o.buttonRotateClockwise,icon:Ca.default.createElement(CN,null),onClick:i.rotateClockwise,customButtonKey:"transformActionRotateClockwise"}),u=a({label:o.buttonRotateAntiClockwise,icon:Ca.default.createElement(SN,null),onClick:i.rotateAntiClockwise,customButtonKey:"transformActionRotateAntiClockwise"}),m=t.isLayoutAdvanced?{transform:"rotate(180deg)"}:{};return Ca.default.createElement(TN,{style:m,"data-test":H.FlipRotateControls},i.config.enableFlip&&n&&l||null,i.config.enableFlip&&n&&c||null,i.config.enableRotation&&Ca.default.createElement(kO,{canvasWidth:s})||null,i.config.enableRotation&&u||null,i.config.enableRotation&&d||null)},Nm=P("transformTool","config","custom","canvas")(O(DN));var IN=ot.Bar.Index,{Backdrop:f_}=ot.Crop,EN=({transformTool:i,canvas:t,config:e})=>{let{leftTopRespectFlip:r,leftBottomRespectFlip:o,rightTopRespectFlip:s}=i,{height:n}=i.cropMaskSize,{height:a,width:l}=t.canvasSize,{defaultCropMaskPosition:c}=i,d=i.isDragMode?{transition:"unset"}:{};return un.default.createElement(ot.Controls.Container,null,un.default.createElement(f_,{style:b({left:0,top:0,width:l,height:r.y+c.y},d)}),un.default.createElement(f_,{style:b({left:0,top:r.y+c.y,width:c.x+r.x,height:n},d)}),un.default.createElement(f_,{style:b({left:s.x+c.x,top:s.y+c.y,width:l-s.x-c.x,height:n},d)}),un.default.createElement(f_,{style:b({left:0,top:o.y+c.y,width:l,height:a-o.y-c.y+e.measurements.basicToolControlBar.controlsBarHeight},d)}),un.default.createElement(CO,null),e.isLayoutAdvanced?un.default.createElement(IN,{bottom:!0},un.default.createElement(Nm,null)):null)},TO=P("transformTool","canvas","config")(O(EN));var g_=y(require("react"));var b_=y(require("styled-components"));var AN=b_.default(ot.Controls.Container)`
  ${i=>i.activeCursor?b_.css`
          cursor: move;
        `:""}
  z-index: ${i=>i.theme.measurements.zIndex.canvas.crop.dragImage};
`,DO=class extends g_.default.Component{constructor(t){super(t);this.INITIAL_POSITION={x:void 0,y:void 0};this.state=b(b({},this.INITIAL_POSITION),{isDragging:!1});this.containerRef=null;this.getCursorCoordinates=t=>{let e=0,r=0;if(t.type.indexOf("touch")!==-1){let a=t;if(!a.touches.length)return this.INITIAL_POSITION;e=a.touches[0].clientX,r=a.touches[0].clientY}else{let a=t;e=a.clientX,r=a.clientY}let o=this.containerRef.current.getBoundingClientRect(),s=e-o.left,n=r-o.top;return{x:s,y:n}};this.move=t=>{if(this.scale.canDrag){let{x:e,y:r}=this.getCursorCoordinates(t);if(e!==void 0&&r!==void 0&&this.state.isDragging){let o={x:this.state.x-e,y:this.state.y-r};this.scale.setOffset(o)}}};this.touchDrag=t=>{if(this.scale.canDrag){let{x:e,y:r}=this.getCursorCoordinates(t);e!==void 0&&r!==void 0&&this.setState({x:e,y:r,isDragging:!0})}};this.drag=t=>{t.preventDefault(),this.touchDrag(t)};this.stop=()=>{this.scale.canDrag&&(this.scale.savePosition(),this.setState(b(b({},this.INITIAL_POSITION),{isDragging:!1})))};this.touchEnd=t=>{t.preventDefault(),t.stopPropagation();let{x:e,y:r}=this.state;e&&r&&this.setState(b(b({},this.INITIAL_POSITION),{isDragging:!1}))};this.containerRef=g_.default.createRef()}componentDidMount(){document.addEventListener("mouseup",this.stop,!1),document.addEventListener("touchend",this.stop,{passive:!0})}componentWillUnmount(){document.removeEventListener("mouseup",this.stop,!1),document.removeEventListener("touchend",this.stop,!1)}get scale(){return this.props.scale}render(){return g_.default.createElement(AN,{ref:this.containerRef,onMouseMove:this.move,onTouchMove:this.move,onMouseDown:this.drag,onTouchStart:this.touchDrag,onMouseUp:this.stop,onTouchEnd:this.touchEnd,activeCursor:this.scale.canDrag})}},IO=P("scale")(O(DO));var EO=O(({children:i})=>{let t=ts.useRef(null),{active:e,sprite:r,canvas:o}=Ee(),s=()=>{switch(e.tool){case C.FOCUS:return ts.default.createElement(lO,null);case C.TEXT:case C.TEXT_DESIGN:case C.STICKER:return ts.default.createElement(vO,null);case C.BRUSH:return ts.default.createElement(rO,null);case C.TRANSFORM:return ts.default.createElement(TO,null);default:return ts.default.createElement(ot.Controls.Container,null,ts.default.createElement(IO,null))}},n=c=>{if(c.preventDefault(),c.stopPropagation(),o.isCanvasClickable){let{clientX:d}=c,{clientY:u}=c;if(c.type.indexOf("touch")!==-1){let v=c;if(!v.touches.length)return;d=v.touches[0].clientX,u=v.touches[0].clientY}let m=t.current.getBoundingClientRect(),p=d-m.left,f=u-m.top;o.getContainersAtPreviewPoint({x:p,y:f})}},a=c=>{c.code==="Tab"&&r.selectLast()},{canvasSize:l}=o;return ts.default.createElement(ot.Controls.Wrapper,{"aria-hidden":!0,ref:t,onClick:n,onKeyDown:a,height:l.height,width:l.width},i,s())});var __=y(require("react"));var Ll=y(require("styled-components"));var AO=y(require("react")),FO=y(require("styled-components")),FN=FO.default.div`
  display: ${({isVisible:i})=>i?"block":"none"};
  position: absolute;
  z-index: ${i=>i.theme.measurements.zIndex.canvas.snappingGuide};
`,ON=({isVisible:i,className:t})=>AO.default.createElement(FN,{isVisible:i,className:t}),u1=ON;var RN=Ll.default(u1)`
  background: ${i=>i.theme.snapping.positionGuideColor};
  ${i=>i.direction==="horizontal"?Ll.css`
        width: 100%;
        height: 2px;
        top: ${()=>i.position}px;
      `:Ll.css`
      width: 2px;
      height: 100%;
      left: ${()=>i.position}px;
    `}
`,PN=Ll.default(u1)`
  border: none;
  border-top: 2px dashed ${i=>i.theme.snapping.rotationGuideColor};
  background: transparent;
  left: ${({position:i})=>i.x}px;
  top: ${({position:i})=>i.y}px;
  transform: rotate(${({rotation:i})=>i}rad);
  width: 200%;
`,BN=Ll.default.div`
  position: absolute;
  width: ${({width:i})=>i}px;
  height: ${({height:i})=>i}px;
  top: ${({top:i})=>i}px;
  left: ${({left:i})=>i}px;
  overflow: hidden;
`,MN=({snapping:i,editor:t})=>{let{width:e,height:r}=t.getPreviewSize(),{x:o,y:s}=i.previewTopLeftPosition,n=i.positionGuides.map(({direction:l,value:c,isVisible:d},u)=>__.default.createElement(RN,{key:`positionGuide-${u}`,direction:l,position:c,isVisible:d})),a=i.rotationGuides.find(({isVisible:l})=>l);return __.default.createElement(BN,{"data-test":H.SnappingLine,width:e,height:r,left:o,top:s},n,__.default.createElement(PN,{key:"rotationGuide",rotation:a?a.value:0,position:a?a.position:{x:0,y:0},isVisible:!!a}))},OO=P("snapping","editor")(O(MN));var RO=y(require("react")),PO=y(require("styled-components"));var LN=PO.default.img`
  z-index: 5;
  position: absolute;
  bottom: 30px;
  right: 30px;
`,BO=()=>RO.default.createElement(LN,{alt:"watermark","data-test":H.Watermark,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKoAAAAvCAYAAABzC1HpAAAAAXNSR0IArs4c6QAAE7NJREFUeAHtnFlQVdeax2UQBAEFFUUccJ7nAVEDGqNeZxOjiRq9uVpJ3apUP3TnPZXHVKUqlYcMLzGxTXc00XSMxjjjiAMqKijOAiLiBIID89C//9J1antyjp6g1zZde1cd9t5rr/Fb/+//DXtr0EcffbS4WbNmvfi5hyuBl1UCF4KZmQvSl3V73HlZCfQSUN3DlcBLLwEXqC/9FrkTlARcoLo4+EtIwAXqX2Kb3Em6QHUx8JeQgAvUv8Q2uZN87kA9dOhQjzVr1kzyJ9qLFy+29ffMLXcl4E8CzxWot27diszIyJh67dq1XuvWrUt1DnrkyJGkr7/+ehHlS69fvx7lfOZeuxJ4mgRC0tLSJjytUqDPAeGUmJiYkpkzZ24+cODAqxUVFTVhYWFVP/7446zz588P6dWrV3ZVVVV4cHBwZVJS0u1A+3XruRJoEqM2NDQ027lz56CrV6+2siLMyclJhFGTpk+fvicxMfHu1KlTf83KypqwevXqpdHR0Xfee++9FdOmTTvWoUOHQhg1wbZzz64EApFAaCCVvOvcvHkzClM++ejRow0tW7Ys7datWy6g7QFjHo+Nja1S/QEDBhTjjx4pKCjoO3/+/PSQkJBGlbdr1+7W6dOnh5aWlkbU1NSEwLj1rVq1qrLPVcc9XAl4S6BJph9QxgLAJFjyG9i1EkAOuHfvXrvXX399U0RERJ0dBOAWHTt2bNCDBw8aAXD57t27h5w5c2bY3bt3O1A+6sSJEyN0xk1IyczMHAzb5lGv0rZ3z64ErASaxKj4nuEwYDX+aA0+7hmYMaywsLCrZVPbuVgSZs0CkCknT55MiYqKKh00aNBR/NPi1q1bV+ASVOOzhl66dKn9li1b5nXs2LHctnXPrgScEmgSUOvr6x/zbfFN4zHpN5wd2+uuXbsWHz58OGrYsGG78VuP23J7joyMrMNnbRcXF1cYHh5eb8vdsysBpwSaBNTmzZvXNzY2esAKcEOJ5BucHdvrffv2jYFBs32B1Na5fPlyn549e56298/jjA/d7cqVK4mDBw8+hwty63n0+SL6KC4ujiYXPRiLUzZx4kQjE1yjnjdu3OgwZMiQM927dy95EfN42cYIGKgS4NmzZ7ty7lhSUpKA39nmk08++Q/Mu/FJAW+t9+IImhJg227Lli1b4f3M3p87dy7+zp07ibQ/acuedEYpgkiDTZS7Yetp7DZt2pSMHj36DIFZtcoPHjw4ARclNjQ0tP7/Cqhbt24dRuDZ3s7TnlHqxlmzZu2S62TL7JkAtT8yScbXL7dAxSK9Wl1dHdWiRYvKFwnU8vLy8L179yrwbSsiio+Pv/7KK6/kyApqvr/88svY+/fvx9i5YxGrkf+dUaNGncNCPhZr7Nmzpx/7EUHmJ8vWJ86Jpf/klJSUoxDVE9OVAQFVgNu4ceNCJlHMZK/CUplc32My9xFgc5irw/Hjx9NYUIZzgrBpWp8+fTKdZXaS9kwQNVz9woCvskEDWcj2Tp06+fVVWVxcXl7eUNvenvPz85uhSEPfeeedNfKVtbF6hl9839ZpylkKytr/BuBr6XsDWQqflsNX38gtGYWK9PUMRT/gC6iUm3kDSs+8qXezkoPsylX1RZ/BP/zww0zO4aQDtz1JXr7GDqSsqKgohjeMiwHfg4SEhDzk2eLUqVNj2EsBMV99kBsfhayvMb9S3Qu0xCr9SFWOJ3bZRL08lesg4O4LqYnMDFCV9Vm/fv0b9FeM8j0RpGofEFD79etXTN60DNNzZOzYsRfV0HmIsVhYZwKicYsWLdqhZ5irXsg2etKkSR4NcrbRNcBqj3/aCwCsREtr1F5515EjR6ZbNvFuA/uajVS5XAoEWQlrdRIrs8lxMFJv5ngG5m2uOgD1gc5NPQj0OiLUzmqv4DDQfsT8FqSwfUHbtm2v27aAsKp9+/b37L3zDOv8AajLly9f76yDzGL49VQZaw53Pnte19u3b5/AnpS///77q+26AWu6jSPEtrh/IcQeR52AVDkAnwtJTe3du/d3kJCxcLRtiQyMonEdsnbt2tlSxgULFmyFrZ867YCAqo4A6zGi92RfQNUoAHI/Wv4ubJdFwr8MhkwViDZs2JDmbxa8aoXxe2ahsWbT3nrrrXTMXP6uXbvmqo0vsJLa8gB1ypQphsG18M8///zf5DeXlZXF3r5921OHOdTAiMn4eImAthwG2udkMvzjNmQk+gDG9mJN2KmAcXO0ZtyWlrDIMM0lKCiogfX9bfbs2ekSvl56YM4GyhUCLNH0eWfcuHHHLLuprdrpwKqcTk1NPfvw7vG/Yi6UWim7NmQ9CgBqjGoAEqNgKGCL33//PY3x6+fNm7eLOTYgn3G2F15Zj2GuB617k5ub24EUYE/axbP2Klj44vjx48/b+vv37++DLOLHjBlzEms2CGDFLV26dKM3WJBHQo8ePbItSNXeglTXuH9Gxqz7MSKQbMDCTr0qR67d7LpFWuTcTd2ffvppCnsWuWTJktXOPtWvvyMgoKoxVJ7Dpo0mF9p/woQJud4d6m0UFH48PT09TQJn4fWwRj4bGgIrDef5WYT/GIsQMBTLfPz888/B5GD3YTrCWNxIGOgKCuFzY6ljAKCNw2wYPwighNngjrJSJ+synxkwm2kDgJuxyZVz5sw5oPmjTEmsZ5ZlX5UBvN7KYrz99ts7L1y40BHgd1S5+oe5uymlBphCYY2Z3HfXMx1sXFdcoIELFy78T4GVdh6gspkeM/6w9sO/8tFY+wI7P8ZNss9RKiMr5NMRczpA5XV1dXtYQ0vm2MfWYw498Wf36F5+IIHYVCsLlaEIfZFHBj7xYd3z/DX6Cae8J+uIxb83L2j0zHnAdg9YT2/GOmWJxPncyhh5/2Ft8jdRqBrqxKqNrEttbW2E3LBff/11DHNOgpR+8E5nOvv3vg4YqPLNkpOTdxGkTMFHzbMgcXb42muvZX7zzTfLZConT578P0OHDjVUDxOFMdlQGGG/s76utVmbNm2a/v3338/kpUEcQr8nX9CfplnTiKbX024kihBMH2bjxHoI6Sr+agc7DmmzK7DNeX0sg7BawFzmta9YGEd+ukCK332JtWXiNowQUGk/hDUcGDhwYAH+VhECT5QfPWPGjM1iHsA9VCBlDnW020ZZAwCYLADAWCMAeTrto+0cCKrm8TO31G2EldfAsjfpZ5xAylrvQQRbWX9L5DtNFS37oJiGubTxlNUCoLouXbpkA6LBgKyS7yp+lmIwXgRzmCKQdu7c+TR7lMN9ihQIFysZS5L5iB2D1L/myvr2Y45LtCbvA8bdi7s3Z9WqVcvpLxdrcYRU4x1b75Fla4RUKmyZ86y5IW/jflnrwouiLljRPsxlrbU8zjZPuv7jDJ9QG4Eydm040d40aYl3VdE+iz+EUKsQlAGp6vTv3/8sGtxPEb53Gy0eYK5l4W1ZXPW777673h9I1RYTYjYOQYcBolQClvFsZjs9I+rfof5gWMNmKNeDxYsXb0bol2BzI2Q22rAwLkYvAZdmjbD5Vr3yxUwZplVfzDdOLgLgN34pa7sFQMr0jMBgkM6MlS3TJtOKQuSrTCZcZzsHXQOeEPuTwqKMYpsWKIX5F8AjRozYN3z48Cu8DMlXfR2WhS1QkYlhLoENOZkMC/3cFeBVH1AO0BjIvppX1tvp6xq+Y6aeaUzGikEpgiU3lSGrdECeKdno3vvQfDDN32ElT4iVsSB/h7H723qybMi3whfI5RbxIicKmZmg2FoXlCmB+rUQg99g2fbvfQ4YqLBPX8zoHDEIEwlasWLFfF/Aw787iTBrqe9ZFCZ2NEItZ6ETvCegewECd2Ibm6zgysNEvuoCVANCbRzgyGPRl/Glst58881VjH1KbQCJAbOcdStIa16t7wfTxKmuvlWwJoh5eyJ6rs3LBwn8UT3jX0lBYfXWKsPFuaazDsYxbTmbdtpIldNPneZmfwSb3wrwAEd9GGWH8YtUl400bXTNnMx4FvCs19zrmbUqMs+61yHfXGfAcd1mJrzW08Canf0/5oaprffBK+37gH435LFC0b2shiyR6mkfJF/vNrrH2kRJabC6RrGZm5EhLtd6yQeim+GL6Hz1ZcsCMv1ywGEgrPnkXzDnhZiBM/gaqaQXFuKzlcgs2Q6ZYJA0GDM6Ef9qoEyzNhbtXIV5X8Jie/jSYjEA7HiaaDMVwfxm+/M+W+Dg854nYtzt/Vz3jGc2xClI2pky+UmqYwEvFte9Dvw/E8jomk0yWs/GGCHbdjKxPDYAQ/k8bRnTtKWeaWf7B2D35LOpT+dhN09lKI+Rn/X7VIZJfmyejOUBhZWBc32MZ+bpXA9zNW6OXCJlGQiyEtS3DuIDD8gflvj/CyE8gPUPszfzYNfWyuVKWZyK4mwNVgZJQQnkDNvj0kTpXgqKe4jHtmkBQfZYLFmGs92TrgNiVCL5bgxUw8+whTSWiPugqJ9FFGJ+cuyvb9++2ZiN/ZiddJjitD5WIa2VQb0KUhkZRJqp/rSJPg/gz3RjPMN23hOXSbHMaH047zq6txsJAMzm2lSKnlFmTD8bbzZKSiSTqGe4EsakA7bb8sFhs+ZSOj2jzNSHsRR8GHeAuRozr/kCMhN0sRkFqm+BIzBpvfanNehgHp4gBh8yUWVkILrrrE2VP6prFMUqnccXtGVOGdj1wORxGkM/5aXVh4JTmKwZcvAwKooQMFDVB4plFNEqsNbnVBTV0aFPPxUgg4PDNo6R+wJWzHgQUhHuYQZzS1YwaxoF8CcgRoUNtxAMDNWHI5BergC1Y8eOZDbtJqZhj79xcMYHs5i7mPVTqkPAcIr2w3EhhsDOJ7zbaWHKDhBQDEcbTT7WWQdhRcDYBlSW4ZzP7bUFKhtpgMqmGQbUc4QzHpBUw3L5CGsMII388ssvl0vobKRhHJRsv+pa/1TXfOU1Fp82VP4om1wA+yaRrptAUNNDyqjquDA3sBYmz2yBCqt1/vTTT/9dfdiDiHclrHRTlkg+I0HVbOZVyoa2VR0pB67V3Ef5UzN3ANAHeZaS+skRQ6oewB7422+/1cvXJKecp6yD+vjiiy/+ATDruNa8mjFnw1xiNt3DulUwvSEd3XsfemWL4rUGVBfFxGR7OrHW8QRVp5BdnepLxrhdRY8sjHFbUNhO2dnZKci9BIwctf3KwjlBrcCOFFkn3MNp9Pm9XAxb1985IKCqMe/qT5BLzd+2bdur33777TIJkyj+v/11LDYi1TSWV25bYQjDQNJqXpftYWOmM/lIgF6mfhRBItQYgNiBdrEwQKGvfqnjSW4DamNifdWzAQN+lQmg5INSv1CgYax2AiqKUMrG7mUTxsFQ0fppA5nfdvzwy+pXm4IfepZItS/tlJc0Jpq3ZztwfWbJp1afqqvMgYIyrVHHo0DNXHv9aUTJquSX68UGZtJE6lIYNncd6bOZagvQDYOxkRdQ7njmF2UVDiXLQbZpmrNcLfVPOu8C8zxKoDcC2caqjPnehxy2wG7mgyHGMPJjXcZ3VB1fB8+rAGuyglX7HEuRjY/pISVkHEH6bqR+tg7t7pDkz3JkGMwjQN2SZx6fWDJ64403fl+5cuUS3MeZvFRYY+Vm+/I+B/GfpH3sXfi0eyLASWhnLN+jrvNXF4d5HKyT4KvOZ5999k+0zoAIoDYHnHEs8CjaewMXokjA8tcvPlIMi2r0lduzbaTlbFaYMwUi884mxgPY+04NBmxhbHAsgqymfpm3wGRC2Yx4gFXpHFPltGsFC0cCphIBz46vs+YA2Jo7y3SNCayTG2TLVQ8XIhrFuS2XinmHokBtAEYJczLspZcSqi/f0LajTmvAEuIs07NH2YTWkECFctu2vs6SAUFcK/m/yN+4Fs7nzmvVlT+qMejnjp2LrUPQG8XePdRKCtmzCu86tq7WiNJ43BlbLtlDTpHyXW2Zv3OTgIppWYofesDfWyotgsDpH3Pnzl1j35g4J/DVV18txrwe4JcHeNrCTvM//PDDr5113GtXAk4JBGz6bSMxGkzRmug/35Y5z7BPO175zUZjS32BVHUxWZFkCwyr4BY0WL/T2Y977UrAKYE/DVQi1CRo/B7+Sxf5bPI/cQMiMN9RmKPumPvOmKOTmKuhArW3+cHMRcrfkmnTRORjYW6NiXNOzL12JeCUwJ8GKgFHDb5IuaJnfJQwOfjyGeUwEyVm8Jpxm3xATH8kQVMKb4a2Ogckj6oUUBAB2SL8slz6qnTm/px13WtXAlYCfxqoemVov4ixnShPyX8u8QFpqBPWocb/PEZEt5io9oKNohUokGMbTvsNRLZh+Kd9xcAEOFdtX+7ZlYAvCfxpoPrqhAizWu4AH3O0JRVyXflT0iepRIJFfAwyhXfi/yWWpXwkqZlSG4SROskVeIkKPYloX/27Za4EmvTPpX2JTZ+j4ZN24nVrCn5oIknmbXwltJ9P1KJxE5IB6E0S+ZPJQW50fnGD2W8gteN5Femrb7fMlYAnD/asoiAHWUBerA1fSh374IMPvlPqSX3yUmA3IC3n3e5CEtVZ/jIBzzq+2/7/twSalEf1JRIliJWw9vds8+bNybzqO2TfUvmq55a5EvAngefio6pzfyC1z3j9dtDfJNxyVwJPk8BzM/1PG8h97krgWSTgAvVZpOe2fWEScIH6wkTtDvQsEnCB+izSc9u+MAm4QH1honYHehYJ8Jo+OP9ZOnDbuhL4V0tAGDVfh3/88cfmn9D+qwd0+3cl0BQJgM+a/wXEHL3v2Wd6kwAAAABJRU5ErkJggg=="});var mn=y(require("react"));var m1=24,MO=class extends mn.default.Component{constructor(t){super(t);this.init=()=>{navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:!0}).then(t=>{this.video.srcObject=t}).catch(()=>{this.props.modal.showActionModal({type:Vt.ERROR,identifier:"webcamUnavailable",error:"Webcam not supported",handleConfirm:()=>{this.props.active.selectWebcam(!1)}})}):this.props.modal.showActionModal({type:Vt.ERROR,identifier:"webcamUnavailable",error:"Webcam not supported",handleConfirm:()=>{this.props.active.selectWebcam(!1)}})};this.stop=()=>{let{active:t}=this.props;this.video.srcObject.getTracks().forEach(o=>{o.stop()}),this.video.srcObject=null,t.selectWebcam(!1)};this.captureAndCloseWebcam=()=>{this.canvas.width=this.video.videoWidth,this.canvas.height=this.video.videoHeight,this.canvas.getContext("2d").drawImage(this.video,0,0),this.props.active.newImage(this.canvas.toDataURL("image/webp")),this.stop()};this.videoRef=mn.default.createRef()}componentDidMount(){this.canvas=document.createElement("canvas"),this.video=this.videoRef.current,this.init()}render(){let{editor:t}=this.props,{height:e,width:r}=t.getPreviewSize(),{measurements:o}=t.configStore,s=this.props.canvas.canvasSize.height,n=(s-e)/2,a=n<m1+o.buttons.float.size?s-m1*2-o.buttons.float.size/2:s-n+m1,l=this.props.active.webcamLabel;return mn.default.createElement(ot.Wrapper,null,mn.default.createElement(ot.Bar.Index,{transparentBackgound:!0,style:{justifyContent:"flex-end"}},mn.default.createElement(ot.Bar.ButtonGroup,null,mn.default.createElement(Cs,{ariaLabel:l,onClick:this.stop},l))),mn.default.createElement(ot.Webcam,{style:{height:e,width:r},autoPlay:!0,ref:this.videoRef}),mn.default.createElement(ot.Button.Float,{ariaLabel:"Click and Save",style:{top:a},onClick:this.captureAndCloseWebcam}))}},LO=P("active","canvas","modal","editor")(O(MO));var Hm=y(require("react"));var zO=class extends Hm.Component{constructor(t){super(t);this.wrapperElementRef=null;this.timeout=null;this.updateDimensions=(t=!0)=>{t?(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.update(t)},100)):this.update(t)};this.update=(t=!0)=>{let e=this.wrapperElementRef.current;this.props.canvas.saveDimensions({width:e&&e.clientWidth||0,height:e&&e.clientHeight||0,render:t})};this.wrapperElementRef=Hm.default.createRef(),this.resizeObserver=new Xd(()=>{this.updateDimensions(!1)})}componentDidMount(){this.updateDimensions(!1),window.addEventListener("resize",()=>this.updateDimensions(!0)),this.wrapperElementRef.current&&this.resizeObserver.observe(this.wrapperElementRef.current)}componentWillUnmount(){window.removeEventListener("resize",()=>this.updateDimensions(!0)),this.timeout&&clearTimeout(this.timeout)}render(){return Hm.default.createElement(ot.Container,{"data-test":H.CanvasContainer,ref:this.wrapperElementRef},this.props.children)}},UO=P("canvas")(O(zO));var fd=O(()=>{let i=po.useRef(null),{canvas:t,active:e,config:r}=Ee();po.useEffect(()=>{let s=i.current;t.setCanvasElement(s)},[]);let{licenseChecker:o}=r;return po.default.createElement(UO,null,o&&o.isWhiteLabel()?null:po.default.createElement(BO,null),e.isWebcam?po.default.createElement(LO,null):null,po.default.createElement(ot.Element,{ref:i,"aria-label":"Canvas","data-test":H.Canvas}),po.default.createElement(EO,null,po.default.createElement(OO,null)))});var gd=class{constructor(t={},e={}){this.getAdvancedCategoryCard=()=>this.components.advancedUICategoryCard;this.getAdvancedItemCard=()=>this.components.advancedUIItemCard;this.getAdvancedToolbarItem=()=>this.components.advancedUIToolbarItem;this.getDialog=()=>this.components.dialog;this.getButton=t=>this.components.buttons[t];this.getColorItem=()=>this.components.colorItem;this.getCheckbox=()=>this.components.checkbox;let r={dialog:E.Dialog,colorItem:E.ColorItem,checkbox:E.Input.Checkbox,buttons:{mainCanvasActionUndo:ot.Button.TextSecondary,mainCanvasActionRedo:ot.Button.TextSecondary,mainCanvasActionExport:hc,mainCanvasActionClose:Cs,canvasActionEdit:ot.Controls.SpriteActionButton,canvasActionBringToFront:ot.Controls.SpriteActionButton,canvasActionDuplicate:ot.Controls.SpriteActionButton,canvasActionDelete:ot.Controls.SpriteActionButton,canvasActionInvert:ot.Controls.SpriteActionButton,canvasActionFlip:ot.Controls.SpriteActionButton,transformActionFlipHorizontal:Eo,transformActionFlipVertical:Eo,transformActionRotateClockwise:Eo,transformActionRotateAntiClockwise:Eo,textAlignment:Eo,toolControlBarPrimaryButton:pc,toolControlBarSecondaryButton:Cs}};this.components=hr([r,e,t])}};var pn=y(require("react"));var zN=({modal:i,textTool:t,textDesignTool:e,config:r,custom:o})=>{let{type:s,identifier:n,isVisible:a,modalProps:l,positionOffset:c}=i,{headerLabel:d,bodyLabel:u,confirmLabel:m,dismissLabel:p,handleClose:f,handleConfirm:v,handleDismiss:x}=l,_=o.getDialog();if(s===Vt.INFO)return pn.default.createElement(E.InfoModal,{headerLabel:d,bodyLabel:u},pn.default.createElement(_,{type:s,isVisible:a,identifier:n,position:c,handleClose:f,headerLabel:d,bodyLabel:u}));if(s===Vt.TEXT_EDIT){let{buttonSave:D,buttonClose:k}=t.locale.canvasControls,A={type:s,isVisible:i.isVisible,confirmLabel:D,dismissLabel:k,headerLabel:t.locale.canvasControls.inputText,maxLength:r.config.text.maxCharacterLimit};if(t.isTextSelected)return pn.default.createElement(E.TextEditModal,b(b({},A),{defaultText:yt.defaultText(),handleConfirm:t.changeText,handleDismiss:t.setEditMode,text:t.text}),pn.default.createElement(_,{type:s,isVisible:a,identifier:n,position:c,handleClose:f,confirmLabel:D,dismissLabel:k,headerLabel:t.locale.canvasControls.inputText}));if(e.isTextDesignSelected)return pn.default.createElement(E.TextEditModal,b(b({},A),{defaultText:Bt.defaultText(),handleConfirm:e.changeText,handleDismiss:e.setEditMode,text:e.text}),pn.default.createElement(_,{type:s,isVisible:a,identifier:n,position:c,handleClose:f,confirmLabel:D,dismissLabel:k,headerLabel:t.locale.canvasControls.inputText}))}return pn.default.createElement(E.ActionModal,{type:s,headerLabel:d,bodyLabel:u,confirmLabel:m,dismissLabel:p,handleClose:f,handleConfirm:v,handleDismiss:x},pn.default.createElement(_,{type:s,isVisible:a,identifier:n,position:c,confirmLabel:m,dismissLabel:p,headerLabel:d,bodyLabel:u,handleClose:f}))},bd=P("textTool","textDesignTool","modal","config","custom")(O(zN));var zl=y(require("react")),h1=y(require("styled-components"));var Wm=y(require("react")),NO=y(require("styled-components"));var UN=NO.default.div`
  position: absolute;
  right: 8px;
  top: 8px;
`,HO=class extends Wm.default.Component{constructor(t){super(t);this.onChange=t=>{this.setState({value:t.replace(/[^\d.,-]/g,""),isSubmitted:!1})};this.onSubmit=()=>{let{getCorrectValue:t}=this.props,{isSubmitted:e,value:r}=this.state;e||this.setState({value:t(parseInt(r,10)||0).toString(),isSubmitted:!0})};this.state={isSubmitted:!1,value:t.value.toString()}}componentDidUpdate(t){let{value:e}=this.props;t.value!==e&&this.setState({value:e.toString()})}render(){let{id:t,isDisabled:e,label:r}=this.props,{value:o}=this.state;return Wm.default.createElement(E.Input.Text,{id:t,value:o,isDisabled:e,onChange:this.onChange,onBlur:this.onSubmit,onKeyUp:Nw(this.onSubmit)},Wm.default.createElement(UN,null,Wm.default.createElement(E.Input.Label,{label:r,htmlFor:t})))}},p1=HO;var NN=h1.default.div`
  display: inline-flex;
  justify-content: space-between;
  max-width: ${i=>i.theme.measurements.advancedUIToolControlBar.width}px;
`,HN=h1.default.span`
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  margin-top: 10px;
  margin-right: 13px;
`,WN="photoeditorsdk-transformScaleWidth",GN="photoeditorsdk-transformScaleHeight",VN=({showLabel:i=!0,label:t,isDisabled:e,valueHeight:r,valueWidth:o,labelWidth:s,labelHeight:n,onSubmitWidth:a,onSubmitHeight:l})=>zl.default.createElement("div",null,zl.default.createElement(E.Input.Label,{label:t,show:i}),zl.default.createElement(NN,null,zl.default.createElement(p1,{id:WN,value:o,getCorrectValue:a,label:s,isDisabled:e}),zl.default.createElement(HN,null,"x"),zl.default.createElement(p1,{id:GN,value:r,getCorrectValue:l,label:n,isDisabled:e}))),Gm=VN;var XO=y(require("react"));var WO=y(require("react")),GO=y(require("styled-components"));var jN=GO.default(sr)`
  width: ${i=>i.theme.measurements.advancedCard.large.width}px;
  height: ${i=>i.theme.measurements.advancedCard.large.height}px;
  margin-bottom: ${i=>i.theme.measurements.advancedSpacer}px;
  color: ${i=>i.theme.card.foreground};
`,$N=e=>{var{isActive:i}=e,t=_i(e,["isActive"]);return WO.default.createElement(jN,b({},t))},VO=$N;var jO=y(require("styled-components"));var $O=jO.default(sr)`
  width: ${i=>i.theme.measurements.advancedCard.medium.width}px;
  height: ${i=>i.theme.measurements.advancedCard.medium.height}px;
  margin-bottom: ${i=>i.theme.measurements.advancedSpacer}px;
  color: ${i=>i.theme.card.foreground};
  &:nth-child(2n + 1) {
    margin-right: ${i=>i.theme.measurements.advancedSpacer}px;
  }
`;var YO=y(require("styled-components"));var KO=YO.default(sr)`
  width: ${i=>i.theme.measurements.advancedCard.small.width}px;
  height: ${i=>i.theme.measurements.advancedCard.small.height}px;
  margin-bottom: ${i=>i.theme.measurements.advancedSpacer}px;
  color: ${i=>i.theme.card.foreground};
  &:nth-child(3n + 1),
  &:nth-child(3n + 2) {
    margin-right: ${i=>i.theme.measurements.advancedSpacer}px;
  }
`;var Vm=i=>{let t=i.type===ft.LARGE,e=i.type===ft.SMALL,r=$O;return t?r=VO:e&&(r=KO),XO.default.createElement(r,b({},i))};var qO=y(require("styled-components"));var y_=qO.default.div.attrs(i=>({"data-test":i["data-test"]||H.CardContainer}))`
  display: flex;
  flex-wrap: wrap;
  /* width - padding on both sides */
  width: ${i=>i.theme.measurements.advancedUIToolControlBar.width-48}px;
`;var ZO=y(require("react")),jm=y(require("styled-components"));var YN=jm.default.div`
  display: flex;
  flex-direction: column;
  flex-shrink: 0;

  position: relative;
  width: ${i=>i.theme.measurements.advancedUIToolControlBar.width}px;
  /* for Firefox */
  min-height: 0;
  margin-bottom: ${i=>i.theme.measurements.advancedUIToolControlBar.marginBottom}px;

  z-index: ${i=>i.theme.measurements.zIndex.toolControlBar};

  background: ${i=>i.theme.toolControlBar.background};
  transition: width 0.4s ease-in;
  ${i=>i.reverse?jm.css`
          border-left: 1px solid ${i.theme.toolControlBar.borderColor};
        `:jm.css`
          border-right: 1px solid ${i.theme.toolControlBar.borderColor};
        `}
`,JO=({reverse:i=!1,children:t})=>ZO.default.createElement(YN,{"data-test":H.ToolControlBar,reverse:i},t);var _d=y(require("styled-components"));var QO=_d.default.div.attrs(()=>({"data-test":H.CategoryItemsContainer}))`
  transition: max-height 0.8s ease-out, transform 0.8s ease-out;
  background: ${i=>i.theme.toolControlBar.background};
  visibility: hidden;
  opacity: 0;
  transform-origin: 0 0;
  display: none;
  flex-wrap: wrap;

  ${({show:i})=>i&&_d.css`
      opacity: 1;
      visibility: visible;
      ${Se()?_d.css`
            display: block;
          `:_d.css`
            display: flex;
          `}
    `}
`;var $m=y(require("react")),Ym=y(require("styled-components"));var KN=Ym.default.div`
  position: relative;
  flex-grow: 0;
  flex-shrink: 0;
  ${i=>i.shouldAnimateHeight&&Ym.css`
      height: ${i.height}px;
    `}
  opacity: ${({opacity:i})=>i};
  visibility: ${({visibility:i})=>i};
  overflow: ${({shouldAnimateOverflow:i,overflow:t})=>i?t:void 0};
  transition: ${({shouldAnimateHeight:i})=>i?"opacity 0.5s ease-in, height 0.4s ease-out":"opacity 0.5s ease-in"};
  background: ${i=>i.theme.toolControlBar.background};
  color: ${i=>i.theme.toolControlBar.inputLabelForeground};
`,XN=Ym.default.div`
  position: relative;
  padding: ${i=>i.theme.measurements.advancedUIToolControlBar.padding};
`,f1=class extends $m.default.Component{constructor(t){super(t);this.contentRef=null;this.enableOverflow=()=>{let{show:t}=this.props;t&&this.contentRef.current&&this.setState({overflow:!0})};this.contentRef=$m.default.createRef(),this.state={height:0,mounted:!1,overflow:!1}}componentDidMount(){let{overflowAfterExpand:t}=this.props;this.contentRef.current&&(t&&this.contentRef.current.addEventListener("transitionend",this.enableOverflow),this.setState({height:this.contentRef.current.scrollHeight,mounted:!0}))}componentWillUnmount(){this.contentRef.current&&this.contentRef.current.removeEventListener("transitionend",this.enableOverflow)}render(){let{show:t,shouldAnimateOverflow:e,shouldAnimateHeight:r,children:o}=this.props,{height:s,mounted:n,overflow:a}=this.state,l=n&&(t&&e||!e),c=l?s:0,d=l?1:0,u=l?"visible":"hidden";return $m.default.createElement(KN,{"data-test":H.ToolControlBarControls,ref:this.contentRef,height:c,opacity:d,visibility:u,overflow:a?"visible":"hidden",shouldAnimateHeight:r,shouldAnimateOverflow:e},$m.default.createElement(XN,null,o))}};f1.defaultProps={show:!0,shouldAnimateOverflow:!0,shouldAnimateHeight:!0};var tR=f1;var x_=y(require("styled-components"));var g1=x_.default(Yr)`
  position: relative;
  padding: ${i=>i.theme.measurements.advancedUIToolControlBar.padding};
  width: ${i=>i.theme.measurements.advancedUIToolControlBar.width}px;

  box-sizing: border-box;

  /* for Firefox */
  min-height: 0;

  transition: height 0.4s cubic-bezier(0.17, 0.04, 0.03, 0.94);
  background: ${i=>i.theme.toolControlBar.background};
  color: ${i=>i.theme.toolControlBar.inputLabelForeground};

  /* compensate the padding in IE and Edge */
  ${()=>Se()||kr()?x_.css`
        > ul {
          padding-right: 34px;
          margin-right: -34px;
        }
      `:""}
`;g1.defaultProps={direction:"vertical"};var v_=y(require("styled-components")),qN=v_.default.div`
  &:after {
    content: '';
    position: absolute;
    bottom: 0px;
    ${i=>i.full?v_.css`
            left: -${3*i.theme.measurements.advancedSpacer/2}px;
            width: calc(
              100% + ${3*i.theme.measurements.advancedSpacer}px
            );
          `:`
      left: ${3*i.theme.measurements.advancedSpacer/2}px;
      width: calc(100% - ${3*i.theme.measurements.advancedSpacer}px);
    `}
    border-bottom: 2px solid ${i=>i.theme.toolControlBar.separatorColor};
  }
`,C_=qN;var eR=y(require("styled-components")),ZN=eR.default.h2`
  color: ${i=>i.theme.toolControlBar.titleForeground};
  font-size: ${i=>i.theme.measurements.fontSystem.headline2.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.headline2.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.headline2.case};
  font-weight: 500;
  min-height: ${i=>2*i.theme.measurements.advancedSpacer}px;
`,S_=ZN;var hn=y(require("react")),iR=y(require("styled-components"));var JN=iR.default.div`
  display: flex;
  flex-direction: column;
  position: relative;
  width: 100%;
  flex: 1 0 auto;
`,rR=({name:i,isFirstCategory:t,isLastCategory:e,children:r})=>hn.default.createElement(JN,null,!t&&hn.default.createElement(E.Spacer,{count:2}),hn.default.createElement(S_,{"data-test":i},i),hn.default.createElement(y_,{"data-test":H.CategoryItemsContainer},r),!e&&hn.default.createElement(hn.default.Fragment,null,hn.default.createElement(E.Spacer,{count:2}),hn.default.createElement(C_,{full:!0})));var oR=y(require("styled-components")),QN=oR.default.h1`
  /* Center text horizontally and vertically */
  display: flex;
  align-items: center;
  justify-content: center;
  flex-grow: 0;
  padding: 0 4px;
  margin: 0;
  min-height: ${i=>i.theme.measurements.mainCanvasActionBar.height-2}px;
  font-size: ${i=>i.theme.measurements.fontSystem.headline1.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.headline1.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.headline1.case};
  background: ${i=>i.theme.toolControlBar.background};
  color: ${i=>i.theme.toolControlBar.titleForeground};
  border-bottom: 1px solid ${i=>i.theme.toolControlBar.separatorColor};
  font-weight: 500;
  text-align: center;
`,sR=QN;var b1=y(require("react")),yd=y(require("styled-components"));var tH=yd.default.div`
  display: flex;
  flex: 1 0 auto;
  flex-direction: column;
  align-items: center;
  height: 100%;
  width: ${i=>i.theme.measurements.advancedUIToolbar.width}px;

  z-index: ${i=>i.theme.measurements.zIndex.toolbar};

  background-color: ${i=>i.theme.toolbar.background};
  color: ${i=>i.theme.toolbar.foreground};
  ${i=>{let t=i.theme.toolbar.border?i.theme.toolbar.border:yd.css`
          1px solid ${i.theme.toolbar.borderColor};
        `;return i.reverse?yd.css`
          border-left: ${t};
        `:yd.css`
          border-right: ${t};
        `}}
  margin-bottom: ${i=>i.theme.measurements.advancedUIToolbar.marginBottom}px;
`,nR=({reverse:i,children:t})=>b1.default.createElement(tH,{reverse:i,"data-test":H.Toolbar},b1.default.createElement(Yr,{direction:"vertical"},t));var _1=y(require("react")),Ul=y(require("styled-components"));var eH=Ul.default(Ar)`
  width: inherit;
  height: inherit;
  padding: 0;
  margin: 0;
  ${Se()?Ul.css`
        background-color: transparent;
      `:Ul.css`
        background-color: inherit;
      `}

  ${i=>i.isActive&&Ul.css`
      background-color: ${i.theme.toolbar.activeBackground};
      color: ${i.theme.toolbar.activeForeground};
    `}
`,iH=Ul.default.li.attrs({"aria-haspopup":!0,"aria-hidden":!0,role:"menuitem"})`
  height: ${i=>i.theme.measurements.advancedUIToolbar.itemHeight}px;
  cursor: pointer;
  position: relative;
`,aR=i=>_1.default.createElement(iH,null,_1.default.createElement(eH,b(b({},i),{"data-test":H.ToolbarItem})));var lR=y(require("styled-components")),rH=lR.default.li.attrs({role:"none"})`
  height: ${i=>i.theme.measurements.advancedUIToolbar.seperatorHeight}px;
  cursor: pointer;
  position: relative;
`,cR=rH;var y1=y(require("react")),fn=y(require("styled-components"));var oH=fn.default.div`
  ${Se()?fn.css`
        position: -ms-device-fixed;
      `:fn.css`
        position: fixed;
      `}
  position: -ms-device-fixed;
  top: ${i=>i.position.y-5}px;
  left: ${i=>i.position.x+i.theme.measurements.advancedUIToolbar.width-10}px;
  z-index: ${i=>i.theme.measurements.zIndex.toolbar};
  transition: opacity 0.5s ease-in-out, left 0.25s ease-in-out,
    right 0.25s ease-in-out, visibility 0.5s ease-in-out;
  pointer-events: none;
  opacity: 0;
  visibility: hidden;
  cursor: pointer;

  &:before {
    content: ' ';
    position: absolute;
    top: 10px;
    left: -8px;
    width: 0;
    height: 0;
    border-right: 8px solid ${i=>i.theme.tooltip.background};
    border-bottom: 6px solid transparent;
    border-top: 6px solid transparent;
  }

  &:after {
    content: '${i=>i.label}';
    position: absolute;
    transition: margin-left 0.15s ease-in-out, opacity 0.15s ease-in-out;
    color: ${i=>i.theme.tooltip.foreground};
    background: ${i=>i.theme.tooltip.background};
    padding: 8px 12px;
    text-align: center;
    vertical-align: super;
    font-size: ${i=>i.theme.measurements.fontSystem.label.size}px;
    letter-spacing: ${i=>i.theme.measurements.fontSystem.label.letterSpacing}px;
    text-transform: ${i=>i.theme.measurements.fontSystem.label.case};
    border-radius: ${i=>i.theme.shape.radiusSmall}px;
    white-space: nowrap;
  }

  ${i=>i.reverse&&fn.css`
      left: unset;
      right: ${i.position.x+i.theme.measurements.advancedUIToolbar.width-10}px;
      direction: rtl;

      &:before {
        border-left: 8px solid ${i.theme.tooltip.background};
        border-right: none;
        right: -8px;
        left: unset;
        top: 10px;
      }
    `}

  ${i=>i.show&&!i.reverse&&fn.css`
      opacity: 1;
      visibility: visible;
      left: ${i.position.x+i.theme.measurements.advancedUIToolbar.width+16}px;
    `}

  ${i=>i.show&&i.reverse&&fn.css`
      opacity: 1;
      visibility: visible;
      right: ${i.position.x+i.theme.measurements.advancedUIToolbar.width+16}px;
    `}
`,sH=fn.default.span`
  display: none;
`,dR=({show:i,reverse:t,position:e,children:r})=>{let o=typeof r=="string"?r:"";return y1.default.createElement(oH,{"data-test":H.Tooltip,show:i,reverse:t,position:e,label:o},y1.default.createElement(sH,null,o))};dR.defaultProps={show:!1};var uR=dR;var W={Card:Vm,CardContainer:y_,Toolbar:{Index:nR,Item:aR,Separator:cR,Tooltip:uR},Itemsbar:g1,BarSeparator:"",ItemsSeparator:C_,Controlsbar:tR,Sidebar:{Index:JO,Heading:sR,SubHeading:S_,TextCategory:rR,ExpandableContainer:QO}};var ii=y(require("react"));var qR=y(require("styled-components"));var k_=y(require("react"));var xd=y(require("react"));var w_=class extends xd.default.Component{constructor(){super(...arguments);this.renderIcon=t=>{let{tool:e,config:r}=this.props,o=r.state.config[e];if(o.icon){let n=o.icon;return xd.default.createElement(n,null)}let s=Ka[t];return xd.default.createElement(s,null)||null};this.update=t=>{this.props.active.selectTool(t)}}getToolTitle(t){return this.props.config.locale[t].title}render(){let t=this.props.active.tool,{tool:e,custom:r}=this.props;if(e){let o=r.getAdvancedToolbarItem();return xd.default.createElement(o,{key:e,isActive:e===t,isReverse:this.props.isReverse,icon:this.renderIcon(e),onClick:()=>this.update(e),tool:e,label:this.getToolTitle(e)})}return xd.default.createElement(W.Toolbar.Separator,null)}};w_=h([P("active","config","custom"),O],w_);var mR=w_;var vd=class extends k_.default.Component{render(){let{config:t}=this.props,e=t.config.order==="reverse";return k_.default.createElement(W.Toolbar.Index,{reverse:e},t.tools.map((r,o)=>k_.default.createElement(mR,{key:r||o,tool:r,isReverse:e})))}};vd=h([P("config"),O],vd);var se=y(require("react"));var Hl=y(require("react"));var T_=y(require("react"));var nH=({adjustmentsTool:i,custom:t})=>{let e=i.locale.controls,r=t.getButton("toolControlBarSecondaryButton"),o=()=>{i.reset()};return T_.default.createElement(W.Controlsbar,{show:i.isDirty},T_.default.createElement(r,{tool:C.ADJUSTMENT,label:e.buttonReset,ariaLabel:e.buttonReset,onClick:o,fullWidth:!0}),T_.default.createElement(W.ItemsSeparator,null))},pR=P("adjustmentsTool","custom")(O(nH));var Nl=y(require("react"));var hR=y(require("styled-components"));var aH=hR.default(E.Input.Slider)`
  padding-bottom: 16px;
`,lH=({adjustmentsTool:i})=>{let{categories:t,items:e,config:r,locale:o}=i,s=()=>{i.toolSnapshot()},n=(c,d)=>{i.editAdjustments({type:c,value:d})},a=c=>{let d=i.locale.categories[c.identifier]||c.name;return Nl.default.createElement(aH,{identifier:c.identifier,adjust:!0,key:c.identifier,label:d,value:i[c.identifier],onChange:u=>n(c.identifier,u),onMouseUp:s,onTouchEnd:s,snap:0})},l=(c,d)=>{let u=o.categories[c.identifier]||c.name;return c.items?Nl.default.createElement(W.Sidebar.TextCategory,{key:c.identifier,name:u,isFirstCategory:d===0,isLastCategory:d===t.length-1},c.items.map(a)):null};return r.flattenCategories?Nl.default.createElement(Nl.default.Fragment,null,e.map(a)):Nl.default.createElement(Nl.default.Fragment,null,t.map(l))},fR=P("adjustmentsTool")(O(lH));var cH=({adjustmentsTool:i,displayTitle:t})=>Hl.default.createElement(Hl.default.Fragment,null,t&&Hl.default.createElement(W.Sidebar.Heading,null,i.locale.title),Hl.default.createElement(pR,null),Hl.default.createElement(W.Itemsbar,null,Hl.default.createElement(fR,null))),gR=P("adjustmentsTool")(O(cH));var Km=y(require("react"));var Yi=y(require("react"));var dH=({brushTool:i,custom:t})=>{let{colorList:e}=i,r=i.locale.controls,o=i.localeColor.colorPicker,s=t.getButton("toolControlBarSecondaryButton");return Yi.default.createElement(Yi.default.Fragment,null,Yi.default.createElement(W.Controlsbar,{show:i.isDirty},Yi.default.createElement(s,{tool:C.BRUSH,ariaLabel:r.buttonReset,onClick:i.reset,fullWidth:!0,label:r.buttonReset}),Yi.default.createElement(W.ItemsSeparator,null)),Yi.default.createElement(W.Controlsbar,{overflowAfterExpand:!0},Yi.default.createElement(E.Input.Selection,{label:r.selectColor},Yi.default.createElement(Re,{activeColor:i.color,colors:e,labelsColor:o,onChange:i.changeColor})),Yi.default.createElement(E.Spacer,{count:2}),Yi.default.createElement(E.Input.Slider,{"data-test":H.BrushSize,label:r.sliderSize,value:i.relativeSize,min:1,max:100,divider:1,onChange:i.changeRelativeSize}),Yi.default.createElement(E.Spacer,{count:3}),Yi.default.createElement(E.Input.Slider,{"data-test":H.BrushHardness,label:r.sliderHardness,value:i.hardness,min:0,max:1,onChange:i.changeHardness}),Yi.default.createElement(E.Spacer,null)))},bR=P("brushTool","custom")(O(dH));var uH=({brushTool:i,displayTitle:t})=>Km.default.createElement(Km.default.Fragment,null,t&&Km.default.createElement(W.Sidebar.Heading,null,i.locale.title),Km.default.createElement(bR,null)),_R=P("brushTool")(O(uH));var Xm=y(require("react"));var yR=({displayTitle:i})=>{let{config:t}=Ee(),e=t.state.config[C.CUSTOM].toolControlBar,{title:r}=t.state.locale[C.CUSTOM];return Xm.default.createElement(Xm.default.Fragment,null,i&&Xm.default.createElement(W.Sidebar.Heading,null,r),Xm.default.createElement(e,{language:t.state.locale[C.CUSTOM]}))};var wa=y(require("react"));var Sa=y(require("react"));var mH=({filterTool:i,custom:t})=>{let e=i.locale.controls,r=i.state,o=t.getButton("toolControlBarSecondaryButton"),s=()=>{i.toolSnapshot()},n=()=>{i.reset()};return Sa.default.createElement(W.Controlsbar,{show:i.isOptionSelected},Sa.default.createElement(E.Input.Form,null,Sa.default.createElement(o,{tool:C.FILTER,ariaLabel:e.buttonReset,onClick:n,fullWidth:!0,label:e.buttonReset}),Sa.default.createElement(E.Spacer,{count:2}),Sa.default.createElement(E.Input.Slider,{"aria-hidden":!i.isOptionSelected,label:e.sliderIntensity,value:r.intensity,min:0,max:1,onChange:i.changeIntensity,onMouseUp:s,onTouchEnd:s,snap:r.isDuotone?.5:null}),Sa.default.createElement(E.Spacer,null)),Sa.default.createElement(W.ItemsSeparator,null))},xR=P("filterTool","custom")(O(mH));var Ki=y(require("react"));var pH=({filterTool:i,custom:t})=>{let{categories:e,config:r,items:o,locale:s}=i,n=t.getAdvancedItemCard(),a=t.getAdvancedCategoryCard(),l=(u,m)=>{let p=s.items[u.identifier]||u.name;return Ki.default.createElement(n,{tool:C.FILTER,type:ft.MEDIUM,onClick:()=>i.selectFilter(u.identifier,u.defaultIntensity),key:u.identifier,image:u.thumbnailURI,label:p,style:{animationDelay:`${At(m)}s`},isActive:i.identifier===u.identifier},Ki.default.createElement(me,{withBackground:!0},p))},c=(u,m)=>{let{selectedCategoryIdentifier:p}=i,f=p===u.identifier,v=s.categories[u.identifier]||u.name;return u.items?Ki.default.createElement("div",{key:u.identifier},Ki.default.createElement(a,{isActive:f,tool:C.FILTER,type:ft.LARGE,onClick:()=>i.toggleCategorySelection(u.identifier),image:u.thumbnailURI,label:v,style:{animationDelay:`${At(m)}s`}},Ki.default.createElement(me,{withBackground:!0,caret:!0,isActive:f},v)),Ki.default.createElement(W.Sidebar.ExpandableContainer,{show:f},u.items.map(l))):null},d=(u,m)=>{let p=s.categories[u.identifier]||u.name;return u.items?Ki.default.createElement(W.Sidebar.TextCategory,{key:u.identifier,name:p,isFirstCategory:m===0,isLastCategory:m===e.length-1},u.items.map(l)):null};return r.flattenCategories?Ki.default.createElement(Ki.default.Fragment,null,o.map(l)):r.categoryHeaderType===we.CARD?Ki.default.createElement(Ki.default.Fragment,null,e.map(c)):r.categoryHeaderType===we.TEXT?Ki.default.createElement(Ki.default.Fragment,null,e.map(d)):null},vR=P("filterTool","custom")(O(pH));var hH=({filterTool:i,displayTitle:t})=>wa.default.createElement(wa.default.Fragment,null,t&&wa.default.createElement(W.Sidebar.Heading,null,i.locale.title),wa.default.createElement(xR,null),wa.default.createElement(W.Itemsbar,{key:"filterToolItemsbar"},wa.default.createElement(W.CardContainer,null,wa.default.createElement(vR,null)))),CR=P("filterTool")(O(hH));var Cd=y(require("react"));var ka=y(require("react"));var SR=O(()=>{let{focusTool:i,custom:t}=Ee(),e=i.locale.controls,r=t.getButton("toolControlBarSecondaryButton"),o=()=>{i.toolSnapshot(e.sliderIntensity)},s=()=>{i.reset()};return ka.default.createElement(W.Controlsbar,{show:i.isOptionSelected},ka.default.createElement(E.Input.Form,null,ka.default.createElement(r,{tool:C.FOCUS,ariaLabel:e.buttonReset,onClick:s,fullWidth:!0,label:e.buttonReset}),ka.default.createElement(E.Spacer,{count:2}),ka.default.createElement(E.Input.Slider,{"aria-hidden":!i.isOptionSelected,label:e.sliderIntensity,value:i.relativeIntensity,min:0,max:100,divider:1,onChange:i.changeRelativeIntensity,onMouseUp:o,onTouchEnd:o})),ka.default.createElement(E.Spacer,{count:1}),ka.default.createElement(W.ItemsSeparator,null))});var qm=y(require("react"));var fH=({focusTool:i,custom:t})=>{let{items:e}=i,r=(o,s)=>{let n=i.locale.items[o.identifier]||o.name,a=t.getAdvancedItemCard();return qm.default.createElement(a,{tool:C.FOCUS,type:ft.LARGE,onClick:()=>i.selectFocus(o.identifier),key:o.identifier,image:o.thumbnailURI,label:n,style:{animationDelay:`${At(s)}s`},isActive:o.identifier===i.identifier},qm.default.createElement(me,{withBackground:!0},n))};return qm.default.createElement(W.Itemsbar,null,qm.default.createElement(W.CardContainer,null,e.map(r)))},wR=P("focusTool","custom")(O(fH));var kR=O(({displayTitle:i})=>{let{focusTool:t}=Ee();return Cd.default.createElement(Cd.default.Fragment,null,i&&Cd.default.createElement(W.Sidebar.Heading,null,t.locale.title),Cd.default.createElement(SR,null),Cd.default.createElement(wR,null))});var Sd=y(require("react"));var ho=y(require("react"));var gH=({frameTool:i,custom:t})=>{let e=i.locale.controls,r=i.localeColor.colorPicker,{tintable:o,colorList:s}=i,n=t.getButton("toolControlBarSecondaryButton"),a=()=>{i.reset()},l=c=>{i.toolSnapshot(c)};return ho.default.createElement(W.Controlsbar,{show:i.isOptionSelected,overflowAfterExpand:!0},ho.default.createElement(n,{tool:C.FRAME,ariaLabel:e.buttonReset,onClick:a,fullWidth:!0,label:e.buttonReset}),ho.default.createElement(E.Spacer,{count:2}),ho.default.createElement(E.Input.Slider,{"aria-hidden":!i.isOptionSelected,label:e.sliderOpacity,value:i.opacity,min:0,max:1,onChange:i.changeOpacity,onMouseUp:()=>{l(e.sliderOpacity)},onTouchEnd:()=>{l(e.sliderOpacity)}}),ho.default.createElement(E.Spacer,{count:2}),ho.default.createElement(E.Input.Slider,{"aria-hidden":!i.isOptionSelected,label:e.sliderSize,value:i.size,min:i.minSize,max:i.maxSize,divider:1,onChange:i.changeWidth,onMouseUp:()=>{l(e.sliderSize)},onTouchEnd:()=>{l(e.sliderSize)}}),ho.default.createElement(E.Spacer,{count:2}),ho.default.createElement(E.Input.Selection,{isDisabled:!o,label:e.selectColor},ho.default.createElement(Re,{activeColor:i.color,colors:s,labelsColor:r,isDisabled:!o,onChange:i.changeColor,onAddSnapshot:i.colorSnapshot})),ho.default.createElement(W.ItemsSeparator,null))},TR=P("frameTool","custom")(O(gH));var Zm=y(require("react"));var bH=({frameTool:i,custom:t})=>{let{items:e}=i,r=i.state?i.state.identifier:null,o=(s,n)=>{let a=i.locale.items[s.identifier]||s.name,l=t.getAdvancedItemCard();return Zm.default.createElement(l,{tool:C.FRAME,type:ft.MEDIUM,onClick:()=>i.selectFrame(s.identifier),key:s.identifier,image:s.thumbnailURI,label:a,style:{backgroundSize:"75%",animationDelay:`${At(n)}s`},isActive:s.identifier===r},Zm.default.createElement(me,{hidden:!0},a))};return Zm.default.createElement(W.Itemsbar,null,Zm.default.createElement(W.CardContainer,null,e.map(o)))},DR=P("frameTool","custom")(O(bH));var _H=({frameTool:i,displayTitle:t})=>Sd.default.createElement(Sd.default.Fragment,null,t&&Sd.default.createElement(W.Sidebar.Heading,null,i.locale.title),Sd.default.createElement(TR,null),Sd.default.createElement(DR,null)),IR=P("frameTool")(O(_H));var Ta=y(require("react"));var vr=y(require("react"));var AR=y(require("react"));var D_=y(require("react")),ER=()=>{let[i,t]=D_.useState([]);return D_.useEffect(()=>{var e;if(typeof window!==void 0&&((e=window.navigator)==null?void 0:e.mediaDevices)){let r=!0,o=()=>{window.navigator.mediaDevices.enumerateDevices().then(s=>{r&&t(s.map(({deviceId:n,groupId:a,kind:l,label:c})=>({deviceId:n,groupId:a,kind:l,label:c})))}).catch(()=>null)};return window.navigator.mediaDevices.addEventListener("devicechange",o),o(),()=>{r=!1,window.navigator.mediaDevices.removeEventListener("devicechange",o)}}return null},[]),i};var I_=O(({tool:i,fullWidth:t=!1,icon:e,label:r,onClick:o})=>{let{custom:s}=Ee();if(!ER().some(({kind:l})=>l==="videoinput"))return null;let a=s.getButton("toolControlBarSecondaryButton");return AR.default.createElement(a,{tool:i,label:r,ariaLabel:r,onClick:o,fullWidth:t,icon:e})});var yH=({library:i,active:t,custom:e})=>{let r=i.locale.controls.placeholderSearch,{config:o,libraryProvider:s}=i,n=e.getButton("toolControlBarPrimaryButton"),a=u=>{let{files:m}=u.target;if(m.length){let p=new FileReader;p.onload=f=>{t.newImage(f.target.result)},p.readAsDataURL(m[0])}},l=()=>{t.selectWebcam(!0)},c=()=>{let u=document.getElementById("fileUpload");u&&u.click()},d=u=>{i.fetchImages(u)};return vr.default.createElement(W.Controlsbar,{shouldAnimateHeight:!1,shouldAnimateOverflow:!1},s&&vr.default.createElement(vr.default.Fragment,null,vr.default.createElement(E.Input.Search,{onChange:d,placeholder:r}),vr.default.createElement(E.Spacer,{count:2})),o.enableUpload&&vr.default.createElement(vr.default.Fragment,null,vr.default.createElement(n,{tool:C.LIBRARY,ariaLabel:i.locale.controls.buttonUpload,onClick:c,fullWidth:!0,label:i.locale.controls.buttonUpload},vr.default.createElement(E.Input.File,{onChange:a})),vr.default.createElement(E.Spacer,null)),o.enableWebcam&&vr.default.createElement(I_,{tool:C.LIBRARY,onClick:l,fullWidth:!0,label:i.locale.controls.buttonWebcamOpen}),vr.default.createElement(W.ItemsSeparator,null))},FR=P("library","active","custom")(O(yH));var ei=y(require("react"));var xH=({active:i,library:t,custom:e})=>{let{query:r,config:o,selectedCategoryIdentifier:s,categories:n,items:a}=t,l=e.getAdvancedCategoryCard(),c=e.getAdvancedItemCard(),d=(p,f)=>ei.default.createElement(c,{tool:C.LIBRARY,type:ft.MEDIUM,onClick:()=>i.newImage(p.rawUrl),key:`${p.identifier}-${f}`,image:p.thumbnailURI,label:p.name,style:{animationDelay:`${At(f)}s`},authorAvatar:p.authorAvatar,authorName:p.authorName},p.authorAvatar&&ei.default.createElement(Rn,{url:p.authorAvatar}),p.authorName&&ei.default.createElement(me,{withBackground:!0},p.authorName)),u=(p,f)=>{let v=s===p.identifier;return p.items?ei.default.createElement("div",{key:p.identifier},ei.default.createElement(l,{isActive:v,tool:C.LIBRARY,type:ft.LARGE,onClick:()=>t.toggleCategorySelection(p.identifier),image:p.thumbnailURI,label:p.name,style:{animationDelay:`${At(f)}s`}},ei.default.createElement(me,{withBackground:!0,caret:!0,isActive:v},p.name)),ei.default.createElement(W.Sidebar.ExpandableContainer,{show:v},p.items.map(d))):null},m=(p,f)=>p.items?ei.default.createElement(W.Sidebar.TextCategory,{key:p.identifier,name:p.name,isFirstCategory:f===0,isLastCategory:f===n.length-1},p.items.map(d)):null;return r?a.length?ei.default.createElement(ei.default.Fragment,null,a.map(d)):ei.default.createElement("p",{"data-test":H.NoResult},t.locale.controls.noResults):o.flattenCategories?ei.default.createElement(ei.default.Fragment,null,a.map(d)):o.categoryHeaderType===we.CARD?ei.default.createElement(ei.default.Fragment,null,n.map(u)):o.categoryHeaderType===we.TEXT?ei.default.createElement(ei.default.Fragment,null,n.map(m)):null},OR=P("library","active","custom")(O(xH));var vH=({library:i,displayTitle:t})=>Ta.default.createElement(Ta.default.Fragment,null,t&&Ta.default.createElement(W.Sidebar.Heading,null,i.locale.title),Ta.default.createElement(FR,null),Ta.default.createElement(W.Itemsbar,null,Ta.default.createElement(W.CardContainer,null,Ta.default.createElement(OR,null)))),RR=P("library")(O(vH));var wd=y(require("react"));var gn=y(require("react"));var CH=({overlayTool:i,custom:t})=>{let e=i.locale.controls,{allBlendModes:r}=i,{blendMode:o}=i,s=t.getButton("toolControlBarSecondaryButton"),n=()=>{i.toolSnapshot()},a=c=>{i.changeBlendMode(c)},l=()=>{i.reset()};return gn.default.createElement(W.Controlsbar,{show:i.isOptionSelected},gn.default.createElement(s,{tool:C.OVERLAY,ariaLabel:e.buttonReset,onClick:l,fullWidth:!0,label:e.buttonReset}),gn.default.createElement(E.Spacer,{count:2}),gn.default.createElement(E.Input.CarouselSlider,{label:e.carouselBlendMode,defaultIdentifier:o,onSelect:a,list:r}),gn.default.createElement(E.Spacer,{count:2}),gn.default.createElement(E.Input.Slider,{"aria-hidden":!i.isOptionSelected,label:e.sliderOpacity,value:i.opacity,min:0,max:1,onChange:i.changeOpacity,onMouseUp:n,onTouchEnd:n}),gn.default.createElement(E.Spacer,null),gn.default.createElement(W.ItemsSeparator,null))},PR=P("overlayTool","custom")(O(CH));var Jm=y(require("react"));var SH=({overlayTool:i,custom:t})=>{let{items:e,locale:r,identifier:o,selectOverlay:s}=i,n=(a,l)=>{let c=r.items[a.identifier]||a.name,d=t.getAdvancedItemCard();return Jm.default.createElement(d,{tool:C.OVERLAY,type:ft.MEDIUM,onClick:()=>s(a.identifier),key:a.identifier,image:a.thumbnailURI,label:c,style:{animationDelay:`${At(l)}s`},isActive:a.identifier===o},Jm.default.createElement(me,{withBackground:!0},c))};return Jm.default.createElement(W.Itemsbar,null,Jm.default.createElement(W.CardContainer,null,e.map(n)))},BR=P("overlayTool","custom")(O(SH));var wH=({overlayTool:i,displayTitle:t})=>wd.default.createElement(wd.default.Fragment,null,t&&wd.default.createElement(W.Sidebar.Heading,null,i.locale.title),wd.default.createElement(PR,null),wd.default.createElement(BR,null)),MR=P("overlayTool")(O(wH));var Da=y(require("react"));var fo=y(require("react"));var LR=y(require("styled-components"));var kH=LR.default.input.attrs({type:"file",id:"fileUpload",accept:"image/*",multiple:!0})`
  ${tf.VisuallyHidden}
`,TH=({stickerTool:i,custom:t})=>{let{colorList:e}=i,r=i.locale.controls,o=i.localeColor.colorPicker,s=t.getButton("toolControlBarPrimaryButton"),n=()=>{i.toolSnapshot()},a=()=>{let u=document.getElementById("fileUpload");u&&(u.value=null,u.click())},l=u=>{let{files:m}=u.target;i.addFiles(m)},c=()=>i.isCustomStickerEnabled?fo.default.createElement(s,{tool:C.STICKER,ariaLabel:r.buttonUpload,onClick:a,fullWidth:!0,label:r.buttonUpload},fo.default.createElement(kH,{onChange:l})):null,d=!i.isStickerSelected||!i.tintable&&i.isStickerSelected;return fo.default.createElement(W.Controlsbar,{shouldAnimateHeight:!1,shouldAnimateOverflow:!1,overflowAfterExpand:!0},fo.default.createElement(E.Input.Form,null,c(),fo.default.createElement(E.Spacer,{count:2}),fo.default.createElement(E.Input.Slider,{isDisabled:!i.isStickerSelected,label:r.sliderOpacity,value:i.opacity,min:0,max:1,onChange:i.changeOpacity,onMouseUp:n,onTouchEnd:n}),fo.default.createElement(E.Spacer,{count:2}),fo.default.createElement(E.Input.Selection,{isDisabled:d,label:r.selectColor},fo.default.createElement(Re,{activeSprite:i.id,activeColor:i.tintColor,colors:e,labelsColor:o,isDisabled:d,onChange:i.changeTintColor,onAddSnapshot:i.tintColorSnapshot}))),fo.default.createElement(W.ItemsSeparator,null))},zR=P("stickerTool","custom")(O(TH));var Xi=y(require("react"));var DH=({stickerTool:i,custom:t})=>{let{categories:e,selectedCategoryIdentifier:r,config:o,items:s,locale:n}=i,a=t.getAdvancedCategoryCard(),l=t.getAdvancedItemCard(),c=(m,p)=>{let f=n.items[m.identifier]||m.name;return Xi.default.createElement(l,{key:m.identifier,tool:C.STICKER,type:ft.SMALL,onClick:()=>i.add(m.identifier),image:m.thumbnailURI,label:f,style:{backgroundSize:"75%",animationDelay:`${gh(p)}s`}},Xi.default.createElement(me,{hidden:!0},f))},d=(m,p)=>{let f=r===m.identifier,v=n.categories[m.identifier]||m.name;return m.items?Xi.default.createElement("div",{key:m.identifier},Xi.default.createElement(a,{isActive:f,tool:C.STICKER,type:ft.LARGE,onClick:()=>i.toggleCategorySelection(m.identifier),image:m.thumbnailURI,label:v,style:{animationDelay:`${At(p)}s`}},Xi.default.createElement(me,{withBackground:!0,caret:!0,isActive:f},v)),Xi.default.createElement(W.Sidebar.ExpandableContainer,{show:f,key:`${m.identifier}-items`},m.items.map(c))):null},u=(m,p)=>{let f=n.categories[m.identifier]||m.name;return m.items?Xi.default.createElement(W.Sidebar.TextCategory,{key:m.identifier,name:f,isFirstCategory:p===0,isLastCategory:p===e.length-1},m.items.map(c)):null};return o.flattenCategories?Xi.default.createElement(Xi.default.Fragment,null,s.map(c)):o.categoryHeaderType===we.CARD?Xi.default.createElement(Xi.default.Fragment,null,e.map(d)):o.categoryHeaderType===we.TEXT?Xi.default.createElement(Xi.default.Fragment,null,e.map(u)):null},UR=P("stickerTool","custom")(O(DH));var IH=({stickerTool:i,displayTitle:t})=>Da.default.createElement(Da.default.Fragment,null,t&&Da.default.createElement(W.Sidebar.Heading,null,i.locale.title),Da.default.createElement(zR,null),Da.default.createElement(W.Itemsbar,null,Da.default.createElement(W.CardContainer,null,Da.default.createElement(UR,null)))),NR=P("stickerTool")(O(IH));var tp=y(require("react"));var le=y(require("react"));var Qm=y(require("styled-components"));var HR=Qm.default.div`
  position: relative;
`,EH=Qm.default.div`
  display: flex;
  justify-content: space-between;
`,AH=Qm.default(E.Input.NumericInput)`
  max-width: 50%;
  margin-right: 16px;
`,FH=Qm.default(E.Input.Selection)`
  width: 50%;
`,OH=({textTool:i,custom:t})=>{let e=i.locale.controls,r=i.localeColor.colorPicker,{fontFamilies:o,alignment:s,isTextSelected:n,fontFamily:a,fontStyle:l,fontWeight:c,colorList:d,backgroundColorList:u}=i,m=["left","center","right"],p=t.getButton("textAlignment"),f=t.getButton("toolControlBarPrimaryButton"),v=()=>{i.toolSnapshot()},x=()=>{i.add()},_=B=>{let T=B?parseFloat(B):0;i.setFontSize(Math.max(10,Math.min(690,T)))},D=()=>m.map(B=>{let T=of[B];return le.default.createElement(p,{tool:B,isDisabled:!n,ariaLabel:`Align ${B}`,isActive:B===s,key:B,style:{padding:"1px 3px 2px"},icon:le.default.createElement(T,null),onClick:()=>i.changeAlignment(B)})}),k=o.map(B=>({label:`${B.fontFamily} ${yt.getDisplayFontStyle(B)}`,fontWeight:B.fontWeight,fontStyle:B.fontStyle,fontFamily:B.fontFamily,value:B.identifier})),A=k.filter(({value:B})=>B===i.identifier)[0];return le.default.createElement(W.Controlsbar,{show:!0,overflowAfterExpand:!0,shouldAnimateHeight:!1},le.default.createElement(E.Input.Form,null,le.default.createElement(f,{tool:C.TEXT,ariaLabel:e.buttonNew,onClick:x,fullWidth:!0,label:e.buttonNew}),le.default.createElement(E.Spacer,{count:2}),le.default.createElement(E.Input.Dropdown,{isDisabled:!n,style:{fontFamily:a,fontStyle:l,fontWeight:c},itemStyle:B=>({fontFamily:B.fontFamily,fontStyle:B.fontStyle,fontWeight:B.fontWeight}),label:e.dropdownFontFamily,list:k,onSelect:i.changeFont,selectedItem:A.label}),le.default.createElement(E.Spacer,{count:2}),le.default.createElement(EH,null,le.default.createElement(AH,{value:i.fontSize.toFixed(0),onSubmit:_,label:e.textFontSize,isDisabled:!n}),le.default.createElement(FH,{isDisabled:!n,inline:!0,label:e.selectAlignment,"data-test":H.TextAlignment},D())),le.default.createElement(E.Spacer,{count:2}),le.default.createElement(HR,null,le.default.createElement(W.ItemsSeparator,{full:!0})),le.default.createElement(E.Spacer,{count:2}),le.default.createElement(E.Input.Selection,{isDisabled:!n,label:e.selectFontColor},le.default.createElement(Re,{activeSprite:i.id,activeColor:i.textColor,colors:d,labelsColor:r,isDisabled:!n,onChange:i.changeColor,onAddSnapshot:i.colorSnapshot})),le.default.createElement(E.Spacer,{count:2}),le.default.createElement(E.Input.Selection,{isDisabled:!n,label:e.selectBackgroundColor},le.default.createElement(Re,{activeSprite:i.id,activeColor:i.backgroundColor,colors:u,labelsColor:r,isDisabled:!n,onChange:i.changeBackgroundColor,onAddSnapshot:i.backgroundColorSnapshot})),le.default.createElement(E.Spacer,{count:2}),le.default.createElement(HR,null,le.default.createElement(W.ItemsSeparator,{full:!0})),le.default.createElement(E.Spacer,{count:2}),le.default.createElement(E.Input.Slider,{isDisabled:!n,label:e.sliderLineSpacing,value:i.lineHeight,min:.5,max:3,onChange:i.changeLineHeight,onMouseUp:v,onTouchEnd:v,snap:1,divider:1,decimal:1}),le.default.createElement(E.Spacer,{count:1})))},WR=P("textTool","custom")(O(OH));var RH=({textTool:i,displayTitle:t})=>tp.default.createElement(tp.default.Fragment,null,t&&tp.default.createElement(W.Sidebar.Heading,null,i.locale.title),tp.default.createElement(WR,null)),GR=P("textTool")(O(RH));var kd=y(require("react"));var es=y(require("react"));var PH=({textDesignTool:i,custom:t})=>{let e=i.locale.controls,r=i.localeColor.colorPicker,{colorList:o}=i,s=i.isTextDesignSelected,n=t.getButton("toolControlBarPrimaryButton"),a=t.getButton("toolControlBarSecondaryButton"),l=()=>{i.add()},c=()=>{i.changeSeed()};return es.default.createElement(W.Controlsbar,{shouldAnimateOverflow:!1,shouldAnimateHeight:!1},es.default.createElement(E.Input.Form,null,es.default.createElement(n,{tool:C.TEXT_DESIGN,ariaLabel:e.buttonNew,onClick:l,fullWidth:!0,label:e.buttonNew}),es.default.createElement(E.Spacer,{count:2}),es.default.createElement(a,{tool:C.TEXT_DESIGN,ariaLabel:e.buttonShuffle,isDisabled:!s,onClick:c,fullWidth:!0,label:e.buttonShuffle}),es.default.createElement(E.Spacer,{count:2}),es.default.createElement(E.Input.Selection,{isDisabled:!s,label:e.selectColor},es.default.createElement(Re,{activeSprite:i.id,activeColor:i.color,colors:o,labelsColor:r,isDisabled:!s,onChange:i.changeColor,onAddSnapshot:i.colorSnapshot}))),es.default.createElement(W.ItemsSeparator,null))},VR=P("textDesignTool","custom")(O(PH));var ep=y(require("react"));var BH=({textDesignTool:i,custom:t})=>{let{items:e,identifier:r}=i,o=n=>{i.changeIdentifier(n)},s=(n,a)=>{let l=t.getAdvancedItemCard();return ep.default.createElement(l,{key:n.identifier,tool:C.TEXT_DESIGN,type:ft.MEDIUM,onClick:()=>o(n.identifier),image:n.thumbnailURI,label:n.name||"",style:{animationDelay:`${At(a)}s`,backgroundSize:"60%"},isDisabled:!i.isTextDesignSelected,isActive:r===n.identifier},ep.default.createElement(me,{hidden:!0},n.name))};return ep.default.createElement(W.Itemsbar,null,ep.default.createElement(W.CardContainer,null,e.map(s)))},jR=P("textDesignTool","custom")(O(BH));var MH=({textDesignTool:i,displayTitle:t})=>kd.default.createElement(kd.default.Fragment,null,t&&kd.default.createElement(W.Sidebar.Heading,null,i.locale.title),kd.default.createElement(VR,null),kd.default.createElement(jR,null)),$R=P("textDesignTool")(O(MH));var Ia=y(require("react"));var is=y(require("react"));var LH=({transformTool:i,custom:t})=>{let e=i.locale.controls,{forceDimensions:r,lockResolution:o,localOutputHeight:s,localOutputWidth:n}=i,a=t.getButton("toolControlBarSecondaryButton"),l=()=>{i.reset()},c=t.getCheckbox();return is.default.createElement(W.Controlsbar,{shouldAnimateHeight:!1},is.default.createElement(E.Input.Form,null,is.default.createElement(a,{tool:C.TRANSFORM,ariaLabel:e.buttonReset,onClick:l,fullWidth:!0,label:e.buttonReset}),is.default.createElement(E.Spacer,{count:2}),is.default.createElement(c,{isDisabled:r,value:o,label:e.checkboxKeepResolution,checkMarkPosition:"right",onClick:i.changeLockResolution,style:{paddingTop:"5px",justifyContent:"space-between"}}),is.default.createElement(E.Spacer,{count:2}),is.default.createElement(Gm,{isDisabled:r,showLabel:!0,valueHeight:s,valueWidth:n,onSubmitWidth:i.onPixelWidth,onSubmitHeight:i.onPixelHeight,label:e.inputCropSize,labelHeight:e.inputHeight,labelWidth:e.inputWidth}),is.default.createElement(E.Spacer,{count:1})),is.default.createElement(W.ItemsSeparator,null))},YR=P("transformTool","custom")(O(LH));var gi=y(require("react"));var x1=y(require("react-dom/server"));var zH=({transformTool:i,custom:t,editor:e})=>{let{categories:r,items:o,identifier:s,config:n,locale:a}=i,l=t.getAdvancedItemCard(),c=t.getAdvancedCategoryCard(),d=(p,f)=>{let{theme:v,measurements:x}=e.configStore,_=a.items[p.identifier]||p.name,D=p.thumbnailURI||"",k="80%";if(!i.checkIfTransformThumbnailExits(p.thumbnailURI)){let A=p.identifier.includes("imgly_transform_common"),B=Nt.crops[p.identifier]||Nt.crops.imgly_transform_common_custom,T=gi.default.createElement(B,{width:x.advancedCard.medium.width-(A?42:0),height:x.advancedCard.medium.height-(A?42:0),main:v.transform.crops.main,highlight:v.transform.crops.highlight,shadow:v.transform.crops.shadow});D=`'data:image/svg+xml,${encodeURIComponent(x1.renderToStaticMarkup(T))}'`,k=Se()||kr()?"auto":"unset"}return gi.default.createElement(l,{key:p.identifier,tool:C.TRANSFORM,type:ft.MEDIUM,onClick:()=>i.changeIdentifier(p.identifier,!0),image:D,label:_,style:{backgroundSize:k,animationDelay:`${At(f)}s`},isActive:p.identifier===s},gi.default.createElement(me,null,_))},u=(p,f)=>{let{theme:v,measurements:x}=e.configStore,_=i.selectedCategoryIdentifier===p.identifier,D=a.categories[p.identifier]||p.name,k=p.thumbnailURI||"";if(!p.items)return null;if(!i.checkIfTransformThumbnailExits(p.thumbnailURI)){let A=Nt.categories[p.identifier]||Nt.crops.imgly_transform_common_custom,B=gi.default.createElement(A,{width:x.advancedCard.large.width-42,height:x.advancedCard.large.height-42,main:v.transform.crops.main,highlight:v.transform.crops.highlight,shadow:v.transform.crops.shadow});k=`'data:image/svg+xml,${encodeURIComponent(x1.renderToStaticMarkup(B))}'`}return gi.default.createElement("div",{key:p.identifier},gi.default.createElement(c,{type:ft.LARGE,onClick:()=>i.toggleCategorySelection(p.identifier),key:p.identifier,image:k,style:{animationDelay:`${At(f)}s`},label:p.name,tool:C.TRANSFORM},gi.default.createElement(me,{caret:!0,isActive:_},D)),gi.default.createElement(W.Sidebar.ExpandableContainer,{show:_},p.items.map(d)))},m=(p,f)=>{let v=a.categories[p.identifier]||p.name;return p.items?gi.default.createElement(W.Sidebar.TextCategory,{key:p.identifier,name:v,isFirstCategory:f===0,isLastCategory:f===r.length-1},p.items.map(d)):null};return n.flattenCategories?gi.default.createElement(gi.default.Fragment,null,o.map(d)):n.categoryHeaderType===we.CARD?gi.default.createElement(gi.default.Fragment,null,r.map(u)):n.categoryHeaderType===we.TEXT?gi.default.createElement(gi.default.Fragment,null,r.map(m)):null},KR=P("transformTool","custom","editor")(O(zH));var UH=({transformTool:i,displayTitle:t})=>Ia.default.createElement(Ia.default.Fragment,null,t&&Ia.default.createElement(W.Sidebar.Heading,null,i.locale.title),Ia.default.createElement(YR,null),Ia.default.createElement(W.Itemsbar,null,Ia.default.createElement(W.CardContainer,null,Ia.default.createElement(KR,null)))),XR=P("transformTool")(O(UH));var Td=class extends se.default.Component{render(){let{config:t,active:e}=this.props,r=e.tool,o=t.config.displayToolControlBarTitle;return se.default.createElement(W.Sidebar.Index,{reverse:t.config.order==="reverse"},se.default.createElement(E.Switch.Index,{type:r},se.default.createElement(E.Switch.Case,{value:C.LIBRARY},se.default.createElement(RR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.FILTER},se.default.createElement(CR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.FOCUS},se.default.createElement(kR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.ADJUSTMENT},se.default.createElement(gR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.OVERLAY},se.default.createElement(MR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.STICKER},se.default.createElement(NR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.TEXT},se.default.createElement(GR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.TEXT_DESIGN},se.default.createElement($R,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.FRAME},se.default.createElement(IR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.BRUSH},se.default.createElement(_R,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.TRANSFORM},se.default.createElement(XR,{displayTitle:o})),se.default.createElement(E.Switch.Case,{value:C.CUSTOM},se.default.createElement(yR,{displayTitle:o}))))}};Td=h([P("active","config"),O],Td);var ZR=qR.default.div`
  position: absolute;
  height: 100%;
  width: ${i=>i.theme.measurements.advancedUIToolbar.width+i.theme.measurements.advancedUIToolControlBar.width}px;
  top: 0;
  background: ${i=>i.theme.webcam.backdrop};
  z-index: ${i=>i.theme.measurements.zIndex.disable};
`,ip=class extends ii.default.Component{static getDerivedStateFromError(t){return console.error(t),{hasError:!0}}render(){let{config:t,active:e}=this.props;return t.isOrderDefault?ii.default.createElement(E.Container,null,e.isWebcam?ii.default.createElement(ZR,{style:{left:0}}):null,ii.default.createElement(bd,null),ii.default.createElement(vd,null),ii.default.createElement(Td,null),ii.default.createElement(Kn,null,ii.default.createElement(ad,null),ii.default.createElement(fd,null))):ii.default.createElement(E.Container,null,e.isWebcam?ii.default.createElement(ZR,{style:{right:0}}):null,ii.default.createElement(bd,null),ii.default.createElement(Kn,null,ii.default.createElement(ad,null),ii.default.createElement(fd,null)),ii.default.createElement(Td,null),ii.default.createElement(vd,null))}};ip=h([P("config","active"),O],ip);var Dd=y(require("react")),JR=y(require("styled-components"));var QR=class extends Dd.default.Component{constructor(t){super(t);this.ref=null;this.updatePosition=()=>{let{isReverse:t}=this.props,e={x:0,y:0};if(this.ref.current){let{top:r,height:o,left:s,right:n}=this.ref.current.getBoundingClientRect();e.y=r+o/4,e.x=t?window.innerWidth-n:s}this.setState({tooltipPosition:e})};this.mouseOver=t=>{this.updatePosition(),this.setState({hoverTool:t})};this.mouseOut=()=>{this.setState({hoverTool:null})};this.state={hoverTool:null,tooltipPosition:{x:0,y:0}},this.ref=Dd.default.createRef()}componentDidMount(){this.updatePosition()}componentDidUpdate(t){let{isReverse:e}=this.props;e!==t.isReverse&&this.updatePosition()}render(){let{tool:t,isActive:e,isReverse:r,icon:o,label:s,onClick:n,className:a,children:l}=this.props,{hoverTool:c,tooltipPosition:d}=this.state;return Dd.default.createElement(NH,{ref:this.ref,onMouseOver:()=>this.mouseOver(t),onMouseOut:()=>this.mouseOut(),className:a},Dd.default.createElement(W.Toolbar.Item,{ariaLabel:s,isActive:e,onClick:()=>n(t)},o,l),Dd.default.createElement(W.Toolbar.Tooltip,{position:d,reverse:r,show:c===t},s))}},Id=QR,NH=JR.default.div`
  position: relative;
`;var Ed=class extends rp.default.Component{componentDidMount(){let{editor:t,storeProps:e}=this.props;this.editor=t,this.storeProps=e;let r=new gd(this.editor.configStore.config.custom.components,{advancedUICategoryCard:W.Card,advancedUIItemCard:W.Card,advancedUIToolbarItem:Id}),o={getAdvancedCategoryCard:r.getAdvancedCategoryCard,getAdvancedItemCard:r.getAdvancedItemCard,getAdvancedToolbarItem:r.getAdvancedToolbarItem,getDialog:r.getDialog,getButton:r.getButton,getColorItem:r.getColorItem,getCheckbox:r.getCheckbox};this.storeProps.custom=o,this.forceUpdate()}render(){return this.storeProps?rp.default.createElement($d,b({},this.storeProps),rp.default.createElement(t5.ThemeProvider,{theme:b(b({},this.editor.configStore.theme),{measurements:this.editor.configStore.measurements})},rp.default.createElement(ip,null))):null}};document.onkeydown=i=>{i.keyCode===13&&document.activeElement&&document.activeElement.click()};var W_=y(require("react")),P1=y(require("react-dom"));var hP=class extends Ri{constructor(t,e){super();this.dispose=()=>{this.container&&(P1.default.unmountComponentAtNode(this.container),this.removeAllListeners(rt.EXPORT),this.removeAllListeners(rt.HISTORY_CHANGE),this.removeAllListeners(rt.EDITOR_READY),this.removeAllListeners(rt.ERROR_IMAGE_LOADING),this.removeAllListeners(rt.IMAGE_LOAD),this.removeAllListeners(rt.TOOL_ENTER),this.removeAllListeners(rt.STICKER_UPLOAD_ADD))};this.serialize=t=>this.editor.serialize(t);this.deserialize=t=>this.editor.deserialize(t);this.export=t=>this.editor.export(t);this.close=()=>this.editor.close();this.setImage=t=>this.editor.setImage(t);this.reset=()=>{this.editor.resetToolStates(),this.editor.resize()};this.container=e,this.editor=new fe(b({},t)),this.editor.configStore.events.on(rt.EXPORT,r=>{this.emit(rt.EXPORT,r)}),this.editor.configStore.events.on(rt.CLOSE,()=>{this.dispose(),this.emit(rt.CLOSE)}),this.editor.configStore.events.on(rt.HISTORY_CHANGE,()=>{this.emit(rt.HISTORY_CHANGE)}),this.editor.configStore.events.on(rt.STICKER_UPLOAD_ADD,r=>{this.emit(rt.STICKER_UPLOAD_ADD,r)})}hasChanges(){return this.editor.hasChanges()}},fP=class{constructor(){this.container=null}init(t){return new Promise((e,r)=>{this.container=typeof t.container=="string"?document.querySelector(t.container):t.container,this.container?(this.editorApi=new hP(t,this.container),P1.default.render(W_.default.createElement(gP,{editor:this.editorApi.editor}),this.container),this.editorApi.editor.configStore.events.on(rt.EDITOR_READY,()=>{setTimeout(()=>{this.editorApi.emit(rt.EDITOR_READY)},0),e(this.editorApi)}),this.editorApi.editor.configStore.events.on(rt.ERROR_IMAGE_LOADING,o=>{setTimeout(()=>{this.editorApi.emit(rt.ERROR_IMAGE_LOADING,o)},0),e(this.editorApi)}),this.editorApi.editor.configStore.events.on(rt.IMAGE_LOAD,()=>{setTimeout(()=>{this.editorApi.emit(rt.IMAGE_LOAD)},0),e(this.editorApi)}),this.editorApi.editor.configStore.events.on(rt.TOOL_ENTER,o=>{setTimeout(()=>{this.editorApi.emit(rt.TOOL_ENTER,o)},0),e(this.editorApi)})):r(new Error("Provide a container"))})}};var yp=y(require("react"));var pP=y(require("styled-components"));var bo=y(require("react"));var mP=y(require("styled-components"));var Fd=y(require("react"));var s5=y(require("react"));var e5=y(require("styled-components"));var i5=e5.default(sr)`
  margin: 2px;
  min-width: ${i=>i.theme.measurements.basicCard.large.width}px;
  height: ${i=>i.theme.measurements.basicCard.large.height}px;
  color: ${i=>i.theme.card.foreground};
`;var r5=y(require("styled-components"));var o5=r5.default(sr)`
  margin: 2px;
  min-width: ${i=>i.theme.measurements.basicCard.medium.width}px;
  height: ${i=>i.theme.measurements.basicCard.medium.height}px;
  color: ${i=>i.theme.card.foreground};
`;var v1=i=>{let t=i.type===ft.LARGE,e=o5;return t&&(e=i5),s5.default.createElement(e,b({},i))};v1.defaultProps={type:ft.MEDIUM};var n5=y(require("styled-components"));var a5=n5.default(Yr)`
  transition-property: width;
  transition-duration: 0.4s;
  transition-timing-function: ease-in;
  height: ${i=>i.theme.measurements.basicToolControlBar.itemsBarHeight}px;
`;var l5=y(require("styled-components"));var c5=l5.default(me)`
  &&& {
    min-height: 32px;
    font-size: ${i=>i.theme.measurements.fontSystem.basicUICardLabel.size}px;
    letter-spacing: ${i=>i.theme.measurements.fontSystem.basicUICardLabel.letterSpacing}px;
    text-transform: ${i=>i.theme.measurements.fontSystem.basicUICardLabel.case};
  }
`;var d5=y(require("styled-components")),u5=d5.default.div`
  display: flex;
  /* This fixes an IE11 issue where the items are behind the category */
  flex: 1 0 auto;
`;var op=y(require("styled-components")),m5=op.default.div`
  position: relative;
  display: flex;
  flex-shrink: 0;
  height: auto;
  transition: max-height 0.4s ease-in-out;
  ${i=>i.show?op.css`
          max-height: 80px;
        `:op.css`
          max-height: 0px;
        `}
`,p5=m5;m5.defaultProps={show:!0};var h5=y(require("styled-components")),HH=h5.default.div`
  text-align: -moz-center;
  text-align: center;
  text-align: -webkit-center;
  margin: 0 10vw;
  height: auto;
  box-shadow: ${i=>i.theme.toolControlBar.shadow};
  @media all and (min-width: 0) and (max-width: 599px) {
    margin: 0 5vw;
  }
`,f5=HH;var g5=y(require("styled-components")),WH=g5.default.div`
  width: 100px;
  @media all and (min-width: 0) and (max-width: 599px) {
    width: 42px;
  }
`,b5=WH;var E_=y(require("styled-components"));var _5=E_.default.div.attrs(()=>({"data-test":H.ToolControlBarControls}))`
  position: absolute;
  left: 0%;
  transform: translateY(0%) scaleY(0);
  justify-content: center;
  padding: 0 5vw;
  width: 90%;
  height: ${i=>i.theme.measurements.basicToolControlBar.controlsBarHeight}px;
  display: flex;
  align-items: center;
  transition: transform 0.4s ease-in-out;
  z-index: ${i=>i.theme.measurements.zIndex.controlsBar};
  background: ${i=>i.theme.toolControlBar.background};
  color: ${i=>i.theme.toolControlBar.inputLabelForeground};

  ${({show:i})=>i&&E_.css`
      transform: translateY(-100%) scaleY(1);
    `}
`;var Ad=y(require("react")),T5=y(require("styled-components"));var y5=y(require("react")),x5=y(require("styled-components")),GH=x5.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
`,VH=({label:i,className:t,children:e})=>y5.default.createElement(GH,{"aria-label":i,className:t},e),C1=VH;var Ai=y(require("react")),k1=y(require("styled-components"));var v5=y(require("styled-components"));var jH=v5.default.div`
  display: flex;
  justify-content: center;
  align-items: center;
  animation: ${i2.scale} 0.2s linear;
  animation-fill-mode: both;
  height: 40px;
  min-width: 350px;
  @media all and (min-width: 0) and (max-width: 599px) {
    min-width: 280px;
  }
`,C5=jH;var S1=y(require("react")),A_=y(require("styled-components"));var S5=A_.css`
  background: ${i=>i.theme.tabTitle.activeBackground};
  color: ${i=>i.theme.tabTitle.activeForeground};
  border-bottom: 1px solid ${i=>i.theme.tabTitle.activeBorderColor};
`,$H=A_.default(Zr)`
  display: inline-flex;
  align-items: center;
  font-size: ${i=>i.theme.measurements.fontSystem.basicUITabLabel.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.basicUITabLabel.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.basicUITabLabel.case};
  color: ${i=>i.theme.tabTitle.foreground};
  border-radius: 0px;
  padding: 1px 12px 2px;
  background: ${i=>i.theme.tabTitle.background};

  ${({isActive:i})=>i&&S5}

  &:active {
    ${S5}
  }

  @media all and (min-width: 0) and (max-width: 599px) {
    max-width: 150px;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
`,w1=class extends S1.default.Component{constructor(){super(...arguments);this.onClick=()=>{let{label:t,onClick:e}=this.props;e(t)}}render(){let{activeTab:t,label:e}=this.props;return S1.default.createElement($H,{ariaLabel:e,isActive:t===e,onClick:this.onClick},e)}},w5=w1;var YH=k1.default(Ar)`
  display: inline-flex;
  padding: 0 4px;
  height: 20px;
  font-size: 16px;
`,KH=k1.default(Iu)`
  display: inline-flex;
  justify-content: center;
  transform: translate(-100%, -100%);
  @media all and (min-width: 0) and (max-width: 499px) {
    left: 0;
    right: 0;
    transform: translateY(-120%);
    background: transparent;
    button {
      &:first-child {
        border-bottom-right-radius: 0;
        border-top-right-radius: 0;
      }
      &:last-child {
        border-bottom-left-radius: 0;
        border-top-left-radius: 0;
      }
      &:not(:first-child):not(:last-child) {
        border-radius: 0;
      }
    }
  }
`,k5=class extends Ai.default.Component{constructor(t){super(t);this.onTabClick=t=>{this.setState({activeTab:t,toggleExtend:!1})};this.getDropUp=()=>{let{length:t}=this.props,{toggleExtend:e}=this.state,r=Ai.default.Children.toArray(this.props.children),o=Ai.default.Children.count(this.props.children),s=r.slice(t,o);return Ai.default.createElement(KH,{show:e},s.map(n=>{let a=n.props.label||"";return Ai.default.createElement(Zr,{onClick:()=>this.onTabClick(a),key:a,ariaLabel:"More Options"},a)}))};this.extend=()=>{this.setState(({toggleExtend:t})=>({toggleExtend:!t}))};this.getExtension=()=>Ai.default.createElement(YH,{onClick:this.extend,ariaLabel:"Select Next"},"...");let e=Ai.default.Children.count(this.props.children),r=Ai.default.Children.toArray(this.props.children);this.state={activeTab:e&&r[0].props&&r[0].props.label||"",toggleExtend:!1}}render(){let{length:t}=this.props,{activeTab:e,toggleExtend:r}=this.state,o=Ai.default.Children.toArray(this.props.children).slice(0,t),s=Ai.default.Children.count(this.props.children)>t;return Ai.default.createElement("div",null,o.map(n=>{if(n){let a=n.props.label||"";return Ai.default.createElement(w5,{activeTab:e,key:a,label:a,onClick:this.onTabClick})}return null}),s?this.getExtension():null,r?this.getDropUp():null,Ai.default.Children.map(this.props.children,n=>!n||n.props&&n.props.label!==e?null:Ai.default.createElement(C5,{key:n.props.label},n.props.children)))}},sp=k5;var XH=T5.default.div`
  position: relative;
  white-space: nowrap;
  display: flex;
  transition: all 0.2s linear;
`,O_=class extends Ad.default.Component{constructor(t){super(t);this.updateLength=()=>{let{maxWidth:t,children:e}=this.props,r=0;if(t)r=t;else{let n=window.innerWidth,a=n>600?300:200;r=n-a}let o=Ad.default.Children.count(e),s=r-o*O_.TAB_WIDTH;if(s<0){let n=Math.round(Math.abs(s/O_.TAB_WIDTH));this.setState({length:o-n})}};this.state={length:Ad.default.Children.count(this.props.children)}}componentDidMount(){window.addEventListener("resize",this.updateLength),this.updateLength()}componentWillUnmount(){window.removeEventListener("resize",this.updateLength)}render(){let{children:t}=this.props,{length:e}=this.state;return e?Ad.default.createElement(XH,null,Ad.default.createElement(sp,{length:e},t)):null}},F_=O_;F_.TAB_WIDTH=120;var R_=y(require("styled-components")),qH=R_.default.div`
  &:after {
    content: '';
    position: absolute;
    bottom: 0px;
    ${i=>i.full?R_.css`
            left: -24px;
            width: calc(100% + 48px);
          `:`
      left: 24px;
      width: calc(100% - 48px);
    `}
    border-bottom: 1px solid ${i=>i.theme.toolControlBar.separatorColor};
  }
`,D5=qH;var I5=y(require("styled-components"));var ZH=I5.default(E.Input.Slider).attrs(()=>({centerSlider:!0}))`
  max-width: 224px;
`,E5=ZH;var P_=y(require("styled-components")),JH=P_.default.div`
  visibility: hidden;
  opacity: 0;
  display: none;

  ${({show:i})=>i&&P_.css`
      opacity: 1;
      visibility: visible;
      display: flex;
    `}
`,A5=JH;var np=y(require("styled-components")),T1=np.default.div`
  display: flex;
  flex-shrink: 0;
  justify-content: center;
  position: relative;
  width: 100%;
  z-index: ${i=>i.theme.measurements.zIndex.toolControlBar};

  ${i=>i.show?np.css`
          transition-timing-function: ease-in;
          transition-duration: 0.3s;
          transition-property: all;
          padding: 2px 0px;
          background: ${i.theme.toolControlBar.background};
          color: ${i.theme.toolControlBar.inputLabelForeground};
        `:np.css`
          max-height: 0px;
        `}
`;T1.defaultProps={show:!0};var F5=y(require("styled-components")),QH=F5.default.div`
  height: ${i=>i.theme.measurements.basicToolControlBar.itemsBarHeight}px;
  width: 2px;
  margin: 0 10px;
  display: inline-flex;
  position: relative;
  &:after {
    content: ' ';
    right: 0px;
    position: absolute;
    top: 8px;
    height: calc(100% - 16px);
    border-right: 1px solid
      ${i=>i.theme.toolControlBar.separatorColor};
  }
`,O5=QH;var D1=y(require("react")),ap=y(require("styled-components"));var Wl=y(require("styled-components"));var R5=Wl.default.span`
  display: flex;
  cursor: pointer;
  z-index: ${i=>i.theme.measurements.zIndex.label};
  transition: bottom 0.3s linear;
`,P5=Wl.css`
  background-color: ${i=>i.theme.toolbar.activeBackground};
  color: ${i=>i.theme.toolbar.activeForeground};
`,B_=Wl.default(si)`
  display: block;
  height: 100%;
  width: 100%;
  color: ${i=>i.theme.toolbar.foreground};
  background-color: ${i=>i.theme.toolbar.background};
  border: unset;
  box-shadow: unset;
  font-size: ${i=>i.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.label.case};
  font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;

  ${({isActive:i})=>i&&P5}

  &:active {
    ${P5}
  }

  svg {
    display: flex;
    transition: visibility 0s, opacity 0.5s linear;
    visibility: visible;
    opacity: 1;
  }
`,B5=Wl.default.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
`,M_=Wl.default.div.attrs({role:"none"})`
  display: flex;
  height: ${i=>i.theme.measurements.basicUIToolbar.openHeight-2}px;
  text-align: center;
  min-width: 100px;
  /* Allow the text to grow in this limit */
  max-width: 150px;
  position: relative;
  /* Position inline-block box at the top of the line box */
  vertical-align: top;
  /* Allow text to wrap again, overwriting the Toolbar style */
  white-space: normal;
  margin: 1px;
`;var tW=ap.default.div`
  display: flex;
  flex-shrink: 0;
  justify-content: center;
  position: relative;
  width: 100%;
  transition: height 0.2s ease-out, display 0.1s fade-out;
  background-color: ${i=>i.theme.toolbar.background};
  color: ${i=>i.theme.toolbar.foreground};
  z-index: ${i=>i.theme.measurements.zIndex.toolbar};

  ${i=>i.show?ap.css`
          height: ${i.theme.measurements.basicUIToolbar.closeHeight}px;
          ${B_} {
            svg {
              visibility: hidden;
              opacity: 0;
              height: 0;
            }
          }
          ${M_} {
            height: ${i.theme.measurements.basicUIToolbar.closeHeight}px;
          }
        `:ap.css`
          height: ${i.theme.measurements.basicUIToolbar.openHeight}px;
        `}
`,M5=({show:i=!1,children:t})=>D1.default.createElement(tW,{"data-test":H.Toolbar,show:i},D1.default.createElement(Yr,null,t));var lp=y(require("react"));var L5=({children:i,label:t,isActive:e,onClick:r})=>lp.default.createElement(M_,{"aria-haspopup":!0,"aria-expanded":e},lp.default.createElement(B_,{"data-test":H.ToolbarItem,ariaLabel:t,onClick:r,isActive:e},lp.default.createElement(B5,null,i,lp.default.createElement(R5,null,t))));var cp=y(require("styled-components")),eW=cp.default.li.attrs({role:"none"})`
  ${i=>i.active?cp.css`
          height: ${i.theme.measurements.basicUIToolbar.closeHeight}px;
        `:cp.css`
          height: ${i.theme.measurements.basicUIToolbar.openHeight}px;
        `}
  width: 2px;
  display: inline-block;
  position: relative;
  &:after {
    content: ' ';
    right: 0px;
    position: absolute;
    top: 8px;
    height: calc(100% - 16px);
    border-right: 1px solid
      ${i=>i.theme.toolControlBar.separatorColor};
  }
`,z5=eW;var M={CardContainer:a5,ExpandableContainer:A5,CategoryContainer:u5,Card:v1,CardAvatar:Rn,CardLabel:c5,Toolbar:{Index:M5,Item:L5,Separator:z5},BarSeparator:D5,ItemsSeparator:O5,Itemsbar:T1,Controlsbar:p5,ControlsbarContainer:_5,ResponsiveTabWrapper:F_,Slider:E5,TabWrapper:sp,Tab:C1,Other:{ControlsWrapper:f5,EmptyDiv:b5}};var iW=({config:i,active:t})=>{let{tools:e}=i,r=t.tool,o=a=>{let l=i.state.config[a];if(l.icon){let d=l.icon;return Fd.default.createElement(d,null)}let c=Ka[a];return Fd.default.createElement(c,null)||null},s=a=>i.locale[a].title,n=(a,l)=>a&&Fd.default.createElement(M.Toolbar.Item,{onClick:()=>t.selectTool(a),key:a,label:s(a),isActive:r===a},o(a))||Fd.default.createElement(M.Toolbar.Separator,{key:a+l,active:!!r});return Fd.default.createElement(M.Toolbar.Index,{show:!!r},e.map(n))},U5=P("config","active")(O(iW));var ge=y(require("react"));var rs=y(require("react"));var rW=({adjustmentsTool:i,custom:t})=>{let e=i.selectedAdjustmentType.toLowerCase(),r=t.getButton("toolControlBarSecondaryButton"),o=()=>{i.toolSnapshot()};return rs.default.createElement(M.ControlsbarContainer,{show:Boolean(e)},rs.default.createElement(r,{tool:C.ADJUSTMENT,ariaLabel:i.locale.controls.buttonReset,onClick:i.reset,icon:rs.default.createElement(ke.reset,null),label:i.locale.controls.buttonReset}),rs.default.createElement(M.Other.ControlsWrapper,null,rs.default.createElement(E.Spacer,{count:2}),rs.default.createElement(M.Slider,{"aria-hidden":!e,adjust:!0,style:{width:"280px"},label:i.selectedOptionLabel,value:i[e],onChange:s=>i.editAdjustments({type:e,value:s}),onMouseUp:o,onTouchEnd:o,snap:0}),rs.default.createElement(E.Spacer,{count:2}),rs.default.createElement(M.BarSeparator,null)),rs.default.createElement(M.Other.EmptyDiv,null))},N5=P("adjustmentsTool","custom")(O(rW));var Fi=y(require("react"));var oW=M.TabWrapper,{Tab:I1}=M,sW=({brushTool:i,custom:t})=>{let{colorList:e,locale:r,localeColor:o}=i,s=r.controls,n=o.colorPicker,a=t.getButton("toolControlBarSecondaryButton");return Fi.default.createElement(M.ControlsbarContainer,{style:{justifyContent:"center"},show:!0},Fi.default.createElement(a,{tool:C.BRUSH,ariaLabel:s.buttonReset,onClick:i.reset,icon:Fi.default.createElement(ke.reset,null),isDisabled:!i.isDirty,label:s.buttonReset}),Fi.default.createElement(M.Other.ControlsWrapper,null,Fi.default.createElement(E.Input.Form,null,Fi.default.createElement(oW,null,Fi.default.createElement(I1,{label:s.tabColor},Fi.default.createElement(E.Spacer,{count:1}),Fi.default.createElement(E.Input.Selection,{showLabel:!1,label:s.selectColor},Fi.default.createElement(Re,{activeColor:i.color,colors:e,labelsColor:n,colorPickerDirection:"top",onChange:i.changeColor}))),Fi.default.createElement(I1,{label:s.tabSize},Fi.default.createElement(M.Slider,{style:{width:"280px"},showLabel:!1,label:s.sliderSize,value:i.relativeSize,min:1,max:100,divider:1,onChange:i.changeRelativeSize})),Fi.default.createElement(I1,{label:s.tabHardness},Fi.default.createElement(M.Slider,{style:{width:"280px"},showLabel:!1,label:s.sliderHardness,value:i.hardness,min:0,max:1,onChange:i.changeHardness}))))))},H5=P("brushTool","custom")(O(sW));var os=y(require("react"));var nW=({filterTool:i,custom:t})=>{let{state:e}=i,r=i.locale.controls,o=t.getButton("toolControlBarSecondaryButton"),s=()=>{i.toolSnapshot()};return os.default.createElement(M.ControlsbarContainer,{show:i.isOptionSelected},os.default.createElement(o,{tool:C.FILTER,ariaLabel:i.locale.controls.buttonReset,onClick:i.reset,icon:os.default.createElement(ke.reset,null),label:i.locale.controls.buttonReset}),os.default.createElement(M.Other.ControlsWrapper,null,os.default.createElement(E.Spacer,{count:2}),os.default.createElement(M.Slider,{"aria-hidden":!i.isOptionSelected,style:{width:"280px"},label:r.sliderIntensity,value:e.intensity,min:0,max:1,onMouseUp:s,onTouchEnd:s,onChange:i.changeIntensity,snap:e.isDuotone?.5:null}),os.default.createElement(E.Spacer,{count:2}),os.default.createElement(M.BarSeparator,null)),os.default.createElement(M.Other.EmptyDiv,null))},W5=P("filterTool","custom")(O(nW));var ss=y(require("react"));var G5=O(()=>{let{focusTool:i,custom:t}=Ee(),e=i.locale.controls,r=t.getButton("toolControlBarSecondaryButton"),o=()=>{i.toolSnapshot(e.sliderIntensity)};return ss.default.createElement(M.ControlsbarContainer,{show:i.isOptionSelected},ss.default.createElement(r,{tool:C.FOCUS,ariaLabel:e.buttonReset,onClick:i.reset,icon:ss.default.createElement(ke.reset,null),label:e.buttonReset}),ss.default.createElement(M.Other.ControlsWrapper,null,ss.default.createElement(E.Spacer,{count:2}),ss.default.createElement(M.Slider,{"aria-hidden":!i.isOptionSelected,style:{width:"280px"},label:e.sliderIntensity,value:i.relativeIntensity,min:0,max:100,divider:1,onChange:i.changeRelativeIntensity,onMouseUp:o,onTouchEnd:o}),ss.default.createElement(E.Spacer,{count:2}),ss.default.createElement(M.BarSeparator,null)),ss.default.createElement(M.Other.EmptyDiv,null))});var ui=y(require("react"));var aW=M.TabWrapper,{Tab:E1}=M,lW=({frameTool:i,custom:t})=>{let e=i.locale.controls,r=i.localeColor.colorPicker,{tintable:o,colorList:s}=i,n=t.getButton("toolControlBarSecondaryButton"),a=l=>{i.toolSnapshot(l)};return ui.default.createElement(M.ControlsbarContainer,{show:i.isOptionSelected},ui.default.createElement(n,{tool:C.FRAME,ariaLabel:e.buttonReset,onClick:i.reset,icon:ui.default.createElement(ke.reset,null),label:e.buttonReset}),ui.default.createElement(M.Other.ControlsWrapper,null,ui.default.createElement(E.Spacer,null),ui.default.createElement(aW,null,ui.default.createElement(E1,{label:e.tabOpacity},ui.default.createElement(M.Slider,{"aria-hidden":!i.isOptionSelected,showLabel:!1,style:{width:"280px"},label:e.sliderOpacity,value:i.opacity,min:0,max:1,onChange:i.changeOpacity,onMouseUp:()=>{a(e.sliderOpacity)},onTouchEnd:()=>{a(e.sliderOpacity)}})),ui.default.createElement(E1,{label:e.tabSize},ui.default.createElement(M.Slider,{"aria-hidden":!i.isOptionSelected,showLabel:!1,style:{width:"280px"},label:e.sliderSize,value:i.size,min:i.minSize,max:i.maxSize,divider:1,onChange:i.changeWidth,onMouseUp:()=>{a(e.sliderSize)},onTouchEnd:()=>{a(e.sliderSize)}})),o&&ui.default.createElement(E1,{label:e.tabColor},ui.default.createElement(E.Spacer,{count:1}),ui.default.createElement(E.Input.Selection,{label:e.selectColor,showLabel:!1},ui.default.createElement(Re,{activeColor:i.color,colors:s,labelsColor:r,colorPickerDirection:"top",onChange:i.changeColor,onAddSnapshot:i.colorSnapshot})))||null),ui.default.createElement(M.BarSeparator,null)),ui.default.createElement(M.Other.EmptyDiv,null))},V5=P("frameTool","canvas","custom")(O(lW));var ns=y(require("react"));var L_=y(require("styled-components"));var cW=L_.default(M.ControlsbarContainer)`
  ${i=>i.firstChildMargin&&L_.css`
      > :first-child {
        margin-right: 16px;
      }
    `}
`,dW=({library:i,active:t,custom:e})=>{let r=i.locale.controls.placeholderSearch,{config:o}=i,s=e.getButton("toolControlBarPrimaryButton"),n=d=>{i.fetchImages(d)},a=d=>{let{files:u}=d.target;if(u.length){let m=new FileReader;m.onload=p=>{t.newImage(p.target.result)},m.readAsDataURL(u[0])}},l=()=>{t.selectWebcam(!0)},c=()=>{let d=document.getElementById("fileUpload");d&&d.click()};return ns.default.createElement(cW,{firstChildMargin:o.enableWebcam&&!i.libraryProvider,show:!0},o.enableUpload&&ns.default.createElement(s,{tool:C.LIBRARY,ariaLabel:i.locale.controls.buttonUpload,onClick:c,icon:ns.default.createElement(ke.uploadImage,null),label:i.locale.controls.buttonUpload},ns.default.createElement(E.Input.File,{onChange:a})),i.libraryProvider&&ns.default.createElement(M.Other.ControlsWrapper,null,ns.default.createElement(E.Input.Search,{onChange:n,placeholder:r})),o.enableWebcam&&ns.default.createElement(I_,{tool:C.LIBRARY,onClick:l,icon:ns.default.createElement(ke.openWebcam,null),label:i.locale.controls.buttonWebcamOpen}),ns.default.createElement(M.BarSeparator,null))},j5=P("library","active","custom")(O(dW));var Cr=y(require("react"));var uW=M.TabWrapper,{Tab:$5}=M,mW=({overlayTool:i,custom:t})=>{let{state:e}=i,r=i.locale.controls,{allBlendModes:o}=i,{blendMode:s}=i,n=t.getButton("toolControlBarSecondaryButton"),a=()=>{i.toolSnapshot()},l=c=>{i.changeBlendMode(c)};return Cr.default.createElement(M.ControlsbarContainer,{show:i.isOptionSelected},Cr.default.createElement(n,{tool:C.OVERLAY,ariaLabel:r.buttonReset,onClick:i.reset,icon:Cr.default.createElement(ke.reset,null),label:r.buttonReset}),Cr.default.createElement(M.Other.ControlsWrapper,null,Cr.default.createElement(E.Spacer,null),Cr.default.createElement(uW,null,Cr.default.createElement($5,{label:r.tabBlendMode},Cr.default.createElement(E.Input.CarouselSlider,{showLabel:!1,label:r.carouselBlendMode,defaultIdentifier:s,onSelect:l,list:o})),Cr.default.createElement($5,{label:r.tabOpacity},Cr.default.createElement(M.Slider,{"aria-hidden":!i.isOptionSelected,showLabel:!1,style:{width:"280px"},label:r.sliderOpacity,value:e.opacity,min:0,max:1,onChange:i.changeOpacity,onMouseUp:a,onTouchEnd:a}))),Cr.default.createElement(M.BarSeparator,null)),Cr.default.createElement(M.Other.EmptyDiv,null))},Y5=P("overlayTool","custom")(O(mW));var Ue=y(require("react"));var K5=y(require("styled-components"));var pW=M.TabWrapper,{Tab:X5}=M,hW=K5.default.input.attrs({type:"file",id:"fileUpload",accept:"image/*",multiple:!0})`
  ${tf.VisuallyHidden}
`,fW=({stickerTool:i,custom:t})=>{let{colorList:e}=i,r=i.locale.controls,o=i.localeColor.colorPicker,s=t.getButton("toolControlBarPrimaryButton"),n=()=>{i.toolSnapshot()},a=()=>{let m=document.getElementById("fileUpload");m&&(m.value=null,m.click())},l=m=>{let{files:p}=m.target;i.addFiles(p)},c=()=>Ue.default.createElement("div",null,Ue.default.createElement(E.Spacer,{count:2}),Ue.default.createElement(M.Slider,{isDisabled:!i.isStickerSelected,style:{width:"280px"},label:r.sliderOpacity,value:i.opacity,min:0,max:1,onMouseUp:n,onTouchEnd:n,onChange:i.changeOpacity}),Ue.default.createElement(E.Spacer,{count:2})),d=()=>Ue.default.createElement("div",null,Ue.default.createElement(E.Spacer,null),Ue.default.createElement(pW,null,Ue.default.createElement(X5,{label:r.tabColor},Ue.default.createElement(E.Spacer,{count:1}),Ue.default.createElement(E.Input.Selection,{isDisabled:!i.isStickerSelected,showLabel:!1,label:r.selectColor},Ue.default.createElement(Re,{activeSprite:i.id,activeColor:i.tintColor,colors:e,labelsColor:o,isDisabled:!i.isStickerSelected,colorPickerDirection:"top",onChange:i.changeTintColor,onAddSnapshot:i.tintColorSnapshot}))),Ue.default.createElement(X5,{label:r.tabOpacity},Ue.default.createElement(M.Slider,{isDisabled:!i.isStickerSelected,showLabel:!1,style:{width:"280px"},label:r.sliderOpacity,value:i.opacity,min:0,max:1,onMouseUp:n,onTouchEnd:n,onChange:i.changeOpacity})))),u=()=>i.isCustomStickerEnabled?Ue.default.createElement(s,{tool:C.STICKER,ariaLabel:r.buttonUpload,onClick:a,icon:Ue.default.createElement(ke.uploadImage,null),label:r.buttonUpload},Ue.default.createElement(hW,{onChange:l})):null;return Ue.default.createElement(M.ControlsbarContainer,{show:!0},u(),Ue.default.createElement(M.Other.ControlsWrapper,null,i.tintable&&d()||c(),Ue.default.createElement(M.BarSeparator,null)),Ue.default.createElement(M.Other.EmptyDiv,null))},q5=P("stickerTool","custom")(O(fW));var Ce=y(require("react"));var Z5=y(require("styled-components"));var gW=M.ResponsiveTabWrapper,{Tab:dp}=M,bW=Z5.default(E.Input.NumericInput)`
  max-width: 55px;
  > div > input {
    text-align: center;
  }
`,_W=({textTool:i,custom:t})=>{let{colorList:e,backgroundColorList:r}=i,o=i.locale.controls,s=i.localeColor.colorPicker,n=["left","center","right"],a=t.getButton("textAlignment"),l=t.getButton("toolControlBarPrimaryButton"),c=()=>n.map(m=>{let p=of[m];return Ce.default.createElement(a,{tool:m,isDisabled:!i.isTextSelected,ariaLabel:`Align ${m}`,isActive:m===i.alignment,key:m,icon:Ce.default.createElement(p,null),onClick:()=>i.changeAlignment(m)})}),d=()=>{i.toolSnapshot()},u=m=>{let p=m?parseFloat(m):0;i.setFontSize(Math.max(10,Math.min(690,p)))};return Ce.default.createElement(M.ControlsbarContainer,{show:!0},Ce.default.createElement(l,{tool:C.TEXT,ariaLabel:o.buttonNew,onClick:i.add,icon:Ce.default.createElement(ke.addText,null),label:o.buttonNew}),Ce.default.createElement(M.Other.ControlsWrapper,null,Ce.default.createElement(E.Spacer,null),Ce.default.createElement(gW,null,Ce.default.createElement(dp,{label:o.tabFontSize},Ce.default.createElement(bW,{value:i.fontSize.toFixed(0),onSubmit:u,isDisabled:!i.isTextSelected})),Ce.default.createElement(dp,{label:o.tabAlignment},Ce.default.createElement(E.Input.Selection,{isDisabled:!i.isTextSelected,showLabel:!1,label:o.selectAlignment},c())),Ce.default.createElement(dp,{label:o.tabColor},Ce.default.createElement(E.Spacer,null),Ce.default.createElement(E.Input.Selection,{isDisabled:!i.isTextSelected,showLabel:!1,label:o.selectFontColor},Ce.default.createElement(Re,{activeSprite:i.id,activeColor:i.textColor,colors:e,labelsColor:s,colorPickerDirection:"top",isDisabled:!i.isTextSelected,onChange:i.changeColor,onAddSnapshot:i.colorSnapshot}))),Ce.default.createElement(dp,{label:o.tabBgColor},Ce.default.createElement(E.Spacer,null),Ce.default.createElement(E.Input.Selection,{isDisabled:!i.isTextSelected,showLabel:!1,label:o.selectBackgroundColor},Ce.default.createElement(Re,{activeSprite:i.id,activeColor:i.backgroundColor,colors:r,labelsColor:s,colorPickerDirection:"top",isDisabled:!i.isTextSelected,onChange:i.changeBackgroundColor,onAddSnapshot:i.backgroundColorSnapshot}))),Ce.default.createElement(dp,{label:o.tabLineHeight},Ce.default.createElement(M.Slider,{isDisabled:!i.isTextSelected,showLabel:!1,label:o.sliderLineSpacing,value:i.lineHeight,min:.5,max:3,onChange:i.changeLineHeight,onMouseUp:d,onTouchEnd:d,snap:1,divider:1,decimal:1}))),Ce.default.createElement(M.BarSeparator,null)),Ce.default.createElement(M.Other.EmptyDiv,null))},J5=P("textTool","custom")(O(_W));var as=y(require("react"));var yW=({textDesignTool:i,custom:t})=>{let e=i.locale.controls,r=i.localeColor.colorPicker,{colorList:o}=i,s=t.getButton("toolControlBarSecondaryButton"),n=t.getButton("toolControlBarPrimaryButton");return as.default.createElement(M.ControlsbarContainer,{show:!0},as.default.createElement(n,{tool:C.TEXT_DESIGN,ariaLabel:e.buttonNew,onClick:i.add,icon:as.default.createElement(ke.addText,null),label:e.buttonNew}),as.default.createElement(M.Other.ControlsWrapper,null,as.default.createElement(E.Input.Selection,{isDisabled:!i.isTextDesignSelected,label:e.selectColor},as.default.createElement(Re,{activeSprite:i.id,activeColor:i.color,colors:o,labelsColor:r,colorPickerDirection:"top",isDisabled:!i.isTextDesignSelected,onChange:i.changeColor,onAddSnapshot:i.colorSnapshot}))),as.default.createElement(s,{tool:C.TEXT_DESIGN,ariaLabel:e.buttonShuffle,onClick:i.changeSeed,icon:as.default.createElement(ke.shuffle,null),label:e.buttonShuffle}),as.default.createElement(M.BarSeparator,null))},Q5=P("textDesignTool","custom")(O(yW));var Oi=y(require("react"));var xW=M.ResponsiveTabWrapper,{Tab:A1}=M,vW=({transformTool:i,custom:t})=>{let e=i.locale.controls,{forceDimensions:r}=i,o=t.getCheckbox(),s=t.getButton("toolControlBarSecondaryButton");return Oi.default.createElement(M.ControlsbarContainer,{show:!0},Oi.default.createElement(s,{tool:C.TRANSFORM,ariaLabel:i.locale.controls.buttonReset,onClick:i.reset,icon:Oi.default.createElement(ke.reset,null),label:i.locale.controls.buttonReset}),Oi.default.createElement(M.Other.ControlsWrapper,null,Oi.default.createElement(E.Spacer,null),Oi.default.createElement(xW,null,Oi.default.createElement(A1,{label:e.tabCropSize},Oi.default.createElement(Gm,{isDisabled:r,showLabel:!1,valueHeight:i.localOutputHeight,valueWidth:i.localOutputWidth,onSubmitWidth:i.onPixelWidth,onSubmitHeight:i.onPixelHeight,label:e.inputCropSize,labelHeight:e.inputHeight,labelWidth:e.inputWidth})),Oi.default.createElement(A1,{label:e.tabFlipAndRotate},Oi.default.createElement(Nm,null)),Oi.default.createElement(A1,{label:e.tabResolution},Oi.default.createElement(o,{isDisabled:r,style:{paddingTop:"5px",justifyContent:"center"},value:i.lockResolution,checkMarkPosition:"left",label:e.checkboxKeepResolution,onClick:i.changeLockResolution}))),Oi.default.createElement(M.BarSeparator,null)),Oi.default.createElement(M.Other.EmptyDiv,null))},tP=P("transformTool","custom")(O(vW));var up=class extends ge.default.Component{render(){let{active:t}=this.props,e=t.tool;return ge.default.createElement(M.Controlsbar,{show:!!e},ge.default.createElement(E.Switch.Index,{type:e},ge.default.createElement(E.Switch.Case,{value:C.FILTER},ge.default.createElement(W5,null)),ge.default.createElement(E.Switch.Case,{value:C.FOCUS},ge.default.createElement(G5,null)),ge.default.createElement(E.Switch.Case,{value:C.ADJUSTMENT},ge.default.createElement(N5,null)),ge.default.createElement(E.Switch.Case,{value:C.OVERLAY},ge.default.createElement(Y5,null)),ge.default.createElement(E.Switch.Case,{value:C.STICKER},ge.default.createElement(q5,null)),ge.default.createElement(E.Switch.Case,{value:C.TEXT},ge.default.createElement(J5,null)),ge.default.createElement(E.Switch.Case,{value:C.TEXT_DESIGN},ge.default.createElement(Q5,null)),ge.default.createElement(E.Switch.Case,{value:C.LIBRARY},ge.default.createElement(j5,null)),ge.default.createElement(E.Switch.Case,{value:C.FRAME},ge.default.createElement(V5,null)),ge.default.createElement(E.Switch.Case,{value:C.BRUSH},ge.default.createElement(H5,null)),ge.default.createElement(E.Switch.Case,{value:C.TRANSFORM},ge.default.createElement(tP,null))))}};up=h([P("active","config"),O],up);var Zi=y(require("react"));var Od=y(require("react"));var eP=y(require("styled-components"));var CW=eP.default.div`
  position: relative;
  top: -8px;
  color: ${i=>i.theme.card.foreground};
`,SW=({adjustmentsTool:i})=>{let t=(e,r)=>{let o=gT[e.identifier];return Od.default.createElement(M.Card,{tool:C.ADJUSTMENT,type:ft.MEDIUM,onClick:()=>i.toggleOptionSelection(e.identifier),isActive:e.identifier===i.selectedAdjustmentType,key:`${e.identifier}-${r}`,label:e.name,style:{animationDelay:`${At(r)}s`}},Od.default.createElement(CW,null,Od.default.createElement(o,null)),Od.default.createElement(M.CardLabel,null,i.locale.items[e.identifier]||e.name))};return Od.default.createElement(M.CardContainer,null,i.items.map(t))},iP=P("adjustmentsTool")(O(SW));var rP=y(require("react"));var oP=()=>{let{config:i}=Ee(),t=i.state.config[C.CUSTOM].toolControlBar;return rP.default.createElement(t,{language:i.state.locale[C.CUSTOM]})};var ls=y(require("react"));var mp=class extends ls.default.Component{constructor(){super(...arguments);this.onCategoryClick=t=>{let{filterTool:e}=this.props;e.toggleCategorySelection(t)};this.renderItem=(t,e)=>{let{filterTool:r}=this.props;return ls.default.createElement(M.Card,{tool:C.FILTER,type:ft.MEDIUM,onClick:()=>r.selectFilter(t.identifier,t.defaultIntensity),isActive:r.identifier===t.identifier,key:`${t.identifier}-${e}`,image:t.thumbnailURI,label:t.name,style:{animationDelay:`${At(e)}s`}},ls.default.createElement(M.CardLabel,{withBackground:!0},r.locale.categories[t.identifier]||r.locale.items[t.identifier]||t.name))};this.renderCategory=(t,e)=>{let{filterTool:r}=this.props,{selectedCategoryIdentifier:o}=r,s=o===t.identifier;return t.items?ls.default.createElement(M.CategoryContainer,{key:t.identifier},ls.default.createElement(M.Card,{tool:C.FILTER,type:ft.LARGE,onClick:()=>this.onCategoryClick(t.identifier),image:t.thumbnailURI,label:t.name,style:{animationDelay:`${At(e)}s`}},ls.default.createElement(M.CardLabel,{withBackground:!0},t.name)),ls.default.createElement(M.ExpandableContainer,{show:s},t.items.map(this.renderItem))):null}}render(){let{filterTool:t}=this.props,{categories:e,config:r,items:o}=t;return r.flattenCategories?ls.default.createElement(M.CardContainer,null,o.map(this.renderItem)):ls.default.createElement(M.CardContainer,null,e.map(this.renderCategory))}};mp=h([P("filterTool","active"),O],mp);var z_=y(require("react"));var wW=({focusTool:i})=>{let t=r=>{i.selectFocus(r)},e=(r,o)=>z_.default.createElement(M.Card,{isActive:r.identifier===i.identifier,tool:C.FOCUS,type:ft.MEDIUM,onClick:()=>t(r.identifier),key:`${r.identifier}-${o}`,image:r.thumbnailURI,label:r.name,style:{animationDelay:`${At(o)}s`}},z_.default.createElement(M.CardLabel,{withBackground:!0},i.locale.items[r.identifier]||r.name));return z_.default.createElement(M.CardContainer,null,i.items.map(e))},sP=P("focusTool")(O(wW));var U_=y(require("react"));var kW=({frameTool:i})=>{let t=i.identifier,e=(r,o)=>U_.default.createElement(M.Card,{tool:C.FRAME,type:ft.MEDIUM,onClick:()=>i.selectFrame(r.identifier),isActive:r.identifier===t,key:`${r.identifier}-${o}`,image:r.thumbnailURI,label:r.name,style:{animationDelay:`${At(o)}s`,backgroundSize:"60%"}}," ",U_.default.createElement(M.CardLabel,{hidden:!0},i.locale.items[r.identifier]||r.name));return U_.default.createElement(M.CardContainer,null,i.items.map(e))},nP=P("frameTool")(O(kW));var go=y(require("react"));var pp=class extends go.default.Component{constructor(){super(...arguments);this.onCategoryClick=t=>{let{library:e}=this.props;e.toggleCategorySelection(t)};this.renderItem=(t,e)=>{let{active:r}=this.props;return go.default.createElement(M.Card,{tool:C.LIBRARY,type:ft.MEDIUM,onClick:()=>r.newImage(t.rawUrl),key:`${t.identifier}-${e}`,image:t.thumbnailURI,label:t.name,style:{animationDelay:`${At(e)}s`}})};this.renderCategory=(t,e)=>{let{library:r}=this.props,{selectedCategoryIdentifier:o}=r,s=o===t.identifier;return t.items?go.default.createElement(M.CategoryContainer,{key:t.identifier},go.default.createElement(M.Card,{tool:C.LIBRARY,type:ft.LARGE,onClick:()=>this.onCategoryClick(t.identifier),image:t.thumbnailURI,label:t.name,style:{animationDelay:`${At(e)}s`}},go.default.createElement(M.CardLabel,{withBackground:!0},t.name)),go.default.createElement(M.ExpandableContainer,{show:s},t.items.map(this.renderItem))):null}}render(){let{library:t}=this.props,{query:e,categories:r,items:o,locale:s,config:n}=t;return e?o.length?go.default.createElement(M.CardContainer,null,o.map(this.renderItem)):go.default.createElement("p",{"data-test":H.NoResult},s.controls.noResults):n.flattenCategories?go.default.createElement(M.CardContainer,null,o.map(this.renderItem)):go.default.createElement(M.CardContainer,null,r.map(this.renderCategory))}};pp=h([P("library","active"),O],pp);var N_=y(require("react"));var TW=({overlayTool:i})=>{let{identifier:t,items:e,selectOverlay:r,locale:o}=i,s=(n,a)=>N_.default.createElement(M.Card,{tool:C.OVERLAY,type:ft.MEDIUM,onClick:()=>r(n.identifier),isActive:n.identifier===t,key:`${n.identifier}-${a}`,image:n.thumbnailURI,label:n.name,style:{animationDelay:`${At(a)}s`}},N_.default.createElement(M.CardLabel,{withBackground:!0},o.items[n.identifier]||n.name));return N_.default.createElement(M.CardContainer,null,e.map(s))},aP=P("overlayTool")(O(TW));var cs=y(require("react"));var hp=class extends cs.default.Component{constructor(){super(...arguments);this.onCategoryClick=t=>{let{stickerTool:e}=this.props;e.toggleCategorySelection(t)};this.renderItem=(t,e)=>{let{stickerTool:r}=this.props;return cs.default.createElement(M.Card,{tool:C.STICKER,type:ft.MEDIUM,onClick:()=>r.add(t.identifier),key:`${t.identifier}-${e}`,image:t.thumbnailURI,label:t.name,style:{backgroundSize:"55%",animationDelay:`${gh(e)}s`}},cs.default.createElement(M.CardLabel,{hidden:!0},r.locale.items[t.identifier]||t.name))};this.renderCategory=(t,e)=>{let{stickerTool:r}=this.props,{selectedCategoryIdentifier:o,locale:s}=r,n=o===t.identifier;return t.items?cs.default.createElement(M.CategoryContainer,{key:t.identifier},cs.default.createElement(M.Card,{tool:C.STICKER,type:ft.LARGE,onClick:()=>this.onCategoryClick(t.identifier),image:t.thumbnailURI,label:t.name,style:{animationDelay:`${At(e)}s`}},cs.default.createElement(M.CardLabel,{withBackground:!0},s.categories[t.identifier]||t.name)),cs.default.createElement(M.ExpandableContainer,{show:n},t.items.map(this.renderItem))):null}}render(){let{stickerTool:t}=this.props,{categories:e,items:r,config:o}=t;return o.flattenCategories?cs.default.createElement(M.CardContainer,null,r.map(this.renderItem)):cs.default.createElement(M.CardContainer,null,e.map(this.renderCategory))}};hp=h([P("stickerTool","active"),O],hp);var fp=y(require("react"));var lP=y(require("styled-components"));var DW=lP.default.div`
  font-size: 20px;
  position: absolute;
  left: 50%;
  top: 50%;
  transform-origin: left top;
`,cP=class extends fp.default.Component{constructor(){super(...arguments);this.getWidth=({fontFamily:t,fontStyle:e,fontWeight:r},o)=>{let n=document.createElement("canvas").getContext("2d");return n.font=`${e} ${r} 20px ${t}`,n.fillText(o,0,0),n.measureText(o).width};this.renderItem=(t,e)=>{let{config:r,textTool:o}=this.props,{fontFamily:s,fontWeight:n,fontStyle:a,identifier:l}=t,c=`${t.fontFamily} ${yt.getDisplayFontStyle(t)}`,d=this.getWidth(t,c),u=(r.measurements.basicCard.medium.width-20)/d;return fp.default.createElement(M.Card,{tool:C.TEXT,type:ft.MEDIUM,onClick:()=>o.changeFont(l),isDisabled:!this.textTool.isTextSelected,isActive:o.identifier===l,key:`${t.identifier}-${e}`,label:c,style:{animationDelay:`${At(e)}s`}},fp.default.createElement(DW,{style:{transform:`scale(${u}) translate(-50%, -50%)`,fontFamily:s,fontStyle:a,fontWeight:n}},c))}}get textTool(){return this.props.textTool}render(){let{textTool:t}=this.props,{fontsLoaded:e,fontFamilies:r}=t;return e?fp.default.createElement(M.CardContainer,null,r.map(this.renderItem)):null}},dP=P("textTool","config")(O(cP));var H_=y(require("react"));var IW=({textDesignTool:i})=>{let{items:t,changeIdentifier:e,isTextDesignSelected:r,identifier:o}=i,s=(n,a)=>H_.default.createElement(M.Card,{tool:C.TEXT_DESIGN,type:ft.MEDIUM,onClick:()=>e(n.identifier),isDisabled:!r,isActive:o===n.identifier,key:`${n.identifier}-${a}`,image:n.thumbnailURI,label:n.name,style:{animationDelay:`${At(a)}s`,backgroundSize:"60%"}},H_.default.createElement(M.CardLabel,{hidden:!0},n.name));return H_.default.createElement(M.CardContainer,null,t.map(s))},uP=P("textDesignTool")(O(IW));var qi=y(require("react"));var F1=y(require("styled-components"));var EW=F1.default.div`
  svg {
    margin-bottom: 12px;
  }
`,AW=F1.default.div`
  svg {
    width: ${i=>i.theme.measurements.basicCard.medium.height}px;
    height: ${i=>i.theme.measurements.basicCard.medium.height}px;
  }

  ${xi} {
    width: ${i=>i.theme.measurements.basicCard.medium.width-32}px;
    height: ${i=>i.theme.measurements.basicCard.medium.height-32}px;
    padding: 6px 0px 24px;
  }
`,gp=class extends qi.default.Component{constructor(){super(...arguments);this.onCategoryClick=t=>{let{transformTool:e}=this.props;e.toggleCategorySelection(t)};this.renderItem=(t,e)=>{let{transformTool:r,config:o}=this.props,{locale:s}=r,n=r.checkIfTransformThumbnailExits(t.thumbnailURI),a=Nt.crops[t.identifier]||Nt.crops.imgly_transform_common_custom,l=qi.default.createElement(M.CardLabel,null,s.items[t.identifier]||t.name),c=n?l:qi.default.createElement(AW,null,qi.default.createElement(a,{main:o.theme.transform.crops.main,highlight:o.theme.transform.crops.highlight,shadow:o.theme.transform.crops.shadow}),l);return qi.default.createElement(M.Card,{tool:C.TRANSFORM,type:ft.MEDIUM,onClick:()=>r.changeIdentifier(t.identifier,!0),key:`${t.identifier}-${e}`,image:t.thumbnailURI,label:t.name,style:{backgroundSize:"55%",animationDelay:`${At(e)}s`}},c)};this.renderCategory=(t,e)=>{let{transformTool:r}=this.props,{selectedCategoryIdentifier:o,locale:s}=r,n=o===t.identifier;if(!t.items)return null;let a=r.checkIfTransformThumbnailExits(t.thumbnailURI),l=qi.default.createElement(M.CardLabel,null,s.categories[t.identifier]||t.name),c=a?l:qi.default.createElement(EW,null,Nt.categories[t.identifier]&&qi.default.createElement(Nt.categories[t.identifier]),l);return qi.default.createElement(M.CategoryContainer,{key:t.identifier},qi.default.createElement(M.Card,{tool:C.TRANSFORM,type:ft.LARGE,onClick:()=>this.onCategoryClick(t.identifier),image:a?t.thumbnailURI:"",label:t.name,style:{animationDelay:`${At(e)}s`}},c),qi.default.createElement(M.ExpandableContainer,{show:n},t.items.map(this.renderItem)))}}render(){let{transformTool:t}=this.props,{categories:e,config:r,items:o}=t;return r.flattenCategories?qi.default.createElement(M.CardContainer,null,o.map(this.renderItem)):qi.default.createElement(M.CardContainer,null,e.map(this.renderCategory))}};gp=h([P("transformTool","config"),O],gp);var bp=class extends Zi.default.Component{constructor(){super(...arguments);this.getToolItemsComponent=t=>{switch(t){case C.LIBRARY:return Zi.default.createElement(pp,null);case C.FILTER:return Zi.default.createElement(mp,null);case C.FOCUS:return Zi.default.createElement(sP,null);case C.ADJUSTMENT:return Zi.default.createElement(iP,null);case C.OVERLAY:return Zi.default.createElement(aP,null);case C.STICKER:return Zi.default.createElement(hp,null);case C.TEXT:return Zi.default.createElement(dP,null);case C.TEXT_DESIGN:return Zi.default.createElement(uP,null);case C.FRAME:return Zi.default.createElement(nP,null);case C.TRANSFORM:return Zi.default.createElement(gp,null);case C.CUSTOM:return Zi.default.createElement(oP,null);default:return null}}}render(){let{library:t,active:e}=this.props,r=e.tool;return r===C.BRUSH||r===C.LIBRARY&&!t.libraryProvider?null:Zi.default.createElement(M.Itemsbar,{"data-test":H.ToolControlBar,show:!!r},this.getToolItemsComponent(r))}};bp=h([P("active","library"),O],bp);var FW=mP.default.div`
  position: absolute;
  width: 100%;
  height: ${i=>i.theme.measurements.basicToolControlBar.maxHeight}px;
  bottom: 0;
  left: 0;
  background: ${i=>i.theme.webcam.backdrop};
  z-index: ${i=>i.theme.measurements.zIndex.disable};
`,_p=class extends bo.default.Component{static getDerivedStateFromError(t){return console.error(t),{hasError:!0}}render(){let{active:t}=this.props;return bo.default.createElement(E.Container,{"data-test":H.EditorContainer},t.isWebcam?bo.default.createElement(FW,null):null,bo.default.createElement(bd,null),bo.default.createElement(Kn,null,bo.default.createElement(ad,null),bo.default.createElement(fd,null),bo.default.createElement(up,null),bo.default.createElement(bp,null),bo.default.createElement(U5,null)))}};_p=h([P("active"),O],_p);var O1=class extends yp.default.Component{componentDidMount(){let{editor:t,storeProps:e}=this.props;this.editor=t,this.storeProps=e;let r=new gd(this.editor.configStore.config.custom.components,{}),o={getDialog:r.getDialog,getButton:r.getButton,getColorItem:r.getColorItem,getCheckbox:r.getCheckbox};this.storeProps.custom=o,this.forceUpdate()}render(){return this.storeProps?yp.default.createElement($d,b({},this.storeProps),yp.default.createElement(pP.ThemeProvider,{theme:b(b({},this.editor.configStore.theme),{measurements:this.editor.configStore.measurements})},yp.default.createElement(_p,null))):null}};var gP=class extends W_.default.Component{constructor(){super(...arguments);this.UIComponent=null}componentDidMount(){this.editor=this.props.editor,this.storeProps={filterTool:this.editor.filterToolStore,focusTool:this.editor.focusToolStore,adjustmentsTool:this.editor.adjustmentsToolStore,overlayTool:this.editor.overlayToolStore,frameTool:this.editor.frameToolStore,brushTool:this.editor.brushToolStore,transformTool:this.editor.transformToolStore,scale:this.editor.scale,sprite:this.editor.spriteStore,stickerTool:this.editor.spriteStore.stickerToolStore,textTool:this.editor.spriteStore.textToolStore,textDesignTool:this.editor.spriteStore.textDesignToolStore,library:this.editor.libraryStore,modal:this.editor.modalStore,snapping:this.editor.snappingStore,config:this.editor.configStore,active:this.editor.activeStore,canvas:this.editor.canvasStore,history:this.editor.historyStore,editor:this.editor},this.editor.configStore.config.layout==="basic"?Promise.resolve().then(()=>y(R1())).then(({BasicUI:t})=>{this.UIComponent=t,this.forceUpdate()}):(this.UIComponent=Ed,this.forceUpdate())}componentWillUnmount(){this.editor.engine.dispose(),this.editor.configStore.events.removeAllListeners(rt.EXPORT),this.editor.configStore.events.removeAllListeners(rt.CLOSE),this.editor.configStore.events.removeAllListeners(rt.HISTORY_CHANGE),this.editor.configStore.events.removeAllListeners(rt.EDITOR_READY),this.editor.configStore.events.removeAllListeners(rt.ERROR_IMAGE_LOADING),this.editor.configStore.events.removeAllListeners(rt.IMAGE_LOAD),this.editor.configStore.events.removeAllListeners(rt.TOOL_ENTER),this.editor.configStore.events.removeAllListeners(rt.STICKER_UPLOAD_ADD)}render(){if(this.editor){let t=this.UIComponent;return this.storeProps&&t?W_.default.createElement(t,{editor:this.editor,storeProps:this.storeProps}):null}return null}},B1={init:i=>new fP().init(i)};var M1=y(require("react"));var G_=class extends M1.default.Component{constructor(t){super(t);this.ui=new Ri;this.serialize=t=>this.editor.serialize(t);this.deserialize=t=>this.editor.deserialize(t);this.export=t=>this.editor.export(t);this.close=()=>this.editor.close();this.setImage=t=>this.editor.setImage(t);this.reset=()=>{this.editor.resetToolStates(),this.editor.resize()};this.editor=new fe(b({},t)),this.editor.configStore.events.on(rt.EXPORT,e=>{this.ui.emit(rt.EXPORT,e)}),this.editor.configStore.events.on(rt.CLOSE,()=>{this.componentWillUnmount(),this.ui.emit(rt.CLOSE)}),this.editor.configStore.events.on(rt.HISTORY_CHANGE,()=>{this.ui.emit(rt.HISTORY_CHANGE)}),this.editor.configStore.events.on(rt.EDITOR_READY,()=>{this.ui.emit(rt.EDITOR_READY)}),this.editor.configStore.events.on(rt.ERROR_IMAGE_LOADING,e=>{this.ui.emit(rt.ERROR_IMAGE_LOADING,e)}),this.editor.configStore.events.on(rt.IMAGE_LOAD,()=>{this.ui.emit(rt.IMAGE_LOAD)}),this.editor.configStore.events.on(rt.TOOL_ENTER,e=>{this.ui.emit(rt.TOOL_ENTER,e)}),this.editor.configStore.events.on(rt.STICKER_UPLOAD_ADD,e=>{this.ui.emit(rt.STICKER_UPLOAD_ADD,e)}),this.storeProps={filterTool:this.editor.filterToolStore,focusTool:this.editor.focusToolStore,adjustmentsTool:this.editor.adjustmentsToolStore,overlayTool:this.editor.overlayToolStore,frameTool:this.editor.frameToolStore,brushTool:this.editor.brushToolStore,transformTool:this.editor.transformToolStore,scale:this.editor.scale,sprite:this.editor.spriteStore,stickerTool:this.editor.spriteStore.stickerToolStore,textTool:this.editor.spriteStore.textToolStore,textDesignTool:this.editor.spriteStore.textDesignToolStore,library:this.editor.libraryStore,modal:this.editor.modalStore,snapping:this.editor.snappingStore,config:this.editor.configStore,active:this.editor.activeStore,canvas:this.editor.canvasStore,history:this.editor.historyStore,editor:this.editor},this.editor.configStore.config.layout==="basic"?Promise.resolve().then(()=>y(R1())).then(({BasicUI:e})=>{this.UIComponent=e,this.forceUpdate()}):(this.UIComponent=Ed,this.forceUpdate())}componentWillUnmount(){this.ui.removeAllListeners(rt.EXPORT),this.ui.removeAllListeners(rt.HISTORY_CHANGE),this.ui.removeAllListeners(rt.EDITOR_READY),this.ui.removeAllListeners(rt.ERROR_IMAGE_LOADING),this.ui.removeAllListeners(rt.IMAGE_LOAD),this.ui.removeAllListeners(rt.TOOL_ENTER),this.ui.removeAllListeners(rt.STICKER_UPLOAD_ADD)}hasChanges(){return this.editor.hasChanges()}render(){if(this.editor){let t=this.UIComponent;return this.storeProps&&t?M1.default.createElement(t,{editor:this.editor,storeProps:this.storeProps}):null}return null}};var bP=()=>{let{active:i}=Ee();return i.newImage};Lp({isolateGlobalState:!0});var{Container:_P,Input:RW,ColorItem:yP,ColorItemBase:xP,ColorItemBackground:vP,ColorItemTiledBackground:CP,ColorItemActiveOverlay:SP,Dialog:wP,DialogBase:kP,DialogContainer:TP,DialogBackdrop:DP,DialogHeader:IP,DialogBody:EP,DialogFooter:AP,DialogSpinner:FP}=E,{Search:PW,Label:OP,Checkbox:RP,CheckboxBase:PP,CheckboxInput:BP,CheckboxCheckMark:MP}=RW,LP=Vm,zP=Vm,UP=PW;return BW;})();
/*
 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
 * Licensed under MIT
 * @license
 */
/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */
/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */
/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */
/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */
/*!
StackBlur - a fast almost Gaussian Blur For Canvas

Version:  0.5
Author:   Mario Klingemann
Contact:  mario@quasimondo.com
Website:  http://www.quasimondo.com/StackBlurForCanvas
Twitter:  @quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr:
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
@license
*/
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
