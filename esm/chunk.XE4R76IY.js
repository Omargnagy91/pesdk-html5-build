import{A as ab,B as oe,D as Mb,E as Wb,F as xi,G as cb,H as Ji,I as f,J as qp,K as pe,L as Ym,M as Py,N as qb,O as bs,P as Ye,R as Zb,S as De,T as C,U as he,V as A,a as Tp,b as de,c as wn,d as g,e as $e,f as Be,g as Gt,h as jt,i as ze,j as y,k as W,l as j,m as L,o as Yr,p as hb,q as oy,r as lb,t as Kb,u as $,v as iy,w as Tb,x as zb,y as _t,z as _}from"./chunk.WNPNZHNS.js";var Ra=Object.getOwnPropertySymbols,id=Object.prototype.propertyIsEnumerable;var Pe=(i,e)=>{var t={};for(var r in i)ab.call(i,r)&&e.indexOf(r)<0&&(t[r]=i[r]);if(i!=null&&Ra)for(var r of Ra(i))e.indexOf(r)<0&&id.call(i,r)&&(t[r]=i[r]);return t};var a=(i,e,t,r)=>{for(var o=r>1?void 0:r?cb(e,t):e,n=i.length-1,s;n>=0;n--)(s=i[n])&&(o=(r?s(e,t,o):s(o))||o);return r&&o&&lb(e,t,o),o};var dr=Ym((u0,vc)=>{var Om="Expected a function",_c=0/0,Tm="[object Symbol]",Pm=/^\s+|\s+$/g,Mm=/^[-+]0x[0-9a-f]+$/i,Bm=/^0b[01]+$/i,zm=/^0o[0-7]+$/i,Lm=parseInt,Um=typeof global=="object"&&global&&global.Object===Object&&global,Nm=typeof self=="object"&&self&&self.Object===Object&&self,Hm=Um||Nm||Function("return this")(),Wm=Object.prototype,jm=Wm.toString,Gm=Math.max,Vm=Math.min,zs=function(){return Hm.Date.now()};function $m(i,e,t){var r,o,n,s,l,c,p=0,m=!1,h=!1,b=!0;if(typeof i!="function")throw new TypeError(Om);e=Sc(e)||0,Ls(t)&&(m=!!t.leading,h="maxWait"in t,n=h?Gm(Sc(t.maxWait)||0,e):n,b="trailing"in t?!!t.trailing:b);function v(T){var Z=r,ae=o;return r=o=void 0,p=T,s=i.apply(ae,Z),s}function x(T){return p=T,l=setTimeout(M,e),m?v(T):s}function I(T){var Z=T-c,ae=T-p,Qe=e-Z;return h?Vm(Qe,n-ae):Qe}function R(T){var Z=T-c,ae=T-p;return c===void 0||Z>=e||Z<0||h&&ae>=n}function M(){var T=zs();if(R(T))return Q(T);l=setTimeout(M,I(T))}function Q(T){return l=void 0,b&&r?v(T):(r=o=void 0,s)}function se(){l!==void 0&&clearTimeout(l),p=0,r=c=o=l=void 0}function ve(){return l===void 0?s:Q(zs())}function _e(){var T=zs(),Z=R(T);if(r=arguments,o=this,c=T,Z){if(l===void 0)return x(c);if(h)return l=setTimeout(M,e),v(c)}return l===void 0&&(l=setTimeout(M,e)),s}return _e.cancel=se,_e.flush=ve,_e}function Ls(i){var e=typeof i;return!!i&&(e=="object"||e=="function")}function Km(i){return!!i&&typeof i=="object"}function qm(i){return typeof i=="symbol"||Km(i)&&jm.call(i)==Tm}function Sc(i){if(typeof i=="number")return i;if(qm(i))return _c;if(Ls(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=Ls(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=i.replace(Pm,"");var t=Bm.test(i);return t||zm.test(i)?Lm(i.slice(2),t?2:8):Mm.test(i)?_c:+i}vc.exports=$m});var fr=Ym((UA,bu)=>{var yu="Expected a function",vu=0/0,gf="[object Symbol]",bf=/^\s+|\s+$/g,yf=/^[-+]0x[0-9a-f]+$/i,vf=/^0b[01]+$/i,_f=/^0o[0-7]+$/i,Sf=parseInt,Df=typeof global=="object"&&global&&global.Object===Object&&global,xf=typeof self=="object"&&self&&self.Object===Object&&self,Cf=Df||xf||Function("return this")(),wf=Object.prototype,Ef=wf.toString,kf=Math.max,If=Math.min,ua=function(){return Cf.Date.now()};function Ff(i,e,t){var r,o,n,s,l,c,p=0,m=!1,h=!1,b=!0;if(typeof i!="function")throw new TypeError(yu);e=_u(e)||0,Uo(t)&&(m=!!t.leading,h="maxWait"in t,n=h?kf(_u(t.maxWait)||0,e):n,b="trailing"in t?!!t.trailing:b);function v(T){var Z=r,ae=o;return r=o=void 0,p=T,s=i.apply(ae,Z),s}function x(T){return p=T,l=setTimeout(M,e),m?v(T):s}function I(T){var Z=T-c,ae=T-p,Qe=e-Z;return h?If(Qe,n-ae):Qe}function R(T){var Z=T-c,ae=T-p;return c===void 0||Z>=e||Z<0||h&&ae>=n}function M(){var T=ua();if(R(T))return Q(T);l=setTimeout(M,I(T))}function Q(T){return l=void 0,b&&r?v(T):(r=o=void 0,s)}function se(){l!==void 0&&clearTimeout(l),p=0,r=c=o=l=void 0}function ve(){return l===void 0?s:Q(ua())}function _e(){var T=ua(),Z=R(T);if(r=arguments,o=this,c=T,Z){if(l===void 0)return x(c);if(h)return l=setTimeout(M,e),v(c)}return l===void 0&&(l=setTimeout(M,e)),s}return _e.cancel=se,_e.flush=ve,_e}function Af(i,e,t){var r=!0,o=!0;if(typeof i!="function")throw new TypeError(yu);return Uo(t)&&(r="leading"in t?!!t.leading:r,o="trailing"in t?!!t.trailing:o),Ff(i,e,{leading:r,maxWait:e,trailing:o})}function Uo(i){var e=typeof i;return!!i&&(e=="object"||e=="function")}function Rf(i){return!!i&&typeof i=="object"}function Of(i){return typeof i=="symbol"||Rf(i)&&Ef.call(i)==gf}function _u(i){if(typeof i=="number")return i;if(Of(i))return vu;if(Uo(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=Uo(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=i.replace(bf,"");var t=vf.test(i);return t||_f.test(i)?Sf(i.slice(2),t?2:8):yf.test(i)?vu:+i}bu.exports=Af});var rd="An invariant failed, however the error is obfuscated because this is an production build.",Ir=[];Object.freeze(Ir);var Oa={};Object.freeze(Oa);var od={};function gi(){return typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:od}function Ce(){return++E.mobxGuid}function V(i){throw Rt(!1,i),"X"}function Rt(i,e){if(!i)throw new Error("[mobx] "+(e||rd))}var Ta=[];function mt(i,e){return!1}function Jo(i){var e=!1;return function(){if(!e)return e=!0,i.apply(this,arguments)}}var Pa=function(){};function nd(i){var e=[];return i.forEach(function(t){e.indexOf(t)===-1&&e.push(t)}),e}function Zo(i){return i!==null&&typeof i=="object"}function bi(i){if(i===null||typeof i!="object")return!1;var e=Object.getPrototypeOf(i);return e===Object.prototype||e===null}function sd(i){if(yi(i)||et(i))return i;if(Array.isArray(i))return new Map(i);if(bi(i)){var e=new Map;for(var t in i)e.set(t,i[t]);return e}else return V("Cannot convert to map from '"+i+"'")}function ad(i,e){for(var t=0;t<e.length;t++)ht(i,e[t],i[e[t]])}function ht(i,e,t){Object.defineProperty(i,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}function Hi(i,e,t){Object.defineProperty(i,e,{enumerable:!1,writable:!1,configurable:!0,value:t})}function ld(i,e){}function Ot(i,e){var t="isMobX"+i;return e.prototype[t]=!0,function(r){return Zo(r)&&r[t]===!0}}function cd(i,e){return typeof i=="number"&&typeof e=="number"&&isNaN(i)&&isNaN(e)}function yi(i){return gi().Map!==void 0&&i instanceof gi().Map}function Wi(i){return i instanceof Set}function ft(i){for(var e=[];;){var t=i.next();if(t.done)break;e.push(t.value)}return e}function Ma(){return typeof Symbol=="function"&&Symbol.toPrimitive||"@@toPrimitive"}function Ba(i){return i===null?null:typeof i=="object"?""+i:i}function za(i,e){for(var t=i.next();!t.done;)e(t.value),t=i.next()}function La(){return typeof Symbol=="function"&&Symbol.iterator||"@@iterator"}function Qo(i,e){Hi(i,La(),e)}function ji(i){return i[La()]=ud,i}function en(){return typeof Symbol=="function"&&Symbol.toStringTag||"@@toStringTag"}function ud(){return this}var Fr=function(){function i(e){e===void 0&&(e="Atom@"+Ce()),this.name=e,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=N.NOT_TRACKING}return i.prototype.onBecomeUnobserved=function(){},i.prototype.onBecomeObserved=function(){},i.prototype.reportObserved=function(){return Ua(this)},i.prototype.reportChanged=function(){gt(),dd(this),bt()},i.prototype.toString=function(){return this.name},i}(),tn=Ot("Atom",Fr);function Ar(i,e,t){e===void 0&&(e=Pa),t===void 0&&(t=Pa);var r=new Fr(i);return pd(r,e),Na(r,t),r}function Ha(i,e){return i===e}function md(i,e){return rn(i,e)}function hd(i,e){return rn(i,e,1)}function fd(i,e){return cd(i,e)||Ha(i,e)}var Rr={identity:Ha,structural:md,default:fd,shallow:hd};var on=function(i,e){return on=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])},on(i,e)};function Wa(i,e){on(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var q=function(){return q=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},q.apply(this,arguments)};function nn(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var r=t.call(i),o,n=[],s;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)n.push(o.value)}catch(l){s={error:l}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return n}function sn(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(nn(arguments[e]));return i}var gd={},bd={};function yd(i,e){var t=e?gd:bd;return t[i]||(t[i]={configurable:!0,enumerable:e,get:function(){return Yt(this),this[i]},set:function(r){Yt(this),this[i]=r}})}function Yt(i){if(i.__mobxDidRunLazyInitializers!==!0){var e=i.__mobxDecorators;if(e){ht(i,"__mobxDidRunLazyInitializers",!0);for(var t in e){var r=e[t];r.propertyCreator(i,r.prop,r.descriptor,r.decoratorTarget,r.decoratorArguments)}}}}function ja(i,e){return function(){var r,o=function(s,l,c,p){if(p===!0)return e(s,l,c,s,r),null;if(!Object.prototype.hasOwnProperty.call(s,"__mobxDecorators")){var m=s.__mobxDecorators;ht(s,"__mobxDecorators",q({},m))}return s.__mobxDecorators[l]={prop:l,propertyCreator:e,descriptor:c,decoratorTarget:s,decoratorArguments:r},yd(l,i)};return vd(arguments)?(r=Ir,o.apply(null,arguments)):(r=Array.prototype.slice.call(arguments),o)}}function vd(i){return(i.length===2||i.length===3)&&typeof i[1]=="string"||i.length===4&&i[3]===!0}function Gi(i,e,t){return Or(i)?i:Array.isArray(i)?S.array(i,{name:t}):bi(i)?S.object(i,void 0,{name:t}):yi(i)?S.map(i,{name:t}):Wi(i)?S.set(i,{name:t}):i}function _d(i,e,t){return i==null||Jt(i)||Xt(i)||et(i)||Tt(i)?i:Array.isArray(i)?S.array(i,{name:t,deep:!1}):bi(i)?S.object(i,void 0,{name:t,deep:!1}):yi(i)?S.map(i,{name:t,deep:!1}):Wi(i)?S.set(i,{name:t,deep:!1}):V(!1)}function Tr(i){return i}function Sd(i,e,t){return rn(i,e)?e:i}function Pr(i){Rt(i);var e=ja(!0,function(r,o,n,s,l){var c=n?n.initializer?n.initializer.call(r):n.value:void 0;Dd(r,o,c,i)}),t=typeof process!="undefined"&&process.env&&!1?function(){return arguments.length<2?V("Incorrect decorator invocation. @observable decorator doesn't expect any arguments"):e.apply(null,arguments)}:e;return t.enhancer=i,t}var Ga={deep:!0,name:void 0,defaultDecorator:void 0},xd={deep:!1,name:void 0,defaultDecorator:void 0};Object.freeze(Ga);Object.freeze(xd);function vi(i){return i==null?Ga:typeof i=="string"?{name:i,deep:!0}:i}function Mr(i){return i.defaultDecorator?i.defaultDecorator.enhancer:i.deep===!1?Tr:Gi}var an=Pr(Gi),Cd=Pr(_d),Va=Pr(Tr),wd=Pr(Sd);function Ed(i,e,t){if(typeof arguments[1]=="string")return an.apply(null,arguments);if(Or(i))return i;var r=bi(i)?S.object(i,e,t):Array.isArray(i)?S.array(i,e):yi(i)?S.map(i,e):Wi(i)?S.set(i,e):i;if(r!==i)return r;V(!1)}var $a={box:function(i,e){arguments.length>2&&yt("box");var t=vi(e);return new Pt(i,Mr(t),t.name,!0,t.equals)},shallowBox:function(i,e){return arguments.length>2&&yt("shallowBox"),mt("observable.shallowBox","observable.box(value, { deep: false })"),S.box(i,{name:e,deep:!1})},array:function(i,e){arguments.length>2&&yt("array");var t=vi(e);return new tt(i,Mr(t),t.name)},shallowArray:function(i,e){return arguments.length>2&&yt("shallowArray"),mt("observable.shallowArray","observable.array(values, { deep: false })"),S.array(i,{name:e,deep:!1})},map:function(i,e){arguments.length>2&&yt("map");var t=vi(e);return new Br(i,Mr(t),t.name)},shallowMap:function(i,e){return arguments.length>2&&yt("shallowMap"),mt("observable.shallowMap","observable.map(values, { deep: false })"),S.map(i,{name:e,deep:!1})},set:function(i,e){arguments.length>2&&yt("set");var t=vi(e);return new zr(i,Mr(t),t.name)},object:function(i,e,t){typeof arguments[1]=="string"&&yt("object");var r=vi(t);return kd({},i,e,r)},shallowObject:function(i,e){return typeof arguments[1]=="string"&&yt("shallowObject"),mt("observable.shallowObject","observable.object(values, {}, { deep: false })"),S.object(i,{},{name:e,deep:!1})},ref:Va,shallow:Cd,deep:an,struct:wd},S=Ed;Object.keys($a).forEach(function(i){return S[i]=$a[i]});function yt(i){V("Expected one or two arguments to observable."+i+". Did you accidentally try to use observable."+i+" as decorator?")}var Lr=ja(!1,function(i,e,t,r,o){var n=t.get,s=t.set,l=o[0]||{};Id(i,e,q({get:n,set:s},l))}),Fd=Lr({equals:Rr.structural}),u=function(e,t,r){if(typeof t=="string"||e!==null&&typeof e=="object"&&arguments.length===1)return Lr.apply(null,arguments);var o=typeof t=="object"?t:{};return o.get=e,o.set=typeof t=="function"?t:o.set,o.name=o.name||e.name||"",new Mt(o)};u.struct=Fd;var N;(function(i){i[i.NOT_TRACKING=-1]="NOT_TRACKING",i[i.UP_TO_DATE=0]="UP_TO_DATE",i[i.POSSIBLY_STALE=1]="POSSIBLY_STALE",i[i.STALE=2]="STALE"})(N||(N={}));var He;(function(i){i[i.NONE=0]="NONE",i[i.LOG=1]="LOG",i[i.BREAK=2]="BREAK"})(He||(He={}));var Ur=function(){function i(e){this.cause=e}return i}();function Vi(i){return i instanceof Ur}function ln(i){switch(i.dependenciesState){case N.UP_TO_DATE:return!1;case N.NOT_TRACKING:case N.STALE:return!0;case N.POSSIBLY_STALE:{for(var e=Zt(!0),t=_i(),r=i.observing,o=r.length,n=0;n<o;n++){var s=r[n];if(Nr(s)){if(E.disableErrorBoundaries)s.get();else try{s.get()}catch(l){return Bt(t),vt(e),!0}if(i.dependenciesState===N.STALE)return Bt(t),vt(e),!0}}return Ka(i),Bt(t),vt(e),!1}}}function Si(i){var e=i.observers.length>0;E.computationDepth>0&&e&&V(!1),!E.allowStateChanges&&(e||E.enforceActions==="strict")&&V(!1)}function Ad(i){}function qa(i,e,t){var r=Zt(!0);Ka(i),i.newObserving=new Array(i.observing.length+100),i.unboundDepsCount=0,i.runId=++E.runId;var o=E.trackingDerivation;E.trackingDerivation=i;var n;if(E.disableErrorBoundaries===!0)n=e.call(t);else try{n=e.call(t)}catch(s){n=new Ur(s)}return E.trackingDerivation=o,Od(i),i.observing.length===0&&Rd(i),vt(r),n}function Rd(i){}function Od(i){for(var e=i.observing,t=i.observing=i.newObserving,r=N.UP_TO_DATE,o=0,n=i.unboundDepsCount,s=0;s<n;s++){var l=t[s];l.diffValue===0&&(l.diffValue=1,o!==s&&(t[o]=l),o++),l.dependenciesState>r&&(r=l.dependenciesState)}for(t.length=o,i.newObserving=null,n=e.length;n--;){var l=e[n];l.diffValue===0&&Ya(l,i),l.diffValue=0}for(;o--;){var l=t[o];l.diffValue===1&&(l.diffValue=0,Td(l,i))}r!==N.UP_TO_DATE&&(i.dependenciesState=r,i.onBecomeStale())}function cn(i){var e=i.observing;i.observing=[];for(var t=e.length;t--;)Ya(e[t],i);i.dependenciesState=N.NOT_TRACKING}function un(i){var e=_i(),t=i();return Bt(e),t}function _i(){var i=E.trackingDerivation;return E.trackingDerivation=null,i}function Bt(i){E.trackingDerivation=i}function Zt(i){var e=E.allowStateReads;return E.allowStateReads=i,e}function vt(i){E.allowStateReads=i}function Ka(i){if(i.dependenciesState!==N.UP_TO_DATE){i.dependenciesState=N.UP_TO_DATE;for(var e=i.observing,t=e.length;t--;)e[t].lowestObserverState=N.UP_TO_DATE}}var Hr=0,Pd=1,Xa=Object.getOwnPropertyDescriptor(function(){},"name"),db=Xa&&Xa.configurable;function Qt(i,e){var t=function(){return Ja(i,e,this,arguments)};return t.isMobxAction=!0,t}function Ja(i,e,t,r){var o=Md(i,t,r);try{return e.apply(t,r)}catch(n){throw o.error=n,n}finally{Bd(o)}}function Md(i,e,t){var r=ge()&&!!i,o=0;if(r){o=Date.now();var n=t&&t.length||0,s=new Array(n);if(n>0)for(var l=0;l<n;l++)s[l]=t[l];we({type:"action",name:i,object:e,arguments:s})}var c=_i();gt();var p=$i(!0),m=Zt(!0),h={prevDerivation:c,prevAllowStateChanges:p,prevAllowStateReads:m,notifySpy:r,startTime:o,actionId:Pd++,parentActionId:Hr};return Hr=h.actionId,h}function Bd(i){Hr!==i.actionId&&V("invalid action stack. did you forget to finish an action?"),Hr=i.parentActionId,i.error!==void 0&&(E.suppressReactionErrors=!0),Ki(i.prevAllowStateChanges),vt(i.prevAllowStateReads),bt(),Bt(i.prevDerivation),i.notifySpy&&Ee({time:Date.now()-i.startTime}),E.suppressReactionErrors=!1}function Za(i,e){var t=$i(i),r;try{r=e()}finally{Ki(t)}return r}function $i(i){var e=E.allowStateChanges;return E.allowStateChanges=i,e}function Ki(i){E.allowStateChanges=i}var Pt=function(i){Wa(e,i);function e(t,r,o,n,s){o===void 0&&(o="ObservableValue@"+Ce()),n===void 0&&(n=!0),s===void 0&&(s=Rr.default);var l=i.call(this,o)||this;return l.enhancer=r,l.name=o,l.equals=s,l.hasUnreportedChange=!1,l.value=r(t,void 0,o),n&&ge()&&ei({type:"create",name:l.name,newValue:""+l.value}),l}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.set=function(t){var r=this.value;if(t=this.prepareNewValue(t),t!==E.UNCHANGED){var o=ge();o&&we({type:"update",name:this.name,newValue:t,oldValue:r}),this.setNewValue(t),o&&Ee()}},e.prototype.prepareNewValue=function(t){if(Si(this),it(this)){var r=rt(this,{object:this,type:"update",newValue:t});if(!r)return E.UNCHANGED;t=r.newValue}return t=this.enhancer(t,this.value,this.name),this.equals(this.value,t)?E.UNCHANGED:t},e.prototype.setNewValue=function(t){var r=this.value;this.value=t,this.reportChanged(),We(this)&&je(this,{type:"update",object:this,newValue:t,oldValue:r})},e.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},e.prototype.intercept=function(t){return qi(this,t)},e.prototype.observe=function(t,r){return r&&t({object:this,type:"update",newValue:this.value,oldValue:void 0}),Yi(this,t)},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.value+"]"},e.prototype.valueOf=function(){return Ba(this.get())},e}(Fr);Pt.prototype[Ma()]=Pt.prototype.valueOf;var zd=Ot("ObservableValue",Pt),Mt=function(){function i(e){this.dependenciesState=N.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=N.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Ce(),this.value=new Ur(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=He.NONE,Rt(e.get,"missing option for computed: get"),this.derivation=e.get,this.name=e.name||"ComputedValue@"+Ce(),e.set&&(this.setter=Qt(this.name+"-setter",e.set)),this.equals=e.equals||(e.compareStructural||e.struct?Rr.structural:Rr.default),this.scope=e.context,this.requiresReaction=!!e.requiresReaction,this.keepAlive=!!e.keepAlive}return i.prototype.onBecomeStale=function(){Ud(this)},i.prototype.onBecomeUnobserved=function(){},i.prototype.onBecomeObserved=function(){},i.prototype.get=function(){this.isComputing&&V("Cycle detected in computation "+this.name+": "+this.derivation),E.inBatch===0&&this.observers.length===0&&!this.keepAlive?ln(this)&&(this.warnAboutUntrackedRead(),gt(),this.value=this.computeValue(!1),bt()):(Ua(this),ln(this)&&this.trackAndCompute()&&Ld(this));var e=this.value;if(Vi(e))throw e.cause;return e},i.prototype.peek=function(){var e=this.computeValue(!1);if(Vi(e))throw e.cause;return e},i.prototype.set=function(e){if(this.setter){Rt(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,e)}finally{this.isRunningSetter=!1}}else Rt(!1,!1)},i.prototype.trackAndCompute=function(){ge()&&ei({object:this.scope,type:"compute",name:this.name});var e=this.value,t=this.dependenciesState===N.NOT_TRACKING,r=this.computeValue(!0),o=t||Vi(e)||Vi(r)||!this.equals(e,r);return o&&(this.value=r),o},i.prototype.computeValue=function(e){this.isComputing=!0,E.computationDepth++;var t;if(e)t=qa(this,this.derivation,this.scope);else if(E.disableErrorBoundaries===!0)t=this.derivation.call(this.scope);else try{t=this.derivation.call(this.scope)}catch(r){t=new Ur(r)}return E.computationDepth--,this.isComputing=!1,t},i.prototype.suspend=function(){this.keepAlive||(cn(this),this.value=void 0)},i.prototype.observe=function(e,t){var r=this,o=!0,n=void 0;return Nd(function(){var s=r.get();if(!o||t){var l=_i();e({type:"update",object:r,newValue:s,oldValue:n}),Bt(l)}o=!1,n=s})},i.prototype.warnAboutUntrackedRead=function(){},i.prototype.toJSON=function(){return this.get()},i.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},i.prototype.valueOf=function(){return Ba(this.get())},i}();Mt.prototype[Ma()]=Mt.prototype.valueOf;var Nr=Ot("ComputedValue",Mt);var Wr=function(){function i(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return i}(),jr=!0,Qa=!1,E=function(){var i=gi();return i.__mobxInstanceCount>0&&!i.__mobxGlobals&&(jr=!1),i.__mobxGlobals&&i.__mobxGlobals.version!==new Wr().version&&(jr=!1),jr?i.__mobxGlobals?(i.__mobxInstanceCount+=1,i.__mobxGlobals.UNCHANGED||(i.__mobxGlobals.UNCHANGED={}),i.__mobxGlobals):(i.__mobxInstanceCount=1,i.__mobxGlobals=new Wr):(setTimeout(function(){Qa||V("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new Wr)}();function Hd(){(E.pendingReactions.length||E.inBatch||E.isRunningReactions)&&V("isolateGlobalState should be called before MobX is running any reactions"),Qa=!0,jr&&(--gi().__mobxInstanceCount==0&&(gi().__mobxGlobals=void 0),E=new Wr)}function Td(i,e){var t=i.observers.length;t&&(i.observersIndexes[e.__mapid]=t),i.observers[t]=e,i.lowestObserverState>e.dependenciesState&&(i.lowestObserverState=e.dependenciesState)}function Ya(i,e){if(i.observers.length===1)i.observers.length=0,el(i);else{var t=i.observers,r=i.observersIndexes,o=t.pop();if(o!==e){var n=r[e.__mapid]||0;n?r[o.__mapid]=n:delete r[o.__mapid],t[n]=o}delete r[e.__mapid]}}function el(i){i.isPendingUnobservation===!1&&(i.isPendingUnobservation=!0,E.pendingUnobservations.push(i))}function gt(){E.inBatch++}function bt(){if(--E.inBatch==0){tl();for(var i=E.pendingUnobservations,e=0;e<i.length;e++){var t=i[e];t.isPendingUnobservation=!1,t.observers.length===0&&(t.isBeingObserved&&(t.isBeingObserved=!1,t.onBecomeUnobserved()),t instanceof Mt&&t.suspend())}E.pendingUnobservations=[]}}function Ua(i){Ad(i);var e=E.trackingDerivation;return e!==null?(e.runId!==i.lastAccessedBy&&(i.lastAccessedBy=e.runId,e.newObserving[e.unboundDepsCount++]=i,i.isBeingObserved||(i.isBeingObserved=!0,i.onBecomeObserved())),!0):(i.observers.length===0&&E.inBatch>0&&el(i),!1)}function dd(i){if(i.lowestObserverState!==N.STALE){i.lowestObserverState=N.STALE;for(var e=i.observers,t=e.length;t--;){var r=e[t];r.dependenciesState===N.UP_TO_DATE&&(r.isTracing!==He.NONE&&il(r,i),r.onBecomeStale()),r.dependenciesState=N.STALE}}}function Ld(i){if(i.lowestObserverState!==N.STALE){i.lowestObserverState=N.STALE;for(var e=i.observers,t=e.length;t--;){var r=e[t];r.dependenciesState===N.POSSIBLY_STALE?r.dependenciesState=N.STALE:r.dependenciesState===N.UP_TO_DATE&&(i.lowestObserverState=N.UP_TO_DATE)}}}function Ud(i){if(i.lowestObserverState===N.UP_TO_DATE){i.lowestObserverState=N.POSSIBLY_STALE;for(var e=i.observers,t=e.length;t--;){var r=e[t];r.dependenciesState===N.UP_TO_DATE&&(r.dependenciesState=N.POSSIBLY_STALE,r.isTracing!==He.NONE&&il(r,i),r.onBecomeStale())}}}function il(i,e){if(console.log("[mobx.trace] '"+i.name+"' is invalidated due to a change in: '"+e.name+"'"),i.isTracing===He.BREAK){var t=[];rl(dn(i),t,1),new Function(`debugger;
/*
Tracing '`+i.name+`'

You are entering this break point because derivation '`+i.name+"' is being traced and '"+e.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(i instanceof Mt?i.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+t.join(`
`)+`
*/
    `)()}}function rl(i,e,t){if(e.length>=1e3){e.push("(and many more)");return}e.push(""+new Array(t).join("	")+i.name),i.dependencies&&i.dependencies.forEach(function(r){return rl(r,e,t+1)})}var zt=function(){function i(e,t,r,o){e===void 0&&(e="Reaction@"+Ce()),o===void 0&&(o=!1),this.name=e,this.onInvalidate=t,this.errorHandler=r,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=N.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Ce(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=He.NONE}return i.prototype.onBecomeStale=function(){this.schedule()},i.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,E.pendingReactions.push(this),tl())},i.prototype.isScheduled=function(){return this._isScheduled},i.prototype.runReaction=function(){if(!this.isDisposed){if(gt(),this._isScheduled=!1,ln(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&ge()&&ei({name:this.name,type:"scheduled-reaction"})}catch(e){this.reportExceptionInDerivation(e)}}bt()}},i.prototype.track=function(e){gt();var t=ge(),r;t&&(r=Date.now(),we({name:this.name,type:"reaction"})),this._isRunning=!0;var o=qa(this,e,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&cn(this),Vi(o)&&this.reportExceptionInDerivation(o.cause),t&&Ee({time:Date.now()-r}),bt()},i.prototype.reportExceptionInDerivation=function(e){var t=this;if(this.errorHandler){this.errorHandler(e,this);return}if(E.disableErrorBoundaries)throw e;var r="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";E.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(r,e),ge()&&ei({type:"error",name:this.name,message:r,error:""+e}),E.globalReactionErrorHandlers.forEach(function(o){return o(e,t)})},i.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(gt(),cn(this),bt()))},i.prototype.getDisposer=function(){var e=this.dispose.bind(this);return e.$mobx=this,e},i.prototype.toString=function(){return"Reaction["+this.name+"]"},i.prototype.trace=function(e){e===void 0&&(e=!1),Wd(this,e)},i}();var ol=100,pn=function(i){return i()};function tl(){E.inBatch>0||E.isRunningReactions||pn(jd)}function jd(){E.isRunningReactions=!0;for(var i=E.pendingReactions,e=0;i.length>0;){++e===ol&&(console.error("Reaction doesn't converge to a stable state after "+ol+" iterations."+(" Probably there is a cycle in the reactive function: "+i[0])),i.splice(0));for(var t=i.splice(0),r=0,o=t.length;r<o;r++)t[r].runReaction()}E.isRunningReactions=!1}var Gr=Ot("Reaction",zt);function Gd(i){var e=pn;pn=function(t){return i(function(){return e(t)})}}function ge(){return!!E.spyListeners.length}function ei(i){if(!!E.spyListeners.length)for(var e=E.spyListeners,t=0,r=e.length;t<r;t++)e[t](i)}function we(i){var e=q(q({},i),{spyReportStart:!0});ei(e)}var Vd={spyReportEnd:!0};function Ee(i){ei(i?q(q({},i),{spyReportEnd:!0}):Vd)}function mn(i){return E.spyListeners.push(i),Jo(function(){E.spyListeners=E.spyListeners.filter(function(e){return e!==i})})}function $d(){V(!1)}function nl(i){return function(e,t,r){if(r){if(r.value)return{value:Qt(i,r.value),enumerable:!1,configurable:!0,writable:!0};var o=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return Qt(i,o.call(this))}}}return Kd(i).apply(this,arguments)}}function Kd(i){return function(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:function(){},set:function(o){ht(this,t,d(i,o))}})}}function qd(i,e,t,r){return r===!0?(hn(i,e,t.value),null):t?{configurable:!0,enumerable:!1,get:function(){return hn(this,e,t.value||t.initializer.call(this)),this[e]},set:$d}:{enumerable:!1,configurable:!0,set:function(o){hn(this,e,o)},get:function(){}}}var d=function(e,t,r,o){if(arguments.length===1&&typeof e=="function")return Qt(e.name||"<unnamed action>",e);if(arguments.length===2&&typeof t=="function")return Qt(e,t);if(arguments.length===1&&typeof e=="string")return nl(e);if(o===!0)e[t]=Qt(e.name||t,r.value);else return nl(t).apply(null,arguments)};d.bound=qd;function re(i,e){var t=typeof i=="string"?i:i.name||"<unnamed action>",r=typeof i=="function"?i:e;return Ja(t,r,this,void 0)}function hn(i,e,t){ht(i,e,Qt(e,t.bind(i)))}function Nd(i,e){e===void 0&&(e=Oa);var t=e&&e.name||i.name||"Autorun@"+Ce(),r=!e.scheduler&&!e.delay,o;if(r)o=new zt(t,function(){this.track(l)},e.onError,e.requiresObservable);else{var n=Yd(e),s=!1;o=new zt(t,function(){s||(s=!0,n(function(){s=!1,o.isDisposed||o.track(l)}))},e.onError,e.requiresObservable)}function l(){i(o)}return o.schedule(),o.getDisposer()}var Xd=function(i){return i()};function Yd(i){return i.scheduler?i.scheduler:i.delay?function(e){return setTimeout(e,i.delay)}:Xd}function pd(i,e,t){return sl("onBecomeObserved",i,e,t)}function Na(i,e,t){return sl("onBecomeUnobserved",i,e,t)}function sl(i,e,t,r){var o=typeof r=="function"?Lt(e,t):Lt(e),n=typeof r=="function"?r:t,s=o[i];return typeof s!="function"?V(!1):(o[i]=function(){s.call(this),n.call(this)},function(){o[i]=s})}function al(i){var e=i.enforceActions,t=i.computedRequiresReaction,r=i.computedConfigurable,o=i.disableErrorBoundaries,n=i.arrayBuffer,s=i.reactionScheduler,l=i.reactionRequiresObservable,c=i.observableRequiresReaction;if(i.isolateGlobalState===!0&&Hd(),e!==void 0){(typeof e=="boolean"||e==="strict")&&mt(`Deprecated value for 'enforceActions', use 'false' => '"never"', 'true' => '"observed"', '"strict"' => "'always'" instead`);var p=void 0;switch(e){case!0:case"observed":p=!0;break;case!1:case"never":p=!1;break;case"strict":case"always":p="strict";break;default:V("Invalid value for 'enforceActions': '"+e+"', expected 'never', 'always' or 'observed'")}E.enforceActions=p,E.allowStateChanges=!(p===!0||p==="strict")}t!==void 0&&(E.computedRequiresReaction=!!t),l!==void 0&&(E.reactionRequiresObservable=!!l),c!==void 0&&(E.observableRequiresReaction=!!c,E.allowStateReads=!E.observableRequiresReaction),r!==void 0&&(E.computedConfigurable=!!r),o!==void 0&&(o===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),E.disableErrorBoundaries=!!o),typeof n=="number"&&fn(n),s&&Gd(s)}function kd(i,e,t,r){if(!1&&t)for(var o in t);r=vi(r);var n=r.defaultDecorator||(r.deep===!1?Va:an);Yt(i),gn(i,r.name,n.enhancer),gt();try{for(var s=Object.getOwnPropertyNames(e),l=0,c=s.length;l<c;l++){var o=s[l],p=Object.getOwnPropertyDescriptor(e,o),m=t&&o in t?t[o]:p.get?Lr:n,h=m(i,o,p,!0);h&&Object.defineProperty(i,o,h)}}finally{bt()}return i}function dn(i,e){return ll(Lt(i,e))}function ll(i){var e={name:i.name};return i.observing&&i.observing.length>0&&(e.dependencies=nd(i.observing).map(ll)),e}function Jd(){this.message="FLOW_CANCELLED"}Jd.prototype=Object.create(Error.prototype);function Zd(i,e){if(i==null)return!1;if(e!==void 0){if(Jt(i)){var t=i.$mobx;return t.values&&!!t.values[e]}return!1}return Jt(i)||!!i.$mobx||tn(i)||Gr(i)||Nr(i)}function Or(i){return arguments.length!==1&&V(!1),Zd(i)}function Qd(i){return Jt(i)?i.$mobx.getKeys():et(i)||Tt(i)?ft(i.keys()):Xt(i)?i.map(function(e,t){return t}):V(!1)}var ep={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function Di(i,e,t,r){return r.detectCycles&&i.set(e,t),t}function Ut(i,e,t){if(!e.recurseEverything&&!Or(i)||typeof i!="object")return i;if(i===null)return null;if(i instanceof Date)return i;if(zd(i))return Ut(i.get(),e,t);Or(i)&&Qd(i);var r=e.detectCycles===!0;if(r&&i!==null&&t.has(i))return t.get(i);if(Xt(i)||Array.isArray(i)){var o=Di(t,i,[],e),n=i.map(function(x){return Ut(x,e,t)});o.length=n.length;for(var s=0,l=n.length;s<l;s++)o[s]=n[s];return o}if(Tt(i)||Object.getPrototypeOf(i)===Set.prototype)if(e.exportMapsAsObjects===!1){var c=Di(t,i,new Set,e);return i.forEach(function(x){c.add(Ut(x,e,t))}),c}else{var p=Di(t,i,[],e);return i.forEach(function(x){p.push(Ut(x,e,t))}),p}if(et(i)||Object.getPrototypeOf(i)===Map.prototype)if(e.exportMapsAsObjects===!1){var m=Di(t,i,new Map,e);return i.forEach(function(x,I){m.set(I,Ut(x,e,t))}),m}else{var h=Di(t,i,{},e);return i.forEach(function(x,I){h[I]=Ut(x,e,t)}),h}var b=Di(t,i,{},e);for(var v in i)b[v]=Ut(i[v],e,t);return b}function k(i,e){typeof e=="boolean"&&(e={detectCycles:e}),e||(e=ep),e.detectCycles=e.detectCycles===void 0?e.recurseEverything===!0:e.detectCycles===!0;var t;return e.detectCycles&&(t=new Map),Ut(i,e,t)}function Wd(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var t=!1;typeof i[i.length-1]=="boolean"&&(t=i.pop());var r=tp(i);if(!r)return V(!1);r.isTracing===He.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled"),r.isTracing=t?He.BREAK:He.LOG}function tp(i){switch(i.length){case 0:return E.trackingDerivation;case 1:return Lt(i[0]);case 2:return Lt(i[0],i[1])}}function ot(i,e){e===void 0&&(e=void 0),gt();try{return i.apply(e)}finally{bt()}}function it(i){return i.interceptors!==void 0&&i.interceptors.length>0}function qi(i,e){var t=i.interceptors||(i.interceptors=[]);return t.push(e),Jo(function(){var r=t.indexOf(e);r!==-1&&t.splice(r,1)})}function rt(i,e){var t=_i();try{var r=i.interceptors;if(r)for(var o=0,n=r.length;o<n&&(e=r[o](e),Rt(!e||e.type,"Intercept handlers should return nothing or a change object"),!!e);o++);return e}finally{Bt(t)}}function We(i){return i.changeListeners!==void 0&&i.changeListeners.length>0}function Yi(i,e){var t=i.changeListeners||(i.changeListeners=[]);return t.push(e),Jo(function(){var r=t.indexOf(e);r!==-1&&t.splice(r,1)})}function je(i,e){var t=_i(),r=i.changeListeners;if(!!r){r=r.slice();for(var o=0,n=r.length;o<n;o++)r[o](e);Bt(t)}}var ip=1e4,rp=function(){var i=!1,e={};return Object.defineProperty(e,"0",{set:function(){i=!0}}),Object.create(e)["0"]=1,i===!1}(),bn=0,yn=function(){function i(){}return i}();function op(i,e){typeof Object.setPrototypeOf!="undefined"?Object.setPrototypeOf(i.prototype,e):typeof i.prototype.__proto__!="undefined"?i.prototype.__proto__=e:i.prototype=e}op(yn,Array.prototype);Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(i){Object.defineProperty(yn.prototype,i,{configurable:!0,writable:!0,value:Array.prototype[i]})});var cl=function(){function i(e,t,r,o){this.array=r,this.owned=o,this.values=[],this.lastKnownLength=0,this.atom=new Fr(e||"ObservableArray@"+Ce()),this.enhancer=function(n,s){return t(n,s,e+"[..]")}}return i.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},i.prototype.dehanceValues=function(e){return this.dehancer!==void 0&&e.length>0?e.map(this.dehancer):e},i.prototype.intercept=function(e){return qi(this,e)},i.prototype.observe=function(e,t){return t===void 0&&(t=!1),t&&e({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),Yi(this,e)},i.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},i.prototype.setArrayLength=function(e){if(typeof e!="number"||e<0)throw new Error("[mobx.array] Out of range: "+e);var t=this.values.length;if(e!==t)if(e>t){for(var r=new Array(e-t),o=0;o<e-t;o++)r[o]=void 0;this.spliceWithArray(t,0,r)}else this.spliceWithArray(e,t-e)},i.prototype.updateArrayLength=function(e,t){if(e!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=t,t>0&&e+t+1>bn&&fn(e+t+1)},i.prototype.spliceWithArray=function(e,t,r){var o=this;Si(this.atom);var n=this.values.length;if(e===void 0?e=0:e>n?e=n:e<0&&(e=Math.max(0,n+e)),arguments.length===1?t=n-e:t==null?t=0:t=Math.max(0,Math.min(t,n-e)),r===void 0&&(r=Ir),it(this)){var s=rt(this,{object:this.array,type:"splice",index:e,removedCount:t,added:r});if(!s)return Ir;t=s.removedCount,r=s.added}r=r.length===0?r:r.map(function(p){return o.enhancer(p,void 0)});var l=r.length-t;this.updateArrayLength(n,l);var c=this.spliceItemsIntoValues(e,t,r);return(t!==0||r.length!==0)&&this.notifyArraySplice(e,r,c),this.dehanceValues(c)},i.prototype.spliceItemsIntoValues=function(e,t,r){var o;if(r.length<ip)return(o=this.values).splice.apply(o,sn([e,t],r));var n=this.values.slice(e,e+t);return this.values=this.values.slice(0,e).concat(r,this.values.slice(e+t)),n},i.prototype.notifyArrayChildUpdate=function(e,t,r){var o=!this.owned&&ge(),n=We(this),s=n||o?{object:this.array,type:"update",index:e,newValue:t,oldValue:r}:null;o&&we(q(q({},s),{name:this.atom.name})),this.atom.reportChanged(),n&&je(this,s),o&&Ee()},i.prototype.notifyArraySplice=function(e,t,r){var o=!this.owned&&ge(),n=We(this),s=n||o?{object:this.array,type:"splice",index:e,removed:r,added:t,removedCount:r.length,addedCount:t.length}:null;o&&we(q(q({},s),{name:this.atom.name})),this.atom.reportChanged(),n&&je(this,s),o&&Ee()},i}(),tt=function(i){Wa(e,i);function e(t,r,o,n){o===void 0&&(o="ObservableArray@"+Ce()),n===void 0&&(n=!1);var s=i.call(this)||this,l=new cl(o,r,s,n);if(Hi(s,"$mobx",l),t&&t.length){var c=$i(!0);s.spliceWithArray(0,0,t),Ki(c)}return rp&&Object.defineProperty(l.array,"0",np),s}return e.prototype.intercept=function(t){return this.$mobx.intercept(t)},e.prototype.observe=function(t,r){return r===void 0&&(r=!1),this.$mobx.observe(t,r)},e.prototype.clear=function(){return this.splice(0)},e.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),t.map(function(o){return Xt(o)?o.peek():o}))},e.prototype.replace=function(t){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,t)},e.prototype.toJS=function(){return this.slice()},e.prototype.toJSON=function(){return this.toJS()},e.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},e.prototype.find=function(t,r,o){o===void 0&&(o=0),arguments.length===3&&mt("The array.find fromIndex argument to find will not be supported anymore in the next major");var n=this.findIndex.apply(this,arguments);return n===-1?void 0:this.get(n)},e.prototype.findIndex=function(t,r,o){o===void 0&&(o=0),arguments.length===3&&mt("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");for(var n=this.peek(),s=n.length,l=o;l<s;l++)if(t.call(r,n[l],l,this))return l;return-1},e.prototype.splice=function(t,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(t);case 2:return this.$mobx.spliceWithArray(t,r)}return this.$mobx.spliceWithArray(t,r,o)},e.prototype.spliceWithArray=function(t,r,o){return this.$mobx.spliceWithArray(t,r,o)},e.prototype.push=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(o.values.length,0,t),o.values.length},e.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},e.prototype.shift=function(){return this.splice(0,1)[0]},e.prototype.unshift=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(0,0,t),o.values.length},e.prototype.reverse=function(){var t=this.slice();return t.reverse.apply(t,arguments)},e.prototype.sort=function(t){var r=this.slice();return r.sort.apply(r,arguments)},e.prototype.remove=function(t){var r=this.$mobx.dehanceValues(this.$mobx.values).indexOf(t);return r>-1?(this.splice(r,1),!0):!1},e.prototype.move=function(t,r){mt("observableArray.move is deprecated, use .slice() & .replace() instead");function o(l){if(l<0)throw new Error("[mobx.array] Index out of bounds: "+l+" is negative");var c=this.$mobx.values.length;if(l>=c)throw new Error("[mobx.array] Index out of bounds: "+l+" is not smaller than "+c)}if(o.call(this,t),o.call(this,r),t!==r){var n=this.$mobx.values,s;t<r?s=sn(n.slice(0,t),n.slice(t+1,r+1),[n[t]],n.slice(r+1)):s=sn(n.slice(0,r),[n[t]],n.slice(r,t),n.slice(t+1)),this.replace(s)}},e.prototype.get=function(t){var r=this.$mobx;if(r){if(t<r.values.length)return r.atom.reportObserved(),r.dehanceValue(r.values[t]);console.warn("[mobx.array] Attempt to read an array index ("+t+") that is out of bounds ("+r.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},e.prototype.set=function(t,r){var o=this.$mobx,n=o.values;if(t<n.length){Si(o.atom);var s=n[t];if(it(o)){var l=rt(o,{type:"update",object:this,index:t,newValue:r});if(!l)return;r=l.newValue}r=o.enhancer(r,s);var c=r!==s;c&&(n[t]=r,o.notifyArrayChildUpdate(t,r,s))}else if(t===n.length)o.spliceWithArray(t,0,[r]);else throw new Error("[mobx.array] Index out of bounds, "+t+" is larger than "+n.length)},e}(yn);Qo(tt.prototype,function(){this.$mobx.atom.reportObserved();var i=this,e=0;return ji({next:function(){return e<i.length?{value:i[e++],done:!1}:{done:!0,value:void 0}}})});Object.defineProperty(tt.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(i){this.$mobx.setArrayLength(i)}});ht(tt.prototype,en(),"Array");["indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(i){var e=Array.prototype[i];Rt(typeof e=="function","Base function not defined on Array prototype: '"+i+"'"),ht(tt.prototype,i,function(){return e.apply(this.peek(),arguments)})});["every","filter","forEach","map","some"].forEach(function(i){var e=Array.prototype[i];Rt(typeof e=="function","Base function not defined on Array prototype: '"+i+"'"),ht(tt.prototype,i,function(t,r){var o=this,n=this.$mobx;n.atom.reportObserved();var s=n.dehanceValues(n.values);return s[i](function(l,c){return t.call(r,l,c,o)},r)})});["reduce","reduceRight"].forEach(function(i){ht(tt.prototype,i,function(){var e=this,t=this.$mobx;t.atom.reportObserved();var r=arguments[0];return arguments[0]=function(o,n,s){return n=t.dehanceValue(n),r(o,n,s,e)},t.values[i].apply(t.values,arguments)})});ad(tt.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var np=ul(0);function ul(i){return{enumerable:!1,configurable:!1,get:function(){return this.get(i)},set:function(e){this.set(i,e)}}}function sp(i){Object.defineProperty(tt.prototype,""+i,ul(i))}function fn(i){for(var e=bn;e<i;e++)sp(e);bn=i}fn(1e3);var ap=Ot("ObservableArrayAdministration",cl);function Xt(i){return Zo(i)&&ap(i.$mobx)}var lp={},Br=function(){function i(e,t,r){if(t===void 0&&(t=Gi),r===void 0&&(r="ObservableMap@"+Ce()),this.enhancer=t,this.name=r,this.$mobx=lp,this._keysAtom=Ar(this.name+".keys()"),typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(e)}return i.prototype._has=function(e){return this._data.has(e)},i.prototype.has=function(e){var t=this;if(!E.trackingDerivation)return this._has(e);var r=this._hasMap.get(e);if(!r){var o=r=new Pt(this._has(e),Tr,this.name+"."+Vr(e)+"?",!1);this._hasMap.set(e,o),Na(o,function(){return t._hasMap.delete(e)})}return r.get()},i.prototype.set=function(e,t){var r=this._has(e);if(it(this)){var o=rt(this,{type:r?"update":"add",object:this,newValue:t,name:e});if(!o)return this;t=o.newValue}return r?this._updateValue(e,t):this._addValue(e,t),this},i.prototype.delete=function(e){var t=this;if(Si(this._keysAtom),it(this)){var r=rt(this,{type:"delete",object:this,name:e});if(!r)return!1}if(this._has(e)){var o=ge(),n=We(this),r=n||o?{type:"delete",object:this,oldValue:this._data.get(e).value,name:e}:null;return o&&we(q(q({},r),{name:this.name,key:e})),ot(function(){t._keysAtom.reportChanged(),t._updateHasMapEntry(e,!1);var l=t._data.get(e);l.setNewValue(void 0),t._data.delete(e)}),n&&je(this,r),o&&Ee(),!0}return!1},i.prototype._updateHasMapEntry=function(e,t){var r=this._hasMap.get(e);r&&r.setNewValue(t)},i.prototype._updateValue=function(e,t){var r=this._data.get(e);if(t=r.prepareNewValue(t),t!==E.UNCHANGED){var o=ge(),n=We(this),s=n||o?{type:"update",object:this,oldValue:r.value,name:e,newValue:t}:null;o&&we(q(q({},s),{name:this.name,key:e})),r.setNewValue(t),n&&je(this,s),o&&Ee()}},i.prototype._addValue=function(e,t){var r=this;Si(this._keysAtom),ot(function(){var l=new Pt(t,r.enhancer,r.name+"."+Vr(e),!1);r._data.set(e,l),t=l.value,r._updateHasMapEntry(e,!0),r._keysAtom.reportChanged()});var o=ge(),n=We(this),s=n||o?{type:"add",object:this,name:e,newValue:t}:null;o&&we(q(q({},s),{name:this.name,key:e})),n&&je(this,s),o&&Ee()},i.prototype.get=function(e){return this.has(e)?this.dehanceValue(this._data.get(e).get()):this.dehanceValue(void 0)},i.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},i.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},i.prototype.values=function(){var e=this,t=this.keys();return ji({next:function(){var r=t.next(),o=r.done,n=r.value;return{done:o,value:o?void 0:e.get(n)}}})},i.prototype.entries=function(){var e=this,t=this.keys();return ji({next:function(){var r=t.next(),o=r.done,n=r.value;return{done:o,value:o?void 0:[n,e.get(n)]}}})},i.prototype.forEach=function(e,t){var r=this;this._keysAtom.reportObserved(),this._data.forEach(function(o,n){return e.call(t,r.get(n),n,r)})},i.prototype.merge=function(e){var t=this;return et(e)&&(e=e.toJS()),ot(function(){var r=$i(!0);try{bi(e)?Object.keys(e).forEach(function(o){return t.set(o,e[o])}):Array.isArray(e)?e.forEach(function(o){var n=nn(o,2),s=n[0],l=n[1];return t.set(s,l)}):yi(e)?e.constructor!==Map?V("Cannot initialize from classes that inherit from Map: "+e.constructor.name):e.forEach(function(o,n){return t.set(n,o)}):e!=null&&V("Cannot initialize map from "+e)}finally{Ki(r)}}),this},i.prototype.clear=function(){var e=this;ot(function(){un(function(){e._data.forEach(function(t,r){return e.delete(r)})})})},i.prototype.replace=function(e){var t=this;return ot(function(){var r=sd(e),o=new Map,n=!1;if(za(t._data.keys(),function(m){if(!r.has(m)){var h=t.delete(m);if(h)n=!0;else{var b=t._data.get(m);o.set(m,b)}}}),za(r.entries(),function(m){var h=nn(m,2),b=h[0],v=h[1],x=t._data.has(b);if(t.set(b,v),t._data.has(b)){var I=t._data.get(b);o.set(b,I),x||(n=!0)}}),!n)if(t._data.size!==o.size)t._keysAtom.reportChanged();else for(var s=t._data.keys(),l=o.keys(),c=s.next(),p=l.next();!c.done;){if(c.value!==p.value){t._keysAtom.reportChanged();break}c=s.next(),p=l.next()}t._data=o}),this},Object.defineProperty(i.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),i.prototype.toPOJO=function(){var e=this,t={};return this.forEach(function(r,o){return t[typeof o=="symbol"?o:Vr(o)]=e.get(o)}),t},i.prototype.toJS=function(){return new Map(this)},i.prototype.toJSON=function(){return this.toPOJO()},i.prototype.toString=function(){var e=this;return this.name+"[{ "+ft(this.keys()).map(function(t){return Vr(t)+": "+(""+e.get(t))}).join(", ")+" }]"},i.prototype.observe=function(e,t){return Yi(this,e)},i.prototype.intercept=function(e){return qi(this,e)},i}();function Vr(i){return i&&i.toString?i.toString():new String(i).toString()}Qo(Br.prototype,function(){return this.entries()});Hi(Br.prototype,en(),"Map");var et=Ot("ObservableMap",Br),cp={},zr=function(){function i(e,t,r){if(t===void 0&&(t=Gi),r===void 0&&(r="ObservableSet@"+Ce()),this.name=r,this.$mobx=cp,this._data=new Set,this._atom=Ar(this.name),typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(o,n){return t(o,n,r)},e&&this.replace(e)}return i.prototype.dehanceValue=function(e){return this.dehancer!==void 0?this.dehancer(e):e},i.prototype.clear=function(){var e=this;ot(function(){un(function(){e._data.forEach(function(t){e.delete(t)})})})},i.prototype.forEach=function(e,t){var r=this;this._atom.reportObserved(),this._data.forEach(function(o){e.call(t,o,o,r)})},Object.defineProperty(i.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),i.prototype.add=function(e){var t=this;if(Si(this._atom),it(this)){var r=rt(this,{type:"add",object:this,newValue:e});if(!r)return this}if(!this.has(e)){ot(function(){t._data.add(t.enhancer(e,void 0)),t._atom.reportChanged()});var o=ge(),n=We(this),r=n||o?{type:"add",object:this,newValue:e}:null;o&&!1&&we(r),n&&je(this,r),o&&!1&&Ee()}return this},i.prototype.delete=function(e){var t=this;if(it(this)){var r=rt(this,{type:"delete",object:this,oldValue:e});if(!r)return!1}if(this.has(e)){var o=ge(),n=We(this),r=n||o?{type:"delete",object:this,oldValue:e}:null;return o&&!1&&we(q(q({},r),{name:this.name})),ot(function(){t._atom.reportChanged(),t._data.delete(e)}),n&&je(this,r),o&&!1&&Ee(),!0}return!1},i.prototype.has=function(e){return this._atom.reportObserved(),this._data.has(this.dehanceValue(e))},i.prototype.entries=function(){var e=0,t=ft(this.keys()),r=ft(this.values());return ji({next:function(){var o=e;return e+=1,o<r.length?{value:[t[o],r[o]],done:!1}:{done:!0}}})},i.prototype.keys=function(){return this.values()},i.prototype.values=function(){this._atom.reportObserved();var e=this,t=0,r;return this._data.values!==void 0?r=ft(this._data.values()):(r=[],this._data.forEach(function(o){return r.push(o)})),ji({next:function(){return t<r.length?{value:e.dehanceValue(r[t++]),done:!1}:{done:!0}}})},i.prototype.replace=function(e){var t=this;return Tt(e)&&(e=e.toJS()),ot(function(){var r=$i(!0);try{Array.isArray(e)?(t.clear(),e.forEach(function(o){return t.add(o)})):Wi(e)?(t.clear(),e.forEach(function(o){return t.add(o)})):e!=null&&V("Cannot initialize set from "+e)}finally{Ki(r)}}),this},i.prototype.observe=function(e,t){return Yi(this,e)},i.prototype.intercept=function(e){return qi(this,e)},i.prototype.toJS=function(){return new Set(this)},i.prototype.toString=function(){return this.name+"[ "+ft(this.keys()).join(", ")+" ]"},i}();Qo(zr.prototype,function(){return this.values()});Hi(zr.prototype,en(),"Set");var Tt=Ot("ObservableSet",zr),dl=function(){function i(e,t,r){this.target=e,this.name=t,this.defaultEnhancer=r,this.values={}}return i.prototype.read=function(e,t){if(!(this.target!==e&&(this.illegalAccess(e,t),!this.values[t])))return this.values[t].get()},i.prototype.write=function(e,t,r){var o=this.target;o!==e&&this.illegalAccess(e,t);var n=this.values[t];if(n instanceof Mt){n.set(r);return}if(it(this)){var s=rt(this,{type:"update",object:o,name:t,newValue:r});if(!s)return;r=s.newValue}if(r=n.prepareNewValue(r),r!==E.UNCHANGED){var l=We(this),c=ge(),s=l||c?{type:"update",object:o,oldValue:n.value,name:t,newValue:r}:null;c&&we(q(q({},s),{name:this.name,key:t})),n.setNewValue(r),l&&je(this,s),c&&Ee()}},i.prototype.remove=function(e){if(!!this.values[e]){var t=this.target;if(it(this)){var r=rt(this,{object:t,name:e,type:"remove"});if(!r)return}try{gt();var o=We(this),n=ge(),s=this.values[e].get();this.keys&&this.keys.remove(e),delete this.values[e],delete this.target[e];var r=o||n?{type:"remove",object:t,oldValue:s,name:e}:null;n&&we(q(q({},r),{name:this.name,key:e})),o&&je(this,r),n&&Ee()}finally{bt()}}},i.prototype.illegalAccess=function(e,t){console.warn("Property '"+t+"' of '"+e+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},i.prototype.observe=function(e,t){return Yi(this,e)},i.prototype.intercept=function(e){return qi(this,e)},i.prototype.getKeys=function(){var e=this;return this.keys===void 0&&(this.keys=new tt(Object.keys(this.values).filter(function(t){return e.values[t]instanceof Pt}),Tr,"keys("+this.name+")",!0)),this.keys.slice()},i}();function gn(i,e,t){e===void 0&&(e=""),t===void 0&&(t=Gi);var r=i.$mobx;return r||(bi(i)||(e=(i.constructor.name||"ObservableObject")+"@"+Ce()),e||(e="ObservableObject@"+Ce()),r=new dl(i,e,t),Hi(i,"$mobx",r),r)}function Dd(i,e,t,r){var o=gn(i);if(ld(i,e),it(o)){var n=rt(o,{object:i,name:e,type:"add",newValue:t});if(!n)return;t=n.newValue}var s=o.values[e]=new Pt(t,r,o.name+"."+e,!1);t=s.value,Object.defineProperty(i,e,up(e)),o.keys&&o.keys.push(e),dp(o,i,e,t)}function Id(i,e,t){var r=gn(i);t.name=r.name+"."+e,t.context=i,r.values[e]=new Mt(t),Object.defineProperty(i,e,pp(e))}var pl=Object.create(null),ml=Object.create(null);function up(i){return pl[i]||(pl[i]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,i)},set:function(e){this.$mobx.write(this,i,e)}})}function hl(i){var e=i.$mobx;return e||(Yt(i),i.$mobx)}function pp(i){return ml[i]||(ml[i]={configurable:E.computedConfigurable,enumerable:!1,get:function(){return hl(this).read(this,i)},set:function(e){hl(this).write(this,i,e)}})}function dp(i,e,t,r){var o=We(i),n=ge(),s=o||n?{type:"add",object:e,name:t,newValue:r}:null;n&&we(q(q({},s),{name:i.name,key:t})),o&&je(i,s),n&&Ee()}var mp=Ot("ObservableObjectAdministration",dl);function Jt(i){return Zo(i)?(Yt(i),mp(i.$mobx)):!1}function Lt(i,e){if(typeof i=="object"&&i!==null){if(Xt(i))return e!==void 0&&V(!1),i.$mobx.atom;if(Tt(i))return i.$mobx;if(et(i)){var t=i;if(e===void 0)return t._keysAtom;var r=t._data.get(e)||t._hasMap.get(e);return r||V(!1),r}if(Yt(i),e&&!i.$mobx&&i[e],Jt(i)){if(!e)return V(!1);var r=i.$mobx.values[e];return r||V(!1),r}if(tn(i)||Nr(i)||Gr(i))return i}else if(typeof i=="function"&&Gr(i.$mobx))return i.$mobx;return V(!1)}function fl(i,e){if(i||V("Expecting some object"),e!==void 0)return fl(Lt(i,e));if(tn(i)||Nr(i)||Gr(i)||et(i)||Tt(i))return i;if(Yt(i),i.$mobx)return i.$mobx;V(!1)}function hp(i,e){var t;return e!==void 0?t=Lt(i,e):Jt(i)||et(i)||Tt(i)?t=fl(i):t=Lt(i),t.name}var gl=Object.prototype.toString;function rn(i,e,t){return t===void 0&&(t=-1),vn(i,e,t)}function vn(i,e,t,r,o){if(i===e)return i!==0||1/i==1/e;if(i==null||e==null)return!1;if(i!==i)return e!==e;var n=typeof i;if(n!=="function"&&n!=="object"&&typeof e!="object")return!1;i=bl(i),e=bl(e);var s=gl.call(i);if(s!==gl.call(e))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+i==""+e;case"[object Number]":return+i!=+i?+e!=+e:+i==0?1/+i==1/e:+i==+e;case"[object Date]":case"[object Boolean]":return+i==+e;case"[object Symbol]":return typeof Symbol!="undefined"&&Symbol.valueOf.call(i)===Symbol.valueOf.call(e)}var l=s==="[object Array]";if(!l){if(typeof i!="object"||typeof e!="object")return!1;var c=i.constructor,p=e.constructor;if(c!==p&&!(typeof c=="function"&&c instanceof c&&typeof p=="function"&&p instanceof p)&&"constructor"in i&&"constructor"in e)return!1}if(t===0)return!1;t<0&&(t=-1),r=r||[],o=o||[];for(var m=r.length;m--;)if(r[m]===i)return o[m]===e;if(r.push(i),o.push(e),l){if(m=i.length,m!==e.length)return!1;for(;m--;)if(!vn(i[m],e[m],t-1,r,o))return!1}else{var h=Object.keys(i),b=void 0;if(m=h.length,Object.keys(e).length!==m)return!1;for(;m--;)if(b=h[m],!(fp(e,b)&&vn(i[b],e[b],t-1,r,o)))return!1}return r.pop(),o.pop(),!0}function bl(i){return Xt(i)?i.peek():yi(i)||et(i)||Wi(i)||Tt(i)?ft(i.entries()):i}function fp(i,e){return Object.prototype.hasOwnProperty.call(i,e)}try{}catch(i){_n=gi(),typeof process=="undefined"&&(_n.process={}),_n.process.env={}}var _n;(function(){function i(){}if(i.name!=="testCodeMinification"&&!1&&typeof process!="undefined"&&process.env.IGNORE_MOBX_MINIFY_WARNING!=="true"){var e=["process","env","NODE_ENV"].join(".");console.warn("[mobx] you are running a minified build, but '"+e+"' was not set to 'production' in your bundler. This results in an unnecessarily large and slow bundle")}})();var Sn="$mobx";typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:mn,extras:{getDebugName:hp},$mobx:Sn});var Dn=()=>window&&window.navigator&&window.navigator.userAgent||"",ti=(i=Dn())=>i.indexOf("Edge")!==-1,Me=(i=Dn())=>!!i.match(/msie|trident/i);var yl=(i=Dn())=>!!i.match(/iP(hone|od|ad)|AppleWebKit/),vl=()=>{let i=document.createElement("canvas"),e=i.getContext("webgl")||i.getContext("experimental-webgl");return e&&e instanceof WebGLRenderingContext};var _l=i=>i.replace(hb,"");var ii=i=>{try{return new URL(i),!0}catch(e){return!1}};var Sl=i=>i instanceof HTMLImageElement;var Dl=class{constructor(){this.enabled=!0;this.threshold=20;this.snapToHorizontalCenter=!0;this.snapToVerticalCenter=!0;this.snapToLeft=.1;this.snapToRight=.1;this.snapToTop=.1;this.snapToBottom=.1}},xl=class{constructor(){this.enabled=!0;this.threshold=20;this.angles=[0,45,90,135,180,225,270,315]}},xn=class{constructor(){this.position=new Dl;this.rotation=new xl}};var Cn=class{constructor(){this.categories=[];this.flattenCategories=!1}};var En=class{constructor(){this.categories=[];this.flattenCategories=!1;this.categoryHeaderType=wn.CARD;this.enablePreviewThumbnails=!1}};function $r(i){return i.lightColor!==void 0}function gp(i){return i.lutURI!==void 0}var kn=class{constructor(){this.items=[]}};var In=class{constructor(){this.items=[]}};var Fn=class{constructor(){this.enableWebcam=!1;this.enableUpload=!1;this.flattenCategories=!1;this.categoryHeaderType=wn.CARD}};var An=class{constructor(){this.items=[]}};var Rn=class{constructor(){this.categories=[];this.canvasActions=[de.BRING_TO_FRONT,de.FLIP,de.DUPLICATE,de.DELETE];this.flattenCategories=!1;this.categoryHeaderType=wn.CARD;this.enableCustomUpload=!0;this.customStickerTintMode="none"}};var On=class{constructor(){this.fonts=[];this.canvasActions=[de.EDIT,de.BRING_TO_FRONT,de.DUPLICATE,de.DELETE];this.disableAutoScaling=!1}};function bp(i){return i.provider===void 0||i.provider==="file"}function yp(i){return i.provider==="google"}var Tn=class{constructor(){this.defaultSize=.05;this.defaultHardness=.5}};var Pn=class{constructor(){this.items=[];this.canvasActions=[de.EDIT,de.BRING_TO_FRONT,de.INVERT,de.DUPLICATE,de.DELETE]}};var Mn=class{constructor(){this.categories=[];this.enableRotation=!0;this.enableFlip=!0;this.flattenCategories=!1;this.categoryHeaderType=wn.TEXT}};var Xi=class{constructor(){this.events={}}addListener(e,t){return(this.events[e]||(this.events[e]=[])).push(t),this}removeListener(e,t){let r=this.events[e];if(!r)return this;let o=r.lastIndexOf(t);return o===-1?this:(r.splice(o,1),this)}removeAllListeners(e){return this.events[e]=void 0,this}on(e,t){return this.addListener(e,t)}off(e,t){return this.removeListener(e,t)}emit(e,...t){let r=this.events[e];return!r||!r.length?!1:(r.slice(0).forEach(o=>o.apply(null,t)),!0)}};var Bn=Tb;var zn=Mb;var Cl=zb;var vp=[{identifier:"imgly_font_open_sans_bold",fontFamily:"Open Sans",fontWeight:"bold",fontURI:"./fonts/imgly_font_open_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}},{identifier:"imgly_font_aleo_bold",fontFamily:"Aleo",fontWeight:"bold",fontURI:"./fonts/imgly_font_aleo_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}},{identifier:"imgly_font_amaticsc",fontFamily:"Amatic SC",fontWeight:"normal",fontURI:"./fonts/imgly_font_amaticsc.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}},{identifier:"imgly_font_archivo_black",fontFamily:"Archivo",fontWeight:"normal",fontURI:"./fonts/imgly_font_archivo_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}},{identifier:"imgly_font_bungee_inline",fontFamily:"Bungee Inline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_bungee_inline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}},{identifier:"imgly_font_fira_sans_regular",fontFamily:"Fira Sans",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_fira_sans_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}},{identifier:"imgly_font_campton_bold",fontFamily:"Campton Book",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_campton_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}},{identifier:"imgly_font_carter_one",fontFamily:"Carter One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_carter_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}},{identifier:"imgly_font_codystar",fontFamily:"Codystar",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_codystar.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}},{identifier:"imgly_font_galano_grotesque_bold",fontFamily:"Galano Grotesque",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_galano_grotesque_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_krona_one",fontFamily:"Krona One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_krona_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}},{identifier:"imgly_font_kumar_one_outline",fontFamily:"Kumar One Outline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_kumar_one_outline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}},{identifier:"imgly_font_lobster",fontFamily:"Lobster",fontWeight:"normal",fontURI:"./fonts/imgly_font_lobster.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}},{identifier:"imgly_font_molle",fontFamily:"Molle",fontWeight:"normal",fontStyle:"italic",fontURI:"./fonts/imgly_font_molle.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}},{identifier:"imgly_font_monoton",fontFamily:"Monoton",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_monoton.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}},{identifier:"imgly_font_nixie_one",fontFamily:"Nixie One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_nixie_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}},{identifier:"imgly_font_notable",fontFamily:"Notable",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_notable.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}},{identifier:"imgly_font_ostrich_sans_black",fontFamily:"Ostrich",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontFamily:"Ostrich",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_oswald_semi_bold",fontFamily:"Oswald SemiBold",googleFamily:"Oswald",fontWeight:600,fontStyle:"normal",fontURI:"./fonts/imgly_font_oswald_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}},{identifier:"imgly_font_palanquin_dark_semi_bold",fontFamily:"Palanquin Dark SemiBold",googleFamily:"Palanquin Dark",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_palanquin_dark_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}},{identifier:"imgly_font_poppins",fontFamily:"Poppins",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_poppins.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}},{identifier:"imgly_font_permanent_marker",fontFamily:"Permanent Marker",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_permanent_marker.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}},{identifier:"imgly_font_roboto_black_italic",fontFamily:"Roboto Black",fontWeight:"bold",fontStyle:"italic",googleFamily:"Roboto",fontURI:"./fonts/imgly_font_roboto_black_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontFamily:"Roboto Light",googleFamily:"Roboto",fontWeight:300,fontStyle:"italic",fontURI:"./fonts/imgly_font_roboto_light_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sancreek",fontFamily:"Sancreek",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sancreek.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}},{identifier:"imgly_font_stint_ultra_expanded",fontFamily:"Stint Ultra Expanded",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_stint_ultra_expanded.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}},{identifier:"imgly_font_trash_hand",fontFamily:"Trash Hand",fontWeight:"normal",fontURI:"./fonts/imgly_font_trash_hand.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}},{identifier:"imgly_font_vt323",fontFamily:"VT323",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_vt323.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_yeseva_one",fontFamily:"Yeseva One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_yeseva_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}},{identifier:"imgly_font_abril_fatface_regular",fontFamily:"Abril Fatface",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_abril_fatface_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}},{identifier:"imgly_font_amberlight",fontFamily:"Amberlight",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_amberlight.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}},{identifier:"imgly_font_montserrat_light",fontFamily:"Montserrat Light",googleFamily:"Montserrat",fontWeight:300,fontStyle:"normal",fontURI:"./fonts/imgly_font_montserrat_light.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}},{identifier:"imgly_font_handycheera_regular",fontFamily:"Handycheera",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_handycheera_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}},{identifier:"imgly_font_ostrich_sans_heavy",fontFamily:"Ostrich",fontWeight:900,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_heavy.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}},{identifier:"imgly_font_petit_formal_script",fontFamily:"Petit Formal Script",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_petit_formal_script.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}},{identifier:"imgly_font_rasa_500",fontFamily:"Rasa",fontWeight:500,fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_500.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_regular",fontFamily:"Rasa",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_regular.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_roboto_black",fontFamily:"Roboto Black",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_black.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light",fontFamily:"Roboto Light",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_light.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sue_ellen_francisco",fontFamily:"Sue Ellen Francisco",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sue_ellen_francisco.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}},{identifier:"imgly_font_ultra",fontFamily:"Ultra",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_ultra.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}},{identifier:"imgly_font_wolesbro",fontFamily:"Wolesbro",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_wolesbro.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}],Ln=vp;var _p=["imgly_font_open_sans_bold","imgly_font_aleo_bold","imgly_font_amaticsc","imgly_font_archivo_black","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_carter_one","imgly_font_codystar","imgly_font_fira_sans_regular","imgly_font_galano_grotesque_bold","imgly_font_krona_one","imgly_font_kumar_one_outline","imgly_font_lobster","imgly_font_molle","imgly_font_monoton","imgly_font_nixie_one","imgly_font_notable","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_oswald_semi_bold","imgly_font_palanquin_dark_semi_bold","imgly_font_poppins","imgly_font_permanent_marker","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sancreek","imgly_font_stint_ultra_expanded","imgly_font_trash_hand","imgly_font_vt323","imgly_font_yeseva_one"],Sp=["imgly_font_abril_fatface_regular","imgly_font_amberlight","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_galano_grotesque_bold","imgly_font_handycheera_regular","imgly_font_montserrat_light","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_heavy","imgly_font_permanent_marker","imgly_font_petit_formal_script","imgly_font_rasa_500","imgly_font_rasa_regular","imgly_font_roboto_black","imgly_font_roboto_light","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sue_ellen_francisco","imgly_font_ultra","imgly_font_wolesbro"];var Dp=[{identifier:"imgly_frame_dia",name:"Dia",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_left.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_right.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",name:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",name:"Black Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",name:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",name:"Low Poly",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}}],Un=Dp;var Nn=Wb;var xp=[{identifier:"imgly_sticker_emoticons",name:"Emoticons",thumbnailURI:"./categories/emoticons.png",items:[{identifier:"imgly_sticker_emoticons_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_grin.svg",tintMode:"none",name:"Grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_laugh",stickerURI:"./emoticons/imgly_sticker_emoticons_laugh.svg",tintMode:"none",name:"Laugh",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smile",stickerURI:"./emoticons/imgly_sticker_emoticons_smile.svg",tintMode:"none",name:"Smile",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_wink.svg",tintMode:"none",name:"Wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tongue_out_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_tongue_out_wink.svg",tintMode:"none",name:"Tongue out wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angel",stickerURI:"./emoticons/imgly_sticker_emoticons_angel.svg",tintMode:"none",name:"Angel",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kisses",stickerURI:"./emoticons/imgly_sticker_emoticons_kisses.svg",tintMode:"none",name:"Kisses",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loving",stickerURI:"./emoticons/imgly_sticker_emoticons_loving.svg",tintMode:"none",name:"Loving",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kiss",stickerURI:"./emoticons/imgly_sticker_emoticons_kiss.svg",tintMode:"none",name:"Kiss",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wave",stickerURI:"./emoticons/imgly_sticker_emoticons_wave.svg",tintMode:"none",name:"Wave",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_nerd",stickerURI:"./emoticons/imgly_sticker_emoticons_nerd.svg",tintMode:"none",name:"Nerd",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cool",stickerURI:"./emoticons/imgly_sticker_emoticons_cool.svg",tintMode:"none",name:"Cool",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_blush",stickerURI:"./emoticons/imgly_sticker_emoticons_blush.svg",tintMode:"none",name:"Blush",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_duckface",stickerURI:"./emoticons/imgly_sticker_emoticons_duckface.svg",tintMode:"none",name:"Duckface",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_furious.svg",tintMode:"none",name:"Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angry",stickerURI:"./emoticons/imgly_sticker_emoticons_angry.svg",tintMode:"none",name:"Angry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_steaming_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_steaming_furious.svg",tintMode:"none",name:"Steaming Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sad",stickerURI:"./emoticons/imgly_sticker_emoticons_sad.svg",tintMode:"none",name:"Sad",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_anxious",stickerURI:"./emoticons/imgly_sticker_emoticons_anxious.svg",tintMode:"none",name:"Anxious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_cry.svg",tintMode:"none",name:"Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sobbing",stickerURI:"./emoticons/imgly_sticker_emoticons_sobbing.svg",tintMode:"none",name:"Sobbing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loud_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_loud_cry.svg",tintMode:"none",name:"Loud Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wide_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_wide_grin.svg",tintMode:"none",name:"Wide grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_impatient",stickerURI:"./emoticons/imgly_sticker_emoticons_impatient.svg",tintMode:"none",name:"Impatient",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tired",stickerURI:"./emoticons/imgly_sticker_emoticons_tired.svg",tintMode:"none",name:"Tired",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_asleep",stickerURI:"./emoticons/imgly_sticker_emoticons_asleep.svg",tintMode:"none",name:"Asleep",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sleepy",stickerURI:"./emoticons/imgly_sticker_emoticons_sleepy.svg",tintMode:"none",name:"Sleepy",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_deceased",stickerURI:"./emoticons/imgly_sticker_emoticons_deceased.svg",tintMode:"none",name:"Deceased",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_attention",stickerURI:"./emoticons/imgly_sticker_emoticons_attention.svg",tintMode:"none",name:"Attention",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_question",stickerURI:"./emoticons/imgly_sticker_emoticons_question.svg",tintMode:"none",name:"Question",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",stickerURI:"./emoticons/imgly_sticker_emoticons_not_speaking_to_you.svg",tintMode:"none",name:"Not speaking to you",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sick",stickerURI:"./emoticons/imgly_sticker_emoticons_sick.svg",tintMode:"none",name:"Sick",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pumpkin",stickerURI:"./emoticons/imgly_sticker_emoticons_pumpkin.svg",tintMode:"none",name:"Pumpkin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_boxer",stickerURI:"./emoticons/imgly_sticker_emoticons_boxer.svg",tintMode:"none",name:"Boxer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_idea",stickerURI:"./emoticons/imgly_sticker_emoticons_idea.svg",tintMode:"none",name:"Idea",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smoking",stickerURI:"./emoticons/imgly_sticker_emoticons_smoking.svg",tintMode:"none",name:"Smoking",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_beer",stickerURI:"./emoticons/imgly_sticker_emoticons_beer.svg",tintMode:"none",name:"Beer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skateboard",stickerURI:"./emoticons/imgly_sticker_emoticons_skateboard.svg",tintMode:"none",name:"Skateboard",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_guitar",stickerURI:"./emoticons/imgly_sticker_emoticons_guitar.svg",tintMode:"none",name:"Guitar",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_music",stickerURI:"./emoticons/imgly_sticker_emoticons_music.svg",tintMode:"none",name:"Music",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sunbathing",stickerURI:"./emoticons/imgly_sticker_emoticons_sunbathing.svg",tintMode:"none",name:"Sunbathing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hippie",stickerURI:"./emoticons/imgly_sticker_emoticons_hippie.svg",tintMode:"none",name:"Hippie",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_humourous",stickerURI:"./emoticons/imgly_sticker_emoticons_humourous.svg",tintMode:"none",name:"Humourous",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hitman",stickerURI:"./emoticons/imgly_sticker_emoticons_hitman.svg",tintMode:"none",name:"Hitman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_harry_potter",stickerURI:"./emoticons/imgly_sticker_emoticons_harry_potter.svg",tintMode:"none",name:"Harry Potter",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_business",stickerURI:"./emoticons/imgly_sticker_emoticons_business.svg",tintMode:"none",name:"Business",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_batman",stickerURI:"./emoticons/imgly_sticker_emoticons_batman.svg",tintMode:"none",name:"Batman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skull",stickerURI:"./emoticons/imgly_sticker_emoticons_skull.svg",tintMode:"none",name:"Skull",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_ninja",stickerURI:"./emoticons/imgly_sticker_emoticons_ninja.svg",tintMode:"none",name:"Ninja",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_masked",stickerURI:"./emoticons/imgly_sticker_emoticons_masked.svg",tintMode:"none",name:"Masked",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_alien",stickerURI:"./emoticons/imgly_sticker_emoticons_alien.svg",tintMode:"none",name:"Alien",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wrestler",stickerURI:"./emoticons/imgly_sticker_emoticons_wrestler.svg",tintMode:"none",name:"Wrestler",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_devil",stickerURI:"./emoticons/imgly_sticker_emoticons_devil.svg",tintMode:"none",name:"Devil",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_star",stickerURI:"./emoticons/imgly_sticker_emoticons_star.svg",tintMode:"none",name:"Star",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_baby_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_baby_chicken.svg",tintMode:"none",name:"Baby Chicken",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_rabbit",stickerURI:"./emoticons/imgly_sticker_emoticons_rabbit.svg",tintMode:"none",name:"Rabbit",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pig",stickerURI:"./emoticons/imgly_sticker_emoticons_pig.svg",tintMode:"none",name:"Pig",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_chicken.svg",tintMode:"none",name:"Chicken",resizeMode:"keepAspect"}]},{identifier:"imgly_sticker_shapes",name:"Shapes",thumbnailURI:"./categories/shapes.png",items:[{identifier:"imgly_sticker_shapes_badge_01",stickerURI:"./shapes/imgly_sticker_shapes_badge_01.svg",tintMode:"solid",name:"Shape Badge 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_04",stickerURI:"./shapes/imgly_sticker_shapes_badge_04.svg",tintMode:"solid",name:"Shape Badge 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_12",stickerURI:"./shapes/imgly_sticker_shapes_badge_12.svg",tintMode:"solid",name:"Shape Badge 12",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_06",stickerURI:"./shapes/imgly_sticker_shapes_badge_06.svg",tintMode:"solid",name:"Shape Badge 06",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_13",stickerURI:"./shapes/imgly_sticker_shapes_badge_13.svg",tintMode:"solid",name:"Shape Badge 13",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_36",stickerURI:"./shapes/imgly_sticker_shapes_badge_36.svg",tintMode:"solid",name:"Shape Badge 36",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_08",stickerURI:"./shapes/imgly_sticker_shapes_badge_08.svg",tintMode:"solid",name:"Shape Badge 08",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_11",stickerURI:"./shapes/imgly_sticker_shapes_badge_11.svg",tintMode:"solid",name:"Shape Badge 11",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_35",stickerURI:"./shapes/imgly_sticker_shapes_badge_35.svg",tintMode:"solid",name:"Shape Badge 35",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_28",stickerURI:"./shapes/imgly_sticker_shapes_badge_28.svg",tintMode:"solid",name:"Shape Badge 28",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_32",stickerURI:"./shapes/imgly_sticker_shapes_badge_32.svg",tintMode:"solid",name:"Shape Badge 32",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_15",stickerURI:"./shapes/imgly_sticker_shapes_badge_15.svg",tintMode:"solid",name:"Shape Badge 15",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_20",stickerURI:"./shapes/imgly_sticker_shapes_badge_20.svg",tintMode:"solid",name:"Shape Badge 20",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_18",stickerURI:"./shapes/imgly_sticker_shapes_badge_18.svg",tintMode:"solid",name:"Shape Badge 18",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_19",stickerURI:"./shapes/imgly_sticker_shapes_badge_19.svg",tintMode:"solid",name:"Shape Badge 19",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_02",stickerURI:"./shapes/imgly_sticker_shapes_arrow_02.svg",tintMode:"solid",name:"Shape Arrow 02",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_03",stickerURI:"./shapes/imgly_sticker_shapes_arrow_03.svg",tintMode:"solid",name:"Shape Arrow 03",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_01",stickerURI:"./shapes/imgly_sticker_shapes_spray_01.svg",tintMode:"solid",name:"Shape Spray 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_04",stickerURI:"./shapes/imgly_sticker_shapes_spray_04.svg",tintMode:"solid",name:"Shape Spray 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_03",stickerURI:"./shapes/imgly_sticker_shapes_spray_03.svg",tintMode:"solid",name:"Shape Spray 03",resizeMode:"keepAspect"}]}],Hn=xp;var Cp=[{thumbnailURI:"./items/dark/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/dark/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/dark/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/dark/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/dark/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/dark/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/dark/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/dark/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/dark/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/dark/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/dark/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/dark/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/dark/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/dark/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}],wp=Cp;var Ep=[{thumbnailURI:"./items/light/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/light/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/light/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/light/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/light/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/light/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/light/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/light/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/light/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/light/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/light/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/light/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/light/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/light/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}],kp=Ep;var Wn=Kb;var jn={};qb(jn,{isMobile:()=>wl});function wl(){if(typeof navigator=="undefined")return!1;let i=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4))}var Gn=class extends Xi{constructor(e,t){super();this.image=e,this.options=t}needsResize(){let e=this.resizedDimensions();return e.x<this.image.width||e.y<this.image.height}resizedDimensions(){let{options:e}=this,t={width:this.image.width,height:this.image.height},r=_.fromSize(t),o=_.fromSize(t),{maxMegaPixels:n}=e;if(n){let c=(wl()?n.mobile:n.desktop)*1e6,p=t.width/t.height,m=t.height/t.width,h=new _(Math.floor(Math.sqrt(c*p)),Math.floor(Math.sqrt(c*m)));h.x<=t.width&&h.y<=t.height&&(r=h)}let s=e.maxDimensions;s&&(s.height<t.height||s.width<t.width)&&(o=new _(s.width,s.height));let l=new _(Math.min(r.x,o.x),Math.min(r.y,o.y));return _.proportionalFit(l,_.fromSize(t)).floored}downscaleIfNecessary(){let e=this.resizedDimensions();if(!(e.x<this.image.width||e.y<this.image.height))return this.image;this.emit(Ji.BEGAN_IMAGE_DOWNSCALING,this.image);let r=document.createElement("canvas");r.width=e.x,r.height=e.y;let o=r.getContext("2d"),{image:n}=this;return o.imageSmoothingQuality="high",o.drawImage(n,0,0,n.width,n.height,0,0,e.x,e.y),this.emit(Ji.IMAGE_DOWNSCALED,{width:e.x,height:e.y}),r}downscaleImageIfNecessary(){let e=this.image,t=this.resizedDimensions();if(!(t.x<this.image.width||t.y<this.image.height))return e;this.emit(Ji.BEGAN_IMAGE_DOWNSCALING,e);let o=new Image;return o.width=t.x,o.height=t.y,o.src=e.src,this.emit(Ji.IMAGE_DOWNSCALED,{width:t.x,height:t.y}),o}};var Ip=i=>i.key==="Escape";var El=i=>e=>{Ip(e)&&i(e)};var me=Zb;function Fp(i,e){let t=0;for(let r=i.length-1;r>=0;r--){let o=i[r];o==="."?i.splice(r,1):o===".."?(i.splice(r,1),t++):t&&(i.splice(r,1),t--)}if(e)for(;t--;t)i.unshift("..");return i}function Ap(i){return i.charAt(0)==="/"}function Rp(i){let e=Ap(i),t=i.substr(-1)==="/";return i=Fp(i.split("/").filter(Boolean),!e).join("/"),!i&&!e&&(i="."),i&&t&&(i+="/"),(e?"/":"")+i}var kl=(...i)=>Rp(i.join("/"));var Vn=(i,e,[t,r],o=0)=>{let n=i[e];if(n){if(n<t)return console.error(`${e} must be greater than or equal to ${t}`),t;if(n>r)return console.error(`${e} must be less than or equal to ${r}`),r}return n||o},Ge=(i,e,t=[1,1,1,1])=>{let r=i[e],o=!0;return r&&r.forEach(n=>{n<0&&(console.error(`${n} in ${e} must be greater than or equal to 0`),o=!1),n>1&&(console.error(`${n} in ${e} must be less than or equal to 1`),o=!1)}),o&&r||t};var Op={italic:"i"},Kr=class{constructor(e){this.assetManager=e;this.injectedFonts={};this.loadedFonts={};this.getGoogleFamiliesString=e=>{let t=e.reduce((r,o)=>{let{fontFamily:n,fontStyle:s,fontWeight:l=400}=o;return r[n]=(r[n]||[]).concat(`${l}${Op[s]||""}`),r},{});return Object.keys(t).map(r=>{let o=t[r].length?`:${t[r].join(",")}`:"";return r.replace(" ","+")+o}).join("|")}}static createFontFacesCSS(e,t){return e.map(r=>{let o=t(r.fontURI);return`@font-face {
        font-family: "${r.fontFamily}";
        src: url('${o}') format('${r.format||"woff"}');
        font-weight: ${r.fontWeight||"normal"};
        font-style: ${r.fontStyle||"normal"};
      }`})}getFontWithId(e){let t=this.assetManager.getFontAsset(e);if(!t)throw new Error("The requested font does not exist as an asset.");return t}isFontLoaded(e){return this.loadedFonts[e]!==void 0}injectAllFonts(){let e=this.assetManager.getFontAssets();this.injectFonts(e)}loadAllFonts(){return C(this,null,function*(){let e=this.assetManager.getFontAssets();return this.loadFonts(e)})}loadFontsWithIdentifiers(e){return C(this,null,function*(){let t=e.map(r=>this.getFontWithId(r));return this.loadFonts(t)})}loadFonts(e){return C(this,null,function*(){this.injectFonts(e);let t=new Array;return e.forEach(r=>{t.push(this.loadFont(r,!1))}),new Promise((r,o)=>{Promise.all(t).then(()=>r()).catch(n=>o(n))})})}loadFont(e,t=!0){return C(this,null,function*(){return new Promise((r,o)=>{this.isFontLoaded(e.identifier)&&r(),t&&this.injectFonts([e]),new iy(e).load().then(()=>{this.loadedFonts[e.identifier]=e,r()}).catch(()=>{o(e.identifier)})})})}loadFontWithIdentifier(e,t=!0){return C(this,null,function*(){let r=this.assetManager.getFontAsset(e);if(!r)throw new Error(`The requested font asset with identifier ${e} does not exist!`);return this.loadFont(r,t)})}injectFonts(e,t=this.assetManager.getPathForCategory("font")){let r=e.filter(yp),o=e.filter(bp);r.length>0&&this.addGoogleFontLinks(r),o.length>0&&this.addWebFontCSS(o,t)}addGoogleFontLinks(e){let t=e.filter(s=>!this.injectedFonts[s.identifier]);if(t.length===0)return;let r=this.getGoogleFamiliesString(t),o=document.createElement("link");o.rel="stylesheet",o.href=`https://fonts.googleapis.com/css?family=${r}`,document.getElementsByTagName("head")[0].appendChild(o),e.forEach(s=>{this.injectedFonts[s.identifier]=s})}addWebFontCSS(e,t){let r=e.filter(l=>!this.injectedFonts[l.identifier]);if(r.length===0)return;let n=`
      /* Injected by PhotoEditorSDK */
      ${Kr.createFontFacesCSS(r,t).join(`
`)}
    `,s=document.createElement("style");s.innerHTML=n,document.head.appendChild(s),e.forEach(l=>{this.injectedFonts[l.identifier]=l})}};var qr=class{constructor(e,t=!1){this.basePath="assets/";this.areCustomAssetsAllowed=!1;this.getAssets=e=>{switch(e){case"overlay":return this.overlayAssets;case"filter":return this.filterCategories;case"font":return this.fontAssets;case"focus":return this.focusAssets;case"adjustment":return this.adjustmentCategories;case"sticker":return this.stickerCategories;case"textdesign":return this.textDesignAssets;case"frame":return this.frameAssets;case"transform":return this.transformCategories}return[]};this.getPath=(e,...t)=>{if(t.length===1&&t[0].match(/(ftp|http|https):\/\//)&&ii(t[0]))return t[0];let r=kl(e,...t);if((!t||t.length===0)&&ii(e))return e;if(this.basePath.match(/(ftp|http|https):\/\//)){let{length:o}=this.basePath;return this.basePath[o-1]!=="/"&&(this.basePath=`${this.basePath}/`),this.basePath+r}return kl(this.basePath,r)};this.getPathForCategory=e=>(...t)=>this.getPath(e,...t);this.addCustomStickerAsset=(e,t,r)=>{e.forEach(o=>{let{thumbnailURI:n,name:s,stickerURI:l,identifier:c,tintMode:p,resizeMode:m}=o,h=this.stickerCategories.find(v=>v.identifier===t),b={identifier:c,name:s,thumbnailURI:n,stickerURI:l,tintMode:p,resizeMode:m};if(h)h.items.push(b);else{let v={identifier:t,name:r,thumbnailURI:n,items:[b]};this.stickerCategories=[v,...this.stickerCategories]}}),this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[])};this.getItemPath=(e,t,r)=>{let o=e.find(n=>n.identifier===t);return o&&(o[r]||o.path)||""};this.isNonExistingFont=e=>!Ln.find(t=>t.identifier===e.identifier)&&!Tp[e.identifier];this.replaceDeprecatedFont=e=>Tp[e.identifier]?Ln.find(t=>t.identifier===oy(e.identifier,!0)):e;e&&e.basePath&&(this.basePath=e.basePath),this.areCustomAssetsAllowed=t;let r=zn.reduce(this.allOptions,[]);e&&e.filter?this.filterCategories=this.configuredCategory(zn,e.filter,r):this.filterCategories=zn,this.lutFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(m=>gp(m)),this.duoToneFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(m=>$r(m));let o=Bn.reduce(this.allOptions,[]);e&&e.adjustment?this.adjustmentCategories=this.configuredCategory(Bn,e.adjustment,o):this.adjustmentCategories=Bn,this.fontAssets=Ln.reduce(this.allOptions,[]);let n=_p.map(m=>this.getFontAsset(m));if(e&&e.text&&e.text.fonts&&e.text.fonts.length>0){let m=e.text.fonts.filter(this.isNonExistingFont),h=e.text.fonts.filter(b=>!this.isNonExistingFont(b)).map(b=>this.replaceDeprecatedFont(b)).map(b=>this.getFontAsset(b.identifier));n=e.text.fonts?[...h,...m]:n,this.fontAssets=e.text.fonts?[...this.fontAssets,...m]:this.fontAssets}this.textToolFontAssets=n;let s=e&&e.focus&&e.focus.items&&e.focus.items.length?e.focus.items.map(m=>Cl.find(h=>h.identifier===m.identifier)):Cl;this.focusAssets=s,e&&e.overlay&&e.overlay.items?this.overlayAssets=this.configuredItem(e.overlay.items,Nn,Nn):this.overlayAssets=Nn,e&&e.frame&&e.frame.items?this.frameAssets=this.configuredItem(e.frame.items,Un,Un):this.frameAssets=Un;let l=Hn.reduce(this.allOptions,[]);e&&e.sticker?this.stickerCategories=this.configuredCategory(Hn,e.sticker,l):this.stickerCategories=Hn,this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[]);let c=wp;e&&e.theme==="light"&&(c=kp),this.textDesignAssets=e&&e.textdesign&&e.textdesign.items&&e.textdesign.items.length?e.textdesign.items.map(m=>c.find(h=>h.identifier===m.identifier)):c,this.textDesignToolFontAssets=Sp.map(m=>this.getFontAsset(m));let p=Wn.reduce(this.allOptions,[]);e&&e.transform?this.transformCategories=this.configuredCategory(Wn,e.transform,p):this.transformCategories=Wn,this.transformAssets=this.transformCategories.reduce(this.allOptions,[]),this.fontManager=new Kr(this)}getFontManager(){return this.fontManager}getAssetSource(e,t){switch(e){case"filter":if(this.getLUTFilterAsset(t))return this.getPath(e,this.getItemPath(this.lutFilterAssets,t,"lutURI"));break;case"overlay":return this.getPath(e,this.getItemPath(this.overlayAssets,t,"overlayURI"));case"font":return this.getPath(e,this.getItemPath(this.fontAssets,t,"fontURI"));case"sticker":let o=this.stickerAssets.find(n=>n.identifier===t);if(o){if(o.stickerURI.substr(0,10)==="data:image")return o.stickerURI;if(t.includes("imgly_sticker")&&o.stickerURI.includes(".svg")&&Me()){let s=this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI")).split("/");return s.splice(s.length-1,0,"base"),s[s.length-1]=s[s.length-1].replace(".svg",".png"),s.join("/")}return this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI"))}throw new Error("Cannot resolve this type of sticker asset yet");case"textdesign":return this.getPath(e,"engine",t);case"frame":return this.getPath(e,t)}throw new Error("Cannot resolve this type of asset yet")}getDuotoneFilterAsset(e){return this.duoToneFilterAssets.filter(t=>t.identifier===e)[0]}getLUTFilterAsset(e){return this.lutFilterAssets.filter(t=>t.identifier===e)[0]}getOverlayAsset(e){return this.overlayAssets.filter(t=>t.identifier===e)[0]}getStickerAsset(e){return this.stickerAssets.filter(t=>t.identifier===e)[0]}getFontAsset(e){return this.fontAssets.filter(t=>t.identifier===e)[0]}getTextDesignAssets(e){return this.textDesignAssets.filter(t=>t.identifier===e)[0]}getFrameAsset(e){return this.frameAssets.filter(t=>t.identifier===e)[0]}getFontAssets(){return this.fontAssets}getFontAssetsForText(){return this.textToolFontAssets}getFontAssetsForTextDesign(){return this.textDesignToolFontAssets}getFrameAssets(){return this.frameAssets}allOptions(e,t){return Object.prototype.hasOwnProperty.call(t,"items")?[...e,...t.items]:[...e,t]}configuredCategory(e,t,r){return t.categories&&t.categories.length?t.categories.reduce((o,n)=>{let s=e.find(l=>l.identifier===n.identifier);return s?o.push(f(f(f({},s),n),{items:this.configuredItem(n.items,r,s.items).filter(Boolean)})):this.areCustomAssetsAllowed&&o.push(f(f({},n),{items:this.configuredItem(n.items,r,n.items).filter(Boolean)})),o},[]):e}configuredItem(e,t,r){return e&&e.length?e.reduce((o,n)=>{let s=t.find(l=>l.identifier===n.identifier);return s?o.push(f(f({},s),n)):this.areCustomAssetsAllowed&&o.push(n),o},[]).filter(Boolean):r}};function Ve(i){return typeof i=="number"}var X=class{static get IDENTITY(){return new X({x:0,y:0})}constructor(e,t={x:1,y:1},r=0){this.position=e,this.scale=t,this.rotation=r}};function $n(i){return typeof i!="string"&&!Array.isArray(i)&&i.a===void 0}function Kn(i){return typeof i!="string"&&Array.isArray(i)&&i.length===3}function qn(i){return typeof i!="string"&&!Array.isArray(i)&&i.a!==void 0}function Yn(i){return typeof i!="string"&&Array.isArray(i)&&i.length===4}function Pp(i){return typeof i=="string"}var Il=class{constructor(e,t){this.engine=t;this.transform=X.IDENTITY;this.canvasPivot={x:0,y:0};this.previewQuality=1;this.canvas=e}get quality(){return this.previewQuality}setQuality(e){this.previewQuality=Math.min(Math.max(e,.01),1)}getTransform(){return this.transform}setTransform(e){this.transform=e}getPosition(){return this.transform.position}setPosition(e,t){let r;typeof e=="number"?r={x:e,y:t===void 0?e:t}:r=e;let{scale:o}=this.transform,{rotation:n}=this.transform;this.setTransform(new X(r,o,n))}getScale(){return this.transform.scale}setScale(e,t){let r;typeof e!="number"?r=e:r={x:e,y:t===void 0?e:t};let{position:o}=this.transform,{rotation:n}=this.transform;this.setTransform(new X(o,r,n))}getRotation(){return this.transform.rotation}setRotation(e){let{position:t}=this.transform,{scale:r}=this.transform;this.setTransform(new X(t,r,e))}getCanvasPivot(){return this.canvasPivot}setCanvasPivot(e,t){typeof e=="number"?this.canvasPivot={x:e,y:typeof t===void 0?e:t}:this.canvasPivot=e}getCanvasBounds(){let e=this.canvasPivot,{width:t,height:r}=this.canvas;return new _t(-e.x*t,-e.y*r,t,r)}};function Fl(i){return i.getTransform!==void 0}function Mp(i){return i.getContainer!==void 0}var Al=class extends Xi{constructor(e){super();this.config=e}getOutputDimensions(){let e=this.getOutputContainer();return e?e.getResolution():{width:0,height:0}}getSmallerOutputSide(){let e=this.getOutputContainer();if(!e)return 0;let t=e.getResolution();return Math.min(t.width,t.height)}convertPointFromPreviewIntoOutputSpace(e,t){let r=$.getInverted(A.rectTransformToAffineTransform(t));return $.transformPoint(r,e)}convertPointFromPreviewIntoWorldSpace(e,t,r){let o=$.getInverted(A.rectTransformToAffineTransform(t)),n=r?this.getOutputContainer().getBaseLocalToParentMatrix():this.getOutputContainer().getLocalToParentMatrix(),s=$.multiply(n,o);return $.transformPoint(s,e)}convertPointFromPreviewIntoFlippedPreviewSpace(e){let t=this.getOutputContainer().getFlipTransformMatrix();return $.transformPoint(t,e)}convertPointFromWorldIntoPreviewSpace(e,t){let r=A.rectTransformToAffineTransform(t),o=$.getInverted(this.getOutputContainer().getLocalToParentMatrix()),n=$.multiply(r,o);return $.transformPoint(n,e)}convertPointFromOutputIntoPreviewSpace(e,t){let r=A.rectTransformToAffineTransform(t);return $.transformPoint(r,e)}getContainersAtPreviewPoint(e,t){let r=new Array,o=this.convertPointFromPreviewIntoWorldSpace(e,t),n=this.getRootContainers();for(let s of n)this.accumulateContainersAtWorldPointInHierarchy(o,s,r);return r}isPreviewPointInContainer(e,t,r){let o=this.convertPointFromPreviewIntoWorldSpace(e,r);return this.isWorldPointInContainer(o,t)}isWorldPointInContainer(e,t){let r=A.getLocalToWorldMatrix(t),o=$.getInverted(r),n=$.transformPoint(o,e);return _t.contains(t.getBounds(),n)}accumulateContainersAtWorldPointInHierarchy(e,t,r){this.isWorldPointInContainer(e,t)&&r.push(t);let o=t.getChildren();for(let n of o)Fl(n)&&this.accumulateContainersAtWorldPointInHierarchy(e,n,r)}};var nt=class{constructor(e){this.engine=e;this.id=xi()}getID(){return this.id}getContainer(){return this.engine.getRootContainers()[0]}getIndexInParent(){let{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1)if(e[t].getID()===this.id)return t;return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}isValid(){return this.getIndexInParent()!==-1}};var Rl=class extends nt{constructor(e,t,r){super(t);this.operation=r;this.type="adjustments";this.setProperties(e)}getProperties(){let e=this.operation.getOptions(),t=e.gamma-1;return{brightness:e.brightness||0,saturation:e.saturation||0,contrast:e.contrast||0,gamma:(t<0?2*t:t)||0,clarity:e.clarity||0,exposure:e.exposure||0,shadows:e.shadows*.5||0,highlights:e.highlights||0,whites:e.whites||0,blacks:e.blacks||0,temperature:e.temperature||0,sharpness:e.sharpness||0}}setProperties(e){e.gamma!==void 0&&(e.gamma=1+(e.gamma<0?.5*e.gamma:e.gamma)),e.shadows&&(e.shadows=e.shadows*2),this.operation.set(e)}getOperation(){return this.operation}getTypeIdentifier(){return"adjustments"}};var St=i=>{if(qn(i))return new pe.Color(i.r,i.g,i.b,i.a);if(Yn(i))return new pe.Color(i[0],i[1],i[2],i[3]);if($n(i))return new pe.Color(i.r,i.g,i.b,1);if(Kn(i))return new pe.Color(i[0],i[1],i[2],1);if(Pp(i)){let[e,t,r]=i.match(/[0-9A-fa-f]{1,2}/g);return new pe.Color(parseInt(e,16)/255,parseInt(t,16)/255,parseInt(r,16)/255,1)}throw new Error("Invalid color type")};var K=class{get x(){return this._x}get y(){return this._y}constructor(e=0,t=0){this._x=e,this._y=t}set(e,t){return this._x=e,this._y=t,this}clone(){return new K(this._x,this._y)}copy(e){return this._x=e.x,this._y=e.y,this}clamped(e=this,t=this){let r=typeof e=="number"?{x:e,y:e}:e,o=typeof t=="number"?{x:t,y:t}:t;return this._x=Math.max(r.x,this._x),this._y=Math.max(r.y,this._y),this._x=Math.min(o.x,this._x),this._y=Math.min(o.y,this._y),this}divide(e,t){return typeof e=="number"||e===null?(this._x/=e,this._y/=typeof t=="undefined"?e:t):(this._x/=e.x,this._y/=e.y),this}subtract(e,t){return typeof e=="number"||e===null?(this._x-=e,this._y-=typeof t=="undefined"?e:t):(this._x-=e.x,this._y-=e.y),this}multiply(e,t){return typeof e=="number"||e===null?(this._x*=e,this._y*=typeof t=="undefined"?e:t):(this._x*=e.x,this._y*=e.y),this}add(e,t){return typeof e=="number"||e===null?(this._x+=e,this._y+=typeof t=="undefined"?e:t):(this._x+=e.x,this._y+=e.y),this}dot(e,t){return typeof e=="number"||e===null?this._x*e+this._y*(typeof t=="undefined"?e:t):this._x*e.x+this._y*e.y}equals(e,t){return typeof e=="number"||e===null?e===this._x&&t===this._y:e.x===this._x&&e.y===this._y}flip(){let e=this._x;return this._x=this._y,this._y=e,this}round(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this}ceil(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this}floor(){return this._x=this._x|0,this._y=this._y|0,this}abs(){return this._x=Math.abs(this._x),this._y=Math.abs(this._y),this}len(){return Math.sqrt(this._x*this._x+this._y*this._y)}min(){return Math.min(this._x,this._y)}max(){return Math.max(this._x,this._y)}toObject(){return{x:this._x,y:this._y}}toString(){return`Vector2({ x: ${this._x}, y: ${this._y} })`}roundDecimal(e){return this._x=parseFloat(this._x.toFixed(e)),this._y=parseFloat(this._y.toFixed(e)),this}asArray(e=!1){return e?[this._y,this._x]:[this._x,this._y]}static fromObject(e){return new K(e.x,e.y)}static fromSize(e){return new K(e.width,e.height)}static get NULL(){return new K(0,0)}};var ri=class{constructor(e){this.engine=e;this.id=xi(),this.transform=X.IDENTITY,this.bounds=_t.ZERO}getID(){return this.id}getParent(){let e=this.engine.getRootContainers();if(!(e.length===0||this.id===e[0].id))return e[0]}getIndexInParent(){let{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1)if(e[t].getID()===this.id)return t;return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}getChildren(){let e=this.engine.getRootContainers();return e.length>0&&(this.id===e[0].id||this.id===this.engine.getOutputContainer().id)?this.engine.rootOperations:[]}getBounds(){return this.bounds}setPivotOnSelfAndSprite(e,t,r){typeof t=="number"?(this.setPivotInternal(t,r),e.setPivot(new K(t,r))):(this.setPivotInternal(t),e.setPivot(K.fromObject(t)))}setPivot(e,t){this.setPivotInternal(e,t)}getPivot(){let e=this.getBounds();return{x:-e.minX/e.width,y:-e.minY/e.height}}getTransform(){return this.transform}setTransform(e){this.transform=e}updateTransform(){this.setTransform(this.transform)}getPosition(){return this.transform.position}setPosition(e,t){let r;typeof e=="number"?r={x:e,y:t===void 0?e:t}:r=e;let{scale:o}=this.transform,{rotation:n}=this.transform;this.setTransform(new X(r,o,n))}getScale(){return this.transform.scale}setScale(e,t){let r;typeof e!="number"?r=e:r={x:e,y:t===void 0?e:t};let{position:o,rotation:n}=this.transform;this.setTransform(new X(o,r,n))}getRotation(){return this.transform.rotation}setRotation(e){let{position:t,scale:r}=this.transform;this.setTransform(new X(t,r,e))}getSizeInWorldSpace(){return A.getSizeInWorldSpace(this)}getSizeInOutputSpace(){return A.getSizeInOutputSpace(this,this.engine.getOutputContainer())}setSizeInWorldSpace(e){let t=this.getBounds();this.setScale(e.width/t.width,e.height/t.height)}setSizeInOutputSpace(e){let t=this.engine.getOutputContainer().getScale();this.setSizeInWorldSpace({width:e.width/t.x,height:e.height/t.y})}isValid(){return this.getIndexInParent()!==-1}setPivotInternal(e,t){let r=this.getBounds();typeof e=="number"?this.setBoundsFromSize(r.width,r.height,{x:e,y:t}):this.setBoundsFromSize(r.width,r.height,e)}setBoundsFromSize(e,t,r=this.getPivot()){this.bounds=new _t(-r.x*e,-r.y*t,e,t)}};var Ol=class extends ri{constructor(e,t){super(t);this.type="drawing";this.drawing=e,this.operation=t.createSpriteOperation(),this.sprite=this.operation.createBrush({}),this.operation.addSprite(this.sprite),this.radialBrush=this.sprite._createRadialBrush();let o=t.getRootContainers()[0].getBounds();this.bounds=new _t(0,0,o.width,o.height),this.setTransform(X.IDENTITY),this.operation.setDirty(!0),this.setData(e)}beginStroke(e){if(this.currentStroke)throw new Error("A brush stroke has already been started but not finished.");if(e.id!=="imgly_brush_radial")throw new Error("This adapter does not support any brush faces other than the radial img.ly brush.");this.currentBrush=e,this.currentStroke={brush:e,path:{controlPoints:[]}},this.radialBrush.setColor(St(e.color)),this.radialBrush.setHardness(e.hardness),this.radialBrush.setSize(e.size),this.currentPath=this.sprite.createPath(this.radialBrush.clone())}addPointToCurrentStroke(e,t=!0){if(!this.currentStroke||!this.currentBrush||!this.currentPath)throw new Error('A brush stroke has to first be started with a call to "beginStroke(brush:Brush)"');if(this.currentStroke.path.controlPoints.length){let c=this.currentStroke.path.controlPoints,p=c[c.length-1],m=this.currentBrush.size/10;if(Math.sqrt(e.x-p.x**2+(e.y-p.y**2))<m)return}let r=this.engine.getOutputContainer(),o=this.engine.getRootContainers()[0],n=A.pointFromSpaceToSpace(e,o,r,!0),s=A.absoluteToRelativePoint(n,r,!1),l=r.getBounds();this.currentPath.addControlPoint(K.fromObject(s)),this.currentStroke.path.controlPoints.push(e),t&&this.sprite.render(K.fromObject({x:l.width,y:l.height}))}endStroke(){if(!this.currentStroke||!this.currentPath||!this.currentBrush)return;this.currentStroke.path.controlPoints.length&&this.drawing.strokes.push(this.currentStroke),this.currentStroke=void 0,this.currentBrush=void 0,this.currentPath.setClosed(!0);let e=this.engine.getOutputContainer().getBounds();this.sprite.render(K.fromObject({x:e.width,y:e.height})),this.currentPath=void 0}setData(e){this.drawing=f(f({},this.drawing),e),this.drawing.strokes&&(this.drawing.strokes=[]),this.sprite.clearPersistCanvas(),this.sprite.clearCanvas(),this.sprite.setPaths([]),this.drawStrokes(e.strokes)}getData(){return this.drawing}updateData(){this.setData(this.getData())}getOperation(){return this.operation}drawStrokes(e){e.forEach(t=>{this.beginStroke(t.brush),t.path.controlPoints.forEach(r=>{this.addPointToCurrentStroke(r,!0)}),this.endStroke()})}};var Tl=class extends nt{constructor(e,t,r,o){super(o);this.filterOperation=t;this.type="duotone-filter";t.set({intensity:r.colorIntensity}),t.set({filter:e}),o.pesdk.setAllOperationsToDirty()}getProperties(){return{colorIntensity:this.filterOperation.getOptions().intensity}}setProperties(e){let r=this.filterOperation.getOptions().intensity;e.colorIntensity!==void 0&&(r=Math.min(Math.max(e.colorIntensity,0),1)),this.filterOperation.set({intensity:r})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}};var Pl=class{constructor(e,t){this.engine=t;this.loaded=!1;this.loading=!1;this.asset=f({},e)}load(){return C(this,null,function*(){if(this.loaded)return Promise.resolve();if(this.loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this.loading=!0;let{imageGroups:e}=this.asset,t=[];return["top","left","right","bottom"].forEach(r=>{if(!e[r])return;let o=e[r];["start","mid","end"].forEach(n=>{n in o&&t.push(this.loadPart(r,n))})}),Promise.all(t).then(()=>{this.loaded=!0,this.loading=!1}).catch(()=>{this.loaded=!1,this.loading=!1})})}getFrame(){return f(f({},this.asset),{defaultName:this.asset.name,thumbnail:this.asset.thumbnailURI})}getIdentifier(){return this.asset.identifier}getDefaultName(){return this.asset.name}getThumbnail(){return this.asset.thumbnailURI}getTintable(){return this.asset.tintable||!1}getLayoutMode(){return this.asset.layoutMode}getImageGroups(){return this.asset.imageGroups}loadPart(e,t){return C(this,null,function*(){return new Promise((r,o)=>{let{imageGroups:n}=this.asset,s=n[e][t],l=s;typeof s!="string"&&"image"in s&&(l=s.image);let c=new Image;c.addEventListener("load",()=>{typeof s!="string"?this.asset.imageGroups[e][t].image=c:this.asset.imageGroups[e][t]=c,r(c)}),c.addEventListener("error",()=>{o(new Error(`Failed to load image at ${c.src}`))}),c.crossOrigin=this.engine.configuration.crossOrigin||"anonymus",c.src=this.engine.assetProvider.getAssetSource("frame",l)})})}};var Ml=class extends nt{constructor(e,t,r){super(r);this.frameOperation=e;this.type="frame";this.setProperties(t),r.pesdk.setAllOperationsToDirty()}setProperties(e){if(this.props=f(f({},this.props),e),typeof e.opacity=="number"&&this.frameOperation.set({alpha:e.opacity}),e.tintColor&&this.frameOperation.set({tintColor:St(e.tintColor)}),e.width){let t=this.engine.getOutputContainer().getBounds(),r=Math.min(t.width,t.height),o=e.width/r;this.frameOperation.set({scale:o})}this.frameOperation.setDirty(!0)}getProperties(){return this.props}getOperation(){return this.frameOperation}getTypeIdentifier(){return"frame"}};var Bl=class extends nt{constructor(e,t,r){super(t);this.blurOperation=r;this.type="gaussian-blur";this.setProperties(e)}getProperties(){let e=this.engine.getOutputContainer(),t=e.getBounds(),r=Math.min(t.size.width,t.size.height);return{blurRadius:A.scalarFromSpaceToSpace(this.blurOperation.getOptions().blurRadius*r,e,this.getContainer())}}setProperties(e){if(e.blurRadius!==void 0){let t=this.engine.pesdk.getOutputDimensions(),r=Math.min(t.x,t.y),o=this.getContainer(),n=this.engine.getOutputContainer(),l=A.scalarFromSpaceToSpace(e.blurRadius,o,n)/r;this.blurOperation.set({blurRadius:l})}}getOperation(){return this.blurOperation}getTypeIdentifier(){return"blur"}};var zl=class extends ri{constructor(e,t){super(t);this.data=e;this.type="image";let r=t.configuration.downscaleOptions;if(!r)this.downscaleOptions={maxDimensions:{width:t.maxTextureDimension,height:t.maxTextureDimension}};else{let{maxDimensions:n}=r;this.downscaleOptions={maxMegaPixels:r.maxMegaPixels,maxDimensions:{width:Math.min(t.maxTextureDimension,n?n.width:Number.MAX_VALUE),height:Math.min(t.maxTextureDimension,n?n.height:Number.MAX_VALUE)}}}this.setData(e);let{image:o}=this.data;this.bounds=new _t(_.ZERO,{width:o.width,height:o.height})}setData(e){if(this.data=f(f({},this.data),e),e.image){let{image:t}=e,r;if(t instanceof HTMLImageElement&&(r=this.engine.pesdk.parseExif(t),r)){let n=r.getTags();if(n&&n.Orientation){let s=n.Orientation!==1&&n.Orientation!==2,l=[2,4,5,7].indexOf(n.Orientation)!==-1;if(s||l){if(Me()||ti()||!CSS.supports("image-orientation","from-image")){let c=this.engine.pesdk.createOperation("exif-orientation",{},!1);c.setTags(n),t=c.applyTo(t)}r.setOrientation(1),n.Orientation=1}}}let o=new Gn(t,this.downscaleOptions);o.on(Ji.IMAGE_DOWNSCALED,({width:n,height:s})=>{this.engine.emit(Yr.IMAGE_DOWNSCALED,{width:n,height:s})}),o.on(Ji.BEGAN_IMAGE_DOWNSCALING,()=>{this.engine.emit(Yr.BEGAN_IMAGE_DOWNSCALING)}),t=o.downscaleIfNecessary(),this.data.image=t,this.engine.pesdk.setImage(t,r),this.setBoundsFromSize(t.width,t.height)}}getData(){return this.data}setPivot(e,t){throw new Error("This container does not support modifying the pivot")}getOperation(){throw new Error("This container has no associated operation")}};var Ll=class extends nt{constructor(e,t,r){super(t);this.props=e;this.blurOperation=r;this.type="linear-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=f(f({},this.props),e);let t=this.blurOperation.getOptions(),r=this.engine.getOutputContainer(),o=r.getBounds(),n=this.getContainer(),s=r.getBaseLocalToParentMatrix(),l=A.getBaseLocalToWorldMatrix(n),c=$.multiply($.getInverted(s),l),p=Math.min(o.size.width,o.size.height);if(e.blurRadius!==void 0){let m=A.scalarFromSpaceToSpace(e.blurRadius,n,r);t.blurRadius=m/p}if(e.start!==void 0){let m=$.transformPoint(c,e.start),h=A.absoluteToRelativePoint(m,r,!1);t.controlPoint1=h}if(e.end!==void 0){let m=$.transformPoint(c,e.end),h=A.absoluteToRelativePoint(m,r,!1);t.controlPoint2=h}this.blurOperation.set(t)}updateProperties(){let e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"linear-focus"}};var Ul=class extends nt{constructor(e,t,r,o){super(o);this.filter=e;this.filterOperation=t;this.props=r;this.type="lut-filter";t.set({intensity:r.intensity}),t.set({filter:e}),o.pesdk.setAllOperationsToDirty()}getProperties(){return{intensity:this.filterOperation.getOptions().intensity,lutImage:this.props.lutImage,horizontalTileCount:this.props.horizontalTileCount,verticalTileCount:this.props.verticalTileCount}}setProperties(e){let t=this.filterOperation.getOptions(),r=typeof e.intensity=="number"?e.intensity:t.intensity;this.filterOperation.set({intensity:r})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}};var Nl=class extends nt{constructor(e,t,r){super(t);this.props=e;this.blurOperation=r;this.type="mirrored-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=f(f({},this.props),e);let t=this.blurOperation.getOptions(),r=this.engine.getOutputContainer(),o=r.getBounds(),n=this.getContainer(),s=r.getBaseLocalToParentMatrix(),l=A.getBaseLocalToWorldMatrix(n),c=$.multiply($.getInverted(s),l),p=Math.min(o.size.width,o.size.height);if(e.blurRadius!==void 0){let m=A.scalarFromSpaceToSpace(e.blurRadius,n,r);t.blurRadius=m/p}if(e.gradientSize!==void 0){let h=A.scalarFromSpaceToSpace(e.gradientSize,n,r)/p;t.gradientSize=h}if(e.clearAreaWidth!==void 0){let h=A.scalarFromSpaceToSpace(e.clearAreaWidth,n,r)/p;t.size=h*.5}if(e.mirrorAxisOrigin!==void 0){let m=$.transformPoint(c,e.mirrorAxisOrigin),h=A.absoluteToRelativePoint(m,r,!1);t.start=h}if(e.mirrorAxisDirection!==void 0){let m=$.transformPoint(c,e.mirrorAxisDirection),h=A.absoluteToRelativePoint(m,r,!1);t.end=h}this.blurOperation.set(t)}updateProperties(){let e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"mirrored-focus"}};var Hl=class extends ri{constructor(e,t,r,o){super(o);this.settings=e;this.operation=t;this.flipOperation=r;this.type="output";this.flipTransform=$.IDENTITY;this.blockTransformUpdate=!1;this.transformUpdateWhileBlock=!1;this.bounds=new _t({x:0,y:0},this.settings.resolution),this.setData(e)}pauseChildrenUpdates(){this.transformUpdateWhileBlock=!1,this.blockTransformUpdate=!0}resumeChildrenUpdates(){this.blockTransformUpdate=!1,this.transformUpdateWhileBlock&&this.updateChildrenContainers()}setData(e){if(this.settings=f(f({},this.settings),e),e.resolution&&(this.setBoundsFromSize(e.resolution.width,e.resolution.height),this.setTransform(this.transform),this.operation.set({outputResolution:new K(e.resolution.width,e.resolution.height)})),e.flipHorizontally!==void 0){let t=e.flipHorizontally;this.updateFlipTransform(),this.flipOperation.set({flipHorizontally:t})}if(e.flipVertically!==void 0){let t=e.flipVertically;this.updateFlipTransform(),this.flipOperation.set({flipVertically:t})}this.operation.setDirty(!0),this.flipOperation.setDirty(!0)}getData(){return this.settings}setResolution(e){this.setData({resolution:e})}getResolution(){return this.getData().resolution}setTransform(e){if(this.transform.rotation!==e.rotation||this.transform.position!==e.position||this.transform.scale!==e.scale){this.transform=e;let t=this.flipTransform;this.flipTransform=$.IDENTITY;let r=this.engine.getRootContainers()[0],o=A.pointFromSpaceToSpace({x:0,y:0},r,this),n=-e.rotation,s=K.fromObject(o).clone().subtract(K.fromObject(this.getBounds().origin));this.operation.set({pivot:new K(0,0),position:s,scale:new K(1/e.scale.x,1/e.scale.y),rotation:n}),this.flipTransform=t,this.operation.setDirty(!0),this.updateChildrenContainers()}}rotate90(e=!1){let t=e?-Math.PI*.5:Math.PI*.5,r=this.getResolution(),o=this.getPivot(),n=this.getBounds(),s={x:n.midX,y:n.midY},l=A.getPointInWorldSpace(s,this);this.setPivot(.5,.5),this.setPosition(l),this.setRotation(this.getRotation()-t);let c={width:r.height,height:r.width};this.setResolution(c);let p={x:-c.width*(.5-o.x),y:-c.height*(.5-o.y)},m=A.getPointInWorldSpace(p,this);this.setPivot(o),this.setPosition(m),this.updateChildrenContainers()}setPivot(e,t){super.setPivotInternal(e,t),this.setTransform(this.transform)}getTransform(){return this.transform}getBaseLocalToParentMatrix(){return A.rectTransformToAffineTransform(this.getTransform())}getLocalToParentMatrix(){let e=A.rectTransformToAffineTransform(this.getTransform());return $.multiply(e,this.flipTransform)}getFlipTransformMatrix(){return this.flipTransform}isValid(){return!0}getOperation(){return this.operation}updateFlipTransform(){let{flipHorizontally:e,flipVertically:t}=this.settings;if(!e&&!t)this.flipTransform=$.IDENTITY;else{let r=this.getPivot(),o=this.getBounds(),n=e?-1:1,s=e?-2*(r.x-.5)*o.width:0,l=t?-1:1,c=t?-2*(r.y-.5)*o.height:0;this.flipTransform=new $(n,0,0,l,s,c)}}updateChildrenContainers(){if(this.blockTransformUpdate){this.transformUpdateWhileBlock=!0;return}this.engine.rootOperations.forEach(e=>{Fl(e)?(e.updateTransform(),"updateData"in e&&e.updateData()):"updateProperties"in e&&e.updateProperties()})}};var Xn=class extends nt{constructor(e,t,r){super(r);this.overlayOperation=e;this.type="overlay";let o=t.blendMode||r.mapBlendMode(e.getBlendMode());e.set({blendMode:r.reverseMapBlendMode(o)}),e.set({image:t.image}),r.pesdk.setAllOperationsToDirty()}getProperties(){let e=this.overlayOperation.getOptions();return{image:e.image,blendMode:this.engine.mapBlendMode(e.blendMode),opacity:e.alpha}}setProperties(e){let t=this.overlayOperation.getOptions();typeof e.opacity=="number"&&(t.alpha=e.opacity),e.blendMode!==void 0&&(t.blendMode=this.engine.reverseMapBlendMode(e.blendMode)),this.overlayOperation.set(t),this.overlayOperation.setDirty(!0)}getOperation(){return this.overlayOperation}getTypeIdentifier(){return"overlay"}setFlipHorizontally(e){this.overlayOperation.setFlipHorizontally(e)}setFlipVertically(e){this.overlayOperation.setFlipVertically(e)}getFlipHorizontally(){return this.overlayOperation.getFlipHorizontally()}getFlipVertically(){return this.overlayOperation.getFlipVertically()}};var Wl=class extends nt{constructor(e,t,r){super(t);this.props=e;this.blurOperation=r;this.type="radial-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=f(f({},this.props),e);let t=this.blurOperation.getOptions(),r=this.engine.getOutputContainer(),o=r.getBounds(),n=this.getContainer(),s=r.getBaseLocalToParentMatrix(),l=A.getBaseLocalToWorldMatrix(n),c=$.multiply($.getInverted(s),l),p=Math.min(o.size.width,o.size.height);if(e.blurRadius!==void 0){let m=A.scalarFromSpaceToSpace(e.blurRadius,n,r);t.blurRadius=m/p}if(e.center!==void 0){let m=$.transformPoint(c,e.center),h=A.absoluteToRelativePoint(m,r,!1);t.position=h}if(e.radius!==void 0){let h=A.scalarFromSpaceToSpace(e.radius,n,r)/p;t.radius=h}if(e.gradientSize!==void 0){let h=A.scalarFromSpaceToSpace(e.gradientSize,n,r)/p;t.gradientRadius=h}this.blurOperation.set(t)}updateProperties(){let e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"radial-focus"}};var Jn=class extends ri{constructor(e,t){super(t);this.data=e;this.type="sticker";let r=e.image,o=this.engine.pesdk.parseExif(e.image);if(o){let s=o.getTags();if(s&&s.Orientation){let l=s.Orientation!==1&&s.Orientation!==2,c=[2,4,5,7].indexOf(s.Orientation)!==-1;if(l||c){let p=this.engine.pesdk.createOperation("exif-orientation",{},!1);p.setTags(s),r=p.applyTo(e.image),o.setOrientation(1),s.Orientation=1}}}r=new Gn(r,{maxMegaPixels:{desktop:10,mobile:5}}).downscaleImageIfNecessary(),this.operation=t.createSpriteOperation(),this.sprite=this.operation.createSticker({identifier:"",image:r,position:new K(0,0),dimensions:new K(1,1),rotation:0,smoothDownscaling:!1}),this.operation.addSprite(this.sprite),this.bounds=new _t({x:0,y:0},{width:r.width,height:r.height}),this.setTransform(X.IDENTITY),this.sprite.setPivot(new K(0,0)),this.operation.setDirty(!0),this.setData(e)}setData(e){this.data=f(f({},this.data),e),e.id&&(this.id=e.id),Ve(e.opacity)&&e.opacity>=0&&this.sprite.setAlpha(e.opacity),e.tintColor&&this.sprite.setTintColor(St(e.tintColor)),e.tintMode&&this.sprite.setTintMode(e.tintMode),this.operation.setDirty(!0)}getData(){return this.data}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);let t=this.engine.getOutputContainer(),r=this.getParent(),o={width:this.bounds.width*e.scale.x,height:this.bounds.height*e.scale.y},n=A.sizeFromSpaceToSpace(o,r,t);this.sprite.setDimensions(K.fromSize(n));let s=A.pointFromSpaceToSpace(e.position,r,t,!0),l=A.absoluteToRelativePoint(s,t,!1);this.sprite.setPosition(new K(l.x,l.y));let c=A.getRotationBetweenCoordinateSpaces(r,t),p=e.rotation+c;this.sprite.setRotation(p),this.operation.setDirty(!0)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}};var Zi=i=>2*Math.PI-i,Bp=i=>-i,Qi=({rotation:i,flipHorizontally:e,flipVertically:t})=>{let r=i;return e&&(r=Zi(r)),t&&(r=Bp(r)),r};function zp(i,e){if(e){let t=1/e.unitsPerEm*i,r=e.ascender*t,o=e.descender*t;return r+Math.abs(o)}return i*1.1}var Xr=class{constructor(e){this.context=e;this.sourceLines=[];this.maxWidth=100}static buildWords(e){let t=[],r="",o=e.length;for(let n=0;n<o;n+=1){let s=e[n];r+=s,(s===" "||s==="-"||n===o-1)&&(t.push(r),r="")}return t}getLines(){let e=[],t=[],r=this.sourceLines.length;for(let o=0;o<r;o+=1){let n=this.sourceLines[o],s=Xr.buildWords(n),l=s.length;for(let c=0;c<l;c+=1){let p=s[c],m=t.concat(p).join("").replace(/\s+$/i,"");if(this.getWidth(m)>this.maxWidth){t.length>0&&(e.push(t.join("")),t=[p]);let b=p.replace(/\s+$/i,"");if(this.getWidth(b)>this.maxWidth){let v=this.splitWord(p);e=e.concat(v.lines),v.rest&&(t=[v.rest])}}else t.push(p)}e.push(t.join("")),t=[]}return e}splitWord(e){let t={lines:[],rest:null},r=e.length,o=[];for(let n=0;n<r;n+=1){let s=e[n];this.getWidth(o.concat(s).join(""))>this.maxWidth?(o.length>0&&t.lines.push(o.join("")),o=[s]):o.push(s),n===r-1&&o.length>0&&(t.rest=o.join(""))}return t}getWidth(e){return this.context.measureText(e).width}setText(e){this.sourceLines=e.split(`
`)}setMaxWidth(e){this.maxWidth=e}};function er(i,e,t,r,o,n,s){i.font=`${t.fontStyle||"normal"} ${t.fontWeight||"normal"} ${r}px "${t.fontFamily}"`;let l=new Xr(i);l.setText(e),l.setMaxWidth(n);let c=l.getLines().map(b=>b.replace(/\s+$/i,"")),p=zp(r,s),m=p*o,h=p/5;return{width:n+h*2,height:c.length*m+h*2}}var Nt=class extends ri{constructor(e,t){super(t);this.text=e;this.type="text";if(!Nt.measureContext){let c=document.createElement("canvas");Nt.measureContext=c.getContext("2d")}this.operation=t.createSpriteOperation();let r=this.engine.getOutputContainer(),o=this.getParent(),n=r.getBounds();this.sprite=this.operation.createText({text:e.text,position:new K(0,0),rotation:0,fontSize:A.scalarFromSpaceToSpace(e.fontSize/n.height,o,r),lineHeight:e.lineHeight,fontIdentifier:e.fontIdentifier,alignment:e.alignment,color:St(e.textColor),backgroundColor:St(e.backgroundColor),maxWidth:A.scalarFromSpaceToSpace(e.width/n.width,o,r)});let s=t.assetProvider.getFontManager().getFontWithId(e.fontIdentifier);this.sprite.setFontFamily(s.fontFamily),this.sprite.setFontWeight(s.fontWeight||"normal"),this.sprite.setFontStyle(s.fontStyle||"normal"),this.sprite.setFontIdentifier(s.identifier),this.sprite.setTextMetrics(s.textMetrics),this.sprite.setPivot(new K(0,0)),this.operation.addSprite(this.sprite);let l=er(Nt.measureContext,e.text,s,e.fontSize,e.lineHeight,e.width,s.textMetrics);this.bounds=new _t(0,0,l.width,l.height),this.setTransform(X.IDENTITY),this.operation.setDirty(!0)}setData(e){this.text=f(f({},this.text),e);let t=this.engine.assetProvider.getFontManager().getFontWithId(e.fontIdentifier||this.text.fontIdentifier);if(e.fontIdentifier&&(this.sprite.setFontFamily(t.fontFamily),this.sprite.setFontWeight(t.fontWeight||"normal"),this.sprite.setFontStyle(t.fontStyle||"normal"),this.sprite.setFontIdentifier(t.identifier),this.sprite.setTextMetrics(t.textMetrics)),e.id&&(this.id=e.id),e.text&&this.sprite.setText(e.text),e.fontSize){let o=this.engine.getOutputContainer(),n=this.getParent(),s=A.scalarFromSpaceToSpace(e.fontSize,n,o),l=o.getBounds();this.sprite.setFontSize(s/l.height)}if(e.alignment&&this.sprite.setAlignment(e.alignment),e.lineHeight&&this.sprite.setLineHeight(e.lineHeight),e.textColor&&this.sprite.setColor(St(e.textColor)),e.backgroundColor&&this.sprite.setBackgroundColor(St(e.backgroundColor)),e.width){let o=this.engine.getOutputContainer(),n=this.getParent(),s=A.scalarFromSpaceToSpace(e.width,n,o),l=o.getBounds();this.sprite.setMaxWidth(s/l.width)}let r=er(Nt.measureContext,this.text.text,t,this.text.fontSize,this.text.lineHeight,this.text.width,t.textMetrics);this.setBoundsFromSize(r.width,r.height),this.operation.setDirty(!0)}getData(){return this.text}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);let t=this.engine.getOutputContainer(),r=this.getParent(),o=A.pointFromSpaceToSpace(e.position,r,t,!0),n=A.absoluteToRelativePoint(o,t,!1);this.sprite.setPosition(new K(n.x,n.y));let s=A.getRotationBetweenCoordinateSpaces(r,t);this.sprite.setRotation(e.rotation+s),this.operation.setDirty(!0)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setRotation(this.getFlippedRotation({flipHorizontally:e})),this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setRotation(this.getFlippedRotation({flipVertically:e})),this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}getFlippedRotation({flipVertically:e,flipHorizontally:t}){let r=e||this.getFlipVertically(),o=t||this.getFlipHorizontally(),n=this.getRotation();return(r||o)&&(n=Zi(n)),n}};var Zn=1e3,Ci=class extends ri{constructor(e,t,r){super(r);this.textDesign=e;this.layout=t;this.type="text-design";this.currentLayoutSize=void 0;this.layoutID=t.identifier,this.operation=r.createSpriteOperation();let o=this.engine.getOutputContainer(),n=this.getParent(),s=o.getBounds(),l=Math.min(s.width,s.height);t.seed(e.seed),this.bounds=this.calculateBounds(this.textDesign,this.layout);let c=e.width;this.sprite=this.operation.createTextDesign({text:e.text,layout:t,inverted:e.inverted,color:St(e.color),width:A.scalarFromSpaceToSpace(e.width/l,n,o),padding:e.padding/c,seed:e.seed}),this.updatePivot(),this.operation.addSprite(this.sprite),this.setTransform(X.IDENTITY),this.operation.setDirty(!0)}static stringify(e){return JSON.stringify(e,Ci.serializer())}static serializer(){let e=[],t=[],r=(o,n)=>e[0]===n?"[Circular ~]":`[Circular ~.${t.slice(0,e.indexOf(n)).join(".")}]`;return function(n,s){let l=this;if(e.length>0){let c=e.indexOf(l);~c?(e.splice(c+1),t.splice(c,Infinity,n)):(e.push(l),t.push(n)),~e.indexOf(s)&&(s=r.call(l,n,s))}else e.push(s);return s}}calculateBounds(e,t,r=!0){let o=e.inverted&&r?Math.max(0,2*e.padding):0,n=e.width/Zn;if(this.currentLayoutSize===void 0){t.seed(e.seed);let s=t.generateLayoutData(e.text,Zn);this.currentLayoutData=s,this.currentLayoutSize=s.getSize()}return new _t(0,0,this.currentLayoutSize.width*n+o,this.currentLayoutSize.height*n+o)}findNextUniqueSeed(e,t,r){let o=r,n=this.currentLayoutData?Ci.stringify(this.currentLayoutData.getRows()):"",s;for(let l=0;l<20&&(t.seed(o),s=t.generateLayoutData(e.text,Zn),n===Ci.stringify(s.getRows()));l+=1)o+=1;return t.seed(o),this.currentLayoutData=s,o}setData(e){if(this.textDesign=f(f({},this.textDesign),e),e.id&&(this.id=e.id),e.padding!==void 0){let t=this.textDesign.width;this.sprite.setPadding(e.padding/t)}else e.width&&(this.textDesign.padding=this.sprite.getPadding()*this.textDesign.width);if(e.seed!==void 0&&(e.seed<0&&(e.seed=this.findNextUniqueSeed(this.textDesign,this.layout,Date.now()),this.textDesign.seed=e.seed),this.currentLayoutSize=void 0,this.layout.seed(e.seed),this.sprite.setSeed(e.seed),this.sprite.setLayout(this.layout)),e.color&&this.sprite.setColor(St(e.color)),e.inverted!==void 0&&this.sprite.setInverted(e.inverted),e.text&&(this.currentLayoutSize=void 0,this.sprite.setText(e.text)),e.width){let t=this.engine.getOutputContainer(),r=this.getParent(),o=t.getBounds(),n=Math.min(o.width,o.height),s=A.scalarFromSpaceToSpace(e.width/n,r,t);this.sprite.setWidth(s)}if(e.padding!==void 0||e.seed!==void 0||e.inverted!==void 0||e.text||e.width){let t=this.calculateBounds(this.textDesign,this.layout);this.setBoundsFromSize(t.width,t.height),this.updatePivot()}this.operation.setDirty(!0)}getData(){return this.textDesign}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);let t=this.engine.getOutputContainer(),r=this.getParent();if(e.scale.x!==1||e.scale.y!==1)throw new Error("This engine doesn't support scaling TextDesign containers! You can change the bounds using the width property of the TextDesign data.");let o=A.pointFromSpaceToSpace(e.position,r,t,!0),n=A.absoluteToRelativePoint(o,t,!1);this.sprite.setPosition(new K(n.x,n.y));let s=A.getRotationBetweenCoordinateSpaces(r,t);this.sprite.setRotation(e.rotation+s),this.operation.setDirty(!0)}setPivot(e,t){typeof e=="number"?super.setPivot(e,t):super.setPivot(e),this.updatePivot()}getOperation(){return this.operation}getLayoutID(){return this.layoutID}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}updatePivot(){let e=this.textDesign.inverted?Math.max(0,this.textDesign.padding):0,t=new _(this.bounds.width-2*e,this.bounds.height-2*e),r=this.getPivot(),o=new _(r.x*this.bounds.width,r.y*this.bounds.height),n=new _(e,e),l=o.subtract(n).divide(t);this.sprite.setPivot(new K(l.x,l.y))}};var Jr="imgly_font_open_sans_bold",tr=class extends Al{constructor(e){super(e);this.previews=Array();this.rootOperationStack=[];this.deferredRenderQueue=[];this.operationStackOffset=1;this.enforceOperationOrder=()=>{this.refreshFlipIndex(),this.refreshFrameIndex()};if(this.assetProvider=e.assetProvider||new qr,this.wrapper=new Py({license:e.license,crossOrigin:e.crossOrigin,assets:{resolver:(t,r)=>this.resolveAssetForSDK(t,r)},editor:{preferredRenderer:e.preferredRenderer,pixelRatio:1}}),this.editor=this.wrapper.getEditor(),this.sdk=this.editor.getSDK(),this.sdk.setRenderMode("adapter"),this.tempCanvas=document.createElement("canvas"),this.sdk.setCanvas(this.tempCanvas),e.preferredRenderer==="webgl"){let t=document.createElement("canvas"),r=t.getContext("webgl")||t.getContext("experimental-webgl");this.maxTextureDimension=r.getParameter(r.MAX_TEXTURE_SIZE)}else this.maxTextureDimension=Infinity}get configuration(){return this.config}get pesdk(){return this.sdk}get rootOperations(){return this.rootOperationStack}dispose(){this.pesdk.dispose(),this.wrapper.dispose()}render(e){return new Promise(t=>{let r=()=>new Promise(o=>{let{canvas:n}=e,s=e.getTransform(),l=this.outputContainer.getPivot(),c=e.getCanvasBounds(),p=e.quality,{tempCanvas:m}=this;this.sdk.setTextureQuality(p);let h=this.sdk.getOutputDimensions();return m.width=h.x,m.height=h.y,this.sdk.getRenderer().resizeTo(new K(m.width,m.height)),this.sdk.render(!0).then(()=>{let b=n.getContext("2d");b.clearRect(0,0,n.width,n.height),b.save(),b.translate(-c.minX,-c.minY),b.translate(s.position.x,s.position.y),b.rotate(s.rotation),b.scale(s.scale.x,s.scale.y),b.translate(-l.x*m.width,-l.y*m.height),b.scale(1/e.quality,1/e.quality),b.drawImage(m,0,0),b.restore(),t(),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?(this.sdk.setAllOperationsToDirty(),Promise.resolve(this.deferredRenderQueue[0]().then(o))):o()})});this.deferredRenderQueue.push(r),this.deferredRenderQueue.length===1&&r()})}createPreview(e){let t=new Il(e,this);return this.previews.push(t),t}export(){return C(this,arguments,function*(e=$e.IMAGE,t=Be.PNG,r=1){return new Promise(o=>{let n=()=>new Promise(s=>this.sdk.export(this.mapToRenderType(e),this.mapToImageFormat(t),r).then(l=>{o(l),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?Promise.resolve(this.deferredRenderQueue[0]().then(s)):s()}));this.deferredRenderQueue.push(n),this.deferredRenderQueue.length===1&&n()})})}getRootContainers(){return[this.rootContainer]}getOutputContainer(){return this.outputContainer}findContainerByID(e){return e===this.rootContainer.getID()?this.rootContainer:this.rootOperationStack.find(t=>t.getID()===e)}findEffectByID(e){return this.rootOperationStack.find(t=>t.getID()===e)}addImage(e,t,r){if(this.rootContainer)throw new Error("A background image already exists - did you mean to use addSticker?");let o=new zl(e,this);if(this.rootContainer=o,!this.outputContainer){let{width:n,height:s}=o.getBounds(),l={resolution:{width:n,height:s},flipHorizontally:!1,flipVertically:!1},c=this.sdk.createOperation("output",{},!1),p=this.sdk.createOperation("flip",{},!1);this.insertIntoOperationsStack(c,this.operationStackOffset-1),this.insertIntoOperationsStack(p,this.operationStackOffset),this.outputContainer=new Hl(l,c,p,this)}return o}addSticker(e,t,r){if(!t)throw new Error("This engine does not support adding stickers as root elements.");this.ensureContainerIsRoot(t);let o=new Jn(e,this);return this.addToStackAtIndex(o,r),o}addStickerFromAssets(e,t,r){if(!t)throw new Error("This engine does not support adding stickers as root elements.");return this.ensureContainerIsRoot(t),new Promise((o,n)=>{let s=new Image;s.onload=()=>{let l={image:s,opacity:1},c=new Jn(l,this);this.addToStackAtIndex(c,r),o(c)},s.onerror=l=>{n(l)},s.crossOrigin=this.config.crossOrigin||null,s.src=this.assetProvider.getAssetSource("sticker",e)})}addText(e,t,r){if(!t)throw new Error("This engine does not support adding text as root elements.");if(!this.assetProvider.getFontManager().isFontLoaded(e.fontIdentifier||Jr))throw new Error("Adding text synchronously only works if the required font is already loded! Consider using the asynchronous addTextWithFontLoading function instead!");this.ensureContainerIsRoot(t);let n=f({text:"",fontIdentifier:Jr,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},e),s=new Nt(n,this);return this.addToStackAtIndex(s,r),s}addTextWithFontLoading(e,t,r){if(!t)throw new Error("This engine does not support adding text as root elements.");let o=this.assetProvider.getFontManager(),n=e.fontIdentifier||Jr;return new Promise((s,l)=>{o.loadFontWithIdentifier(n).then(()=>{this.ensureContainerIsRoot(t);let c=f({text:"",fontIdentifier:Jr,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},e),p=new Nt(c,this);this.addToStackAtIndex(p,r),s(p)}).catch(l)})}addTextDesignAsync(e="imgly_text_design_blocks",t,r,o){return C(this,null,function*(){if(!r)throw new Error("This engine does not support adding TextDesign as a root element.");let n=f({seed:Date.now(),padding:0,text:"",color:[0,0,0],inverted:!1,width:100},t),s=this.wrapper.getTextDesignLayoutByID(e);if(!s)throw new Error(`The layout could not be loaded for the given id: ${e}`);let l=s.getImagePaths().map(v=>{let x=v.split("/").pop()||"";return{path:v,fullPath:this.assetProvider.getAssetSource("textdesign",x)}}),c=this.wrapper.getTextDesignAssetManager(),m=this.wrapper.getTextDesignFontManager().getVariationsByIdentifier();c.setFonts(m),yield c.loadImages(l),s.onImagesLoaded();let h=Object.keys(m);return this.assetProvider.getFontManager().loadFontsWithIdentifiers(h).then(()=>{this.ensureContainerIsRoot(r);let v=new Ci(n,s,this);return this.addToStackAtIndex(v,o),Promise.resolve(v)})})}addDrawing(e,t,r){if(!t)throw new Error("This engine does not support DrawingContainers as root elements.");this.ensureContainerIsRoot(t);let o=new Ol(e,this);return this.addToStackAtIndex(o,r),o}addGaussianBlur(e,t,r){this.ensureContainerIsRoot(t);let o=new Bl(e,this,this.sdk.createOperation("blur",{},!1));return this.addToStackAtIndex(o,r),o}addRadialBlur(e,t,r){this.ensureContainerIsRoot(t);let o=new Wl(e,this,this.sdk.createOperation("radial-focus",{},!1));return this.addToStackAtIndex(o,r),o}addMirroredBlur(e,t,r){this.ensureContainerIsRoot(t);let o=new Nl(e,this,this.sdk.createOperation("mirrored-focus",{},!1));return this.addToStackAtIndex(o,r),o}addLinearBlur(e,t,r){this.ensureContainerIsRoot(t);let o=new Ll(e,this,this.sdk.createOperation("linear-focus",{},!1));return this.addToStackAtIndex(o,r),o}addDuoToneFilter(e,t,r){throw new Error("Not supported! Use addDuoToneFilterFromAssets instead")}addDuoToneFilterFromAssets(e,t,r){this.ensureContainerIsRoot(t);let n=this.sdk.getOperationsStack().getByIdentifier("filter");if(n&&n.getIdentifier()!==e)throw new Error("This engine doesn't support multiple types of filter operations at once!");let s=n||this.sdk.createOperation("filter",{},!1);return new Promise((l,c)=>{try{let p=this.assetProvider.getDuotoneFilterAsset(e),m={colorIntensity:p.defaultIntensity||0},h=new pe.Operations.FilterOperation.Filters.DuoToneFilter({intensity:m.colorIntensity,lightColor:pe.Color.fromHex(p.lightColor),darkColor:pe.Color.fromHex(p.darkColor)}),b=new Tl(h,s,m,this);this.addToStackAtIndex(b,r),l(b)}catch(p){p&&c(p)}})}addLUTFilter(e,t,r){throw new Error("Not supported! Use addLUTFilterFromAssets instead")}addLUTFilterFromAssets(e,t,r){this.ensureContainerIsRoot(t);let n=this.sdk.getOperationsStack().getByIdentifier("filter");if(n&&n.getIdentifier()!==e)throw new Error("This engine doesn't support multiple types filter operations at once!");let s=n||this.sdk.createOperation("filter",{},!1);return this.getLutFilterImage(e).then(l=>{let c=this.assetProvider.getLUTFilterAsset(e),p={horizontalTileCount:c.horizontalTileCount||5,verticalTileCount:c.verticalTileCount||5,intensity:c.defaultIntensity||1},m=new pe.Operations.FilterOperation.Filters.ThreeDLUTFilter(f(f({},p),{image:l})),h=f(f({},p),{lutImage:new Image}),b=new Ul(m,s,h,this);return this.addToStackAtIndex(b,r),b})}getLutFilterImage(e){return new Promise((t,r)=>{let o=new Image;o.addEventListener("load",()=>{t(o)}),o.addEventListener("error",n=>{r(n)}),o.crossOrigin=this.config.crossOrigin||null,o.src=this.assetProvider.getAssetSource("filter",e)})}addAdjustments(e,t,r){this.ensureContainerIsRoot(t);let o=new Rl(e,this,this.sdk.createOperation("adjustments",{},!1));return this.addToStackAtIndex(o,r),o}addOverlay(e,t,r){this.ensureContainerIsRoot(t);let o=new Xn(this.sdk.createOperation("overlay",{},!1),e,this);return this.addToStackAtIndex(o,r),o}addOverlayFromAssets(e,t,r){return this.ensureContainerIsRoot(t),new Promise((o,n)=>{let s=this.sdk.getOperationsStack(),l=s.getByIdentifier("overlay");l&&l.getIdentifier()!==e&&s.remove(l);let c=l||this.sdk.createOperation("overlay",{},!1),p=new Image;p.onload=()=>{let m={image:p,opacity:1,blendMode:j.NORMAL},h=new Xn(c,m,this);this.addToStackAtIndex(h,r),o(h)},p.onerror=m=>{n(m)},p.crossOrigin=this.config.crossOrigin||null,p.src=this.assetProvider.getAssetSource("overlay",e)})}addFrame(e,t,r){throw new Error("Not supported!")}addFrameFromAssets(e,t,r){return C(this,null,function*(){this.ensureContainerIsRoot(t);let o=this.assetProvider.getFrameAsset(e);if(!o)throw new Error(`The requested asset does not exist! ${e}`);let n=new Pl(o,this);yield n.load();let s=this.getOutputContainer().getBounds(),l=Math.min(s.width,s.height),c=this.sdk.createOperation("frame",{},!1);c.setFrame(n.getFrame());let p={opacity:1,tintColor:[1,1,1],tintable:!1,width:Math.max(1,.1*l),imageGroups:n.getFrame().imageGroups},m=new Ml(c,p,this);return this.addToStackAtIndex(m,r),Promise.resolve(m)})}removeEffect(e){if(!e.isValid())return;let r=e.getOperation();this.sdk.removeOperation(r),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(e.getIndexInParent(),1)}removeContainer(e){if(!e.isValid()||e.type==="output")return;let r=e.getOperation();this.sdk.removeOperation(r),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(e.getIndexInParent(),1)}refreshOutputIndex(){let e=this.sdk.getOperationsStack().getIndexByIdentifier("output");this.moveInOperationsStack(e,this.operationStackOffset-1)}refreshFlipIndex(){let e=this.sdk.getOperationsStack().getIndexByIdentifier("flip"),t=this.sdk.getOperationsStack().getStack().length-1;e!==t&&this.moveInOperationsStack(e,t)}refreshFrameIndex(){let e=this.sdk.getOperationsStack().getIndexByIdentifier("frame"),t=this.sdk.getOperationsStack().getStack().length-1;e!==-1&&e!==t&&this.moveInOperationsStack(e,t)}mapToRenderType(e){switch(e){case $e.IMAGE:return pe.RenderType.IMAGE;case $e.DATA_URL:return pe.RenderType.DATAURL;case $e.BLOB:return pe.RenderType.BLOB;case $e.MSBLOB:return pe.RenderType.MSBLOB;default:return pe.RenderType.IMAGE}}mapToImageFormat(e){switch(e){case Be.PNG:return pe.ImageFormat.PNG;case Be.JPEG:return pe.ImageFormat.JPEG;default:return null}}mapBlendMode(e){switch(e){case he.NORMAL:return j.NORMAL;case he.OVERLAY:return j.OVERLAY;case he.HARD_LIGHT:return j.HARD_LIGHT;case he.SOFT_LIGHT:return j.SOFT_LIGHT;case he.MULTIPLY:return j.MULTIPLY;case he.DARKEN:return j.DARKEN;case he.LIGHTEN:return j.LIGHTEN;case he.SCREEN:return j.SCREEN;case he.COLOR_BURN:return j.COLOR_BURN;default:return j.NORMAL}}reverseMapBlendMode(e){switch(e){case j.NORMAL:return he.NORMAL;case j.OVERLAY:return he.OVERLAY;case j.HARD_LIGHT:return he.HARD_LIGHT;case j.SOFT_LIGHT:return he.SOFT_LIGHT;case j.MULTIPLY:return he.MULTIPLY;case j.DARKEN:return he.DARKEN;case j.LIGHTEN:return he.LIGHTEN;case j.SCREEN:return he.SCREEN;case j.COLOR_BURN:return he.COLOR_BURN;default:return he.NORMAL}}createSpriteOperation(){return this.sdk.createOperation("sprite",{},!1)}moveIndex(e,t){let r=this.getSiblingIndex(e);if(r===-1)throw new Error("The item to be moved is not part of any stack.");this.moveInStack(this.rootOperationStack,r,t);let o=this.operationStackOffset;this.moveInOperationsStack(r+o,t+o),this.enforceOperationOrder()}ensureContainerIsRoot(e){if(e.getID()!==this.rootContainer.getID())throw new Error("This engine doesn't support adding this effect/container to anything other than the root image container")}addToStackAtIndex(e,t){if(t&&t<0)throw new Error(`The given index may not be negative: ${t}`);t===void 0?this.rootOperationStack.push(e):this.rootOperationStack.splice(t,0,e);let r=this.rootOperationStack.length-1,o=t!==void 0?t:r;o+=this.operationStackOffset,Mp(e)?this.insertIntoOperationsStack(e.getOperation(),o):this.insertIntoOperationsStack(e.getOperation(),o),this.sdk.setAllOperationsToDirty()}insertIntoOperationsStack(e,t){let r=this.sdk.getOperationsStack().getStack(),o=r.length,n=Math.max(Math.min(t,o),0);for(let s=o-1;s>=n;s-=1){let l=r[s];r[s+1]=l}r[n]=e,this.sdk.setAllOperationsToDirty(),this.enforceOperationOrder()}moveInStack(e,t,r){let o=e.length,n=Math.max(Math.min(t,o-1),0),s=Math.max(Math.min(r,o-1),0);if(n===s)return;let l=e[n];if(n<s)for(let c=n+1;c<=s;c+=1)e[c-1]=e[c];else for(let c=n-1;c>=s;c-=1)e[c+1]=e[c];e[s]=l}moveInOperationsStack(e,t){let r=this.sdk.getOperationsStack().getStack(),o=r.length,n=Math.min(Math.max(0,e),o-1),s=Math.min(Math.max(0,t),o-1);if(n===s)return;let l=r[n];if(n<s)for(let c=n+1;c<=s;c+=1)r[c-1]=r[c];else for(let c=n-1;c>=s;c-=1)r[c+1]=r[c];r[s]=l,this.sdk.getOperationsStack().setAllToDirty()}getSiblingIndex(e){return e.getIndexInParent()}resolveAssetForSDK(e,t){switch(t=t,e){case"filter":return this.assetProvider.getAssetSource("filter",t.identifier);case"overlay":return this.assetProvider.getAssetSource("overlay",t.identifier);case"font":return this.assetProvider.getAssetSource("font",t.identifier)}return""}};var Qn=class{constructor(e){this.isEmpty=!1;this.isValid=!1;this.isWhiteLabel=()=>this.isValid&&this.licenseChecker.isWhiteLabel();this.areCustomAssetsAllowed=()=>this.isEmpty||this.isValid&&this.licenseChecker.areCustomAssetsAllowed();e&&e.length!==0?(this.licenseChecker=new pe.LicenseChecker(e),this.isValid=this.licenseChecker.validate()):e===""&&(this.isEmpty=!0)}isToolAllowed(e){return this.licenseChecker&&this.isValid?this.licenseChecker.isToolAllowed(e):!0}};var es=i=>{let e=Number(i).toString(16);return e.length<2&&(e=`0${e}`),e},jl=(i,e,t)=>{let r=es(i*255),o=es(e*255),n=es(t*255);return`#${r}${o}${n}`},ir=i=>{if(Yn(i)){let[e,t,r,o]=i;return`rgba(${e*255}, ${t*255}, ${r*255}, ${o})`}if(qn(i)){let{r:e,g:t,b:r,a:o}=i;return`rgba(${e*255}, ${t*255}, ${r*255}, ${o})`}if(Kn(i)){let[e,t,r]=i;return jl(e,t,r)}if($n(i)){let{r:e,g:t,b:r}=i;return jl(e,t,r)}return i},Ke=i=>i.map(e=>({identifier:e.name,color:e.color,colorString:ir(e.color)})),xe={black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],gray:[191/255,191/255,191/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]},ts={transparent:[0/255,0/255,0/255,0],black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]};var Zr=[g.LIBRARY,[g.TRANSFORM,g.FILTER,g.ADJUSTMENT],[g.FOCUS,g.FRAME,g.OVERLAY],[g.TEXT,g.TEXT_DESIGN,g.STICKER,g.BRUSH]];var is={license:"",order:"default",language:"en",theme:"dark",layout:"advanced",mainCanvasActions:[de.UNDO,de.REDO,de.EXPORT,de.CLOSE],displayResizeWarning:!1,displayCloseWarning:!0,displayCanvasRendererWarning:!0,displayToolControlBarTitle:!0,engine:{crossOrigin:"anonymous",downscaleOptions:{maxMegaPixels:{desktop:10,mobile:5}},preferredRenderer:vl()?"webgl":"canvas"},enableZoom:!0,forceCrop:!1,assetBaseUrl:"assets/",defaultTool:g.FILTER,tools:Zr,snapping:new xn,filter:new En,focus:new kn,adjustment:new Cn,library:new Fn,overlay:new An,sticker:new Rn,text:new On,textdesign:new Pn,frame:new In,brush:new Tn,transform:new Mn,export:{image:{exportType:$e.IMAGE,format:Be.PNG,quality:.9,enableDownload:!0},filename:"photoeditorsdk-export"},custom:{}};var Qr={[ze.BRIGHTNESS]:0,[ze.SATURATION]:0,[ze.CONTRAST]:0,[ze.GAMMA]:0,[ze.CLARITY]:0,[ze.EXPOSURE]:0,[ze.SHADOWS]:0,[ze.HIGHLIGHTS]:0,[ze.WHITES]:0,[ze.BLACKS]:0,[ze.TEMPERATURE]:0,[ze.SHARPNESS]:0};var wi=class{constructor(){this.snapshots=[];this.observeIndex=S.box(-1)}addSnapshot(e){this.index===this.snapshots.length-1?this.snapshots=this.snapshots.concat(JSON.stringify(e)):this.snapshots=[...this.snapshots.slice(0,this.index+1),JSON.stringify(e)],this.observeIndex.set(this.snapshots.length-1)}getCurrentState(){return this.snapshots[this.index]}reset(){this.snapshots=[],this.observeIndex.set(-1)}undo(){return this.canUndo?(this.observeIndex.set(this.index-1),JSON.parse(this.getCurrentState())):null}redo(){return this.canRedo?(this.observeIndex.set(this.index+1),JSON.parse(this.getCurrentState())):null}discardSnapshotsfromIndex(e){e>0&&e<this.snapshots.length-1&&(this.snapshots=this.snapshots.slice(0,e),this.observeIndex.set(this.snapshots.length-1))}get index(){return this.observeIndex.get()}get canUndo(){return this.index>0}get canRedo(){return this.snapshots.length-1>this.index}};a([u],wi.prototype,"index",1),a([u],wi.prototype,"canUndo",1),a([u],wi.prototype,"canRedo",1);var F;(function(i){i.ADD="add",i.EDIT="edit",i.DELETE="delete"})(F||(F={}));var oi=class{constructor(e){this.localTransformStartIndex=null;this.awaitHistoryChange=!1;this.isDirtySinceSave=!1;this.undo=()=>C(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;let e=this.appHistoryManager.undo();yield this.applyState(e),this.awaitHistoryChange=!1,this.canUndo||(this.isDirtySinceSave=!1)}});this.redo=()=>C(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;let e=this.appHistoryManager.redo();yield this.applyState(e),this.awaitHistoryChange=!1}});this.editor=e,this.appHistoryManager=new wi}get canUndo(){return this.appHistoryManager.canUndo}get canRedo(){return this.appHistoryManager.canRedo}getHistoryState(){let e=k(this.editor.adjustmentsToolStore.state),t=k(this.editor.filterToolStore.state),r=this.editor.focusToolStore.getFocusStateForHistory(),o=k(this.editor.overlayToolStore.state),n=k(this.editor.frameToolStore.state),s=this.editor.brushToolStore.strokes||{strokes:[]},l=this.editor.spriteStore.getSpriteHistoryState(),c=this.editor.transformToolStore.serializableState;return{[g.ADJUSTMENT]:e,[g.FILTER]:t,[g.FOCUS]:r,[g.OVERLAY]:o,[g.FRAME]:n,[g.BRUSH]:s,sprite:l,[g.TRANSFORM]:c}}addInitialSnapshot(){let e=this.getHistoryState();this.appHistoryManager.addSnapshot({state:e,type:F.ADD,description:"Initial State"})}addSnapshot(e=this.getHistoryState(),t,r){e&&((e.sprite||e.transform)&&(e=f(f({},this.getHistoryState()),e)),this.appHistoryManager.addSnapshot({state:e,type:t,description:r}),this.editor.configStore.events.onHistoryChange(),this.isDirtySinceSave||(this.isDirtySinceSave=!0))}saveTransformLocalSnapshotIndex(){this.localTransformStartIndex===null&&(this.localTransformStartIndex=this.appHistoryManager.snapshots.length)}removeTransformLocalSnapshots(){this.localTransformStartIndex!==null&&(this.appHistoryManager.discardSnapshotsfromIndex(this.localTransformStartIndex-1),this.localTransformStartIndex=null)}applyState(t){return C(this,arguments,function*({state:e}){try{if(e){let r=Object.keys(e);for(let o of r)switch(o){case g.FILTER:yield this.editor.filterToolStore.updateStateFromHistory(e[o]);break;case g.ADJUSTMENT:yield this.editor.adjustmentsToolStore.updateStateFromHistory(e[o]);break;case g.OVERLAY:yield this.editor.overlayToolStore.updateStateFromHistory(e[o]);break;case g.FRAME:yield this.editor.frameToolStore.updateStateFromHistory(e[o]);break;case g.FOCUS:yield this.editor.focusToolStore.updateStateFromHistory(e[o],this.editor.canvasStore.sizeVector);break;case g.BRUSH:yield this.editor.brushToolStore.updateStateFromHistory(e[o]);break;case"sprite":yield this.editor.spriteStore.updateStateFromHistory(e[o]);break;case"localTransform":yield this.editor.transformToolStore.updateLocalStateFromHistory(e.localTransform);break;case g.TRANSFORM:this.editor.outputContainer.pauseChildrenUpdates(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(e[o],!1),this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.onLeave(),this.editor.outputContainer.resumeChildrenUpdates(),yield this.editor.wait();break}yield this.editor.renderPromise()}}catch(r){console.error(r),this.editor.modalStore.showActionModal({type:oe.ERROR,identifier:"unexpectedError",error:r,handleConfirm:()=>{window.location.reload()}})}})}isDirty(){return this.appHistoryManager.snapshots.length>1}reset(){this.appHistoryManager.reset(),this.isDirtySinceSave=!1}};a([d],oi.prototype,"undo",2),a([d],oi.prototype,"redo",2),a([u],oi.prototype,"canUndo",1),a([u],oi.prototype,"canRedo",1);var ee=class{constructor(e,t){this.assets=[];this.entityMapper=e=>"items"in e?this.categoryMapper(e):this.itemMapper(e);this.categoryMapper=e=>e?f(f({},e),{thumbnailURI:this.getCategoryURI(e),name:this.config.locale[e.identifier]||e.name,items:e.items.map(this.itemMapper)}):null;this.itemMapper=e=>f(f({},e),{thumbnailURI:this.getItemURI(e),name:this.config.locale[e.identifier]||("name"in e?e.name:"")});this.getCategoryURI=e=>e.thumbnailURI&&(ii(e.thumbnailURI)||e.thumbnailURI.substr(0,10)==="data:image")?e.thumbnailURI:this.config.getAssetPath(e[this.config.categoryKey]||"");this.getItemURI=e=>"thumbnailURI"in e&&(ii(e.thumbnailURI)||e.thumbnailURI.substr(0,10)==="data:image")?e.thumbnailURI:this.config.getAssetPath(e[this.config.itemKey]||"");this.config=t,this.assets=e.map(this.entityMapper).filter(Boolean)}static isCategory(e){return Object.prototype.hasOwnProperty.call(e,"items")}get categories(){return this.assets.reduce((e,t)=>{if(ee.isCategory(t))return[...e,t]},[]).filter(Boolean)}get items(){return this.assets.reduce((e,t)=>ee.isCategory(t)?[...e,...t.items]:[...e,t],[]).filter(Boolean)}};var Dt=class{constructor(e,t){this.from=e,this.to=t}contains(e){return this.from<=e&&e<=this.to}clamp(e){return Math.min(Math.max(this.from,e),this.to)}};var Lp=new Dt(-1,1),Ei=class{constructor(e){this.editAdjustments=({type:e,value:t})=>{let r=Lp.clamp(t);this.state[e]=r};this.reset=()=>{re(()=>{this.indexInContainer===-1&&(Object.keys(Qr).forEach(e=>{this.state[e]=Qr[e]}),this.orderHelper.removeIndex(g.ADJUSTMENT))})};this.setAdjustmentEffect=e=>{let t=this.orderHelper.addIndex(g.ADJUSTMENT);return this.effect?this.effect.setProperties(e):this.effect=this.engineMediator.engine.addAdjustments(e,this.engineMediator.image.container,t),this.effect.getProperties()};this.removeAdjustmentEffect=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))};this.engineMediator=e,this.state=Qr}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get orderHelper(){return this.engineMediator.orderHelper}};a([S],Ei.prototype,"state",2),a([d],Ei.prototype,"editAdjustments",2),a([d],Ei.prototype,"reset",2);var H=class{constructor(e){this.dirty=S.box(!1);this.editAdjustments=({type:e,value:t})=>{this.pureSetAdjustment({type:e,value:t}),this.editor.render()};this.toolSnapshot=()=>{this.dirty.set(!0),this.addSnapshot(F.EDIT,g.ADJUSTMENT)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.toggleOptionSelection=e=>{this.selectedOption=e};this.pureSetAdjustment=({type:e,value:t})=>{let r=this.adjustmentsStore.setAdjustmentEffect({[e]:t});this.adjustmentsStore.editAdjustments({type:e,value:r[e]})};this.pureReset=()=>{this.dirty.set(!1),this.adjustmentsStore.removeAdjustmentEffect(),this.adjustmentsStore.reset(),this.selectedOption=""};this.reset=()=>{this.pureReset(),this.addSnapshot(F.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromHistory=e=>{re(()=>{Object.keys(e).forEach(t=>{this.pureSetAdjustment({type:t,value:e[t]})})})};this.updateStateFromSerialization=e=>{this.updateStateFromHistory(e)};this.editor=e,this.adjustmentsStore=new Ei(this.editor.engineMediator),this.selectedOption="";let t=this.editor.assetProvider.getAssets("adjustment");this.entityManager=new ee(t,f(f({},this.config),{categoryKey:"",itemKey:"thumbnailURI",locale:f(f({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("adjustment")}))}get selectedAdjustmentType(){return this.selectedOption}get isDirty(){return this.dirty.get()}get state(){return this.adjustmentsStore.state}get selectedOptionLabel(){let e=this.items.find(t=>t?t.identifier===this.selectedOption:!1);return e?e.name:""}get brightness(){return this.state.brightness}get saturation(){return this.state.saturation}get contrast(){return this.state.contrast}get gamma(){return this.state.gamma}get clarity(){return this.state.clarity}get exposure(){return this.state.exposure}get shadows(){return this.state.shadows}get highlights(){return this.state.highlights}get whites(){return this.state.whites}get blacks(){return this.state.blacks}get temperature(){return this.state.temperature}get sharpness(){return this.state.sharpness}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}get config(){return this.editor.configStore.config[g.ADJUSTMENT]}get locale(){return this.editor.configStore.locale[g.ADJUSTMENT]}};a([S],H.prototype,"selectedOption",2),a([S],H.prototype,"dirty",2),a([d],H.prototype,"editAdjustments",2),a([d],H.prototype,"toggleOptionSelection",2),a([d],H.prototype,"pureSetAdjustment",2),a([d],H.prototype,"pureReset",2),a([d],H.prototype,"reset",2),a([d],H.prototype,"updateStateFromHistory",2),a([d],H.prototype,"updateStateFromSerialization",2),a([u],H.prototype,"selectedAdjustmentType",1),a([u],H.prototype,"isDirty",1),a([u],H.prototype,"state",1),a([u],H.prototype,"selectedOptionLabel",1),a([u],H.prototype,"brightness",1),a([u],H.prototype,"saturation",1),a([u],H.prototype,"contrast",1),a([u],H.prototype,"gamma",1),a([u],H.prototype,"clarity",1),a([u],H.prototype,"exposure",1),a([u],H.prototype,"shadows",1),a([u],H.prototype,"highlights",1),a([u],H.prototype,"whites",1),a([u],H.prototype,"blacks",1),a([u],H.prototype,"temperature",1),a([u],H.prototype,"sharpness",1),a([u],H.prototype,"categories",1),a([u],H.prototype,"items",1),a([u],H.prototype,"config",1),a([u],H.prototype,"locale",1);var eo={identifier:"identity",intensity:1,isDuotone:!1};var Up=new Dt(0,1),Ht=class{constructor(e){this.changeIdentifier=e=>{this.state.identifier=e};this.changeIfDuotone=e=>{this.state.isDuotone=e};this.changeIntensity=e=>{let t=Up.clamp(e);this.state.intensity=t};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=eo.identifier,this.state.intensity=eo.intensity,this.removeIndex())};this.setFilterEffect=({identifier:e,intensity:t,isDuotone:r})=>{let o=this.state;this.changeIdentifier(e),this.changeIntensity(t),this.changeIfDuotone(r),this.removeFilterEffect();let n=this.engineMediator.orderHelper.addIndex(g.FILTER);return r?new Promise((s,l)=>{this.engineMediator.engine.addDuoToneFilterFromAssets(e,this.engineMediator.image.container,n).then(c=>{this.effect=c,this.effect.setProperties({colorIntensity:t}),s()}).catch(c=>{this.fallbackOnError(o),l(c)})}):new Promise((s,l)=>{this.engineMediator.engine.addLUTFilterFromAssets(e,this.engineMediator.image.container,n).then(c=>{this.effect=c,this.effect.setProperties({intensity:t}),s()}).catch(c=>{this.fallbackOnError(o),l(c)})})};this.removeFilterEffect=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))};this.setEffectProperties=({intensity:e})=>this.effect?(this.state.isDuotone?this.effect.setProperties({colorIntensity:e}):this.effect.setProperties({intensity:e}),this.effect.getProperties()):null;this.removeIndex=()=>{this.engineMediator.orderHelper.removeIndex(g.FILTER)};this.fallbackOnError=e=>{this.changeIdentifier(e.identifier),this.changeIntensity(e.intensity),e.identifier==="identity"&&this.removeIndex()};this.engineMediator=e,this.state=eo}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}};a([S],Ht.prototype,"state",2),a([d],Ht.prototype,"changeIdentifier",2),a([d],Ht.prototype,"changeIfDuotone",2),a([d],Ht.prototype,"changeIntensity",2),a([d],Ht.prototype,"reset",2);var rs="identity",te=class{constructor(e){this.selectFilter=(e,t=1)=>C(this,null,function*(){e!==this.identifier&&(yield this.filterStore.setFilterEffect({identifier:e,intensity:t,isDuotone:this.isOptionDuoTone(e)}),this.editor.render(),this.addSnapshot(F.ADD,g.FILTER))});this.changeIntensity=e=>{let t=this.isOptionDuoTone(this.identifier),r=this.filterStore.setEffectProperties({intensity:e});if(r){let o=t?r.colorIntensity:r.intensity;this.filterStore.changeIntensity(o),this.editor.render()}};this.setImageAndGetPreviews=()=>C(this,null,function*(){let{image:e}=this.editor.activeStore.state;yield this.editor.previewThumbnails.addImageToContainer(e),yield this.getAllFilterPreview()});this.getAllFilterPreview=()=>C(this,null,function*(){let e=this.entityManager.items.map(n=>({identifier:n.identifier,isDuotone:this.isOptionDuoTone(n.identifier)})),t=yield this.editor.previewThumbnails.getAllFilterPreviewThumbnails(e);yield this.editor.wait();let{config:r}=this,o=this.editor.configStore.assetProvider.getAssets("filter").map(n=>f(f({},n),{items:n.items.map(s=>f(f({},s),{thumbnailURI:t[s.identifier]}))}));this.entityManager=new ee(o,f(f({},r),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))});this.toolSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.controls.sliderIntensity)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.pureReset=()=>{this.selectedCategory=rs,this.filterStore.removeFilterEffect(),this.filterStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(F.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory===e?rs:e};this.updateStateFromSerialization=({identifier:e,intensity:t})=>{let r=this.doesFilterAssetExist(e);if(r){let o=$r(r);return this.filterStore.setFilterEffect({identifier:e,intensity:t,isDuotone:o})}return new Promise((o,n)=>{n(new Error(`Filter Asset ${e} doesn't exist`))})};this.updateStateFromHistory=e=>C(this,null,function*(){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.filterStore.setFilterEffect(e)});this.doesFilterAssetExist=e=>this.entityManager.items.find(t=>e===t.identifier);this.isOptionDuoTone=e=>{let t=this.doesFilterAssetExist(e);return t?$r(t):!1};this.editor=e,this.selectedCategory=rs,this.filterStore=new Ht(this.editor.engineMediator);let{config:t}=this,r=this.editor.configStore.assetProvider.getAssets("filter");this.entityManager=new ee(r,f(f({},t),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))}get state(){return this.filterStore.state}get identifier(){return this.state.identifier}get intensity(){return this.state.intensity}get isDuotone(){return this.state.isDuotone}get selectedCategoryIdentifier(){return this.selectedCategory}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[g.FILTER]}get locale(){return this.editor.configStore.locale[g.FILTER]}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}};a([S],te.prototype,"selectedCategory",2),a([S],te.prototype,"entityManager",2),a([d],te.prototype,"selectFilter",2),a([d],te.prototype,"changeIntensity",2),a([d],te.prototype,"pureReset",2),a([d],te.prototype,"reset",2),a([d],te.prototype,"toggleCategorySelection",2),a([d],te.prototype,"updateStateFromSerialization",2),a([d],te.prototype,"updateStateFromHistory",2),a([u],te.prototype,"state",1),a([u],te.prototype,"identifier",1),a([u],te.prototype,"intensity",1),a([u],te.prototype,"isDuotone",1),a([u],te.prototype,"selectedCategoryIdentifier",1),a([u],te.prototype,"isOptionSelected",1),a([u],te.prototype,"config",1),a([u],te.prototype,"locale",1),a([u],te.prototype,"categories",1),a([u],te.prototype,"items",1);function os(i){return i&&typeof i=="object"&&Object.prototype.toString.call(i)!=="[object RegExp]"&&Object.prototype.toString.call(i)!=="[object Date]"}function Np(i){return Array.isArray(i)?[]:{}}function ss(i,e){return e&&e.clone===!0&&os(i)?ns(Np(i),i,e):i}function Hp(i,e,t){let r={};return os(i)&&Object.keys(i).forEach(o=>{r[o]=ss(i[o],t)}),Object.keys(e).forEach(o=>{let n=os(e[o])&&i[o];r[o]=n?ns(i[o],e[o],t):ss(e[o],t)}),r}function ns(i,e,t){return Array.isArray(e)?Array.isArray(i)?e:ss(e,t):Hp(i,e,t)}function Wt(i,e=null){if(!Array.isArray(i)||i.length<2)throw new Error("first argument should be an array with at least two elements");return i.reduce((t,r)=>ns(t,r,e))}var as=class extends Xi{onExport(e){this.emit(jt.EXPORT,e)}onClose(){this.emit(jt.CLOSE)}onHistoryChange(){this.emit(jt.HISTORY_CHANGE)}onEditorReady(){this.emit(jt.EDITOR_READY)}onErrorImageLoading(e){this.emit(jt.ERROR_IMAGE_LOADING,e)}onImageLoaded(){this.emit(jt.IMAGE_LOAD)}onStickerUploadedAdd(e){this.emit(jt.STICKER_UPLOAD_ADD,e)}onToolChanged(e){this.emit(jt.TOOL_ENTER,e)}};var ls={common:{error:"Fehler",warning:"Warnung",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Farbe",sliderOpacity:"Farbe Transparenz"}}},mainCanvasActions:{buttonExport:"Bild Exportieren",buttonUndo:"R\xFCckg\xE4ngig machen",buttonRedo:"Wiederholen",buttonClose:"Schlie\xDFen"},infoModals:{exporting:{heading:"Exportieren...",body:"Einen Moment bitte..."},saving:{heading:"Speichere...",body:"Einen Moment bitte..."},loading:{heading:"Lade...",body:"Einen Moment bitte..."},resizing:{heading:"Bild wird bearbeitet...",body:"Einen Moment bitte..."},loadingFonts:{heading:"Lade Schriftarten...",body:"Einen Moment bitte..."},stickerLoading:{heading:"Lade Sticker...",body:"Einen Moment bitte..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Laden des Bildes fehlgeschlagen. Dies kann verschiedene Gr\xFCnde haben, beispielsweise kann die Datei defekt sein oder der Dateityp wird nicht unterst\xFCtzt",buttonYes:"Neu Laden"},rendering:{headingDelimiter:":",body:"Beim Rendern des Bildes ist ein Fehler aufgetreten",buttonYes:"Neu Laden"},fontLoading:{headingDelimiter:":",heading:"Laden von Schriftarten ist fehlgeschlagen",body:"Die folgenden Schriftarten konnten nicht geladen werden: ${error}",buttonNo:"Schlie\xDFen"},webcamUnavailable:{headingDelimiter:":",body:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})",buttonYes:"Schlie\xDFen"},stickerLoading:{headingDelimiter:":",body:"Laden des Stickers fehlgeschlagen.",buttonNo:"Schlie\xDFen"},unexpectedError:{headingDelimiter:":",body:"Ein unerwarteter Fehler ist aufgetreten, ${error}",buttonYes:"Neu Laden"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Bild verkleinert",body:"Ihr Bild \xFCbersteigt die maximale Gr\xF6sse von ${megapixels} megapixels und wurde auf ${width}x${height} Pixel verkleinert",buttonYes:"Weiter"},discardChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die \xC4nderungen verwerfen wollen?",buttonYes:"\xC4nderungen verwerfen",buttonNo:"\xC4nderungen beibehalten"},unsavedChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die \xC4nderungen verwerfen wollen?",buttonYes:"Beenden ohne zu speichern",buttonNo:"Schlie\xDFen"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Ihre Daten wurden von einem veralteten Format geladen und k\xF6nnten anders aussehen",buttonYes:"\xC4nderungen anwenden",buttonNo:"Abbrechen"},unsupportedWebGLRenderer:{body:"Es wurde ein Problem im Browser festgestellt, welches zu langen Ladezeiten f\xFChren kann. Bitte probieren sie einen anderen Browser.",buttonYes:"Weiter"}},library:{title:"Bibliothek",controls:{buttonUpload:"Bild Hochladen",buttonWebcamOpen:"Webcam \xD6ffnen",buttonWebcamClose:"Webcam Schlie\xDFen",placeholderSearch:"Bibliothek durchsuchen",noResults:"Keine Ergebnisse"}},filter:{title:"Filter",controls:{buttonReset:"Zur\xFCcksetzen",sliderIntensity:"Filter Intensit\xE4t"},categories:{[De.DuoTone]:"DuoTone",[De.BW]:"B & W",[De.Vintage]:"Vintage",[De.Smooth]:"Smooth",[De.Cold]:"Cold",[De.Warm]:"Warm",[De.Legacy]:"Legacy"},items:{[y.Inferno]:"Inferno",[y.Chestnut]:"Chestnut",[y.Fixie]:"Fixie",[y.Fridge]:"Fridge",[y.Sunny70s]:"Sunny 70s",[y.FlatBlack]:"Flat Black",[y.Mellow]:"Mellow",[y.HardStuff]:"Hard Stuff",[y.Oldtimer]:"Oldtimer",[y.AD1920]:"1920 A.D.",[y.Ancient]:"Ancient",[y.Kalmen]:"Kalmen",[y.Joran]:"Joran",[y.Polaroid]:"Polaroid",[y.Zephyr]:"Zephyr",[y.Levante]:"Levante",[y.Greyed]:"Greyed",[y.Classic]:"Classic",[y.Colorful]:"Colorful",[y.Snappy]:"Snappy",[y.Candy]:"Candy",[y.Creamy]:"Creamy",[y.LowFire]:"Low Fire",[y.Colla]:"Colla",[y.Sunrise]:"Sunrise",[y.Moss]:"Moss",[y.Food]:"Food",[y.Glam]:"Glam",[y.Gobblin]:"Gobblin",[y.HighCarb]:"High Carb",[y.Hicon]:"Hicon",[y.K1]:"K1",[y.K6]:"K6",[y.Pebble]:"Pebble",[y.Keen]:"Keen",[y.Lemon]:"Lemon",[y.Litho]:"Litho",[y.Lomo]:"Lomo",[y.Lomo100]:"Lomo 100",[y.Lucid]:"Lucid",[y.Neat]:"Neat",[y.Pumpkin]:"Pumpkin",[y.Solanus]:"Solanus",[y.Pale]:"Pale",[y.Pitched]:"Pitched",[y.Weathered]:"Weathered",[y.GreenGap]:"Green Gap",[y.PolaSX]:"Pola SX",[y.Pro400]:"Pro 400",[y.Quozi]:"Quozi",[y.Sepia]:"Sepia",[y.Settled]:"Settled",[y.Seventies]:"Seventies",[y.Soft]:"Soft",[y.Steel]:"Steel",[y.Summer]:"Summer",[y.Golden]:"Golden",[y.Tender]:"Tender",[y.Twilight]:"Twilight",[y.Softy]:"Softy",[y.Dusty]:"Dusty",[y.Desert]:"Desert",[y.Peach]:"Peach",[y.Clash]:"Clash",[y.Plum]:"Plum",[y.Breezy]:"Breezy",[y.DeepBlue]:"Deep Blue",[y.Frog]:"Frog",[y.Sunset]:"Sunset"}},adjustment:{title:"Korrekturen",controls:{buttonReset:"Zur\xFCcksetzen"},categories:{basics:"Grundlagen",refinements:"Feinheiten"},items:{brightness:"Helligkeit",saturation:"S\xE4ttigung",contrast:"Kontrast",gamma:"Gamma",sharpness:"Sch\xE4rfe",clarity:"Klarheit",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",whites:"Wei\xDF",blacks:"Schwarz",temperature:"Temperatur"}},focus:{title:"Weichzeichnen",controls:{buttonReset:"Zur\xFCcksetzen",sliderIntensity:"Focus Intensit\xE4t"},items:{radial:"Kreisf\xF6rmig",mirrored:"Gespiegelt",linear:"Linear",gaussian:"Gau\xDFsch"},history:{focusPosition:"Focus Position",focusSize:"Focus Gr\xF6\xDFe"}},overlay:{title:"Overlays",controls:{buttonReset:"Zur\xFCcksetzen",sliderOpacity:"Overlay Transparenz",carouselBlendMode:"Overlay Mischmodus",blendModeNormal:"Normal",blendModeOverlay:"\xDCberblenden",blendModeHardLight:"Hartes Licht",blendModeSoftLight:"Weiches Licht",blendModeMultiply:"Multiplizieren",blendModeDarken:"Abdunkeln",blendModeLighten:"Aufhellen",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Transparenz",tabBlendMode:"Mischmodus"},items:{[L.Bokeh]:"Bokeh",[L.Chop]:"Chop",[L.Clouds]:"Clouds",[L.Golden]:"Golden",[L.Grain]:"Grain",[L.Hearts]:"Hearts",[L.LightLeak1]:"Light Leak 1",[L.LightLeak2]:"Light Leak 2",[L.Metal]:"Metal",[L.Mosaic]:"Mosaic",[L.Painting]:"Painting",[L.Paper]:"Paper",[L.Rain]:"Rain",[L.Vintage]:"Vintage",[L.Wall1]:"Wall",[L.Wall2]:"Wall 2",[L.Wood]:"Wood"}},sticker:{title:"Sticker",controls:{buttonUpload:"Sticker Hochladen",sliderOpacity:"Sticker Transparenz",selectColor:"Stickerfarbe",tabColor:"Farbe",tabOpacity:"Transparenz"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren",buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"Neuer Text",dropdownFontFamily:"Schriftart",textFontSize:"Schriftgr\xF6\xDFe",selectAlignment:"Ausrichtung",selectFontColor:"Schriftfarbe",selectBackgroundColor:"Hintergrundfarbe",sliderLineSpacing:"Zeilenabstand",tabColor:"Farbe",tabBgColor:"Hintergrund",tabAlignment:"Ausrichtung",tabLineHeight:"Zeilenh\xF6he",tabFontSize:"Schriftgr\xF6\xDFe"},canvasControls:{placeholderText:"Etwas aufschreiben",buttonSave:"Fertig",buttonClose:"Abbrechen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"Neues Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Textfarbe",tabColor:"Farbe",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Etwas aufschreiben mit Style",buttonSave:"Done",buttonClose:"Schlie\xDFen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonInvert:"Invertieren",buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Rahmen",controls:{buttonReset:"Zur\xFCcksetzen",sliderOpacity:"Rahmen Transparenz",sliderSize:"Rahmen Dicke",selectColor:"Rahmen Farbe",tabColor:"Farbe",tabOpacity:"Transparenz",tabSize:"Dicke"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Malen",controls:{buttonReset:"Zur\xFCcksetzen",sliderSize:"Dicke",sliderHardness:"H\xE4rte",selectColor:"Farbe",tabSize:"Dicke",tabHardness:"H\xE4rte",tabColor:"Farbe"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Zuschneiden",controls:{buttonReset:"Zur\xFCcksetzen",checkboxKeepResolution:"Fixiere Aufl\xF6sung",inputCropSize:"Bildgr\xF6\xDFe",inputHeight:"h",inputWidth:"b",tabFlipAndRotate:"Spiegeln & Drehen",tabResolution:"Aufl\xF6sung",tabCropSize:"Bildgr\xF6\xDFe"},categories:{imgly_transforms_common:"Standard",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Frei",imgly_transform_common_square:"Quadratisch",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Titel",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln",buttonRotateClockwise:"Drehe im Uhrzeigersinn",buttonRotateAntiClockwise:"Drehe gegen Uhrzeigersinn"}}};var ni={common:{error:"Error",warning:"Warning",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Color",sliderOpacity:"Color Opacity"}}},mainCanvasActions:{buttonExport:"Export Image",buttonUndo:"Undo",buttonRedo:"Redo",buttonClose:"Close"},infoModals:{exporting:{heading:"Exporting...",body:"Just a few seconds..."},saving:{heading:"Saving...",body:"Just a few seconds..."},loading:{heading:"Loading...",body:"Just a few seconds..."},resizing:{heading:"Resizing...",body:"Just a few seconds..."},loadingFonts:{heading:"Loading Fonts...",body:"Just a few seconds..."},stickerLoading:{heading:"Loading Sticker...",body:"Just a few seconds..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Failed to load image. This can have multiple reasons, e.g. the file is corrupted or the file type is not supported",buttonYes:"Reload"},rendering:{headingDelimiter:":",body:"An error has occurred while rendering the image",buttonYes:"Reload"},fontLoading:{headingDelimiter:":",heading:"Failed to load font",body:"The following fonts could not be loaded: ${error}",buttonNo:"Close"},webcamUnavailable:{headingDelimiter:":",body:"Unable to display webcam image (Error: ${error})",buttonYes:"Close"},stickerLoading:{headingDelimiter:":",body:"Unable to load the sticker",buttonNo:"Close"},unexpectedError:{headingDelimiter:":",body:"An unexpected error has occured ${error}",buttonYes:"Reload"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Image resized",body:"Your image exceeds the maximum size of ${megapixels} megapixels and has been resized to ${width}x${height} pixels",buttonYes:"Continue"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Your data was restored from a legacy data format and might look different",buttonYes:"Apply changes",buttonNo:"Cancel"},discardChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to discard the changes?",buttonYes:"Discard changes",buttonNo:"Keep Changes"},unsavedChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to exit?",buttonYes:"Exit without saving",buttonNo:"Cancel"},unsupportedWebGLRenderer:{body:"A problem has been detected in the browser that could cause long loading times. Please try a different browser.",buttonYes:"Continue"}},library:{title:"Library",controls:{buttonUpload:"Upload Image",buttonWebcamOpen:"Open Webcam",buttonWebcamClose:"Close Webcam",placeholderSearch:"Search Library",noResults:"No Results"}},filter:{title:"Filters",controls:{buttonReset:"Remove Filter",sliderIntensity:"Filter Intensity"},categories:{[De.DuoTone]:"DuoTone",[De.BW]:"B & W",[De.Vintage]:"Vintage",[De.Smooth]:"Smooth",[De.Cold]:"Cold",[De.Warm]:"Warm",[De.Legacy]:"Legacy"},items:{[y.Inferno]:"Inferno",[y.Chestnut]:"Chestnut",[y.Fixie]:"Fixie",[y.Fridge]:"Fridge",[y.Sunny70s]:"Sunny 70s",[y.FlatBlack]:"Flat Black",[y.Mellow]:"Mellow",[y.HardStuff]:"Hard Stuff",[y.Oldtimer]:"Oldtimer",[y.AD1920]:"1920 A.D.",[y.Ancient]:"Ancient",[y.Kalmen]:"Kalmen",[y.Joran]:"Joran",[y.Polaroid]:"Polaroid",[y.Zephyr]:"Zephyr",[y.Levante]:"Levante",[y.Greyed]:"Greyed",[y.Classic]:"Classic",[y.Colorful]:"Colorful",[y.Snappy]:"Snappy",[y.Candy]:"Candy",[y.Creamy]:"Creamy",[y.LowFire]:"Low Fire",[y.Colla]:"Colla",[y.Sunrise]:"Sunrise",[y.Moss]:"Moss",[y.Food]:"Food",[y.Glam]:"Glam",[y.Gobblin]:"Gobblin",[y.HighCarb]:"High Carb",[y.Hicon]:"Hicon",[y.K1]:"K1",[y.K6]:"K6",[y.Pebble]:"Pebble",[y.Keen]:"Keen",[y.Lemon]:"Lemon",[y.Litho]:"Litho",[y.Lomo]:"Lomo",[y.Lomo100]:"Lomo 100",[y.Lucid]:"Lucid",[y.Neat]:"Neat",[y.Pumpkin]:"Pumpkin",[y.Solanus]:"Solanus",[y.Pale]:"Pale",[y.Pitched]:"Pitched",[y.Weathered]:"Weathered",[y.GreenGap]:"Green Gap",[y.PolaSX]:"Pola SX",[y.Pro400]:"Pro 400",[y.Quozi]:"Quozi",[y.Sepia]:"Sepia",[y.Settled]:"Settled",[y.Seventies]:"Seventies",[y.Soft]:"Soft",[y.Steel]:"Steel",[y.Summer]:"Summer",[y.Golden]:"Golden",[y.Tender]:"Tender",[y.Twilight]:"Twilight",[y.Softy]:"Softy",[y.Dusty]:"Dusty",[y.Desert]:"Desert",[y.Peach]:"Peach",[y.Clash]:"Clash",[y.Plum]:"Plum",[y.Breezy]:"Breezy",[y.DeepBlue]:"Deep Blue",[y.Frog]:"Frog",[y.Sunset]:"Sunset"}},adjustment:{title:"Adjust",controls:{buttonReset:"Reset Adjustment"},categories:{basics:"Basic",refinements:"Refinements"},items:{brightness:"Brightness",saturation:"Saturation",contrast:"Contrast",gamma:"Gamma",sharpness:"Sharpness",clarity:"Clarity",exposure:"Exposure",shadows:"Shadows",highlights:"Highlights",whites:"Whites",blacks:"Blacks",temperature:"Temperature"}},focus:{title:"Focus",controls:{buttonReset:"Remove Focus",sliderIntensity:"Focus Intensity"},items:{radial:"Radial",mirrored:"Mirrored",linear:"Linear",gaussian:"Gaussian"},history:{focusPosition:"Focus Position",focusSize:"Focus Size"}},overlay:{title:"Overlays",controls:{buttonReset:"Remove Overlay",sliderOpacity:"Overlay Opacity",carouselBlendMode:"Overlay Blend mode",blendModeNormal:"Normal",blendModeOverlay:"Overlay",blendModeHardLight:"Hard Light",blendModeSoftLight:"Soft Light",blendModeMultiply:"Multiply",blendModeDarken:"Darken",blendModeLighten:"Lighten",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Opacity",tabBlendMode:"Blend Mode"},items:{[L.Bokeh]:"Bokeh",[L.Chop]:"Chop",[L.Clouds]:"Clouds",[L.Golden]:"Golden",[L.Grain]:"Grain",[L.Hearts]:"Hearts",[L.LightLeak1]:"Light Leak 1",[L.LightLeak2]:"Light Leak 2",[L.Metal]:"Metal",[L.Mosaic]:"Mosaic",[L.Painting]:"Painting",[L.Paper]:"Paper",[L.Rain]:"Rain",[L.Vintage]:"Vintage",[L.Wall1]:"Wall",[L.Wall2]:"Wall 2",[L.Wood]:"Wood"}},sticker:{title:"Stickers",controls:{buttonUpload:"Upload Sticker",sliderOpacity:"Sticker Opacity",selectColor:"Sticker Color",tabColor:"Color",tabOpacity:"Opacity"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate",buttonFlipHorizontal:"Flip",buttonFlipVertical:"Flip"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"New Text",dropdownFontFamily:"Font Family",textFontSize:"Font Size",selectAlignment:"Alignment",selectFontColor:"Font Color",selectBackgroundColor:"Background Color",sliderLineSpacing:"Line Spacing",tabColor:"Color",tabBgColor:"Bg Color",tabAlignment:"Alignment",tabLineHeight:"Line Height",tabFontSize:"Font Size"},canvasControls:{placeholderText:"Write Something",buttonSave:"Done",buttonClose:"Cancel",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"New Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Text Color",tabColor:"Color",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Write Something With Style",buttonSave:"Done",buttonClose:"Schlie\xDFen",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonInvert:"Invert",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Frames",controls:{buttonReset:"Remove Frame",sliderOpacity:"Frame Opacity",sliderSize:"Frame Size",selectColor:"Frame Color",tabColor:"Color",tabOpacity:"Opacity",tabSize:"Size"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Brush",controls:{buttonReset:"Remove Brush",sliderSize:"Brush Size",sliderHardness:"Brush Hardness",selectColor:"Brush Color",tabSize:"Size",tabHardness:"Hardness",tabColor:"Color"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Transform",controls:{buttonReset:"Reset to default",checkboxKeepResolution:"Keep Resolution",inputCropSize:"Crop Size",inputHeight:"h",inputWidth:"w",tabFlipAndRotate:"Flip & Rotate",tabResolution:"Resolution",tabCropSize:"Crop Size"},categories:{imgly_transforms_common:"Common",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Custom",imgly_transform_common_square:"Square",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Title",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Flip Horizontal",buttonFlipVertical:"Flip Vertical",buttonRotateClockwise:"Rotate Clockwise",buttonRotateAntiClockwise:"Rotate Counterclockwise"}}};var Gl=i=>i==="de"?ls:ni,Vl=(i,e)=>e&&e[i]?Wt([Gl(i),e[i]]):Gl(i)||ni;var Wp={headline1:{size:16,letterSpacing:1.5,case:"uppercase"},headline2:{size:14,letterSpacing:.8,case:"uppercase"},body:{size:13,letterSpacing:0,case:"none"},label:{size:13,letterSpacing:0,case:"capitalize"},basicUICardLabel:{size:12,letterSpacing:0,case:"capitalize"},button1:{size:12,letterSpacing:1.2,case:"uppercase"},button2:{size:14,letterSpacing:0,case:"capitalize"},basicUITabLabel:{size:14,letterSpacing:.8,case:"uppercase"}},jp={toast:2,controlsBar:5,buttonGroup:5,toolControlBar:6,toolbar:7,label:10,disable:11,canvas:{knob:4,bar:5,controls:5,snappingGuide:1,crop:{grid:2,dragImage:3,backdrop:4},webcam:{backdrop:7}},input:{list:6},button:{float:5},dialog:{base:100,backdrop:1,container:2},colorItem:{overlay:2,background:1,tiledBackground:0}},to=()=>{let i=8,e=230,t=3*i,r=e-2*t,o=(r-2*i)/3,n=(r-i)/2;return{advancedUIToolbar:{width:55,itemHeight:48,seperatorHeight:20,marginBottom:0},advancedUIToolControlBar:{width:e,padding:`${2*i}px ${t}px`,marginBottom:0},advancedCard:{small:{height:o,width:o},medium:{height:n,width:n},large:{height:86,width:r}},advancedSpacer:8,basicCanvasOffset:40+76-88,basicUIToolbar:{openHeight:88,closeHeight:40},basicToolControlBar:{itemsBarHeight:72,controlsBarHeight:80,maxHeight:72+40+4,maxWidth:300},basicCard:{medium:{height:56,width:90},large:{height:60,width:110}},basicSpacer:8,mainCanvasActionBar:{height:50},crop:{minSize:50},canvas:{marginTop:0,transform:{minSliderWidth:435,minValueWidth:235,minFlipWidth:160}},canvasControls:{sprite:{controlOffset:16,rotateHandle:{height:16},minSize:30,controlPadding:16},knob:{size:16,touchable:{desktop:24}},corner:{size:14,touchable:{desktop:24,mobile:48},borderWidth:4},width:{size:14}},buttons:{float:{size:56}},colorItem:{size:20},color:{colorPicker:{width:214,height:370,saturationSlider:{height:150},thumb:{size:14},arrow:{width:36}}},fontSystem:Wp,zIndex:jp}};var Gp=({primary:i="#365afc",background:e="#0B0B0B",foreground:t="#FFFFFF"}={primary:"#365afc",background:"#0B0B0B",foreground:"#FFFFFF"})=>{let r="rgba(255, 255, 255, 0.90)",o="rgba(255, 255, 255, 0.60)",n="rgba(255, 255, 255, 0.38)",s="#424242",l="#333333",c="#242424",p="#171717",m="#0B0B0B",h="rgba(255, 255, 255, 0.08)",b="rgba(0, 0, 0, 0.3)",v="rgba(89, 121, 252, 0.20)",x="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:e,foreground:t,primary:i,warning:"#ffba5c",error:"#c2393a",success:"#39c26c",focusOutlineColor:"rgba(255, 255, 255, 0.12)",scrollbar:{handleColor:"rgba(255, 255, 255, 0.2)"},button:{outlinedBorderColor:l,activeForeground:i,containedPrimaryBackground:i,containedPrimaryForeground:r,outlinedPrimaryBackground:c,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:i,textSecondaryForeground:o,outlinedInactiveOverlayColor:b,textInactiveOpacity:"0.5",hoverOverlayColor:h},checkbox:{background:l,foreground:t,activeForeground:t,activeBackground:i,inactiveOpacity:x,hoverOpacity:"0.8"},modal:{background:c,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:l,foreground:r,activeBorderColor:i,activeOverlayColor:v,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:r,inactiveOverlayColor:b,hoverOverlayColor:h},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:i,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:l,caretColor:n,listBackground:l,listBorderColor:l,listItemHoverBackground:s,listForeground:o,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,inactiveOpacity:x},textInput:{foreground:r,hoverBorderColor:"rgba(255, 255, 255, 0.40)",background:"transparent",borderColor:l,inactiveOpacity:x},slider:{trackColor:"rgba(255, 255, 255, 0.4)",activeTrackColor:i,thumbBackground:p,thumbBorderColor:i,inactiveOpacity:x,hoverOpacity:"0.7"},selectColor:{activeBorderColor:i,inactiveOpacity:x},toolbar:{foreground:r,background:c,activeBackground:"transparent",activeForeground:i,borderColor:"transparent"},tooltip:{background:s,foreground:r},toolControlBar:{background:"rgba(23, 23, 23, 0.9)",borderColor:"transparent",shadow:"none",separatorColor:l,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:x},mainCanvasActionBar:{background:"linear-gradient(0deg, transparent 0%,  rgba(0, 0, 0, 0.6) 98%)",foreground:r,borderColor:"none"},canvasActionBar:{background:s,foreground:r,separatorColor:n},canvas:{background:m,controlsOutline:"rgba(255, 255, 255, 0.5)",controlsColor:"#ffffff",cropBackdrop:"rgba(0, 0, 0, 0.5)"},colorPicker:{listBackground:l,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:s},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:t,background:m},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#424242",highlight:"#565656",shadow:"#333333"}}}},io=Gp;var Vp=({primary:i="#1e47fb",background:e="#FBFBFB",foreground:t="#000000"}={primary:"#1e47fb",background:"#FBFBFB",foreground:"#000000"})=>{let r="rgba(0, 0, 0, 0.90)",o="rgba(0, 0, 0, 0.60)",n="rgba(0, 0, 0, 0.38)",s="#CCCCCC",l="#D4D4D4",c="#E6E6E6",p="#EEEEEE",m="#FBFBFB",h="rgba(125, 125, 125, 0.12)",b="rgba(30, 71, 251, 0.2)",v="rgba(0, 0, 0, 0.3)",x="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:e,foreground:t,primary:i,warning:"#ffb045",error:"#c01a1b",success:"#17c658",focusOutlineColor:"rgba(125, 125, 125, 0.12)",scrollbar:{handleColor:"rgba(0, 0, 0, 0.2)"},button:{outlinedBorderColor:l,activeForeground:i,containedPrimaryBackground:i,containedPrimaryForeground:"rgba(255, 255, 255, 0.9)",outlinedPrimaryBackground:c,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:i,textSecondaryForeground:o,outlinedInactiveOverlayColor:v,textInactiveOpacity:"0.5",hoverOverlayColor:h},checkbox:{background:l,foreground:t,activeForeground:t,activeBackground:i,inactiveOpacity:x,hoverOpacity:"0.8"},modal:{background:c,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:l,foreground:r,activeBorderColor:i,activeOverlayColor:b,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:"rgba(255, 255, 255, 0.87)",inactiveOverlayColor:v,hoverOverlayColor:h},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:i,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:l,listBackground:l,caretColor:n,listForeground:o,listBorderColor:l,listItemHoverBackground:s,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,inactiveOpacity:x},textInput:{foreground:r,hoverBorderColor:r,background:"transparent",borderColor:l,inactiveOpacity:x},slider:{trackColor:s,activeTrackColor:i,thumbBackground:p,thumbBorderColor:i,inactiveOpacity:x,hoverOpacity:"0.7"},selectColor:{activeBorderColor:i,inactiveOpacity:x},toolbar:{foreground:r,background:l,activeBackground:"transparent",activeForeground:i,borderColor:"transparent"},tooltip:{background:s,foreground:r},toolControlBar:{background:"rgba(238, 238, 238, 0.9)",borderColor:p,shadow:"none",separatorColor:l,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:x},mainCanvasActionBar:{background:"transparent",foreground:r,borderColor:"none"},canvasActionBar:{background:s,foreground:r,separatorColor:n},canvas:{background:m,controlsOutline:"rgba(255, 255, 255, 0.6)",controlsColor:"#ffffff",cropBackdrop:"rgba(255, 255, 255, 0.3)"},colorPicker:{listBackground:l,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:s},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:t,background:m},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#B8B8B8",highlight:"#E6E6E6",shadow:"#D4D4D4"}}}},cs=Vp;var rr=io(),us=to(),I_=f(f({},rr),{measurements:us});var $p=i=>i==="light"?cs:io,$l=(i,e)=>{let t=$p(i);if(e&&e[i]){let{primary:r,background:o,foreground:n}=e[i],s={primary:r,background:o,foreground:n},l=Object.keys(s).reduce((c,p)=>s[p]?f(f({},c),{[p]:s[p]}):c,{});return Wt([t(l),e[i]])}return t()||rr};var Kp=["canvas","advancedUIToolbar","advancedUIToolControlBar","basicUIToolbar","mainCanvasActionBar","colorItem","fontSystem"],Kl=i=>{let e=to();if(i){let t={};return Object.keys(i).forEach(r=>{Kp.indexOf(r)!==-1&&(t[r]=i[r])}),Wt([e,t])}return e};var Yp={config:is,locale:ni,theme:rr,measurements:us},ke=class{constructor(){this.checkDefaultToolAvailability=(e,t)=>t.indexOf(e)!==-1;this.state=S(Yp),this.events=new as,this.licenseChecker=null}saveConfig(e){e.mainCanvasActions&&e.mainCanvasActions.length!==4&&(e.mainCanvasActions.length=4);let r=Wt([is,e]);this.licenseChecker=new Qn(r.license),this.licenseChecker.areCustomAssetsAllowed()||(r.sticker.enableCustomUpload=!1);let o=Vl(r.language,r.custom.languages),n=$l(r.theme,r.custom.themes),s=Kl(r.custom.measurements),{provider:l}=r.library,c=[];r.adjustment.categories=r.adjustment.categories.reduce((b,v)=>(b.push(f(f({},v),{items:v.items.filter(x=>qp[x.identifier]?!0:(c.push(x.identifier),!1))})),b),[]),c.length!==0&&console.error(`The following identifier are incorrect for the adjustment tool: ${c.join(", ")}`),delete r.language,delete r.custom.languages,delete r.custom.themes,delete r.library.provider;let p=r.tools.reduce((b,v)=>typeof v=="object"?[...b,...v]:[...b,v],[]);p.length||(console.error("Empty list input for tools"),p=Zr.reduce((b,v)=>typeof v=="object"?[...b,...v]:[...b,v],[])),p=p.filter(b=>this.licenseChecker.isToolAllowed(b)),this.checkDefaultToolAvailability(r.defaultTool,p)||(this.licenseChecker.isToolAllowed(r.defaultTool)&&console.warn(`Configured default tool ${r.defaultTool} is not a part of configured list of tools: [${p.join(" ")}]`),[r.defaultTool]=p),r.tools=p,this.state.config=r,this.state.locale=o,this.state.theme=n,this.state.measurements=s;let h=this.buildCustomAssetsConfig();return this.assetProvider=new qr(h,this.licenseChecker.areCustomAssetsAllowed()),this.loadThemeFont(),l}get config(){return this.state.config}get locale(){return this.state.locale}get theme(){return this.state.theme}get measurements(){return this.state.measurements}get tools(){return this.config.tools.reduce((e,t)=>typeof t=="string"?[...e,t]:[...e,"",...t],[])}get defaultTool(){return this.config.defaultTool}get isOrderDefault(){return this.config.order==="default"}get isLayoutAdvanced(){return this.config.layout==="advanced"}get displayCloseButton(){return this.config.mainCanvasActions.indexOf(de.CLOSE)!==-1}loadThemeFont(){let{typography:e}=this.theme;e.skipLoading||this.assetProvider.getFontManager().injectFonts([e])}buildCustomAssetsConfig(){let e=this.tools,t=k(this.state.config),r=this.state.config.assetBaseUrl,{theme:o}=this.state,n=e.indexOf(g.FILTER)!==-1?t[g.FILTER]:void 0,s=e.indexOf(g.FOCUS)!==-1?t[g.FOCUS]:void 0,l=e.indexOf(g.ADJUSTMENT)!==-1?t[g.ADJUSTMENT]:void 0,c=e.indexOf(g.STICKER)!==-1?t[g.STICKER]:void 0,p=e.indexOf(g.FRAME)!==-1?t[g.FRAME]:void 0,m=e.indexOf(g.OVERLAY)!==-1?t[g.OVERLAY]:void 0,h=e.indexOf(g.TRANSFORM)!==-1?t[g.TRANSFORM]:void 0,b=e.indexOf(g.TEXT)!==-1?t[g.TEXT]:void 0,v=e.indexOf(g.TEXT_DESIGN)!==-1?t[g.TEXT_DESIGN]:void 0;return{basePath:r,theme:o,filter:n,focus:s,sticker:c,frame:p,overlay:m,transform:h,text:b,adjustment:l,textdesign:v}}};a([d],ke.prototype,"saveConfig",1),a([u],ke.prototype,"config",1),a([u],ke.prototype,"locale",1),a([u],ke.prototype,"theme",1),a([u],ke.prototype,"measurements",1),a([u],ke.prototype,"tools",1),a([u],ke.prototype,"defaultTool",1),a([u],ke.prototype,"isOrderDefault",1),a([u],ke.prototype,"isLayoutAdvanced",1),a([u],ke.prototype,"displayCloseButton",1);var ds=class{constructor(e){this.editor=e}setBackgroundImage(e){this.container?this.container.setData({image:e,originalImage:e}):this.container=this.engine.addImage({image:e,originalImage:e,blendMode:j.NORMAL,opacity:1})}getchildren(){return this.container.getChildren()}addImageToContainer(){return new Promise((e,t)=>{let{image:r}=this.editor.activeStore;if(Sl(r))this.setBackgroundImage(r),e();else{let o=this.editor.libraryStore.getRawUrl(r);this.getImageElement(o).then(n=>{this.setBackgroundImage(n),e()}).catch(n=>{t({identifier:"imageLoading",message:n.message})})}})}getImageElement(e){return new Promise((t,r)=>{let o=new Image;o.addEventListener("load",()=>{t(o)}),o.addEventListener("error",n=>{r(n)}),o.crossOrigin=this.editor.configStore.config.engine.crossOrigin,o.src=e})}getImgageContainerId(){return this.container?this.container.getID():""}get engine(){return this.editor.engine}};var ps=class{constructor(e){this.applyNewImageTransform=()=>{let{size:e,width:t,height:r}=this.editor.engineMediator.image.container.getBounds(),o=this.container;o.setTransform(X.IDENTITY),o.setResolution(e),o.setPivot(.5,.5),o.setPosition({x:t/2,y:r/2})};this.editor=e}get engine(){return this.editor.engine}get container(){return this.engine.getOutputContainer()}};var Xp=(i,e)=>new Promise((t,r)=>{let o=new XMLHttpRequest;o.onload=()=>{let n=new FileReader;n.onloadend=()=>{typeof n.result=="string"&&n.result.substr(0,10)==="data:image"?t(n.result):r(new Error(`The image could not be loaded from ${i}`))},n.onerror=s=>{r(s)},n.readAsDataURL(o.response)},o.open("GET",i),o.responseType="blob",o.withCredentials=e==="use-credentials",o.send()}),ql=(i,e)=>new Promise((t,r)=>{let o=new Image;o.onload=()=>{t(o)},o.onerror=()=>{r(new Error(`Failed to load image with src:${i}`))},o.crossOrigin=e,o.src=i}),Jp=(i,e)=>new Promise((t,r)=>{Xp(i,e).then(o=>{let n=new Image;n.addEventListener("load",()=>{t(n)}),n.src=o}).catch(()=>{ql(i,e).then(o=>t(o)).catch(o=>{r(o)})})}),ms=r=>C(void 0,[r],function*({url:i,image:e,crossOrigin:t="anonymous"}){try{return e&&e.src&&e.src.substr(0,5)==="data:"||e&&e.src&&e.src.includes(".svg")?e:typeof i=="string"&&i.substr(0,5)==="data:"||typeof i=="string"&&i.includes(".svg")?ql(i,t):Jp(i||e.src,t)}catch(o){throw new Error(o)}});var Zp={tool:null,isWebcam:!1,image:""},qe=class{constructor(e){this.setImage=e=>C(this,null,function*(){let{crossOrigin:t}=this.editor.configStore.config.engine;typeof e=="string"&&(this.state.image=yield ms({url:ii(e)?e:this.editor.assetProvider.getPath(e),crossOrigin:t})),e instanceof HTMLImageElement&&(this.state.image=yield ms({image:e,crossOrigin:t})),this.isWebcam&&(this.state.isWebcam=!1)});this.newImage=e=>{this.editor.init(e)};this.editor=e,this.state=S(Zp)}selectTool(e){let{licenseChecker:t}=this.editor.configStore;if(this.state.tool!==e&&(t==null?void 0:t.isToolAllowed(e)))switch(this.editor.onToolChange(this.state.tool,e),this.state.tool=e,this.editor.configStore.events.onToolChanged(e),e){case g.TEXT:this.editor.spriteStore.textToolStore.addOrselect();break;case g.TEXT_DESIGN:this.editor.spriteStore.textDesignToolStore.addOrselect();break;case g.BRUSH:{this.editor.brushToolStore.initSize();break}case g.TRANSFORM:this.editor.transformToolStore.applyDefaultCrop();break;default:break}}selectWebcam(e){this.state.isWebcam=e}get webcamLabel(){return this.editor.libraryStore.locale.controls.buttonWebcamClose}get tool(){return this.state.tool}get isWebcam(){return this.state.isWebcam}get image(){return this.state.image}};a([d],qe.prototype,"selectTool",1),a([d],qe.prototype,"selectWebcam",1),a([d],qe.prototype,"setImage",2),a([d],qe.prototype,"newImage",2),a([u],qe.prototype,"webcamLabel",1),a([u],qe.prototype,"tool",1),a([u],qe.prototype,"isWebcam",1),a([u],qe.prototype,"image",1);var hs={height:150,width:150},fs=class{constructor(e){this.canvasClickDisabled=S.box(!1);this.editor=e,this.state=S(fs.initialState)}setCanvasElement(e){this.canvas=e,this.editor.engineMediator.preview.createPreview(e),this.updateCanvasDimensions(),this.editor.init(this.editor.configStore.config.image)}updateCanvasDimensions(){let e=ie.devicePixelRatio;this.canvas.width=this.canvasSize.width*e,this.canvas.height=this.canvasSize.height*e,this.canvas.style.width=`${this.canvasSize.width}px`,this.canvas.style.height=`${this.canvasSize.height}px`}saveDimensions({height:e,width:t,render:r}){let o=this.editor.configStore.isLayoutAdvanced?0:this.editor.configStore.measurements.basicCanvasOffset;e-o>hs.height&&t>hs.width&&(this.state.canvasSize.height=e-o,this.state.canvasSize.width=t,r&&this.editor.resize())}disableCanvasClick(){this.canvasClickDisabled.set(!0)}enableCanvasClick(){this.canvasClickDisabled.set(!1)}get isCanvasClickable(){return!this.canvasClickDisabled.get()}get canvasSize(){return this.state.canvasSize}get sizeVector(){return _.fromSize(this.state.canvasSize)}get sizeVectorMagnitude(){return this.sizeVector.magnitude}getContainersAtPreviewPoint(e){let t=this.editor.engine.getContainersAtPreviewPoint(e,this.editor.engineMediator.preview.previewTransformWithoutDpr).map(r=>r.getID()).filter(r=>r!==this.editor.engineMediator.image.getImgageContainerId());this.editor.spriteStore.onCanvasClick(t)}},Ie=fs;Ie.initialState={canvasSize:hs},a([d],Ie.prototype,"setCanvasElement",1),a([d],Ie.prototype,"updateCanvasDimensions",1),a([d],Ie.prototype,"saveDimensions",1),a([d],Ie.prototype,"disableCanvasClick",1),a([d],Ie.prototype,"enableCanvasClick",1),a([u],Ie.prototype,"isCanvasClickable",1),a([u],Ie.prototype,"canvasSize",1),a([u],Ie.prototype,"sizeVector",1),a([u],Ie.prototype,"sizeVectorMagnitude",1);var Qp={type:null,identifier:null,isVisible:!1,error:""},Le=class{constructor(e){this.showActionModal=({type:e,identifier:t,error:r,handleConfirm:o,handleDismiss:n})=>{this.resetHandlers(),this.state.isVisible=!0,this.state.identifier=t,this.state.type=e,this.state.error=r||"",this.handleConfirm=o,this.handleDismiss=n};this.hideModal=()=>{this.state.isVisible=!1,this.state.type=null,this.state.error="",this.state.identifier=null,this.resetHandlers()};this.resetHandlers=()=>{this.handleConfirm=null,this.handleDismiss=null};this.configStore=e.configStore,this.state=S(Qp)}showInfoModal(e){this.resetHandlers(),this.state.isVisible=!0,this.state.type=oe.INFO,this.state.identifier=e,this.state.error=""}showTextEditModal(){this.resetHandlers(),this.state.isVisible=!0,this.state.type=oe.TEXT_EDIT,this.state.identifier="inputText",this.state.error=""}get modalProps(){let{isVisible:e}=this.state,t=this.getModalLocale();if(t){let{bodyLabel:r,headerLabel:o,buttonYes:n,buttonNo:s}=t;return{headerLabel:o,bodyLabel:r,confirmLabel:n,dismissLabel:s,isVisible:e,handleClose:this.hideModal,handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss}}return{isVisible:!1}}get isVisible(){return this.state.isVisible}get type(){return this.state.type}get identifier(){return this.state.identifier}get positionOffset(){let{isLayoutAdvanced:e,measurements:{basicCanvasOffset:t,advancedUIToolControlBar:r,advancedUIToolbar:o},isOrderDefault:n}=this.configStore,s=(r.width+o.width)*(n?1:-1);return e?{x:s/2,y:0}:{x:0,y:-t}}getModalLocale(){let{identifier:e,error:t,type:r}=this.state,{locale:o}=this.configStore;if(!r||!e||r===oe.TEXT_EDIT)return null;if(r&&e&&o[`${r}Modals`]&&o[`${r}Modals`][e]){let n=o[`${r}Modals`][e],{body:s}=n;s&&typeof t=="object"?Object.keys(t).forEach(c=>{s=s.replace(`\${${c}}`,t[c])}):s&&(s=s.replace("${error}",t));let l=n.heading;if(r===oe.ERROR||r===oe.WARNING){let c={error:o.common.error,warning:o.common.warning};l=`${r==="error"?c.error:c.warning}${n.headingDelimiter||""} ${n.header||""}`}return{bodyLabel:s,headerLabel:l,buttonYes:n.buttonYes,buttonNo:n.buttonNo}}return null}};a([d],Le.prototype,"showActionModal",2),a([d],Le.prototype,"showInfoModal",1),a([d],Le.prototype,"showTextEditModal",1),a([d],Le.prototype,"hideModal",2),a([u],Le.prototype,"modalProps",1),a([u],Le.prototype,"isVisible",1),a([u],Le.prototype,"type",1),a([u],Le.prototype,"identifier",1),a([u],Le.prototype,"positionOffset",1);var le=class{constructor(e){this.defaultScale=1;this.SCALE_LEVELS=[8.33,12.5,16.66,25,33.33,50,66.66,100,125,150,200,300,400,500,600].map(e=>e/100);this.state={position:{x:0,y:0},scaleIndex:-1};this.offset={x:0,y:0};this.in=()=>{this.canZoomIn&&(this.state.scaleIndex+=1,this.scaleRender())};this.out=()=>{if(this.canZoomOut){this.state.scaleIndex-=1;let{canDragX:e,canDragY:t,maxOffsetX:r,maxOffsetY:o}=this.checkOffset({x:0,y:0});t||(this.offset.y=o),e||(this.offset.x=r),this.savePosition(),this.scaleRender()}};this.setOffset=e=>{let{canDragX:t,canDragY:r}=this.checkOffset(e);t&&(this.offset.x=e.x),r&&(this.offset.y=e.y),this.scaleRender()};this.editor=e}setInitialTransform(e=0){let{transform:t}=this.editor.engineMediator.preview;re(()=>{this.setDefaultScale(Math.abs(e||t.scale.x)),this.setPosition(t.position)})}resetScale(){this.state.scaleIndex=-1}resetPosition(){let{width:e,height:t}=this.editor.canvasStore.canvas;this.setPosition({x:e/2,y:t/2})}resetOffset(){this.offset={x:0,y:0}}setPosition(e){this.state.position.x=e.x,this.state.position.y=e.y}savePosition(){this.setPosition(this.getPositionWithOffset()),this.offset={x:0,y:0}}setDefaultScale(e){if(this.defaultScale!==1){let r=this.SCALE_LEVELS.findIndex(o=>o===this.defaultScale);r!==-1&&(this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,r),...this.SCALE_LEVELS.slice(r+1)])}let t=this.SCALE_LEVELS.findIndex((r,o)=>o===0?e<r:o===this.SCALE_LEVELS.length-1?r<e:this.SCALE_LEVELS[o-1]<e&&e<r);if(t!==-1)this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,t),e,...this.SCALE_LEVELS.slice(t)],t===this.state.scaleIndex&&this.resetScale(),this.state.scaleIndex=t,this.defaultScale=e;else{let r=this.SCALE_LEVELS.findIndex(o=>o===e);r===this.state.scaleIndex&&this.resetScale(),r!==-1&&(this.state.scaleIndex=r,this.defaultScale=e)}}setScaleToDefault(){this.state.scaleIndex=this.defaultIndex}checkOffset(e){let t=window.devicePixelRatio||1,{scaledSize:r}=this,{previewSize:o}=this,n=this.editor.engineMediator.preview.initialTransform.position,s=this.getPositionWithOffset(e),l=(r.width-o.width)*t/2,c=(r.height-o.height)*t/2,p=n.x-s.x,m=n.y-s.y,h=Math.abs(p),b=Math.abs(m),v=p>0,x=m>0,I=h-l,R=b-c;return{canDragX:I<0,canDragY:R<0,maxOffsetX:v?-I:I,maxOffsetY:x?-R:R}}calculateScale(e=0,t=this.previewSize,r=this.defaultScale){let{width:o,height:n}=t,s=new _({x:o,y:n}),l=new _(Math.abs(s.x*Math.cos(e))+Math.abs(s.y*Math.sin(e)),Math.abs(s.x*Math.sin(e))+Math.abs(s.y*Math.cos(e))),c=s.subtract(l).divide(2).multiply(r).abs;return c.y>c.x?c.y*2/s.y+r:c.x*2/s.x+r}get defaultIndex(){return this.SCALE_LEVELS.findIndex(e=>e===this.defaultScale)}getPositionWithOffset(e=this.offset){let{position:t}=this;return{x:t.x-e.x,y:t.y-e.y}}scaleRender(e=!1){let t=this.editor.scale.getPositionWithOffset(),r=e?this.defaultScale:this.scale,o={x:r,y:r};this.editor.engineMediator.preview.container.setScale(o),this.editor.engineMediator.preview.container.setPosition(t),this.editor.engineMediator.preview.savePreviewTransform({scale:o,position:t,rotation:0}),e||this.editor.render()}get scale(){let e=this.state.scaleIndex;return e!==-1?this.SCALE_LEVELS[e]:this.defaultScale}get zoomLevel(){let e=window.devicePixelRatio||1;return(this.scale/e*100).toFixed(1)}get canDrag(){return this.defaultScale<this.scale}get canZoomOut(){return this.state.scaleIndex>this.defaultIndex}get canZoomIn(){return this.SCALE_LEVELS.length-1>this.state.scaleIndex}get position(){return this.state.position}get scaledSize(){let e=this.state.scaleIndex,t=e!==-1?this.SCALE_LEVELS[e]:this.defaultScale,{previewSize:r}=this;return{width:r.width*t/this.defaultScale,height:r.height*t/this.defaultScale}}get previewSize(){return this.editor.getPreviewSize()}};a([S],le.prototype,"state",2),a([d],le.prototype,"in",2),a([d],le.prototype,"out",2),a([d],le.prototype,"setInitialTransform",1),a([d],le.prototype,"resetScale",1),a([d],le.prototype,"resetPosition",1),a([d],le.prototype,"setPosition",1),a([d],le.prototype,"savePosition",1),a([d],le.prototype,"setDefaultScale",1),a([d],le.prototype,"setScaleToDefault",1),a([u],le.prototype,"scale",1),a([u],le.prototype,"zoomLevel",1),a([u],le.prototype,"canDrag",1),a([u],le.prototype,"canZoomOut",1),a([u],le.prototype,"canZoomIn",1),a([u],le.prototype,"position",1),a([u],le.prototype,"scaledSize",1);var Yl=/^data:image\/(.+?);base64,/,em=i=>Yl.test(i),tm=i=>i.match(/^data:([^;]+)/)[1],im=i=>i.replace(Yl,""),or=class{constructor(e){this.applySerialization=(e,t,r,o)=>C(this,null,function*(){this.editor.resetToolStates();let n=this.editor.activeStore.tool===g.TRANSFORM;n||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.reset(),n||this.editor.transformToolStore.onLeave();let s=new t(this.editor),l="Unexpected error occured",c=t.deserializeImage(e);if(c.image&&c.image.data){let m=c.image.data;yield this.editor.setImage(m),this.editor.scale.defaultScale=1,this.editor.scale.resetOffset(),this.editor.transformToolStore.reset(),this.editor.activeStore.setImage(m),yield this.editor.engineMediator.image.addImageToContainer(),this.editor.engineMediator.output.applyNewImageTransform(),this.editor.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.editor.transformToolStore.setCropDefaults(),this.editor.historyStore.addInitialSnapshot(),this.editor.transformToolStore.saveTransforms()}let p=s.deserializeTransformation(e);if(p){yield this.applyStateOnUI(p);let m=s.deserialize(e);m?(yield this.applyStateOnUI(m),yield this.editor.render(),this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),r()):o(l)}else o(l)});this.editor=e}serialize({image:e}={image:!1}){let t=this.editor.activeStore.tool===g.TRANSFORM;return this.editor.modalStore.showInfoModal("saving"),new Promise((r,o)=>{import("./serialization/index.js").then(s=>C(this,[s],function*({Serializer:n}){try{t&&this.editor.transformToolStore.onLeave(),yield this.editor.wait(),this.editor.transformToolStore.applyDefaultCrop(!1);let{originalImage:l}=this.editor.imageContainer.getData(),c=this.editor.engineMediator.output.container.getResolution(),p={width:l.width,height:l.height},m=new n(this.editor.transformToolStore.defaultCropMaskPosition,this.editor.transformToolStore.maxCropMaskSize,c,p,this.editor.engine.getRootContainers()[0],this.editor.engine.getOutputContainer()),h={[g.ADJUSTMENT]:k(this.editor.adjustmentsToolStore.state),[g.FILTER]:k(this.editor.filterToolStore.state),[g.FOCUS]:k(this.editor.focusToolStore.serializableState),[g.OVERLAY]:k(this.editor.overlayToolStore.state),[g.FRAME]:k(this.editor.frameToolStore.state),[g.BRUSH]:this.editor.brushToolStore.strokes||{strokes:[]}},{sprite:b,customStickers:v}=yield this.editor.spriteStore.serializableState();b.spriteIdList=b.spriteIdList.sort((R,M)=>{let Q=b.common[R].order,se=b.common[M].order;return Q-se}),h.sprite=b,h.customStickers=v,h.transform=this.editor.transformToolStore.serializableState;let x,I;if(e){let R=or.getDataURL(l);I=tm(R),x=im(R)}this.editor.modalStore.hideModal(),r(m.serialise(h,x,I)),t&&this.editor.transformToolStore.onEnter()}catch(l){this.editor.modalStore.hideModal(),o(l)}}))})}deserialize(e){return this.editor.modalStore.showInfoModal("loading"),new Promise((t,r)=>{try{import("./serialization/index.js").then(({Deserializer:o})=>{o.checkIsSerialisationValid(e)?this.applySerialization(e,o,t,r):(this.editor.modalStore.hideModal(),this.editor.modalStore.showActionModal({type:oe.WARNING,identifier:"unsupportedSerializationVersion",handleConfirm:()=>this.applySerialization(e,o,t,r)}))})}catch(o){this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),r(o)}})}static getDataURL(e){if(e instanceof HTMLImageElement){let{src:o}=e;if(em(o))return o}if(e instanceof HTMLCanvasElement)return e.toDataURL(Be.PNG);let t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t.toDataURL(Be.PNG)}applyStateOnUI(e){return C(this,null,function*(){let t=this.editor.activeStore.tool===g.TRANSFORM;try{e.transform&&(t||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(e.transform,!0),yield this.editor.wait(),t||(this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),yield this.editor.wait(),this.editor.transformToolStore.onLeave())),e.filter&&(yield this.editor.filterToolStore.updateStateFromSerialization(e.filter)),e.adjustment&&this.editor.adjustmentsToolStore.updateStateFromSerialization(e.adjustment),e.focus&&(yield this.editor.focusToolStore.updateStateFromSerialization(e.focus)),e.overlay&&(yield this.editor.overlayToolStore.updateStateFromSerialization(e.overlay)),e.sprite&&(e.sprite.spriteIdList=e.sprite.spriteIdList.sort((r,o)=>{let n=e.sprite.common[r].order,s=e.sprite.common[o].order;return n-s}),yield this.editor.spriteStore.updateStateFromSerialization(e.sprite,e.customStickers)),e.brush&&this.editor.brushToolStore.updateStateFromHistory(e.brush),e.frame&&(yield this.editor.frameToolStore.updateStateFromSerialization(e.frame)),this.editor.outputContainer.updateChildrenContainers()}catch(r){console.error(r),this.editor.modalStore.showActionModal({type:oe.ERROR,identifier:"unexpectedError",error:r,handleConfirm:()=>{window.location.reload()}})}})}};var st={identifier:"identity",opacity:1,width:0,color:xe.white};var rm=new Dt(0,1),xt=class{constructor(e){this.changeIdentifier=e=>{this.state.identifier=e};this.changeOpacity=e=>{let t=rm.clamp(e);this.state.opacity=t};this.changeWidth=e=>{this.state.width=e};this.changeColor=e=>{this.state.color=e};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=st.identifier,this.state.opacity=st.opacity,this.state.width=st.width,this.state.color=st.color,this.removeIndex())};this.removeFrameEffect=()=>{this.effect&&(this.engine.removeEffect(this.effect),this.effect=void 0)};this.setEffectProperties=e=>this.effect?(this.removeIndex(),this.effect.setProperties(e),this.effect.getProperties()):null;this.setFrameEffect=({identifier:e,width:t,opacity:r,color:o})=>{let n=f({},this.state);this.changeIdentifier(e),this.changeWidth(t),this.changeOpacity(r),this.changeColor(o),this.removeFrameEffect();let s=this.engineMediator.orderHelper.addSprite(e);return new Promise((l,c)=>{this.engine.addFrameFromAssets(e,this.engineMediator.image.container,s).then(p=>{this.effect=p,this.effect.setProperties({tintColor:o,opacity:r,width:t}),l()}).catch(p=>{this.changeIdentifier(n.identifier),this.changeOpacity(n.opacity),this.changeWidth(n.width),this.changeColor(n.color),n.identifier==="identity"&&this.removeIndex(),c(p)})})};this.removeIndex=()=>{this.engineMediator.orderHelper.removeSprite(this.state.identifier)};this.engineMediator=e,this.state=st}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}};a([S],xt.prototype,"state",2),a([d],xt.prototype,"changeIdentifier",2),a([d],xt.prototype,"changeOpacity",2),a([d],xt.prototype,"changeWidth",2),a([d],xt.prototype,"changeColor",2),a([d],xt.prototype,"reset",2);var J=class{constructor(e){this.colorList=ie.defaultColors;this.selectFrame=e=>C(this,null,function*(){if(e!==this.identifier){let t=.1*this.editor.shortestOutputSide;yield this.frameStore.setFrameEffect({identifier:e,width:t,opacity:1,color:st.color}),this.editor.render(),this.addSnapshot(F.ADD,g.FRAME)}});this.changeOpacity=e=>{let t=this.frameStore.setEffectProperties({opacity:e});t&&(this.frameStore.changeOpacity(t.opacity),this.editor.render())};this.changeWidth=e=>{let t=this.frameStore.setEffectProperties({width:e});t&&(this.frameStore.changeWidth(t.width),this.editor.render())};this.changeColor=e=>{let t=this.frameStore.setEffectProperties({tintColor:e});t&&(this.frameStore.changeColor(t.tintColor),this.editor.render())};this.colorSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.controls.selectColor)};this.toolSnapshot=e=>{this.addSnapshot(F.EDIT,e)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.pureReset=()=>{this.frameStore.removeFrameEffect(),this.frameStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(F.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromHistory=e=>e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.frameStore.setFrameEffect(e);this.updateStateFromSerialization=e=>C(this,null,function*(){return this.entityManager.items.find(r=>r.identifier===e.identifier)?this.frameStore.setFrameEffect(e):new Promise((r,o)=>{o(new Error("Frame Asset doesn't exist"))})});this.editor=e,this.frameStore=new xt(this.editor.engineMediator);let t=this.editor.assetProvider.getAssets("frame"),{config:r}=this;this.entityManager=new ee(t,f(f({},r),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("frame")})),st.color=k(Ge(this.config,"defaultColor",st.color)),this.config.colors&&this.config.colors.length>0&&(this.colorList=Ke(k(this.config.colors)))}get state(){return this.frameStore.state}get identifier(){return this.state.identifier}get color(){return this.state.color}get size(){return this.state.width}get tintable(){let e=this.entityManager.items.find(t=>t.identifier===this.identifier);return e&&e.tintable||!1}get opacity(){return this.state.opacity}get minSize(){return this.editor.shortestOutputSide*.05}get maxSize(){return this.editor.shortestOutputSide*.3}get config(){return this.editor.configStore.config[g.FRAME]}get locale(){return this.editor.configStore.locale[g.FRAME]}get localeColor(){return this.editor.configStore.locale.common.color}get items(){return this.entityManager.items}get isOptionSelected(){return this.identifier!=="identity"}};a([d],J.prototype,"selectFrame",2),a([d],J.prototype,"changeOpacity",2),a([d],J.prototype,"changeWidth",2),a([d],J.prototype,"changeColor",2),a([d],J.prototype,"pureReset",2),a([d],J.prototype,"reset",2),a([d],J.prototype,"updateStateFromHistory",2),a([d],J.prototype,"updateStateFromSerialization",2),a([u],J.prototype,"state",1),a([u],J.prototype,"identifier",1),a([u],J.prototype,"color",1),a([u],J.prototype,"size",1),a([u],J.prototype,"tintable",1),a([u],J.prototype,"opacity",1),a([u],J.prototype,"minSize",1),a([u],J.prototype,"maxSize",1),a([u],J.prototype,"config",1),a([u],J.prototype,"locale",1),a([u],J.prototype,"localeColor",1),a([u],J.prototype,"items",1),a([u],J.prototype,"isOptionSelected",1);var om={categories:[],query:""},Fe=class{constructor(e){this.initProvider=e=>{e&&(this.libraryProvider=new e)};this.fetchImages=(e="")=>C(this,null,function*(){if(this.libraryProvider){let t=null;try{let r=yield this.libraryProvider.getCategories(),o=yield this.libraryProvider.searchImages(e);t=r.map((n,s)=>{let l=o.filter(c=>c.category===n.name);return{identifier:n.name,name:n.name,thumbnailURI:n.coverImageUrl,items:l.map(c=>({name:c.title||`image${s}`,identifier:`${n.name}-${c.title}-${s}`,thumbnailURI:c.thumbUrl,rawUrl:c.rawUrl,authorName:c.authorName,authorAvatar:c.authorAvatar}))}}).filter(n=>n.items.length)}catch(r){console.log(r)}re(()=>{this.state.query=e,this.state.categories=t})}});this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory!==e?e:""};this.getRawUrl=e=>{let t=this.items.findIndex(r=>r.identifier===e);return t!==-1?this.items[t].rawUrl:e};this.configStore=e.configStore,this.state=S(om),this.selectedCategory=""}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.state.categories}get items(){return this.state.categories.map(e=>e.items).reduce((e,t)=>[...e,...t],[])}get query(){return this.state.query}get config(){return this.configStore.config[g.LIBRARY]}get locale(){return this.configStore.locale[g.LIBRARY]}};a([S],Fe.prototype,"selectedCategory",2),a([d],Fe.prototype,"initProvider",2),a([d],Fe.prototype,"fetchImages",2),a([d],Fe.prototype,"toggleCategorySelection",2),a([u],Fe.prototype,"selectedCategoryIdentifier",1),a([u],Fe.prototype,"categories",1),a([u],Fe.prototype,"items",1),a([u],Fe.prototype,"query",1),a([u],Fe.prototype,"config",1),a([u],Fe.prototype,"locale",1);var nr={identifier:"identity",opacity:1,blendMode:j.LIGHTEN};var nm=new Dt(0,1),Ct=class{constructor(e,t){this.changeIdentifier=e=>{this.state.identifier=e};this.changeOpacity=e=>{let t=nm.clamp(e);this.state.opacity=t};this.changeBlendMode=e=>{this.state.blendMode=e};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=nr.identifier,this.state.opacity=nr.opacity,this.state.blendMode=nr.blendMode,this.removeIndex())};this.correctOverlayFlip=()=>{let{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();this.effect&&(this.effect.setFlipHorizontally(e),this.effect.setFlipVertically(t))};this.removeOverlayEffect=()=>{this.effect&&(this.removeIndex(),this.engineMediator.engine.removeEffect(this.effect),this.effect=void 0)};this.setEffectProperties=e=>this.effect?(this.effect.setProperties(e),this.effect.getProperties()):null;this.setOverlayEffect=({identifier:e,blendMode:t,opacity:r})=>{let o=f({},this.state);this.changeIdentifier(e),this.changeOpacity(r),this.changeBlendMode(t),this.removeOverlayEffect();let n=this.engineMediator.orderHelper.addIndex(g.OVERLAY);return new Promise((s,l)=>{this.engineMediator.engine.addOverlayFromAssets(e,this.engineMediator.image.container,n).then(c=>{this.effect=c,this.effect.setProperties({blendMode:t,opacity:r}),this.correctOverlayFlip(),s()}).catch(c=>{this.changeIdentifier(o.identifier),this.changeOpacity(o.opacity),this.changeBlendMode(o.blendMode),o.identifier==="identity"&&this.removeIndex(),l(c)})})};this.removeIndex=()=>{this.engineMediator.orderHelper.removeIndex(g.OVERLAY)};this.engineMediator=e,this.editor=t,this.state=nr}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}};a([S],Ct.prototype,"state",2),a([d],Ct.prototype,"changeIdentifier",2),a([d],Ct.prototype,"changeOpacity",2),a([d],Ct.prototype,"changeBlendMode",2),a([d],Ct.prototype,"reset",2),a([d],Ct.prototype,"correctOverlayFlip",2);var ce=class{constructor(e){this.selectOverlay=e=>C(this,null,function*(){if(e!==this.identifier){let t=this.defaultBlendModeForIdentifier(e);yield this.overlayStore.setOverlayEffect({identifier:e,opacity:1,blendMode:t}),this.addSnapshot(F.ADD,g.OVERLAY),this.editor.render()}});this.changeOpacity=e=>{let t=this.overlayStore.setEffectProperties({opacity:e});t&&(this.overlayStore.changeOpacity(t.opacity),this.editor.render())};this.toolSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.controls.sliderOpacity)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.changeBlendMode=e=>{let t=this.overlayStore.setEffectProperties({blendMode:e});t&&(this.overlayStore.changeBlendMode(t.blendMode),this.addSnapshot(F.EDIT,this.locale.controls.carouselBlendMode),this.editor.render())};this.pureReset=()=>{this.overlayStore.removeOverlayEffect(),this.overlayStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(F.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromSerialization=e=>C(this,null,function*(){return this.entityManager.items.find(r=>r.identifier===e.identifier)?this.overlayStore.setOverlayEffect(e):new Promise((r,o)=>{o(new Error(`Overlay Asset ${e.identifier} doesn't exist`))})});this.updateStateFromHistory=e=>C(this,null,function*(){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.overlayStore.setOverlayEffect(e)});this.correctOverlayFlip=()=>{this.overlayStore.correctOverlayFlip()};this.defaultBlendModeForIdentifier=e=>{let t=this.entityManager.items.findIndex(r=>r.identifier===e);return t!==-1?this.entityManager.items[t].defaultBlendMode:j.LIGHTEN};this.editor=e,this.overlayStore=new Ct(this.editor.engineMediator,e);let t=this.editor.assetProvider.getAssets("overlay"),{config:r}=this;this.entityManager=new ee(t,f(f({},r),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("overlay")}))}get state(){return this.overlayStore.state}get identifier(){return this.overlayStore.state.identifier}get opacity(){return this.overlayStore.state.opacity}get blendMode(){return this.overlayStore.state.blendMode}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[g.OVERLAY]}get locale(){return this.editor.configStore.locale[g.OVERLAY]}get items(){return this.entityManager.items}get allBlendModes(){let e=this.locale.controls;return Object.keys(j).map(t=>{let r=j[t],o=`blendMode${r.charAt(0).toUpperCase()}${r.slice(1)}`;return{identifier:r,value:e[o]}})}};a([d],ce.prototype,"selectOverlay",2),a([d],ce.prototype,"changeOpacity",2),a([d],ce.prototype,"changeBlendMode",2),a([d],ce.prototype,"pureReset",2),a([d],ce.prototype,"reset",2),a([d],ce.prototype,"updateStateFromSerialization",2),a([d],ce.prototype,"updateStateFromHistory",2),a([d],ce.prototype,"correctOverlayFlip",2),a([u],ce.prototype,"state",1),a([u],ce.prototype,"identifier",1),a([u],ce.prototype,"opacity",1),a([u],ce.prototype,"blendMode",1),a([u],ce.prototype,"isOptionSelected",1),a([u],ce.prototype,"config",1),a([u],ce.prototype,"locale",1),a([u],ce.prototype,"items",1),a([u],ce.prototype,"allBlendModes",1);var sm=i=>{let e=atob(i.split(",")[1]),t=i.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(e.length),o=new Uint8Array(r);for(let n=0;n<e.length;n+=1)o[n]=e.charCodeAt(n);return new Blob([r],{type:t})},gs=sm;var ro=Ye(bs());var sr=class{static isImageElement(e){return e instanceof HTMLImageElement}constructor({license:e,assetProvider:t,crossOrigin:r}){this.crossOrigin=r,this.engine=new tr({license:e,crossOrigin:r,assetProvider:t,downscaleOptions:{maxDimensions:{width:100,height:100}}})}getAllFilterPreviewThumbnails(e){return new Promise((t,r)=>{let o=[],n=[];e.forEach(s=>{s.isDuotone?o.push(s.identifier):n.push(s.identifier)}),this.getAllDuotonePreview(o).then(s=>{this.getAllLutPreview(n).then(l=>{t(Object.assign(s,l))})}).catch(s=>{r(s)})})}getAllDuotonePreview(e){return C(this,null,function*(){let t={};if(!e.length)return t;let r=yield this.engine.addDuoToneFilterFromAssets(e[0],this.container);return yield ro.default(e,o=>C(this,null,function*(){let n=this.engine.assetProvider.getDuotoneFilterAsset(o);r.filterOperation.getFilter().set({intensity:.5,lightColor:pe.Color.fromHex(n.lightColor),darkColor:pe.Color.fromHex(n.darkColor)});let l=yield this.engine.export($e.DATA_URL,Be.PNG);t[o]=l}),{concurrency:1}),this.engine.removeEffect(r),t})}loadLutAssets(e){return C(this,null,function*(){let t={};return yield ro.default(e,r=>C(this,null,function*(){t[r]=yield this.engine.getLutFilterImage(r)})),t})}getAllLutPreview(e){return C(this,null,function*(){let t={};if(!e.length)return t;let r=yield this.loadLutAssets(e),o=yield this.engine.addLUTFilterFromAssets(e[0],this.container);return yield ro.default(e,n=>C(this,null,function*(){let s=this.engine.assetProvider.getLUTFilterAsset(n),l=o.filterOperation.getFilter(),c={horizontalTileCount:s.horizontalTileCount||5,verticalTileCount:s.verticalTileCount||5,image:r[n]};l.set(f(f({},c),{intensity:s.defaultIntensity||1})),o.setProperties({intensity:1}),l._lutPrimitive.set(c);let p=yield this.engine.export($e.DATA_URL,Be.PNG);t[n]=p}),{concurrency:1}),this.engine.removeEffect(o),t})}addImageToContainer(e){return new Promise((t,r)=>{let o;sr.isImageElement(e)?(o=e,this.setBackgroundImage(o),t()):this.getImageElement(e).then(n=>{o=n,this.setBackgroundImage(o),t()}).catch(n=>{r({identifier:"imageLoading",message:n.message})})})}getImageElement(e){return new Promise((t,r)=>{let o=new Image;o.addEventListener("load",()=>{t(o)}),o.addEventListener("error",n=>{r(n)}),o.crossOrigin=this.crossOrigin,o.src=e})}setBackgroundImage(e){this.container?this.container.setData({image:e}):this.container=this.engine.addImage({image:e,blendMode:j.NORMAL,opacity:1});let{size:t}=this.container.getBounds();this.engine.getOutputContainer().setResolution(t)}};var ar={size:0,color:xe.white,hardness:0,maximumSize:.125,minimumSize:0,maximumHardness:1,minimumHardness:0};var Y=class{constructor(e){this.colorList=ie.defaultColors;this.dirty=S.box(!1);this.id="";this.containerId=()=>this.id;this.initSize=()=>{let{minimumSize:e,maximumSize:t}=this.state,{size:r}=this;r===0&&this.changeSize(Vn(this.config,"defaultSize",[e,t]))};this.changeColor=e=>{this.state.color=e};this.changeSize=e=>{this.state.size=e};this.changeRelativeSize=e=>{let{maximumSize:t,minimumSize:r}=this.state;this.state.size=(t-r)*e/100+r};this.changeHardness=e=>{this.state.hardness=e};this.reset=()=>{this.pureReset(),this.addSnapshot(F.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.editor=e,this.state=f(f({},ar),{hardness:Vn(this.config,"defaultHardness",[ar.minimumHardness,ar.maximumHardness]),color:k(Ge(this.config,"defaultColor",ar.color))}),this.config.colors&&this.config.colors.length>0&&(this.colorList=Ke(k(this.config.colors)))}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}clickableCanvas(e){this.editor.clickableCanvas(e)}beginStroke(e=[]){if(!this.drawingContainer){let t=this.editor.orderHelper.addSprite(g.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:e},this.editor.imageContainer,t)}this.id=this.drawingContainer.getID(),this.drawingContainer.beginStroke({id:"imgly_brush_radial",color:k(this.state.color),size:this.state.size,hardness:this.state.hardness})}strokePosition(e){if(this.drawingContainer){let t=this.editor.previewToWorld(e,!1);this.drawingContainer.addPointToCurrentStroke(t),this.editor.render()}}endStroke(){this.drawingContainer&&(this.drawingContainer.endStroke(),this.editor.render(),this.strokes=this.drawingContainer.getData(),this.addSnapshot(F.EDIT,this.locale.history.brushStroke),this.dirty.set(!0))}updateStateFromHistory(e){if(e=e||{strokes:[]},this.drawingContainer){if(this.strokes&&this.strokes.strokes.length===e.strokes.length)return;this.strokes=e,this.drawingContainer.setData(this.strokes),e.strokes.length!==0&&this.dirty.set(!0)}else{let t=this.editor.orderHelper.addSprite(g.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:e.strokes},this.editor.imageContainer,t),this.strokes=this.drawingContainer.getData()}this.id=this.drawingContainer.getID()}pureReset(){this.dirty.set(!1),this.strokes={strokes:[]},this.drawingContainer&&(this.editor.engine.removeContainer(this.drawingContainer),this.drawingContainer=void 0)}get config(){return this.editor.configStore.config[g.BRUSH]}get locale(){return this.editor.configStore.locale[g.BRUSH]}get localeColor(){return this.editor.configStore.locale.common.color}get color(){return this.state.color}get size(){return this.state.size}get relativeSize(){let{size:e,maximumSize:t,minimumSize:r}=this.state;return(e-r)*100/(t-r)}get sizeOnScreenSpace(){let e=this.editor.engineMediator.engine.getSmallerOutputSide();return this.editor.worldToPreview(this.state.size*e)}get hardness(){return this.state.hardness}get isDirty(){return this.dirty.get()}};a([S],Y.prototype,"state",2),a([S],Y.prototype,"dirty",2),a([d],Y.prototype,"initSize",2),a([d],Y.prototype,"changeColor",2),a([d],Y.prototype,"changeSize",2),a([d],Y.prototype,"changeRelativeSize",2),a([d],Y.prototype,"changeHardness",2),a([d],Y.prototype,"clickableCanvas",1),a([d],Y.prototype,"beginStroke",1),a([d],Y.prototype,"strokePosition",1),a([d],Y.prototype,"endStroke",1),a([d],Y.prototype,"updateStateFromHistory",1),a([d],Y.prototype,"reset",2),a([u],Y.prototype,"config",1),a([u],Y.prototype,"locale",1),a([u],Y.prototype,"localeColor",1),a([u],Y.prototype,"color",1),a([u],Y.prototype,"size",1),a([u],Y.prototype,"relativeSize",1),a([u],Y.prototype,"sizeOnScreenSpace",1),a([u],Y.prototype,"hardness",1),a([u],Y.prototype,"isDirty",1);var Xe;(function(i){i.LEADING="leading",i.CENTER="center",i.TRAILING="trailing"})(Xe||(Xe={}));var am={horizontalGuides:[],verticalGuides:[],rotationGuides:[]},at=class{constructor(e){this.previewTopLeftPosition={x:0,y:0};this.getGuideValue=(e,t)=>{let{height:r,width:o}=this.editor.getPreviewSize(),{snapToLeft:n,snapToRight:s,snapToTop:l,snapToBottom:c}=this.configStore.config.snapping.position,p=Math.min(r,o),m=0;return t==="bottom"?m=Math.round(r-p*c):t==="top"?m=Math.round(p*l):t==="right"?m=Math.round(o-p*s):t==="left"?m=Math.round(p*n):e==="vertical"&&t==="center"?m=Math.round(o/2):e==="horizontal"&&t==="center"&&(m=Math.round(r/2)),m};this.getVerticalGuidesFromConfig=()=>{let{snapToVerticalCenter:e,snapToLeft:t,snapToRight:r}=this.configStore.config.snapping.position,o=[];return e&&o.push({value:this.getGuideValue("vertical","center"),edge:Xe.CENTER,isVisible:!1,direction:"vertical"}),t&&o.push({value:this.getGuideValue("vertical","left"),edge:Xe.LEADING,isVisible:!1,direction:"vertical"}),r&&o.push({value:this.getGuideValue("vertical","right"),edge:Xe.TRAILING,isVisible:!1,direction:"vertical"}),o};this.getHorizontalGuidesFromConfig=()=>{let{snapToHorizontalCenter:e,snapToTop:t,snapToBottom:r}=this.configStore.config.snapping.position,o=[];return e&&o.push({value:this.getGuideValue("horizontal","center"),edge:Xe.CENTER,isVisible:!1,direction:"horizontal"}),t&&o.push({value:this.getGuideValue("horizontal","top"),edge:Xe.LEADING,isVisible:!1,direction:"horizontal"}),r&&o.push({value:this.getGuideValue("horizontal","bottom"),edge:Xe.TRAILING,isVisible:!1,direction:"horizontal"}),o};this.getRotationGuidesFromConfig=()=>{let{angles:e}=this.configStore.config.snapping.rotation,t=[];return e.forEach(o=>{t.push(o),t.push(o+360),t.push(o-360)}),t.filter((o,n)=>t.indexOf(o)===n).map(o=>({value:o*Math.PI/180,edge:Xe.CENTER,isVisible:!1,position:{x:0,y:0}}))};this.getSpriteDimensions=({leftTop:e,leftBottom:t,rightTop:r,rightBottom:o})=>{let n=Math.min(e.y,r.y,t.y,o.y),s=Math.max(e.y,r.y,t.y,o.y),l=Math.min(e.x,r.x,t.x,o.x),c=Math.max(e.x,r.x,t.x,o.x);return{height:Math.round(s-n),width:Math.round(c-l)}};this.mapRange=({value:e,fromMin:t,fromLength:r,toMin:o,toLength:n})=>(e-t)*n/r+o;this.updateGuides=()=>{this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig()};this.mapToSnapSystem=(e,t,r,o)=>{if(t.length===0)return e;if(t[0]>e)return e-r;for(let n=0;n<t.length-1;n+=1){let s=t[n],l=t[n+1],c=s+r,p=l-r,m=0;o&&(m=n*r*2,c+=m,p+=m+r*2);let h=1e-5;if(s<=e&&e<=l)return e<=s+h?s+m:e>=l-h?l+m+(o?r*2:0):this.mapRange({value:e,fromMin:s,fromLength:l-s,toMin:c,toLength:p-c})}return o?e+(t.length-1)*r*2+r:e};this.mapFromSnapSystem=(e,t,r,o)=>{if(t.length===0)return e;if(t[0]>e)return e>=t[0]-r?t[0]:e+r;let n=e;for(let l=0;l<t.length-1;l+=1){let c=t[l],p=t[l+1],m=c+r,h=p-r,b=p;if(o&&(h+=r*2,b+=r*2,n=e-l*r*2),c<=n&&n<=b)return m<=n&&n<=h?this.mapRange({value:n,fromMin:m,fromLength:h-m,toMin:c,toLength:p-c}):n<m?c:p}n-=r*3;let s=t[t.length-1];return n<=s?s:n};this.centerSnapValue=(e,t)=>{let r=t*.5,{value:o,edge:n}=e,s=o;return n===Xe.LEADING?s+=r:n===Xe.TRAILING&&(s-=r),s};this.mapSnappingGuidesToCenter=(e,t)=>{let r=[];return e.forEach(o=>{r.push(this.centerSnapValue(o,t))}),r};this.calcSnapThresholdInRadians=(e,t)=>e===0?0:t/e;this.calculatePreviewTopLeftPosition=()=>{let e=this.editor.engineMediator.preview.container.getPosition(),t=this.editor.getPreviewSize(),r=ie.devicePixelRatio;this.previewTopLeftPosition={x:e.x/r-t.width/2,y:e.y/r-t.height/2}};this.snapToRotation=(e,t,r)=>{let{rotationGuides:o}=this.state,{enabled:n,threshold:s}=this.configStore.config.snapping.rotation,{x:l,y:c}=this.previewTopLeftPosition,{width:p}=this.editor.getPreviewSize(),m=(e+Math.PI*2)%(Math.PI*2);if(n){let h=new _(t).magnitude,b=o.map(I=>I.value).sort((I,R)=>I-R),v=this.calcSnapThresholdInRadians(h,s);if(!this.rotationOffset){let I=this.mapToSnapSystem(e,b,v,!1);this.rotationOffset=I-m}m=this.mapFromSnapSystem(m+this.rotationOffset,b,v,!1);let x={x:r.position.x-l-p,y:r.position.y-c};return o.forEach(I=>{I.isVisible=I.value===m,I.position=x}),m}return e};this.snapToPosition=(e,t)=>{let{horizontalGuides:r,verticalGuides:o}=this.state,{enabled:n,threshold:s}=this.configStore.config.snapping.position,l=new _(this.previewTopLeftPosition),{height:c,width:p}=this.getSpriteDimensions(t),{x:m,y:h}=new _(e).subtract(l);if(n){let b=this.mapSnappingGuidesToCenter(r,c).sort((R,M)=>R-M),v=this.mapSnappingGuidesToCenter(o,p).sort((R,M)=>R-M);if(!this.positionOffset){let R=this.mapToSnapSystem(m,v,s,!0),M=this.mapToSnapSystem(h,b,s,!0);this.positionOffset=new _(R,M).subtract(new _(m,h))}let x=this.mapFromSnapSystem(m+this.positionOffset.x,v,s,!0),I=this.mapFromSnapSystem(h+this.positionOffset.y,b,s,!0);return x=Math.round(x),I=Math.round(I),r.forEach(R=>{let M=Math.round(this.centerSnapValue(R,c));R.isVisible=M===I}),o.forEach(R=>{let M=Math.round(this.centerSnapValue(R,p));R.isVisible=M===x}),new _(x,I).add(l)}return{x:m,y:h}};this.editor=e,this.configStore=e.configStore,this.state=S(am),this.rotationOffset=null,this.positionOffset=null,this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig(),this.state.rotationGuides=this.getRotationGuidesFromConfig()}hidePositionGuides(){this.positionOffset=null,this.state.verticalGuides=this.state.verticalGuides.map(e=>f(f({},e),{isVisible:!1})),this.state.horizontalGuides=this.state.horizontalGuides.map(e=>f(f({},e),{isVisible:!1}))}hideRotationGuides(){this.rotationOffset=null,this.state.rotationGuides=this.state.rotationGuides.map(e=>f(f({},e),{isVisible:!1}))}get positionGuides(){let{verticalGuides:e,horizontalGuides:t}=this.state;return[...e,...t]}get rotationGuides(){return this.state.rotationGuides}};a([S],at.prototype,"state",2),a([d],at.prototype,"snapToRotation",2),a([d],at.prototype,"snapToPosition",2),a([d],at.prototype,"hidePositionGuides",1),a([d],at.prototype,"hideRotationGuides",1),a([u],at.prototype,"positionGuides",1),a([u],at.prototype,"rotationGuides",1);function oo(i,e=null){return new Promise((t,r)=>{let o=new Image;o.addEventListener("load",()=>{let n=document.createElement("canvas"),s=n.getContext("2d");n.width=o.width,n.height=o.height,e&&(n.width=e,n.height=e*o.height/o.width),s.drawImage(o,0,0,n.width,n.height),t(n.toDataURL(Gt.PNG))}),o.addEventListener("error",()=>{r()}),o.src=i})}var Xl=i=>new Promise((e,t)=>{let r=new FileReader;r.onload=o=>C(void 0,null,function*(){try{let{result:n}=o.target,s=yield oo(n,150);e({stickerURI:n,thumbnailURI:s,name:i.name||"",type:i.type,identifier:xi()})}catch(n){t(n)}}),r.onerror=o=>{t(o)},r.readAsDataURL(i)});var lm="white",Ae={identifier:"identity",opacity:1,tintColor:xe[lm],tintMode:"none",resizeMode:"keepAspect"},ys={};var Jl="identity",vs="imgly_sticker_custom",z=class{constructor(e){this.state=S.map(ys);this.customStickers=[];this.colorList=ie.defaultColors;this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.doesStickerAssetExist=e=>this.entityManager.items.findIndex(t=>t.identifier===e)!==-1;this.add=e=>{let t=this.entityManager.items.find(n=>n.identifier===e),r=t?t.tintMode:Ae.tintMode,o=t?t.resizeMode:Ae.resizeMode;this.editor.spriteStore.addSticker({state:{identifier:e,tintMode:r,tintColor:Ae.tintColor,opacity:Ae.opacity,resizeMode:o}})};this.duplicate=()=>{if(this.id){let e=this.editor.spriteStore.getDuplicateContainerTransform(this.id),t=this.editor.spriteStore.getDuplicateContainerFlip(this.id),{flipHorizontally:r,flipVertically:o}=this.editor.outputContainer.getData();this.editor.spriteStore.addSticker({state:{identifier:this.identifier,tintColor:k(this.tintColor),tintMode:this.tintMode,resizeMode:this.resizeMode,opacity:this.opacity,flipHorizontally:r!==t.flipHorizontally,flipVertically:o!==t.flipVertically},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.flipHorizontally=()=>{this.id&&this.editor.spriteStore.flipHorizontally(this.id)};this.delete=()=>{if(this.id){let e=this.id;this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast()}};this.updateStateFromHistory=(e,t)=>{this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)};this.setState=(e,t)=>{let r=this.state.get(e);r?("opacity"in t&&(r.opacity=t.opacity),t.tintColor&&(r.tintColor=t.tintColor),t.tintMode&&(r.tintMode=t.tintMode),t.resizeMode&&(r.resizeMode=t.resizeMode),this.state.set(e,r)):this.state.set(e,{identifier:t.identifier,opacity:t.opacity,tintMode:t.tintMode,resizeMode:t.resizeMode,tintColor:t.tintColor?t.tintColor:Ae.tintColor})};this.changeOpacity=e=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{opacity:e});let r=this.editor.spriteStore.getContainerProperties(this.id);t.opacity=r.opacity,this.state.set(this.id,t)}}};this.changeTintColor=e=>{if(this.id){let t=this.state.get(this.id);if(t){let{tintMode:r}=this.entityManager.items.find(n=>n.identifier===this.identifier);this.editor.spriteStore.setContainerProperties(this.id,{tintColor:e,tintMode:r});let o=this.editor.spriteStore.getContainerProperties(this.id);t.tintColor=o.tintColor,t.tintMode=o.tintMode||Ae.tintMode,this.state.set(this.id,t)}}};this.tintColorSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.history.color)};this.addFiles=e=>C(this,null,function*(){if(this.editor.modalStore.showInfoModal("loading"),e.length){let t=0,r=[];for(t=0;t<e.length;t+=1)r.push(Xl(e[t]));try{let o=yield Promise.all(r);this.addCustomStickerAsset(o),this.editor.configStore.events.onStickerUploadedAdd(o.map(({identifier:n,stickerURI:s},l)=>({identifier:n,stickerURI:s,file:e[l]})))}catch(o){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}}});this.addCustomStickerAsset=e=>C(this,null,function*(){let t=[];e.forEach(({stickerURI:s,thumbnailURI:l,name:c,identifier:p,type:m})=>{t.push({stickerURI:s,thumbnailURI:l,name:c,tintMode:this.customStickerTintMode,resizeMode:"keepAspect",identifier:p}),this.customStickers.push({identifier:p,type:m,stickerURI:s,name:c})});let r=this.locale.categories[vs];this.editor.assetProvider.addCustomStickerAsset(t,vs,r);let o=this.editor.assetProvider.getAssets("sticker"),{config:n}=this;this.entityManager=new ee(o,f(f({},n),{categoryKey:"thumbnailURI",itemKey:"stickerURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("sticker")})),this.selectedCategory=vs,this.editor.modalStore.hideModal()});this.toolSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.history.opacity)};this.addSnapshot=(e,t)=>{this.currentSticker&&this.editor.spriteStore.addSnapshot(e,t)};this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory===e?Jl:e};this.pureReset=()=>{this.state=S.map(ys)};this.editor=e,this.selectedCategory=Jl;let{config:t}=this,r=this.editor.assetProvider.getAssets("sticker");this.entityManager=new ee(r,f(f({},t),{categoryKey:"thumbnailURI",itemKey:"stickerURI",locale:f(f({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("sticker")})),Ae.tintColor=k(Ge(this.config,"defaultTintColor",Ae.tintColor)),this.config.colors&&this.config.colors.length>0&&(this.colorList=Ke(k(this.config.colors)))}get isStickerSelected(){return this.editor.spriteStore.isSpriteSticker}get isCustomStickerEnabled(){return this.config.enableCustomUpload}get customStickerTintMode(){return this.config.customStickerTintMode}get currentSticker(){if(this.isStickerSelected){let e=this.state.get(this.id);if(e)return e}}get identifier(){if(this.isStickerSelected){let e=this.state.get(this.id);if(e)return e.identifier}return"none"}get id(){if(this.isStickerSelected)return this.editor.spriteStore.id}get opacity(){return this.currentSticker?this.currentSticker.opacity:Ae.opacity}get tintMode(){return this.currentSticker?this.currentSticker.tintMode:Ae.tintMode}get resizeMode(){return this.currentSticker?this.currentSticker.resizeMode:Ae.resizeMode}get tintable(){return this.currentSticker?this.currentSticker.tintMode==="solid"||this.currentSticker.tintMode==="colorized":!1}get tintColor(){return this.currentSticker?this.currentSticker.tintColor:Ae.tintColor}get config(){return this.editor.configStore.config[g.STICKER]}get locale(){return this.editor.configStore.locale[g.STICKER]}get localeColor(){return this.editor.configStore.locale.common.color}get selectedCategoryIdentifier(){return this.selectedCategory}get items(){return this.entityManager.items}get categories(){return this.entityManager.categories}};a([S],z.prototype,"selectedCategory",2),a([S],z.prototype,"entityManager",2),a([d],z.prototype,"selectLast",2),a([d],z.prototype,"add",2),a([d],z.prototype,"duplicate",2),a([d],z.prototype,"bringToFront",2),a([d],z.prototype,"flipHorizontally",2),a([d],z.prototype,"delete",2),a([d],z.prototype,"updateStateFromHistory",2),a([d],z.prototype,"setState",2),a([d],z.prototype,"changeOpacity",2),a([d],z.prototype,"changeTintColor",2),a([d],z.prototype,"addFiles",2),a([d],z.prototype,"addCustomStickerAsset",2),a([d],z.prototype,"toggleCategorySelection",2),a([d],z.prototype,"pureReset",2),a([u],z.prototype,"isStickerSelected",1),a([u],z.prototype,"isCustomStickerEnabled",1),a([u],z.prototype,"customStickerTintMode",1),a([u],z.prototype,"currentSticker",1),a([u],z.prototype,"identifier",1),a([u],z.prototype,"id",1),a([u],z.prototype,"opacity",1),a([u],z.prototype,"tintMode",1),a([u],z.prototype,"resizeMode",1),a([u],z.prototype,"tintable",1),a([u],z.prototype,"tintColor",1),a([u],z.prototype,"config",1),a([u],z.prototype,"locale",1),a([u],z.prototype,"localeColor",1),a([u],z.prototype,"selectedCategoryIdentifier",1),a([u],z.prototype,"items",1),a([u],z.prototype,"categories",1);var cm="imgly_font_open_sans_bold",G={text:"Write Something",identifier:cm,fontSize:73.3,defaultFontSize:73.3,fontFamily:"Open Sans",fontStyle:"",fontWeight:"bold",lineHeight:1,alignment:"center",textColor:xe.white,backgroundColor:xe.transparent||[0,0,0,0],width:0},_s={};var Zl={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"SemiBold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular",lighter:"Lighter"},ki=class{constructor(e){this.state=S.map(_s);this.colorList=ie.defaultColors;this.backgroundColorList=ie.defaultBackgroundColors;this.loadingObservable=S.box(!1);this.loadfonts=e=>{if(this.fontsLoaded)e();else{let t=this.editor.assetProvider.getFontManager(),r=this.editor.assetProvider.getFontAssetsForText().map(o=>o.identifier);t.loadFontsWithIdentifiers(r).then(()=>{this.loadingObservable.set(!0),e()}).catch(o=>{console.error(o),this.editor.modalStore.showActionModal({type:oe.ERROR,identifier:"fontLoading",error:o})})}};this.doesTextAssetExist=e=>this.editor.assetProvider.getFontAssets().findIndex(t=>t.identifier===e)!==-1;this.validFontWithConfig=e=>this.fonts.find(t=>t.identifier===e)||this.fonts[0];this.addOrselect=()=>{this.state.size?this.selectLast():this.add()};this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.add=()=>{let e=()=>{this.editor.spriteStore.addText({state:{identifier:G.identifier,text:G.text,textColor:G.textColor,backgroundColor:G.backgroundColor,lineHeight:G.lineHeight,alignment:G.alignment,fontSize:0}})};this.loadfonts(e)};this.duplicate=()=>{if(this.id){let e=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addText({state:{identifier:this.identifier,text:this.text,textColor:k(this.textColor),lineHeight:this.lineHeight,alignment:this.alignment,fontSize:this.fontSize,backgroundColor:k(this.backgroundColor),width:this.width},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.delete=()=>{if(this.id){let e=this.id;this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast()}};this.setEditMode=e=>{this.editor.spriteStore.setEditMode(e)};this.changeFont=e=>{let t=this.fonts.find(r=>r.identifier===e);this.changeIdentifier(t,this.id),this.id&&this.addSnapshot(F.EDIT,this.locale.history.fontFamily)};this.changeIdentifier=(e,t)=>{re(()=>{if(e&&t){let r=this.state.get(t);if(r){this.editor.spriteStore.setContainerProperties(t,{fontIdentifier:e.identifier},!0);let o=this.editor.spriteStore.getContainerProperties(t);r.identifier=o.fontIdentifier,r.fontFamily=e.fontFamily,r.fontStyle=e.fontStyle,r.fontWeight=e.fontWeight,r.fontSize=o.fontSize,r.width=o.width,r.defaultFontSize=r.fontSize,this.state.set(t,r)}}})};this.changeFontSize=(e,t=!1)=>{if(this.id){let r=this.state.get(this.id);r&&(r.fontSize=e,t&&(r.defaultFontSize=e),this.state.set(this.id,r))}};this.updateDefaultFontSize=()=>{if(this.id){let e=this.state.get(this.id);e&&(e.defaultFontSize=e.fontSize,this.state.set(this.id,e))}};this.changeSize=(e,t)=>{let r=this.state.get(e);r&&(r.width=t.width,r.fontSize=t.fontSize,r.defaultFontSize=t.fontSize,this.state.set(e,r))};this.changeWidth=e=>{if(this.id){let t=this.state.get(this.id);t&&(t.width=e,this.state.set(this.id,t))}};this.changeText=e=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{text:e},!0);let r=this.editor.spriteStore.getContainerProperties(this.id),o=this.editor.outputContainer.getSizeInOutputSpace(),n=this.editor.spriteStore.getSize(this.id);this.config.disableAutoScaling||n.height>o.height&&this.editor.spriteStore.setContainerProperties(this.id,{fontSize:this.calculateFitFontSize(this.id,o.height)},!0),r=this.editor.spriteStore.getContainerProperties(this.id),t.text=r.text,t.fontSize=r.fontSize,t.defaultFontSize=r.fontSize,this.state.set(this.id,t),this.addSnapshot(F.EDIT,this.locale.history.edit)}}};this.calculateFitFontSize=(e,t)=>{if(!ki.measureContext){let v=document.createElement("canvas");ki.measureContext=v.getContext("2d")}let r=this.editor.spriteStore.getContainerProperties(e),o=this.editor.engine.assetProvider.getFontManager().getFontWithId(r.fontIdentifier),n=this.config.minFontSizeForAutoScaling,s=er(ki.measureContext,r.text,o,r.fontSize,r.lineHeight,r.width,o.textMetrics),l=Math.min(Math.floor(r.fontSize*(t/s.height)),1),c=Math.round(r.fontSize),p=0,m=c-l,h=Math.floor((c-l)*2),b=m;for(;p<=h;){m=p+Math.floor((h-p)/2);let v=er(ki.measureContext,r.text,o,m,r.lineHeight,r.width,o.textMetrics);if(t<v.height)h=m-1,b=m-1;else if(t>v.height){if(p=m+1,l+m>=c)return c}else{b=m;break}}return n&&b<n?n:b};this.changeLineHeight=e=>{if(this.id){let t=this.state.get(this.id);if(t&&e){this.editor.spriteStore.setContainerProperties(this.id,{lineHeight:e},!0);let r=this.editor.spriteStore.getContainerProperties(this.id);t.lineHeight=r.lineHeight,this.state.set(this.id,t)}}};this.changeColor=e=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{textColor:e});let r=this.editor.spriteStore.getContainerProperties(this.id);t.textColor=r.textColor,this.state.set(this.id,t)}}};this.changeBackgroundColor=e=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{backgroundColor:e});let r=this.editor.spriteStore.getContainerProperties(this.id);t.backgroundColor=r.backgroundColor,this.state.set(this.id,t)}}};this.colorSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.history.textColor)};this.backgroundColorSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.history.backgroundColor)};this.changeAlignment=e=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{alignment:e});let r=this.editor.spriteStore.getContainerProperties(this.id);t.alignment=r.alignment,this.state.set(this.id,t),this.addSnapshot(F.EDIT,this.locale.history.alignment)}}};this.toolSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.history.lineSpacing)};this.addSnapshot=(e,t)=>{this.currentText&&this.editor.spriteStore.addSnapshot(e,t)};this.updateStateFromHistory=(e,t)=>{this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)};this.setState=(e,t)=>{let r=this.state.get(e);if(r)t.alignment&&(r.alignment=t.alignment),t.text&&(r.text=t.text),t.lineHeight&&(r.lineHeight=t.lineHeight),t.textColor&&(r.textColor=t.textColor),t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.fontIdentifier&&(r.identifier=t.fontIdentifier),t.fontSize&&(r.fontSize=t.fontSize,r.defaultFontSize=t.fontSize),t.width&&(r.width=t.width);else{let o=this.validFontWithConfig(t.fontIdentifier);o&&this.state.set(e,{text:t.text,identifier:o.identifier,alignment:t.alignment,textColor:t.textColor?t.textColor:G.textColor,backgroundColor:t.backgroundColor?t.backgroundColor:G.backgroundColor,fontFamily:o.fontFamily,fontStyle:o.fontStyle,fontSize:t.fontSize,fontWeight:o.fontWeight,lineHeight:t.lineHeight,width:t.width,defaultFontSize:t.fontSize})}};this.setFontSize=e=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{fontSize:e},!0);let r=this.editor.spriteStore.getContainerProperties(this.id);t.fontSize=r.fontSize,t.defaultFontSize=r.fontSize,this.state.set(this.id,t)}}};this.pureReset=()=>{this.state=S.map(_s)};this.editor=e,this.fonts.find(t=>t.identifier===G.identifier)||(G.identifier=this.fonts[0].identifier),G.textColor=k(Ge(this.config,"defaultColor",G.textColor)),G.backgroundColor=k(Ge(this.config,"defaultBackgroundColor",G.backgroundColor)),G.text=this.locale.canvasControls.placeholderText,this.config.colors&&this.config.colors.length>0&&(this.colorList=Ke(k(this.config.colors))),this.config.backgroundColors&&this.config.backgroundColors.length>0&&(this.backgroundColorList=Ke(k(this.config.backgroundColors)))}static defaultText(){return G.text}static getDisplayFontStyle(e){let t=e.fontWeight&&Zl[e.fontWeight].toLowerCase()!=="regular"?Zl[e.fontWeight]:"",r=e.fontStyle&&e.fontStyle.toLowerCase()!=="normal"?e.fontStyle:"";return`${e.fontFamily.toLowerCase().includes(t.toLowerCase())?"":t} ${r}`.trim()}get isEditMode(){return this.editor.spriteStore.isEditMode}get isTextSelected(){return this.editor.spriteStore.isSpriteText}get fontsLoaded(){return this.loadingObservable.get()}get currentText(){if(this.isTextSelected){let e=this.state.get(this.id);if(e)return e}}get text(){return this.currentText?this.currentText.text:G.text}get fontSize(){return this.currentText?this.currentText.fontSize:G.fontSize}get defaultFontSize(){return this.currentText?this.currentText.defaultFontSize:G.defaultFontSize}get width(){return this.currentText?this.currentText.width:G.width}get fontFamily(){return this.currentText?this.currentText.fontFamily:G.fontFamily}get fontStyle(){return this.currentText?this.currentText.fontStyle:G.fontStyle}get fontWeight(){return this.currentText?this.currentText.fontWeight:G.fontWeight}get lineHeight(){return this.currentText?this.currentText.lineHeight:G.lineHeight}get identifier(){return this.currentText?this.currentText.identifier:G.identifier}get id(){if(this.isTextSelected)return this.editor.spriteStore.id}get alignment(){return this.currentText?this.currentText.alignment:G.alignment}get textColor(){return this.currentText?this.currentText.textColor:G.textColor}get backgroundColor(){return this.currentText?this.currentText.backgroundColor:G.backgroundColor}get config(){return this.editor.configStore.config[g.TEXT]}get locale(){return this.editor.configStore.locale[g.TEXT]}get localeColor(){return this.editor.configStore.locale.common.color}get rawOptions(){return this.editor.assetProvider.getFontAssetsForText()}get fonts(){return this.rawOptions.reduce((e,t)=>this.rawOptions.find(r=>r.identifier===t.identifier)?[...e,{identifier:t.identifier,fontFamily:t.fontFamily,fontStyle:t.fontStyle||"",fontWeight:t.fontWeight||""}]:e,[])}get fontFamilies(){return[...new Set(this.fonts)]}},O=ki;a([d],O.prototype,"addOrselect",2),a([d],O.prototype,"selectLast",2),a([d],O.prototype,"add",2),a([d],O.prototype,"duplicate",2),a([d],O.prototype,"bringToFront",2),a([d],O.prototype,"delete",2),a([d],O.prototype,"setEditMode",2),a([d],O.prototype,"changeFont",2),a([d],O.prototype,"changeIdentifier",2),a([d],O.prototype,"changeFontSize",2),a([d],O.prototype,"updateDefaultFontSize",2),a([d],O.prototype,"changeSize",2),a([d],O.prototype,"changeWidth",2),a([d],O.prototype,"changeText",2),a([d],O.prototype,"changeLineHeight",2),a([d],O.prototype,"changeColor",2),a([d],O.prototype,"changeBackgroundColor",2),a([d],O.prototype,"changeAlignment",2),a([d],O.prototype,"updateStateFromHistory",2),a([d],O.prototype,"setState",2),a([d],O.prototype,"setFontSize",2),a([d],O.prototype,"pureReset",2),a([u],O.prototype,"isEditMode",1),a([u],O.prototype,"isTextSelected",1),a([u],O.prototype,"fontsLoaded",1),a([u],O.prototype,"currentText",1),a([u],O.prototype,"text",1),a([u],O.prototype,"fontSize",1),a([u],O.prototype,"defaultFontSize",1),a([u],O.prototype,"width",1),a([u],O.prototype,"fontFamily",1),a([u],O.prototype,"fontStyle",1),a([u],O.prototype,"fontWeight",1),a([u],O.prototype,"lineHeight",1),a([u],O.prototype,"identifier",1),a([u],O.prototype,"id",1),a([u],O.prototype,"alignment",1),a([u],O.prototype,"textColor",1),a([u],O.prototype,"backgroundColor",1),a([u],O.prototype,"config",1),a([u],O.prototype,"locale",1),a([u],O.prototype,"localeColor",1),a([u],O.prototype,"rawOptions",1),a([u],O.prototype,"fonts",1),a([u],O.prototype,"fontFamilies",1);var um="imgly_text_design_blocks",ue={identifier:um,color:xe.white,isInverted:!1,text:"Write Something With Style",seed:0,padding:0,width:0},Ss={imgly_text_design_blocks:835,imgly_text_design_rotated:6,imgly_text_design_blocks_light:3,imgly_text_design_equal_width:727,imgly_text_design_masked:259,imgly_text_design_celebrate:579,imgly_text_design_sunshine:77,imgly_text_design_masked_badge:683,imgly_text_design_blocks_condensed:673,imgly_text_design_celebrate_simple:425,imgly_text_design_equal_width_fat:961,imgly_text_design_watercolor:671,imgly_text_design_particles:683,imgly_text_design_masked_speech_bubble:317,imgly_text_design_masked_speech_bubble_comic:229,imgly_text_design_multiline:831},Ds={};var U=class{constructor(e){this.state=S.map(Ds);this.colorList=ie.defaultColors;this.fontsLoaded=!1;this.loadfonts=e=>{if(this.fontsLoaded)e();else{let t=this.editor.assetProvider.getFontManager(),r=this.editor.assetProvider.getFontAssetsForTextDesign().map(o=>o.identifier);t.loadFontsWithIdentifiers(r).then(()=>{this.fontsLoaded=!0,e()}).catch(o=>{console.error(o),this.editor.modalStore.showActionModal({type:oe.ERROR,identifier:"fontLoading",error:r[0]})})}};this.doesTextDesignAssetExist=e=>this.entityManager.items.findIndex(t=>t.identifier===e)!==-1;this.addOrselect=()=>{this.state.size?this.selectLast():this.add()};this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.add=()=>{let e=()=>{this.editor.spriteStore.addTextDesign({state:{identifier:ue.identifier,text:ue.text,color:ue.color,isInverted:ue.isInverted,seed:Ss[ue.identifier]||ue.seed,padding:0}})};this.loadfonts(e)};this.updateStateFromHistory=(e,t)=>{let r=this.state.get(e);t.identifier===r.identifier?(this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)):this.changeIdentifier(t.identifier,!1,t.seed,e)};this.setState=(e,t)=>{let r=this.state.get(e);r?(t.inverted&&(r.isInverted=t.inverted),t.seed&&(r.seed=t.seed),t.color&&(r.color=t.color),t.padding&&(r.padding=t.padding),t.width&&(r.width=t.width)):this.state.set(e,{width:t.width,text:t.text,isInverted:t.inverted,identifier:t.identifier,seed:t.seed,color:t.color?t.color:ue.color,padding:t.padding})};this.changeText=e=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{text:e},!0);let r=this.editor.spriteStore.getContainerProperties(this.id);t.text=r.text,this.state.set(this.id,t),this.addSnapshot(F.EDIT,this.locale.history.edit)}}};this.setEditMode=e=>{this.editor.spriteStore.setEditMode(e)};this.duplicate=()=>{if(this.id){let e=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addTextDesign({state:{identifier:this.identifier,text:this.text,color:k(this.color),isInverted:this.isInverted,seed:this.seed,padding:this.padding,width:this.width},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.addSnapshot=(e,t)=>{this.currentTextDesign&&this.editor.spriteStore.addSnapshot(e,t)};this.delete=(e=this.id)=>{e&&(this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast())};this.changeSeed=()=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{seed:-1},!0);let t=this.editor.spriteStore.getContainerProperties(this.id);e.seed=t.seed,this.state.set(this.id,e),this.addSnapshot(F.EDIT,this.locale.history.shuffle)}}};this.changeIdentifier=(e,t=!0,r=null,o=this.id)=>{if(o&&e!==this.identifier){let n=this.state.get(o),s=this.editor.spriteStore.getContainerTransform(o);this.editor.spriteStore.addTextDesign({spriteId:o,state:{identifier:e,text:n.text,color:k(n.color),isInverted:n.isInverted,seed:r||Ss[e]||n.seed,padding:n.padding,width:n.width},transform:s},t,!0)}};this.changeColor=e=>{if(this.id){let t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{color:e});let r=this.editor.spriteStore.getContainerProperties(this.id);t.color=r.color,this.state.set(this.id,t)}}};this.colorSnapshot=()=>{this.addSnapshot(F.EDIT,this.locale.history.color)};this.invertBackground=()=>{if(this.id){let e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{inverted:!e.isInverted},!0);let t=this.editor.spriteStore.getContainerProperties(this.id);e.isInverted=t.inverted,this.state.set(this.id,e),this.addSnapshot(F.EDIT,this.locale.history.invert)}}};this.changeWidth=e=>{if(this.id){let t=this.state.get(this.id);t&&(t.width=e,this.state.set(this.id,t))}};this.changePadding=e=>{if(this.id){let t=this.state.get(this.id);t&&(t.padding=e,this.state.set(this.id,t))}};this.pureReset=()=>{this.state=S.map(Ds)};this.editor=e;let t=this.editor.assetProvider.getAssets("textdesign");this.entityManager=new ee(t,f(f({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:{},getAssetPath:this.editor.getAssetPath("textdesign")})),this.entityManager.items.find(r=>r.identifier===ue.identifier)||(ue.identifier=this.entityManager.items[0].identifier),ue.text=this.locale.canvasControls.placeholderText,ue.color=k(Ge(this.config,"defaultColor",ue.color)),this.config.colors&&this.config.colors.length>0&&(this.colorList=Ke(k(this.config.colors)))}static defaultText(){return ue.text}get isTextDesignSelected(){return this.editor.spriteStore.isSpriteTextDesign}get isEditMode(){return this.editor.spriteStore.isEditMode}get currentTextDesign(){if(this.isTextDesignSelected&&this.id){let e=this.state.get(this.id);if(e)return e}}get id(){if(this.isTextDesignSelected)return this.editor.spriteStore.id}get text(){return this.currentTextDesign?this.currentTextDesign.text:ue.text}get seed(){return this.currentTextDesign?this.currentTextDesign.seed:ue.seed}get padding(){return this.currentTextDesign?this.currentTextDesign.padding:ue.padding}get width(){return this.currentTextDesign?this.currentTextDesign.width:ue.width}get identifier(){return this.currentTextDesign?this.currentTextDesign.identifier:null}get isInverted(){return this.currentTextDesign?this.currentTextDesign.isInverted:ue.isInverted}get color(){return this.currentTextDesign?this.currentTextDesign.color:ue.color}get config(){return this.editor.configStore.config[g.TEXT_DESIGN]}get locale(){return this.editor.configStore.locale[g.TEXT_DESIGN]}get localeColor(){return this.editor.configStore.locale.common.color}get items(){return this.entityManager.items}};a([d],U.prototype,"addOrselect",2),a([d],U.prototype,"selectLast",2),a([d],U.prototype,"add",2),a([d],U.prototype,"updateStateFromHistory",2),a([d],U.prototype,"setState",2),a([d],U.prototype,"changeText",2),a([d],U.prototype,"setEditMode",2),a([d],U.prototype,"duplicate",2),a([d],U.prototype,"bringToFront",2),a([d],U.prototype,"delete",2),a([d],U.prototype,"changeSeed",2),a([d],U.prototype,"changeIdentifier",2),a([d],U.prototype,"changeColor",2),a([d],U.prototype,"invertBackground",2),a([d],U.prototype,"changeWidth",2),a([d],U.prototype,"changePadding",2),a([d],U.prototype,"pureReset",2),a([u],U.prototype,"isTextDesignSelected",1),a([u],U.prototype,"isEditMode",1),a([u],U.prototype,"currentTextDesign",1),a([u],U.prototype,"id",1),a([u],U.prototype,"text",1),a([u],U.prototype,"seed",1),a([u],U.prototype,"padding",1),a([u],U.prototype,"width",1),a([u],U.prototype,"identifier",1),a([u],U.prototype,"isInverted",1),a([u],U.prototype,"color",1),a([u],U.prototype,"config",1),a([u],U.prototype,"locale",1),a([u],U.prototype,"localeColor",1),a([u],U.prototype,"items",1);var dm=i=>({height:i.y,width:i.x}),pm={},no="none",mm={position:{x:0,y:0},rotation:0},lr=class{constructor(e){this.state=S.map(pm);this.selectedId=S.box(no);this.editMode=S.box(!1);this.dragMode=S.box(!1);this.minLength=0;this.addSticker=(e,t=!0)=>C(this,null,function*(){yield this.addStickerAsync(e,t)});this.addStickerAsync=(n,...s)=>C(this,[n,...s],function*({spriteId:e,state:t,transform:r},o=!0){return new Promise((l,c)=>{r=this.getInitialTransform(r);let{identifier:p}=t,m=this.editor.orderHelper.addSprite(p);this.editor.engine.addStickerFromAssets(p,this.editor.engineMediator.image.container,m).then(h=>C(this,null,function*(){e&&h.setData({id:e});let b=h.getID();this.container[b]=h,this.editor.orderHelper.renameSprite(p,b);let v=this.getSize(b);v.width*=h.getScale().x,v.height*=h.getScale().y,h.setPivot(.5,.5);let x;if(r.scale)x=r.scale;else if(r.size)x={x:r.size.width/v.width,y:r.size.height/v.height};else{let Q=this.editor.shortestOutputSide*.4,se=lr.magnitude(Q)/lr.sizeMagnitude(h.getSizeInWorldSpace());x={x:se,y:se}}let{flipHorizontally:I,flipVertically:R}=this.editor.outputContainer.getData();h.setFlipHorizontally(I),h.setFlipVertically(R),h.setTransform({position:r.position,scale:x,rotation:r.rotation}),t.flipHorizontally!==void 0&&h.setFlipHorizontally(t.flipHorizontally!==I),t.flipVertically!==void 0&&h.setFlipVertically(t.flipVertically!==R),this.setContainerProperties(b,f({},t));let M=h.getData();this.setInitialSpriteState(b,g.STICKER),this.stickerToolStore.setState(b,f(f({},M),{identifier:p})),yield this.editor.renderPromise(),o&&(this.selectedId.set(b),this.addSnapshot(F.ADD,this.stickerLocale.add)),l()})).catch(h=>{console.error(h),c()})})});this.addText=(e,t=!0)=>C(this,null,function*(){yield this.addTextAsync(e,t)});this.addTextAsync=({spriteId:e,state:t,transform:r},o=!0)=>new Promise((n,s)=>{r=this.getInitialTransform(r);let l=this.editor.orderHelper.addSprite(t.identifier),c=this.editor.shortestOutputSide,p={fontIdentifier:t.identifier,text:t.text,width:t.width||c*.6,fontSize:t.fontSize||c*.1,lineHeight:t.lineHeight,alignment:t.alignment,textColor:t.textColor,backgroundColor:t.backgroundColor};this.editor.engine.addTextWithFontLoading(p,this.editor.engineMediator.image.container,l).then(m=>C(this,null,function*(){e&&m.setData({id:e});let h=m.getID();this.container[h]=m,this.editor.orderHelper.renameSprite(t.identifier,this.id);let{flipHorizontally:b,flipVertically:v}=this.editor.outputContainer.getData();m.setFlipHorizontally(b),m.setFlipVertically(v),m.setPivot(.5,.5),m.setPosition(r.position),m.setRotation(r.rotation),this.setInitialSpriteState(h,g.TEXT);let x=m.getData();this.textToolStore.setState(h,f({},x)),yield this.editor.renderPromise(),o&&(this.selectedId.set(h),this.addSnapshot(F.ADD,this.textLocale.add)),n()})).catch(m=>{console.error(m),s()})});this.addTextDesign=(e,t=!0,r=!1)=>C(this,null,function*(){yield this.addTextDesignAsync(e,t,r)});this.addTextDesignAsync=({spriteId:e,state:t,transform:r},o=!0,n=!1)=>new Promise((s,l)=>{r=this.getInitialTransform(r);let c=this.editor.orderHelper.addSprite(t.identifier),p=this.editor.shortestOutputSide,m={width:t.width||p*.6,text:t.text,color:t.color,inverted:t.isInverted,seed:t.seed,padding:t.padding};this.editor.engine.addTextDesignAsync(t.identifier,m,this.editor.engineMediator.image.container,c).then(h=>C(this,null,function*(){e&&(n&&(this.pureRemoveSprite(e),this.textDesignToolStore.state.delete(e)),h.setData({id:e}));let b=h.getID();this.container[b]=h,this.editor.orderHelper.renameSprite(t.identifier,this.id);let{flipHorizontally:v,flipVertically:x}=this.editor.outputContainer.getData();h.setFlipHorizontally(v),h.setFlipVertically(x),h.setPivot(.5,.5),h.setPosition(r.position),h.setRotation(r.rotation),this.setInitialSpriteState(b,g.TEXT_DESIGN);let I=h.getData();this.textDesignToolStore.setState(b,f(f({},I),{identifier:t.identifier})),yield this.editor.renderPromise(),o&&(this.selectedId.set(b),this.addSnapshot(F.ADD,this.textDesignLocale.add)),s()})).catch(h=>{console.error(h),l()})});this.spriteLocalTransform=()=>({position:this.editor.previewToOutput(this.position),size:this.size,rotation:this.rotation});this.clickableCanvas=e=>{this.editor.clickableCanvas(e)};this.setContainerProperties=(e,t,r=!1)=>{this.container[e].setData(t),r&&this.updatePositionAndSize(),this.editor.render()};this.setContainerPosition=(e,t)=>{this.container[e].setPosition(t)};this.pureRemoveSprite=e=>(this.editor.engine.removeContainer(this.container[e]),this.container[e].getIndexInParent()===-1?(delete this.container[e],this.state.delete(e),this.editor.orderHelper.removeSprite(e),!0):!1);this.deleteSprite=(e=this.id)=>{let t=this.state.get(e);t.tool===g.STICKER?this.stickerToolStore.delete():t.tool===g.TEXT?this.textToolStore.delete():t.tool===g.TEXT_DESIGN&&this.textDesignToolStore.delete()};this.removeSprite=e=>{this.pureRemoveSprite(e)&&(this.selectLast(),this.spriteSnapshot("delete"),this.editor.render())};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.spriteSnapshot=e=>{this.addSnapshot(F.EDIT,this.historyLocale[e])};this.updateStateFromHistory=e=>C(this,null,function*(){let t=Object.keys(this.container),r=e.spriteIdList;if(r.length!==t.length){let o=t.filter(s=>r.indexOf(s)===-1),n=r.filter(s=>t.indexOf(s)===-1);o.forEach(s=>{this.pureRemoveSprite(s)});for(let s=0;s<n.length;s+=1){let l=n[s],c=e.common?e.common[l]:void 0,p=e.text?e.text[l]:void 0,m=e.sticker?e.sticker[l]:void 0,h=e.textdesign?e.textdesign[l]:void 0;if(c){let b={spriteId:l,transform:{size:c.size?dm(_.fromSize(c.size)):void 0,position:new _(c.position),rotation:c.rotation}};p?yield this.addNewText(b,p):h?yield this.addNewTextDesign(b,h):m&&(yield this.addNewSticker(b,f(f({},m),{flipHorizontally:c.flipHorizontally,flipVertically:c.flipVertically})))}}}else this.updateSpriteStateFromHistory(e)});this.addNewText=(e,t)=>C(this,null,function*(){if(this.textToolStore.doesTextAssetExist(t.identifier))yield this.addTextAsync(f(f({},e),{state:t}),!1);else throw new Error(`Text identifier ${t.identifier} doesn't exist`)});this.addNewTextDesign=(e,t)=>C(this,null,function*(){if(this.textDesignToolStore.doesTextDesignAssetExist(t.identifier))yield this.addTextDesignAsync(f(f({},e),{state:t}),!1);else throw new Error(`TextDesign identifier ${t.identifier} doesn't exist`)});this.addNewSticker=(e,t)=>C(this,null,function*(){if(this.stickerToolStore.doesStickerAssetExist(t.identifier))yield this.addStickerAsync(f(f({},e),{state:t}),!1);else throw new Error(`Sticker identifier ${t.identifier} doesn't exist`)});this.updateSpriteStateFromHistory=e=>C(this,null,function*(){Object.keys(this.container).forEach(t=>{let r=e.common?e.common[t]:void 0,o=e.sticker?e.sticker[t]:void 0,n=e.text?e.text[t]:void 0,s=e.textdesign?e.textdesign[t]:void 0,l=this.state.get(t);if(l&&r){this.state.set(t,l);let c=this.container[t];c.setPosition(new _(r.position)),c.setRotation(r.rotation),l.rotation=c.getRotation(),r.flipHorizontally!==void 0&&c.setFlipHorizontally(r.flipHorizontally),r.flipVertically!==void 0&&c.setFlipVertically(r.flipVertically),o?(c.setSizeInWorldSpace(r.size),this.stickerToolStore.updateStateFromHistory(t,o)):n?this.textToolStore.updateStateFromHistory(t,f(f({},n),{fontIdentifier:n.identifier})):s&&this.textDesignToolStore.updateStateFromHistory(t,f(f({},s),{inverted:s.isInverted})),this.updatePositionAndSize(t)}})});this.getSpriteHistoryState=()=>{let e=k(this.state),t=k(this.textToolStore.state),r=k(this.textDesignToolStore.state),o={common:e,[g.STICKER]:k(this.stickerToolStore.state),[g.TEXT]:t,[g.TEXT_DESIGN]:r,spriteIdList:Object.keys(this.container)};return Object.keys(o.common).forEach(n=>{o.common[n].size=this.container[n].getSizeInWorldSpace(),o.common[n].position=this.container[n].getPosition(),o.common[n].order=this.container[n].getIndexInParent()}),o};this.updateStateFromSerialization=(e,t)=>C(this,null,function*(){if(t&&t.length)try{let r=yield Promise.all(t.map(c=>C(this,[c],function*({svg:o,raster:n,name:s,identifier:l}){let p=(o==null?void 0:o.data)?Gt.SVG:n.type,m=`data:${p};base64,${(o==null?void 0:o.data)||n.data}`,h=yield oo(m,150);return{stickerURI:m,thumbnailURI:h,name:s,type:p,identifier:l}})));yield this.stickerToolStore.addCustomStickerAsset(r)}catch(r){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}for(let r=0;r<e.spriteIdList.length;r+=1){let o=e.spriteIdList[r],n=e.common?e.common[o]:void 0,s=e.sticker?e.sticker[o]:void 0,l=e.text?e.text[o]:void 0,c=e.textdesign?e.textdesign[o]:void 0;if(n){let{size:p}=n;p&&(p={width:this.editor.worldToPreview(n.size.width),height:this.editor.worldToPreview(n.size.height)});let{flipHorizontally:m,flipVertically:h}=this.editor.outputContainer.getData(),b=this.editor.outputContainer.getRotation(),v=h!==m?n.rotation-b:n.rotation+b,x=h!==m?-v:v,I={spriteId:o,transform:{size:p,position:n.position,rotation:x}};if(l){let R=this.textToolStore.validFontWithConfig(l.identifier);l.identifier=R==null?void 0:R.identifier,yield this.addNewText(I,l)}else c?yield this.addNewTextDesign(I,c):s&&(yield this.addNewSticker(I,f(f({},s),{flipHorizontally:n.flipHorizontally,flipVertically:n.flipVertically})))}}});this.serializableState=()=>C(this,null,function*(){let e=this.editor.spriteStore.getSpriteHistoryState();Object.keys(e.common).forEach(r=>{let{flipHorizontally:o,flipVertically:n}=this.editor.outputContainer.getData(),s=this.editor.outputContainer.getRotation(),l=n!==o?-e.common[r].rotation:e.common[r].rotation;e.common[r].rotation=n!==o?l+s:l-s});let t=yield Promise.all(this.editor.spriteStore.stickerToolStore.customStickers.map(l=>C(this,[l],function*({identifier:r,type:o,stickerURI:n,name:s}){let c={identifier:r,name:s,raster:{data:"",type:Gt.JPEG}};if(o===Gt.SVG&&(c.svg={data:n.split(",")[1]}),o===Gt.JPEG||o===Gt.PNG)[,c.raster.data]=n.split(","),c.raster.type=o;else{let p=yield oo(n);[,c.raster.data]=p.split(","),c.raster.type=Gt.PNG}return c})));return{sprite:e,customStickers:t}});this.updateCanvasControls=()=>{Object.keys(this.container).forEach(e=>{this.updatePositionAndSize(e,!0);let t=this.state.get(e);if(t){if(t.tool===g.TEXT){let r=this.getContainerProperties(e);this.textToolStore.changeSize(e,r)}else if(t.tool===g.TEXT_DESIGN){let r=this.getContainerProperties(e);this.textToolStore.changeWidth(r.width)}}})};this.setEditMode=e=>{this.currentSprite&&[g.TEXT,g.TEXT_DESIGN].indexOf(this.tool)!==-1&&(e?this.editor.modalStore.showTextEditModal():this.editor.modalStore.hideModal(),this.editMode.set(e))};this.setDragMode=e=>{this.dragMode.set(e)};this.setPosition=e=>{let t=this.currentSprite,r=this.container[this.id];if(t&&r){r.setPosition(this.editor.previewToWorld(e));let{position:o}=this.getSizePositionFromContainer();t.position.x=o.x,t.position.y=o.y,this.state.set(this.id,t),this.editor.render()}};this.setSize=e=>{let t=this.currentSprite;t&&(t.size.width=e.width,t.size.height=e.height,this.state.set(this.id,t))};this.setRotation=e=>{let t=this.currentSprite;if(t){let{flipHorizontally:r,flipVertically:o}=this.editor.outputContainer.getData(),n=this.editor.outputContainer.getRotation(),s=Qi({rotation:e+n,flipHorizontally:r,flipVertically:o});this.container[this.id].setRotation(s),t.rotation=this.container[this.id].getRotation(),this.state.set(this.id,t),this.editor.render()}};this.onCanvasClick=e=>{this.isEditMode||this.selectHighestOrderSprite(e)};this.select=e=>{let t=this.state.get(e);t&&(this.editor.activeStore.tool!==t.tool&&this.editor.activeStore.selectTool(t.tool),this.selectedId.set(e))};this.selectLast=()=>{let e=this.editor.orderHelper.getLastSpriteId();e&&this.select(e)};this.selectNext=()=>{if(this.currentSprite){let t=this.container[this.id].getIndexInParent();if(t){let r=Object.keys(this.container).find(o=>this.container[o].getIndexInParent()===t-1);r&&this.select(r)}}};this.deselect=()=>{this.selectedId.set(no)};this.bringToFront=e=>{let t=this.editor.orderHelper.bringToFront(e);this.container[e].setIndexInParent(t),this.spriteSnapshot("order"),this.editor.render()};this.flipHorizontally=e=>{let t=this.state.get(e),r=this.container[e];r.setFlipHorizontally(!r.getFlipHorizontally()),t.flipHorizontally=r.getFlipHorizontally(),this.spriteSnapshot("flip"),this.state.set(e,t),this.editor.render()};this.pureReset=()=>{this.selectedId.set(no),Array.from(this.state.keys()).forEach(e=>{this.pureRemoveSprite(e)}),this.stickerToolStore.pureReset(),this.textToolStore.pureReset(),this.textDesignToolStore.pureReset()};this.selectHighestOrderSprite=e=>{let t=this.editor.brushToolStore.containerId();if(e=e.filter(n=>n!==t),e.length<1){this.deselect();return}let r="",o=0;e.forEach(n=>{let s=this.container[n],l=s&&s.getIndexInParent()||0;l>=o&&(o=l,r=n)}),this.select(r)};this.onCornerDrag=({x:e,y:t})=>{if(this.currentSprite){let r=new _(this.currentSprite.position),o=new _(e,t),n=o.subtract(r).magnitude,s=this.getSize(),l=n*2/lr.sizeMagnitude(s);if(n>this.minLength)if(this.isSpriteSticker)if(this.stickerToolStore.resizeMode!=="unrestricted")this.setStickerSize({width:s.width*l,height:s.height*l});else{let c=this.rotationWRTOutputRotation,p=o.subtract(r),m=Math.cos(c),h=Math.sin(c),b=Math.max(Math.abs(p.x*m*2+p.y*h*2),this.minLength),v=Math.max(Math.abs(p.x*-h*2+p.y*m*2),this.minLength);this.setStickerSize({width:b,height:v})}else this.isSpriteText?this.setTextSize(s.width*l):this.isSpriteTextDesign&&this.setTextDesignScale(l);this.editor.render()}};this.onWidthDrag=({x:e,y:t})=>{let r=new _(this.currentSprite.position),n=new _(e,t).subtract(r).magnitude,s=this.editor.previewToWorld(2*n);if(s>this.minLength&&(this.setContainerProperties(this.id,{width:s},!0),this.isSpriteText)){let l=this.getContainerProperties(this.id);this.textToolStore.changeWidth(l.width)}};this.onPaddingDrag=({x:e,y:t})=>{if(this.isSpriteTextDesign){let r=this.getContainerProperties(this.id),o=new _(this.currentSprite.position),s=new _(e,t).subtract(o).magnitude,l=Math.max(this.editor.previewToWorld(s)-r.width/2,0);this.setContainerProperties(this.id,{padding:l},!0),this.isSpriteTextDesign&&(r=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(r.padding))}};this.correctTextFlip=()=>{let{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();Object.values(this.container).forEach(r=>{(r.type==="text"||r.type==="text-design")&&(r.setFlipHorizontally(e),r.setFlipVertically(t))})};this.reverseTextHorizontally=()=>{Object.values(this.container).forEach(e=>{(e.type==="text"||e.type==="text-design")&&e.setFlipHorizontally(!e.getFlipHorizontally())})};this.reverseTextVertically=()=>{Object.values(this.container).forEach(e=>{(e.type==="text"||e.type==="text-design")&&e.setFlipVertically(!e.getFlipVertically())})};this.getOutputProperties=()=>this.editor.outputContainer.getData();this.getContainerProperties=e=>this.container[e].getData();this.getContainerTransform=e=>this.container[e].getTransform();this.getDuplicateContainerTransform=e=>{let t=this.container[e].getTransform(),r=this.editor.shortestOutputSide*.1,o=new _(t.position).add(new _(r,r));return f(f({},t),{position:o})};this.getDuplicateContainerFlip=e=>{let t=this.container[e].getFlipHorizontally(),r=this.container[e].getFlipVertically();return{flipHorizontally:t,flipVertically:r}};this.updatePositionAndSize=(e=this.id,t=!1)=>{let{position:r,size:o}=this.getSizePositionFromContainer(e),n=this.state.get(e);if(n){if(n.position.x=r.x,n.position.y=r.y,n.size.width=o.width,n.size.height=o.height,t){let s=this.container[e].getRotation();this.container[e].setRotation(s),n.rotation=this.container[e].getRotation()}this.state.set(e,n)}};this.getInitialTransform=e=>{let t=this.editor.outputToWorld(mm.position);return e?f({position:t},e):{rotation:this.editor.outputContainer.getRotation(),position:t}};this.setInitialSpriteState=(e,t)=>{let r=this.container[e],{position:o,size:n}=this.getSizePositionFromContainer(e),s=r.getRotation(),l=t!==g.STICKER?!1:r.getFlipHorizontally(),c=t!==g.STICKER?!1:r.getFlipVertically();this.state.set(e,{tool:t,position:o,rotation:s,size:n,flipHorizontally:l,flipVertically:c})};this.setStickerSize=e=>{let t=this.container[this.id];t.setSizeInWorldSpace(this.editor.previewSizeToWorld(e));let r=this.currentSprite;r&&(r.size=this.editor.worldSizeToPreview(t.getSizeInWorldSpace()),this.state.set(this.id,r))};this.setTextSize=e=>{let t=this.getContainerProperties(this.id),r={width:this.editor.previewToWorld(e)},o=r.width/t.width,n={fontSize:Math.round(t.fontSize*o)},s=this.isSpriteText?f(f({},r),n):r;r.width>this.minLength&&n.fontSize&&(this.setContainerProperties(this.id,s,!0),t=this.getContainerProperties(this.id),this.textToolStore.changeFontSize(t.fontSize,!0),this.textToolStore.changeWidth(t.width))};this.setTextDesignScale=e=>{let t=this.getContainerProperties(this.id),r=t.width*e;if(r>this.minLength){this.setContainerProperties(this.id,{width:r},!0);let{width:o}=this.getContainerProperties(this.id);this.textDesignToolStore.changeWidth(o),t=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(t.padding)}};this.getSizePositionFromContainer=(e=this.id)=>{let t=this.container[e];if(t){let r=this.editor.worldToPreview(t.getPosition()),o=this.editor.worldSizeToPreview(t.getSizeInWorldSpace());return{position:r,size:o}}return{position:{x:0,y:0},size:{height:1,width:1}}};this.getSize=(e=this.id)=>{let t=this.container[e];return t?this.editor.worldSizeToPreview(t.getSizeInWorldSpace()):{width:0,height:0}};this.editor=e,this.container={},this.stickerToolStore=new z(e),this.textToolStore=new O(e),this.textDesignToolStore=new U(e),this.rect=new ne(this.editor,this),this.minLength=this.editor.configStore.measurements.canvasControls.sprite.minSize/Math.sqrt(2)}static magnitude(e,t){return new _(e,t||e).magnitude}static sizeMagnitude(e){return Math.sqrt(e.width*e.width+e.height*e.height)}get currentSprite(){if(this.isSpriteSelected)return this.state.get(this.id)}get padding(){return this.textDesignToolStore.padding}get isEditMode(){return this.editMode.get()}get isDragMode(){return this.dragMode.get()}get id(){return this.selectedId.get()}get isSpriteSelected(){return this.id!==no}get position(){if(this.currentSprite)return this.currentSprite.position}get tool(){if(this.currentSprite)return this.currentSprite.tool}get size(){if(this.currentSprite)return this.currentSprite.size}get rotation(){if(this.currentSprite)return this.currentSprite.rotation}get rotationWRTOutputRotation(){if(this.currentSprite){let{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData(),r=this.editor.outputContainer.getRotation();return Qi({rotation:this.currentSprite.rotation-r,flipHorizontally:e,flipVertically:t})}}get flipHorizontal(){if(this.currentSprite)return this.currentSprite.flipHorizontally}get isSpriteSticker(){return this.tool===g.STICKER}get isSpriteText(){return this.tool===g.TEXT}get isSpriteTextDesign(){return this.tool===g.TEXT_DESIGN}get spritePosition(){if(this.currentSprite){let{x:e,y:t}=this.currentSprite.position,{height:r,width:o}=this.currentSprite.size;return{x:Math.round(e-o/2),y:Math.round(t-r/2)}}}get currentRect(){if(this.currentSprite)return this.rect}get leftTopPosition(){if(this.currentSprite)return this.rect.leftTop}get leftBottomPosition(){if(this.currentSprite)return this.rect.leftBottom}get leftMidPosition(){if(this.currentSprite)return this.rect.leftMid}get leftMidPadPosition(){if(this.currentSprite){let{leftMid:e}=this.rect;return{x:e.x-this.editor.worldToPreview(this.padding),y:e.y}}}get rightTopPosition(){if(this.currentSprite)return this.rect.rightTop}get rightBottomPosition(){if(this.currentSprite)return this.rect.rightBottom}get rightMidPosition(){if(this.currentSprite)return this.rect.rightMid}get rightMidPadPosition(){if(this.currentSprite){let{rightMid:e}=this.rect;return{x:e.x+this.editor.worldToPreview(this.padding),y:e.y}}}get leftBottomHandlePosition(){if(this.currentSprite)return this.rect.leftBottomHandle}get rightBottomHandlePosition(){if(this.currentSprite)return this.rect.rightBottomHandle}get historyLocale(){return this.isSpriteSticker?this.stickerLocale:this.isSpriteText?this.textDesignLocale:this.textLocale}get stickerLocale(){return this.editor.configStore.locale[g.STICKER].history}get textLocale(){return this.editor.configStore.locale[g.TEXT].history}get textDesignLocale(){return this.editor.configStore.locale[g.TEXT_DESIGN].history}},w=lr;a([d],w.prototype,"addSticker",2),a([d],w.prototype,"addStickerAsync",2),a([d],w.prototype,"addText",2),a([d],w.prototype,"addTextAsync",2),a([d],w.prototype,"addTextDesign",2),a([d],w.prototype,"addTextDesignAsync",2),a([d],w.prototype,"clickableCanvas",2),a([d],w.prototype,"setContainerProperties",2),a([d],w.prototype,"setContainerPosition",2),a([d],w.prototype,"pureRemoveSprite",2),a([d],w.prototype,"deleteSprite",2),a([d],w.prototype,"removeSprite",2),a([d],w.prototype,"addSnapshot",2),a([d],w.prototype,"updateStateFromHistory",2),a([d],w.prototype,"addNewText",2),a([d],w.prototype,"addNewTextDesign",2),a([d],w.prototype,"addNewSticker",2),a([d],w.prototype,"updateSpriteStateFromHistory",2),a([d],w.prototype,"updateStateFromSerialization",2),a([d],w.prototype,"updateCanvasControls",2),a([d],w.prototype,"setEditMode",2),a([d],w.prototype,"setDragMode",2),a([d],w.prototype,"setPosition",2),a([d],w.prototype,"setSize",2),a([d],w.prototype,"setRotation",2),a([d],w.prototype,"onCanvasClick",2),a([d],w.prototype,"select",2),a([d],w.prototype,"selectLast",2),a([d],w.prototype,"selectNext",2),a([d],w.prototype,"deselect",2),a([d],w.prototype,"bringToFront",2),a([d],w.prototype,"flipHorizontally",2),a([d],w.prototype,"pureReset",2),a([d],w.prototype,"onCornerDrag",2),a([d],w.prototype,"onWidthDrag",2),a([d],w.prototype,"onPaddingDrag",2),a([d],w.prototype,"correctTextFlip",2),a([d],w.prototype,"reverseTextHorizontally",2),a([d],w.prototype,"reverseTextVertically",2),a([u],w.prototype,"currentSprite",1),a([u],w.prototype,"padding",1),a([u],w.prototype,"isEditMode",1),a([u],w.prototype,"isDragMode",1),a([u],w.prototype,"id",1),a([u],w.prototype,"isSpriteSelected",1),a([u],w.prototype,"position",1),a([u],w.prototype,"tool",1),a([u],w.prototype,"size",1),a([u],w.prototype,"rotation",1),a([u],w.prototype,"rotationWRTOutputRotation",1),a([u],w.prototype,"flipHorizontal",1),a([u],w.prototype,"isSpriteSticker",1),a([u],w.prototype,"isSpriteText",1),a([u],w.prototype,"isSpriteTextDesign",1),a([u],w.prototype,"spritePosition",1),a([u],w.prototype,"currentRect",1),a([u],w.prototype,"leftTopPosition",1),a([u],w.prototype,"leftBottomPosition",1),a([u],w.prototype,"leftMidPosition",1),a([u],w.prototype,"leftMidPadPosition",1),a([u],w.prototype,"rightTopPosition",1),a([u],w.prototype,"rightBottomPosition",1),a([u],w.prototype,"rightMidPosition",1),a([u],w.prototype,"rightMidPadPosition",1),a([u],w.prototype,"leftBottomHandlePosition",1),a([u],w.prototype,"rightBottomHandlePosition",1),a([u],w.prototype,"historyLocale",1),a([u],w.prototype,"stickerLocale",1),a([u],w.prototype,"textLocale",1),a([u],w.prototype,"textDesignLocale",1);var Je={position:{x:0,y:0},size:{height:0,width:0},lockResolution:!1,forceDimensions:!1,ratio:"*"},Ql={identifier:"identity",outputRotation:0,rotationInDegrees:0,flipHorizontally:!1,flipVertically:!1,cropState:S.map({})};var B=class{constructor(e,t){this.minCropSize=0;this.state=Ql,this.configStore=e.configStore,this.minCropSize=this.configStore.measurements.crop.minSize,this.defaults=t}changeIdentifier(e){this.state.identifier=e,this.state.cropState.get(e)||this.state.cropState.set(e,f({},Je))}changeRatio(e){let t=this.state.cropState.get(this.identifier);t&&this.state.cropState.set(this.identifier,f(f({},t),{ratio:e}))}changeSize(e){let t=this.state.cropState.get(this.identifier);t&&(e.width&&e.width>0&&(t.size.width=Math.round(e.width)),e.height&&e.height>0&&(t.size.height=Math.round(e.height)),this.state.cropState.set(this.identifier,t))}changeHeight(e){let t=this.state.cropState.get(this.identifier);t&&e&&(t.size.height=Math.round(e),this.state.cropState.set(this.identifier,t))}changeWidth(e){let t=this.state.cropState.get(this.identifier);t&&e&&(t.size.width=Math.round(e),this.state.cropState.set(this.identifier,t))}changePositionX(e,t){let r=this.state.cropState.get(this.identifier);return r&&e<=t-this.minCropSize&&e>=0?(r.position.x=Math.round(e),this.state.cropState.set(this.identifier,r),!0):!1}changePositionY(e,t){let r=this.state.cropState.get(this.identifier);return r&&e<=t-this.minCropSize&&e>=0?(r.position.y=Math.round(e),this.state.cropState.set(this.identifier,r),!0):!1}changePosition(e,t){let r=this.state.cropState.get(this.identifier);return r&&e.x<=t.width-this.minCropSize&&e.x>=0&&e.y<=t.height-this.minCropSize&&e.y>=0?(r.position.x=Math.round(e.x),r.position.y=Math.round(e.y),this.state.cropState.set(this.identifier,r),!0):!1}changeLockResolution(e){let t=this.state.cropState.get(this.identifier);t&&(t.lockResolution=e!==void 0?e:!t.lockResolution,this.state.cropState.set(this.identifier,t))}changeForceDimensions(e){let t=this.state.cropState.get(this.identifier);t&&(t.forceDimensions=e,this.state.cropState.set(this.identifier,t))}setRotation(e){this.state.rotationInDegrees=e}resetRotation(){this.state.rotationInDegrees=0}resetOutputRotation(){this.state.outputRotation=0}resetFlip(){this.state.flipHorizontally=!1,this.state.flipVertically=!1}updateFlip({flipHorizontally:e,flipVertically:t}){this.state.flipHorizontally=e,this.state.flipVertically=t}setOutputRotation(e){this.state.outputRotation=e}flipHorizontally(){this.state.flipHorizontally=!this.state.flipHorizontally}flipVertically(){this.state.flipVertically=!this.state.flipVertically}get flipCenter(){let{width:e,height:t}=this.defaults.maxCropMaskSize;return new _(e/2,t/2)}get isFlippedHorizontal(){return this.state.flipHorizontally}get isFlippedVertical(){return this.state.flipVertically}get identifier(){return this.state.identifier}get height(){return this.selectedCrop?this.selectedCrop.size.height:Je.size.height}get width(){return this.selectedCrop?this.selectedCrop.size.width:Je.size.width}get position(){return this.selectedCrop?this.selectedCrop.position:Je.position}get ratio(){return this.selectedCrop?this.selectedCrop.ratio:Je.ratio}get size(){return this.selectedCrop?this.selectedCrop.size:Je.size}get x(){return this.selectedCrop?this.selectedCrop.position.x:Je.position.x}get y(){return this.selectedCrop?this.selectedCrop.position.y:Je.position.y}get lockResolution(){return this.selectedCrop?this.selectedCrop.lockResolution:Je.lockResolution}get forceDimensions(){return this.selectedCrop?this.selectedCrop.forceDimensions:Je.forceDimensions}get selectedCrop(){return this.state.cropState.get(this.identifier)}get rotationInDegrees(){return this.state.rotationInDegrees}get outputRotation(){return this.state.outputRotation}};a([S],B.prototype,"state",2),a([d],B.prototype,"changeIdentifier",1),a([d],B.prototype,"changeRatio",1),a([d],B.prototype,"changeSize",1),a([d],B.prototype,"changeHeight",1),a([d],B.prototype,"changeWidth",1),a([d],B.prototype,"changePositionX",1),a([d],B.prototype,"changePositionY",1),a([d],B.prototype,"changePosition",1),a([d],B.prototype,"changeLockResolution",1),a([d],B.prototype,"changeForceDimensions",1),a([d],B.prototype,"setRotation",1),a([d],B.prototype,"resetRotation",1),a([d],B.prototype,"resetOutputRotation",1),a([d],B.prototype,"resetFlip",1),a([d],B.prototype,"updateFlip",1),a([d],B.prototype,"setOutputRotation",1),a([d],B.prototype,"flipHorizontally",1),a([d],B.prototype,"flipVertically",1),a([u],B.prototype,"flipCenter",1),a([u],B.prototype,"isFlippedHorizontal",1),a([u],B.prototype,"isFlippedVertical",1),a([u],B.prototype,"identifier",1),a([u],B.prototype,"height",1),a([u],B.prototype,"width",1),a([u],B.prototype,"position",1),a([u],B.prototype,"ratio",1),a([u],B.prototype,"size",1),a([u],B.prototype,"x",1),a([u],B.prototype,"y",1),a([u],B.prototype,"lockResolution",1),a([u],B.prototype,"forceDimensions",1),a([u],B.prototype,"selectedCrop",1),a([u],B.prototype,"rotationInDegrees",1),a([u],B.prototype,"outputRotation",1);var xs=class{constructor(e){this.transforms={output:JSON.stringify(X.IDENTITY),preview:JSON.stringify(X.IDENTITY)};this.editor=e,this.overlayOpacity=0,this.frameOpacity=0}static rotateOutput(e,t){switch(e%=360,e){case 90:case-270:return t.swapped.multiply(-1,1);case 180:case-180:return t.multiply(-1);case 270:case-90:return t.swapped.multiply(1,-1);default:return t}}onLeave(){let{flipHorizontally:e,flipVertically:t,rotation:r,outputRotation:o}=this.transformToolStore.rotateFlipState;this.editor.overlayToolStore.identifier!=="identity"&&this.editor.overlayToolStore.changeOpacity(this.overlayOpacity),this.editor.frameToolStore.identifier!=="identity"&&this.editor.frameToolStore.changeOpacity(this.frameOpacity);let n=this.editor.previewToWorld(new _(this.transformToolStore.leftTopRespectFlip).add(new _(this.transformToolStore.rightBottomRespectFlip)).divide(2).add(new _(this.transformToolStore.unRotatedDefaults.cropMaskPosition)),!0),s=this.engineMediator.preview.container,{outputContainer:l}=this.editor;l.setResolution(k(this.transformToolStore.localOutputImageSize)),l.setData({flipVertically:t,flipHorizontally:e});let c=s.getScale();this.editor.overlayToolStore.correctOverlayFlip(),this.saveTransforms();let p=1;if(this.transformToolStore.lockResolution){let{cropMaskSize:x,defaultImageSize:I}=this.transformToolStore,R=this.transformToolStore.maxCropMaskSize;p={height:x.height*I.height/R.height,width:x.width*I.width/R.width}.width/this.transformToolStore.localOutputImageSize.width}let m=Math.abs(c.x),h=p/(m/this.transformToolStore.defaultScale),b={x:h,y:h},v=-(r-o);l.setTransform({scale:b,position:n,rotation:v}),this.editor.engineMediator.preview.updateTransform(0,!1),this.editor.scale.setInitialTransform(),this.editor.spriteStore.updateCanvasControls(),this.editor.focusToolStore.updateCanvasControls()}onEnter(){this.editor.overlayToolStore.identifier!=="identity"&&(this.overlayOpacity=this.editor.overlayToolStore.opacity,this.editor.overlayToolStore.changeOpacity(0)),this.editor.frameToolStore.identifier!=="identity"&&(this.frameOpacity=this.editor.frameToolStore.opacity,this.editor.frameToolStore.changeOpacity(0)),this.editor.scale.setScaleToDefault();let e=this.engineMediator.preview.container,{outputContainer:t}=this.editor,r=JSON.parse(this.transforms.preview);t.setResolution(k(this.transformToolStore.defaultImageSize)),e.setTransform(r),t.setTransform(JSON.parse(this.transforms.output));let o=r.scale;t.setData({flipVertically:!1,flipHorizontally:!1}),this.transformToolStore.transformStore.updateFlip({flipVertically:o.y<0,flipHorizontally:o.x<0}),this.engineMediator.preview.savePreviewTransform(r);let{scale:n}=this.engineMediator.preview.calculateTransform();this.editor.scale.setInitialTransform(n.x)}rotateOutputContainer(e=!1){this.editor.outputContainer.rotate90(e),this.transformToolStore.transformStore.setOutputRotation(this.editor.outputContainer.getRotation());let{rotation:t}=this.transformToolStore.rotateFlipState;this.engineMediator.preview.updateTransform(t),re(()=>{this.editor.scale.setInitialTransform();let r=this.getScaleWithFlip(t);this.engineMediator.preview.container.setScale(r),this.transformToolStore.setCropDefaults(!0),this.transformToolStore.updateCropMask()}),this.editor.render()}applyPreviewTransform(){let{rotation:e,flipHorizontally:t,flipVertically:r}=this.transformToolStore.rotateFlipState,o=this.editor.scale.getPositionWithOffset(),n=this.getScaleWithFlip(),s=e;t&&(s=Zi(s)),r&&(s=Zi(s));let l={position:o,rotation:s,scale:n};this.engineMediator.preview.savePreviewTransform(l),this.engineMediator.preview.container.setTransform(l)}getScaleWithFlip(e=this.transformToolStore.rotateFlipState.rotation){let{flipHorizontally:t,flipVertically:r}=this.transformToolStore.rotateFlipState,o=t?-1:1,n=r?-1:1,s=this.editor.scale.calculateScale(e);return{x:s*o,y:s*n}}saveTransforms(){let e=JSON.stringify(this.engineMediator.preview.container.getTransform()),t=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:e,output:t}}saveTransformsBasedOnFlip(){let e=this.engineMediator.preview.container.getTransform(),{scale:t}=e,{flipVertically:r,flipHorizontally:o}=this.editor.outputContainer.getData(),n=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:JSON.stringify(f(f({},e),{scale:{x:o?-t.x:t.x,y:r?-t.y:t.y}})),output:n}}get engineMediator(){return this.editor.engineMediator}get transformToolStore(){return this.editor.transformToolStore}};var ec="identity",si=class{constructor(e){this.unRotatedDefaults={cropMaskPosition:{x:0,y:0},scale:1};this.defaultAngle=0;this.dragMode=S.box(!1);this.minCropSize=0;this.localSnapshotEnabled=!0;this.defaults={cropMaskPosition:{x:0,y:0},maxCropMaskSize:{width:0,height:0},imageSize:{width:0,height:0},scale:1};this.localOutputSize={width:0,height:0};this.checkIfTransformThumbnailExits=e=>{let t=this.editor.configStore.config.assetBaseUrl,{length:r}=t;if(t[r-1]!=="/"&&(t+="/"),`${t}transform/`===e)return!1;let o=new Image;try{return o.src=e,!0}catch(n){return!1}};this.reset=()=>{this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.setDefaultAngle(0),this.editor.outputContainer.getRotation()!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop(),this.editor.render()};this.changeLocalOutputSize=e=>{this.localOutputSize.height=Math.round(e.height),this.localOutputSize.width=Math.round(e.width)};this.changeDefaultScale=e=>{this.defaults.scale=e};this.changeLocalOutputHeight=e=>{this.localOutputSize.height=Math.round(e)};this.changeLocalOutputWidth=e=>{this.localOutputSize.width=Math.round(e)};this.changeLockResolution=()=>{this.transformStore.changeLockResolution(),this.addLocalSnapshot()};this.rotateClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical!==this.isFlippedHorizontal)};this.rotateAntiClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical===this.isFlippedHorizontal)};this.flipHorizontally=(e=!0)=>{this.transformStore.flipHorizontally(),this.editor.spriteStore.reverseTextHorizontally(),this.transformRender(e),e&&this.addLocalSnapshot()};this.flipVertically=(e=!0)=>{this.transformStore.flipVertically(),this.editor.spriteStore.reverseTextVertically(),this.transformRender(e),e&&this.addLocalSnapshot()};this.applyDefaultCrop=(e=!1)=>{if(this.identifier==="identity"){let{identifier:t}=this.getMatchingItem();this.changeIdentifier(t,e)}};this.updateCropMask=()=>{this.changeIdentifier(this.identifier,!0)};this.onLeftTop=({x:e,y:t})=>{let r=this.getRatio(),o=this.rightBottom,{minCropMaskSize:n,maxCropMaskSize:s}=this,l=Math.min(Math.max(0,e),o.x-n.width),c=Math.min(Math.max(0,t),o.y-n.height),p=o.x-l,m=o.y-c,h={width:Math.max(this.minCropSize,Math.min(p,s.width-l)),height:Math.max(this.minCropSize,Math.min(m,s.height-c))};if(r==="*")this.changePosition({x:l,y:c})&&this.changeCropAndOutputSize(h);else{let b=this.proportionalSize(r,h),v=new _(o).rounded.subtract({x:b.width,y:b.height});this.changePosition(v)&&this.changeCropAndOutputSize(b)}};this.onLeftBottom=({x:e,y:t})=>{let r=this.getRatio(),o=this.rightTop,{minCropMaskSize:n,maxCropMaskSize:s}=this,l=Math.min(Math.max(0,e),o.x-n.width),c=Math.max(0,t,o.y+n.height),p=o.x-l,m=c-o.y,h={width:Math.max(1,Math.min(p,s.width-l)),height:Math.max(1,Math.min(m,s.height-o.y))};if(r==="*")this.changeCropAndOutputSize(h)&&this.changePositionX(l);else{let b=this.proportionalSize(r,h);this.changePositionX(Math.round(o.x)-b.width)&&this.changeCropAndOutputSize(b)}};this.onRightTop=({x:e,y:t})=>{let r=this.getRatio(),o=this.leftBottom,{minCropMaskSize:n,maxCropMaskSize:s}=this,l=Math.max(0,e,o.x+n.width),c=Math.min(Math.max(0,t),o.y-n.height),p=l-o.x,m=o.y-c,h={width:Math.max(1,Math.min(p,s.width-o.x)),height:Math.max(1,Math.min(m,s.height-c))};if(r==="*")this.changePositionY(c)&&this.changeCropAndOutputSize(h);else{let b=this.proportionalSize(r,h);this.changePositionY(Math.round(o.y)-b.height)&&this.changeCropAndOutputSize(b)}};this.onRightBottom=({x:e,y:t})=>{let r=this.getRatio(),o=this.leftTop,{minCropMaskSize:n,maxCropMaskSize:s}=this,l=Math.max(0,e,o.x+n.width),c=Math.max(0,t,o.y+n.height),p=l-o.x,m=c-o.y,h={width:Math.max(1,Math.min(p,s.width-o.x)),height:Math.max(1,Math.min(m,s.height-o.y))};if(r==="*")this.changeCropAndOutputSize(h);else{let b=this.proportionalSize(r,h);this.changeCropAndOutputSize(b)}};this.onPixelWidth=e=>{let t=JSON.stringify(k(this.localOutputSize)),r=this.entityManager.items.find(n=>n.identifier===this.identifier),o=this.defaults.imageSize;if(r&&r.ratio){let n=e,s=this.localOutputSize.height,{ratio:l}=r;if(l==="*"&&this.lockResolution&&(l=this.localOutputSize.width/this.localOutputSize.height),l==="*"&&!this.lockResolution)n=Math.max(Math.min(e,o.width),this.minCropSize),this.changeLocalOutputWidth(n);else{let c=si.placeCropMask(l,o);n=Math.max(Math.min(n,c.width),this.minCropSize),s=n/l,this.changeLocalOutputSize({height:s,width:n})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(t)),Math.round(n)}return e};this.onPixelHeight=e=>{let t=JSON.stringify(k(this.localOutputSize)),r=this.entityManager.items.find(n=>n.identifier===this.identifier),o=this.defaults.imageSize;if(r&&r.ratio){let n=e,s=this.localOutputSize.width,{ratio:l}=r;if(l==="*"&&this.lockResolution&&(l=this.localOutputSize.width/this.localOutputSize.height),l==="*"&&!this.lockResolution)n=Math.max(Math.min(e,o.height),this.minCropSize),this.changeLocalOutputHeight(n);else{let c=si.placeCropMask(l,o);n=Math.max(Math.min(n,c.height),this.minCropSize),s=n*l,this.changeLocalOutputSize({height:n,width:s})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(t)),Math.round(n)}return e};this.closestRatioReducer=e=>(t,r)=>r===null||Math.abs(e-t.ratio)<Math.abs(e-r.ratio)?-1:1;this.closestDimensionsReducer=e=>(t,r)=>{if(r===null)return-1;let o=Math.abs(t.dimensions.x/t.dimensions.y),n=Math.abs(r.dimensions.x/r.dimensions.y);return o===n?t.dimensions.x*t.dimensions.y>r.dimensions.x*r.dimensions.y?-1:1:Math.abs(e-o)<Math.abs(e-n)?-1:1};this.getMatchingItem=()=>{let e=this.entityManager.items.findIndex(c=>c.identifier==="imgly_transform_common_custom");if(e!==-1)return this.entityManager.items[e];let t=this.entityManager.items.findIndex(c=>c.ratio==="*");if(t!==-1)return this.entityManager.items[t];let r=k(this.editor.outputContainer.getResolution()),o=Math.abs(r.width/r.height),[n]=this.entityManager.items.filter(c=>c.ratio&&typeof c.ratio=="number").sort(this.closestRatioReducer(o)),[s]=this.entityManager.items.filter(c=>c.dimensions&&!c.ratio).sort(this.closestDimensionsReducer(o));if(!n||!s||!n.ratio&&!s.dimensions)return this.entityManager.items[0];if(!s||!s.dimensions)return n;if(!n||!n.ratio)return s;let l=Math.abs(s.dimensions.x/s.dimensions.y);return l===n.ratio||Math.abs(o-n.ratio)<Math.abs(o-l)?n:s};this.getTransform=e=>{let t=this.entityManager.items.find(r=>r.identifier===e);return t||(t=this.getMatchingItem()),t};this.editor=e,this.selectedCategory=ec,this.transformStore=new B(e,this.defaults),this.transformations=new xs(e);let s=this.config,{enableRotation:t,enableFlip:r}=s,o=Pe(s,["enableRotation","enableFlip"]),n=this.editor.assetProvider.getAssets("transform");this.entityManager=new ee(n,f(f({},o),{categoryKey:"",itemKey:"thumbnailURI",locale:f(f({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("transform")})),this.rect=new ne(this.editor,this.transformStore,"topLeft",!1,!1),this.rectForUi=new ne(this.editor,this.transformStore,"topLeft",!1,!0),this.minCropSize=this.editor.configStore.measurements.crop.minSize}static inRadians(e){return e*Math.PI/180}static placeCropMask(e,t){if(t.height*e>t.width)return{height:t.width/e,width:t.width,yChanged:!0};let r=t.height*e;return{height:t.height,width:r,yChanged:!1}}changeIdentifier(e,t=!1){this.transformStore.changeIdentifier(e);let r=this.getCropMask(e,this.defaults.imageSize);r&&(this.transformStore.changeRatio(r.ratio),this.changeLocalOutputSize(r),this.updatePreviewSizeWRTImageSize(),r.yChanged!==void 0&&this.updateInitialCropMaskPosition(r.yChanged),r.dimensions&&this.changeLocalOutputSize({width:r.dimensions.x,height:r.dimensions.y}),t&&this.addLocalSnapshot())}setDragMode(e){this.dragMode.set(e)}getCropMask(e,t){let r=this.getTransform(e);if(r){let{ratio:o,forceDimensions:n,lockDimensions:s,dimensions:l=null}=r;if(n&&this.transformStore.changeForceDimensions(n),s&&this.transformStore.changeLockResolution(s),o)switch(o){case"*":return this.changePosition({x:0,y:0}),f(f({},t),{yChanged:void 0,ratio:"*",dimensions:l});default:return f(f({},si.placeCropMask(r.ratio,t)),{ratio:r.ratio,dimensions:l})}else{let{x:c,y:p}=r.dimensions;return f(f({},si.placeCropMask(c/p,t)),{ratio:null,dimensions:l})}}return null}setCropDefaults(e=!1){let t=this.editor.outputContainer.getResolution();this.setDefaultImageSize(t);let r=this.editor.getPreviewSize(),{position:o}=this.editor.engineMediator.preview.previewTransformWithoutDpr;this.setMaxCropSize(r),this.setDefaultCropPosition({x:o.x-r.width/2,y:o.y-r.height/2}),this.changeDefaultScale(this.editor.scale.defaultScale),e||(this.unRotatedDefaults.cropMaskPosition=this.defaultCropMaskPosition,this.unRotatedDefaults.scale=this.defaultScale)}setDefaultImageSize(e){this.defaults.imageSize=f({},k(e)),this.lockResolution||(this.localOutputSize=f({},k(e)))}setMaxCropSize(e){this.defaults.maxCropMaskSize.height=e.height,this.defaults.maxCropMaskSize.width=e.width}setDefaultCropPosition(e){this.defaults.cropMaskPosition.x=e.x,this.defaults.cropMaskPosition.y=e.y}resetCrop(){this.state.cropState=S.map({}),this.state.identifier="identity"}toggleCategorySelection(e){this.selectedCategory=this.selectedCategory===e?ec:e}pureReset(){this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.resetCrop()}changePosition(e){return this.transformStore.changePosition(e,this.defaults.maxCropMaskSize)}changePositionX(e){return this.transformStore.changePositionX(e,this.defaults.maxCropMaskSize.width)}changePositionY(e){return this.transformStore.changePositionY(e,this.defaults.maxCropMaskSize.height)}changeCropAndOutputHeight(e){return e&&e>=this.minCropSize?(this.transformStore.changeHeight(e),this.lockResolution||this.changeLocalOutputHeight(e*this.defaults.imageSize.height/this.defaults.maxCropMaskSize.height),!0):!1}changeCropAndOutputWidth(e){return e&&e>=this.minCropSize?(this.transformStore.changeWidth(e),this.lockResolution||this.changeLocalOutputWidth(e*this.defaults.imageSize.width/this.defaults.maxCropMaskSize.width),!0):!1}changeCropAndOutputSize(e){let t=this.changeCropAndOutputHeight(e.height),r=this.changeCropAndOutputWidth(e.width);return{widthChanged:t,heightChanged:r}}transformRender(e=!0){this.transformations.applyPreviewTransform(),e&&this.editor.render()}addLocalSnapshot(e=`Local ${this.locale.title}`){if(this.localSnapshotEnabled){let t=this.state,{cropState:r}=t,o=Pe(t,["cropState"]);this.editor.addLocalTransformSnapshot(f(f(f({},o),this.cropState),{localOutputSize:k(this.localOutputSize),outputSize:this.engineMediator.output.container.getResolution(),defaults:k(this.defaults),previewTransform:this.engineMediator.preview.container.getTransform(),outputTransform:this.engineMediator.output.container.getTransform()}),e)}}updateLocalStateFromHistory(e){let{tool:t}=this.editor.activeStore;t===g.TRANSFORM&&(this.transformStore.changeLockResolution(e.lockResolution),this.transformStore.changeForceDimensions(e.forceDimensions),this.transformStore.changeIdentifier(e.identifier),this.transformStore.setRotation(e.rotationInDegrees),this.setDefaultAngle(e.rotationInDegrees),this.transformStore.setOutputRotation(e.outputRotation),this.transformStore.updateFlip(e),this.engineMediator.output.container.setRotation(e.outputRotation),this.setDefaultImageSize(e.defaults.imageSize),this.localOutputSize=e.defaults.imageSize,this.changeLocalOutputSize(e.localOutputSize),this.transformStore.changeSize(e.size),this.changePosition(e.position),this.setMaxCropSize(e.defaults.maxCropMaskSize),this.setDefaultCropPosition(e.defaults.cropMaskPosition),this.changeDefaultScale(e.defaults.scale),this.engineMediator.output.container.setResolution(e.outputSize),this.engineMediator.preview.container.setTransform(e.previewTransform),this.engineMediator.output.container.setTransform(e.outputTransform))}updateStateFromHistory(e){let{tool:t}=this.editor.activeStore;t!==g.TRANSFORM&&(this.engineMediator.output.container.setTransform(e.outputTransform),this.engineMediator.preview.container.setTransform(e.previewTransform),this.engineMediator.output.container.setResolution(e.outputSize),this.changeLocalOutputSize(e.outputSize))}get serializableState(){let{flipHorizontally:e,flipVertically:t}=this.rotateFlipState,r=this.editor.engineMediator.output.container.getRotation()*180/Math.PI%360,{identifier:o,rotationInDegrees:n}=this,s=n*Math.PI/180,l=r+n;l=Math.round(l/90)*90,l=l<0?l+360:l,l=(360-l)%360;let{start:c,end:p}=this.convertUIToOperationOptions(s,l);return{flipHorizontally:e,flipVertically:t,rotation:s,start:c,end:p,identifier:o,outputRotation:l}}getStartEndForOperation(e){let{leftTop:t,rightBottom:r,maxCropMaskSize:o}=this,n=t.y,s=t.x,l=r.x,c=r.y;switch(e){case 270:return{leftTop:{x:o.height-c,y:s},rightBottom:{x:o.height-n,y:l}};case 180:return{leftTop:{x:o.width-l,y:o.height-c},rightBottom:{x:o.width-s,y:o.height-n}};case 90:return{leftTop:{x:n,y:o.width-l},rightBottom:{x:c,y:o.width-s}};default:return{leftTop:{x:s,y:n},rightBottom:{x:l,y:c}}}}getStartEndForUI(e,t,r){let{maxCropMaskSize:o}=this,n=t.y,s=t.x,l=r.x,c=r.y;switch(e){case 90:return{leftTop:{x:n,y:o.height-l},rightBottom:{x:c,y:o.height-s}};case 180:return{leftTop:{x:o.width-l,y:o.height-c},rightBottom:{x:o.width-s,y:o.height-n}};case 270:return{leftTop:{x:o.width-c,y:s},rightBottom:{x:o.width-n,y:l}};default:return{leftTop:{x:s,y:n},rightBottom:{x:l,y:c}}}}convertOperationOptionsToUI({start:e,end:t,rotation:r,outputRotation:o}){let n=o===90||o===270,s=n?_.fromSize(this.defaultImageSize).swapped:_.fromSize(this.defaultImageSize),l=Math.cos(r),c=Math.sin(r),p=this.calculateScale(r),m=new _(Math.min(e.x,t.x),Math.min(e.y,t.y)),b=new _(Math.max(e.x,t.x),Math.max(e.y,t.y)).subtract(m).divide(2),x=m.add(b).multiply(s).subtract(s.multiply(.5)),I=new _(x.x*l-x.y*c,x.x*c+x.y*l).multiply(p),M=s.multiply(.5).add(I).divide(s),Q=M.subtract(b.multiply(p)),se=M.add(b.multiply(p)),ve=n?_.fromSize(this.maxCropMaskSize).swapped:_.fromSize(this.maxCropMaskSize),_e=Q.multiply(ve),T=se.multiply(ve),{leftTop:Z,rightBottom:ae}=this.getStartEndForUI(o,_e,T);return{start:new _(Z),end:new _(ae)}}convertUIToOperationOptions(e,t){let r=t===90||t===270,o=r?_.fromSize(this.defaultImageSize).swapped:_.fromSize(this.defaultImageSize),n=r?_.fromSize(this.maxCropMaskSize).swapped:_.fromSize(this.maxCropMaskSize),s=Math.cos(-e),l=Math.sin(-e),c=this.calculateScale(e,r),{leftTop:p,rightBottom:m}=this.getStartEndForOperation(t),h=new _(p).divide(n),v=new _(m).divide(n).subtract(h).divide(2),I=h.add(v).multiply(o).subtract(o.multiply(.5)),R=new _(I.x*s-I.y*l,I.x*l+I.y*s).divide(c),Q=o.multiply(.5).add(R).divide(o),se=Q.subtract(v.divide(c)),ve=Q.add(v.divide(c));return{start:se,end:ve}}calculateScale(e,t=!1){let r=t?_.fromSize(this.defaultImageSize).swapped:_.fromSize(this.defaultImageSize),o=new _(Math.abs(r.x*Math.cos(e))+Math.abs(r.y*Math.sin(e)),Math.abs(r.x*Math.sin(e))+Math.abs(r.y*Math.cos(e))),n=r.subtract(o.clone()).divide(2).abs;return n.y>n.x?n.y*2/r.y+1:n.x*2/r.x+1}updateStateFromSerialization(e,t){this.localSnapshotEnabled=t,this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.setDefaultAngle(0),this.editor.outputContainer.getRotation()!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop();let r=Math.round(e.rotation*180/Math.PI);this.transformStore.setRotation(r>180?r-360:r),this.applyOutputRotationFromSerialization(e),e.identifier&&this.transformStore.changeIdentifier(e.identifier);let o=e.outputRotation<0?e.outputRotation+360:e.outputRotation;if(o=(360-o)%360,e.start&&e.end){(e.end.x===0||e.end.y===0)&&(e.end.x=1,e.end.y=1);let{start:n,end:s}=this.convertOperationOptionsToUI({start:new _(e.start),end:new _(e.end),rotation:e.rotation,outputRotation:o});this.changePositionX(n.x),this.changePositionY(n.y);let l=s.x-n.x,c=s.y-n.y;this.transformStore.changeSize({width:l,height:c});let{maxCropMaskSize:p,imageSize:m}=this.defaults,h={height:c*m.height/p.height,width:l*m.width/p.width};this.changeLocalOutputSize(h)}this.editor.outputContainer.setData({flipHorizontally:e.flipHorizontally,flipVertically:e.flipVertically}),e.flipHorizontally&&this.flipHorizontally(!1),e.flipVertically&&this.flipVertically(!1),this.editor.overlayToolStore.correctOverlayFlip(),this.localSnapshotEnabled=!0}applyOutputRotationFromSerialization(e){if(e.outputRotation!==void 0)switch(e.outputRotation){case 90:this.transformations.rotateOutputContainer();break;case 180:this.transformations.rotateOutputContainer(),this.transformations.rotateOutputContainer();break;case 270:this.transformations.rotateOutputContainer(!0);break;default:break}this.transformations.rotateOutputContainer(!0),this.transformations.rotateOutputContainer()}setDefaultAngle(e){this.defaultAngle=e}updateCanvasControls(e){let t=k(this.cropMaskPosition),r=k(this.cropMaskSize),o=k(this.defaults.maxCropMaskSize);this.changeCropAndOutputSize({height:o.height*r.height/e.height,width:o.width*r.width/e.width}),this.changePosition({y:o.height*t.y/e.height,x:o.width*t.x/e.width})}onLeave(){this.transformations.onLeave()}onEnter(){this.transformations.onEnter()}saveTransforms(){this.transformations.saveTransforms()}saveTransformsBasedOnFlip(){this.transformations.saveTransformsBasedOnFlip()}setRotation(e){this.transformStore.setRotation(e),this.transformRender()}rotateOutputContainer(e=!1){return C(this,null,function*(){this.setDragMode(!0),this.transformations.rotateOutputContainer(e),yield this.editor.wait(),this.setDragMode(!1)})}applyInitialCrop(){let{identifier:e}=this.getMatchingItem();this.changeIdentifier(e,!1)}clickableCanvas(e){this.editor.clickableCanvas(e)}proportionalSize(e,t,r=this.defaults.maxCropMaskSize,o=this.minCropSize){let n={width:t.height*e,height:t.height};return(n.width>r.width||n.width<o||n.height<o)&&(n.width=t.width,n.height=t.width/e),n.width=Math.round(n.width),n.height=Math.round(n.height),n}checkAndAddSnapshot(e){let t=k(this.localOutputSize);(e.width!==t.width||e.height!==t.height)&&this.addLocalSnapshot()}updateInitialCropMaskPosition(e){let{cropMaskSize:t}=this,r=this.defaults.maxCropMaskSize;e?this.changePosition({x:0,y:Math.abs(r.height-t.height)/2}):this.changePosition({x:Math.abs(r.width-t.width)/2,y:0})}updatePreviewSizeWRTImageSize(){let e=k(this.localOutputSize),t=k(this.defaults.imageSize),r=k(this.defaults.maxCropMaskSize),o={height:r.height*e.height/t.height,width:r.width*e.width/t.width};this.transformStore.changeSize(o)}getScaleWithFlip(e=this.rotateFlipState.rotation){return this.transformations.getScaleWithFlip(e)}get cropState(){return this.transformStore.selectedCrop}get identifier(){return this.transformStore.identifier}get ratio(){return this.transformStore.ratio}get height(){return this.transformStore.height}get width(){return this.transformStore.width}get localOutputImageSize(){return this.localOutputSize}get localOutputHeight(){return this.localOutputSize.height}get localOutputWidth(){return this.localOutputSize.width}get lockResolution(){return this.transformStore.lockResolution}get forceDimensions(){return this.transformStore.forceDimensions}get rotationInDegrees(){return this.transformStore.rotationInDegrees}get outputRotation(){return this.transformStore.outputRotation}get isDragMode(){return this.dragMode.get()}get rotateFlipState(){let{flipHorizontally:e,flipVertically:t,rotationInDegrees:r,outputRotation:o}=this.transformStore.state;return{flipHorizontally:e,flipVertically:t,rotation:si.inRadians(r),outputRotation:o}}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}get config(){return this.editor.configStore.config[g.TRANSFORM]}get locale(){return this.editor.configStore.locale[g.TRANSFORM]}get isOptionSelected(){return this.identifier!=="identity"}get leftTop(){return this.rect.leftTop}get leftBottom(){return this.rect.leftBottom}get rightTop(){return this.rect.rightTop}get rightBottom(){return this.rect.rightBottom}get isFlippedHorizontal(){return this.transformStore.isFlippedHorizontal}get isFlippedVertical(){return this.transformStore.isFlippedVertical}get leftTopRespectFlip(){return this.rectForUi.leftTop}get leftBottomRespectFlip(){return this.rectForUi.leftBottom}get rightTopRespectFlip(){return this.rectForUi.rightTop}get rightBottomRespectFlip(){return this.rectForUi.rightBottom}get cropMaskPosition(){return this.transformStore.position}get cropMaskSize(){return this.transformStore.size}get state(){return this.transformStore.state}get defaultImageSize(){return this.defaults.imageSize}get maxCropMaskSize(){return this.defaults.maxCropMaskSize}get minCropMaskSize(){let e=this.getRatio();return e==="*"||e===1?{width:this.minCropSize,height:this.minCropSize}:e>1?{width:this.minCropSize*e,height:this.minCropSize}:{width:this.minCropSize,height:this.minCropSize*e}}get defaultCropMaskPosition(){return this.defaults.cropMaskPosition}get defaultScale(){return this.defaults.scale}get engineMediator(){return this.editor.engineMediator}getRatio(){let e=this.getTransform(this.identifier);if(e){if(Object.prototype.hasOwnProperty.call(e,"ratio"))return this.lockResolution?this.localOutputWidth/this.localOutputHeight:e.ratio;let{x:t,y:r}=e.dimensions;return t/r}return"*"}},D=si;a([S],D.prototype,"selectedCategory",2),a([S],D.prototype,"defaults",2),a([S],D.prototype,"localOutputSize",2),a([d],D.prototype,"changeIdentifier",1),a([d],D.prototype,"setDragMode",1),a([d],D.prototype,"setCropDefaults",1),a([d],D.prototype,"setDefaultImageSize",1),a([d],D.prototype,"setMaxCropSize",1),a([d],D.prototype,"setDefaultCropPosition",1),a([d],D.prototype,"resetCrop",1),a([d],D.prototype,"toggleCategorySelection",1),a([d],D.prototype,"pureReset",1),a([d],D.prototype,"reset",2),a([d],D.prototype,"changePosition",1),a([d],D.prototype,"changePositionX",1),a([d],D.prototype,"changePositionY",1),a([d],D.prototype,"changeCropAndOutputHeight",1),a([d],D.prototype,"changeCropAndOutputWidth",1),a([d],D.prototype,"changeCropAndOutputSize",1),a([d],D.prototype,"onLeave",1),a([d],D.prototype,"onEnter",1),a([d],D.prototype,"changeLocalOutputSize",2),a([d],D.prototype,"changeDefaultScale",2),a([d],D.prototype,"changeLocalOutputHeight",2),a([d],D.prototype,"changeLocalOutputWidth",2),a([d],D.prototype,"changeLockResolution",2),a([d],D.prototype,"setRotation",1),a([d],D.prototype,"rotateClockwise",2),a([d],D.prototype,"rotateAntiClockwise",2),a([d],D.prototype,"rotateOutputContainer",1),a([d],D.prototype,"flipHorizontally",2),a([d],D.prototype,"flipVertically",2),a([d],D.prototype,"applyDefaultCrop",2),a([d],D.prototype,"applyInitialCrop",1),a([d],D.prototype,"updateCropMask",2),a([d],D.prototype,"clickableCanvas",1),a([d],D.prototype,"onLeftTop",2),a([d],D.prototype,"onLeftBottom",2),a([d],D.prototype,"onRightTop",2),a([d],D.prototype,"onRightBottom",2),a([d],D.prototype,"proportionalSize",1),a([d],D.prototype,"onPixelWidth",2),a([d],D.prototype,"onPixelHeight",2),a([d],D.prototype,"updateInitialCropMaskPosition",1),a([d],D.prototype,"updatePreviewSizeWRTImageSize",1),a([u],D.prototype,"cropState",1),a([u],D.prototype,"identifier",1),a([u],D.prototype,"ratio",1),a([u],D.prototype,"height",1),a([u],D.prototype,"width",1),a([u],D.prototype,"localOutputImageSize",1),a([u],D.prototype,"localOutputHeight",1),a([u],D.prototype,"localOutputWidth",1),a([u],D.prototype,"lockResolution",1),a([u],D.prototype,"forceDimensions",1),a([u],D.prototype,"rotationInDegrees",1),a([u],D.prototype,"outputRotation",1),a([u],D.prototype,"isDragMode",1),a([u],D.prototype,"rotateFlipState",1),a([u],D.prototype,"selectedCategoryIdentifier",1),a([u],D.prototype,"categories",1),a([u],D.prototype,"items",1),a([u],D.prototype,"config",1),a([u],D.prototype,"locale",1),a([u],D.prototype,"isOptionSelected",1),a([u],D.prototype,"leftTop",1),a([u],D.prototype,"leftBottom",1),a([u],D.prototype,"rightTop",1),a([u],D.prototype,"rightBottom",1),a([u],D.prototype,"isFlippedHorizontal",1),a([u],D.prototype,"isFlippedVertical",1),a([u],D.prototype,"leftTopRespectFlip",1),a([u],D.prototype,"leftBottomRespectFlip",1),a([u],D.prototype,"rightTopRespectFlip",1),a([u],D.prototype,"rightBottomRespectFlip",1),a([u],D.prototype,"cropMaskPosition",1),a([u],D.prototype,"cropMaskSize",1),a([u],D.prototype,"state",1),a([u],D.prototype,"defaultImageSize",1),a([u],D.prototype,"maxCropMaskSize",1),a([u],D.prototype,"minCropMaskSize",1),a([u],D.prototype,"defaultCropMaskPosition",1),a([u],D.prototype,"defaultScale",1);var ie=class{constructor(e){this.checkImageResize=()=>{this.engine.on(Yr.BEGAN_IMAGE_DOWNSCALING,()=>{this.modalStore.showInfoModal("resizing")}),this.engine.on(Yr.IMAGE_DOWNSCALED,({width:e,height:t})=>{let{maxMegaPixels:r}=this.configStore.config.engine.downscaleOptions,o=jn.isMobile()?r.mobile:r.desktop;this.modalStore.hideModal(),this.modalStore.showActionModal({type:oe.WARNING,identifier:"imageResized",handleConfirm:()=>{this.modalStore.hideModal()},error:{megapixels:`${o}`,width:`${e}`,height:`${t}`}})})};this.init=e=>{this.historyStore.isDirty()?this.modalStore.showActionModal({type:oe.WARNING,identifier:"discardChanges",handleConfirm:()=>{this.setImage(e),this.resetToolStates()},handleDismiss:()=>{this.setImage(e,!0)}}):this.setImage(e,!0).then(()=>{let{engine:r,displayCanvasRendererWarning:o}=this.configStore.config;r.preferredRenderer==="canvas"&&o&&this.modalStore.showActionModal({type:oe.WARNING,identifier:"unsupportedWebGLRenderer",handleConfirm:()=>{this.modalStore.hideModal()}})}),this.historyStore.reset(),this.libraryStore.fetchImages()};this.setImage=(e,t=!1)=>C(this,null,function*(){try{this.modalStore.showInfoModal(this.configStore.config.displayResizeWarning?"resizing":"loading"),this.scale.defaultScale=1,this.scale.resetOffset(),yield this.activeStore.setImage(e),yield this.engineMediator.image.addImageToContainer(),this.engineMediator.output.applyNewImageTransform(),this.engineMediator.preview.updateTransform(),this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.historyStore.addInitialSnapshot();let{flipHorizontally:r,flipVertically:o}=this.transformToolStore.rotateFlipState;this.outputContainer.setData({flipVertically:o,flipHorizontally:r}),t?(this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls(),this.transformToolStore.resetCrop(),this.transformToolStore.applyDefaultCrop(),this.transformToolStore.saveTransformsBasedOnFlip(),this.transformToolStore.onEnter(),this.transformToolStore.setRotation(this.transformToolStore.rotationInDegrees),this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()):this.transformToolStore.saveTransforms(),this.snappingStore.calculatePreviewTopLeftPosition(),yield this.renderPromise(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"&&this.filterToolStore.setImageAndGetPreviews(),this.activeStore.tool?this.configStore.events.onImageLoaded():this.onReady(),this.modalStore.identifier!=="imageResized"&&this.modalStore.hideModal()}catch(r){this.configStore.events.onErrorImageLoading(r),this.modalStore.hideModal(),this.modalStore.showActionModal({type:oe.ERROR,identifier:r.identifier?r.identifier:"rendering",error:r,handleConfirm:()=>{window.location.reload()}})}});this.onToolChange=(e,t=null,r=!0)=>{if(e!==t&&this.engineMediator.preview.container){if([e,t].indexOf(g.TRANSFORM)!==-1){let{canvasSize:o}=this.canvasStore,n=this.configStore.measurements.basicToolControlBar.controlsBarHeight;if(e===g.TRANSFORM){this.transformToolStore.onLeave(),this.historyStore.removeTransformLocalSnapshots();let s=this.engineMediator.preview.container.getScale().x,l=this.engineMediator.output.container.getResolution(),{defaultImageSize:c}=this.transformToolStore;(s!==1||c.width!==l.width||c.height!==l.height)&&this.addSnapshot(void 0,F.EDIT,this.configStore.locale.transform.title),this.snappingStore.calculatePreviewTopLeftPosition(),this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=o.height+n,this.resize(!0))}else t===g.TRANSFORM&&(this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=o.height-n,this.resize(),this.render()),this.transformToolStore.onEnter(),this.transformToolStore.addLocalSnapshot(),this.historyStore.saveTransformLocalSnapshotIndex())}else this.scale.resetOffset(),this.scale.resetPosition(),this.scale.setScaleToDefault(),this.scale.scaleRender(!0);r&&this.render()}};this.resize=(e=!1)=>{try{this.transformToolStore.applyDefaultCrop(),this.canvasStore.updateCanvasDimensions();let t=k(this.transformToolStore.maxCropMaskSize),r=this.activeStore.tool===g.TRANSFORM;(!r||e)&&this.transformToolStore.onEnter();let o=this.engineMediator.preview.container.getRotation();if(this.engineMediator.preview.updateTransform(o)){this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.transformToolStore.updateCanvasControls(t),this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls();let s=this.transformToolStore.getScaleWithFlip(o);this.engineMediator.preview.container.setScale(s),(!r||e)&&(this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()),this.snappingStore.calculatePreviewTopLeftPosition(),this.render()}}catch(t){this.modalStore.showActionModal({type:oe.ERROR,identifier:"rendering",handleConfirm:()=>{window.location.reload()}})}};this.export=(r={})=>{var{preventExportEvent:e}=r,t=Pe(r,["preventExportEvent"]);return new Promise((o,n)=>{this.modalStore.showInfoModal("exporting");let s=this.activeStore.tool===g.TRANSFORM;s&&this.transformToolStore.onLeave();let{config:l}=this.configStore,c=f(f({},l.export.image),t),{exportType:p,format:m,quality:h,enableDownload:b}=c;this.engineMediator.engine.export(p,m,h).then(v=>{b&&this.triggerFileDownload(l.export.filename,m,p,v),e||this.configStore.events.onExport(v),o(v),s&&this.transformToolStore.onEnter(),this.modalStore.hideModal(),this.historyStore.isDirtySinceSave=!1}).catch(v=>{n(v),s&&this.transformToolStore.onEnter(),this.modalStore.hideModal()})})};this.serialize=({image:e}={image:!0})=>this.serializationMediator.serialize({image:e});this.deserialize=e=>this.serializationMediator.deserialize(e);this.close=()=>{this.historyStore.isDirtySinceSave&&this.configStore.config.displayCloseWarning?this.modalStore.showActionModal({type:oe.WARNING,identifier:"unsavedChanges",handleConfirm:()=>{this.configStore.events.onClose()}}):this.configStore.events.onClose()};this.hasChanges=()=>this.historyStore.isDirty();this.wait=(e=0)=>new Promise(t=>setTimeout(t,e));this.clickableCanvas=e=>C(this,null,function*(){e?(yield new Promise(t=>setTimeout(t,0)),this.canvasStore.enableCanvasClick()):this.canvasStore.disableCanvasClick()});this.onReady=()=>C(this,null,function*(){let{layout:e,forceCrop:t}=this.configStore.config;if(e==="advanced"&&this.activeStore.selectTool(this.configStore.defaultTool),t){let r=this.transformToolStore.localOutputImageSize,o=r.width/r.height,n=this.transformToolStore.entityManager.items.map(s=>s.ratio?s.ratio:s.dimensions.x/s.dimensions.y);n.indexOf("*")!==-1?console.error('ForceCrop will not work if "*" is one of the ratios'):n.indexOf(parseFloat(o.toFixed(2)))===-1&&this.activeStore.selectTool(g.TRANSFORM)}this.configStore.events.onEditorReady()});this.addSnapshot=(e,t,r)=>{this.historyStore.addSnapshot(e,t,r)};this.addLocalTransformSnapshot=(e,t,r=F.EDIT)=>{this.historyStore.addSnapshot({localTransform:e},r,t)};this.resetToolStates=()=>{this.filterToolStore.pureReset(),this.focusToolStore.pureReset(),this.adjustmentsToolStore.pureReset(),this.overlayToolStore.pureReset(),this.frameToolStore.pureReset(),this.brushToolStore.pureReset(),this.spriteStore.pureReset(),this.transformToolStore.pureReset(),this.historyStore.reset(),this.render()};this.getAssetPath=e=>this.assetProvider.getPathForCategory(e);this.render=()=>C(this,null,function*(){yield this.renderPromise()});this.applyFlipToPreview=e=>this.engineMediator.previewSpaceToFlippedPreviewSpace(e);this.getPreviewSize=()=>{let{width:e,height:t}=this.engine.getOutputDimensions();return e&&t?{width:Math.round(this.worldToPreview(this.outputToWorld(e))),height:Math.round(this.worldToPreview(this.outputToWorld(t)))}:{height:t,width:e}};this.triggerFileDownload=(e,t,r,o)=>{let n=t===Be.JPEG&&r!==$e.MSBLOB?".jpeg":".png",s=e+n,l=this.blobFromExportData(o);this.triggerBlobDownload(s,l)};this.triggerBlobDownload=(e,t)=>{if(navigator.msSaveBlob)navigator.msSaveBlob(t,e);else{let r=document.createElement("a"),o=URL.createObjectURL(t);r.href=o,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),yl()||URL.revokeObjectURL(o)}};this.blobFromExportData=e=>typeof e=="string"?gs(e):e instanceof HTMLImageElement?gs(e.src):e;this.configStore=new ke;let t=this.configStore.saveConfig(e);if(this.engineMediator=new Cs(this),this.serializationMediator=new or(this),this.spriteStore=new w(this),this.scale=new le(this),this.filterToolStore=new te(this),this.adjustmentsToolStore=new H(this),this.focusToolStore=new P(this),this.overlayToolStore=new ce(this),this.frameToolStore=new J(this),this.brushToolStore=new Y(this),this.transformToolStore=new D(this),this.libraryStore=new Fe(this),this.modalStore=new Le(this),this.snappingStore=new at(this),this.activeStore=new qe(this),this.canvasStore=new Ie(this),this.historyStore=new oi(this),this.modalStore.showInfoModal("loading"),this.libraryStore.initProvider(t),this.configStore.config.displayResizeWarning&&this.checkImageResize(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"){let r=this.configStore.config.engine;this.previewThumbnails=new sr(f(f({},r),{license:this.configStore.config.license,assetProvider:this.configStore.assetProvider}))}}static get defaultColors(){return Object.keys(xe).map(e=>{let t=xe[e];return{identifier:e,color:t,colorString:ir(t)}})}static get defaultBackgroundColors(){return Object.keys(ts).map(e=>{let t=ts[e];return{identifier:e,color:t,colorString:ir(t)}})}static get devicePixelRatio(){return window.devicePixelRatio||1}get shortestOutputSide(){let e=this.outputContainer.getBounds();return Math.min(e.width,e.height)}get assetProvider(){return this.configStore.assetProvider}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get orderHelper(){return this.engineMediator.orderHelper}renderPromise(){return this.engineMediator.render(this.engineMediator.preview.container)}previewToWorld(e,t){return Ve(e)?this.engineMediator.previewSpaceToWorldSpace(e,t):this.engineMediator.previewSpaceToWorldSpace(e,t)}worldToPreview(e){return Ve(e)?this.engineMediator.worldSpaceToPreviewSpace(e):this.engineMediator.worldSpaceToPreviewSpace(e)}worldSizeToPreview(e){return{width:this.engineMediator.worldSpaceToPreviewSpace(e.width),height:this.engineMediator.worldSpaceToPreviewSpace(e.height)}}previewSizeToWorld(e,t){return{width:this.engineMediator.previewSpaceToWorldSpace(e.width,t),height:this.engineMediator.previewSpaceToWorldSpace(e.height,t)}}outputToWorld(e){return Ve(e)?this.engineMediator.outputSpaceToWorldSpace(e):this.engineMediator.outputSpaceToWorldSpace(e)}previewToOutput(e){return Ve(e)?this.engineMediator.previewSpaceToOutputSpace(e):this.engineMediator.previewSpaceToOutputSpace(e)}get outputContainer(){return this.engineMediator.output.container}};a([d],ie.prototype,"resize",2),a([d],ie.prototype,"export",2),a([d],ie.prototype,"clickableCanvas",2);function ws(i,e){let t=i.width/i.height,r=e.width/e.height;return t>r?i.height/e.height:i.width/e.width}var hm={transform:X.IDENTITY},wt=class{constructor(e){this.initialTransform=X.IDENTITY;this.editor=e,this.state=S(hm)}createPreview(e){this.container=this.editor.engine.createPreview(e)}updateTransform(e=0,t=!0){let r=this.calculateTransform(e);return r.scale.x?(t?this.saveInitialTransform(r):this.savePreviewTransform(r),this.container.setTransform(this.state.transform),!0):!1}saveInitialTransform(e){this.initialTransform=e,this.savePreviewTransform(e)}savePreviewTransform(e){re(()=>{this.state.transform.position=e.position,this.state.transform.scale=e.scale,this.state.transform.rotation=e.rotation;let t=ie.devicePixelRatio;this.previewTransformWithoutDpr={position:new _(e.position).divide(t),scale:new _(e.scale).divide(t),rotation:e.rotation}})}get transform(){return this.state.transform}get position(){return this.state.transform.position}get scale(){return this.state.transform.scale}get rotation(){return this.state.transform.rotation}calculateTransform(e=0){let t=ie.devicePixelRatio,{width:r,height:o}=this.editor.canvasStore.canvasSize,n=this.editor.engine.getOutputDimensions(),s=ws({width:r,height:o},n),l=.95;window.innerWidth<600&&(l=.98),s*=l;let c=o-n.height*s,p=this.editor.configStore.measurements.mainCanvasActionBar.height*2;c<p&&(s=ws({width:r,height:o-p},n),s*=l),s*=t;let m={x:r*t/2,y:o*t/2},h={x:s,y:s};return new X(m,h,e)}};a([d],wt.prototype,"updateTransform",1),a([d],wt.prototype,"savePreviewTransform",1),a([u],wt.prototype,"transform",1),a([u],wt.prototype,"position",1),a([u],wt.prototype,"scale",1),a([u],wt.prototype,"rotation",1);var Vt=class{constructor(){this.imageContainerOrder=[];this.spriteContainerOrder=[]}static checkTool(e){if([g.STICKER,g.TEXT,g.TEXT_DESIGN,g.BRUSH,g.FRAME].indexOf(e)!==-1)throw new Error("addIndex is used for non sprites, for sprites use addSprite")}static remove(e,t){let r=t.findIndex(o=>o===e);r!==-1&&t.splice(r,1)}static indexForOrder(e,t,r){let o=e[r],n=t.findIndex(l=>l===r);if(n!==-1)return{index:n,order:t};let{length:s}=t;if(s){let l;for(l=0;l<s;l+=1){let c=t[l],p=e[c];if(o<p)return t=[...t.slice(0,l),r,...t.slice(l)],{index:l,order:t}}}return t.push(r),{index:t.length-1,order:t}}addIndex(e){Vt.checkTool(e);let{index:t,order:r}=Vt.indexForOrder(Vt.IMAGE_CONTAINER_INDEX,this.imageContainerOrder,e);return this.imageContainerOrder=r,t}removeIndex(e){Vt.checkTool(e),Vt.remove(e,this.imageContainerOrder)}addSprite(e){return this.spriteContainerOrder.push(e),this.imageContainerOrder.length+this.spriteContainerOrder.length-1}removeSprite(e){Vt.remove(e,this.spriteContainerOrder)}renameSprite(e,t){let r=this.spriteContainerOrder.findIndex(o=>o===e);r!==-1&&(this.spriteContainerOrder[r]=t)}bringToFront(e){let t=this.spriteContainerOrder.findIndex(r=>r===e);return t!==-1&&(this.spriteContainerOrder.splice(t,1),this.spriteContainerOrder.push(e)),this.getLastSpriteIndex()}getLastSpriteId(){let{length:e}=this.spriteContainerOrder;return this.spriteContainerOrder[e-1]}getSpriteIndex(e){return this.spriteContainerOrder.findIndex(r=>r===e)+this.imageContainerOrder.length-1}getLastSpriteIndex(){return this.imageContainerOrder.length+this.spriteContainerOrder.length-1}},so=Vt;so.IMAGE_CONTAINER_INDEX={[g.ART_FILTER]:0,[g.FILTER]:1,[g.ADJUSTMENT]:2,[g.FOCUS]:3,[g.OVERLAY]:4};var Cs=class{constructor(e){this.orderHelper=new so;let t=e.configStore.config.engine;this.engine=new tr(f(f({},t),{license:e.configStore.config.license,assetProvider:e.configStore.assetProvider})),this.image=new ds(e),this.output=new ps(e),this.preview=new wt(e),this.editor=e}render(e){return this.engine.render(e)}previewSpaceToWorldSpace(e,t){let r=this.preview.previewTransformWithoutDpr;if(Ve(e)){let o=this.editor.engine.convertPointFromPreviewIntoWorldSpace(_.ZERO,r,t),n=this.editor.engine.convertPointFromPreviewIntoWorldSpace({x:e,y:0},r,t);return _.distance(new _(o),new _(n))}return this.editor.engine.convertPointFromPreviewIntoWorldSpace(e,r,t)}worldSpaceToPreviewSpace(e){let t=this.preview.previewTransformWithoutDpr;if(Ve(e)){let r=this.editor.engine.convertPointFromWorldIntoPreviewSpace(_.ZERO,t),o=this.editor.engine.convertPointFromWorldIntoPreviewSpace({x:e,y:0},t);return _.distance(new _(r),new _(o))}return this.editor.engine.convertPointFromWorldIntoPreviewSpace(e,t)}outputSpaceToWorldSpace(e){return Ve(e)?A.getScalarInWorldSpace(e,this.editor.engine.getOutputContainer()):A.getPointInWorldSpace(e,this.editor.engine.getOutputContainer())}previewSpaceToOutputSpace(e){let t=this.preview.previewTransformWithoutDpr;if(Ve(e)){let r=this.editor.engine.convertPointFromPreviewIntoOutputSpace(_.ZERO,t),o=this.editor.engine.convertPointFromPreviewIntoOutputSpace({x:e,y:0},t);return _.distance(new _(r),new _(o))}return this.editor.engine.convertPointFromPreviewIntoOutputSpace(e,t)}previewSpaceToFlippedPreviewSpace(e){return this.editor.engine.convertPointFromPreviewIntoFlippedPreviewSpace(e)}};var tc=[[0,0],[0,1],[1,0],[1,1]],fm=[[0,1,2,3],[2,3,0,1],[1,0,3,2],[3,2,1,0]],lt=class{constructor(e,t,r="center",o=!0,n=!1){this.considerRotation=!0;this.considerFlip=!0;this.store=t,this.m=r==="center"?lt.movePivotTo([.5,.5]):tc,this.considerRotation=o,this.considerFlip=n,this.configStore=e.configStore}static getFlippedEdgeIndex(e,t,r){return fm[(t?1:0)+(r?2:0)][e]}static movePivotTo(e){return tc.map(t=>[t[0]-e[0],t[1]-e[1]])}get position(){return this.store.position}get size(){return this.store.size}get rotation(){return this.considerRotation?this.store.rotationWRTOutputRotation:0}get flipHorizontally(){return this.considerFlip?this.store.isFlippedHorizontal:!1}get flipVertically(){return this.considerFlip?this.store.isFlippedVertical:!1}get flipCenter(){return this.considerFlip?this.store.flipCenter:null}handleOrigin(e,t,r){let o=lt.getFlippedEdgeIndex(e,t,r),n=this.m[o][0]*this.size.width,s=this.m[o][1]*this.size.height;return{width:n,height:s}}get leftTop(){let{position:e,flipHorizontally:t,flipVertically:r}=this,o=this.handleOrigin(0,t,r);return lt.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftBottom(){let{position:e,flipHorizontally:t,flipVertically:r}=this,o=this.handleOrigin(1,t,r);return lt.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightTop(){let{position:e,flipHorizontally:t,flipVertically:r}=this,o=this.handleOrigin(2,t,r);return lt.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightBottom(){let{position:e,flipHorizontally:t,flipVertically:r}=this,o=this.handleOrigin(3,t,r);return lt.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftBottomHandle(){let{position:e,flipHorizontally:t,flipVertically:r}=this,o=this.handleOrigin(1,t,r);return o.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,lt.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightBottomHandle(){let{position:e,flipHorizontally:t,flipVertically:r}=this,o=this.handleOrigin(3,t,r);return o.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,lt.coordinatesWithRotation(o,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftMid(){let e=new _(this.leftTop),t=new _(this.leftBottom);return e.add(t).divide(2)}get rightMid(){let e=new _(this.rightTop),t=new _(this.rightBottom);return e.add(t).divide(2)}},ne=lt;ne.coordinatesWithRotation=({width:e,height:t},r,o,n,s,l)=>{let c=e*Math.cos(r)-t*Math.sin(r)+l.x,p=e*Math.sin(r)+t*Math.cos(r)+l.y;return o&&(c=s.x*2-c),n&&(p=s.y*2-p),new _({x:c,y:p}).rounded},a([u],ne.prototype,"position",1),a([u],ne.prototype,"size",1),a([u],ne.prototype,"rotation",1),a([u],ne.prototype,"flipHorizontally",1),a([u],ne.prototype,"flipVertically",1),a([u],ne.prototype,"flipCenter",1),a([u],ne.prototype,"leftTop",1),a([u],ne.prototype,"leftBottom",1),a([u],ne.prototype,"rightTop",1),a([u],ne.prototype,"rightBottom",1),a([u],ne.prototype,"leftBottomHandle",1),a([u],ne.prototype,"rightBottomHandle",1),a([u],ne.prototype,"leftMid",1),a([u],ne.prototype,"rightMid",1);var Ii=(i,e=0,t=3)=>{let r=Math.tan(e),o=Math.sqrt(r**2+1);return{x:i.x+t/o,y:i.y+t*r/o}};var ao={blurRadius:40,gradientSize:.2},gm=f({start:{x:0,y:0},end:{x:0,y:0}},ao),bm=f({center:{x:0,y:0},radius:0},ao),ym=f({origin:{x:0,y:0},rotation:0,size:0},ao),vm=ao,ai={identifier:"identity",linear:gm,radial:bm,mirrored:ym,gaussian:vm};var Se=class{constructor(e){this.selectFocus=(e,t)=>{re(()=>{this.state.identifier=e,t&&(this.state[e].blurRadius=t)})};this.changeBlurRadius=(e,t)=>{e!=="identity"&&(this.state[e].blurRadius=t)};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=ai.identifier,this.state.identifier!=="identity"&&(this.state[this.state.identifier].blurRadius=ai[this.state.identifier].blurRadius))};this.setLinear=({start:e,end:t})=>{this.state.linear.start.x=e.x,this.state.linear.start.y=e.y,this.state.linear.end.x=t.x,this.state.linear.end.y=t.y};this.setLinearStart=e=>{this.state.linear.start.x=e.x,this.state.linear.start.y=e.y};this.setLinearEnd=e=>{this.state.linear.end.x=e.x,this.state.linear.end.y=e.y};this.setRadialCenter=e=>{this.state.radial.center.x=e.x,this.state.radial.center.y=e.y};this.setRadialRadius=e=>{this.state.radial.radius=e};this.setMirroredOrigin=e=>{this.state.mirrored.origin.x=e.x,this.state.mirrored.origin.y=e.y};this.setMirroredRotation=e=>{this.state.mirrored.rotation=e};this.setMirroredSize=e=>{this.state.mirrored.size=e};this.getEffectProperties=()=>this.effect?this.effect.getProperties():null;this.setLinearFocus=e=>{this.effect=this.engineMediator.engine.addLinearBlur(e,this.imageContainer,this.order),this.updateLinearState(this.effect.getProperties())};this.setGaussianFocus=e=>{this.effect=this.engineMediator.engine.addGaussianBlur(e,this.imageContainer,this.order),this.updateGaussianState(this.effect.getProperties())};this.setRadialFocus=e=>{this.effect=this.engineMediator.engine.addRadialBlur(e,this.imageContainer,this.order),this.updateRadialState(this.effect.getProperties())};this.setMirroredFocus=e=>{this.effect=this.engineMediator.engine.addMirroredBlur(e,this.imageContainer,this.order),this.updateMirroredState(this.effect.getProperties())};this.updateFromEngineState=e=>{let t=this.getEffectProperties();if(t&&e!=="identity")switch(e){case W.LINEAR:this.updateLinearState(t);break;case W.RADIAL:this.updateRadialState(t);break;case W.MIRRORED:this.updateMirroredState(t);break;default:break}};this.updateGaussianState=e=>{this.changeBlurRadius(W.GAUSSIAN,e.blurRadius)};this.updateMirroredState=e=>{let t=this.editor.worldToPreview(e.mirrorAxisOrigin),o=new _(this.editor.worldToPreview(e.mirrorAxisDirection)).subtract(t),n=Math.atan2(o.y,o.x);this.setMirroredOrigin(this.editor.worldToPreview(e.mirrorAxisOrigin)),this.setMirroredRotation(n),this.setMirroredSize(this.editor.worldToPreview(e.clearAreaWidth)),this.changeBlurRadius(W.MIRRORED,e.blurRadius)};this.updateRadialState=e=>{this.setRadialCenter(this.editor.worldToPreview(e.center)),this.setRadialRadius(this.editor.worldToPreview(e.radius)),this.changeBlurRadius(W.RADIAL,e.blurRadius)};this.updateLinearState=e=>{this.setLinearStart(this.editor.worldToPreview(e.start)),this.setLinearEnd(this.editor.worldToPreview(e.end)),this.changeBlurRadius(W.LINEAR,e.blurRadius)};this.setEffectProperties=e=>this.effect?(this.effect.setProperties(e),this.effect.getProperties()):null;this.removeFocus=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.engineMediator.orderHelper.removeIndex(g.FOCUS))};this.editor=e,this.engineMediator=this.editor.engineMediator,this.state=ai}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get order(){return this.engineMediator.orderHelper.addIndex(g.FOCUS)}get imageContainer(){return this.engineMediator.image.container}};a([S],Se.prototype,"state",2),a([d],Se.prototype,"selectFocus",2),a([d],Se.prototype,"changeBlurRadius",2),a([d],Se.prototype,"reset",2),a([d],Se.prototype,"setLinear",2),a([d],Se.prototype,"setLinearStart",2),a([d],Se.prototype,"setLinearEnd",2),a([d],Se.prototype,"setRadialCenter",2),a([d],Se.prototype,"setRadialRadius",2),a([d],Se.prototype,"setMirroredOrigin",2),a([d],Se.prototype,"setMirroredRotation",2),a([d],Se.prototype,"setMirroredSize",2),a([d],Se.prototype,"updateFromEngineState",2);var li=class{constructor(e){this.selectFocus=e=>{if(e!==this.identifier){this.focusStore.removeFocus();let t=this.maxIntensity*.2,{width:r}=this.editor.engine.getOutputContainer().getBounds(),o=this.editor.shortestOutputSide*.2;switch(e){case W.LINEAR:let n=this.editor.outputToWorld({x:-r/2,y:0}),s=this.editor.outputToWorld({x:r/2,y:0});this.setLinearFocus({start:n,end:s,blurRadius:t});break;case W.RADIAL:let l=this.editor.outputToWorld({x:0,y:0});this.setRadialFocus({center:l,radius:o,blurRadius:t});break;case W.MIRRORED:let c=this.editor.outputToWorld({x:0,y:0}),p=o,m=this.editor.outputToWorld(Ii({x:0,y:0},0));this.setMirroredFocus({mirrorAxisOrigin:c,clearAreaWidth:p,blurRadius:t,mirrorAxisDirection:m});break;case W.GAUSSIAN:this.setGaussianFocus({blurRadius:t});break;default:break}this.focusStore.selectFocus(e,t),this.editor.render(),this.addSnapshot(F.ADD,g.FOCUS)}};this.changeIntensity=e=>{let t=this.focusStore.setEffectProperties({blurRadius:e});t&&(this.focusStore.changeBlurRadius(this.identifier,t.blurRadius),this.editor.render())};this.changeRelativeIntensity=e=>{let t=(this.maxIntensity-li.minIntensity)*e/100+li.minIntensity,r=this.focusStore.setEffectProperties({blurRadius:t});r&&(this.focusStore.changeBlurRadius(this.identifier,r.blurRadius),this.editor.render())};this.toolSnapshot=e=>{this.addSnapshot(F.EDIT,e)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.clickableCanvas=e=>{this.editor.clickableCanvas(e)};this.pureReset=()=>{this.focusStore.removeFocus(),this.focusStore.reset()};this.reset=()=>{this.pureReset(),this.editor.render(),this.addSnapshot(F.DELETE,this.locale.controls.buttonReset)};this.setStart=e=>{let t=this.focusStore.setEffectProperties({start:this.editor.previewToWorld(e)});t&&(this.focusStore.setLinearStart(this.editor.worldToPreview(t.start)),this.editor.render())};this.setEnd=e=>{let t=this.focusStore.setEffectProperties({end:this.editor.previewToWorld(e)});t&&(this.focusStore.setLinearEnd(this.editor.worldToPreview(t.end)),this.editor.render())};this.setCenter=e=>{let t=this.focusStore.setEffectProperties({center:this.editor.previewToWorld(e)});t&&(this.focusStore.setRadialCenter(this.editor.worldToPreview(t.center)),this.editor.render())};this.setRadius=e=>{let t=this.focusStore.setEffectProperties({radius:this.editor.previewToWorld(e)});t&&(this.focusStore.setRadialRadius(this.editor.worldToPreview(t.radius)),this.editor.render())};this.setOrigin=e=>{let t=this.focusStore.setEffectProperties({mirrorAxisOrigin:this.editor.previewToWorld(e),mirrorAxisDirection:this.editor.previewToWorld(Ii(e,this.rotation))});t&&(this.focusStore.setMirroredOrigin(this.editor.worldToPreview(t.mirrorAxisOrigin)),this.editor.render())};this.setSize=e=>{let t=this.focusStore.setEffectProperties({clearAreaWidth:this.editor.previewToWorld(e)});t&&(this.focusStore.setMirroredSize(this.editor.worldToPreview(t.clearAreaWidth)),this.editor.render())};this.setRotation=e=>{this.focusStore.setEffectProperties({mirrorAxisDirection:this.editor.previewToWorld(Ii(this.origin,e))}),this.focusStore.setMirroredRotation(e),this.editor.render()};this.updateStateFromHistory=(e,t)=>{this.focusStore.removeFocus();let{magnitude:r}=t;re(()=>{switch(e.identifier){case W.LINEAR:this.focusStore.selectFocus(W.LINEAR),this.setLinearFocus({start:this.editor.previewToWorld(new _(e.linear.start).multiply(t)),end:this.editor.previewToWorld(new _(e.linear.end).multiply(t)),blurRadius:e.linear.blurRadius});break;case W.GAUSSIAN:this.focusStore.selectFocus(W.GAUSSIAN),this.setGaussianFocus({blurRadius:e.gaussian.blurRadius});break;case W.RADIAL:this.focusStore.selectFocus(W.RADIAL),this.setRadialFocus({center:this.editor.previewToWorld(new _(e.radial.center).multiply(t)),radius:this.editor.previewToWorld(e.radial.radius*r),blurRadius:e.radial.blurRadius});break;case W.MIRRORED:this.focusStore.selectFocus(W.MIRRORED),this.setMirroredFocus({mirrorAxisOrigin:this.editor.previewToWorld(new _(e.mirrored.origin).multiply(t)),clearAreaWidth:this.editor.previewToWorld(e.mirrored.size*r),blurRadius:e.mirrored.blurRadius,mirrorAxisDirection:this.editor.previewToWorld(Ii(e.mirrored.origin,e.mirrored.rotation))});break;case"identity":this.pureReset();break;default:break}})};this.updateStateFromSerialization=e=>C(this,null,function*(){if(li.doesFocusIdentifierExist(e.identifier))this.focusStore.removeFocus(),re(()=>{switch(this.focusStore.selectFocus(e.identifier),e.identifier){case W.LINEAR:this.setLinearFocus(e.linear);break;case W.GAUSSIAN:this.setGaussianFocus(e.gaussian);break;case W.RADIAL:this.setRadialFocus(e.radial);break;case W.MIRRORED:this.setMirroredFocus({mirrorAxisOrigin:e.mirrored.origin,clearAreaWidth:e.mirrored.size,blurRadius:e.mirrored.blurRadius,mirrorAxisDirection:Ii(e.mirrored.origin,e.mirrored.rotation)});break;default:break}});else throw new Error(`Focus identifier ${e.identifier} doesn't exist`)});this.updateCanvasControls=()=>{this.focusStore.updateFromEngineState(this.identifier)};this.getFocusStateForHistory=()=>{let e=this.editor.canvasStore.sizeVector,{linear:t}=this.focusStore.state,{radial:r}=this.focusStore.state,{mirrored:o}=this.focusStore.state,n=e,{magnitude:s}=n;return f(f({},this.focusStore.state),{linear:f(f({},t),{start:new _(t.start).divide(n),end:new _(t.end).divide(n)}),radial:f(f({},r),{center:new _(r.center).divide(n),radius:r.radius/s}),mirrored:f(f({},o),{origin:new _(o.origin).divide(n),size:o.size/s}),gaussian:f({},this.focusStore.state.gaussian)})};this.editor=e,this.focusStore=new Se(this.editor);let t=this.editor.assetProvider.getAssets("focus");this.entityManager=new ee(t,f(f({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("focus")}))}static get minIntensity(){return 0}static doesFocusIdentifierExist(e){return Object.keys(W).map(t=>W[t]).findIndex(t=>t===e)!==-1}get state(){return this.focusStore.state}get serializableState(){switch(this.identifier){case W.LINEAR:return{identifier:this.identifier,linear:this.focusStore.getEffectProperties()};case W.RADIAL:return{identifier:this.identifier,radial:this.focusStore.getEffectProperties()};case W.MIRRORED:let e=this.focusStore.getEffectProperties();return{identifier:this.identifier,mirrored:{blurRadius:e.blurRadius,origin:e.mirrorAxisOrigin,rotation:k(this.state.mirrored.rotation),size:e.clearAreaWidth}};case W.GAUSSIAN:return{identifier:this.identifier,gaussian:this.focusStore.getEffectProperties()};default:return ai}}get start(){return this.focusStore.state.linear.start}get startOnPreview(){let e=this.editor.applyFlipToPreview(this.focusStore.state.linear.start);return{x:Math.abs(e.x),y:Math.abs(e.y)}}get end(){return this.focusStore.state.linear.end}get endOnPreview(){let e=this.editor.applyFlipToPreview(this.focusStore.state.linear.end);return{x:Math.abs(e.x),y:Math.abs(e.y)}}get center(){return this.focusStore.state.radial.center}get radius(){return this.focusStore.state.radial.radius}get origin(){return this.focusStore.state.mirrored.origin}get rotation(){return this.focusStore.state.mirrored.rotation}get rotationOnPreview(){let{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();return Qi({rotation:this.focusStore.state.mirrored.rotation,flipHorizontally:e,flipVertically:t})}get size(){return this.focusStore.state.mirrored.size}get mirroredAreaWidth(){let{width:e,height:t}=this.editor.canvasStore.canvasSize;return Math.sqrt(e**2+t**2)*2}get identifier(){return this.state.identifier}get intensity(){return this.identifier==="identity"?ai.gaussian.blurRadius:this.state[this.identifier].blurRadius}get relativeIntensity(){let{blurRadius:e}=this.identifier==="identity"?this.state.gaussian:this.state[this.identifier];return(e-li.minIntensity)*100/(this.maxIntensity-li.minIntensity)}get maxIntensity(){return this.editor.shortestOutputSide/10}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[g.FOCUS]}get locale(){return this.editor.configStore.locale[g.FOCUS]}get items(){return this.entityManager.items}setGaussianFocus({blurRadius:e}){this.focusStore.setGaussianFocus({blurRadius:e})}setLinearFocus({start:e,end:t,blurRadius:r}){this.focusStore.setLinearFocus({start:e,end:t,blurRadius:r})}setRadialFocus({center:e,radius:t,blurRadius:r}){this.focusStore.setRadialFocus({center:e,radius:t,blurRadius:r})}setMirroredFocus({mirrorAxisOrigin:e,clearAreaWidth:t,blurRadius:r,mirrorAxisDirection:o}){this.focusStore.setMirroredFocus({mirrorAxisOrigin:e,clearAreaWidth:t,blurRadius:r,mirrorAxisDirection:o})}},P=li;a([d],P.prototype,"selectFocus",2),a([d],P.prototype,"changeIntensity",2),a([d],P.prototype,"changeRelativeIntensity",2),a([d],P.prototype,"clickableCanvas",2),a([d],P.prototype,"pureReset",2),a([d],P.prototype,"reset",2),a([d],P.prototype,"setStart",2),a([d],P.prototype,"setEnd",2),a([d],P.prototype,"setCenter",2),a([d],P.prototype,"setRadius",2),a([d],P.prototype,"setOrigin",2),a([d],P.prototype,"setSize",2),a([d],P.prototype,"setRotation",2),a([d],P.prototype,"updateStateFromHistory",2),a([d],P.prototype,"updateStateFromSerialization",2),a([d],P.prototype,"updateCanvasControls",2),a([u],P.prototype,"state",1),a([u],P.prototype,"start",1),a([u],P.prototype,"startOnPreview",1),a([u],P.prototype,"end",1),a([u],P.prototype,"endOnPreview",1),a([u],P.prototype,"center",1),a([u],P.prototype,"radius",1),a([u],P.prototype,"origin",1),a([u],P.prototype,"rotation",1),a([u],P.prototype,"rotationOnPreview",1),a([u],P.prototype,"size",1),a([u],P.prototype,"mirroredAreaWidth",1),a([u],P.prototype,"identifier",1),a([u],P.prototype,"intensity",1),a([u],P.prototype,"relativeIntensity",1),a([u],P.prototype,"maxIntensity",1),a([u],P.prototype,"isOptionSelected",1),a([u],P.prototype,"config",1),a([u],P.prototype,"locale",1),a([u],P.prototype,"items",1);import{keyframes as _m}from"styled-components";var Es=_m`
from {
  opacity: 1;
  transform: scale(0);
}
to {
  opacity: 0;
  transform: scale(10);
}
`;import{keyframes as Sm}from"styled-components";var Dm=Sm`
  0% {
    opacity: 0;
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
`;import{keyframes as xm}from"styled-components";var ks=xm`
  0% {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
`;import di from"react";var Ue=[];var ic=function(){return Ue.some(function(i){return i.activeTargets.length>0})};var rc=function(){return Ue.some(function(i){return i.skippedTargets.length>0})};var oc="ResizeObserver loop completed with undelivered notifications.",nc=function(){var i;typeof ErrorEvent=="function"?i=new ErrorEvent("error",{message:oc}):(i=document.createEvent("Event"),i.initEvent("error",!1,!1),i.message=oc),window.dispatchEvent(i)};var ci;(function(i){i.BORDER_BOX="border-box",i.CONTENT_BOX="content-box",i.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(ci||(ci={}));var Is=function(){function i(e,t,r,o){return this.x=e,this.y=t,this.width=r,this.height=o,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return i.prototype.toJSON=function(){var e=this,t=e.x,r=e.y,o=e.top,n=e.right,s=e.bottom,l=e.left,c=e.width,p=e.height;return{x:t,y:r,top:o,right:n,bottom:s,left:l,width:c,height:p}},i.fromRect=function(e){return new i(e.x,e.y,e.width,e.height)},i}();var cr=function(i){return i instanceof SVGElement&&"getBBox"in i},lo=function(i){if(cr(i)){var e=i.getBBox(),t=e.width,r=e.height;return!t&&!r}var o=i,n=o.offsetWidth,s=o.offsetHeight;return!(n||s||i.getClientRects().length)},Fs=function(i){var e,t,r=(t=(e=i)===null||e===void 0?void 0:e.ownerDocument)===null||t===void 0?void 0:t.defaultView;return!!(r&&i instanceof r.Element)},sc=function(i){switch(i.tagName){case"INPUT":if(i.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1};var ui=typeof window!="undefined"?window:{};var co=new WeakMap,ac=/auto|scroll/,Cm=/^tb|vertical/,wm=/msie|trident/i.test(ui.navigator&&ui.navigator.userAgent),ct=function(i){return parseFloat(i||"0")},Fi=function(i,e,t){return i===void 0&&(i=0),e===void 0&&(e=0),t===void 0&&(t=!1),Object.freeze({inlineSize:(t?e:i)||0,blockSize:(t?i:e)||0})},lc=Object.freeze({devicePixelContentBoxSize:Fi(),borderBoxSize:Fi(),contentBoxSize:Fi(),contentRect:new Is(0,0,0,0)}),As=function(i,e){if(e===void 0&&(e=!1),co.has(i)&&!e)return co.get(i);if(lo(i))return co.set(i,lc),lc;var t=getComputedStyle(i),r=cr(i)&&i.ownerSVGElement&&i.getBBox(),o=!wm&&t.boxSizing==="border-box",n=Cm.test(t.writingMode||""),s=!r&&ac.test(t.overflowY||""),l=!r&&ac.test(t.overflowX||""),c=r?0:ct(t.paddingTop),p=r?0:ct(t.paddingRight),m=r?0:ct(t.paddingBottom),h=r?0:ct(t.paddingLeft),b=r?0:ct(t.borderTopWidth),v=r?0:ct(t.borderRightWidth),x=r?0:ct(t.borderBottomWidth),I=r?0:ct(t.borderLeftWidth),R=h+p,M=c+m,Q=I+v,se=b+x,ve=l?i.offsetHeight-se-i.clientHeight:0,_e=s?i.offsetWidth-Q-i.clientWidth:0,T=o?R+Q:0,Z=o?M+se:0,ae=r?r.width:ct(t.width)-T-_e,Qe=r?r.height:ct(t.height)-Z-ve,ed=ae+R+_e+Q,td=Qe+M+ve+se,Aa=Object.freeze({devicePixelContentBoxSize:Fi(Math.round(ae*devicePixelRatio),Math.round(Qe*devicePixelRatio),n),borderBoxSize:Fi(ed,td,n),contentBoxSize:Fi(ae,Qe,n),contentRect:new Is(h,c,ae,Qe)});return co.set(i,Aa),Aa},uo=function(i,e,t){var r=As(i,t),o=r.borderBoxSize,n=r.contentBoxSize,s=r.devicePixelContentBoxSize;switch(e){case ci.DEVICE_PIXEL_CONTENT_BOX:return s;case ci.BORDER_BOX:return o;default:return n}};var Rs=function(){function i(e){var t=As(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=[t.borderBoxSize],this.contentBoxSize=[t.contentBoxSize],this.devicePixelContentBoxSize=[t.devicePixelContentBoxSize]}return i}();var po=function(i){if(lo(i))return Infinity;for(var e=0,t=i.parentNode;t;)e+=1,t=t.parentNode;return e};var cc=function(){var i=Infinity,e=[];Ue.forEach(function(s){if(s.activeTargets.length!==0){var l=[];s.activeTargets.forEach(function(p){var m=new Rs(p.target),h=po(p.target);l.push(m),p.lastReportedSize=uo(p.target,p.observedBox),h<i&&(i=h)}),e.push(function(){s.callback.call(s.observer,l,s.observer)}),s.activeTargets.splice(0,s.activeTargets.length)}});for(var t=0,r=e;t<r.length;t++){var o=r[t];o()}return i};var Os=function(i){Ue.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(o){o.isActive()&&(po(o.target)>i?t.activeTargets.push(o):t.skippedTargets.push(o))})})};var uc=function(){var i=0;for(Os(i);ic();)i=cc(),Os(i);return rc()&&nc(),i>0};var Ts,dc=[],Em=function(){return dc.splice(0).forEach(function(i){return i()})},pc=function(i){if(!Ts){var e=0,t=document.createTextNode(""),r={characterData:!0};new MutationObserver(function(){return Em()}).observe(t,r),Ts=function(){t.textContent=""+(e?e--:e++)}}dc.push(i),Ts()};var mc=function(i){pc(function(){requestAnimationFrame(i)})};var mo=0,km=function(){return!!mo},Im=250,Fm={attributes:!0,characterData:!0,childList:!0,subtree:!0},hc=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],fc=function(i){return i===void 0&&(i=0),Date.now()+i},Ps=!1,Am=function(){function i(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return i.prototype.run=function(e){var t=this;if(e===void 0&&(e=Im),!Ps){Ps=!0;var r=fc(e);mc(function(){var o=!1;try{o=uc()}finally{if(Ps=!1,e=r-fc(),!km())return;o?t.run(1e3):e>0?t.run(e):t.start()}})}},i.prototype.schedule=function(){this.stop(),this.run()},i.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,Fm)};document.body?t():ui.addEventListener("DOMContentLoaded",t)},i.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),hc.forEach(function(t){return ui.addEventListener(t,e.listener,!0)}))},i.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),hc.forEach(function(t){return ui.removeEventListener(t,e.listener,!0)}),this.stopped=!0)},i}(),ho=new Am,Ms=function(i){!mo&&i>0&&ho.start(),mo+=i,!mo&&ho.stop()};var Rm=function(i){return!cr(i)&&!sc(i)&&getComputedStyle(i).display==="inline"},gc=function(){function i(e,t){this.target=e,this.observedBox=t||ci.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return i.prototype.isActive=function(){var e=uo(this.target,this.observedBox,!0);return Rm(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},i}();var bc=function(){function i(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t}return i}();var fo=new WeakMap,yc=function(i,e){for(var t=0;t<i.length;t+=1)if(i[t].target===e)return t;return-1},ur=function(){function i(){}return i.connect=function(e,t){var r=new bc(e,t);fo.set(e,r)},i.observe=function(e,t,r){var o=fo.get(e),n=o.observationTargets.length===0;yc(o.observationTargets,t)<0&&(n&&Ue.push(o),o.observationTargets.push(new gc(t,r&&r.box)),Ms(1),ho.schedule())},i.unobserve=function(e,t){var r=fo.get(e),o=yc(r.observationTargets,t),n=r.observationTargets.length===1;o>=0&&(n&&Ue.splice(Ue.indexOf(r),1),r.observationTargets.splice(o,1),Ms(-1))},i.disconnect=function(e){var t=this,r=fo.get(e);r.observationTargets.slice().forEach(function(o){return t.unobserve(e,o.target)}),r.activeTargets.splice(0,r.activeTargets.length)},i}();var Bs=function(){function i(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");ur.connect(this,e)}return i.prototype.observe=function(e,t){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Fs(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");ur.observe(this,e,t)},i.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Fs(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");ur.unobserve(this,e)},i.prototype.disconnect=function(){ur.disconnect(this)},i.toString=function(){return"function ResizeObserver () { [polyfill code] }"},i}();var xc=Ye(dr());import Jm from"styled-components";import Xm from"react";var Dc=Xm.createContext({});var Zm=Jm.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  background: ${i=>i.theme.background};
  color: ${i=>i.theme.foreground};
  display: flex;
  flex-direction: row;
  overflow: hidden;
  -webkit-touch-callout: none;
  user-select: none;
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;
    /* css reset for a global box-sizing: border-box */
    box-sizing: content-box;
    /* todo: fix the issue with these settings */
    font-size: inherit;
    color: inherit;
    line-height: normal;

    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.2) transparent;

    &::-webkit-scrollbar-track {
      border-radius: 10px;
      background-color: transparent;
      margin: 1px;
    }

    &::-webkit-scrollbar {
      width: 6px;
      height: 6px;
      background-color: transparent;
    }

    &::-webkit-scrollbar-thumb {
      border-radius: 10px;
      box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.4);
      background-color: rgba(255, 255, 255, 0.2);
    }

    &::-webkit-scrollbar-thumb:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }
  }
`,Us=class extends di.Component{constructor(e){super(e);this.node=di.createRef();this.saveEditorDimensions=e=>{this.setState({contextValue:{element:e,rect:e.getBoundingClientRect()}})};var t;if((t=di)==null?void 0:t.version){let r=Number.parseInt(di.version.split(".")[0],10),o=Number.parseInt(di.version.split(".")[1],10);(r<16||r===16&&o<8)&&console.error("Please be aware that the PhotoEditorSDK will require React 16.8.6 or above.")}this.saveEditorDimensions=xc.default(this.saveEditorDimensions,100),this.resizeObserver=new Bs(([r])=>{this.saveEditorDimensions(r.target)}),this.state={contextValue:{element:null,rect:null}}}componentDidMount(){var e;((e=this.node)==null?void 0:e.current)&&this.resizeObserver.observe(this.node.current)}componentWillUnmount(){var e;((e=this.node)==null?void 0:e.current)&&this.resizeObserver.unobserve(this.node.current)}render(){let{children:e}=this.props,{contextValue:t}=this.state;return di.createElement(Zm,{ref:this.node},di.createElement(Dc.Provider,{value:t},e))}};import Eo from"react";import pi,{PureComponent as yh,Component as Ks,forwardRef as qs,memo as Mc,createElement as vh}from"react";import{useState as Qm}from"react";if(!Qm)throw new Error("mobx-react-lite requires React with Hooks support");if(!mn)throw new Error("mobx-react-lite requires mobx at least version 4 to be available");import{unstable_batchedUpdates as Cc}from"react-dom";import{useCallback as eh,useEffect as C0,useState as th}from"react";var ih=function(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var r=t.call(i),o,n=[],s;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)n.push(o.value)}catch(l){s={error:l}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return n};function Ns(){var i=ih(th(0),2),e=i[1],t=eh(function(){e(function(r){return r+1})},[]);return t}function wc(i){return typeof Symbol=="function"?Symbol.for(i):"__$mobx-react "+i+"__"}var rh={};function Ec(){return typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:rh}var oh=wc("observerBatching");function nh(i){i()}function go(i){i||(i=nh),al({reactionScheduler:i}),Ec()[oh]=!0}var sh=!1;function ut(){return sh}import{forwardRef as ph,memo as Tc}from"react";import Gs from"react";function kc(i){return dn(i)}function Ic(i){var e={cleanAt:Date.now()+ah,reaction:i};return e}var ah=1e4,lh=1e4,pr=new Set,Hs;function Fc(){Hs===void 0&&(Hs=setTimeout(ch,lh))}function Ac(i){pr.add(i),Fc()}function Rc(i){pr.delete(i)}function ch(){Hs=void 0;var i=Date.now();pr.forEach(function(e){var t=e.current;t&&i>=t.cleanAt&&(t.reaction.dispose(),e.current=null,pr.delete(e))}),pr.size>0&&Fc()}import uh from"react";var bo=!1,yo=[];function Ws(i){return function(){bo?yo.push(i):i()}}function js(i){bo=!0,yo=[];try{var e=i();bo=!1;var t=yo.length>0?yo:void 0;return uh.useLayoutEffect(function(){t&&t.forEach(function(r){return r()})},[t]),e}finally{bo=!1}}var dh={};function Oc(i){return"observer"+i}function Ai(i,e,t){if(e===void 0&&(e="observed"),t===void 0&&(t=dh),ut())return i();var r=t.useForceUpdate||Ns,o=r(),n=Ws(o),s=Gs.useRef(null);if(!s.current){var l=new zt(Oc(e),function(){c.mounted?n():(l.dispose(),s.current=null)}),c=Ic(l);s.current=c,Ac(s)}var p=s.current.reaction;return Gs.useDebugValue(p,kc),Gs.useEffect(function(){return Rc(s),s.current?s.current.mounted=!0:(s.current={reaction:new zt(Oc(e),function(){n()}),cleanAt:Infinity},n()),function(){s.current.reaction.dispose(),s.current=null}},[]),js(function(){var m,h;if(p.track(function(){try{m=i()}catch(b){h=b}}),h)throw h;return m})}var Vs=function(){return Vs=Object.assign||function(i){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(i[o]=e[o])}return i},Vs.apply(this,arguments)};function $s(i,e){if(ut())return i;var t=Vs({forwardRef:!1},e),r=i.displayName||i.name,o=function(s,l){return Ai(function(){return i(s,l)},r)};o.displayName=r;var n;return t.forwardRef?n=Tc(ph(o)):n=Tc(o),mh(i,n),n.displayName=r,n}var hh={$$typeof:!0,render:!0,compare:!0,type:!0};function mh(i,e){Object.keys(i).forEach(function(t){hh[t]||Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}function Ri(i){var e=i.children,t=i.render,r=e||t;return typeof r!="function"?null:Ai(r)}Ri.propTypes={children:Pc,render:Pc};Ri.displayName="Observer";function Pc(i,e,t,r,o){var n=e==="children"?"render":"children",s=typeof i[e]=="function",l=typeof i[n]=="function";return s&&l?new Error("MobX Observer: Do not use children and render in the same time in`"+t):s||l?null:new Error("Invalid prop `"+o+"` of type `"+typeof i[e]+"` supplied to `"+t+"`, expected `function`.")}import J0 from"react";import rF from"react";go(Cc);var Bc=0;function _h(i){if(typeof Symbol=="function")return Symbol(i);var e="__$mobx-react "+i+" ("+Bc+")";return Bc++,e}var Ys={};function $t(i){return Ys[i]||(Ys[i]=_h(i)),Ys[i]}function Lc(i,e){if(zc(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(var o=0;o<t.length;o++)if(!Object.hasOwnProperty.call(e,t[o])||!zc(i[t[o]],e[t[o]]))return!1;return!0}function zc(i,e){return i===e?i!==0||1/i==1/e:i!==i&&e!==e}var Sh={$$typeof:1,render:1,compare:1,type:1,childContextTypes:1,contextType:1,contextTypes:1,defaultProps:1,getDefaultProps:1,getDerivedStateFromError:1,getDerivedStateFromProps:1,mixins:1,propTypes:1};function Dh(i,e){var t=Object.getOwnPropertyNames(Object.getPrototypeOf(i));Object.getOwnPropertyNames(i).forEach(function(r){!Sh[r]&&t.indexOf(r)===-1&&Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}function Et(i,e,t){Object.hasOwnProperty.call(i,e)?i[e]=t:Object.defineProperty(i,e,{enumerable:!1,configurable:!0,writable:!0,value:t})}var Uc=$t("patchMixins"),Nc=$t("patchedDefinition");function xh(i,e){var t=i[Uc]=i[Uc]||{},r=t[e]=t[e]||{};return r.locks=r.locks||0,r.methods=r.methods||[],r}function Hc(i,e){for(var t=this,r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];e.locks++;try{var s;return i!=null&&(s=i.apply(this,o)),s}finally{e.locks--,e.locks===0&&e.methods.forEach(function(l){l.apply(t,o)})}}function Wc(i,e){var t=function(){for(var o=arguments.length,n=new Array(o),s=0;s<o;s++)n[s]=arguments[s];Hc.call.apply(Hc,[this,i,e].concat(n))};return t}function Ch(i,e,t){var r=xh(i,e);r.methods.indexOf(t)<0&&r.methods.push(t);var o=Object.getOwnPropertyDescriptor(i,e);if(!(o&&o[Nc])){var n=i[e],s=jc(i,e,o?o.enumerable:void 0,r,n);Object.defineProperty(i,e,s)}}function jc(i,e,t,r,o){var n,s=Wc(o,r);return n={},n[Nc]=!0,n.get=function(){return s},n.set=function(c){if(this===i)s=Wc(c,r);else{var p=jc(this,e,t,r,c);Object.defineProperty(this,e,p)}},n.configurable=!0,n.enumerable=t,n}var Xs=Sn||"$mobx",Gc=$t("isMobXReactObserver"),Vc=$t("isUnmounted"),vo=$t("skipRender"),_o=$t("isForcingUpdate");function Eh(i){var e=i.prototype;if(i[Gc]){var t=Js(e);console.warn("The provided component class ("+t+`) 
                has already been declared as an observer component.`)}else i[Gc]=!0;if(e.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if(i.__proto__!==yh){if(!e.shouldComponentUpdate)e.shouldComponentUpdate=$c;else if(e.shouldComponentUpdate!==$c)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}Kc(e,"props"),Kc(e,"state");var r=e.render;return e.render=function(){return wh.call(this,r)},Ch(e,"componentWillUnmount",function(){var o;if(ut()!==!0&&((o=this.render[Xs])===null||o===void 0||o.dispose(),this[Vc]=!0,!this.render[Xs])){var n=Js(this);console.warn("The reactive render of an observer class component ("+n+`) 
                was overriden after MobX attached. This may result in a memory leak if the 
                overriden reactive render was not properly disposed.`)}}),i}function Js(i){return i.displayName||i.name||i.constructor&&(i.constructor.displayName||i.constructor.name)||"<component>"}function wh(i){var e=this;if(ut()===!0)return i.call(this);Et(this,vo,!1),Et(this,_o,!1);var t=Js(this),r=i.bind(this),o=!1,n=new zt(t+".render()",function(){if(!o&&(o=!0,e[Vc]!==!0)){var l=!0;try{Et(e,_o,!0),e[vo]||Ks.prototype.forceUpdate.call(e),l=!1}finally{Et(e,_o,!1),l&&n.dispose()}}});n.reactComponent=this,s[Xs]=n,this.render=s;function s(){o=!1;var l=void 0,c=void 0;if(n.track(function(){try{c=Za(!1,r)}catch(p){l=p}}),l)throw l;return c}return s.call(this)}function $c(i,e){return ut()&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==e?!0:!Lc(this.props,i)}function Kc(i,e){var t=$t("reactProp_"+e+"_valueHolder"),r=$t("reactProp_"+e+"_atomHolder");function o(){return this[r]||Et(this,r,Ar("reactive "+e)),this[r]}Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){var s=!1;return Zt&&vt&&(s=Zt(!0)),o.call(this).reportObserved(),Zt&&vt&&vt(s),this[t]},set:function(s){!this[_o]&&!Lc(this[t],s)?(Et(this,t,s),Et(this,vo,!0),o.call(this).reportChanged(),Et(this,vo,!1)):Et(this,t,s)}})}var qc=typeof Symbol=="function"&&Symbol.for,Yc=qc?Symbol.for("react.forward_ref"):typeof qs=="function"&&qs(function(i){return null}).$$typeof,Xc=qc?Symbol.for("react.memo"):typeof Mc=="function"&&Mc(function(i){return null}).$$typeof;function Zs(i){if(i.isMobxInjector===!0&&console.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),Xc&&i.$$typeof===Xc)throw new Error("Mobx observer: You are trying to use 'observer' on a function component wrapped in either another observer or 'React.memo'. The observer already applies 'React.memo' for you.");if(Yc&&i.$$typeof===Yc){var e=i.render;if(typeof e!="function")throw new Error("render property of ForwardRef was not a function");return qs(function(){var r=arguments;return vh(Ri,null,function(){return e.apply(void 0,r)})})}return typeof i=="function"&&(!i.prototype||!i.prototype.render)&&!i.isReactClass&&!Object.prototype.isPrototypeOf.call(Ks,i)?$s(i):Eh(i)}function So(){return So=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},So.apply(this,arguments)}function kh(i,e){if(i==null)return{};var t={},r=Object.keys(i),o,n;for(n=0;n<r.length;n++)o=r[n],!(e.indexOf(o)>=0)&&(t[o]=i[o]);return t}var Qs=pi.createContext({});function Ih(i){var e=i.children,t=kh(i,["children"]),r=pi.useContext(Qs),o=pi.useRef(So({},r,t)),n=o.current;if(!1)var s;return pi.createElement(Qs.Provider,{value:n},e)}Ih.displayName="MobXProvider";function Jc(i,e,t,r){var o=pi.forwardRef(function(n,s){var l=So({},n),c=pi.useContext(Qs);return Object.assign(l,i(c||{},l)||{}),s&&(l.ref=s),pi.createElement(e,l)});return r&&(o=Zs(o)),o.isMobxInjector=!0,Dh(e,o),o.wrappedComponent=e,o.displayName=Fh(e,t),o}function Fh(i,e){var t,r=i.displayName||i.name||i.constructor&&i.constructor.name||"Component";return e?t="inject-with-"+e+"("+r+")":t="inject("+r+")",t}function Ah(i){return function(e,t){return i.forEach(function(r){if(!(r in t)){if(!(r in e))throw new Error("MobX injector: Store '"+r+"' is not available! Make sure it is provided by some Provider");t[r]=e[r]}}),t}}function Zc(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];if(typeof arguments[0]=="function"){var r=arguments[0];return function(o){return Jc(r,o,r.name,!0)}}else return function(o){return Jc(Ah(e),o,e.join("-"),!1)}}if(!Ks)throw new Error("mobx-react requires React to be available");if(!S)throw new Error("mobx-react requires mobx to be available");import Oi from"react";import Qc,{css as Ph}from"styled-components";import Rh,{css as Oh}from"styled-components";var mr=Oh`
  position: absolute;
  top: 0;
  left: 0;
  height: ${i=>i.theme.measurements.colorItem.size}px;
  width: ${i=>i.theme.measurements.colorItem.size}px;
  border-radius: ${i=>i.theme.colorItem.borderRadius||`${i.theme.shape.radiusSmall}px`};
  pointer-events: none;
`,Th=Rh.div.attrs(i=>({style:{background:i.color}}))`
  ${mr}
  z-index: ${i=>i.theme.measurements.zIndex.colorItem.background};
`,Do=Th;var Mh=Qc.div`
  ${mr}
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: ${i=>i.theme.measurements.zIndex.colorItem.overlay};

  box-sizing: border-box;
  border: 2px solid transparent;
  border-radius: ${i=>i.theme.colorItem.borderRadius||`${i.theme.shape.radiusSmall}px`};
  transition: border-color 300ms ease-in-out;
  ${i=>i.isActive&&Ph`
      border-color: ${i.theme.selectColor.activeBorderColor};
    `}
`,ea=Qc.span`
  display: inline-block;
  height: 2px;
  width: 2px;
  border-radius: 50%;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.6);
  background: rgba(255, 255, 255, 0.87);
  margin: 1px;
  pointer-events: none;
`,Bh=({isActive:i,className:e,style:t})=>Oi.createElement(Mh,{isActive:i,className:e,style:t},i&&Oi.createElement(Oi.Fragment,null,Oi.createElement(ea,null),Oi.createElement(ea,null),Oi.createElement(ea,null))),xo=Bh;import Uh from"styled-components";import{css as zh}from"styled-components";var be=zh`
  &:focus {
    outline: none;
    box-shadow: 0 0 2px ${i=>i.theme.focusOutlineColor};
  }
  &:-moz-focusring {
    outline: none;
    box-shadow: 0 0 2px ${i=>i.theme.focusOutlineColor};
  }
`;import{css as Lh}from"styled-components";var hr=Lh`
  position: absolute !important;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
  clip: rect(1px, 1px, 1px, 1px);
`;var Nh=Uh.button.attrs({type:"button"})`
  &&& {
    box-sizing: border-box;
  }
  position: relative;
  background: transparent;
  border: none;
  height: ${i=>i.theme.measurements.colorItem.size}px;
  width: ${i=>i.theme.measurements.colorItem.size}px;
  margin: ${i=>i.theme.colorItem.margin};
  padding: 0;
  cursor: pointer;
  border-radius: ${i=>i.theme.colorItem.borderRadius||`${i.theme.shape.radiusSmall}px`};

  &:hover {
    opacity: 0.7;
  }

  ${be}

  &:disabled {
    opacity: ${i=>i.theme.selectColor.inactiveOpacity};
    cursor: default;
  }
`,Co=Nh;import Hh from"styled-components";var Wh=Hh.div.attrs(i=>({style:i.url?{backgroundImage:`url(${i.url})`}:{}}))`
  ${mr}
  z-index: ${i=>i.theme.measurements.zIndex.colorItem.tiledBackground};
`,wo=Wh;var jh=({isActive:i,onClick:e,color:t,label:r,isDisabled:o,tiledBackgroundUrl:n,className:s,style:l,children:c})=>Eo.createElement(Co,{disabled:o,onClick:e,"aria-label":r,className:s,style:l},Eo.createElement(wo,{url:n}),Eo.createElement(Do,{color:t}),Eo.createElement(xo,{isActive:i}),c),eu=Zc("config")(Zs(jh));import ta from"react";import Gh from"styled-components";var Vh=Gh.div`
  display: block;
  opacity: 1;
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: ${i=>i.theme.measurements.zIndex.dialog.backdrop};
  text-align: left;
  background: ${i=>i.theme.modal.backdrop};
  height: 100%;
  width: 100%;
`,ko=Vh;import $h from"react";import Kh,{css as qh}from"styled-components";var Yh=Kh.div`
  display: none;
  visibility: hidden;
  opacity: 0;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${i=>i.theme.measurements.zIndex.dialog.base};
  transition: opacity 100s ease-in-out;

  ${i=>i.isVisible&&qh`
      opacity: 1;
      display: block;
      visibility: visible;
    `};
`,Io=({isVisible:i,className:e,children:t})=>$h.createElement(Yh,{isVisible:i,className:e},t);import Xh from"styled-components";var Jh=Xh.div.attrs(({style:i})=>({role:"dialog","aria-hidden":!1,style:i}))`
  display: flex;
  flex: 0 0 auto;
  flex-direction: column;
  transition: top 0.25s ease;
  position: absolute;
  top: calc(50% + ${i=>i.top}px);
  left: calc(50% + ${i=>i.left}px);
  width: ${i=>i.width};
  height: ${i=>i.height};
  transform: translate(-50%, -50%);
  border-radius: ${i=>i.theme.shape.radiusLarge}px;
  background: ${i=>i.theme.modal.background};
  color: ${i=>i.theme.modal.bodyForeground};
  z-index: ${i=>i.theme.measurements.zIndex.dialog.container};

  @media all and (min-width: 0) and (max-width: 640px) {
    text-align: center;
    width: auto;
    min-width: 200px;
    height: auto;
    top: 50%;
    left: 50%;
  }
`,Fo=Jh;var Zh=({isVisible:i=!1,width:e="350px",height:t="fit-content",position:r,header:o,body:n,footer:s,className:l,style:c,children:p})=>ta.createElement(Io,{isVisible:i},ta.createElement(ko,null),ta.createElement(Fo,{height:t,width:e,left:r.x,top:r.y,className:l,style:c,"data-test":me.Dialog},o,n,p,s)),tu=Zh;import Qh from"styled-components";var ef=Qh.div`
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-sizing: border-box;
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  color: ${i=>i.theme.modal.bodyForeground};

  padding: 0px 20px 11px;
  &:first-child {
    padding-top: 11px;
  }

  @media all and (min-width: 0) and (max-width: 640px) {
    align-items: center;
  }
`,kt=ef;import tf from"styled-components";var rf=tf.div`
  display: flex;
  border-top: 2px solid
    ${i=>i.type==="error"?i.theme.error:i.theme.warning};

  min-height: 40px;
  justify-content: flex-end;
  @media all and (min-width: 0) and (max-width: 640px) {
    height: auto;
    flex-direction: column;
    justify-content: space-around;
  }
`,Ti=rf;import of from"styled-components";var nf=of.h3`
  font-size: ${i=>i.theme.measurements.fontSystem.headline2.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.headline2.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.headline2.case};
  color: ${i=>i.theme.modal.headerForeground};

  padding: 11px 20px 0px;
`,Pi=nf;import sf,{css as iu,keyframes as af}from"styled-components";var ru=af`
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
`,lf=iu`
  animation: ${ru} 2s infinite ease 1.5s;
`,cf=iu`
  animation: ${ru} 2s infinite ease;
`,uf=sf.div`
  color: ${i=>i.theme.primary};
  margin: 12px 0;
  position: relative;
  width: 40px;
  height: 40px;
  box-shadow: inset 0 0 0 2px;
  transform: translateZ(0);
  border-radius: 50%;
  &:before,
  &:after {
    border-radius: 50%;
    position: absolute;
    content: '';
  }
  &:before {
    width: 25px;
    height: 45px;
    background: ${i=>i.theme.modal.background};
    border-radius: 45px 0 0 45px;
    top: -2.5px;
    left: -2.5px;
    transform-origin: 25px 25px;
    ${lf};
  }
  &:after {
    width: 25px;
    height: 45px;
    background: ${i=>i.theme.modal.background};
    border-radius: 0 45px 45px 0;
    top: -2.5px;
    left: 25px;
    transform-origin: 0px 25px;
    ${cf};
  }
`,Ao=uf;import zo from"react";import aa from"react";import la from"react-dom";var ia=["Moz","Webkit","O","ms"];function df(i){let e="",t=!0,r;for(r=0;r<i.length;r+=1)t?(e+=i[r].toUpperCase(),t=!1):i[r]==="-"?t=!0:e+=i[r];return e}function ra(i,e){return e?`${e}${df(i)}`:i}function pf(i="transform"){if(typeof window=="undefined"||typeof window.document=="undefined")return"";let{style:e}=window.document.documentElement;if(i in e)return"";let t;for(t=0;t<ia.length;t+=1)if(ra(i,ia[t])in e)return ia[t];return""}var ou=pf();function Ro(i,e){for(let t=0,{length:r}=i;t<r;t+=1)if(e.apply(e,[i[t],t,i]))return i[t];return null}function oa(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Function]"}function Mi(i){return typeof i=="number"&&!Number.isNaN(i)}function fe(i){return parseInt(i,10)}var Oo="";function mf(i,e){return Oo||(Oo=Ro(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],t=>oa(i[t]))),oa(i[Oo])?i[Oo](e):!1}function na(i,e,t){let r=i;do{if(mf(r,e))return!0;if(r===t)return!1;r=r.parentNode}while(r);return!1}function To(i,e,t){!i||(i.attachEvent?i.attachEvent(`on${e}`,t):i.addEventListener?i.addEventListener(e,t,!0):i[`on${e}`]=t)}function Kt(i,e,t){!i||(i.detachEvent?i.detachEvent(`on${e}`,t):i.removeEventListener?i.removeEventListener(e,t,!0):i[`on${e}`]=null)}function nu(i){let e=i.clientHeight,t=i.ownerDocument.defaultView.getComputedStyle(i);return e+=fe(t.borderTopWidth),e+=fe(t.borderBottomWidth),e}function su(i){let e=i.clientWidth,t=i.ownerDocument.defaultView.getComputedStyle(i);return e+=fe(t.borderLeftWidth),e+=fe(t.borderRightWidth),e}function au(i){let e=i.clientHeight,t=i.ownerDocument.defaultView.getComputedStyle(i);return e-=fe(t.paddingTop),e-=fe(t.paddingBottom),e}function lu(i){let e=i.clientWidth,t=i.ownerDocument.defaultView.getComputedStyle(i);return e-=fe(t.paddingLeft),e-=fe(t.paddingRight),e}function cu(i,e){let r=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),o=i.clientX+e.scrollLeft-r.left,n=i.clientY+e.scrollTop-r.top;return{x:o,y:n}}function uu({x:i,y:e,rotation:t}){let r=`translate(${i}px,${e}px) rotate(${t}rad)`;return{[ra("transform",ou)]:r}}function du(i,e){let t=null;return i.targetTouches&&(t=Ro(i.targetTouches,r=>e===r.identifier)),i.changedTouches&&!t&&(t=Ro(i.changedTouches,r=>e===r.identifier)),t}function pu(i){return i.targetTouches&&i.targetTouches[0]?i.targetTouches[0].identifier:i.changedTouches&&i.changedTouches[0]?i.changedTouches[0].identifier:null}import hf from"react-dom";function sa(i){let e=hf.findDOMNode(i);if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}function mu(i,e,t){if(!i.props.bounds)return[e,t];let{bounds:r}=i.props;r=typeof r=="string"?r:f({},r);let o=sa(i);if(typeof r=="string"){let{ownerDocument:n}=o,s=n.defaultView,l=r==="parent"?o.parentNode:n.querySelector(r);if(!(l instanceof HTMLElement))throw new Error(`Bounds selector "${r}" could not find an element.`);if(o instanceof HTMLElement){let c=s.getComputedStyle(o),p=s.getComputedStyle(l);r={left:-o.offsetLeft+fe(p.paddingLeft)+fe(c.marginLeft),top:-o.offsetTop+fe(p.paddingTop)+fe(c.marginTop),right:lu(l)-su(o)-o.offsetLeft+fe(p.paddingRight)-fe(c.marginRight),bottom:au(l)-nu(o)-o.offsetTop+fe(p.paddingBottom)-fe(c.marginBottom)}}}return r=r,Mi(r.right)&&(e=Math.min(e,r.right)),Mi(r.bottom)&&(t=Math.min(t,r.bottom)),Mi(r.left)&&(e=Math.max(e,r.left)),Mi(r.top)&&(t=Math.max(t,r.top)),[e,t]}function Po(i,e,t){let{state:r}=i,o=!Mi(r.lastX),n=sa(i);return o?{node:n,deltaX:0,deltaY:0,lastX:e,lastY:t,x:e,y:t}:{node:n,deltaX:e-r.lastX,deltaY:t-r.lastY,lastX:r.lastX,lastY:r.lastY,x:e,y:t}}function Mo(i,e){return{node:e.node,x:i.state.x+e.deltaX,y:i.state.y+e.deltaY,deltaX:e.deltaX,deltaY:e.deltaY,lastX:i.state.x,lastY:i.state.y}}function hu(i){return i.props.axis==="both"||i.props.axis==="x"}function fu(i){return i.props.axis==="both"||i.props.axis==="y"}function Bo(i,e){let t=sa(e),{offsetParent:r}=e.props;return!r&&t instanceof HTMLElement&&(r=t.offsetParent||t.ownerDocument.body),cu(i,r)}var dt={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},Re=dt.mouse,ca={cancel:null,disabled:!1,offsetParent:null,handle:null,transform:null,onStart:()=>{},onDrag:()=>{},onStop:()=>{},onMouseDown:()=>{}},mi=class extends aa.Component{constructor(){super(...arguments);this.state={dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:void 0};this.getTouchFromEvent=e=>{let t=pu(e);return this.setState({touchIdentifier:t}),du(e,t)};this.preventDefault=e=>{e.stopPropagation&&e.stopPropagation()};this.handleDragStart=e=>{let t=la.findDOMNode(this);if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");let{ownerDocument:r}=t;if(this.props.disabled||!(e.target instanceof Node)||this.props.handle&&!na(e.target,this.props.handle,t)||this.props.cancel&&na(e.target,this.props.cancel,t))return!1;let o=Bo(e,this);if(o==null)return!1;let{x:n,y:s}=o,l=Po(this,n,s);if(this.props.onStart(e,l)===!1)return!1;this.setState({dragging:!0,lastX:n,lastY:s}),Re.move==="touchmove"?To(r,Re.move,this.onTouchDrag):To(r,Re.move,this.onMouseDrag),To(r,Re.stop,this.handleDragStop)};this.handleDrag=e=>{let t=Bo(e,this);if(t==null)return;let{x:r,y:o}=t,n=Po(this,r,o);if(this.props.onDrag(e,n)===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(l){let c=document.createEvent("MouseEvents");c.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(c)}return}this.setState({lastX:r,lastY:o})};this.handleDragStop=e=>{if(!this.state.dragging)return;let t=Bo(e,this);if(t==null)return;let{x:r,y:o}=t,n=Po(this,r,o),s=la.findDOMNode(this);this.setState({dragging:!1,lastX:NaN,lastY:NaN}),this.props.onStop(e,n),s&&(Re.move==="touchmove"?Kt(s.ownerDocument,Re.move,this.onTouchDrag):Kt(s.ownerDocument,Re.move,this.onMouseDrag),Kt(s.ownerDocument,Re.stop,this.handleDragStop))};this.onMouseDown=e=>(this.preventDefault(e),Re=dt.mouse,this.props.onMouseDown(e),e.button&&typeof e.button=="number"&&e.button!==0?!1:this.handleDragStart(e));this.onMouseDrag=e=>(this.preventDefault(e),this.handleDrag(e));this.onMouseUp=e=>(this.preventDefault(e),Re=dt.mouse,this.handleDragStop(e));this.onTouchStart=e=>{this.preventDefault(e),Re=dt.touch;let t=this.getTouchFromEvent(e);return this.handleDragStart(t)};this.onTouchDrag=e=>{this.preventDefault(e),Re=dt.touch;let t=this.getTouchFromEvent(e);return this.handleDrag(t)};this.onTouchEnd=e=>{this.preventDefault(e),Re=dt.touch;let t=this.getTouchFromEvent(e);return this.handleDragStop(t)}}componentWillUnmount(){let e=la.findDOMNode(this);if(e){let{ownerDocument:t}=e;Kt(t,dt.mouse.move,this.onMouseDrag),Kt(t,dt.touch.move,this.onTouchDrag),Kt(t,dt.mouse.stop,this.handleDragStop),Kt(t,dt.touch.stop,this.handleDragStop)}}render(){return aa.cloneElement(aa.Children.only(this.props.children),{style:f({touchAction:"none"},this.props.children.props.style),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};mi.defaultProps=ca,mi.displayName="DraggableCore";var ff=f(f({},ca),{axis:"both",bounds:!1,defaultClassName:"draggable",defaultClassNameDragging:"draggable-dragging",defaultClassNameDragged:"draggable-dragged",defaultPosition:{x:0,y:0},position:null,rotation:0,updateOnPosition:!1}),Lo=class extends zo.Component{constructor(e){super(e);this.onDragStart=(e,t)=>{if(this.props.onStart(e,Mo(this,t))===!1)return!1;this.setState({dragging:!0,dragged:!0})};this.onDrag=(e,t)=>{let{position:r,defaultPosition:o,onDrag:n,bounds:s}=this.props;if(!this.state.dragging)return!1;let l=Mo(this,t),c=Boolean(r),p={x:c?l.x:o.x,y:c?l.y:o.y,slackX:0,slackY:0};if(s){let{x:h,y:b}=p;p.x+=this.state.slackX,p.y+=this.state.slackY;let[v,x]=mu(this,p.x,p.y);p.x=v,p.y=x,p.slackX=this.state.slackX+(h-p.x),p.slackY=this.state.slackY+(b-p.y),l.x=p.x,l.y=p.y,l.deltaX=p.x-this.state.x,l.deltaY=p.y-this.state.y}if(n(e,l)===!1)return!1;this.setState(p)};this.onDragStop=(e,t)=>{if(!this.state.dragging||this.props.onStop(e,Mo(this,t))===!1)return!1;let o={dragging:!1,slackX:0,slackY:0,x:0,y:0};if(Boolean(this.props.position)){let{x:s,y:l}=this.props.position;o.x=s,o.y=l}this.setState(o)};this.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,slackX:0,slackY:0}}componentDidUpdate(e){Boolean(this.props.position)&&(this.props.updateOnPosition?(e.position&&e.position.x!==this.props.position.x||e.position.y!==this.props.position.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}):(e.position&&this.props.position.x!==this.state.x||this.props.position.y!==this.state.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}))}componentWillUnmount(){this.setState({dragging:!1})}render(){let ve=this.props,{position:e,defaultPosition:t,rotation:r,defaultClassName:o,defaultClassNameDragging:n,defaultClassNameDragged:s}=ve,l=Pe(ve,["position","defaultPosition","rotation","defaultClassName","defaultClassNameDragging","defaultClassNameDragged"]),{x:c,y:p,dragging:m,dragged:h}=this.state,b={},x=!Boolean(e)||m,I=e||t,R={x:hu(this)&&x?c:I.x,y:fu(this)&&x?p:I.y,rotation:r};b=uu(R);let M=zo.Children.only(this.props.children),Q=[M.props.className||"",o,m?n:"",h?s:""].join(" ").trim(),se=zo.cloneElement(M,{className:Q,style:f(f({},M.props.style),b)});return zo.createElement(mi,f(f({},l),{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),se)}};Lo.defaultProps=ff,Lo.displayName="Draggable";var gu=Lo;var Du=Ye(fr());import Ze from"react";import qt,{css as xu}from"styled-components";import br from"react";import Tf,{css as Pf}from"styled-components";import gr from"styled-components";var No=gr.span`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
`,da=gr(No)``,Oe=gr(No)``,Bi=gr(No)``,Ho={display:"none",left:0,top:0},Wo=gr(No)`
  display: ${({display:i})=>i};
  left: ${({left:i})=>i}px;
  top: ${({top:i})=>i}px;
  pointer-events: none;
  border-radius: 50%;
  background-color: rgba(255, 255, 255, 0.12);
  animation: ${Es} 1.2s;
  width: 100px;
  height: 100px;
  margin-top: -50px;
  margin-left: -50px;
  opacity: 0;
`;var It=Pf`
  color: ${i=>i.theme.button.activeForeground};
`,Mf=Tf.button`
  &&& {
    box-sizing: border-box;
  }
  text-align: center;
  position: relative;
  padding: 4px 8px;
  min-height: 32px;
  border-radius: ${i=>i.theme.shape.radiusMedium}px;
  font-size: ${i=>i.theme.measurements.fontSystem.button1.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.button1.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.button1.case};
  font-family: ${i=>i.theme.typography.fontFamily}, sans-serif;
  cursor: pointer;
  border: none;
  background-color: transparent;
  overflow: hidden;
  ${be}

  /* Active */

  &:active {
    ${It}
  }

  ${({isActive:i})=>i&&It}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${Oe} {
      background-color: ${i=>i.theme.button.outlinedInactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${Bi} {
      background-color: ${i=>i.theme.button.hoverOverlayColor};
    }
  }
`,Te=class extends br.Component{constructor(){super(...arguments);this.state=Ho;this.timeout=null;this.onClick=e=>{let t=e.currentTarget.getBoundingClientRect(),r=e.pageX-t.left,o=e.pageY-t.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(r,o)}):this.setRippleState(r,o),this.props.onClick(e)};this.setRippleState=(e,t)=>{this.setState({left:e,top:t,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){let h=this.props,{isActive:e,isDisabled:t,label:r,ariaLabel:o,children:n,className:s}=h,l=Pe(h,["isActive","isDisabled","label","ariaLabel","children","className"]),{left:c,top:p,display:m}=this.state;return br.createElement(Mf,f(f({"data-test":o,className:s,isActive:e,disabled:t,"aria-label":o},l),{onClick:this.onClick}),r,n,br.createElement(Wo,{display:m,left:c,top:p}),br.createElement(Oe,null),br.createElement(Bi,null))}};Te.defaultProps={type:"button",isDisabled:!1,isActive:!1};import Bf from"react";import Su,{css as zf}from"styled-components";var Lf=Su.label`
  ${hr}
`,Uf=Su.label`
  display: block;
  font-size: ${i=>i.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.label.case};
  color: ${i=>i.theme.toolControlBar.inputLabelForeground};
  margin: 0;
  padding-bottom: 8px;

  ${({isDisabled:i})=>i&&zf`
      opacity: ${e=>e.theme.toolControlBar.inputLabelInactiveOpacity};
      cursor: default;
      pointer-events: none;
    `}
`,ye=({label:i,htmlFor:e,show:t,style:r,isDisabled:o,className:n})=>{let s=t?Uf:Lf,l=e||(i?i.replace(" ","-"):void 0);return Bf.createElement(s,{style:r,isDisabled:o,htmlFor:l,className:n},i)};ye.defaultProps={show:!0};var Nf=qt.div`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
`,Hf=qt(ye)`
  align-self: flex-start;
`,Cu=qt(Te)`
  color: ${i=>i.theme.button.textSecondaryForeground};
  padding: 1px 7px 2px;
`,Wf=qt.div`
  display: flex;
  justify-content: space-between;
  width: ${i=>i.theme.measurements.advancedUIToolControlBar.width-48}px;
`,jf=qt.article`
  /* 0.6 of width here refers to the width of the container without padding */
  width: ${i=>.6*i.theme.measurements.advancedUIToolControlBar.width}px;
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  text-align: center;
  margin-top: 7px;
  display: inline-block;
  color: ${i=>i.theme.toolControlBar.inputLabelForeground};
`,Gf=qt.div`
  width: ${i=>.6*i.theme.measurements.advancedUIToolControlBar.width}px;
  transform: translateZ(0);
  overflow: hidden;
  transition: all 500ms ease-out;
`,Vf=qt.span`
  width: ${i=>Math.round(i.length*.6*i.theme.measurements.advancedUIToolControlBar.width)}px;
  margin-left: -${i=>i.activeIndex*.6*i.theme.measurements.advancedUIToolControlBar.width}px;
  position: relative;
  display: inline-block;
  transform: translateZ(0);
  transition: all 600ms cubic-bezier(0.77, 0, 0.175, 1);
  font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;
`,wu=qt.div`
  border: solid ${i=>i.theme.card.foreground};
  border-width: 0 2px 2px 0;
  padding: 3px;
  height: 0;
  width: 0;

  ${({direction:i})=>i==="left"?xu`
          margin-left: 2px;
          transform: rotate(135deg);
        `:xu`
          margin-right: 2px;
          transform: rotate(-45deg);
        `}
`,pa=class extends Ze.PureComponent{constructor(e){super(e);this.updateIndex=(e,t=!1)=>{let r=e+(t?-1:1),o=this.props.list.length-1;r>o&&(r=0),r<0&&(r=o),this.props.onSelect(this.props.list[r].identifier)};this.getActiveIndex=e=>{let{list:t}=this.props,r=t.findIndex(o=>o.identifier===e);return r!==-1?r:0};this.throttledUpdateIndex=Du.default(this.updateIndex,600)}render(){let{list:e,label:t,showLabel:r=!0}=this.props,o=this.getActiveIndex(this.props.defaultIdentifier),n=e.length<=1;return Ze.createElement(Nf,{"data-test":me.CarouselSlider},Ze.createElement(Hf,{show:r,label:t}),Ze.createElement(Wf,{id:`photoeditorsdk-${t.replace(" ","-")}`},Ze.createElement(Cu,{ariaLabel:"Select Previous",isDisabled:n,onClick:()=>this.throttledUpdateIndex(o,!0)},Ze.createElement(wu,{direction:"left"})),Ze.createElement(Gf,null,Ze.createElement(Vf,{activeIndex:o,length:e.length},e.map(s=>Ze.createElement(jf,{key:s.identifier},s.value)))),Ze.createElement(Cu,{ariaLabel:"Select Next",isDisabled:n,onClick:()=>this.throttledUpdateIndex(o)},Ze.createElement(wu,{direction:"right"}))))}};pa.defaultProps={showLabel:!0};var Eu=pa;import vr from"react";import $f from"styled-components";var Kf=$f.div`
  display: flex;
  position: relative;
  margin-bottom: 12px;
  max-width: ${i=>i.theme.measurements.basicToolControlBar.maxWidth}px;
`,jo=Kf;import qf,{css as ku}from"styled-components";var Yf=qf.div.attrs({tabIndex:0})`
  position: relative;
  height: 16px;
  width: 16px;
  cursor: pointer;
  background-color: ${i=>i.theme.checkbox.background};
  border-radius: ${i=>i.theme.shape.radiusSmall}px;
  transition-timing-function: ease-in;
  transition-duration: 0.3s;
  &::after {
    content: '';
    position: absolute;
    display: inline-block;
    left: 5px;
    width: 5px;
    height: 10px;
    border-style: solid;
    border-width: 0 2px 2px 0;
    border-color: transparent;
    transform: rotate(45deg) scale(0.8);
  }

  &:first-child {
    margin-right: 8px;
  }

  &:last-child {
    margin-left: 8px;
  }

  ${be}

  &:hover {
    opacity: ${i=>i.theme.checkbox.hoverOpacity};
  }
  ${i=>i.isChecked&&ku`
      background-color: ${i.theme.checkbox.activeBackground};
      &::after {
        color: ${i.theme.checkbox.activeForeground};
        border-color: ${i.theme.checkbox.foreground};
      }
      &:hover {
        background-color: ${i.theme.checkbox.activeBackground};
        opacity: 0.8;
      }
    `}
  ${i=>i.isDisabled&&ku`
      opacity: 0.5;
      cursor: default;
      pointer-events: none;
    `}
`,yr=Yf;import Xf from"styled-components";var Jf=Xf.input.attrs({type:"checkbox",tabIndex:0})`
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
  margin: 0;
  padding: 0;
  ${be}
`,Go=Jf;var Iu=({label:i,value:e,checkMarkPosition:t,onClick:r,isDisabled:o,className:n,style:s})=>{let l=`photoeditorsdk-${i.replace(" ","-")}`;return vr.createElement(jo,{"data-test":me.Checkbox,className:n,style:s},t==="left"&&vr.createElement(yr,{onClick:r,isDisabled:o,isChecked:e}),vr.createElement(ye,{isDisabled:o,label:i,htmlFor:l}),vr.createElement(Go,{id:l,disabled:o,checked:e,onChange:r}),t==="right"&&vr.createElement(yr,{onClick:r,isDisabled:o,isChecked:e}))},Fu=Iu;Iu.defaultProps={value:!1,checkMarkPosition:"left"};import{css as Zf}from"styled-components";var hi=Zf`
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  width: 100%;
  min-height: 26px;
  color: ${i=>i.theme.textInput.foreground};
  padding-bottom: 7px;
  border: none;
  appearance: none;
  border-bottom: 1px solid ${i=>i.theme.textInput.borderColor};
  background: ${i=>i.theme.textInput.background};
  font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;
  transition: border-color 0.4s ease-in-out;

  &:focus {
    outline: none;
    border-color: ${i=>i.theme.textInput.hoverBorderColor};
  }

  &:-moz-focusring {
    outline: none;
    border-color: ${i=>i.theme.textInput.hoverBorderColor};
  }

  &:disabled {
    opacity: ${i=>i.theme.textInput.inactiveOpacity};
    pointer-events: none;
  }

  &:hover {
    border-color: ${i=>i.theme.textInput.hoverBorderColor};
  }

  &::-ms-clear,
  &::-ms-reveal {
    display: none;
  }

  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  &::-webkit-inner-spin-button,
  &::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
`;import Ft from"react";import zu from"styled-components";import Qf,{css as eg}from"styled-components";var Au=eg`
  opacity: ${i=>i.theme.dropdown.inactiveOpacity};
  pointer-events: none;
`,Ru=Qf.div`
  display: block;
  position: relative;
  width: 100%;
  white-space: nowrap;
  transition-duration: 0.5s;

  &:disabled {
    ${Au}
  }

  ${({isDisabled:i})=>i&&Au}
`;import tg,{css as ig}from"styled-components";var Ou=tg.li`
  padding: 10px 16px;
  text-overflow: ellipsis;
  font-size: ${i=>i.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.button2.case};
  white-space: nowrap;
  color: ${i=>i.theme.dropdown.foreground};

  &:hover {
    cursor: pointer;
    background: ${i=>i.theme.dropdown.listItemHoverBackground};
  }

  ${({isActive:i})=>i&&ig`
      border-left: 2px solid ${e=>e.theme.primary};
    `}

  ${be}
`;import ng,{css as Mu}from"styled-components";import Tu from"react";import Pu,{css as zi}from"styled-components";var rg=Pu.div`
  display: flex;
  ${i=>Me()||ti()?zi`
        overflow: hidden;
      `:i.direction==="vertical"?zi`
        flex-direction: column;
        flex: 1 1 auto;
        overflow-y: auto;
        overflow-x: hidden;
      `:zi`
      overflow-y: hidden;
      overflow-x: auto;
    `};
`,og=Pu.ul.attrs(()=>({role:"menubar","aria-label":"Tool Navigation"}))`
  display: flex;
  flex-direction: ${i=>i.direction==="vertical"?"column":"row"};

  list-style: none;
  padding: 0;
  margin: 0;

  ${i=>Me()||ti()?zi`
        width: 100%;
        height: 100%;

        ${()=>i.direction==="vertical"?zi`
              overflow-y: auto;
              overflow-x: hidden;

              /* hidde the arrows */
              margin-top: -10px;
              margin-bottom: -10px;
              padding-top: 10px;
              padding-bottom: 10px;

              /* hide the scrollbar */
              padding-right: 10px;
              margin-right: -10px;
            `:zi`
            overflow-y: hidden;
            overflow-x: auto;

            margin-right: -10px;
            margin-left: -10px;
            padding-right: 10px;
            padding-left: 10px;

            padding-bottom: 10px;
            margin-bottom: -10px;
          `}

        scrollbar-face-color: #454545;
        scrollbar-track-color: ${i.theme.toolbar.background};
        scrollbar-base-color: ${i.theme.toolbar.background};
        scrollbar-3dlight-color: #454545;
        scrollbar-highlight-color: #454545;
        scrollbar-arrow-color: ${i.theme.toolbar.background};
        scrollbar-shadow-color: #454545;
        scrollbar-dark-shadow-color: #454545;
      `:""}
`,ma=({direction:i="horizontal","data-test":e,className:t,children:r})=>Tu.createElement(rg,{direction:i,className:t},Tu.createElement(og,{direction:i,"data-test":e},r));var ha=ng(ma)`
  position: absolute;

  background: ${i=>i.theme.dropdown.listBackground};
  color: ${i=>i.theme.dropdown.listForeground};
  border: 1px solid ${i=>i.theme.dropdown.listBorderColor};
  box-shadow: ${i=>i.theme.dropdown.listShadow};

  visibility: hidden;
  opacity: 0;
  ${i=>i.isOpen?Mu`
        visibility: visible;
        opacity: 1;
        display: flex;
      `:""}

  transition: all 0.5s ease;

  width: 100%;
  max-height: 160px;
  margin: 5px 0;

  /* had to add these changes to get the dropdown working in IE11 */
  ${()=>Me()?Mu`
        > ul {
          height: 160px;
          margin-bottom: 0px;
          margin-top: 0px;
          padding-bottom: 0px;
          padding-top: 0px;
        }
      `:""}

  border-radius: 0 0 ${i=>i.theme.shape.radiusMedium}px
    ${i=>i.theme.shape.radiusMedium}px;
  z-index: ${i=>i.theme.measurements.zIndex.input.list};
`;ha.defaultProps={direction:"vertical"};import sg from"styled-components";var Bu=sg.div`
  font-size: ${i=>i.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.body.case};
  color: ${i=>i.theme.dropdown.foreground};
  background-color: ${i=>i.theme.dropdown.background};
  border: none;
  border-bottom: 1px solid ${i=>i.theme.dropdown.borderColor};
  padding: 5px 0;
  cursor: ${i=>i.showList?"pointer":"default"};
  transition: border-color 0.4s ease-in-out;

  &:hover {
    border-color: ${i=>i.theme.dropdown.hoverBorderColor};
  }

  ${be}
`;var ag=zu.div`
  position: absolute;
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${i=>i.theme.dropdown.caretColor};
  transform: rotate(${i=>i.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
  right: 0;
  top: 13px;
`,lg=zu.div``,fa=class extends Ft.PureComponent{constructor(e){super(e);this.state={isOpen:!1};this.handleOutsideClick=e=>{this.node&&this.node.contains(e.target)||this.setState({isOpen:!1})};this.onSelect=e=>{let{onSelect:t}=this.props;t(e),this.setState({isOpen:!1})};this.onClick=()=>{this.setState(e=>({isOpen:!e.isOpen}))};this.listItem=e=>{let{itemStyle:t,selectedItem:r}=this.props,{isOpen:o}=this.state,{value:n,label:s}=e,l={};return typeof t=="function"?l=t(e):t!==null&&typeof t=="object"&&(l=t),Ft.createElement(Ou,{"aria-hidden":!o,tabIndex:0,style:l,onClick:()=>this.onSelect(n),key:n,isActive:r===n},s)};this.onKeyDown=e=>{(e.code==="Space"||e.code==="Enter")&&this.onClick()};this.nodeRef=t=>{this.node=t}}componentDidMount(){document.addEventListener("mousedown",this.handleOutsideClick,!1)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1)}render(){let{selectedItem:e,list:t,label:r,style:o,isDisabled:n}=this.props,{isOpen:s}=this.state,l=t.length>1,c=n?{}:{tabIndex:0};return Ft.createElement(lg,null,Ft.createElement(ye,{isDisabled:n,style:{paddingLeft:"0px"},label:r}),Ft.createElement("div",{ref:this.nodeRef},Ft.createElement(Ru,{isOpen:s,isDisabled:n},Ft.createElement(Bu,f(f({"data-test":me.Dropdown,"aria-hidden":n},c),{showList:l,style:o,onClick:l?this.onClick:void 0,onKeyDown:this.onKeyDown}),e,l&&Ft.createElement(ag,{rotation:s?180:0})),Ft.createElement(ha,{"data-test":me.DropdownList,isOpen:s},l&&t.map(this.listItem)))))}};import cg from"styled-components";var Lu=cg.input.attrs({type:"file",id:"fileUpload",accept:"image/*"})`
  display: none;
`;import ug from"react";var dg=({children:i})=>ug.createElement("form",{onSubmit:t=>{t.preventDefault()}},i),Uu=dg;import _r from"react";import hg,{css as Hu}from"styled-components";import ga from"react";import Nu from"styled-components";var pg=Nu.input`
  ${hi}
  /* override user agent style */
  padding: 0;
  &:disabled {
    opacity: ${i=>i.theme.textInput.inactiveOpacity};
    cursor: default;
    pointer-events: none;
  }
`,mg=Nu.div`
  position: relative;
  &:first-child {
    margin-right: 15px;
  }
`,ba=class extends ga.Component{constructor(){super(...arguments);this.onChange=e=>{let{onChange:t}=this.props;t&&t(e.target.value)}}render(){let{id:e,testId:t,value:r,type:o,min:n,max:s,onBlur:l,onFocus:c,onKeyUp:p,onKeyDown:m,onMouseUp:h,onTouchEnd:b,isDisabled:v,className:x,children:I}=this.props;return ga.createElement(mg,{className:x},ga.createElement(pg,{id:e,"data-test":t,"aria-hidden":v,disabled:v,value:r,type:o,min:n,max:s,onChange:this.onChange,onBlur:l,onFocus:c,onKeyUp:p,onKeyDown:m,onMouseUp:h,onTouchEnd:b}),I)}};ba.defaultProps={type:"text"};var Vo=ba;var fg=hg.div`
  ${Me()?Hu``:Hu`
        display: flex;
        flex: 0 1 auto;
        flex-direction: column;
      `}
`,Sr=class extends _r.Component{constructor(e){super(e);this.node=null;this.handleOutsideClick=e=>{this.node&&this.node.current&&this.node.current.contains(e.target)||this.onSubmit()};this.onSubmit=()=>{let{onSubmit:e}=this.props,{value:t,isActive:r}=this.state;if(e){let o=parseFloat(Sr.cleanValue(t));!Number.isNaN(o)&&r&&e(`${o}`)}this.setState({isActive:!1})};this.onBlur=()=>{this.onSubmit()};this.onFocus=()=>{this.setState({isActive:!0})};this.onKeyDown=e=>{let{value:t}=this.state;if(e.key==="Enter")this.onSubmit();else if(e.key==="ArrowUp"){let r=parseFloat(Sr.cleanValue(t));typeof r=="number"&&this.setState({value:(r+1).toString(),isActive:!0})}else if(e.key==="ArrowDown"){let r=parseFloat(Sr.cleanValue(t));typeof r=="number"&&this.setState({value:(r-1).toString(),isActive:!0})}};this.onChange=e=>{this.setState({value:e.replace(/[^\d.,-]/g,""),isActive:!0})};this.state={value:this.props.value||"",isActive:!1},this.node=_r.createRef(),document.addEventListener("mousedown",this.handleOutsideClick,!1),document.addEventListener("touchstart",this.handleOutsideClick,!1)}static getDerivedStateFromProps({value:e},{value:t,isActive:r}){return e!==t&&!r?{value:e}:null}static cleanValue(e){return e?e.replace(",",".").replace(/[a-zA-Z]/g,"").trim():""}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1),document.removeEventListener("touchstart",this.handleOutsideClick,!1)}render(){let{id:e,label:t,isDisabled:r,ariaHidden:o,onMouseUp:n,onTouchEnd:s,className:l}=this.props,{value:c}=this.state;return _r.createElement(fg,{ref:this.node,"data-test":me.NummericInput,className:l},_r.createElement(ye,{htmlFor:e,label:t,show:!!t,isDisabled:r}),_r.createElement(Vo,{id:e,value:c,isDisabled:r,"aria-hidden":o,onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.onFocus,onMouseUp:n,onTouchEnd:s}))}},ya=Sr;ya.defaultProps={showLabel:!0};var $o=ya;import va from"react";import gg from"styled-components";var bg=gg.input.attrs({type:"search"})`
  ${hi}
`,yg=i=>va.createElement("div",null,va.createElement(ye,{show:!1,label:"photoeditorsdk-Search"}),va.createElement(bg,{id:"photoeditorsdk-Search",onChange:t=>{i.onChange(t.target.value)},placeholder:i.placeholder})),Wu=yg;import _a from"react";import ju,{css as vg}from"styled-components";var _g=ju.div``,Gu=({label:i,children:e,inline:t,showLabel:r,isDisabled:o,"data-test":n})=>_a.createElement(_g,{"data-test":n},_a.createElement(ye,{isDisabled:o,label:i,show:r}),_a.createElement(Sg,{id:`photoeditorsdk-${i.replace(" ","-")}`,inline:!!t},e)),Sg=ju.div`
  display: inline-flex;
  ${i=>!i.inline&&vg`
        flex-wrap: wrap;
      `||""}
`;Gu.defaultProps={showLabel:!0};var Vu=Gu;import Li from"react";import Dr,{css as xr}from"styled-components";var Dg=Dr.div`
  display: flex;
  flex-direction: column;
  /* needed for IE11 to properly calculate the width */
  min-width: 1px;
`,xg=Dr(ye)`
  padding-bottom: 2px;
`,Sa=xr`
  ${ti()||Me()?xr`
        width: 16px;
        height: 16px;
      `:xr`
        width: 20px;
        height: 20px;
      `}
  background: ${i=>i.theme.slider.thumbBackground};
  border: 2px solid ${i=>i.theme.slider.thumbBorderColor};
  border-radius: 50%;
  cursor: pointer;
`,Cg=i=>{let e=(i.value-i.min)*100/(i.max-i.min);return i.adjust?i.value>0?(e=i.value*(i.max/2)*100,`${i.theme.slider.trackColor} 0%,
      ${i.theme.slider.trackColor} 50%,
      ${i.theme.slider.activeTrackColor} 50%,
      ${i.theme.slider.activeTrackColor} ${50+e}%,
      ${i.theme.slider.trackColor} ${50+e}%,
      ${i.theme.slider.trackColor} 100%
      `):i.value<0?(e=i.value*(i.min/2)*100,`${i.theme.slider.trackColor} 0%,
      ${i.theme.slider.trackColor} ${50-e}%,
      ${i.theme.slider.activeTrackColor} ${50-e}%,
      ${i.theme.slider.activeTrackColor} 50%,
      ${i.theme.slider.trackColor} 50%,
      ${i.theme.slider.trackColor} 100%
      `):`${i.theme.slider.trackColor} 0%,
    ${i.theme.slider.trackColor} 100%`:`${i.theme.slider.activeTrackColor} 0%,
    ${i.theme.slider.activeTrackColor} ${e}%,
    ${i.theme.slider.trackColor} ${e}%,
    ${i.theme.slider.trackColor} 100%`},wg=Dr.input`
  display: flex;
  flex: 1 0 auto;
  appearance: none;
  max-width: calc(100% - 50px);
  outline: none;
  border-radius: 0; /* iOS */

  ${be}

  ${ti()||Me()?xr`
        margin-top: 10px;
        height: 20px;
        /* remove once we have a better concept for focus in all browser */
        &:focus {
          box-shadow: none;
        }
      `:xr`
        height: 2px;
        background: ${i=>`linear-gradient(to right, ${Cg(i)})`};
      `}
  &::-moz-focus-outer {
    /** This is to remove the dotted focus lines in firefox */
    border: 0;
  }
  &:disabled {
    opacity: ${i=>i.theme.slider.inactiveOpacity};
    pointer-events: none;
  }
  &:hover {
    opacity: ${i=>i.theme.slider.hoverOpacity};
  }
  &::-webkit-slider-runnable-track {
    cursor: pointer;
    appearance: none;
  }
  &::-moz-range-track {
    appearance: none;
    cursor: pointer;
  }
  &::-ms-track {
    cursor: pointer;
    height: 2px;
    appearance: none;
    background: transparent;
    color: transparent;
    border-color: transparent;
    border-width: 6px 0;
  }
  &::-webkit-slider-thumb {
    appearance: none;
    ${Sa}
  }
  &::-moz-range-thumb {
    appearance: none;
    ${Sa}
  }
  &::-ms-thumb {
    appearance: none;
    ${Sa}
  }
  &::-ms-fill-lower {
    background: ${i=>`${i.theme.slider.activeTrackColor}`};
  }
  &::-ms-fill-upper {
    background: ${i=>`${i.theme.slider.trackColor}`};
  }
  &::-ms-tooltip {
    display: none;
  }
  @media all and (min-width: 0) and (max-width: 599px) {
    width: 200px;
  }
`,Eg=Dr.div`
  display: flex;
  align-items: center;
  height: 26px;
  margin-right: ${i=>i.centerSlider?-56:0}px;
`,kg=Dr($o)`
  max-width: 50px;
  padding-left: 16px;
  > div > input {
    text-align: center;
  }
`,Da=class extends Li.Component{constructor(e){super(e);this.onSubmit=e=>{let{onChange:t,suffix:r,divider:o,min:n,max:s,value:l}=this.props,c=e.replace(r,""),p=c?parseFloat(c)/o:l,m=Math.max(n,Math.min(s,p));Number.isNaN(m)||(t(m),this.props.onMouseUp?this.props.onMouseUp():this.props.onTouchEnd&&this.props.onTouchEnd())};this.onSliderChange=e=>{let{onChange:t}=this.props,r=parseFloat(e.target.value);t(r)};this.randomId=xi()}render(){let{"data-test":e,identifier:t,value:r,min:o,max:n,divider:s,suffix:l,decimal:c,showLabel:p,showInput:m,style:h,centerSlider:b,adjust:v,label:x,isDisabled:I,step:R,"aria-hidden":M,onMouseUp:Q,onTouchEnd:se,className:ve}=this.props,_e=`photoeditorsdk-slider-${this.randomId}`,T=`${_e}-input`,Z=`${(r*s).toFixed(c)}${l}`,ae=m&&Li.createElement(kg,{id:T,value:Z,isDisabled:I,"aria-hidden":M,onSubmit:this.onSubmit});return Li.createElement(Dg,{className:ve,"data-test":e||t||_e},Li.createElement(xg,{isDisabled:I,label:x,show:p}),Li.createElement(Eg,{centerSlider:m&&b},Li.createElement(wg,{type:"range",role:"slider","aria-hidden":M,tabIndex:0,value:r,min:o,max:n,step:R,style:h,disabled:I,id:_e,onChange:this.onSliderChange,adjust:v,name:x,onKeyUp:this.onSliderChange,onKeyDown:this.onSliderChange,onMouseUp:Q,onTouchEnd:se}),ae))}};Da.defaultProps={showLabel:!0,showInput:!0,adjust:!1,centerSlider:!1,min:-1,max:1,value:0,step:.01,decimal:0,divider:100,suffix:""};var $u=Da;import At from"react";import Ig from"styled-components";var Cr=Ig(Te)`
  color: ${i=>i.theme.button.textPrimaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:i})=>i&&It}

  ${Oe} {
    display: none;
  }

  &:disabled {
    opacity: ${i=>i.theme.button.textInactiveOpacity};
  }
`;import Fg from"styled-components";var wr=Fg(Te)`
  color: ${i=>i.theme.button.textSecondaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:i})=>i&&It}

  ${Oe} {
    display: none;
  }

  &:disabled {
    opacity: ${i=>i.theme.button.textInactiveOpacity};
  }
`;var xa=class extends At.Component{constructor(){super(...arguments);this.onDismiss=()=>{let{handleClose:e,handleDismiss:t}=this.props;e&&e(),t&&t()};this.onConfirm=()=>{let{handleClose:e,handleConfirm:t}=this.props;e&&e(),t&&t()}}render(){let{headerLabel:e,bodyLabel:t,confirmLabel:r,dismissLabel:o,type:n,children:s}=this.props,l=At.Children.toArray(s)[0];if(!At.isValidElement(l))throw new Error("Child is not a valid react element");return At.cloneElement(l,{handleConfirm:this.onConfirm,handleDismiss:this.onDismiss,header:At.createElement(Pi,null,e),body:At.createElement(kt,{"data-test":me.DialogBody},t),footer:At.createElement(Ti,{type:n},o&&At.createElement(wr,{label:o,ariaLabel:o,onClick:this.onDismiss}),r&&At.createElement(Cr,{label:r,ariaLabel:r,onClick:this.onConfirm}))})}};import pt from"react";import Ko from"styled-components";var Ag=Ko.div`
  display: flex;
`,Rg=Ko(Pi)`
  padding: 0;
`,Og=Ko.div`
  display: flex;
  flex-direction: column;
  margin-left: 8px;
  @media all and (min-width: 640px) {
    margin-left: 30px;
  }
`,Tg=Ko(kt)`
  padding: 0;
  margin: 0;
`,Ca=class extends pt.PureComponent{render(){let{headerLabel:e,bodyLabel:t,children:r}=this.props,o=pt.Children.toArray(r)[0];if(!pt.isValidElement(o))throw new Error("Child is not a valid react element");return pt.cloneElement(o,{height:"90px",body:pt.createElement(kt,{"data-test":me.DialogBody},pt.createElement(Ag,null,pt.createElement(Ao,null),pt.createElement(Og,null,pt.createElement(Rg,null,e),pt.createElement(Tg,null,t))))})}};import Ne from"react";import Er from"styled-components";var Pg=Er.form`
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
`,Mg=Er.textarea`
  display: flex;
  caret-color: ${i=>i.theme.primary};
  ${hi}
  min-height: 100%;
  padding: 0px;
  outline-offset: -8px;
  color: ${i=>i.theme.modal.bodyForeground};
  resize: none;
  font-family: '${i=>i.theme.typography.fontFamily}', sans-serif;

  &:selection,
  &:-moz-selection {
    background-color: ${i=>i.theme.primary};
    color: ${i=>i.theme.foreground};
  }
`,Bg=Er.label`
  padding: 11px 20px 8px;
  font-size: ${i=>i.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.label.case};
  color: ${i=>i.theme.modal.headerForeground};
`,zg=Er(kt)`
  height: 100%;
`,Lg=Er(Ti)`
  border-top: none;
`,wa=class extends Ne.Component{constructor(){super(...arguments);this.state={value:""};this.input=Ne.createRef();this.handleKeydown=e=>{El(this.handleDismiss)(e)};this.handleDismiss=()=>{let{handleDismiss:e}=this.props;e&&e(!1)};this.handleConfirm=()=>{let{handleConfirm:e}=this.props,{value:t}=this.input.current;t&&(e&&e(t),this.handleDismiss())};this.onChange=e=>{let t=_l(e.target.value);this.input.current.value=t,this.setState({value:t})};this.onSubmit=e=>{e.preventDefault()}}componentDidMount(){let{text:e,defaultText:t}=this.props;this.input.current.focus(),this.input.current.value=e||t||"",this.setState({value:this.input.current.value}),document.addEventListener("keydown",this.handleKeydown,!1),e===t&&this.input.current.select()}componentDidUpdate(e){let{isVisible:t}=this.props;e.isVisible!==t&&t&&this.input.current.focus()}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeydown,!1)}render(){let{headerLabel:e,dismissLabel:t,confirmLabel:r,maxLength:o,type:n,children:s}=this.props,{value:l}=this.state,c=Ne.Children.toArray(s)[0];if(!Ne.isValidElement(c))throw new Error("Child is not a valid react element");return Ne.cloneElement(c,{handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss,isConfirmDisabled:!l,height:"150px",header:Ne.createElement(Bg,{htmlFor:"photoeditorsdk-TextInput"},e),body:Ne.createElement(zg,null,Ne.createElement(Pg,{onSubmit:this.onSubmit},Ne.createElement(Mg,{ref:this.input,id:"photoeditorsdk-TextInput",placeholder:"Write Something",autoFocus:!0,onChange:this.onChange,maxLength:o}))),footer:Ne.createElement(Lg,{type:n},Ne.createElement(wr,{label:t,ariaLabel:t,onClick:this.handleDismiss}),Ne.createElement(Cr,{label:r,ariaLabel:r,isDisabled:!l,onClick:this.handleConfirm}))})}};wa.defaultProps={defaultText:"Write Something"};var Ku=wa;import Ug from"styled-components";var qu=Ug.div`
  padding-bottom: ${i=>(i.count||1)*8}px;
`,Yu=qu;qu.defaultProps={count:1};import Ui from"react";var Ea=class extends Ui.Component{getChildren(){let e=[],t=[];return Ui.Children.forEach(this.props.children,r=>{switch(r.type.componentName){case"case":this.props.type===r.props.value&&e.push(r);break;case"default":t.push(r);break}}),e.length>0?e:t}render(){let e=this.getChildren();return e.length===0?null:Ui.createElement(Ui.Fragment,null,e)}},qo=class extends Ui.Component{render(){return this.props.children}};qo.componentName="case";var Yo=class extends Ui.Component{render(){return this.props.children}};Yo.componentName="default";import Ng,{keyframes as Hg,css as Wg}from"styled-components";var jg=Hg`
  from { transform: translate(-50%, 0%); }
  to { transform: translate(-50%, 50%); }
`,Gg=Ng.div`
  position: absolute;
  top: ${i=>i.position.y}px;
  left: ${i=>i.position.x}px;
  transform: translate(-50%, 50%);
  background: black;
  color: white;
  border-radius: ${i=>i.theme.shape.radiusMedium}px;
  padding: 10px 16px;
  text-align: center;
  z-index: ${i=>i.theme.measurements.zIndex.toast};
  visibility: hidden;

  ${({show:i})=>i&&Wg`
      visibility: visible;
      animation: ${jg} 0.5s, fadeout 0.5s 2.5s;
    `}
`,Xu=Gg;import ka from"react";import Ia,{css as Ju}from"styled-components";var Vg=Ia(Te)`
  ${({fullWidth:i})=>i&&Ju`
      width: 100%;
    `}
`,$g=Ia.div`
  &:focus {
    outline: none;
  }

  > img {
    height: 18px;
    width: 18px;
  }

  > svg {
    height: 18px;
    width: 18px;
  }
  display: none;

  @media all and (min-width: 0) and (max-width: 599px) {
    display: flex;
  }
`,Kg=Ia.div`
  display: flex;
  justify-content: center;
  align-items: center;
  &:focus {
    outline: none;
  }

  ${({hasIcon:i})=>i&&Ju`
      @media all and (min-width: 0) and (max-width: 599px) {
        display: none;
      }
    `}
`,fi=n=>{var{label:i,children:e,icon:t,fullWidth:r}=n,o=Pe(n,["label","children","icon","fullWidth"]);let s=ka.createElement(Kg,{hasIcon:!!t},i,e);return ka.createElement(Vg,f({fullWidth:r},o),t&&ka.createElement($g,null,t),(e||i)&&s)};import qg from"styled-components";var Yg=qg(fi)`
  background: ${i=>i.theme.button.outlinedPrimaryBackground};
  color: ${i=>i.theme.button.outlinedPrimaryForeground};
  border: 1px solid ${i=>i.theme.button.outlinedBorderColor};
  min-width: 32px;
`;import Xg from"styled-components";var Jg=Xg(fi)`
  background: ${i=>i.theme.button.outlinedSecondaryBackground};
  color: ${i=>i.theme.button.outlinedSecondaryForeground};
  border: 1px solid ${i=>i.theme.button.outlinedBorderColor};
`;import CT from"react";import Zu from"styled-components";var FT=Zu(Te)`
  color: ${i=>i.theme.foreground};
  /* Repeat active styles so they are not overwritten */
  ${({isActive:i})=>i&&It}

  ${Oe} {
    display: none;
  }

  &:disabled {
    opacity: ${i=>i.theme.button.textInactiveOpacity};
  }
`,AT=Zu.div`
  display: flex;
  &:focus {
    outline: none;
  }
`;import Zg from"styled-components";var Qg=Zg(fi)`
  background: ${i=>i.theme.button.containedPrimaryBackground};
  color: ${i=>i.theme.button.containedPrimaryForeground};
  border: 1px solid ${i=>i.theme.button.containedPrimaryBackground};

  &:active {
    color: ${i=>i.theme.button.containedPrimaryForeground};
  }
`;import Ni from"react";import eb,{css as Qu}from"styled-components";var tb=()=>Qu`
    animation: ${ks} 0.2s linear;
  `,ib=Qu`
  border: 1px solid ${i=>i.theme.card.activeBorderColor};
  ${da} {
    background-color: ${i=>i.theme.card.activeOverlayColor};
  }
`,rb=eb.button.attrs(i=>{let e={};return i.image&&(e.backgroundImage=`url(${i.image})`),{style:e}})`
  &&& {
    box-sizing: border-box;
  }

  /* basic ui text items use position absolute */
  position: relative;

  padding: 0;
  cursor: pointer;
  /* Safari will change the height of the toolbar and position the category cards at the bottom for some reason */
  vertical-align: top;
  border: none;
  box-sizing: border-box;
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  background-color: ${i=>i.theme.card.background};
  color: ${i=>i.theme.card.foreground};
  border-radius: ${i=>i.theme.shape.radiusMedium}px;
  ${tb};
  animation-fill-mode: both;
  overflow: hidden;

  ${be}

  /* Active */

  /* No :active styles on purpose. */

  ${({isActive:i})=>i&&ib}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${Oe} {
      background-color: ${i=>i.theme.card.inactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${Bi} {
      background-color: ${i=>i.theme.card.hoverOverlayColor};
    }
  }
`,Fa=class extends Ni.Component{constructor(){super(...arguments);this.state=Ho;this.timeout=null;this.onKeyDown=e=>{(e.key==="Space"||e.key==="Enter")&&this.props.onClick&&this.props.onClick()};this.onClick=e=>{let t=e.currentTarget.getBoundingClientRect(),r=e.pageX-t.left,o=e.pageY-t.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(r,o)}):this.setRippleState(r,o),this.props.onClick(e)};this.setRippleState=(e,t)=>{this.setState({left:e,top:t,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){let{children:e,label:t,isActive:r,isDisabled:o,image:n,style:s,className:l}=this.props,{left:c,top:p,display:m}=this.state;return Ni.createElement(rb,{isActive:r,"aria-label":t,"data-test":t,disabled:o,image:n,onClick:this.onClick,onKeyDown:this.onKeyDown,style:s,className:l},e,Ni.createElement(Wo,{display:m,left:c,top:p}),Ni.createElement(da,null),Ni.createElement(Oe,null),Ni.createElement(Bi,null))}};Fa.defaultProps={isActive:!1};import jT from"react";import kr,{css as Xo}from"styled-components";var KT=kr.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 4px;
  font-size: ${i=>i.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${i=>i.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${i=>i.theme.measurements.fontSystem.label.case};
`,qT=kr.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  position: absolute;
  bottom: 0px;
  border-radius: ${i=>i.theme.shape.radiusMedium}px;
  left: 0;
  ${i=>i.withBackground?Xo`
          color: ${i.theme.card.labelForeground};
          height: 40px;
          background: ${i.theme.card.labelBackground};
        `:Xo`
          color: ${i.theme.card.foreground};
          height: 32px;
        `}
  width: 100%;
  cursor: pointer;
`,YT=kr.div`
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${i=>i.theme.card.labelForeground};
  ${i=>i.withBackground?Xo`
          border-top-color: ${i.theme.card.labelForeground};
        `:Xo`
          border-top-color: ${i.theme.card.foreground};
        `}
  transform: rotate(${i=>i.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
`,XT=kr.span`
  display: flex;
  align-items: center;
  justify-content: center;
  padding-left: 10px;
`,JT=kr.div`
  ${hr}
`;import ob from"styled-components";var nb=ob.div.attrs(i=>({"data-test":me.CardAvatar,style:{backgroundImage:`url(${i.url})`}}))`
  position: absolute;
  top: 4px;
  left: 4px;
  height: 28px;
  width: 28px;
  border-radius: 50%;
`;var aM={Container:Us,ColorItem:eu,ColorItemBase:Co,ColorItemBackground:Do,ColorItemTiledBackground:wo,ColorItemActiveOverlay:xo,Dialog:tu,DialogBase:Io,DialogContainer:Fo,DialogBackdrop:ko,DialogHeader:Pi,DialogBody:kt,DialogFooter:Ti,DialogSpinner:Ao,TextEditModal:Ku,ActionModal:xa,InfoModal:Ca,Spacer:Yu,Draggable:gu,DraggableCore:mi,Toast:Xu,Input:{Label:ye,File:Lu,Search:Wu,Slider:$u,CarouselSlider:Eu,Selection:Vu,Checkbox:Fu,CheckboxBase:jo,CheckboxInput:Go,CheckboxCheckMark:yr,Dropdown:fa,Text:Vo,NumericInput:$o,Form:Uu},Switch:{Index:Ea,Case:qo,Default:Yo}};export{Xi as a,Dn as b,ti as c,CT as d,jT as e,kn as f,bp as g,Dc as h,Es as i,Dm as j,ks as k,be as l,hr as m,Cn as n,Tn as o,Me as p,Bs as q,xn as r,$r as s,Fn as t,An as u,Qg as v,Yg as w,Jg as x,En as y,yp as z,Mn as A,Oe as B,nb as C,gp as D,In as E,Pn as F,Cr as G,wr as H,I_ as I,On as J,FT as K,Rn as L,KT as M,F as N,fi as O,ma as P,AT as Q,qT as R,Pe as S,ne as T,YT as U,XT as V,is as W,JT as X,Te as Y,U as Z,Fa as _,Wt as $,O as aa,ir as ba,a as ca,me as da,ie as ea,aM as fa,dr as ga,Zs as ha,Qs as ia,Ih as ja,Zc as ka,al as la,k as ma};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
