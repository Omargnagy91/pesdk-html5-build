import{$ as Ae,A as Wb,B as Ht,C as w,D as Db,E as ae,G as Sl,H as lo,J as Kh,K as xb,M as Xh,N as f,O as qh,P as zt,Q as lp,R as el,S as An,T as Uh,U as h,V as qn,X as Gb,Y as cp,Z as Al,_ as k,a as he,aa as Xn,b as Tn,ba as Hl,c as m,d as Mi,e as At,f as oi,g as tp,h as Zt,i as Xe,j as b,k as X,l as Rt,m as U,o as On,p as Ll,q as kb,r as ro,s as Fb,u as Or,v as wb,y as Yh,z as Qt}from"./chunk.UPDPDFFX.js";var Qs=Object.getOwnPropertySymbols,ru=Object.prototype.propertyIsEnumerable,qe=(e,t)=>{var i={};for(var r in e)Db.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&Qs)for(var r of Qs(e))t.indexOf(r)<0&&ru.call(e,r)&&(i[r]=e[r]);return i},s=(e,t,i,r)=>{for(var o=r>1?void 0:r?xb(t,i):t,n=e.length-1,a;n>=0;n--)(a=e[n])&&(o=(r?a(t,i,o):a(o))||o);return r&&o&&wb(t,i,o),o},p=el((ou,en)=>{Uh(ou,{$mobx:()=>Qa,FlowCancellationError:()=>Zr,IDerivationState:()=>V,ObservableMap:()=>or,ObservableSet:()=>nr,Reaction:()=>hr,_allowStateChanges:()=>zu,_allowStateChangesInsideComputed:()=>Pu,_allowStateReadsEnd:()=>Fi,_allowStateReadsStart:()=>Xr,_endAction:()=>xa,_getAdministration:()=>wt,_getGlobalState:()=>ju,_interceptReads:()=>dh,_isComputingDerivation:()=>Fu,_resetGlobalState:()=>Uu,_startAction:()=>wa,action:()=>Xt,autorun:()=>Sn,comparer:()=>ui,computed:()=>ga,configure:()=>rh,createAtom:()=>cn,decorate:()=>oh,entries:()=>yh,extendObservable:()=>mn,extendShallowObservable:()=>nh,flow:()=>ch,get:()=>Sh,getAtom:()=>ct,getDebugName:()=>eo,getDependencyTree:()=>Fa,getObserverTree:()=>sh,has:()=>Ua,intercept:()=>ph,isAction:()=>Qu,isArrayLike:()=>pu,isBoxedObservable:()=>vn,isComputed:()=>fh,isComputedProp:()=>mh,isFlowCancellationError:()=>lh,isObservable:()=>Ei,isObservableArray:()=>Ee,isObservableMap:()=>ge,isObservableObject:()=>Oe,isObservableProp:()=>gh,isObservableSet:()=>Ie,keys:()=>Ai,observable:()=>be,observe:()=>xh,onBecomeObserved:()=>sa,onBecomeUnobserved:()=>ln,onReactionError:()=>Vu,reaction:()=>ih,remove:()=>vh,runInAction:()=>Zu,set:()=>ja,spy:()=>Aa,toJS:()=>_h,trace:()=>Ia,transaction:()=>xt,untracked:()=>yn,values:()=>bh,when:()=>Th});var nu="An invariant failed, however the error is obfuscated because this is an production build.",Hr=[];Object.freeze(Hr);var tn={};Object.freeze(tn);var su={};function Ci(){return typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:su}function Fe(){return++x.mobxGuid}function L(e){throw Pe(!1,e),"X"}function Pe(e,t){if(!e)throw new Error("[mobx] "+(t||nu))}var ea=[];function it(e,t){return!1;if(t)return it("'"+e+"', use '"+t+"' instead.");if(ea.indexOf(e)!==-1)return!1}function rn(e){var t=!1;return function(){return t?void 0:(t=!0,e.apply(this,arguments))}}var jr=function(){};function au(e){var t=[];return e.forEach(function(i){t.indexOf(i)===-1&&t.push(i)}),t}function on(e){return e!==null&&typeof e=="object"}function di(e){if(e===null||typeof e!="object")return!1;var t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}function lu(e){if(_i(e)||ge(e))return e;if(Array.isArray(e))return new Map(e);if(di(e)){var t=new Map;for(var i in e)t.set(i,e[i]);return t}else return L("Cannot convert to map from '"+e+"'")}function cu(e,t){for(var i=0;i<t.length;i++)It(e,t[i],e[t[i]])}function It(e,t,i){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:i})}function er(e,t,i){Object.defineProperty(e,t,{enumerable:!1,writable:!1,configurable:!0,value:i})}function du(e,t){var i=Object.getOwnPropertyDescriptor(e,t);return!i||i.configurable!==!1&&i.writable!==!1}function uu(e,t){}function Wt(e,t){var i="isMobX"+e;return t.prototype[i]=!0,function(r){return on(r)&&r[i]===!0}}function hu(e,t){return typeof e=="number"&&typeof t=="number"&&isNaN(e)&&isNaN(t)}function pu(e){return Array.isArray(e)||Ee(e)}function _i(e){return Ci().Map!==void 0&&e instanceof Ci().Map}function tr(e){return e instanceof Set}function rt(e){for(var t=[];;){var i=e.next();if(i.done)break;t.push(i.value)}return t}function ta(){return typeof Symbol=="function"&&Symbol.toPrimitive||"@@toPrimitive"}function ia(e){return e===null?null:typeof e=="object"?""+e:e}function ra(e,t){for(var i=e.next();!i.done;)t(i.value),i=e.next()}function oa(){return typeof Symbol=="function"&&Symbol.iterator||"@@iterator"}function nn(e,t){er(e,oa(),t)}function ir(e){return e[oa()]=fu,e}function sn(){return typeof Symbol=="function"&&Symbol.toStringTag||"@@toStringTag"}function fu(){return this}var Ur=function(){function e(t){t===void 0&&(t="Atom@"+Fe()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=V.NOT_TRACKING}return e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.reportObserved=function(){return na(this)},e.prototype.reportChanged=function(){ot(),mu(this),nt()},e.prototype.toString=function(){return this.name},e}(),an=Wt("Atom",Ur);function cn(e,t,i){t===void 0&&(t=jr),i===void 0&&(i=jr);var r=new Ur(e);return sa(r,t),ln(r,i),r}function aa(e,t){return e===t}function gu(e,t){return dn(e,t)}function bu(e,t){return dn(e,t,1)}function yu(e,t){return hu(e,t)||aa(e,t)}var ui={identity:aa,structural:gu,default:yu,shallow:bu};var un=function(e,t){return un=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},un(e,t)};function la(e,t){un(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var J=function(){return J=Object.assign||function(t){for(var i,r=1,o=arguments.length;r<o;r++){i=arguments[r];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},J.apply(this,arguments)};function hn(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var r=i.call(e),o,n=[],a;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)n.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(a)throw a.error}}return n}function pn(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(hn(arguments[t]));return e}var vu={},Su={};function Du(e,t){var i=t?vu:Su;return i[e]||(i[e]={configurable:!0,enumerable:t,get:function(){return hi(this),this[e]},set:function(r){hi(this),this[e]=r}})}function hi(e){if(e.__mobxDidRunLazyInitializers===!0)return;var t=e.__mobxDecorators;if(t){It(e,"__mobxDidRunLazyInitializers",!0);for(var i in t){var r=t[i];r.propertyCreator(e,r.prop,r.descriptor,r.decoratorTarget,r.decoratorArguments)}}}function da(e,t){return function(){var r,o=function(a,l,c,d){if(d===!0)return t(a,l,c,a,r),null;if(!Object.prototype.hasOwnProperty.call(a,"__mobxDecorators")){var u=a.__mobxDecorators;It(a,"__mobxDecorators",J({},u))}return a.__mobxDecorators[l]={prop:l,propertyCreator:t,descriptor:c,decoratorTarget:a,decoratorArguments:r},Du(l,e)};return ca(arguments)?(r=Hr,o.apply(null,arguments)):(r=Array.prototype.slice.call(arguments),o)}}function ca(e){return(e.length===2||e.length===3)&&typeof e[1]=="string"||e.length===4&&e[3]===!0}function rr(e,t,i){return Ei(e)?e:Array.isArray(e)?be.array(e,{name:i}):di(e)?be.object(e,void 0,{name:i}):_i(e)?be.map(e,{name:i}):tr(e)?be.set(e,{name:i}):e}function wu(e,t,i){return e==null||(Oe(e)||Ee(e)||ge(e)||Ie(e))?e:Array.isArray(e)?be.array(e,{name:i,deep:!1}):di(e)?be.object(e,void 0,{name:i,deep:!1}):_i(e)?be.map(e,{name:i,deep:!1}):tr(e)?be.set(e,{name:i,deep:!1}):L(!1)}function Wr(e){return e}function xu(e,t,i){return dn(e,t)?t:e}function $r(e){Pe(e);var t=da(!0,function(r,o,n,a,l){var c=n?n.initializer?n.initializer.call(r):n.value:void 0;ua(r,o,c,e)}),i=typeof process!="undefined"&&process.env&&!1?function(){return arguments.length<2?L("Incorrect decorator invocation. @observable decorator doesn't expect any arguments"):t.apply(null,arguments)}:t;return i.enhancer=e,i}var ha={deep:!0,name:void 0,defaultDecorator:void 0},pa={deep:!1,name:void 0,defaultDecorator:void 0};Object.freeze(ha);Object.freeze(pa);function ki(e){return e==null?ha:typeof e=="string"?{name:e,deep:!0}:e}function Vr(e){return e.defaultDecorator?e.defaultDecorator.enhancer:e.deep===!1?Wr:rr}var fn=$r(rr),Cu=$r(wu),fa=$r(Wr),_u=$r(xu);function Eu(e,t,i){if(typeof arguments[1]=="string")return fn.apply(null,arguments);if(Ei(e))return e;var r=di(e)?be.object(e,t,i):Array.isArray(e)?be.array(e,t):_i(e)?be.map(e,t):tr(e)?be.set(e,t):e;if(r!==e)return r;L(!1)}var ma={box:function(e,t){arguments.length>2&&Ot("box");var i=ki(t);return new $t(e,Vr(i),i.name,!0,i.equals)},shallowBox:function(e,t){return arguments.length>2&&Ot("shallowBox"),it("observable.shallowBox","observable.box(value, { deep: false })"),be.box(e,{name:t,deep:!1})},array:function(e,t){arguments.length>2&&Ot("array");var i=ki(t);return new vt(e,Vr(i),i.name)},shallowArray:function(e,t){return arguments.length>2&&Ot("shallowArray"),it("observable.shallowArray","observable.array(values, { deep: false })"),be.array(e,{name:t,deep:!1})},map:function(e,t){arguments.length>2&&Ot("map");var i=ki(t);return new or(e,Vr(i),i.name)},shallowMap:function(e,t){return arguments.length>2&&Ot("shallowMap"),it("observable.shallowMap","observable.map(values, { deep: false })"),be.map(e,{name:t,deep:!1})},set:function(e,t){arguments.length>2&&Ot("set");var i=ki(t);return new nr(e,Vr(i),i.name)},object:function(e,t,i){typeof arguments[1]=="string"&&Ot("object");var r=ki(i);return mn({},e,t,r)},shallowObject:function(e,t){return typeof arguments[1]=="string"&&Ot("shallowObject"),it("observable.shallowObject","observable.object(values, {}, { deep: false })"),be.object(e,{},{name:t,deep:!1})},ref:fa,shallow:Cu,deep:fn,struct:_u},be=Eu;Object.keys(ma).forEach(function(e){return be[e]=ma[e]});function Ot(e){L("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}var Gr=da(!1,function(e,t,i,r,o){var n=i.get,a=i.set,l=o[0]||{};ku(e,t,J({get:n,set:a},l))}),Tu=Gr({equals:ui.structural}),ga=function(t,i,r){if(typeof i=="string")return Gr.apply(null,arguments);if(t!==null&&typeof t=="object"&&arguments.length===1)return Gr.apply(null,arguments);var o=typeof i=="object"?i:{};return o.get=t,o.set=typeof i=="function"?i:o.set,o.name=o.name||t.name||"",new Vt(o)};ga.struct=Tu;var V;(function(e){e[e.NOT_TRACKING=-1]="NOT_TRACKING",e[e.UP_TO_DATE=0]="UP_TO_DATE",e[e.POSSIBLY_STALE=1]="POSSIBLY_STALE",e[e.STALE=2]="STALE"})(V||(V={}));var st;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(st||(st={}));var qr=function(){function e(t){this.cause=t}return e}();function sr(e){return e instanceof qr}function gn(e){switch(e.dependenciesState){case V.UP_TO_DATE:return!1;case V.NOT_TRACKING:case V.STALE:return!0;case V.POSSIBLY_STALE:{for(var t=Xr(!0),i=Ti(),r=e.observing,o=r.length,n=0;n<o;n++){var a=r[n];if(Ii(a)){if(x.disableErrorBoundaries)a.get();else try{a.get()}catch(l){return Gt(i),Fi(t),!0}if(e.dependenciesState===V.STALE)return Gt(i),Fi(t),!0}}return ba(e),Gt(i),Fi(t),!1}}}function Fu(){return x.trackingDerivation!==null}function Oi(e){var t=e.observers.length>0;x.computationDepth>0&&t&&L(!1),!x.allowStateChanges&&(t||x.enforceActions==="strict")&&L(!1)}function Iu(e){}function ya(e,t,i){var r=Xr(!0);ba(e),e.newObserving=new Array(e.observing.length+100),e.unboundDepsCount=0,e.runId=++x.runId;var o=x.trackingDerivation;x.trackingDerivation=e;var n;if(x.disableErrorBoundaries===!0)n=t.call(i);else try{n=t.call(i)}catch(a){n=new qr(a)}return x.trackingDerivation=o,Au(e),e.observing.length===0&&Ou(e),Fi(r),n}function Ou(e){return}function Au(e){for(var t=e.observing,i=e.observing=e.newObserving,r=V.UP_TO_DATE,o=0,n=e.unboundDepsCount,a=0;a<n;a++){var l=i[a];l.diffValue===0&&(l.diffValue=1,o!==a&&(i[o]=l),o++),l.dependenciesState>r&&(r=l.dependenciesState)}for(i.length=o,e.newObserving=null,n=t.length;n--;){var l=t[n];l.diffValue===0&&va(l,e),l.diffValue=0}for(;o--;){var l=i[o];l.diffValue===1&&(l.diffValue=0,Ru(l,e))}r!==V.UP_TO_DATE&&(e.dependenciesState=r,e.onBecomeStale())}function bn(e){var t=e.observing;e.observing=[];for(var i=t.length;i--;)va(t[i],e);e.dependenciesState=V.NOT_TRACKING}function yn(e){var t=Ti(),i=e();return Gt(t),i}function Ti(){var e=x.trackingDerivation;return x.trackingDerivation=null,e}function Gt(e){x.trackingDerivation=e}function Xr(e){var t=x.allowStateReads;return x.allowStateReads=e,t}function Fi(e){x.allowStateReads=e}function ba(e){if(e.dependenciesState===V.UP_TO_DATE)return;e.dependenciesState=V.UP_TO_DATE;for(var t=e.observing,i=t.length;i--;)t[i].lowestObserverState=V.UP_TO_DATE}var Kr=0,Mu=1,Sa=Object.getOwnPropertyDescriptor(function(){},"name"),Cb=Sa&&Sa.configurable;function qt(e,t){var i=function(){return Da(e,t,this,arguments)};return i.isMobxAction=!0,i}function Da(e,t,i,r){var o=wa(e,i,r);try{return t.apply(i,r)}catch(n){throw o.error=n,n}finally{xa(o)}}function wa(e,t,i){var r=we()&&!!e,o=0;if(r){o=Date.now();var n=i&&i.length||0,a=new Array(n);if(n>0)for(var l=0;l<n;l++)a[l]=i[l];Ne({type:"action",name:e,object:t,arguments:a})}var c=Ti();ot();var d=ar(!0),u=Xr(!0),g={prevDerivation:c,prevAllowStateChanges:d,prevAllowStateReads:u,notifySpy:r,startTime:o,actionId:Mu++,parentActionId:Kr};return Kr=g.actionId,g}function xa(e){Kr!==e.actionId&&L("invalid action stack. did you forget to finish an action?"),Kr=e.parentActionId,e.error!==void 0&&(x.suppressReactionErrors=!0),lr(e.prevAllowStateChanges),Fi(e.prevAllowStateReads),nt(),Gt(e.prevDerivation),e.notifySpy&&He({time:Date.now()-e.startTime}),x.suppressReactionErrors=!1}function zu(e,t){var i=ar(e),r;try{r=t()}finally{lr(i)}return r}function ar(e){var t=x.allowStateChanges;return x.allowStateChanges=e,t}function lr(e){x.allowStateChanges=e}function Pu(e){var t=x.computationDepth;x.computationDepth=0;var i;try{i=e()}finally{x.computationDepth=t}return i}var $t=function(e){la(t,e);function t(i,r,o,n,a){o===void 0&&(o="ObservableValue@"+Fe()),n===void 0&&(n=!0),a===void 0&&(a=ui.default);var l=e.call(this,o)||this;return l.enhancer=r,l.name=o,l.equals=a,l.hasUnreportedChange=!1,l.value=r(i,void 0,o),n&&we()&&pi({type:"create",name:l.name,newValue:""+l.value}),l}return t.prototype.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.prototype.set=function(i){var r=this.value;if(i=this.prepareNewValue(i),i!==x.UNCHANGED){var o=we();o&&Ne({type:"update",name:this.name,newValue:i,oldValue:r}),this.setNewValue(i),o&&He()}},t.prototype.prepareNewValue=function(i){if(Oi(this),St(this)){var r=Dt(this,{object:this,type:"update",newValue:i});if(!r)return x.UNCHANGED;i=r.newValue}return i=this.enhancer(i,this.value,this.name),this.equals(this.value,i)?x.UNCHANGED:i},t.prototype.setNewValue=function(i){var r=this.value;this.value=i,this.reportChanged(),at(this)&&lt(this,{type:"update",object:this,newValue:i,oldValue:r})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(i){return cr(this,i)},t.prototype.observe=function(i,r){return r&&i({object:this,type:"update",newValue:this.value,oldValue:void 0}),dr(this,i)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return ia(this.get())},t}(Ur);$t.prototype[ta()]=$t.prototype.valueOf;var vn=Wt("ObservableValue",$t),Vt=function(){function e(t){this.dependenciesState=V.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=V.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Fe(),this.value=new qr(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=st.NONE,Pe(t.get,"missing option for computed: get"),this.derivation=t.get,this.name=t.name||"ComputedValue@"+Fe(),t.set&&(this.setter=qt(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?ui.structural:ui.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return e.prototype.onBecomeStale=function(){Lu(this)},e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.get=function(){this.isComputing&&L("Cycle detected in computation "+this.name+": "+this.derivation),x.inBatch===0&&this.observers.length===0&&!this.keepAlive?gn(this)&&(this.warnAboutUntrackedRead(),ot(),this.value=this.computeValue(!1),nt()):(na(this),gn(this)&&(this.trackAndCompute()&&Bu(this)));var t=this.value;if(sr(t))throw t.cause;return t},e.prototype.peek=function(){var t=this.computeValue(!1);if(sr(t))throw t.cause;return t},e.prototype.set=function(t){if(this.setter){Pe(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else Pe(!1,!1)},e.prototype.trackAndCompute=function(){we()&&pi({object:this.scope,type:"compute",name:this.name});var t=this.value,i=this.dependenciesState===V.NOT_TRACKING,r=this.computeValue(!0),o=i||sr(t)||sr(r)||!this.equals(t,r);return o&&(this.value=r),o},e.prototype.computeValue=function(t){this.isComputing=!0,x.computationDepth++;var i;if(t)i=ya(this,this.derivation,this.scope);else if(x.disableErrorBoundaries===!0)i=this.derivation.call(this.scope);else try{i=this.derivation.call(this.scope)}catch(r){i=new qr(r)}return x.computationDepth--,this.isComputing=!1,i},e.prototype.suspend=function(){this.keepAlive||(bn(this),this.value=void 0)},e.prototype.observe=function(t,i){var r=this,o=!0,n=void 0;return Sn(function(){var a=r.get();if(!o||i){var l=Ti();t({type:"update",object:r,newValue:a,oldValue:n}),Gt(l)}o=!1,n=a})},e.prototype.warnAboutUntrackedRead=function(){return},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},e.prototype.valueOf=function(){return ia(this.get())},e}();Vt.prototype[ta()]=Vt.prototype.valueOf;var Ii=Wt("ComputedValue",Vt),Nu=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED"],ur=function(){function e(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return e}(),Yr=!0,Ca=!1,x=function(){var e=Ci();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(Yr=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new ur().version&&(Yr=!1),Yr?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new ur):(setTimeout(function(){Ca||L("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new ur)}();function Hu(){(x.pendingReactions.length||x.inBatch||x.isRunningReactions)&&L("isolateGlobalState should be called before MobX is running any reactions"),Ca=!0,Yr&&(--Ci().__mobxInstanceCount===0&&(Ci().__mobxGlobals=void 0),x=new ur)}function ju(){return x}function Uu(){var e=new ur;for(var t in e)Nu.indexOf(t)===-1&&(x[t]=e[t]);x.allowStateChanges=!x.enforceActions}function Wu(e){return e.observers&&e.observers.length>0}function $u(e){return e.observers}function Ru(e,t){var i=e.observers.length;i&&(e.observersIndexes[t.__mapid]=i),e.observers[i]=t,e.lowestObserverState>t.dependenciesState&&(e.lowestObserverState=t.dependenciesState)}function va(e,t){if(e.observers.length===1)e.observers.length=0,_a(e);else{var i=e.observers,r=e.observersIndexes,o=i.pop();if(o!==t){var n=r[t.__mapid]||0;n?r[o.__mapid]=n:delete r[o.__mapid],i[n]=o}delete r[t.__mapid]}}function _a(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,x.pendingUnobservations.push(e))}function ot(){x.inBatch++}function nt(){if(--x.inBatch===0){Ea();for(var e=x.pendingUnobservations,t=0;t<e.length;t++){var i=e[t];i.isPendingUnobservation=!1,i.observers.length===0&&(i.isBeingObserved&&(i.isBeingObserved=!1,i.onBecomeUnobserved()),i instanceof Vt&&i.suspend())}x.pendingUnobservations=[]}}function na(e){Iu(e);var t=x.trackingDerivation;return t!==null?(t.runId!==e.lastAccessedBy&&(e.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=e,e.isBeingObserved||(e.isBeingObserved=!0,e.onBecomeObserved())),!0):(e.observers.length===0&&x.inBatch>0&&_a(e),!1)}function mu(e){if(e.lowestObserverState===V.STALE)return;e.lowestObserverState=V.STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===V.UP_TO_DATE&&(r.isTracing!==st.NONE&&ka(r,e),r.onBecomeStale()),r.dependenciesState=V.STALE}}function Bu(e){if(e.lowestObserverState===V.STALE)return;e.lowestObserverState=V.STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===V.POSSIBLY_STALE?r.dependenciesState=V.STALE:r.dependenciesState===V.UP_TO_DATE&&(e.lowestObserverState=V.UP_TO_DATE)}}function Lu(e){if(e.lowestObserverState!==V.UP_TO_DATE)return;e.lowestObserverState=V.POSSIBLY_STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===V.UP_TO_DATE&&(r.dependenciesState=V.POSSIBLY_STALE,r.isTracing!==st.NONE&&ka(r,e),r.onBecomeStale())}}function ka(e,t){if(console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'"),e.isTracing===st.BREAK){var i=[];Ta(Fa(e),i,1),new Function(`debugger;
/*
Tracing '`+e.name+`'

You are entering this break point because derivation '`+e.name+"' is being traced and '"+t.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(e instanceof Vt?e.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+i.join(`
`)+`
*/
    `)()}}function Ta(e,t,i){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+new Array(i).join("	")+e.name),e.dependencies&&e.dependencies.forEach(function(r){return Ta(r,t,i+1)})}var hr=function(){function e(t,i,r,o){t===void 0&&(t="Reaction@"+Fe()),o===void 0&&(o=!1),this.name=t,this.onInvalidate=i,this.errorHandler=r,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=V.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Fe(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=st.NONE}return e.prototype.onBecomeStale=function(){this.schedule()},e.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,x.pendingReactions.push(this),Ea())},e.prototype.isScheduled=function(){return this._isScheduled},e.prototype.runReaction=function(){if(!this.isDisposed){if(ot(),this._isScheduled=!1,gn(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&we()&&pi({name:this.name,type:"scheduled-reaction"})}catch(t){this.reportExceptionInDerivation(t)}}nt()}},e.prototype.track=function(t){ot();var i=we(),r;i&&(r=Date.now(),Ne({name:this.name,type:"reaction"})),this._isRunning=!0;var o=ya(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&bn(this),sr(o)&&this.reportExceptionInDerivation(o.cause),i&&He({time:Date.now()-r}),nt()},e.prototype.reportExceptionInDerivation=function(t){var i=this;if(this.errorHandler){this.errorHandler(t,this);return}if(x.disableErrorBoundaries)throw t;var r="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";x.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(r,t),we()&&pi({type:"error",name:this.name,message:r,error:""+t}),x.globalReactionErrorHandlers.forEach(function(o){return o(t,i)})},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(ot(),bn(this),nt()))},e.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t.$mobx=this,t},e.prototype.toString=function(){return"Reaction["+this.name+"]"},e.prototype.trace=function(t){t===void 0&&(t=!1),Ia(this,t)},e}();function Vu(e){return x.globalReactionErrorHandlers.push(e),function(){var t=x.globalReactionErrorHandlers.indexOf(e);t>=0&&x.globalReactionErrorHandlers.splice(t,1)}}var Oa=100,Dn=function(e){return e()};function Ea(){if(x.inBatch>0||x.isRunningReactions)return;Dn(Gu)}function Gu(){x.isRunningReactions=!0;for(var e=x.pendingReactions,t=0;e.length>0;){++t===Oa&&(console.error("Reaction doesn't converge to a stable state after "+Oa+" iterations."+(" Probably there is a cycle in the reactive function: "+e[0])),e.splice(0));for(var i=e.splice(0),r=0,o=i.length;r<o;r++)i[r].runReaction()}x.isRunningReactions=!1}var Jr=Wt("Reaction",hr);function qu(e){var t=Dn;Dn=function(i){return e(function(){return t(i)})}}function we(){return!!x.spyListeners.length}function pi(e){if(!x.spyListeners.length)return;for(var t=x.spyListeners,i=0,r=t.length;i<r;i++)t[i](e)}function Ne(e){var t=J(J({},e),{spyReportStart:!0});pi(t)}var Xu={spyReportEnd:!0};function He(e){pi(e?J(J({},e),{spyReportEnd:!0}):Xu)}function Aa(e){return x.spyListeners.push(e),rn(function(){x.spyListeners=x.spyListeners.filter(function(t){return t!==e})})}function Ku(){L(!1)}function Ra(e){return function(t,i,r){if(r){if(r.value)return{value:qt(e,r.value),enumerable:!1,configurable:!0,writable:!0};var o=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return qt(e,o.call(this))}}}return Yu(e).apply(this,arguments)}}function Yu(e){return function(t,i,r){Object.defineProperty(t,i,{configurable:!0,enumerable:!1,get:function(){return},set:function(o){It(this,i,Xt(e,o))}})}}function Ju(e,t,i,r){return r===!0?(wn(e,t,i.value),null):i?{configurable:!0,enumerable:!1,get:function(){return wn(this,t,i.value||i.initializer.call(this)),this[t]},set:Ku}:{enumerable:!1,configurable:!0,set:function(o){wn(this,t,o)},get:function(){return}}}var Xt=function(t,i,r,o){if(arguments.length===1&&typeof t=="function")return qt(t.name||"<unnamed action>",t);if(arguments.length===2&&typeof i=="function")return qt(t,i);if(arguments.length===1&&typeof t=="string")return Ra(t);if(o===!0)t[i]=qt(t.name||i,r.value);else return Ra(i).apply(null,arguments)};Xt.bound=Ju;function Zu(e,t){var i=typeof e=="string"?e:e.name||"<unnamed action>",r=typeof e=="function"?e:t;return Da(i,r,this,void 0)}function Qu(e){return typeof e=="function"&&e.isMobxAction===!0}function wn(e,t,i){It(e,t,qt(t,i.bind(e)))}function Sn(e,t){t===void 0&&(t=tn);var i=t&&t.name||e.name||"Autorun@"+Fe(),r=!t.scheduler&&!t.delay,o;if(r)o=new hr(i,function(){this.track(l)},t.onError,t.requiresObservable);else{var n=Ma(t),a=!1;o=new hr(i,function(){a||(a=!0,n(function(){a=!1,o.isDisposed||o.track(l)}))},t.onError,t.requiresObservable)}function l(){e(o)}return o.schedule(),o.getDisposer()}var eh=function(e){return e()};function Ma(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:eh}function ih(e,t,i){i===void 0&&(i=tn),typeof i=="boolean"&&(i={fireImmediately:i},it("Using fireImmediately as argument is deprecated. Use '{ fireImmediately: true }' instead"));var r=i.name||"Reaction@"+Fe(),o=Xt(r,i.onError?th(i.onError,t):t),n=!i.scheduler&&!i.delay,a=Ma(i),l=!0,c=!1,d,u=i.compareStructural?ui.structural:i.equals||ui.default,g=new hr(r,function(){l||n?y():c||(c=!0,a(y))},i.onError,i.requiresObservable);function y(){if(c=!1,g.isDisposed)return;var E=!1;g.track(function(){var D=e(g);E=l||!u(d,D),d=D}),l&&i.fireImmediately&&o(d,g),!l&&E===!0&&o(d,g),l&&(l=!1)}return g.schedule(),g.getDisposer()}function th(e,t){return function(){try{return t.apply(this,arguments)}catch(i){e.call(this,i)}}}function sa(e,t,i){return za("onBecomeObserved",e,t,i)}function ln(e,t,i){return za("onBecomeUnobserved",e,t,i)}function za(e,t,i,r){var o=typeof r=="function"?ct(t,i):ct(t),n=typeof r=="function"?r:i,a=o[e];return typeof a!="function"?L(!1):(o[e]=function(){a.call(this),n.call(this)},function(){o[e]=a})}function rh(e){var t=e.enforceActions,i=e.computedRequiresReaction,r=e.computedConfigurable,o=e.disableErrorBoundaries,n=e.arrayBuffer,a=e.reactionScheduler,l=e.reactionRequiresObservable,c=e.observableRequiresReaction;if(e.isolateGlobalState===!0&&Hu(),t!==void 0){(typeof t=="boolean"||t==="strict")&&it(`Deprecated value for 'enforceActions', use 'false' => '"never"', 'true' => '"observed"', '"strict"' => "'always'" instead`);var d=void 0;switch(t){case!0:case"observed":d=!0;break;case!1:case"never":d=!1;break;case"strict":case"always":d="strict";break;default:L("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}x.enforceActions=d,x.allowStateChanges=!(d===!0||d==="strict")}i!==void 0&&(x.computedRequiresReaction=!!i),l!==void 0&&(x.reactionRequiresObservable=!!l),c!==void 0&&(x.observableRequiresReaction=!!c,x.allowStateReads=!x.observableRequiresReaction),r!==void 0&&(x.computedConfigurable=!!r),o!==void 0&&(o===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),x.disableErrorBoundaries=!!o),typeof n=="number"&&xn(n),a&&qu(a)}function oh(e,t){var i=typeof e=="function"?e.prototype:e,r=function(n){var a=t[n];Array.isArray(a)||(a=[a]);var l=Object.getOwnPropertyDescriptor(i,n),c=a.reduce(function(d,u){return u(i,n,d)},l);c&&Object.defineProperty(i,n,c)};for(var o in t)r(o);return e}function nh(e,t,i){return it("'extendShallowObservable' is deprecated, use 'extendObservable(target, props, { deep: false })' instead"),mn(e,t,i,pa)}function mn(e,t,i,r){if(!1&&i)for(var o in i);r=ki(r);var n=r.defaultDecorator||(r.deep===!1?fa:fn);hi(e),Cn(e,r.name,n.enhancer),ot();try{for(var a=Object.getOwnPropertyNames(t),l=0,c=a.length;l<c;l++){var o=a[l],d=Object.getOwnPropertyDescriptor(t,o),u=i&&o in i?i[o]:d.get?Gr:n,g=u(e,o,d,!0);g&&Object.defineProperty(e,o,g)}}finally{nt()}return e}function Fa(e,t){return Pa(ct(e,t))}function Pa(e){var t={name:e.name};return e.observing&&e.observing.length>0&&(t.dependencies=au(e.observing).map(Pa)),t}function sh(e,t){return Ba(ct(e,t))}function Ba(e){var t={name:e.name};return Wu(e)&&(t.observers=$u(e).map(Ba)),t}var ah=0;function Zr(){this.message="FLOW_CANCELLED"}Zr.prototype=Object.create(Error.prototype);function lh(e){return e instanceof Zr}function ch(e){arguments.length!==1&&L("Flow expects one 1 argument and cannot be used as decorator");var t=e.name||"<unnamed flow>";return function(){var i=this,r=arguments,o=++ah,n=Xt(t+" - runid: "+o+" - init",e).apply(i,r),a,l=void 0,c=new Promise(function(d,u){var g=0;a=u;function y(T){l=void 0;var z;try{z=Xt(t+" - runid: "+o+" - yield "+g++,n.next).call(n,T)}catch(K){return u(K)}D(z)}function E(T){l=void 0;var z;try{z=Xt(t+" - runid: "+o+" - yield "+g++,n.throw).call(n,T)}catch(K){return u(K)}D(z)}function D(T){if(T&&typeof T.then=="function"){T.then(D,u);return}return T.done?d(T.value):(l=Promise.resolve(T.value),l.then(y,E))}y(void 0)});return c.cancel=Xt(t+" - runid: "+o+" - cancel",function(){try{l&&La(l);var d=n.return(void 0),u=Promise.resolve(d.value);u.then(jr,jr),La(u),a(new Zr)}catch(g){a(g)}}),c}}function La(e){typeof e.cancel=="function"&&e.cancel()}function dh(e,t,i){var r;if(ge(e)||Ee(e)||vn(e))r=wt(e);else if(Oe(e)){if(typeof t!="string")return L(!1);r=wt(e,t)}else return L(!1);return r.dehancer!==void 0?L(!1):(r.dehancer=typeof t=="function"?t:i,function(){r.dehancer=void 0})}function ph(e,t,i){return typeof i=="function"?hh(e,t,i):uh(e,t)}function uh(e,t){return wt(e).intercept(t)}function hh(e,t,i){return wt(e,t).intercept(i)}function Na(e,t){if(e==null)return!1;if(t!==void 0){if(Oe(e)===!1)return!1;if(!e.$mobx.values[t])return!1;var i=ct(e,t);return Ii(i)}return Ii(e)}function fh(e){return arguments.length>1?L(!1):Na(e)}function mh(e,t){return typeof t!="string"?L(!1):Na(e,t)}function Ha(e,t){if(e==null)return!1;if(t!==void 0){if(Oe(e)){var i=e.$mobx;return i.values&&!!i.values[t]}return!1}return Oe(e)||!!e.$mobx||an(e)||Jr(e)||Ii(e)}function Ei(e){return arguments.length!==1&&L(!1),Ha(e)}function gh(e,t){return typeof t!="string"?L(!1):Ha(e,t)}function Ai(e){return Oe(e)?e.$mobx.getKeys():ge(e)||Ie(e)?rt(e.keys()):Ee(e)?e.map(function(t,i){return i}):L(!1)}function bh(e){return Oe(e)?Ai(e).map(function(t){return e[t]}):ge(e)?Ai(e).map(function(t){return e.get(t)}):Ie(e)?rt(e.values()):Ee(e)?e.slice():L(!1)}function yh(e){return Oe(e)?Ai(e).map(function(t){return[t,e[t]]}):ge(e)?Ai(e).map(function(t){return[t,e.get(t)]}):Ie(e)?rt(e.entries()):Ee(e)?e.map(function(t,i){return[i,t]}):L(!1)}function ja(e,t,i){if(arguments.length===2&&!Ie(e)){ot();var r=t;try{for(var o in r)ja(e,o,r[o])}finally{nt()}return}if(Oe(e)){var n=e.$mobx,a=n.values[t];a?n.write(e,t,i):ua(e,t,i,n.defaultEnhancer)}else if(ge(e))e.set(t,i);else if(Ie(e))e.add(t);else if(Ee(e))typeof t!="number"&&(t=parseInt(t,10)),Pe(t>=0,"Not a valid index: '"+t+"'"),ot(),t>=e.length&&(e.length=t+1),e[t]=i,nt();else return L(!1)}function vh(e,t){if(Oe(e))e.$mobx.remove(t);else if(ge(e))e.delete(t);else if(Ie(e))e.delete(t);else if(Ee(e))typeof t!="number"&&(t=parseInt(t,10)),Pe(t>=0,"Not a valid index: '"+t+"'"),e.splice(t,1);else return L(!1)}function Ua(e,t){if(Oe(e)){var i=wt(e);return i.getKeys(),!!i.values[t]}else return ge(e)||Ie(e)?e.has(t):Ee(e)?t>=0&&t<e.length:L(!1)}function Sh(e,t){return Ua(e,t)?Oe(e)?e[t]:ge(e)?e.get(t):Ee(e)?e[t]:L(!1):void 0}function xh(e,t,i,r){return typeof i=="function"?wh(e,t,i,r):Dh(e,t,i)}function Dh(e,t,i){return wt(e).observe(t,i)}function wh(e,t,i,r){return wt(e,t).observe(i,r)}var Ch={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function Ri(e,t,i,r){return r.detectCycles&&e.set(t,i),i}function Kt(e,t,i){if(!t.recurseEverything&&!Ei(e))return e;if(typeof e!="object")return e;if(e===null)return null;if(e instanceof Date)return e;if(vn(e))return Kt(e.get(),t,i);Ei(e)&&Ai(e);var r=t.detectCycles===!0;if(r&&e!==null&&i.has(e))return i.get(e);if(Ee(e)||Array.isArray(e)){var o=Ri(i,e,[],t),n=e.map(function(D){return Kt(D,t,i)});o.length=n.length;for(var a=0,l=n.length;a<l;a++)o[a]=n[a];return o}if(Ie(e)||Object.getPrototypeOf(e)===Set.prototype)if(t.exportMapsAsObjects===!1){var c=Ri(i,e,new Set,t);return e.forEach(function(D){c.add(Kt(D,t,i))}),c}else{var d=Ri(i,e,[],t);return e.forEach(function(D){d.push(Kt(D,t,i))}),d}if(ge(e)||Object.getPrototypeOf(e)===Map.prototype)if(t.exportMapsAsObjects===!1){var u=Ri(i,e,new Map,t);return e.forEach(function(D,T){u.set(T,Kt(D,t,i))}),u}else{var g=Ri(i,e,{},t);return e.forEach(function(D,T){g[T]=Kt(D,t,i)}),g}var y=Ri(i,e,{},t);for(var E in e)y[E]=Kt(e[E],t,i);return y}function _h(e,t){typeof t=="boolean"&&(t={detectCycles:t}),t||(t=Ch),t.detectCycles=t.detectCycles===void 0?t.recurseEverything===!0:t.detectCycles===!0;var i;return t.detectCycles&&(i=new Map),Kt(e,t,i)}function Ia(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;typeof e[e.length-1]=="boolean"&&(i=e.pop());var r=Eh(e);if(!r)return L(!1);r.isTracing===st.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled"),r.isTracing=i?st.BREAK:st.LOG}function Eh(e){switch(e.length){case 0:return x.trackingDerivation;case 1:return ct(e[0]);case 2:return ct(e[0],e[1])}}function xt(e,t){t===void 0&&(t=void 0),ot();try{return e.apply(t)}finally{nt()}}function Th(e,t,i){return arguments.length===1||t&&typeof t=="object"?kh(e,t):Wa(e,t,i||{})}function Wa(e,t,i){var r;typeof i.timeout=="number"&&(r=setTimeout(function(){if(!n.$mobx.isDisposed){n();var a=new Error("WHEN_TIMEOUT");if(i.onError)i.onError(a);else throw a}},i.timeout)),i.name=i.name||"When@"+Fe();var o=qt(i.name+"-effect",t),n=Sn(function(a){e()&&(a.dispose(),r&&clearTimeout(r),o())},i);return n}function kh(e,t){var i,r=new Promise(function(o,n){var a=Wa(e,o,J(J({},t),{onError:n}));i=function(){a(),n("WHEN_CANCELLED")}});return r.cancel=i,r}function St(e){return e.interceptors!==void 0&&e.interceptors.length>0}function cr(e,t){var i=e.interceptors||(e.interceptors=[]);return i.push(t),rn(function(){var r=i.indexOf(t);r!==-1&&i.splice(r,1)})}function Dt(e,t){var i=Ti();try{var r=e.interceptors;if(r)for(var o=0,n=r.length;o<n&&!(t=r[o](t),Pe(!t||t.type,"Intercept handlers should return nothing or a change object"),!t);o++);return t}finally{Gt(i)}}function at(e){return e.changeListeners!==void 0&&e.changeListeners.length>0}function dr(e,t){var i=e.changeListeners||(e.changeListeners=[]);return i.push(t),rn(function(){var r=i.indexOf(t);r!==-1&&i.splice(r,1)})}function lt(e,t){var i=Ti(),r=e.changeListeners;if(!r)return;r=r.slice();for(var o=0,n=r.length;o<n;o++)r[o](t);Gt(i)}var Fh=1e4,Ih=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)["0"]=1,e===!1}(),_n=0,En=function(){function e(){}return e}();function Oh(e,t){typeof Object.setPrototypeOf!="undefined"?Object.setPrototypeOf(e.prototype,t):typeof e.prototype.__proto__!="undefined"?e.prototype.__proto__=t:e.prototype=t}Oh(En,Array.prototype);Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(e){Object.defineProperty(En.prototype,e,{configurable:!0,writable:!0,value:Array.prototype[e]})});var $a=function(){function e(t,i,r,o){this.array=r,this.owned=o,this.values=[],this.lastKnownLength=0,this.atom=new Ur(t||"ObservableArray@"+Fe()),this.enhancer=function(n,a){return i(n,a,t+"[..]")}}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.dehanceValues=function(t){return this.dehancer!==void 0&&t.length>0?t.map(this.dehancer):t},e.prototype.intercept=function(t){return cr(this,t)},e.prototype.observe=function(t,i){return i===void 0&&(i=!1),i&&t({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),dr(this,t)},e.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},e.prototype.setArrayLength=function(t){if(typeof t!="number"||t<0)throw new Error("[mobx.array] Out of range: "+t);var i=this.values.length;if(t===i)return;if(t>i){for(var r=new Array(t-i),o=0;o<t-i;o++)r[o]=void 0;this.spliceWithArray(i,0,r)}else this.spliceWithArray(t,i-t)},e.prototype.updateArrayLength=function(t,i){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=i,i>0&&t+i+1>_n&&xn(t+i+1)},e.prototype.spliceWithArray=function(t,i,r){var o=this;Oi(this.atom);var n=this.values.length;if(t===void 0?t=0:t>n?t=n:t<0&&(t=Math.max(0,n+t)),arguments.length===1?i=n-t:i==null?i=0:i=Math.max(0,Math.min(i,n-t)),r===void 0&&(r=Hr),St(this)){var a=Dt(this,{object:this.array,type:"splice",index:t,removedCount:i,added:r});if(!a)return Hr;i=a.removedCount,r=a.added}r=r.length===0?r:r.map(function(d){return o.enhancer(d,void 0)});var l=r.length-i;this.updateArrayLength(n,l);var c=this.spliceItemsIntoValues(t,i,r);return(i!==0||r.length!==0)&&this.notifyArraySplice(t,r,c),this.dehanceValues(c)},e.prototype.spliceItemsIntoValues=function(t,i,r){var o;if(r.length<Fh)return(o=this.values).splice.apply(o,pn([t,i],r));var n=this.values.slice(t,t+i);return this.values=this.values.slice(0,t).concat(r,this.values.slice(t+i)),n},e.prototype.notifyArrayChildUpdate=function(t,i,r){var o=!this.owned&&we(),n=at(this),a=n||o?{object:this.array,type:"update",index:t,newValue:i,oldValue:r}:null;o&&Ne(J(J({},a),{name:this.atom.name})),this.atom.reportChanged(),n&&lt(this,a),o&&He()},e.prototype.notifyArraySplice=function(t,i,r){var o=!this.owned&&we(),n=at(this),a=n||o?{object:this.array,type:"splice",index:t,removed:r,added:i,removedCount:r.length,addedCount:i.length}:null;o&&Ne(J(J({},a),{name:this.atom.name})),this.atom.reportChanged(),n&&lt(this,a),o&&He()},e}(),vt=function(e){la(t,e);function t(i,r,o,n){o===void 0&&(o="ObservableArray@"+Fe()),n===void 0&&(n=!1);var a=e.call(this)||this,l=new $a(o,r,a,n);if(er(a,"$mobx",l),i&&i.length){var c=ar(!0);a.spliceWithArray(0,0,i),lr(c)}return Ih&&Object.defineProperty(l.array,"0",Ah),a}return t.prototype.intercept=function(i){return this.$mobx.intercept(i)},t.prototype.observe=function(i,r){return r===void 0&&(r=!1),this.$mobx.observe(i,r)},t.prototype.clear=function(){return this.splice(0)},t.prototype.concat=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),i.map(function(o){return Ee(o)?o.peek():o}))},t.prototype.replace=function(i){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,i)},t.prototype.toJS=function(){return this.slice()},t.prototype.toJSON=function(){return this.toJS()},t.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},t.prototype.find=function(i,r,o){o===void 0&&(o=0),arguments.length===3&&it("The array.find fromIndex argument to find will not be supported anymore in the next major");var n=this.findIndex.apply(this,arguments);return n===-1?void 0:this.get(n)},t.prototype.findIndex=function(i,r,o){o===void 0&&(o=0),arguments.length===3&&it("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");for(var n=this.peek(),a=n.length,l=o;l<a;l++)if(i.call(r,n[l],l,this))return l;return-1},t.prototype.splice=function(i,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(i);case 2:return this.$mobx.spliceWithArray(i,r)}return this.$mobx.spliceWithArray(i,r,o)},t.prototype.spliceWithArray=function(i,r,o){return this.$mobx.spliceWithArray(i,r,o)},t.prototype.push=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(o.values.length,0,i),o.values.length},t.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},t.prototype.shift=function(){return this.splice(0,1)[0]},t.prototype.unshift=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(0,0,i),o.values.length},t.prototype.reverse=function(){var i=this.slice();return i.reverse.apply(i,arguments)},t.prototype.sort=function(i){var r=this.slice();return r.sort.apply(r,arguments)},t.prototype.remove=function(i){var r=this.$mobx.dehanceValues(this.$mobx.values).indexOf(i);return r>-1?(this.splice(r,1),!0):!1},t.prototype.move=function(i,r){it("observableArray.move is deprecated, use .slice() & .replace() instead");function o(l){if(l<0)throw new Error("[mobx.array] Index out of bounds: "+l+" is negative");var c=this.$mobx.values.length;if(l>=c)throw new Error("[mobx.array] Index out of bounds: "+l+" is not smaller than "+c)}if(o.call(this,i),o.call(this,r),i===r)return;var n=this.$mobx.values,a;i<r?a=pn(n.slice(0,i),n.slice(i+1,r+1),[n[i]],n.slice(r+1)):a=pn(n.slice(0,r),[n[i]],n.slice(r,i),n.slice(i+1)),this.replace(a)},t.prototype.get=function(i){var r=this.$mobx;if(r){if(i<r.values.length)return r.atom.reportObserved(),r.dehanceValue(r.values[i]);console.warn("[mobx.array] Attempt to read an array index ("+i+") that is out of bounds ("+r.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}return},t.prototype.set=function(i,r){var o=this.$mobx,n=o.values;if(i<n.length){Oi(o.atom);var a=n[i];if(St(o)){var l=Dt(o,{type:"update",object:this,index:i,newValue:r});if(!l)return;r=l.newValue}r=o.enhancer(r,a);var c=r!==a;c&&(n[i]=r,o.notifyArrayChildUpdate(i,r,a))}else if(i===n.length)o.spliceWithArray(i,0,[r]);else throw new Error("[mobx.array] Index out of bounds, "+i+" is larger than "+n.length)},t}(En);nn(vt.prototype,function(){this.$mobx.atom.reportObserved();var e=this,t=0;return ir({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})});Object.defineProperty(vt.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(e){this.$mobx.setArrayLength(e)}});It(vt.prototype,sn(),"Array");["indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(e){var t=Array.prototype[e];Pe(typeof t=="function","Base function not defined on Array prototype: '"+e+"'"),It(vt.prototype,e,function(){return t.apply(this.peek(),arguments)})});["every","filter","forEach","map","some"].forEach(function(e){var t=Array.prototype[e];Pe(typeof t=="function","Base function not defined on Array prototype: '"+e+"'"),It(vt.prototype,e,function(i,r){var o=this,n=this.$mobx;n.atom.reportObserved();var a=n.dehanceValues(n.values);return a[e](function(l,c){return i.call(r,l,c,o)},r)})});["reduce","reduceRight"].forEach(function(e){It(vt.prototype,e,function(){var t=this,i=this.$mobx;i.atom.reportObserved();var r=arguments[0];return arguments[0]=function(o,n,a){return n=i.dehanceValue(n),r(o,n,a,t)},i.values[e].apply(i.values,arguments)})});cu(vt.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var Ah=Va(0);function Va(e){return{enumerable:!1,configurable:!1,get:function(){return this.get(e)},set:function(t){this.set(e,t)}}}function Rh(e){Object.defineProperty(vt.prototype,""+e,Va(e))}function xn(e){for(var t=_n;t<e;t++)Rh(t);_n=e}xn(1e3);var Mh=Wt("ObservableArrayAdministration",$a);function Ee(e){return on(e)&&Mh(e.$mobx)}var zh={},or=function(){function e(t,i,r){if(i===void 0&&(i=rr),r===void 0&&(r="ObservableMap@"+Fe()),this.enhancer=i,this.name=r,this.$mobx=zh,this._keysAtom=cn(this.name+".keys()"),typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return e.prototype._has=function(t){return this._data.has(t)},e.prototype.has=function(t){var i=this;if(!x.trackingDerivation)return this._has(t);var r=this._hasMap.get(t);if(!r){var o=r=new $t(this._has(t),Wr,this.name+"."+Qr(t)+"?",!1);this._hasMap.set(t,o),ln(o,function(){return i._hasMap.delete(t)})}return r.get()},e.prototype.set=function(t,i){var r=this._has(t);if(St(this)){var o=Dt(this,{type:r?"update":"add",object:this,newValue:i,name:t});if(!o)return this;i=o.newValue}return r?this._updateValue(t,i):this._addValue(t,i),this},e.prototype.delete=function(t){var i=this;if(Oi(this._keysAtom),St(this)){var r=Dt(this,{type:"delete",object:this,name:t});if(!r)return!1}if(this._has(t)){var o=we(),n=at(this),r=n||o?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return o&&Ne(J(J({},r),{name:this.name,key:t})),xt(function(){i._keysAtom.reportChanged(),i._updateHasMapEntry(t,!1);var l=i._data.get(t);l.setNewValue(void 0),i._data.delete(t)}),n&&lt(this,r),o&&He(),!0}return!1},e.prototype._updateHasMapEntry=function(t,i){var r=this._hasMap.get(t);r&&r.setNewValue(i)},e.prototype._updateValue=function(t,i){var r=this._data.get(t);if(i=r.prepareNewValue(i),i!==x.UNCHANGED){var o=we(),n=at(this),a=n||o?{type:"update",object:this,oldValue:r.value,name:t,newValue:i}:null;o&&Ne(J(J({},a),{name:this.name,key:t})),r.setNewValue(i),n&&lt(this,a),o&&He()}},e.prototype._addValue=function(t,i){var r=this;Oi(this._keysAtom),xt(function(){var l=new $t(i,r.enhancer,r.name+"."+Qr(t),!1);r._data.set(t,l),i=l.value,r._updateHasMapEntry(t,!0),r._keysAtom.reportChanged()});var o=we(),n=at(this),a=n||o?{type:"add",object:this,name:t,newValue:i}:null;o&&Ne(J(J({},a),{name:this.name,key:t})),n&&lt(this,a),o&&He()},e.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},e.prototype.values=function(){var t=this,i=this.keys();return ir({next:function(){var r=i.next(),o=r.done,n=r.value;return{done:o,value:o?void 0:t.get(n)}}})},e.prototype.entries=function(){var t=this,i=this.keys();return ir({next:function(){var r=i.next(),o=r.done,n=r.value;return{done:o,value:o?void 0:[n,t.get(n)]}}})},e.prototype.forEach=function(t,i){var r=this;this._keysAtom.reportObserved(),this._data.forEach(function(o,n){return t.call(i,r.get(n),n,r)})},e.prototype.merge=function(t){var i=this;return ge(t)&&(t=t.toJS()),xt(function(){var r=ar(!0);try{di(t)?Object.keys(t).forEach(function(o){return i.set(o,t[o])}):Array.isArray(t)?t.forEach(function(o){var n=hn(o,2),a=n[0],l=n[1];return i.set(a,l)}):_i(t)?t.constructor!==Map?L("Cannot initialize from classes that inherit from Map: "+t.constructor.name):t.forEach(function(o,n){return i.set(n,o)}):t!=null&&L("Cannot initialize map from "+t)}finally{lr(r)}}),this},e.prototype.clear=function(){var t=this;xt(function(){yn(function(){t._data.forEach(function(i,r){return t.delete(r)})})})},e.prototype.replace=function(t){var i=this;return xt(function(){var r=lu(t),o=new Map,n=!1;if(ra(i._data.keys(),function(u){if(!r.has(u)){var g=i.delete(u);if(g)n=!0;else{var y=i._data.get(u);o.set(u,y)}}}),ra(r.entries(),function(u){var g=hn(u,2),y=g[0],E=g[1],D=i._data.has(y);if(i.set(y,E),i._data.has(y)){var T=i._data.get(y);o.set(y,T),D||(n=!0)}}),!n)if(i._data.size!==o.size)i._keysAtom.reportChanged();else for(var a=i._data.keys(),l=o.keys(),c=a.next(),d=l.next();!c.done;){if(c.value!==d.value){i._keysAtom.reportChanged();break}c=a.next(),d=l.next()}i._data=o}),this},Object.defineProperty(e.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.toPOJO=function(){var t=this,i={};return this.forEach(function(r,o){return i[typeof o=="symbol"?o:Qr(o)]=t.get(o)}),i},e.prototype.toJS=function(){return new Map(this)},e.prototype.toJSON=function(){return this.toPOJO()},e.prototype.toString=function(){var t=this;return this.name+"[{ "+rt(this.keys()).map(function(i){return Qr(i)+": "+(""+t.get(i))}).join(", ")+" }]"},e.prototype.observe=function(t,i){return dr(this,t)},e.prototype.intercept=function(t){return cr(this,t)},e}();function Qr(e){return e&&e.toString?e.toString():new String(e).toString()}nn(or.prototype,function(){return this.entries()});er(or.prototype,sn(),"Map");var ge=Wt("ObservableMap",or),Ph={},nr=function(){function e(t,i,r){if(i===void 0&&(i=rr),r===void 0&&(r="ObservableSet@"+Fe()),this.name=r,this.$mobx=Ph,this._data=new Set,this._atom=cn(this.name),typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(o,n){return i(o,n,r)},t&&this.replace(t)}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.clear=function(){var t=this;xt(function(){yn(function(){t._data.forEach(function(i){t.delete(i)})})})},e.prototype.forEach=function(t,i){var r=this;this._atom.reportObserved(),this._data.forEach(function(o){t.call(i,o,o,r)})},Object.defineProperty(e.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.add=function(t){var i=this;if(Oi(this._atom),St(this)){var r=Dt(this,{type:"add",object:this,newValue:t});if(!r)return this}if(!this.has(t)){xt(function(){i._data.add(i.enhancer(t,void 0)),i._atom.reportChanged()});var o=we(),n=at(this),r=n||o?{type:"add",object:this,newValue:t}:null;o&&!1&&Ne(r),n&&lt(this,r),o&&!1&&He()}return this},e.prototype.delete=function(t){var i=this;if(St(this)){var r=Dt(this,{type:"delete",object:this,oldValue:t});if(!r)return!1}if(this.has(t)){var o=we(),n=at(this),r=n||o?{type:"delete",object:this,oldValue:t}:null;return o&&!1&&Ne(J(J({},r),{name:this.name})),xt(function(){i._atom.reportChanged(),i._data.delete(t)}),n&&lt(this,r),o&&!1&&He(),!0}return!1},e.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},e.prototype.entries=function(){var t=0,i=rt(this.keys()),r=rt(this.values());return ir({next:function(){var o=t;return t+=1,o<r.length?{value:[i[o],r[o]],done:!1}:{done:!0}}})},e.prototype.keys=function(){return this.values()},e.prototype.values=function(){this._atom.reportObserved();var t=this,i=0,r;return this._data.values!==void 0?r=rt(this._data.values()):(r=[],this._data.forEach(function(o){return r.push(o)})),ir({next:function(){return i<r.length?{value:t.dehanceValue(r[i++]),done:!1}:{done:!0}}})},e.prototype.replace=function(t){var i=this;return Ie(t)&&(t=t.toJS()),xt(function(){var r=ar(!0);try{Array.isArray(t)?(i.clear(),t.forEach(function(o){return i.add(o)})):tr(t)?(i.clear(),t.forEach(function(o){return i.add(o)})):t!=null&&L("Cannot initialize set from "+t)}finally{lr(r)}}),this},e.prototype.observe=function(t,i){return dr(this,t)},e.prototype.intercept=function(t){return cr(this,t)},e.prototype.toJS=function(){return new Set(this)},e.prototype.toString=function(){return this.name+"[ "+rt(this.keys()).join(", ")+" ]"},e}();nn(nr.prototype,function(){return this.values()});er(nr.prototype,sn(),"Set");var Ie=Wt("ObservableSet",nr),Ga=function(){function e(t,i,r){this.target=t,this.name=i,this.defaultEnhancer=r,this.values={}}return e.prototype.read=function(t,i){return this.target!==t&&(this.illegalAccess(t,i),!this.values[i])?void 0:this.values[i].get()},e.prototype.write=function(t,i,r){var o=this.target;o!==t&&this.illegalAccess(t,i);var n=this.values[i];if(n instanceof Vt){n.set(r);return}if(St(this)){var a=Dt(this,{type:"update",object:o,name:i,newValue:r});if(!a)return;r=a.newValue}if(r=n.prepareNewValue(r),r!==x.UNCHANGED){var l=at(this),c=we(),a=l||c?{type:"update",object:o,oldValue:n.value,name:i,newValue:r}:null;c&&Ne(J(J({},a),{name:this.name,key:i})),n.setNewValue(r),l&&lt(this,a),c&&He()}},e.prototype.remove=function(t){if(!this.values[t])return;var i=this.target;if(St(this)){var r=Dt(this,{object:i,name:t,type:"remove"});if(!r)return}try{ot();var o=at(this),n=we(),a=this.values[t].get();this.keys&&this.keys.remove(t),delete this.values[t],delete this.target[t];var r=o||n?{type:"remove",object:i,oldValue:a,name:t}:null;n&&Ne(J(J({},r),{name:this.name,key:t})),o&&lt(this,r),n&&He()}finally{nt()}},e.prototype.illegalAccess=function(t,i){console.warn("Property '"+i+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},e.prototype.observe=function(t,i){return dr(this,t)},e.prototype.intercept=function(t){return cr(this,t)},e.prototype.getKeys=function(){var t=this;return this.keys===void 0&&(this.keys=new vt(Object.keys(this.values).filter(function(i){return t.values[i]instanceof $t}),Wr,"keys("+this.name+")",!0)),this.keys.slice()},e}();function Cn(e,t,i){t===void 0&&(t=""),i===void 0&&(i=rr);var r=e.$mobx;return r||(di(e)||(t=(e.constructor.name||"ObservableObject")+"@"+Fe()),t||(t="ObservableObject@"+Fe()),r=new Ga(e,t,i),er(e,"$mobx",r),r)}function ua(e,t,i,r){var o=Cn(e);if(uu(e,t),St(o)){var n=Dt(o,{object:e,name:t,type:"add",newValue:i});if(!n)return;i=n.newValue}var a=o.values[t]=new $t(i,r,o.name+"."+t,!1);i=a.value,Object.defineProperty(e,t,Bh(t)),o.keys&&o.keys.push(t),Lh(o,e,t,i)}function ku(e,t,i){var r=Cn(e);i.name=r.name+"."+t,i.context=e,r.values[t]=new Vt(i),Object.defineProperty(e,t,Nh(t))}var qa=Object.create(null),Xa=Object.create(null);function Bh(e){return qa[e]||(qa[e]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,e)},set:function(t){this.$mobx.write(this,e,t)}})}function Ka(e){var t=e.$mobx;return t||(hi(e),e.$mobx)}function Nh(e){return Xa[e]||(Xa[e]={configurable:x.computedConfigurable,enumerable:!1,get:function(){return Ka(this).read(this,e)},set:function(t){Ka(this).write(this,e,t)}})}function Lh(e,t,i,r){var o=at(e),n=we(),a=o||n?{type:"add",object:t,name:i,newValue:r}:null;n&&Ne(J(J({},a),{name:e.name,key:i})),o&&lt(e,a),n&&He()}var Hh=Wt("ObservableObjectAdministration",Ga);function Oe(e){return on(e)?(hi(e),Hh(e.$mobx)):!1}function ct(e,t){if(typeof e=="object"&&e!==null){if(Ee(e))return t!==void 0&&L(!1),e.$mobx.atom;if(Ie(e))return e.$mobx;if(ge(e)){var i=e;if(t===void 0)return i._keysAtom;var r=i._data.get(t)||i._hasMap.get(t);return r||L(!1),r}if(hi(e),t&&!e.$mobx&&e[t],Oe(e)){if(!t)return L(!1);var r=e.$mobx.values[t];return r||L(!1),r}if(an(e)||Ii(e)||Jr(e))return e}else if(typeof e=="function"&&Jr(e.$mobx))return e.$mobx;return L(!1)}function wt(e,t){if(e||L("Expecting some object"),t!==void 0)return wt(ct(e,t));if(an(e)||Ii(e)||Jr(e))return e;if(ge(e)||Ie(e))return e;if(hi(e),e.$mobx)return e.$mobx;L(!1)}function eo(e,t){var i;return t!==void 0?i=ct(e,t):Oe(e)||ge(e)||Ie(e)?i=wt(e):i=ct(e),i.name}var Ya=Object.prototype.toString;function dn(e,t,i){return i===void 0&&(i=-1),kn(e,t,i)}function kn(e,t,i,r,o){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var n=typeof e;if(n!=="function"&&n!=="object"&&typeof t!="object")return!1;e=Ja(e),t=Ja(t);var a=Ya.call(e);if(a!==Ya.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e===""+t;case"[object Number]":return+e!==+e?+t!==+t:+e===0?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return typeof Symbol!="undefined"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t)}var l=a==="[object Array]";if(!l){if(typeof e!="object"||typeof t!="object")return!1;var c=e.constructor,d=t.constructor;if(c!==d&&!(typeof c=="function"&&c instanceof c&&typeof d=="function"&&d instanceof d)&&"constructor"in e&&"constructor"in t)return!1}if(i===0)return!1;i<0&&(i=-1),r=r||[],o=o||[];for(var u=r.length;u--;)if(r[u]===e)return o[u]===t;if(r.push(e),o.push(t),l){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!kn(e[u],t[u],i-1,r,o))return!1}else{var g=Object.keys(e),y=void 0;if(u=g.length,Object.keys(t).length!==u)return!1;for(;u--;)if(y=g[u],!(jh(t,y)&&kn(e[y],t[y],i-1,r,o)))return!1}return r.pop(),o.pop(),!0}function Ja(e){return Ee(e)?e.peek():_i(e)||ge(e)||(tr(e)||Ie(e))?rt(e.entries()):e}function jh(e,t){return Object.prototype.hasOwnProperty.call(e,t)}try{}catch(e){var Za=Ci();typeof process=="undefined"&&(Za.process={}),Za.process.env={}}(function(){function e(){}if(e.name!=="testCodeMinification"&&!1&&typeof process!="undefined"&&process.env.IGNORE_MOBX_MINIFY_WARNING!=="true"){var t=["process","env","NODE_ENV"].join(".");console.warn("[mobx] you are running a minified build, but '"+t+"' was not set to 'production' in your bundler. This results in an unnecessarily large and slow bundle")}})();var Qa="$mobx";typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Aa,extras:{getDebugName:eo},$mobx:Qa});if(!1)var _b}),xr=el((Gk,sc)=>{var Gp="Expected a function",ac=0/0,qp="[object Symbol]",Xp=/^\s+|\s+$/g,Kp=/^[-+]0x[0-9a-f]+$/i,Yp=/^0b[01]+$/i,Jp=/^0o[0-7]+$/i,Zp=parseInt,Qp=typeof global=="object"&&global&&global.Object===Object&&global,ef=typeof self=="object"&&self&&self.Object===Object&&self,tf=Qp||ef||Function("return this")(),rf=Object.prototype,of=rf.toString,nf=Math.max,sf=Math.min,us=function(){return tf.Date.now()};function af(e,t,i){var r,o,n,a,l,c,d=0,u=!1,g=!1,y=!0;if(typeof e!="function")throw new TypeError(Gp);t=lc(t)||0,hs(i)&&(u=!!i.leading,g="maxWait"in i,n=g?nf(lc(i.maxWait)||0,t):n,y="trailing"in i?!!i.trailing:y);function E(A){var te=r,_e=o;return r=o=void 0,d=A,a=e.apply(_e,te),a}function D(A){return d=A,l=setTimeout(K,t),u?E(A):a}function T(A){var te=A-c,_e=A-d,yt=t-te;return g?sf(yt,n-_e):yt}function z(A){var te=A-c,_e=A-d;return c===void 0||te>=t||te<0||g&&_e>=n}function K(){var A=us();if(z(A))return re(A);l=setTimeout(K,T(A))}function re(A){return l=void 0,y&&r?E(A):(r=o=void 0,a)}function De(){l!==void 0&&clearTimeout(l),d=0,r=c=o=l=void 0}function Ge(){return l===void 0?a:re(us())}function ze(){var A=us(),te=z(A);if(r=arguments,o=this,c=A,te){if(l===void 0)return D(c);if(g)return l=setTimeout(K,t),E(c)}return l===void 0&&(l=setTimeout(K,t)),a}return ze.cancel=De,ze.flush=Ge,ze}function hs(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function lf(e){return!!e&&typeof e=="object"}function cf(e){return typeof e=="symbol"||lf(e)&&of.call(e)==qp}function lc(e){if(typeof e=="number")return e;if(cf(e))return ac;if(hs(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=hs(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Xp,"");var i=Yp.test(e);return i||Jp.test(e)?Zp(e.slice(2),i?2:8):Kp.test(e)?ac:+e}sc.exports=af}),Er=el((hF,cd)=>{var dd="Expected a function",ud=0/0,Im="[object Symbol]",Om=/^\s+|\s+$/g,Am=/^[-+]0x[0-9a-f]+$/i,Rm=/^0b[01]+$/i,Mm=/^0o[0-7]+$/i,zm=parseInt,Pm=typeof global=="object"&&global&&global.Object===Object&&global,Bm=typeof self=="object"&&self&&self.Object===Object&&self,Lm=Pm||Bm||Function("return this")(),Nm=Object.prototype,Hm=Nm.toString,jm=Math.max,Um=Math.min,Hs=function(){return Lm.Date.now()};function Wm(e,t,i){var r,o,n,a,l,c,d=0,u=!1,g=!1,y=!0;if(typeof e!="function")throw new TypeError(dd);t=hd(t)||0,$o(i)&&(u=!!i.leading,g="maxWait"in i,n=g?jm(hd(i.maxWait)||0,t):n,y="trailing"in i?!!i.trailing:y);function E(A){var te=r,_e=o;return r=o=void 0,d=A,a=e.apply(_e,te),a}function D(A){return d=A,l=setTimeout(K,t),u?E(A):a}function T(A){var te=A-c,_e=A-d,yt=t-te;return g?Um(yt,n-_e):yt}function z(A){var te=A-c,_e=A-d;return c===void 0||te>=t||te<0||g&&_e>=n}function K(){var A=Hs();if(z(A))return re(A);l=setTimeout(K,T(A))}function re(A){return l=void 0,y&&r?E(A):(r=o=void 0,a)}function De(){l!==void 0&&clearTimeout(l),d=0,r=c=o=l=void 0}function Ge(){return l===void 0?a:re(Hs())}function ze(){var A=Hs(),te=z(A);if(r=arguments,o=this,c=A,te){if(l===void 0)return D(c);if(g)return l=setTimeout(K,t),E(c)}return l===void 0&&(l=setTimeout(K,t)),a}return ze.cancel=De,ze.flush=Ge,ze}function $m(e,t,i){var r=!0,o=!0;if(typeof e!="function")throw new TypeError(dd);return $o(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),Wm(e,t,{leading:r,maxWait:t,trailing:o})}function $o(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Vm(e){return!!e&&typeof e=="object"}function Gm(e){return typeof e=="symbol"||Vm(e)&&Hm.call(e)==Im}function hd(e){if(typeof e=="number")return e;if(Gm(e))return ud;if($o(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=$o(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Om,"");var i=Rm.test(e);return i||Mm.test(e)?zm(e.slice(2),i?2:8):Am.test(e)?ud:+e}cd.exports=$m});const tl=(e=kb())=>!!e.match(/iP(hone|od|ad)|AppleWebKit/),il=()=>{const e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return t&&t instanceof WebGLRenderingContext},rl=e=>e.replace(Fb,""),ol=e=>e instanceof HTMLImageElement;class Wh{constructor(){this.enabled=!0;this.threshold=20;this.snapToHorizontalCenter=!0;this.snapToVerticalCenter=!0;this.snapToLeft=.1;this.snapToRight=.1;this.snapToTop=.1;this.snapToBottom=.1}}class $h{constructor(){this.enabled=!0;this.threshold=20;this.angles=[0,45,90,135,180,225,270,315]}}class nl{constructor(){this.position=new Wh;this.rotation=new $h}}class sl{constructor(){this.categories=[];this.flattenCategories=!1}}class al{constructor(){this.categories=[];this.flattenCategories=!1;this.categoryHeaderType=Tn.CARD;this.enablePreviewThumbnails=!1}}class ll{constructor(){this.items=[]}}class cl{constructor(){this.items=[]}}class dl{constructor(){this.enableWebcam=!1;this.enableUpload=!1;this.flattenCategories=!1;this.categoryHeaderType=Tn.CARD}}class ul{constructor(){this.items=[]}}class hl{constructor(){this.categories=[];this.canvasActions=[he.BRING_TO_FRONT,he.FLIP,he.DUPLICATE,he.DELETE];this.flattenCategories=!1;this.categoryHeaderType=Tn.CARD;this.enableCustomUpload=!0;this.customStickerTintMode="none"}}class pl{constructor(){this.fonts=[];this.canvasActions=[he.EDIT,he.BRING_TO_FRONT,he.DUPLICATE,he.DELETE];this.disableAutoScaling=!1}}class fl{constructor(){this.defaultSize=.05;this.defaultHardness=.5}}class ml{constructor(){this.items=[];this.canvasActions=[he.EDIT,he.BRING_TO_FRONT,he.INVERT,he.DUPLICATE,he.DELETE]}}class gl{constructor(){this.categories=[];this.enableRotation=!0;this.enableFlip=!0;this.flattenCategories=!1;this.categoryHeaderType=Tn.TEXT}}const Fn={};Uh(Fn,{isMobile:()=>Wb});const Vh=e=>e.key==="Escape",bl=e=>t=>{Vh(t)&&e(t)},ye=Gb,In=(e,t,[i,r],o=0)=>{const n=e[t];if(n){if(n<i)return console.error(`${t} must be greater than or equal to ${i}`),i;if(n>r)return console.error(`${t} must be less than or equal to ${r}`),r}return n||o},dt=(e,t,i=[1,1,1,1])=>{const r=e[t];let o=!0;return r&&r.forEach(n=>{n<0&&(console.error(`${n} in ${t} must be greater than or equal to 0`),o=!1),n>1&&(console.error(`${n} in ${t} must be less than or equal to 1`),o=!1)}),o&&r||i};const Gh=e=>-e,pr=({rotation:e,flipHorizontally:t,flipVertically:i})=>{let r=e;return t&&(r=On(r)),i&&(r=Gh(r)),r};class yl{constructor(e){this.isEmpty=!1;this.isValid=!1;this.isWhiteLabel=()=>this.isValid&&this.licenseChecker.isWhiteLabel();this.areCustomAssetsAllowed=()=>this.isEmpty||this.isValid&&this.licenseChecker.areCustomAssetsAllowed();e&&e.length!==0?(this.licenseChecker=new An.LicenseChecker(e),this.isValid=this.licenseChecker.validate()):e===""&&(this.isEmpty=!0)}isToolAllowed(e){return this.licenseChecker&&this.isValid?this.licenseChecker.isToolAllowed(e):!0}}const Rn=e=>{let t=Number(e).toString(16);return t.length<2&&(t=`0${t}`),t},vl=(e,t,i)=>{const r=Rn(e*255),o=Rn(t*255),n=Rn(i*255);return`#${r}${o}${n}`},fr=e=>{if(qh(e)){const[t,i,r,o]=e;return`rgba(${t*255}, ${i*255}, ${r*255}, ${o})`}if(Xh(e)){const{r:t,g:i,b:r,a:o}=e;return`rgba(${t*255}, ${i*255}, ${r*255}, ${o})`}if(Kh(e)){const[t,i,r]=e;return vl(t,i,r)}if(Yh(e)){const{r:t,g:i,b:r}=e;return vl(t,i,r)}return e},ut=e=>e.map(t=>({identifier:t.name,color:t.color,colorString:fr(t.color)})),Be={black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],gray:[191/255,191/255,191/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]},Mn={transparent:[0/255,0/255,0/255,0],black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]};const to=[m.LIBRARY,[m.TRANSFORM,m.FILTER,m.ADJUSTMENT],[m.FOCUS,m.FRAME,m.OVERLAY],[m.TEXT,m.TEXT_DESIGN,m.STICKER,m.BRUSH]],zn={license:"",order:"default",language:"en",theme:"dark",layout:"advanced",mainCanvasActions:[he.UNDO,he.REDO,he.EXPORT,he.CLOSE],displayResizeWarning:!1,displayCloseWarning:!0,displayCanvasRendererWarning:!0,displayToolControlBarTitle:!0,engine:{crossOrigin:"anonymous",downscaleOptions:{maxMegaPixels:{desktop:10,mobile:5}},preferredRenderer:il()?"webgl":"canvas"},enableZoom:!0,forceCrop:!1,assetBaseUrl:"assets/",defaultTool:m.FILTER,tools:to,snapping:new nl,filter:new al,focus:new ll,adjustment:new sl,library:new dl,overlay:new ul,sticker:new hl,text:new pl,textdesign:new ml,frame:new cl,brush:new fl,transform:new gl,export:{image:{exportType:Mi.IMAGE,format:At.PNG,quality:.9,enableDownload:!0},filename:"photoeditorsdk-export"},custom:{}};const io={[Xe.BRIGHTNESS]:0,[Xe.SATURATION]:0,[Xe.CONTRAST]:0,[Xe.GAMMA]:0,[Xe.CLARITY]:0,[Xe.EXPOSURE]:0,[Xe.SHADOWS]:0,[Xe.HIGHLIGHTS]:0,[Xe.WHITES]:0,[Xe.BLACKS]:0,[Xe.TEMPERATURE]:0,[Xe.SHARPNESS]:0};const j=h(p()),ht=h(p()),zi=h(p());class mr{constructor(){this.snapshots=[];this.observeIndex=zi.observable.box(-1)}addSnapshot(e){this.index===this.snapshots.length-1?this.snapshots=this.snapshots.concat(JSON.stringify(e)):this.snapshots=[...this.snapshots.slice(0,this.index+1),JSON.stringify(e)],this.observeIndex.set(this.snapshots.length-1)}getCurrentState(){return this.snapshots[this.index]}reset(){this.snapshots=[],this.observeIndex.set(-1)}undo(){return this.canUndo?(this.observeIndex.set(this.index-1),JSON.parse(this.getCurrentState())):null}redo(){return this.canRedo?(this.observeIndex.set(this.index+1),JSON.parse(this.getCurrentState())):null}discardSnapshotsfromIndex(e){e>0&&e<this.snapshots.length-1&&(this.snapshots=this.snapshots.slice(0,e),this.observeIndex.set(this.snapshots.length-1))}get index(){return this.observeIndex.get()}get canUndo(){return this.index>0}get canRedo(){return this.snapshots.length-1>this.index}}s([zi.computed],mr.prototype,"index",1),s([zi.computed],mr.prototype,"canUndo",1),s([zi.computed],mr.prototype,"canRedo",1);var O;(function(e){e.ADD="add",e.EDIT="edit",e.DELETE="delete"})(O||(O={}));class Pi{constructor(e){this.localTransformStartIndex=null;this.awaitHistoryChange=!1;this.isDirtySinceSave=!1;this.undo=()=>k(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;const e=this.appHistoryManager.undo();yield this.applyState(e),this.awaitHistoryChange=!1,this.canUndo||(this.isDirtySinceSave=!1)}});this.redo=()=>k(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;const e=this.appHistoryManager.redo();yield this.applyState(e),this.awaitHistoryChange=!1}});this.editor=e,this.appHistoryManager=new mr}get canUndo(){return this.appHistoryManager.canUndo}get canRedo(){return this.appHistoryManager.canRedo}getHistoryState(){const e=ht.toJS(this.editor.adjustmentsToolStore.state),t=ht.toJS(this.editor.filterToolStore.state),i=this.editor.focusToolStore.getFocusStateForHistory(),r=ht.toJS(this.editor.overlayToolStore.state),o=ht.toJS(this.editor.frameToolStore.state),n=this.editor.brushToolStore.strokes||{strokes:[]},a=this.editor.spriteStore.getSpriteHistoryState(),l=this.editor.transformToolStore.serializableState;return{[m.ADJUSTMENT]:e,[m.FILTER]:t,[m.FOCUS]:i,[m.OVERLAY]:r,[m.FRAME]:o,[m.BRUSH]:n,sprite:a,[m.TRANSFORM]:l}}addInitialSnapshot(){const e=this.getHistoryState();this.appHistoryManager.addSnapshot({state:e,type:O.ADD,description:"Initial State"})}addSnapshot(e=this.getHistoryState(),t,i){e&&((e.sprite||e.transform)&&(e=f(f({},this.getHistoryState()),e)),this.appHistoryManager.addSnapshot({state:e,type:t,description:i}),this.editor.configStore.events.onHistoryChange(),this.isDirtySinceSave||(this.isDirtySinceSave=!0))}saveTransformLocalSnapshotIndex(){this.localTransformStartIndex===null&&(this.localTransformStartIndex=this.appHistoryManager.snapshots.length)}removeTransformLocalSnapshots(){this.localTransformStartIndex!==null&&(this.appHistoryManager.discardSnapshotsfromIndex(this.localTransformStartIndex-1),this.localTransformStartIndex=null)}applyState(t){return k(this,arguments,function*({state:e}){try{if(e){const i=Object.keys(e);for(const r of i)switch(r){case m.FILTER:yield this.editor.filterToolStore.updateStateFromHistory(e[r]);break;case m.ADJUSTMENT:yield this.editor.adjustmentsToolStore.updateStateFromHistory(e[r]);break;case m.OVERLAY:yield this.editor.overlayToolStore.updateStateFromHistory(e[r]);break;case m.FRAME:yield this.editor.frameToolStore.updateStateFromHistory(e[r]);break;case m.FOCUS:yield this.editor.focusToolStore.updateStateFromHistory(e[r],this.editor.canvasStore.sizeVector);break;case m.BRUSH:yield this.editor.brushToolStore.updateStateFromHistory(e[r]);break;case"sprite":yield this.editor.spriteStore.updateStateFromHistory(e[r]);break;case"localTransform":yield this.editor.transformToolStore.updateLocalStateFromHistory(e.localTransform);break;case m.TRANSFORM:this.editor.outputContainer.pauseChildrenUpdates(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(e[r],!1),this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.onLeave(),this.editor.outputContainer.resumeChildrenUpdates(),yield this.editor.wait();break}yield this.editor.renderPromise()}}catch(i){console.error(i),this.editor.modalStore.showActionModal({type:ae.ERROR,identifier:"unexpectedError",error:i,handleConfirm:()=>{window.location.reload()}})}})}isDirty(){return this.appHistoryManager.snapshots.length>1}reset(){this.appHistoryManager.reset(),this.isDirtySinceSave=!1}}s([ht.action],Pi.prototype,"undo",2),s([ht.action],Pi.prototype,"redo",2),s([ht.computed],Pi.prototype,"canUndo",1),s([ht.computed],Pi.prototype,"canRedo",1);class de{constructor(e,t){this.assets=[];this.entityMapper=e=>"items"in e?this.categoryMapper(e):this.itemMapper(e);this.categoryMapper=e=>e?f(f({},e),{thumbnailURI:this.getCategoryURI(e),name:this.config.locale[e.identifier]||e.name,items:e.items.map(this.itemMapper)}):null;this.itemMapper=e=>f(f({},e),{thumbnailURI:this.getItemURI(e),name:this.config.locale[e.identifier]||("name"in e?e.name:"")});this.getCategoryURI=e=>e.thumbnailURI&&(ro(e.thumbnailURI)||e.thumbnailURI.substr(0,10)==="data:image")?e.thumbnailURI:this.config.getAssetPath(e[this.config.categoryKey]||"");this.getItemURI=e=>"thumbnailURI"in e&&(ro(e.thumbnailURI)||e.thumbnailURI.substr(0,10)==="data:image")?e.thumbnailURI:this.config.getAssetPath(e[this.config.itemKey]||"");this.config=t,this.assets=e.map(this.entityMapper).filter(Boolean)}static isCategory(e){return Object.prototype.hasOwnProperty.call(e,"items")}get categories(){return this.assets.reduce((e,t)=>de.isCategory(t)?[...e,t]:void 0,[]).filter(Boolean)}get items(){return this.assets.reduce((e,t)=>de.isCategory(t)?[...e,...t.items]:[...e,t],[]).filter(Boolean)}}const fi=h(p());class Yt{constructor(e,t){this.from=e,this.to=t}contains(e){return this.from<=e&&e<=this.to}clamp(e){return Math.min(Math.max(this.from,e),this.to)}}const Jh=new Yt(-1,1);class gr{constructor(e){this.editAdjustments=({type:e,value:t})=>{const i=Jh.clamp(t);this.state[e]=i};this.reset=()=>{fi.runInAction(()=>{this.indexInContainer===-1&&(Object.keys(io).forEach(e=>{this.state[e]=io[e]}),this.orderHelper.removeIndex(m.ADJUSTMENT))})};this.setAdjustmentEffect=e=>{const t=this.orderHelper.addIndex(m.ADJUSTMENT);return this.effect?this.effect.setProperties(e):this.effect=this.engineMediator.engine.addAdjustments(e,this.engineMediator.image.container,t),this.effect.getProperties()};this.removeAdjustmentEffect=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))};this.engineMediator=e,this.state=io}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get orderHelper(){return this.engineMediator.orderHelper}}s([fi.observable],gr.prototype,"state",2),s([fi.action],gr.prototype,"editAdjustments",2),s([fi.action],gr.prototype,"reset",2);class G{constructor(e){this.dirty=j.observable.box(!1);this.editAdjustments=({type:e,value:t})=>{this.pureSetAdjustment({type:e,value:t}),this.editor.render()};this.toolSnapshot=()=>{this.dirty.set(!0),this.addSnapshot(O.EDIT,m.ADJUSTMENT)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.toggleOptionSelection=e=>{this.selectedOption=e};this.pureSetAdjustment=({type:e,value:t})=>{const i=this.adjustmentsStore.setAdjustmentEffect({[e]:t});this.adjustmentsStore.editAdjustments({type:e,value:i[e]})};this.pureReset=()=>{this.dirty.set(!1),this.adjustmentsStore.removeAdjustmentEffect(),this.adjustmentsStore.reset(),this.selectedOption=""};this.reset=()=>{this.pureReset(),this.addSnapshot(O.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromHistory=e=>{j.runInAction(()=>{Object.keys(e).forEach(t=>{this.pureSetAdjustment({type:t,value:e[t]})})})};this.updateStateFromSerialization=e=>{this.updateStateFromHistory(e)};this.editor=e,this.adjustmentsStore=new gr(this.editor.engineMediator),this.selectedOption="";const t=this.editor.assetProvider.getAssets("adjustment");this.entityManager=new de(t,f(f({},this.config),{categoryKey:"",itemKey:"thumbnailURI",locale:f(f({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("adjustment")}))}get selectedAdjustmentType(){return this.selectedOption}get isDirty(){return this.dirty.get()}get state(){return this.adjustmentsStore.state}get selectedOptionLabel(){const e=this.items.find(t=>t?t.identifier===this.selectedOption:!1);return e?e.name:""}get brightness(){return this.state.brightness}get saturation(){return this.state.saturation}get contrast(){return this.state.contrast}get gamma(){return this.state.gamma}get clarity(){return this.state.clarity}get exposure(){return this.state.exposure}get shadows(){return this.state.shadows}get highlights(){return this.state.highlights}get whites(){return this.state.whites}get blacks(){return this.state.blacks}get temperature(){return this.state.temperature}get sharpness(){return this.state.sharpness}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}get config(){return this.editor.configStore.config[m.ADJUSTMENT]}get locale(){return this.editor.configStore.locale[m.ADJUSTMENT]}}s([j.observable],G.prototype,"selectedOption",2),s([j.observable],G.prototype,"dirty",2),s([j.action],G.prototype,"editAdjustments",2),s([j.action],G.prototype,"toggleOptionSelection",2),s([j.action],G.prototype,"pureSetAdjustment",2),s([j.action],G.prototype,"pureReset",2),s([j.action],G.prototype,"reset",2),s([j.action],G.prototype,"updateStateFromHistory",2),s([j.action],G.prototype,"updateStateFromSerialization",2),s([j.computed],G.prototype,"selectedAdjustmentType",1),s([j.computed],G.prototype,"isDirty",1),s([j.computed],G.prototype,"state",1),s([j.computed],G.prototype,"selectedOptionLabel",1),s([j.computed],G.prototype,"brightness",1),s([j.computed],G.prototype,"saturation",1),s([j.computed],G.prototype,"contrast",1),s([j.computed],G.prototype,"gamma",1),s([j.computed],G.prototype,"clarity",1),s([j.computed],G.prototype,"exposure",1),s([j.computed],G.prototype,"shadows",1),s([j.computed],G.prototype,"highlights",1),s([j.computed],G.prototype,"whites",1),s([j.computed],G.prototype,"blacks",1),s([j.computed],G.prototype,"temperature",1),s([j.computed],G.prototype,"sharpness",1),s([j.computed],G.prototype,"categories",1),s([j.computed],G.prototype,"items",1),s([j.computed],G.prototype,"config",1),s([j.computed],G.prototype,"locale",1);const oe=h(p()),mi=h(p()),oo={identifier:"identity",intensity:1,isDuotone:!1},Zh=new Yt(0,1);class gi{constructor(e){this.changeIdentifier=e=>{this.state.identifier=e};this.changeIfDuotone=e=>{this.state.isDuotone=e};this.changeIntensity=e=>{const t=Zh.clamp(e);this.state.intensity=t};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=oo.identifier,this.state.intensity=oo.intensity,this.removeIndex())};this.setFilterEffect=({identifier:e,intensity:t,isDuotone:i})=>{const r=this.state;this.changeIdentifier(e),this.changeIntensity(t),this.changeIfDuotone(i),this.removeFilterEffect();const o=this.engineMediator.orderHelper.addIndex(m.FILTER);return i?new Promise((n,a)=>{this.engineMediator.engine.addDuoToneFilterFromAssets(e,this.engineMediator.image.container,o).then(l=>{this.effect=l,this.effect.setProperties({colorIntensity:t}),n()}).catch(l=>{this.fallbackOnError(r),a(l)})}):new Promise((n,a)=>{this.engineMediator.engine.addLUTFilterFromAssets(e,this.engineMediator.image.container,o).then(l=>{this.effect=l,this.effect.setProperties({intensity:t}),n()}).catch(l=>{this.fallbackOnError(r),a(l)})})};this.removeFilterEffect=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))};this.setEffectProperties=({intensity:e})=>this.effect?(this.state.isDuotone?this.effect.setProperties({colorIntensity:e}):this.effect.setProperties({intensity:e}),this.effect.getProperties()):null;this.removeIndex=()=>{this.engineMediator.orderHelper.removeIndex(m.FILTER)};this.fallbackOnError=e=>{this.changeIdentifier(e.identifier),this.changeIntensity(e.intensity),e.identifier==="identity"&&this.removeIndex()};this.engineMediator=e,this.state=oo}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}}s([mi.observable],gi.prototype,"state",2),s([mi.action],gi.prototype,"changeIdentifier",2),s([mi.action],gi.prototype,"changeIfDuotone",2),s([mi.action],gi.prototype,"changeIntensity",2),s([mi.action],gi.prototype,"reset",2);const Pn="identity";class le{constructor(e){this.selectFilter=(e,t=1)=>k(this,null,function*(){e!==this.identifier&&(yield this.filterStore.setFilterEffect({identifier:e,intensity:t,isDuotone:this.isOptionDuoTone(e)}),this.editor.render(),this.addSnapshot(O.ADD,m.FILTER))});this.changeIntensity=e=>{const t=this.isOptionDuoTone(this.identifier),i=this.filterStore.setEffectProperties({intensity:e});if(i){const r=t?i.colorIntensity:i.intensity;this.filterStore.changeIntensity(r),this.editor.render()}};this.setImageAndGetPreviews=()=>k(this,null,function*(){const{image:e}=this.editor.activeStore.state;yield this.editor.previewThumbnails.addImageToContainer(e),yield this.getAllFilterPreview()});this.getAllFilterPreview=()=>k(this,null,function*(){const e=this.entityManager.items.map(o=>({identifier:o.identifier,isDuotone:this.isOptionDuoTone(o.identifier)})),t=yield this.editor.previewThumbnails.getAllFilterPreviewThumbnails(e);yield this.editor.wait();const{config:i}=this,r=this.editor.configStore.assetProvider.getAssets("filter").map(o=>f(f({},o),{items:o.items.map(n=>f(f({},n),{thumbnailURI:t[n.identifier]}))}));this.entityManager=new de(r,f(f({},i),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))});this.toolSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.controls.sliderIntensity)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.pureReset=()=>{this.selectedCategory=Pn,this.filterStore.removeFilterEffect(),this.filterStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(O.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory===e?Pn:e};this.updateStateFromSerialization=({identifier:e,intensity:t})=>{const i=this.doesFilterAssetExist(e);if(i){const r=Sl(i);return this.filterStore.setFilterEffect({identifier:e,intensity:t,isDuotone:r})}return new Promise((r,o)=>{o(new Error(`Filter Asset ${e} doesn't exist`))})};this.updateStateFromHistory=e=>k(this,null,function*(){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.filterStore.setFilterEffect(e)});this.doesFilterAssetExist=e=>this.entityManager.items.find(t=>e===t.identifier);this.isOptionDuoTone=e=>{const t=this.doesFilterAssetExist(e);return t?Sl(t):!1};this.editor=e,this.selectedCategory=Pn,this.filterStore=new gi(this.editor.engineMediator);const{config:t}=this,i=this.editor.configStore.assetProvider.getAssets("filter");this.entityManager=new de(i,f(f({},t),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))}get state(){return this.filterStore.state}get identifier(){return this.state.identifier}get intensity(){return this.state.intensity}get isDuotone(){return this.state.isDuotone}get selectedCategoryIdentifier(){return this.selectedCategory}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[m.FILTER]}get locale(){return this.editor.configStore.locale[m.FILTER]}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}}s([oe.observable],le.prototype,"selectedCategory",2),s([oe.observable],le.prototype,"entityManager",2),s([oe.action],le.prototype,"selectFilter",2),s([oe.action],le.prototype,"changeIntensity",2),s([oe.action],le.prototype,"pureReset",2),s([oe.action],le.prototype,"reset",2),s([oe.action],le.prototype,"toggleCategorySelection",2),s([oe.action],le.prototype,"updateStateFromSerialization",2),s([oe.action],le.prototype,"updateStateFromHistory",2),s([oe.computed],le.prototype,"state",1),s([oe.computed],le.prototype,"identifier",1),s([oe.computed],le.prototype,"intensity",1),s([oe.computed],le.prototype,"isDuotone",1),s([oe.computed],le.prototype,"selectedCategoryIdentifier",1),s([oe.computed],le.prototype,"isOptionSelected",1),s([oe.computed],le.prototype,"config",1),s([oe.computed],le.prototype,"locale",1),s([oe.computed],le.prototype,"categories",1),s([oe.computed],le.prototype,"items",1);const M=h(p()),ke=h(p());function Bn(e){const t=e&&typeof e=="object";return t&&Object.prototype.toString.call(e)!=="[object RegExp]"&&Object.prototype.toString.call(e)!=="[object Date]"}function Qh(e){return Array.isArray(e)?[]:{}}function Nn(e,t){const i=t&&t.clone===!0;return i&&Bn(e)?Ln(Qh(e),e,t):e}function ep(e,t,i){const r={};return Bn(e)&&Object.keys(e).forEach(o=>{r[o]=Nn(e[o],i)}),Object.keys(t).forEach(o=>{const n=Bn(t[o])&&e[o];r[o]=n?Ln(e[o],t[o],i):Nn(t[o],i)}),r}function Ln(e,t,i){const r=Array.isArray(t);return r?Array.isArray(e)?t:Nn(t,i):ep(e,t,i)}function Jt(e,t=null){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce((i,r)=>Ln(i,r,t))}class Dl extends tp{onExport(e){this.emit(Zt.EXPORT,e)}onClose(){this.emit(Zt.CLOSE)}onHistoryChange(){this.emit(Zt.HISTORY_CHANGE)}onEditorReady(){this.emit(Zt.EDITOR_READY)}onErrorImageLoading(e){this.emit(Zt.ERROR_IMAGE_LOADING,e)}onImageLoaded(){this.emit(Zt.IMAGE_LOAD)}onStickerUploadedAdd(e){this.emit(Zt.STICKER_UPLOAD_ADD,e)}onToolChanged(e){this.emit(Zt.TOOL_ENTER,e)}}const Hn={common:{error:"Fehler",warning:"Warnung",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Farbe",sliderOpacity:"Farbe Transparenz"}}},mainCanvasActions:{buttonExport:"Bild Exportieren",buttonUndo:"R\xFCckg\xE4ngig machen",buttonRedo:"Wiederholen",buttonClose:"Schlie\xDFen"},infoModals:{exporting:{heading:"Exportieren...",body:"Einen Moment bitte..."},saving:{heading:"Speichere...",body:"Einen Moment bitte..."},loading:{heading:"Lade...",body:"Einen Moment bitte..."},resizing:{heading:"Bild wird bearbeitet...",body:"Einen Moment bitte..."},loadingFonts:{heading:"Lade Schriftarten...",body:"Einen Moment bitte..."},stickerLoading:{heading:"Lade Sticker...",body:"Einen Moment bitte..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Laden des Bildes fehlgeschlagen. Dies kann verschiedene Gr\xFCnde haben, beispielsweise kann die Datei defekt sein oder der Dateityp wird nicht unterst\xFCtzt",buttonYes:"Neu Laden"},rendering:{headingDelimiter:":",body:"Beim Rendern des Bildes ist ein Fehler aufgetreten",buttonYes:"Neu Laden"},fontLoading:{headingDelimiter:":",heading:"Laden von Schriftarten ist fehlgeschlagen",body:"Die folgenden Schriftarten konnten nicht geladen werden: ${error}",buttonNo:"Schlie\xDFen"},webcamUnavailable:{headingDelimiter:":",body:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})",buttonYes:"Schlie\xDFen"},stickerLoading:{headingDelimiter:":",body:"Laden des Stickers fehlgeschlagen.",buttonNo:"Schlie\xDFen"},unexpectedError:{headingDelimiter:":",body:"Ein unerwarteter Fehler ist aufgetreten, ${error}",buttonYes:"Neu Laden"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Bild verkleinert",body:"Ihr Bild \xFCbersteigt die maximale Gr\xF6sse von ${megapixels} megapixels und wurde auf ${width}x${height} Pixel verkleinert",buttonYes:"Weiter"},discardChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die \xC4nderungen verwerfen wollen?",buttonYes:"\xC4nderungen verwerfen",buttonNo:"\xC4nderungen beibehalten"},unsavedChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die \xC4nderungen verwerfen wollen?",buttonYes:"Beenden ohne zu speichern",buttonNo:"Schlie\xDFen"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Ihre Daten wurden von einem veralteten Format geladen und k\xF6nnten anders aussehen",buttonYes:"\xC4nderungen anwenden",buttonNo:"Abbrechen"},unsupportedWebGLRenderer:{body:"Es wurde ein Problem im Browser festgestellt, welches zu langen Ladezeiten f\xFChren kann. Bitte probieren sie einen anderen Browser.",buttonYes:"Weiter"}},library:{title:"Bibliothek",controls:{buttonUpload:"Bild Hochladen",buttonWebcamOpen:"Webcam \xD6ffnen",buttonWebcamClose:"Webcam Schlie\xDFen",placeholderSearch:"Bibliothek durchsuchen",noResults:"Keine Ergebnisse"}},filter:{title:"Filter",controls:{buttonReset:"Zur\xFCcksetzen",sliderIntensity:"Filter Intensit\xE4t"},categories:{[Ae.DuoTone]:"DuoTone",[Ae.BW]:"B & W",[Ae.Vintage]:"Vintage",[Ae.Smooth]:"Smooth",[Ae.Cold]:"Cold",[Ae.Warm]:"Warm",[Ae.Legacy]:"Legacy"},items:{[b.Inferno]:"Inferno",[b.Chestnut]:"Chestnut",[b.Fixie]:"Fixie",[b.Fridge]:"Fridge",[b.Sunny70s]:"Sunny 70s",[b.FlatBlack]:"Flat Black",[b.Mellow]:"Mellow",[b.HardStuff]:"Hard Stuff",[b.Oldtimer]:"Oldtimer",[b.AD1920]:"1920 A.D.",[b.Ancient]:"Ancient",[b.Kalmen]:"Kalmen",[b.Joran]:"Joran",[b.Polaroid]:"Polaroid",[b.Zephyr]:"Zephyr",[b.Levante]:"Levante",[b.Greyed]:"Greyed",[b.Classic]:"Classic",[b.Colorful]:"Colorful",[b.Snappy]:"Snappy",[b.Candy]:"Candy",[b.Creamy]:"Creamy",[b.LowFire]:"Low Fire",[b.Colla]:"Colla",[b.Sunrise]:"Sunrise",[b.Moss]:"Moss",[b.Food]:"Food",[b.Glam]:"Glam",[b.Gobblin]:"Gobblin",[b.HighCarb]:"High Carb",[b.Hicon]:"Hicon",[b.K1]:"K1",[b.K6]:"K6",[b.Pebble]:"Pebble",[b.Keen]:"Keen",[b.Lemon]:"Lemon",[b.Litho]:"Litho",[b.Lomo]:"Lomo",[b.Lomo100]:"Lomo 100",[b.Lucid]:"Lucid",[b.Neat]:"Neat",[b.Pumpkin]:"Pumpkin",[b.Solanus]:"Solanus",[b.Pale]:"Pale",[b.Pitched]:"Pitched",[b.Weathered]:"Weathered",[b.GreenGap]:"Green Gap",[b.PolaSX]:"Pola SX",[b.Pro400]:"Pro 400",[b.Quozi]:"Quozi",[b.Sepia]:"Sepia",[b.Settled]:"Settled",[b.Seventies]:"Seventies",[b.Soft]:"Soft",[b.Steel]:"Steel",[b.Summer]:"Summer",[b.Golden]:"Golden",[b.Tender]:"Tender",[b.Twilight]:"Twilight",[b.Softy]:"Softy",[b.Dusty]:"Dusty",[b.Desert]:"Desert",[b.Peach]:"Peach",[b.Clash]:"Clash",[b.Plum]:"Plum",[b.Breezy]:"Breezy",[b.DeepBlue]:"Deep Blue",[b.Frog]:"Frog",[b.Sunset]:"Sunset"}},adjustment:{title:"Korrekturen",controls:{buttonReset:"Zur\xFCcksetzen"},categories:{basics:"Grundlagen",refinements:"Feinheiten"},items:{brightness:"Helligkeit",saturation:"S\xE4ttigung",contrast:"Kontrast",gamma:"Gamma",sharpness:"Sch\xE4rfe",clarity:"Klarheit",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",whites:"Wei\xDF",blacks:"Schwarz",temperature:"Temperatur"}},focus:{title:"Weichzeichnen",controls:{buttonReset:"Zur\xFCcksetzen",sliderIntensity:"Focus Intensit\xE4t"},items:{radial:"Kreisf\xF6rmig",mirrored:"Gespiegelt",linear:"Linear",gaussian:"Gau\xDFsch"},history:{focusPosition:"Focus Position",focusSize:"Focus Gr\xF6\xDFe"}},overlay:{title:"Overlays",controls:{buttonReset:"Zur\xFCcksetzen",sliderOpacity:"Overlay Transparenz",carouselBlendMode:"Overlay Mischmodus",blendModeNormal:"Normal",blendModeOverlay:"\xDCberblenden",blendModeHardLight:"Hartes Licht",blendModeSoftLight:"Weiches Licht",blendModeMultiply:"Multiplizieren",blendModeDarken:"Abdunkeln",blendModeLighten:"Aufhellen",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Transparenz",tabBlendMode:"Mischmodus"},items:{[U.Bokeh]:"Bokeh",[U.Chop]:"Chop",[U.Clouds]:"Clouds",[U.Golden]:"Golden",[U.Grain]:"Grain",[U.Hearts]:"Hearts",[U.LightLeak1]:"Light Leak 1",[U.LightLeak2]:"Light Leak 2",[U.Metal]:"Metal",[U.Mosaic]:"Mosaic",[U.Painting]:"Painting",[U.Paper]:"Paper",[U.Rain]:"Rain",[U.Vintage]:"Vintage",[U.Wall1]:"Wall",[U.Wall2]:"Wall 2",[U.Wood]:"Wood"}},sticker:{title:"Sticker",controls:{buttonUpload:"Sticker Hochladen",sliderOpacity:"Sticker Transparenz",selectColor:"Stickerfarbe",tabColor:"Farbe",tabOpacity:"Transparenz"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren",buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"Neuer Text",dropdownFontFamily:"Schriftart",textFontSize:"Schriftgr\xF6\xDFe",selectAlignment:"Ausrichtung",selectFontColor:"Schriftfarbe",selectBackgroundColor:"Hintergrundfarbe",sliderLineSpacing:"Zeilenabstand",tabColor:"Farbe",tabBgColor:"Hintergrund",tabAlignment:"Ausrichtung",tabLineHeight:"Zeilenh\xF6he",tabFontSize:"Schriftgr\xF6\xDFe"},canvasControls:{placeholderText:"Etwas aufschreiben",buttonSave:"Fertig",buttonClose:"Abbrechen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"Neues Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Textfarbe",tabColor:"Farbe",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Etwas aufschreiben mit Style",buttonSave:"Done",buttonClose:"Schlie\xDFen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonInvert:"Invertieren",buttonDelete:"L\xF6schen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Rahmen",controls:{buttonReset:"Zur\xFCcksetzen",sliderOpacity:"Rahmen Transparenz",sliderSize:"Rahmen Dicke",selectColor:"Rahmen Farbe",tabColor:"Farbe",tabOpacity:"Transparenz",tabSize:"Dicke"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Malen",controls:{buttonReset:"Zur\xFCcksetzen",sliderSize:"Dicke",sliderHardness:"H\xE4rte",selectColor:"Farbe",tabSize:"Dicke",tabHardness:"H\xE4rte",tabColor:"Farbe"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Zuschneiden",controls:{buttonReset:"Zur\xFCcksetzen",checkboxKeepResolution:"Fixiere Aufl\xF6sung",inputCropSize:"Bildgr\xF6\xDFe",inputHeight:"h",inputWidth:"b",tabFlipAndRotate:"Spiegeln & Drehen",tabResolution:"Aufl\xF6sung",tabCropSize:"Bildgr\xF6\xDFe"},categories:{imgly_transforms_common:"Standard",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Frei",imgly_transform_common_square:"Quadratisch",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Titel",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln",buttonRotateClockwise:"Drehe im Uhrzeigersinn",buttonRotateAntiClockwise:"Drehe gegen Uhrzeigersinn"}}},bi={common:{error:"Error",warning:"Warning",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Color",sliderOpacity:"Color Opacity"}}},mainCanvasActions:{buttonExport:"Export Image",buttonUndo:"Undo",buttonRedo:"Redo",buttonClose:"Close"},infoModals:{exporting:{heading:"Exporting...",body:"Just a few seconds..."},saving:{heading:"Saving...",body:"Just a few seconds..."},loading:{heading:"Loading...",body:"Just a few seconds..."},resizing:{heading:"Resizing...",body:"Just a few seconds..."},loadingFonts:{heading:"Loading Fonts...",body:"Just a few seconds..."},stickerLoading:{heading:"Loading Sticker...",body:"Just a few seconds..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Failed to load image. This can have multiple reasons, e.g. the file is corrupted or the file type is not supported",buttonYes:"Reload"},rendering:{headingDelimiter:":",body:"An error has occurred while rendering the image",buttonYes:"Reload"},fontLoading:{headingDelimiter:":",heading:"Failed to load font",body:"The following fonts could not be loaded: ${error}",buttonNo:"Close"},webcamUnavailable:{headingDelimiter:":",body:"Unable to display webcam image (Error: ${error})",buttonYes:"Close"},stickerLoading:{headingDelimiter:":",body:"Unable to load the sticker",buttonNo:"Close"},unexpectedError:{headingDelimiter:":",body:"An unexpected error has occured ${error}",buttonYes:"Reload"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Image resized",body:"Your image exceeds the maximum size of ${megapixels} megapixels and has been resized to ${width}x${height} pixels",buttonYes:"Continue"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Your data was restored from a legacy data format and might look different",buttonYes:"Apply changes",buttonNo:"Cancel"},discardChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to discard the changes?",buttonYes:"Discard changes",buttonNo:"Keep Changes"},unsavedChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to exit?",buttonYes:"Exit without saving",buttonNo:"Cancel"},unsupportedWebGLRenderer:{body:"A problem has been detected in the browser that could cause long loading times. Please try a different browser.",buttonYes:"Continue"}},library:{title:"Library",controls:{buttonUpload:"Upload Image",buttonWebcamOpen:"Open Webcam",buttonWebcamClose:"Close Webcam",placeholderSearch:"Search Library",noResults:"No Results"}},filter:{title:"Filters",controls:{buttonReset:"Remove Filter",sliderIntensity:"Filter Intensity"},categories:{[Ae.DuoTone]:"DuoTone",[Ae.BW]:"B & W",[Ae.Vintage]:"Vintage",[Ae.Smooth]:"Smooth",[Ae.Cold]:"Cold",[Ae.Warm]:"Warm",[Ae.Legacy]:"Legacy"},items:{[b.Inferno]:"Inferno",[b.Chestnut]:"Chestnut",[b.Fixie]:"Fixie",[b.Fridge]:"Fridge",[b.Sunny70s]:"Sunny 70s",[b.FlatBlack]:"Flat Black",[b.Mellow]:"Mellow",[b.HardStuff]:"Hard Stuff",[b.Oldtimer]:"Oldtimer",[b.AD1920]:"1920 A.D.",[b.Ancient]:"Ancient",[b.Kalmen]:"Kalmen",[b.Joran]:"Joran",[b.Polaroid]:"Polaroid",[b.Zephyr]:"Zephyr",[b.Levante]:"Levante",[b.Greyed]:"Greyed",[b.Classic]:"Classic",[b.Colorful]:"Colorful",[b.Snappy]:"Snappy",[b.Candy]:"Candy",[b.Creamy]:"Creamy",[b.LowFire]:"Low Fire",[b.Colla]:"Colla",[b.Sunrise]:"Sunrise",[b.Moss]:"Moss",[b.Food]:"Food",[b.Glam]:"Glam",[b.Gobblin]:"Gobblin",[b.HighCarb]:"High Carb",[b.Hicon]:"Hicon",[b.K1]:"K1",[b.K6]:"K6",[b.Pebble]:"Pebble",[b.Keen]:"Keen",[b.Lemon]:"Lemon",[b.Litho]:"Litho",[b.Lomo]:"Lomo",[b.Lomo100]:"Lomo 100",[b.Lucid]:"Lucid",[b.Neat]:"Neat",[b.Pumpkin]:"Pumpkin",[b.Solanus]:"Solanus",[b.Pale]:"Pale",[b.Pitched]:"Pitched",[b.Weathered]:"Weathered",[b.GreenGap]:"Green Gap",[b.PolaSX]:"Pola SX",[b.Pro400]:"Pro 400",[b.Quozi]:"Quozi",[b.Sepia]:"Sepia",[b.Settled]:"Settled",[b.Seventies]:"Seventies",[b.Soft]:"Soft",[b.Steel]:"Steel",[b.Summer]:"Summer",[b.Golden]:"Golden",[b.Tender]:"Tender",[b.Twilight]:"Twilight",[b.Softy]:"Softy",[b.Dusty]:"Dusty",[b.Desert]:"Desert",[b.Peach]:"Peach",[b.Clash]:"Clash",[b.Plum]:"Plum",[b.Breezy]:"Breezy",[b.DeepBlue]:"Deep Blue",[b.Frog]:"Frog",[b.Sunset]:"Sunset"}},adjustment:{title:"Adjust",controls:{buttonReset:"Reset Adjustment"},categories:{basics:"Basic",refinements:"Refinements"},items:{brightness:"Brightness",saturation:"Saturation",contrast:"Contrast",gamma:"Gamma",sharpness:"Sharpness",clarity:"Clarity",exposure:"Exposure",shadows:"Shadows",highlights:"Highlights",whites:"Whites",blacks:"Blacks",temperature:"Temperature"}},focus:{title:"Focus",controls:{buttonReset:"Remove Focus",sliderIntensity:"Focus Intensity"},items:{radial:"Radial",mirrored:"Mirrored",linear:"Linear",gaussian:"Gaussian"},history:{focusPosition:"Focus Position",focusSize:"Focus Size"}},overlay:{title:"Overlays",controls:{buttonReset:"Remove Overlay",sliderOpacity:"Overlay Opacity",carouselBlendMode:"Overlay Blend mode",blendModeNormal:"Normal",blendModeOverlay:"Overlay",blendModeHardLight:"Hard Light",blendModeSoftLight:"Soft Light",blendModeMultiply:"Multiply",blendModeDarken:"Darken",blendModeLighten:"Lighten",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Opacity",tabBlendMode:"Blend Mode"},items:{[U.Bokeh]:"Bokeh",[U.Chop]:"Chop",[U.Clouds]:"Clouds",[U.Golden]:"Golden",[U.Grain]:"Grain",[U.Hearts]:"Hearts",[U.LightLeak1]:"Light Leak 1",[U.LightLeak2]:"Light Leak 2",[U.Metal]:"Metal",[U.Mosaic]:"Mosaic",[U.Painting]:"Painting",[U.Paper]:"Paper",[U.Rain]:"Rain",[U.Vintage]:"Vintage",[U.Wall1]:"Wall",[U.Wall2]:"Wall 2",[U.Wood]:"Wood"}},sticker:{title:"Stickers",controls:{buttonUpload:"Upload Sticker",sliderOpacity:"Sticker Opacity",selectColor:"Sticker Color",tabColor:"Color",tabOpacity:"Opacity"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate",buttonFlipHorizontal:"Flip",buttonFlipVertical:"Flip"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"New Text",dropdownFontFamily:"Font Family",textFontSize:"Font Size",selectAlignment:"Alignment",selectFontColor:"Font Color",selectBackgroundColor:"Background Color",sliderLineSpacing:"Line Spacing",tabColor:"Color",tabBgColor:"Bg Color",tabAlignment:"Alignment",tabLineHeight:"Line Height",tabFontSize:"Font Size"},canvasControls:{placeholderText:"Write Something",buttonSave:"Done",buttonClose:"Cancel",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"New Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Text Color",tabColor:"Color",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Write Something With Style",buttonSave:"Done",buttonClose:"Schlie\xDFen",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonInvert:"Invert",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Frames",controls:{buttonReset:"Remove Frame",sliderOpacity:"Frame Opacity",sliderSize:"Frame Size",selectColor:"Frame Color",tabColor:"Color",tabOpacity:"Opacity",tabSize:"Size"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Brush",controls:{buttonReset:"Remove Brush",sliderSize:"Brush Size",sliderHardness:"Brush Hardness",selectColor:"Brush Color",tabSize:"Size",tabHardness:"Hardness",tabColor:"Color"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Transform",controls:{buttonReset:"Reset to default",checkboxKeepResolution:"Keep Resolution",inputCropSize:"Crop Size",inputHeight:"h",inputWidth:"w",tabFlipAndRotate:"Flip & Rotate",tabResolution:"Resolution",tabCropSize:"Crop Size"},categories:{imgly_transforms_common:"Common",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Custom",imgly_transform_common_square:"Square",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Title",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Flip Horizontal",buttonFlipVertical:"Flip Vertical",buttonRotateClockwise:"Rotate Clockwise",buttonRotateAntiClockwise:"Rotate Counterclockwise"}}};const wl=e=>e==="de"?Hn:bi,xl=(e,t)=>t&&t[e]?Jt([wl(e),t[e]]):wl(e)||bi;const ip={headline1:{size:16,letterSpacing:1.5,case:"uppercase"},headline2:{size:14,letterSpacing:.8,case:"uppercase"},body:{size:13,letterSpacing:0,case:"none"},label:{size:13,letterSpacing:0,case:"capitalize"},basicUICardLabel:{size:12,letterSpacing:0,case:"capitalize"},button1:{size:12,letterSpacing:1.2,case:"uppercase"},button2:{size:14,letterSpacing:0,case:"capitalize"},basicUITabLabel:{size:14,letterSpacing:.8,case:"uppercase"}},rp={toast:2,controlsBar:5,buttonGroup:5,toolControlBar:6,toolbar:7,label:10,disable:11,canvas:{knob:4,bar:5,controls:5,snappingGuide:1,crop:{grid:2,dragImage:3,backdrop:4},webcam:{backdrop:7}},input:{list:6},button:{float:5},dialog:{base:100,backdrop:1,container:2},colorItem:{overlay:2,background:1,tiledBackground:0}},no=()=>{const e=8,t=230,i=3*e,r=t-2*i,o=(r-2*e)/3,n=(r-e)/2;return{advancedUIToolbar:{width:55,itemHeight:48,seperatorHeight:20,marginBottom:0},advancedUIToolControlBar:{width:t,padding:`${2*e}px ${i}px`,marginBottom:0},advancedCard:{small:{height:o,width:o},medium:{height:n,width:n},large:{height:86,width:r}},advancedSpacer:8,basicCanvasOffset:40+76-88,basicUIToolbar:{openHeight:88,closeHeight:40},basicToolControlBar:{itemsBarHeight:72,controlsBarHeight:80,maxHeight:72+40+4,maxWidth:300},basicCard:{medium:{height:56,width:90},large:{height:60,width:110}},basicSpacer:8,mainCanvasActionBar:{height:50},crop:{minSize:50},canvas:{marginTop:0,transform:{minSliderWidth:435,minValueWidth:235,minFlipWidth:160}},canvasControls:{sprite:{controlOffset:16,rotateHandle:{height:16},minSize:30,controlPadding:16},knob:{size:16,touchable:{desktop:24}},corner:{size:14,touchable:{desktop:24,mobile:48},borderWidth:4},width:{size:14}},buttons:{float:{size:56}},colorItem:{size:20},color:{colorPicker:{width:214,height:370,saturationSlider:{height:150},thumb:{size:14},arrow:{width:36}}},fontSystem:ip,zIndex:rp}},op=({primary:e="#365afc",background:t="#0B0B0B",foreground:i="#FFFFFF"}={primary:"#365afc",background:"#0B0B0B",foreground:"#FFFFFF"})=>{const r="rgba(255, 255, 255, 0.90)",o="rgba(255, 255, 255, 0.60)",n="rgba(255, 255, 255, 0.38)",a="#424242",l="#333333",c="#242424",d="#171717",u="#0B0B0B",g="rgba(255, 255, 255, 0.08)",y="rgba(0, 0, 0, 0.3)",E="rgba(89, 121, 252, 0.20)",D="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:t,foreground:i,primary:e,warning:"#ffba5c",error:"#c2393a",success:"#39c26c",focusOutlineColor:"rgba(255, 255, 255, 0.12)",scrollbar:{handleColor:"rgba(255, 255, 255, 0.2)"},button:{outlinedBorderColor:l,activeForeground:e,containedPrimaryBackground:e,containedPrimaryForeground:r,outlinedPrimaryBackground:c,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:e,textSecondaryForeground:o,outlinedInactiveOverlayColor:y,textInactiveOpacity:"0.5",hoverOverlayColor:g},checkbox:{background:l,foreground:i,activeForeground:i,activeBackground:e,inactiveOpacity:D,hoverOpacity:"0.8"},modal:{background:c,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:l,foreground:r,activeBorderColor:e,activeOverlayColor:E,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:r,inactiveOverlayColor:y,hoverOverlayColor:g},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:e,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:l,caretColor:n,listBackground:l,listBorderColor:l,listItemHoverBackground:a,listForeground:o,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,inactiveOpacity:D},textInput:{foreground:r,hoverBorderColor:"rgba(255, 255, 255, 0.40)",background:"transparent",borderColor:l,inactiveOpacity:D},slider:{trackColor:"rgba(255, 255, 255, 0.4)",activeTrackColor:e,thumbBackground:d,thumbBorderColor:e,inactiveOpacity:D,hoverOpacity:"0.7"},selectColor:{activeBorderColor:e,inactiveOpacity:D},toolbar:{foreground:r,background:c,activeBackground:"transparent",activeForeground:e,borderColor:"transparent"},tooltip:{background:a,foreground:r},toolControlBar:{background:"rgba(23, 23, 23, 0.9)",borderColor:"transparent",shadow:"none",separatorColor:l,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:D},mainCanvasActionBar:{background:"linear-gradient(0deg, transparent 0%,  rgba(0, 0, 0, 0.6) 98%)",foreground:r,borderColor:"none"},canvasActionBar:{background:a,foreground:r,separatorColor:n},canvas:{background:u,controlsOutline:"rgba(255, 255, 255, 0.5)",controlsColor:"#ffffff",cropBackdrop:"rgba(0, 0, 0, 0.5)"},colorPicker:{listBackground:l,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:a},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:i,background:u},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#424242",highlight:"#565656",shadow:"#333333"}}}};var so=op;const np=({primary:e="#1e47fb",background:t="#FBFBFB",foreground:i="#000000"}={primary:"#1e47fb",background:"#FBFBFB",foreground:"#000000"})=>{const r="rgba(0, 0, 0, 0.90)",o="rgba(0, 0, 0, 0.60)",n="rgba(0, 0, 0, 0.38)",a="#CCCCCC",l="#D4D4D4",c="#E6E6E6",d="#EEEEEE",u="#FBFBFB",g="rgba(125, 125, 125, 0.12)",y="rgba(30, 71, 251, 0.2)",E="rgba(0, 0, 0, 0.3)",D="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:t,foreground:i,primary:e,warning:"#ffb045",error:"#c01a1b",success:"#17c658",focusOutlineColor:"rgba(125, 125, 125, 0.12)",scrollbar:{handleColor:"rgba(0, 0, 0, 0.2)"},button:{outlinedBorderColor:l,activeForeground:e,containedPrimaryBackground:e,containedPrimaryForeground:"rgba(255, 255, 255, 0.9)",outlinedPrimaryBackground:c,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:e,textSecondaryForeground:o,outlinedInactiveOverlayColor:E,textInactiveOpacity:"0.5",hoverOverlayColor:g},checkbox:{background:l,foreground:i,activeForeground:i,activeBackground:e,inactiveOpacity:D,hoverOpacity:"0.8"},modal:{background:c,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:l,foreground:r,activeBorderColor:e,activeOverlayColor:y,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:"rgba(255, 255, 255, 0.87)",inactiveOverlayColor:E,hoverOverlayColor:g},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:e,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:l,listBackground:l,caretColor:n,listForeground:o,listBorderColor:l,listItemHoverBackground:a,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,inactiveOpacity:D},textInput:{foreground:r,hoverBorderColor:r,background:"transparent",borderColor:l,inactiveOpacity:D},slider:{trackColor:a,activeTrackColor:e,thumbBackground:d,thumbBorderColor:e,inactiveOpacity:D,hoverOpacity:"0.7"},selectColor:{activeBorderColor:e,inactiveOpacity:D},toolbar:{foreground:r,background:l,activeBackground:"transparent",activeForeground:e,borderColor:"transparent"},tooltip:{background:a,foreground:r},toolControlBar:{background:"rgba(238, 238, 238, 0.9)",borderColor:d,shadow:"none",separatorColor:l,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:D},mainCanvasActionBar:{background:"transparent",foreground:r,borderColor:"none"},canvasActionBar:{background:a,foreground:r,separatorColor:n},canvas:{background:u,controlsOutline:"rgba(255, 255, 255, 0.6)",controlsColor:"#ffffff",cropBackdrop:"rgba(255, 255, 255, 0.3)"},colorPicker:{listBackground:l,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:a},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:i,background:u},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#B8B8B8",highlight:"#E6E6E6",shadow:"#D4D4D4"}}}};var jn=np;const br=so(),Un=no(),Pv=f(f({},br),{measurements:Un}),sp=e=>e==="light"?jn:so,Cl=(e,t)=>{const i=sp(e);if(t&&t[e]){const{primary:r,background:o,foreground:n}=t[e],a={primary:r,background:o,foreground:n},l=Object.keys(a).reduce((c,d)=>a[d]?f(f({},c),{[d]:a[d]}):c,{});return Jt([i(l),t[e]])}return i()||br};const ap=["canvas","advancedUIToolbar","advancedUIToolControlBar","basicUIToolbar","mainCanvasActionBar","colorItem","fontSystem"],_l=e=>{const t=no();if(e){const i={};return Object.keys(e).forEach(r=>{ap.indexOf(r)!==-1&&(i[r]=e[r])}),Jt([t,i])}return t};const dp={config:zn,locale:bi,theme:br,measurements:Un};class Ke{constructor(){this.checkDefaultToolAvailability=(e,t)=>t.indexOf(e)!==-1;this.state=ke.observable(dp),this.events=new Dl,this.licenseChecker=null}saveConfig(e){e.mainCanvasActions&&e.mainCanvasActions.length!==4&&(e.mainCanvasActions.length=4);const t=Jt([zn,e]),i=t;this.licenseChecker=new yl(i.license),this.licenseChecker.areCustomAssetsAllowed()||(i.sticker.enableCustomUpload=!1);const r=xl(i.language,i.custom.languages),o=Cl(i.theme,i.custom.themes),n=_l(i.custom.measurements),{provider:a}=i.library,l=[];i.adjustment.categories=i.adjustment.categories.reduce((g,y)=>(g.push(f(f({},y),{items:y.items.filter(E=>lp[E.identifier]?!0:(l.push(E.identifier),!1))})),g),[]),l.length!==0&&console.error(`The following identifier are incorrect for the adjustment tool: ${l.join(", ")}`),delete i.language,delete i.custom.languages,delete i.custom.themes,delete i.library.provider;let c=i.tools.reduce((g,y)=>typeof y=="object"?[...g,...y]:[...g,y],[]);c.length||(console.error("Empty list input for tools"),c=to.reduce((g,y)=>typeof y=="object"?[...g,...y]:[...g,y],[])),c=c.filter(g=>this.licenseChecker.isToolAllowed(g));const d=this.checkDefaultToolAvailability(i.defaultTool,c);d||(this.licenseChecker.isToolAllowed(i.defaultTool)&&console.warn(`Configured default tool ${i.defaultTool} is not a part of configured list of tools: [${c.join(" ")}]`),[i.defaultTool]=c),i.tools=c,this.state.config=i,this.state.locale=r,this.state.theme=o,this.state.measurements=n;const u=this.buildCustomAssetsConfig();return this.assetProvider=new cp(u,this.licenseChecker.areCustomAssetsAllowed()),this.loadThemeFont(),a}get config(){return this.state.config}get locale(){return this.state.locale}get theme(){return this.state.theme}get measurements(){return this.state.measurements}get tools(){return this.config.tools.reduce((e,t)=>typeof t=="string"?[...e,t]:[...e,"",...t],[])}get defaultTool(){return this.config.defaultTool}get isOrderDefault(){return this.config.order==="default"}get isLayoutAdvanced(){return this.config.layout==="advanced"}get displayCloseButton(){return this.config.mainCanvasActions.indexOf(he.CLOSE)!==-1}loadThemeFont(){const{typography:e}=this.theme;e.skipLoading||this.assetProvider.getFontManager().injectFonts([e])}buildCustomAssetsConfig(){const e=this.tools,t=ke.toJS(this.state.config),i=this.state.config.assetBaseUrl,{theme:r}=this.state,o=e.indexOf(m.FILTER)!==-1?t[m.FILTER]:void 0,n=e.indexOf(m.FOCUS)!==-1?t[m.FOCUS]:void 0,a=e.indexOf(m.ADJUSTMENT)!==-1?t[m.ADJUSTMENT]:void 0,l=e.indexOf(m.STICKER)!==-1?t[m.STICKER]:void 0,c=e.indexOf(m.FRAME)!==-1?t[m.FRAME]:void 0,d=e.indexOf(m.OVERLAY)!==-1?t[m.OVERLAY]:void 0,u=e.indexOf(m.TRANSFORM)!==-1?t[m.TRANSFORM]:void 0,g=e.indexOf(m.TEXT)!==-1?t[m.TEXT]:void 0,y=e.indexOf(m.TEXT_DESIGN)!==-1?t[m.TEXT_DESIGN]:void 0;return{basePath:i,theme:r,filter:o,focus:n,sticker:l,frame:c,overlay:d,transform:u,text:g,adjustment:a,textdesign:y}}}s([ke.action],Ke.prototype,"saveConfig",1),s([ke.computed],Ke.prototype,"config",1),s([ke.computed],Ke.prototype,"locale",1),s([ke.computed],Ke.prototype,"theme",1),s([ke.computed],Ke.prototype,"measurements",1),s([ke.computed],Ke.prototype,"tools",1),s([ke.computed],Ke.prototype,"defaultTool",1),s([ke.computed],Ke.prototype,"isOrderDefault",1),s([ke.computed],Ke.prototype,"isLayoutAdvanced",1),s([ke.computed],Ke.prototype,"displayCloseButton",1);class El{constructor(e){this.editor=e}setBackgroundImage(e){this.container?this.container.setData({image:e,originalImage:e}):this.container=this.engine.addImage({image:e,originalImage:e,blendMode:Rt.NORMAL,opacity:1})}getchildren(){return this.container.getChildren()}addImageToContainer(){return new Promise((e,t)=>{const{image:i}=this.editor.activeStore;if(ol(i))this.setBackgroundImage(i),e();else{const r=this.editor.libraryStore.getRawUrl(i);this.getImageElement(r).then(o=>{this.setBackgroundImage(o),e()}).catch(o=>{t({identifier:"imageLoading",message:o.message})})}})}getImageElement(e){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",o=>{i(o)}),r.crossOrigin=this.editor.configStore.config.engine.crossOrigin,r.src=e})}getImgageContainerId(){return this.container?this.container.getID():""}get engine(){return this.editor.engine}}class kl{constructor(e){this.applyNewImageTransform=()=>{const{size:e,width:t,height:i}=this.editor.engineMediator.image.container.getBounds(),r=this.container;r.setTransform(Qt.IDENTITY),r.setResolution(e),r.setPivot(.5,.5),r.setPosition({x:t/2,y:i/2})};this.editor=e}get engine(){return this.editor.engine}get container(){return this.engine.getOutputContainer()}}const Ze=h(p()),Li=h(p()),Ye=h(p()),up=(e,t)=>new Promise((i,r)=>{const o=new XMLHttpRequest;o.onload=()=>{const n=new FileReader;n.onloadend=()=>{typeof n.result=="string"&&n.result.substr(0,10)==="data:image"?i(n.result):r(new Error(`The image could not be loaded from ${e}`))},n.onerror=a=>{r(a)},n.readAsDataURL(o.response)},o.open("GET",e),o.responseType="blob",o.withCredentials=t==="use-credentials",o.send()}),Tl=(e,t)=>new Promise((i,r)=>{const o=new Image;o.onload=()=>{i(o)},o.onerror=()=>{r(new Error(`Failed to load image with src:${e}`))},o.crossOrigin=t,o.src=e}),hp=(e,t)=>new Promise((i,r)=>{up(e,t).then(o=>{const n=new Image;n.addEventListener("load",()=>{i(n)}),n.src=o}).catch(()=>{Tl(e,t).then(o=>i(o)).catch(o=>{r(o)})})}),Wn=r=>k(void 0,[r],function*({url:e,image:t,crossOrigin:i="anonymous"}){try{return t&&t.src&&t.src.substr(0,5)==="data:"||t&&t.src&&t.src.includes(".svg")?t:typeof e=="string"&&e.substr(0,5)==="data:"||typeof e=="string"&&e.includes(".svg")?Tl(e,i):hp(e||t.src,i)}catch(o){throw new Error(o)}}),pp={tool:null,isWebcam:!1,image:""};class Ct{constructor(e){this.setImage=e=>k(this,null,function*(){const{crossOrigin:t}=this.editor.configStore.config.engine;typeof e=="string"&&(this.state.image=yield Wn({url:ro(e)?e:this.editor.assetProvider.getPath(e),crossOrigin:t})),e instanceof HTMLImageElement&&(this.state.image=yield Wn({image:e,crossOrigin:t})),this.isWebcam&&(this.state.isWebcam=!1)});this.newImage=e=>{this.editor.init(e)};this.editor=e,this.state=Ye.observable(pp)}selectTool(e){const{licenseChecker:t}=this.editor.configStore;if(this.state.tool!==e&&(t==null?void 0:t.isToolAllowed(e))){this.editor.onToolChange(this.state.tool,e),this.state.tool=e,this.editor.configStore.events.onToolChanged(e);switch(e){case m.TEXT:this.editor.spriteStore.textToolStore.addOrselect();break;case m.TEXT_DESIGN:this.editor.spriteStore.textDesignToolStore.addOrselect();break;case m.BRUSH:{this.editor.brushToolStore.initSize();break}case m.TRANSFORM:this.editor.transformToolStore.applyDefaultCrop();break;default:break}}}selectWebcam(e){this.state.isWebcam=e}get webcamLabel(){return this.editor.libraryStore.locale.controls.buttonWebcamClose}get tool(){return this.state.tool}get isWebcam(){return this.state.isWebcam}get image(){return this.state.image}}s([Ye.action],Ct.prototype,"selectTool",1),s([Ye.action],Ct.prototype,"selectWebcam",1),s([Ye.action],Ct.prototype,"setImage",2),s([Ye.action],Ct.prototype,"newImage",2),s([Ye.computed],Ct.prototype,"webcamLabel",1),s([Ye.computed],Ct.prototype,"tool",1),s([Ye.computed],Ct.prototype,"isWebcam",1),s([Ye.computed],Ct.prototype,"image",1);const Le=h(p()),$n={height:150,width:150};class je{constructor(e){this.canvasClickDisabled=Le.observable.box(!1);this.editor=e,this.state=Le.observable(je.initialState)}setCanvasElement(e){this.canvas=e,this.editor.engineMediator.preview.createPreview(e),this.updateCanvasDimensions(),this.editor.init(this.editor.configStore.config.image)}updateCanvasDimensions(){const e=ce.devicePixelRatio;this.canvas.width=this.canvasSize.width*e,this.canvas.height=this.canvasSize.height*e,this.canvas.style.width=`${this.canvasSize.width}px`,this.canvas.style.height=`${this.canvasSize.height}px`}saveDimensions({height:e,width:t,render:i}){const r=this.editor.configStore.isLayoutAdvanced?0:this.editor.configStore.measurements.basicCanvasOffset;e-r>$n.height&&t>$n.width&&(this.state.canvasSize.height=e-r,this.state.canvasSize.width=t,i&&this.editor.resize())}disableCanvasClick(){this.canvasClickDisabled.set(!0)}enableCanvasClick(){this.canvasClickDisabled.set(!1)}get isCanvasClickable(){return!this.canvasClickDisabled.get()}get canvasSize(){return this.state.canvasSize}get sizeVector(){return w.fromSize(this.state.canvasSize)}get sizeVectorMagnitude(){return this.sizeVector.magnitude}getContainersAtPreviewPoint(e){const t=this.editor.engine.getContainersAtPreviewPoint(e,this.editor.engineMediator.preview.previewTransformWithoutDpr).map(i=>i.getID()).filter(i=>i!==this.editor.engineMediator.image.getImgageContainerId());this.editor.spriteStore.onCanvasClick(t)}}je.initialState={canvasSize:$n},s([Le.action],je.prototype,"setCanvasElement",1),s([Le.action],je.prototype,"updateCanvasDimensions",1),s([Le.action],je.prototype,"saveDimensions",1),s([Le.action],je.prototype,"disableCanvasClick",1),s([Le.action],je.prototype,"enableCanvasClick",1),s([Le.computed],je.prototype,"isCanvasClickable",1),s([Le.computed],je.prototype,"canvasSize",1),s([Le.computed],je.prototype,"sizeVector",1),s([Le.computed],je.prototype,"sizeVectorMagnitude",1);const Ue=h(p()),fp={type:null,identifier:null,isVisible:!1,error:""};class pt{constructor(e){this.showActionModal=({type:e,identifier:t,error:i,handleConfirm:r,handleDismiss:o})=>{this.resetHandlers(),this.state.isVisible=!0,this.state.identifier=t,this.state.type=e,this.state.error=i||"",this.handleConfirm=r,this.handleDismiss=o};this.hideModal=()=>{this.state.isVisible=!1,this.state.type=null,this.state.error="",this.state.identifier=null,this.resetHandlers()};this.resetHandlers=()=>{this.handleConfirm=null,this.handleDismiss=null};this.configStore=e.configStore,this.state=Ue.observable(fp)}showInfoModal(e){this.resetHandlers(),this.state.isVisible=!0,this.state.type=ae.INFO,this.state.identifier=e,this.state.error=""}showTextEditModal(){this.resetHandlers(),this.state.isVisible=!0,this.state.type=ae.TEXT_EDIT,this.state.identifier="inputText",this.state.error=""}get modalProps(){const{isVisible:e}=this.state,t=this.getModalLocale();if(t){const{bodyLabel:i,headerLabel:r,buttonYes:o,buttonNo:n}=t;return{headerLabel:r,bodyLabel:i,confirmLabel:o,dismissLabel:n,isVisible:e,handleClose:this.hideModal,handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss}}return{isVisible:!1}}get isVisible(){return this.state.isVisible}get type(){return this.state.type}get identifier(){return this.state.identifier}get positionOffset(){const{isLayoutAdvanced:e,measurements:{basicCanvasOffset:t,advancedUIToolControlBar:i,advancedUIToolbar:r},isOrderDefault:o}=this.configStore,n=(i.width+r.width)*(o?1:-1),a=t;return e?{x:n/2,y:0}:{x:0,y:-a}}getModalLocale(){const{identifier:e,error:t,type:i}=this.state,{locale:r}=this.configStore;if(!i||!e||i===ae.TEXT_EDIT)return null;if(i&&e&&r[`${i}Modals`]&&r[`${i}Modals`][e]){const o=r[`${i}Modals`][e];let{body:n}=o;n&&typeof t=="object"?Object.keys(t).forEach(l=>{n=n.replace(`\${${l}}`,t[l])}):n&&(n=n.replace("${error}",t));let a=o.heading;if(i===ae.ERROR||i===ae.WARNING){const l={error:r.common.error,warning:r.common.warning},c=i==="error"?l.error:l.warning;a=`${c}${o.headingDelimiter||""} ${o.header||""}`}return{bodyLabel:n,headerLabel:a,buttonYes:o.buttonYes,buttonNo:o.buttonNo}}return null}}s([Ue.action],pt.prototype,"showActionModal",2),s([Ue.action],pt.prototype,"showInfoModal",1),s([Ue.action],pt.prototype,"showTextEditModal",1),s([Ue.action],pt.prototype,"hideModal",2),s([Ue.computed],pt.prototype,"modalProps",1),s([Ue.computed],pt.prototype,"isVisible",1),s([Ue.computed],pt.prototype,"type",1),s([Ue.computed],pt.prototype,"identifier",1),s([Ue.computed],pt.prototype,"positionOffset",1);const ne=h(p());class pe{constructor(e){this.defaultScale=1;this.SCALE_LEVELS=[8.33,12.5,16.66,25,33.33,50,66.66,100,125,150,200,300,400,500,600].map(e=>e/100);this.state={position:{x:0,y:0},scaleIndex:-1};this.offset={x:0,y:0};this.in=()=>{this.canZoomIn&&(this.state.scaleIndex+=1,this.scaleRender())};this.out=()=>{if(this.canZoomOut){this.state.scaleIndex-=1;const{canDragX:e,canDragY:t,maxOffsetX:i,maxOffsetY:r}=this.checkOffset({x:0,y:0});t||(this.offset.y=r),e||(this.offset.x=i),this.savePosition(),this.scaleRender()}};this.setOffset=e=>{const{canDragX:t,canDragY:i}=this.checkOffset(e);t&&(this.offset.x=e.x),i&&(this.offset.y=e.y),this.scaleRender()};this.editor=e}setInitialTransform(e=0){const{transform:t}=this.editor.engineMediator.preview;ne.runInAction(()=>{this.setDefaultScale(Math.abs(e||t.scale.x)),this.setPosition(t.position)})}resetScale(){this.state.scaleIndex=-1}resetPosition(){const{width:e,height:t}=this.editor.canvasStore.canvas;this.setPosition({x:e/2,y:t/2})}resetOffset(){this.offset={x:0,y:0}}setPosition(e){this.state.position.x=e.x,this.state.position.y=e.y}savePosition(){this.setPosition(this.getPositionWithOffset()),this.offset={x:0,y:0}}setDefaultScale(e){if(this.defaultScale!==1){const i=this.SCALE_LEVELS.findIndex(r=>r===this.defaultScale);i!==-1&&(this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,i),...this.SCALE_LEVELS.slice(i+1)])}const t=this.SCALE_LEVELS.findIndex((i,r)=>r===0?e<i:r===this.SCALE_LEVELS.length-1?i<e:this.SCALE_LEVELS[r-1]<e&&e<i);if(t!==-1)this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,t),e,...this.SCALE_LEVELS.slice(t)],t===this.state.scaleIndex&&this.resetScale(),this.state.scaleIndex=t,this.defaultScale=e;else{const i=this.SCALE_LEVELS.findIndex(r=>r===e);i===this.state.scaleIndex&&this.resetScale(),i!==-1&&(this.state.scaleIndex=i,this.defaultScale=e)}}setScaleToDefault(){this.state.scaleIndex=this.defaultIndex}checkOffset(e){const t=window.devicePixelRatio||1,{scaledSize:i}=this,{previewSize:r}=this,o=this.editor.engineMediator.preview.initialTransform.position,n=this.getPositionWithOffset(e),a=(i.width-r.width)*t/2,l=(i.height-r.height)*t/2,c=o.x-n.x,d=o.y-n.y,u=Math.abs(c),g=Math.abs(d),y=c>0,E=d>0,D=u-a,T=g-l;return{canDragX:D<0,canDragY:T<0,maxOffsetX:y?-D:D,maxOffsetY:E?-T:T}}calculateScale(e=0,t=this.previewSize,i=this.defaultScale){const{width:r,height:o}=t,n=new w({x:r,y:o}),a=new w(Math.abs(n.x*Math.cos(e))+Math.abs(n.y*Math.sin(e)),Math.abs(n.x*Math.sin(e))+Math.abs(n.y*Math.cos(e))),l=n.subtract(a).divide(2).multiply(i).abs;return l.y>l.x?l.y*2/n.y+i:l.x*2/n.x+i}get defaultIndex(){return this.SCALE_LEVELS.findIndex(e=>e===this.defaultScale)}getPositionWithOffset(e=this.offset){const{position:t}=this;return{x:t.x-e.x,y:t.y-e.y}}scaleRender(e=!1){const t=this.editor.scale.getPositionWithOffset(),i=e?this.defaultScale:this.scale,r={x:i,y:i};this.editor.engineMediator.preview.container.setScale(r),this.editor.engineMediator.preview.container.setPosition(t),this.editor.engineMediator.preview.savePreviewTransform({scale:r,position:t,rotation:0}),e||this.editor.render()}get scale(){const e=this.state.scaleIndex;return e!==-1?this.SCALE_LEVELS[e]:this.defaultScale}get zoomLevel(){const e=window.devicePixelRatio||1;return(this.scale/e*100).toFixed(1)}get canDrag(){return this.defaultScale<this.scale}get canZoomOut(){return this.state.scaleIndex>this.defaultIndex}get canZoomIn(){return this.SCALE_LEVELS.length-1>this.state.scaleIndex}get position(){return this.state.position}get scaledSize(){const e=this.state.scaleIndex,t=e!==-1?this.SCALE_LEVELS[e]:this.defaultScale,{previewSize:i}=this;return{width:i.width*t/this.defaultScale,height:i.height*t/this.defaultScale}}get previewSize(){return this.editor.getPreviewSize()}}s([ne.observable],pe.prototype,"state",2),s([ne.action],pe.prototype,"in",2),s([ne.action],pe.prototype,"out",2),s([ne.action],pe.prototype,"setInitialTransform",1),s([ne.action],pe.prototype,"resetScale",1),s([ne.action],pe.prototype,"resetPosition",1),s([ne.action],pe.prototype,"setPosition",1),s([ne.action],pe.prototype,"savePosition",1),s([ne.action],pe.prototype,"setDefaultScale",1),s([ne.action],pe.prototype,"setScaleToDefault",1),s([ne.computed],pe.prototype,"scale",1),s([ne.computed],pe.prototype,"zoomLevel",1),s([ne.computed],pe.prototype,"canDrag",1),s([ne.computed],pe.prototype,"canZoomOut",1),s([ne.computed],pe.prototype,"canZoomIn",1),s([ne.computed],pe.prototype,"position",1),s([ne.computed],pe.prototype,"scaledSize",1);const Bi=h(p()),Fl=/^data:image\/(.+?);base64,/,mp=e=>Fl.test(e),gp=e=>e.match(/^data:([^;]+)/)[1],bp=e=>e.replace(Fl,"");class Vn{constructor(e){this.applySerialization=(e,t,i,r)=>k(this,null,function*(){this.editor.resetToolStates();const o=this.editor.activeStore.tool===m.TRANSFORM;o||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.reset(),o||this.editor.transformToolStore.onLeave();const n=new t(this.editor),a="Unexpected error occured",l=t.deserializeImage(e);if(l.image&&l.image.data){const d=l.image.data;yield this.editor.setImage(d),this.editor.scale.defaultScale=1,this.editor.scale.resetOffset(),this.editor.transformToolStore.reset(),this.editor.activeStore.setImage(d),yield this.editor.engineMediator.image.addImageToContainer(),this.editor.engineMediator.output.applyNewImageTransform(),this.editor.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.editor.transformToolStore.setCropDefaults(),this.editor.historyStore.addInitialSnapshot(),this.editor.transformToolStore.saveTransforms()}const c=n.deserializeTransformation(e);if(c){yield this.applyStateOnUI(c);const d=n.deserialize(e);d?(yield this.applyStateOnUI(d),yield this.editor.render(),this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),i()):r(a)}else r(a)});this.editor=e}serialize({image:e}={image:!1}){const t=this.editor.activeStore.tool===m.TRANSFORM;return this.editor.modalStore.showInfoModal("saving"),new Promise((i,r)=>{import("./serialization/index.js").then(n=>k(this,[n],function*({Serializer:o}){try{t&&this.editor.transformToolStore.onLeave(),yield this.editor.wait(),this.editor.transformToolStore.applyDefaultCrop(!1);const{originalImage:a}=this.editor.imageContainer.getData(),l=this.editor.engineMediator.output.container.getResolution(),c={width:a.width,height:a.height},d=new o(this.editor.transformToolStore.defaultCropMaskPosition,this.editor.transformToolStore.maxCropMaskSize,l,c,this.editor.engine.getRootContainers()[0],this.editor.engine.getOutputContainer()),u={[m.ADJUSTMENT]:Bi.toJS(this.editor.adjustmentsToolStore.state),[m.FILTER]:Bi.toJS(this.editor.filterToolStore.state),[m.FOCUS]:Bi.toJS(this.editor.focusToolStore.serializableState),[m.OVERLAY]:Bi.toJS(this.editor.overlayToolStore.state),[m.FRAME]:Bi.toJS(this.editor.frameToolStore.state),[m.BRUSH]:this.editor.brushToolStore.strokes||{strokes:[]}},{sprite:g,customStickers:y}=yield this.editor.spriteStore.serializableState();g.spriteIdList=g.spriteIdList.sort((T,z)=>{const K=g.common[T].order,re=g.common[z].order;return K-re}),u.sprite=g,u.customStickers=y,u.transform=this.editor.transformToolStore.serializableState;let E,D;if(e){const T=Vn.getDataURL(a);D=gp(T),E=bp(T)}this.editor.modalStore.hideModal(),i(d.serialise(u,E,D)),t&&this.editor.transformToolStore.onEnter()}catch(a){this.editor.modalStore.hideModal(),r(a)}}))})}deserialize(e){return this.editor.modalStore.showInfoModal("loading"),new Promise((t,i)=>{try{import("./serialization/index.js").then(({Deserializer:r})=>{r.checkIsSerialisationValid(e)?this.applySerialization(e,r,t,i):(this.editor.modalStore.hideModal(),this.editor.modalStore.showActionModal({type:ae.WARNING,identifier:"unsupportedSerializationVersion",handleConfirm:()=>this.applySerialization(e,r,t,i)}))})}catch(r){this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),i(r)}})}static getDataURL(e){if(e instanceof HTMLImageElement){const{src:r}=e;if(mp(r))return r}if(e instanceof HTMLCanvasElement)return e.toDataURL(At.PNG);const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");return i.drawImage(e,0,0),t.toDataURL(At.PNG)}applyStateOnUI(e){return k(this,null,function*(){const t=this.editor.activeStore.tool===m.TRANSFORM;try{e.transform&&(t||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(e.transform,!0),yield this.editor.wait(),t||(this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),yield this.editor.wait(),this.editor.transformToolStore.onLeave())),e.filter&&(yield this.editor.filterToolStore.updateStateFromSerialization(e.filter)),e.adjustment&&this.editor.adjustmentsToolStore.updateStateFromSerialization(e.adjustment),e.focus&&(yield this.editor.focusToolStore.updateStateFromSerialization(e.focus)),e.overlay&&(yield this.editor.overlayToolStore.updateStateFromSerialization(e.overlay)),e.sprite&&(e.sprite.spriteIdList=e.sprite.spriteIdList.sort((i,r)=>{const o=e.sprite.common[i].order,n=e.sprite.common[r].order;return o-n}),yield this.editor.spriteStore.updateStateFromSerialization(e.sprite,e.customStickers)),e.brush&&this.editor.brushToolStore.updateStateFromHistory(e.brush),e.frame&&(yield this.editor.frameToolStore.updateStateFromSerialization(e.frame)),this.editor.outputContainer.updateChildrenContainers()}catch(i){console.error(i),this.editor.modalStore.showActionModal({type:ae.ERROR,identifier:"unexpectedError",error:i,handleConfirm:()=>{window.location.reload()}})}})}}const _t={identifier:"identity",opacity:1,width:0,color:Be.white};const Q=h(p()),ei=h(p()),yp=new Yt(0,1);class ti{constructor(e){this.changeIdentifier=e=>{this.state.identifier=e};this.changeOpacity=e=>{const t=yp.clamp(e);this.state.opacity=t};this.changeWidth=e=>{this.state.width=e};this.changeColor=e=>{this.state.color=e};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=_t.identifier,this.state.opacity=_t.opacity,this.state.width=_t.width,this.state.color=_t.color,this.removeIndex())};this.removeFrameEffect=()=>{this.effect&&(this.engine.removeEffect(this.effect),this.effect=void 0)};this.setEffectProperties=e=>this.effect?(this.removeIndex(),this.effect.setProperties(e),this.effect.getProperties()):null;this.setFrameEffect=({identifier:e,width:t,opacity:i,color:r})=>{const o=f({},this.state);this.changeIdentifier(e),this.changeWidth(t),this.changeOpacity(i),this.changeColor(r),this.removeFrameEffect();const n=this.engineMediator.orderHelper.addSprite(e);return new Promise((a,l)=>{this.engine.addFrameFromAssets(e,this.engineMediator.image.container,n).then(c=>{this.effect=c,this.effect.setProperties({tintColor:r,opacity:i,width:t}),a()}).catch(c=>{this.changeIdentifier(o.identifier),this.changeOpacity(o.opacity),this.changeWidth(o.width),this.changeColor(o.color),o.identifier==="identity"&&this.removeIndex(),l(c)})})};this.removeIndex=()=>{this.engineMediator.orderHelper.removeSprite(this.state.identifier)};this.engineMediator=e,this.state=_t}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}}s([ei.observable],ti.prototype,"state",2),s([ei.action],ti.prototype,"changeIdentifier",2),s([ei.action],ti.prototype,"changeOpacity",2),s([ei.action],ti.prototype,"changeWidth",2),s([ei.action],ti.prototype,"changeColor",2),s([ei.action],ti.prototype,"reset",2);class ie{constructor(e){this.colorList=ce.defaultColors;this.selectFrame=e=>k(this,null,function*(){if(e!==this.identifier){const t=.1*this.editor.shortestOutputSide;yield this.frameStore.setFrameEffect({identifier:e,width:t,opacity:1,color:_t.color}),this.editor.render(),this.addSnapshot(O.ADD,m.FRAME)}});this.changeOpacity=e=>{const t=this.frameStore.setEffectProperties({opacity:e});t&&(this.frameStore.changeOpacity(t.opacity),this.editor.render())};this.changeWidth=e=>{const t=this.frameStore.setEffectProperties({width:e});t&&(this.frameStore.changeWidth(t.width),this.editor.render())};this.changeColor=e=>{const t=this.frameStore.setEffectProperties({tintColor:e});t&&(this.frameStore.changeColor(t.tintColor),this.editor.render())};this.colorSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.controls.selectColor)};this.toolSnapshot=e=>{this.addSnapshot(O.EDIT,e)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.pureReset=()=>{this.frameStore.removeFrameEffect(),this.frameStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(O.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromHistory=e=>e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.frameStore.setFrameEffect(e);this.updateStateFromSerialization=e=>k(this,null,function*(){const t=this.entityManager.items.find(i=>i.identifier===e.identifier);return t?this.frameStore.setFrameEffect(e):new Promise((i,r)=>{r(new Error("Frame Asset doesn't exist"))})});this.editor=e,this.frameStore=new ti(this.editor.engineMediator);const t=this.editor.assetProvider.getAssets("frame"),{config:i}=this;this.entityManager=new de(t,f(f({},i),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("frame")})),_t.color=Q.toJS(dt(this.config,"defaultColor",_t.color)),this.config.colors&&this.config.colors.length>0&&(this.colorList=ut(Q.toJS(this.config.colors)))}get state(){return this.frameStore.state}get identifier(){return this.state.identifier}get color(){return this.state.color}get size(){return this.state.width}get tintable(){const e=this.entityManager.items.find(t=>t.identifier===this.identifier);return e&&e.tintable||!1}get opacity(){return this.state.opacity}get minSize(){return this.editor.shortestOutputSide*.05}get maxSize(){return this.editor.shortestOutputSide*.3}get config(){return this.editor.configStore.config[m.FRAME]}get locale(){return this.editor.configStore.locale[m.FRAME]}get localeColor(){return this.editor.configStore.locale.common.color}get items(){return this.entityManager.items}get isOptionSelected(){return this.identifier!=="identity"}}s([Q.action],ie.prototype,"selectFrame",2),s([Q.action],ie.prototype,"changeOpacity",2),s([Q.action],ie.prototype,"changeWidth",2),s([Q.action],ie.prototype,"changeColor",2),s([Q.action],ie.prototype,"pureReset",2),s([Q.action],ie.prototype,"reset",2),s([Q.action],ie.prototype,"updateStateFromHistory",2),s([Q.action],ie.prototype,"updateStateFromSerialization",2),s([Q.computed],ie.prototype,"state",1),s([Q.computed],ie.prototype,"identifier",1),s([Q.computed],ie.prototype,"color",1),s([Q.computed],ie.prototype,"size",1),s([Q.computed],ie.prototype,"tintable",1),s([Q.computed],ie.prototype,"opacity",1),s([Q.computed],ie.prototype,"minSize",1),s([Q.computed],ie.prototype,"maxSize",1),s([Q.computed],ie.prototype,"config",1),s([Q.computed],ie.prototype,"locale",1),s([Q.computed],ie.prototype,"localeColor",1),s([Q.computed],ie.prototype,"items",1),s([Q.computed],ie.prototype,"isOptionSelected",1);const Te=h(p()),vp={categories:[],query:""};class Je{constructor(e){this.initProvider=e=>{e&&(this.libraryProvider=new e)};this.fetchImages=(e="")=>k(this,null,function*(){if(this.libraryProvider){let t=null;try{const i=yield this.libraryProvider.getCategories(),r=yield this.libraryProvider.searchImages(e);t=i.map((o,n)=>{const a=r.filter(l=>l.category===o.name);return{identifier:o.name,name:o.name,thumbnailURI:o.coverImageUrl,items:a.map(l=>({name:l.title||`image${n}`,identifier:`${o.name}-${l.title}-${n}`,thumbnailURI:l.thumbUrl,rawUrl:l.rawUrl,authorName:l.authorName,authorAvatar:l.authorAvatar}))}}).filter(o=>o.items.length)}catch(i){console.log(i)}Te.runInAction(()=>{this.state.query=e,this.state.categories=t})}});this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory!==e?e:""};this.getRawUrl=e=>{const t=this.items.findIndex(i=>i.identifier===e);return t!==-1?this.items[t].rawUrl:e};this.configStore=e.configStore,this.state=Te.observable(vp),this.selectedCategory=""}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.state.categories}get items(){return this.state.categories.map(e=>e.items).reduce((e,t)=>[...e,...t],[])}get query(){return this.state.query}get config(){return this.configStore.config[m.LIBRARY]}get locale(){return this.configStore.locale[m.LIBRARY]}}s([Te.observable],Je.prototype,"selectedCategory",2),s([Te.action],Je.prototype,"initProvider",2),s([Te.action],Je.prototype,"fetchImages",2),s([Te.action],Je.prototype,"toggleCategorySelection",2),s([Te.computed],Je.prototype,"selectedCategoryIdentifier",1),s([Te.computed],Je.prototype,"categories",1),s([Te.computed],Je.prototype,"items",1),s([Te.computed],Je.prototype,"query",1),s([Te.computed],Je.prototype,"config",1),s([Te.computed],Je.prototype,"locale",1);const fe=h(p()),ii=h(p()),yr={identifier:"identity",opacity:1,blendMode:Rt.LIGHTEN},Sp=new Yt(0,1);class ri{constructor(e,t){this.changeIdentifier=e=>{this.state.identifier=e};this.changeOpacity=e=>{const t=Sp.clamp(e);this.state.opacity=t};this.changeBlendMode=e=>{this.state.blendMode=e};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=yr.identifier,this.state.opacity=yr.opacity,this.state.blendMode=yr.blendMode,this.removeIndex())};this.correctOverlayFlip=()=>{const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();this.effect&&(this.effect.setFlipHorizontally(e),this.effect.setFlipVertically(t))};this.removeOverlayEffect=()=>{this.effect&&(this.removeIndex(),this.engineMediator.engine.removeEffect(this.effect),this.effect=void 0)};this.setEffectProperties=e=>this.effect?(this.effect.setProperties(e),this.effect.getProperties()):null;this.setOverlayEffect=({identifier:e,blendMode:t,opacity:i})=>{const r=f({},this.state);this.changeIdentifier(e),this.changeOpacity(i),this.changeBlendMode(t),this.removeOverlayEffect();const o=this.engineMediator.orderHelper.addIndex(m.OVERLAY);return new Promise((n,a)=>{this.engineMediator.engine.addOverlayFromAssets(e,this.engineMediator.image.container,o).then(l=>{this.effect=l,this.effect.setProperties({blendMode:t,opacity:i}),this.correctOverlayFlip(),n()}).catch(l=>{this.changeIdentifier(r.identifier),this.changeOpacity(r.opacity),this.changeBlendMode(r.blendMode),r.identifier==="identity"&&this.removeIndex(),a(l)})})};this.removeIndex=()=>{this.engineMediator.orderHelper.removeIndex(m.OVERLAY)};this.engineMediator=e,this.editor=t,this.state=yr}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}}s([ii.observable],ri.prototype,"state",2),s([ii.action],ri.prototype,"changeIdentifier",2),s([ii.action],ri.prototype,"changeOpacity",2),s([ii.action],ri.prototype,"changeBlendMode",2),s([ii.action],ri.prototype,"reset",2),s([ii.action],ri.prototype,"correctOverlayFlip",2);class me{constructor(e){this.selectOverlay=e=>k(this,null,function*(){if(e!==this.identifier){const t=this.defaultBlendModeForIdentifier(e);yield this.overlayStore.setOverlayEffect({identifier:e,opacity:1,blendMode:t}),this.addSnapshot(O.ADD,m.OVERLAY),this.editor.render()}});this.changeOpacity=e=>{const t=this.overlayStore.setEffectProperties({opacity:e});t&&(this.overlayStore.changeOpacity(t.opacity),this.editor.render())};this.toolSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.controls.sliderOpacity)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.changeBlendMode=e=>{const t=this.overlayStore.setEffectProperties({blendMode:e});t&&(this.overlayStore.changeBlendMode(t.blendMode),this.addSnapshot(O.EDIT,this.locale.controls.carouselBlendMode),this.editor.render())};this.pureReset=()=>{this.overlayStore.removeOverlayEffect(),this.overlayStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(O.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromSerialization=e=>k(this,null,function*(){const t=this.entityManager.items.find(i=>i.identifier===e.identifier);return t?this.overlayStore.setOverlayEffect(e):new Promise((i,r)=>{r(new Error(`Overlay Asset ${e.identifier} doesn't exist`))})});this.updateStateFromHistory=e=>k(this,null,function*(){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.overlayStore.setOverlayEffect(e)});this.correctOverlayFlip=()=>{this.overlayStore.correctOverlayFlip()};this.defaultBlendModeForIdentifier=e=>{const t=this.entityManager.items.findIndex(i=>i.identifier===e);return t!==-1?this.entityManager.items[t].defaultBlendMode:Rt.LIGHTEN};this.editor=e,this.overlayStore=new ri(this.editor.engineMediator,e);const t=this.editor.assetProvider.getAssets("overlay"),{config:i}=this;this.entityManager=new de(t,f(f({},i),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("overlay")}))}get state(){return this.overlayStore.state}get identifier(){return this.overlayStore.state.identifier}get opacity(){return this.overlayStore.state.opacity}get blendMode(){return this.overlayStore.state.blendMode}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[m.OVERLAY]}get locale(){return this.editor.configStore.locale[m.OVERLAY]}get items(){return this.entityManager.items}get allBlendModes(){const e=this.locale.controls;return Object.keys(Rt).map(t=>{const i=Rt[t],r=`blendMode${i.charAt(0).toUpperCase()}${i.slice(1)}`;return{identifier:i,value:e[r]}})}}s([fe.action],me.prototype,"selectOverlay",2),s([fe.action],me.prototype,"changeOpacity",2),s([fe.action],me.prototype,"changeBlendMode",2),s([fe.action],me.prototype,"pureReset",2),s([fe.action],me.prototype,"reset",2),s([fe.action],me.prototype,"updateStateFromSerialization",2),s([fe.action],me.prototype,"updateStateFromHistory",2),s([fe.action],me.prototype,"correctOverlayFlip",2),s([fe.computed],me.prototype,"state",1),s([fe.computed],me.prototype,"identifier",1),s([fe.computed],me.prototype,"opacity",1),s([fe.computed],me.prototype,"blendMode",1),s([fe.computed],me.prototype,"isOptionSelected",1),s([fe.computed],me.prototype,"config",1),s([fe.computed],me.prototype,"locale",1),s([fe.computed],me.prototype,"items",1),s([fe.computed],me.prototype,"allBlendModes",1);const Dp=e=>{const t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r);for(let n=0;n<t.length;n+=1)o[n]=t.charCodeAt(n);return new Blob([r],{type:i})};var Gn=Dp;const ao=h(qn());class Kn{static isImageElement(e){return e instanceof HTMLImageElement}constructor({license:e,assetProvider:t,crossOrigin:i}){this.crossOrigin=i,this.engine=new Xn({license:e,crossOrigin:i,assetProvider:t,downscaleOptions:{maxDimensions:{width:100,height:100}}})}getAllFilterPreviewThumbnails(e){return new Promise((t,i)=>{const r=[],o=[];e.forEach(n=>{n.isDuotone?r.push(n.identifier):o.push(n.identifier)}),this.getAllDuotonePreview(r).then(n=>{this.getAllLutPreview(o).then(a=>{t(Object.assign(n,a))})}).catch(n=>{i(n)})})}getAllDuotonePreview(e){return k(this,null,function*(){const t={};if(!e.length)return t;const i=yield this.engine.addDuoToneFilterFromAssets(e[0],this.container);return yield ao.default(e,r=>k(this,null,function*(){const o=this.engine.assetProvider.getDuotoneFilterAsset(r),n=i.filterOperation.getFilter();n.set({intensity:.5,lightColor:An.Color.fromHex(o.lightColor),darkColor:An.Color.fromHex(o.darkColor)});const a=yield this.engine.export(Mi.DATA_URL,At.PNG);t[r]=a}),{concurrency:1}),this.engine.removeEffect(i),t})}loadLutAssets(e){return k(this,null,function*(){const t={};return yield ao.default(e,i=>k(this,null,function*(){t[i]=yield this.engine.getLutFilterImage(i)})),t})}getAllLutPreview(e){return k(this,null,function*(){const t={};if(!e.length)return t;const i=yield this.loadLutAssets(e),r=yield this.engine.addLUTFilterFromAssets(e[0],this.container);return yield ao.default(e,o=>k(this,null,function*(){const n=this.engine.assetProvider.getLUTFilterAsset(o),a=r.filterOperation.getFilter(),l={horizontalTileCount:n.horizontalTileCount||5,verticalTileCount:n.verticalTileCount||5,image:i[o]};a.set(f(f({},l),{intensity:n.defaultIntensity||1})),r.setProperties({intensity:1}),a._lutPrimitive.set(l);const c=yield this.engine.export(Mi.DATA_URL,At.PNG);t[o]=c}),{concurrency:1}),this.engine.removeEffect(r),t})}addImageToContainer(e){return new Promise((t,i)=>{let r;Kn.isImageElement(e)?(r=e,this.setBackgroundImage(r),t()):this.getImageElement(e).then(o=>{r=o,this.setBackgroundImage(r),t()}).catch(o=>{i({identifier:"imageLoading",message:o.message})})})}getImageElement(e){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",o=>{i(o)}),r.crossOrigin=this.crossOrigin,r.src=e})}setBackgroundImage(e){this.container?this.container.setData({image:e}):this.container=this.engine.addImage({image:e,blendMode:Rt.NORMAL,opacity:1});const{size:t}=this.container.getBounds(),i=this.engine.getOutputContainer();i.setResolution(t)}}const q=h(p()),vr={size:0,color:Be.white,hardness:0,maximumSize:.125,minimumSize:0,maximumHardness:1,minimumHardness:0};class ee{constructor(e){this.colorList=ce.defaultColors;this.dirty=q.observable.box(!1);this.id="";this.containerId=()=>this.id;this.initSize=()=>{const{minimumSize:e,maximumSize:t}=this.state,{size:i}=this;i===0&&this.changeSize(In(this.config,"defaultSize",[e,t]))};this.changeColor=e=>{this.state.color=e};this.changeSize=e=>{this.state.size=e};this.changeRelativeSize=e=>{const{maximumSize:t,minimumSize:i}=this.state;this.state.size=(t-i)*e/100+i};this.changeHardness=e=>{this.state.hardness=e};this.reset=()=>{this.pureReset(),this.addSnapshot(O.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.editor=e,this.state=f(f({},vr),{hardness:In(this.config,"defaultHardness",[vr.minimumHardness,vr.maximumHardness]),color:q.toJS(dt(this.config,"defaultColor",vr.color))}),this.config.colors&&this.config.colors.length>0&&(this.colorList=ut(q.toJS(this.config.colors)))}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}clickableCanvas(e){this.editor.clickableCanvas(e)}beginStroke(e=[]){if(!this.drawingContainer){const t=this.editor.orderHelper.addSprite(m.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:e},this.editor.imageContainer,t)}this.id=this.drawingContainer.getID(),this.drawingContainer.beginStroke({id:"imgly_brush_radial",color:q.toJS(this.state.color),size:this.state.size,hardness:this.state.hardness})}strokePosition(e){if(this.drawingContainer){const t=this.editor.previewToWorld(e,!1);this.drawingContainer.addPointToCurrentStroke(t),this.editor.render()}}endStroke(){this.drawingContainer&&(this.drawingContainer.endStroke(),this.editor.render(),this.strokes=this.drawingContainer.getData(),this.addSnapshot(O.EDIT,this.locale.history.brushStroke),this.dirty.set(!0))}updateStateFromHistory(e){if(e=e||{strokes:[]},this.drawingContainer){if(this.strokes&&this.strokes.strokes.length===e.strokes.length)return;this.strokes=e,this.drawingContainer.setData(this.strokes),e.strokes.length!==0&&this.dirty.set(!0)}else{const t=this.editor.orderHelper.addSprite(m.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:e.strokes},this.editor.imageContainer,t),this.strokes=this.drawingContainer.getData()}this.id=this.drawingContainer.getID()}pureReset(){this.dirty.set(!1),this.strokes={strokes:[]},this.drawingContainer&&(this.editor.engine.removeContainer(this.drawingContainer),this.drawingContainer=void 0)}get config(){return this.editor.configStore.config[m.BRUSH]}get locale(){return this.editor.configStore.locale[m.BRUSH]}get localeColor(){return this.editor.configStore.locale.common.color}get color(){return this.state.color}get size(){return this.state.size}get relativeSize(){const{size:e,maximumSize:t,minimumSize:i}=this.state;return(e-i)*100/(t-i)}get sizeOnScreenSpace(){const e=this.editor.engineMediator.engine.getSmallerOutputSide();return this.editor.worldToPreview(this.state.size*e)}get hardness(){return this.state.hardness}get isDirty(){return this.dirty.get()}}s([q.observable],ee.prototype,"state",2),s([q.observable],ee.prototype,"dirty",2),s([q.action],ee.prototype,"initSize",2),s([q.action],ee.prototype,"changeColor",2),s([q.action],ee.prototype,"changeSize",2),s([q.action],ee.prototype,"changeRelativeSize",2),s([q.action],ee.prototype,"changeHardness",2),s([q.action],ee.prototype,"clickableCanvas",1),s([q.action],ee.prototype,"beginStroke",1),s([q.action],ee.prototype,"strokePosition",1),s([q.action],ee.prototype,"endStroke",1),s([q.action],ee.prototype,"updateStateFromHistory",1),s([q.action],ee.prototype,"reset",2),s([q.computed],ee.prototype,"config",1),s([q.computed],ee.prototype,"locale",1),s([q.computed],ee.prototype,"localeColor",1),s([q.computed],ee.prototype,"color",1),s([q.computed],ee.prototype,"size",1),s([q.computed],ee.prototype,"relativeSize",1),s([q.computed],ee.prototype,"sizeOnScreenSpace",1),s([q.computed],ee.prototype,"hardness",1),s([q.computed],ee.prototype,"isDirty",1);const ft=h(p());var mt;(function(e){e.LEADING="leading",e.CENTER="center",e.TRAILING="trailing"})(mt||(mt={}));const wp={horizontalGuides:[],verticalGuides:[],rotationGuides:[]};class Mt{constructor(e){this.previewTopLeftPosition={x:0,y:0};this.getGuideValue=(e,t)=>{const{height:i,width:r}=this.editor.getPreviewSize(),{snapToLeft:o,snapToRight:n,snapToTop:a,snapToBottom:l}=this.configStore.config.snapping.position,c=Math.min(i,r);let d=0;return t==="bottom"?d=Math.round(i-c*l):t==="top"?d=Math.round(c*a):t==="right"?d=Math.round(r-c*n):t==="left"?d=Math.round(c*o):e==="vertical"&&t==="center"?d=Math.round(r/2):e==="horizontal"&&t==="center"&&(d=Math.round(i/2)),d};this.getVerticalGuidesFromConfig=()=>{const{snapToVerticalCenter:e,snapToLeft:t,snapToRight:i}=this.configStore.config.snapping.position,r=[];return e&&r.push({value:this.getGuideValue("vertical","center"),edge:mt.CENTER,isVisible:!1,direction:"vertical"}),t&&r.push({value:this.getGuideValue("vertical","left"),edge:mt.LEADING,isVisible:!1,direction:"vertical"}),i&&r.push({value:this.getGuideValue("vertical","right"),edge:mt.TRAILING,isVisible:!1,direction:"vertical"}),r};this.getHorizontalGuidesFromConfig=()=>{const{snapToHorizontalCenter:e,snapToTop:t,snapToBottom:i}=this.configStore.config.snapping.position,r=[];return e&&r.push({value:this.getGuideValue("horizontal","center"),edge:mt.CENTER,isVisible:!1,direction:"horizontal"}),t&&r.push({value:this.getGuideValue("horizontal","top"),edge:mt.LEADING,isVisible:!1,direction:"horizontal"}),i&&r.push({value:this.getGuideValue("horizontal","bottom"),edge:mt.TRAILING,isVisible:!1,direction:"horizontal"}),r};this.getRotationGuidesFromConfig=()=>{const{angles:e}=this.configStore.config.snapping.rotation,t=[];e.forEach(r=>{t.push(r),t.push(r+360),t.push(r-360)});const i=t.filter((r,o)=>t.indexOf(r)===o);return i.map(r=>({value:r*Math.PI/180,edge:mt.CENTER,isVisible:!1,position:{x:0,y:0}}))};this.getSpriteDimensions=({leftTop:e,leftBottom:t,rightTop:i,rightBottom:r})=>{const o=Math.min(e.y,i.y,t.y,r.y),n=Math.max(e.y,i.y,t.y,r.y),a=Math.min(e.x,i.x,t.x,r.x),l=Math.max(e.x,i.x,t.x,r.x);return{height:Math.round(n-o),width:Math.round(l-a)}};this.mapRange=({value:e,fromMin:t,fromLength:i,toMin:r,toLength:o})=>(e-t)*o/i+r;this.updateGuides=()=>{this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig()};this.mapToSnapSystem=(e,t,i,r)=>{if(t.length===0)return e;if(t[0]>e)return e-i;for(let o=0;o<t.length-1;o+=1){const n=t[o],a=t[o+1];let l=n+i,c=a-i,d=0;r&&(d=o*i*2,l+=d,c+=d+i*2);const u=1e-5;if(n<=e&&e<=a)return e<=n+u?n+d:e>=a-u?a+d+(r?i*2:0):this.mapRange({value:e,fromMin:n,fromLength:a-n,toMin:l,toLength:c-l})}return r?e+(t.length-1)*i*2+i:e};this.mapFromSnapSystem=(e,t,i,r)=>{if(t.length===0)return e;if(t[0]>e)return e>=t[0]-i?t[0]:e+i;let o=e;for(let a=0;a<t.length-1;a+=1){const l=t[a],c=t[a+1],d=l+i;let u=c-i,g=c;if(r&&(u+=i*2,g+=i*2,o=e-a*i*2),l<=o&&o<=g)return d<=o&&o<=u?this.mapRange({value:o,fromMin:d,fromLength:u-d,toMin:l,toLength:c-l}):o<d?l:c}o-=i*3;const n=t[t.length-1];return o<=n?n:o};this.centerSnapValue=(e,t)=>{const i=t*.5,{value:r,edge:o}=e;let n=r;return o===mt.LEADING?n+=i:o===mt.TRAILING&&(n-=i),n};this.mapSnappingGuidesToCenter=(e,t)=>{const i=[];return e.forEach(r=>{i.push(this.centerSnapValue(r,t))}),i};this.calcSnapThresholdInRadians=(e,t)=>e===0?0:t/e;this.calculatePreviewTopLeftPosition=()=>{const e=this.editor.engineMediator.preview.container.getPosition(),t=this.editor.getPreviewSize(),i=ce.devicePixelRatio;this.previewTopLeftPosition={x:e.x/i-t.width/2,y:e.y/i-t.height/2}};this.snapToRotation=(e,t,i)=>{const{rotationGuides:r}=this.state,{enabled:o,threshold:n}=this.configStore.config.snapping.rotation,{x:a,y:l}=this.previewTopLeftPosition,{width:c}=this.editor.getPreviewSize();let d=(e+Math.PI*2)%(Math.PI*2);if(o){const u=new w(t).magnitude,g=r.map(D=>D.value).sort((D,T)=>D-T),y=this.calcSnapThresholdInRadians(u,n);if(!this.rotationOffset){const D=this.mapToSnapSystem(e,g,y,!1);this.rotationOffset=D-d}d=this.mapFromSnapSystem(d+this.rotationOffset,g,y,!1);const E={x:i.position.x-a-c,y:i.position.y-l};return r.forEach(D=>{D.isVisible=D.value===d,D.position=E}),d}return e};this.snapToPosition=(e,t)=>{const{horizontalGuides:i,verticalGuides:r}=this.state,{enabled:o,threshold:n}=this.configStore.config.snapping.position,a=new w(this.previewTopLeftPosition),{height:l,width:c}=this.getSpriteDimensions(t),{x:d,y:u}=new w(e).subtract(a);if(o){const g=this.mapSnappingGuidesToCenter(i,l).sort((T,z)=>T-z),y=this.mapSnappingGuidesToCenter(r,c).sort((T,z)=>T-z);if(!this.positionOffset){const T=this.mapToSnapSystem(d,y,n,!0),z=this.mapToSnapSystem(u,g,n,!0);this.positionOffset=new w(T,z).subtract(new w(d,u))}let E=this.mapFromSnapSystem(d+this.positionOffset.x,y,n,!0),D=this.mapFromSnapSystem(u+this.positionOffset.y,g,n,!0);return E=Math.round(E),D=Math.round(D),i.forEach(T=>{const z=Math.round(this.centerSnapValue(T,l));T.isVisible=z===D}),r.forEach(T=>{const z=Math.round(this.centerSnapValue(T,c));T.isVisible=z===E}),new w(E,D).add(a)}return{x:d,y:u}};this.editor=e,this.configStore=e.configStore,this.state=ft.observable(wp),this.rotationOffset=null,this.positionOffset=null,this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig(),this.state.rotationGuides=this.getRotationGuidesFromConfig()}hidePositionGuides(){this.positionOffset=null,this.state.verticalGuides=this.state.verticalGuides.map(e=>f(f({},e),{isVisible:!1})),this.state.horizontalGuides=this.state.horizontalGuides.map(e=>f(f({},e),{isVisible:!1}))}hideRotationGuides(){this.rotationOffset=null,this.state.rotationGuides=this.state.rotationGuides.map(e=>f(f({},e),{isVisible:!1}))}get positionGuides(){const{verticalGuides:e,horizontalGuides:t}=this.state;return[...e,...t]}get rotationGuides(){return this.state.rotationGuides}}s([ft.observable],Mt.prototype,"state",2),s([ft.action],Mt.prototype,"snapToRotation",2),s([ft.action],Mt.prototype,"snapToPosition",2),s([ft.action],Mt.prototype,"hidePositionGuides",1),s([ft.action],Mt.prototype,"hideRotationGuides",1),s([ft.computed],Mt.prototype,"positionGuides",1),s([ft.computed],Mt.prototype,"rotationGuides",1);const C=h(p());function co(e,t=null){return new Promise((i,r)=>{const o=new Image;o.addEventListener("load",()=>{const n=document.createElement("canvas"),a=n.getContext("2d");n.width=o.width,n.height=o.height,t&&(n.width=t,n.height=t*o.height/o.width),a.drawImage(o,0,0,n.width,n.height),i(n.toDataURL(oi.PNG))}),o.addEventListener("error",()=>{r()}),o.src=e})}const Il=e=>new Promise((t,i)=>{const r=new FileReader;r.onload=o=>k(void 0,null,function*(){try{const{result:n}=o.target,a=yield co(n,150);t({stickerURI:n,thumbnailURI:a,name:e.name||"",type:e.type,identifier:lo()})}catch(n){i(n)}}),r.onerror=o=>{i(o)},r.readAsDataURL(e)}),P=h(p()),xp="white",We={identifier:"identity",opacity:1,tintColor:Be[xp],tintMode:"none",resizeMode:"keepAspect"},Yn={},Ol="identity",Jn="imgly_sticker_custom";class W{constructor(e){this.state=P.observable.map(Yn);this.customStickers=[];this.colorList=ce.defaultColors;this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.doesStickerAssetExist=e=>this.entityManager.items.findIndex(t=>t.identifier===e)!==-1;this.add=e=>{const t=this.entityManager.items.find(o=>o.identifier===e),i=t?t.tintMode:We.tintMode,r=t?t.resizeMode:We.resizeMode;this.editor.spriteStore.addSticker({state:{identifier:e,tintMode:i,tintColor:We.tintColor,opacity:We.opacity,resizeMode:r}})};this.duplicate=()=>{if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id),t=this.editor.spriteStore.getDuplicateContainerFlip(this.id),{flipHorizontally:i,flipVertically:r}=this.editor.outputContainer.getData();this.editor.spriteStore.addSticker({state:{identifier:this.identifier,tintColor:P.toJS(this.tintColor),tintMode:this.tintMode,resizeMode:this.resizeMode,opacity:this.opacity,flipHorizontally:i!==t.flipHorizontally,flipVertically:r!==t.flipVertically},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.flipHorizontally=()=>{this.id&&this.editor.spriteStore.flipHorizontally(this.id)};this.delete=()=>{if(this.id){const e=this.id;this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast()}};this.updateStateFromHistory=(e,t)=>{this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)};this.setState=(e,t)=>{const i=this.state.get(e);i?("opacity"in t&&(i.opacity=t.opacity),t.tintColor&&(i.tintColor=t.tintColor),t.tintMode&&(i.tintMode=t.tintMode),t.resizeMode&&(i.resizeMode=t.resizeMode),this.state.set(e,i)):this.state.set(e,{identifier:t.identifier,opacity:t.opacity,tintMode:t.tintMode,resizeMode:t.resizeMode,tintColor:t.tintColor?t.tintColor:We.tintColor})};this.changeOpacity=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{opacity:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.opacity=i.opacity,this.state.set(this.id,t)}}};this.changeTintColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){const{tintMode:i}=this.entityManager.items.find(o=>o.identifier===this.identifier);this.editor.spriteStore.setContainerProperties(this.id,{tintColor:e,tintMode:i});const r=this.editor.spriteStore.getContainerProperties(this.id);t.tintColor=r.tintColor,t.tintMode=r.tintMode||We.tintMode,this.state.set(this.id,t)}}};this.tintColorSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.history.color)};this.addFiles=e=>k(this,null,function*(){if(this.editor.modalStore.showInfoModal("loading"),e.length){let t=0;const i=[];for(t=0;t<e.length;t+=1)i.push(Il(e[t]));try{const r=yield Promise.all(i);this.addCustomStickerAsset(r),this.editor.configStore.events.onStickerUploadedAdd(r.map(({identifier:o,stickerURI:n},a)=>({identifier:o,stickerURI:n,file:e[a]})))}catch(r){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}}});this.addCustomStickerAsset=e=>k(this,null,function*(){const t=[];e.forEach(({stickerURI:n,thumbnailURI:a,name:l,identifier:c,type:d})=>{t.push({stickerURI:n,thumbnailURI:a,name:l,tintMode:this.customStickerTintMode,resizeMode:"keepAspect",identifier:c}),this.customStickers.push({identifier:c,type:d,stickerURI:n,name:l})});const i=this.locale.categories[Jn];this.editor.assetProvider.addCustomStickerAsset(t,Jn,i);const r=this.editor.assetProvider.getAssets("sticker"),{config:o}=this;this.entityManager=new de(r,f(f({},o),{categoryKey:"thumbnailURI",itemKey:"stickerURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("sticker")})),this.selectedCategory=Jn,this.editor.modalStore.hideModal()});this.toolSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.history.opacity)};this.addSnapshot=(e,t)=>{this.currentSticker&&this.editor.spriteStore.addSnapshot(e,t)};this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory===e?Ol:e};this.pureReset=()=>{this.state=P.observable.map(Yn)};this.editor=e,this.selectedCategory=Ol;const{config:t}=this,i=this.editor.assetProvider.getAssets("sticker");this.entityManager=new de(i,f(f({},t),{categoryKey:"thumbnailURI",itemKey:"stickerURI",locale:f(f({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("sticker")})),We.tintColor=P.toJS(dt(this.config,"defaultTintColor",We.tintColor)),this.config.colors&&this.config.colors.length>0&&(this.colorList=ut(P.toJS(this.config.colors)))}get isStickerSelected(){return this.editor.spriteStore.isSpriteSticker}get isCustomStickerEnabled(){return this.config.enableCustomUpload}get customStickerTintMode(){return this.config.customStickerTintMode}get currentSticker(){if(this.isStickerSelected){const e=this.state.get(this.id);if(e)return e}return}get identifier(){if(this.isStickerSelected){const e=this.state.get(this.id);if(e)return e.identifier}return"none"}get id(){return this.isStickerSelected?this.editor.spriteStore.id:void 0}get opacity(){return this.currentSticker?this.currentSticker.opacity:We.opacity}get tintMode(){return this.currentSticker?this.currentSticker.tintMode:We.tintMode}get resizeMode(){return this.currentSticker?this.currentSticker.resizeMode:We.resizeMode}get tintable(){return this.currentSticker?this.currentSticker.tintMode==="solid"||this.currentSticker.tintMode==="colorized":!1}get tintColor(){return this.currentSticker?this.currentSticker.tintColor:We.tintColor}get config(){return this.editor.configStore.config[m.STICKER]}get locale(){return this.editor.configStore.locale[m.STICKER]}get localeColor(){return this.editor.configStore.locale.common.color}get selectedCategoryIdentifier(){return this.selectedCategory}get items(){return this.entityManager.items}get categories(){return this.entityManager.categories}}s([P.observable],W.prototype,"selectedCategory",2),s([P.observable],W.prototype,"entityManager",2),s([P.action],W.prototype,"selectLast",2),s([P.action],W.prototype,"add",2),s([P.action],W.prototype,"duplicate",2),s([P.action],W.prototype,"bringToFront",2),s([P.action],W.prototype,"flipHorizontally",2),s([P.action],W.prototype,"delete",2),s([P.action],W.prototype,"updateStateFromHistory",2),s([P.action],W.prototype,"setState",2),s([P.action],W.prototype,"changeOpacity",2),s([P.action],W.prototype,"changeTintColor",2),s([P.action],W.prototype,"addFiles",2),s([P.action],W.prototype,"addCustomStickerAsset",2),s([P.action],W.prototype,"toggleCategorySelection",2),s([P.action],W.prototype,"pureReset",2),s([P.computed],W.prototype,"isStickerSelected",1),s([P.computed],W.prototype,"isCustomStickerEnabled",1),s([P.computed],W.prototype,"customStickerTintMode",1),s([P.computed],W.prototype,"currentSticker",1),s([P.computed],W.prototype,"identifier",1),s([P.computed],W.prototype,"id",1),s([P.computed],W.prototype,"opacity",1),s([P.computed],W.prototype,"tintMode",1),s([P.computed],W.prototype,"resizeMode",1),s([P.computed],W.prototype,"tintable",1),s([P.computed],W.prototype,"tintColor",1),s([P.computed],W.prototype,"config",1),s([P.computed],W.prototype,"locale",1),s([P.computed],W.prototype,"localeColor",1),s([P.computed],W.prototype,"selectedCategoryIdentifier",1),s([P.computed],W.prototype,"items",1),s([P.computed],W.prototype,"categories",1);const F=h(p()),Cp="imgly_font_open_sans_bold",Y={text:"Write Something",identifier:Cp,fontSize:73.3,defaultFontSize:73.3,fontFamily:"Open Sans",fontStyle:"",fontWeight:"bold",lineHeight:1,alignment:"center",textColor:Be.white,backgroundColor:Be.transparent||[0,0,0,0],width:0},Zn={},Rl={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"SemiBold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular",lighter:"Lighter"};class I{constructor(e){this.state=F.observable.map(Zn);this.colorList=ce.defaultColors;this.backgroundColorList=ce.defaultBackgroundColors;this.loadingObservable=F.observable.box(!1);this.loadfonts=e=>{if(this.fontsLoaded)e();else{const t=this.editor.assetProvider.getFontManager(),i=this.editor.assetProvider.getFontAssetsForText().map(r=>r.identifier);t.loadFontsWithIdentifiers(i).then(()=>{this.loadingObservable.set(!0),e()}).catch(r=>{console.error(r),this.editor.modalStore.showActionModal({type:ae.ERROR,identifier:"fontLoading",error:r})})}};this.doesTextAssetExist=e=>this.editor.assetProvider.getFontAssets().findIndex(t=>t.identifier===e)!==-1;this.validFontWithConfig=e=>this.fonts.find(t=>t.identifier===e)||this.fonts[0];this.addOrselect=()=>{this.state.size?this.selectLast():this.add()};this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.add=()=>{const e=()=>{this.editor.spriteStore.addText({state:{identifier:Y.identifier,text:Y.text,textColor:Y.textColor,backgroundColor:Y.backgroundColor,lineHeight:Y.lineHeight,alignment:Y.alignment,fontSize:0}})};this.loadfonts(e)};this.duplicate=()=>{if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addText({state:{identifier:this.identifier,text:this.text,textColor:F.toJS(this.textColor),lineHeight:this.lineHeight,alignment:this.alignment,fontSize:this.fontSize,backgroundColor:F.toJS(this.backgroundColor),width:this.width},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.delete=()=>{if(this.id){const e=this.id;this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast()}};this.setEditMode=e=>{this.editor.spriteStore.setEditMode(e)};this.changeFont=e=>{const t=this.fonts.find(i=>i.identifier===e);this.changeIdentifier(t,this.id),this.id&&this.addSnapshot(O.EDIT,this.locale.history.fontFamily)};this.changeIdentifier=(e,t)=>{F.runInAction(()=>{if(e&&t){const i=this.state.get(t);if(i){this.editor.spriteStore.setContainerProperties(t,{fontIdentifier:e.identifier},!0);const r=this.editor.spriteStore.getContainerProperties(t);i.identifier=r.fontIdentifier,i.fontFamily=e.fontFamily,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.fontSize=r.fontSize,i.width=r.width,i.defaultFontSize=i.fontSize,this.state.set(t,i)}}})};this.changeFontSize=(e,t=!1)=>{if(this.id){const i=this.state.get(this.id);i&&(i.fontSize=e,t&&(i.defaultFontSize=e),this.state.set(this.id,i))}};this.updateDefaultFontSize=()=>{if(this.id){const e=this.state.get(this.id);e&&(e.defaultFontSize=e.fontSize,this.state.set(this.id,e))}};this.changeSize=(e,t)=>{const i=this.state.get(e);i&&(i.width=t.width,i.fontSize=t.fontSize,i.defaultFontSize=t.fontSize,this.state.set(e,i))};this.changeWidth=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.width=e,this.state.set(this.id,t))}};this.changeText=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{text:e},!0);let i=this.editor.spriteStore.getContainerProperties(this.id);const r=this.editor.outputContainer.getSizeInOutputSpace(),o=this.editor.spriteStore.getSize(this.id);this.config.disableAutoScaling||o.height>r.height&&this.editor.spriteStore.setContainerProperties(this.id,{fontSize:this.calculateFitFontSize(this.id,r.height)},!0),i=this.editor.spriteStore.getContainerProperties(this.id),t.text=i.text,t.fontSize=i.fontSize,t.defaultFontSize=i.fontSize,this.state.set(this.id,t),this.addSnapshot(O.EDIT,this.locale.history.edit)}}};this.calculateFitFontSize=(e,t)=>{if(!I.measureContext){const y=document.createElement("canvas");I.measureContext=y.getContext("2d")}const i=this.editor.spriteStore.getContainerProperties(e),r=this.editor.engine.assetProvider.getFontManager().getFontWithId(i.fontIdentifier),o=this.config.minFontSizeForAutoScaling,n=Al(I.measureContext,i.text,r,i.fontSize,i.lineHeight,i.width,r.textMetrics),a=Math.min(Math.floor(i.fontSize*(t/n.height)),1),l=Math.round(i.fontSize);let c=0,d=l-a,u=Math.floor((l-a)*2),g=d;for(;c<=u;){d=c+Math.floor((u-c)/2);const y=Al(I.measureContext,i.text,r,d,i.lineHeight,i.width,r.textMetrics);if(t<y.height)u=d-1,g=d-1;else if(t>y.height){if(c=d+1,a+d>=l)return l}else{g=d;break}}return o&&g<o?o:g};this.changeLineHeight=e=>{if(this.id){const t=this.state.get(this.id);if(t&&e){this.editor.spriteStore.setContainerProperties(this.id,{lineHeight:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.lineHeight=i.lineHeight,this.state.set(this.id,t)}}};this.changeColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{textColor:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.textColor=i.textColor,this.state.set(this.id,t)}}};this.changeBackgroundColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{backgroundColor:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.backgroundColor=i.backgroundColor,this.state.set(this.id,t)}}};this.colorSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.history.textColor)};this.backgroundColorSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.history.backgroundColor)};this.changeAlignment=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{alignment:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.alignment=i.alignment,this.state.set(this.id,t),this.addSnapshot(O.EDIT,this.locale.history.alignment)}}};this.toolSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.history.lineSpacing)};this.addSnapshot=(e,t)=>{this.currentText&&this.editor.spriteStore.addSnapshot(e,t)};this.updateStateFromHistory=(e,t)=>{this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)};this.setState=(e,t)=>{const i=this.state.get(e);if(i)t.alignment&&(i.alignment=t.alignment),t.text&&(i.text=t.text),t.lineHeight&&(i.lineHeight=t.lineHeight),t.textColor&&(i.textColor=t.textColor),t.backgroundColor&&(i.backgroundColor=t.backgroundColor),t.fontIdentifier&&(i.identifier=t.fontIdentifier),t.fontSize&&(i.fontSize=t.fontSize,i.defaultFontSize=t.fontSize),t.width&&(i.width=t.width);else{const r=this.validFontWithConfig(t.fontIdentifier);r&&this.state.set(e,{text:t.text,identifier:r.identifier,alignment:t.alignment,textColor:t.textColor?t.textColor:Y.textColor,backgroundColor:t.backgroundColor?t.backgroundColor:Y.backgroundColor,fontFamily:r.fontFamily,fontStyle:r.fontStyle,fontSize:t.fontSize,fontWeight:r.fontWeight,lineHeight:t.lineHeight,width:t.width,defaultFontSize:t.fontSize})}};this.setFontSize=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{fontSize:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.fontSize=i.fontSize,t.defaultFontSize=i.fontSize,this.state.set(this.id,t)}}};this.pureReset=()=>{this.state=F.observable.map(Zn)};this.editor=e,this.fonts.find(t=>t.identifier===Y.identifier)||(Y.identifier=this.fonts[0].identifier),Y.textColor=F.toJS(dt(this.config,"defaultColor",Y.textColor)),Y.backgroundColor=F.toJS(dt(this.config,"defaultBackgroundColor",Y.backgroundColor)),Y.text=this.locale.canvasControls.placeholderText,this.config.colors&&this.config.colors.length>0&&(this.colorList=ut(F.toJS(this.config.colors))),this.config.backgroundColors&&this.config.backgroundColors.length>0&&(this.backgroundColorList=ut(F.toJS(this.config.backgroundColors)))}static defaultText(){return Y.text}static getDisplayFontStyle(e){const t=e.fontWeight&&Rl[e.fontWeight].toLowerCase()!=="regular"?Rl[e.fontWeight]:"",i=e.fontStyle&&e.fontStyle.toLowerCase()!=="normal"?e.fontStyle:"";return`${e.fontFamily.toLowerCase().includes(t.toLowerCase())?"":t} ${i}`.trim()}get isEditMode(){return this.editor.spriteStore.isEditMode}get isTextSelected(){return this.editor.spriteStore.isSpriteText}get fontsLoaded(){return this.loadingObservable.get()}get currentText(){if(this.isTextSelected){const e=this.state.get(this.id);if(e)return e}return}get text(){return this.currentText?this.currentText.text:Y.text}get fontSize(){return this.currentText?this.currentText.fontSize:Y.fontSize}get defaultFontSize(){return this.currentText?this.currentText.defaultFontSize:Y.defaultFontSize}get width(){return this.currentText?this.currentText.width:Y.width}get fontFamily(){return this.currentText?this.currentText.fontFamily:Y.fontFamily}get fontStyle(){return this.currentText?this.currentText.fontStyle:Y.fontStyle}get fontWeight(){return this.currentText?this.currentText.fontWeight:Y.fontWeight}get lineHeight(){return this.currentText?this.currentText.lineHeight:Y.lineHeight}get identifier(){return this.currentText?this.currentText.identifier:Y.identifier}get id(){return this.isTextSelected?this.editor.spriteStore.id:void 0}get alignment(){return this.currentText?this.currentText.alignment:Y.alignment}get textColor(){return this.currentText?this.currentText.textColor:Y.textColor}get backgroundColor(){return this.currentText?this.currentText.backgroundColor:Y.backgroundColor}get config(){return this.editor.configStore.config[m.TEXT]}get locale(){return this.editor.configStore.locale[m.TEXT]}get localeColor(){return this.editor.configStore.locale.common.color}get rawOptions(){return this.editor.assetProvider.getFontAssetsForText()}get fonts(){return this.rawOptions.reduce((e,t)=>this.rawOptions.find(i=>i.identifier===t.identifier)?[...e,{identifier:t.identifier,fontFamily:t.fontFamily,fontStyle:t.fontStyle||"",fontWeight:t.fontWeight||""}]:e,[])}get fontFamilies(){return[...new Set(this.fonts)]}}s([F.action],I.prototype,"addOrselect",2),s([F.action],I.prototype,"selectLast",2),s([F.action],I.prototype,"add",2),s([F.action],I.prototype,"duplicate",2),s([F.action],I.prototype,"bringToFront",2),s([F.action],I.prototype,"delete",2),s([F.action],I.prototype,"setEditMode",2),s([F.action],I.prototype,"changeFont",2),s([F.action],I.prototype,"changeIdentifier",2),s([F.action],I.prototype,"changeFontSize",2),s([F.action],I.prototype,"updateDefaultFontSize",2),s([F.action],I.prototype,"changeSize",2),s([F.action],I.prototype,"changeWidth",2),s([F.action],I.prototype,"changeText",2),s([F.action],I.prototype,"changeLineHeight",2),s([F.action],I.prototype,"changeColor",2),s([F.action],I.prototype,"changeBackgroundColor",2),s([F.action],I.prototype,"changeAlignment",2),s([F.action],I.prototype,"updateStateFromHistory",2),s([F.action],I.prototype,"setState",2),s([F.action],I.prototype,"setFontSize",2),s([F.action],I.prototype,"pureReset",2),s([F.computed],I.prototype,"isEditMode",1),s([F.computed],I.prototype,"isTextSelected",1),s([F.computed],I.prototype,"fontsLoaded",1),s([F.computed],I.prototype,"currentText",1),s([F.computed],I.prototype,"text",1),s([F.computed],I.prototype,"fontSize",1),s([F.computed],I.prototype,"defaultFontSize",1),s([F.computed],I.prototype,"width",1),s([F.computed],I.prototype,"fontFamily",1),s([F.computed],I.prototype,"fontStyle",1),s([F.computed],I.prototype,"fontWeight",1),s([F.computed],I.prototype,"lineHeight",1),s([F.computed],I.prototype,"identifier",1),s([F.computed],I.prototype,"id",1),s([F.computed],I.prototype,"alignment",1),s([F.computed],I.prototype,"textColor",1),s([F.computed],I.prototype,"backgroundColor",1),s([F.computed],I.prototype,"config",1),s([F.computed],I.prototype,"locale",1),s([F.computed],I.prototype,"localeColor",1),s([F.computed],I.prototype,"rawOptions",1),s([F.computed],I.prototype,"fonts",1),s([F.computed],I.prototype,"fontFamilies",1);const B=h(p()),_p="imgly_text_design_blocks",ue={identifier:_p,color:Be.white,isInverted:!1,text:"Write Something With Style",seed:0,padding:0,width:0},Qn={imgly_text_design_blocks:835,imgly_text_design_rotated:6,imgly_text_design_blocks_light:3,imgly_text_design_equal_width:727,imgly_text_design_masked:259,imgly_text_design_celebrate:579,imgly_text_design_sunshine:77,imgly_text_design_masked_badge:683,imgly_text_design_blocks_condensed:673,imgly_text_design_celebrate_simple:425,imgly_text_design_equal_width_fat:961,imgly_text_design_watercolor:671,imgly_text_design_particles:683,imgly_text_design_masked_speech_bubble:317,imgly_text_design_masked_speech_bubble_comic:229,imgly_text_design_multiline:831},es={};class ${constructor(e){this.state=B.observable.map(es);this.colorList=ce.defaultColors;this.fontsLoaded=!1;this.loadfonts=e=>{if(this.fontsLoaded)e();else{const t=this.editor.assetProvider.getFontManager(),i=this.editor.assetProvider.getFontAssetsForTextDesign().map(r=>r.identifier);t.loadFontsWithIdentifiers(i).then(()=>{this.fontsLoaded=!0,e()}).catch(r=>{console.error(r),this.editor.modalStore.showActionModal({type:ae.ERROR,identifier:"fontLoading",error:i[0]})})}};this.doesTextDesignAssetExist=e=>this.entityManager.items.findIndex(t=>t.identifier===e)!==-1;this.addOrselect=()=>{this.state.size?this.selectLast():this.add()};this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.add=()=>{const e=()=>{this.editor.spriteStore.addTextDesign({state:{identifier:ue.identifier,text:ue.text,color:ue.color,isInverted:ue.isInverted,seed:Qn[ue.identifier]||ue.seed,padding:0}})};this.loadfonts(e)};this.updateStateFromHistory=(e,t)=>{const i=this.state.get(e);t.identifier===i.identifier?(this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)):this.changeIdentifier(t.identifier,!1,t.seed,e)};this.setState=(e,t)=>{const i=this.state.get(e);i?(t.inverted&&(i.isInverted=t.inverted),t.seed&&(i.seed=t.seed),t.color&&(i.color=t.color),t.padding&&(i.padding=t.padding),t.width&&(i.width=t.width)):this.state.set(e,{width:t.width,text:t.text,isInverted:t.inverted,identifier:t.identifier,seed:t.seed,color:t.color?t.color:ue.color,padding:t.padding})};this.changeText=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{text:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.text=i.text,this.state.set(this.id,t),this.addSnapshot(O.EDIT,this.locale.history.edit)}}};this.setEditMode=e=>{this.editor.spriteStore.setEditMode(e)};this.duplicate=()=>{if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addTextDesign({state:{identifier:this.identifier,text:this.text,color:B.toJS(this.color),isInverted:this.isInverted,seed:this.seed,padding:this.padding,width:this.width},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.addSnapshot=(e,t)=>{this.currentTextDesign&&this.editor.spriteStore.addSnapshot(e,t)};this.delete=(e=this.id)=>{e&&(this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast())};this.changeSeed=()=>{if(this.id){const e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{seed:-1},!0);const t=this.editor.spriteStore.getContainerProperties(this.id);e.seed=t.seed,this.state.set(this.id,e),this.addSnapshot(O.EDIT,this.locale.history.shuffle)}}};this.changeIdentifier=(e,t=!0,i=null,r=this.id)=>{if(r&&e!==this.identifier){const o=this.state.get(r),n=this.editor.spriteStore.getContainerTransform(r);this.editor.spriteStore.addTextDesign({spriteId:r,state:{identifier:e,text:o.text,color:B.toJS(o.color),isInverted:o.isInverted,seed:i||Qn[e]||o.seed,padding:o.padding,width:o.width},transform:n},t,!0)}};this.changeColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{color:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.color=i.color,this.state.set(this.id,t)}}};this.colorSnapshot=()=>{this.addSnapshot(O.EDIT,this.locale.history.color)};this.invertBackground=()=>{if(this.id){const e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{inverted:!e.isInverted},!0);const t=this.editor.spriteStore.getContainerProperties(this.id);e.isInverted=t.inverted,this.state.set(this.id,e),this.addSnapshot(O.EDIT,this.locale.history.invert)}}};this.changeWidth=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.width=e,this.state.set(this.id,t))}};this.changePadding=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.padding=e,this.state.set(this.id,t))}};this.pureReset=()=>{this.state=B.observable.map(es)};this.editor=e;const t=this.editor.assetProvider.getAssets("textdesign");this.entityManager=new de(t,f(f({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:{},getAssetPath:this.editor.getAssetPath("textdesign")})),this.entityManager.items.find(i=>i.identifier===ue.identifier)||(ue.identifier=this.entityManager.items[0].identifier),ue.text=this.locale.canvasControls.placeholderText,ue.color=B.toJS(dt(this.config,"defaultColor",ue.color)),this.config.colors&&this.config.colors.length>0&&(this.colorList=ut(B.toJS(this.config.colors)))}static defaultText(){return ue.text}get isTextDesignSelected(){return this.editor.spriteStore.isSpriteTextDesign}get isEditMode(){return this.editor.spriteStore.isEditMode}get currentTextDesign(){if(this.isTextDesignSelected&&this.id){const e=this.state.get(this.id);if(e)return e}return}get id(){return this.isTextDesignSelected?this.editor.spriteStore.id:void 0}get text(){return this.currentTextDesign?this.currentTextDesign.text:ue.text}get seed(){return this.currentTextDesign?this.currentTextDesign.seed:ue.seed}get padding(){return this.currentTextDesign?this.currentTextDesign.padding:ue.padding}get width(){return this.currentTextDesign?this.currentTextDesign.width:ue.width}get identifier(){return this.currentTextDesign?this.currentTextDesign.identifier:null}get isInverted(){return this.currentTextDesign?this.currentTextDesign.isInverted:ue.isInverted}get color(){return this.currentTextDesign?this.currentTextDesign.color:ue.color}get config(){return this.editor.configStore.config[m.TEXT_DESIGN]}get locale(){return this.editor.configStore.locale[m.TEXT_DESIGN]}get localeColor(){return this.editor.configStore.locale.common.color}get items(){return this.entityManager.items}}s([B.action],$.prototype,"addOrselect",2),s([B.action],$.prototype,"selectLast",2),s([B.action],$.prototype,"add",2),s([B.action],$.prototype,"updateStateFromHistory",2),s([B.action],$.prototype,"setState",2),s([B.action],$.prototype,"changeText",2),s([B.action],$.prototype,"setEditMode",2),s([B.action],$.prototype,"duplicate",2),s([B.action],$.prototype,"bringToFront",2),s([B.action],$.prototype,"delete",2),s([B.action],$.prototype,"changeSeed",2),s([B.action],$.prototype,"changeIdentifier",2),s([B.action],$.prototype,"changeColor",2),s([B.action],$.prototype,"invertBackground",2),s([B.action],$.prototype,"changeWidth",2),s([B.action],$.prototype,"changePadding",2),s([B.action],$.prototype,"pureReset",2),s([B.computed],$.prototype,"isTextDesignSelected",1),s([B.computed],$.prototype,"isEditMode",1),s([B.computed],$.prototype,"currentTextDesign",1),s([B.computed],$.prototype,"id",1),s([B.computed],$.prototype,"text",1),s([B.computed],$.prototype,"seed",1),s([B.computed],$.prototype,"padding",1),s([B.computed],$.prototype,"width",1),s([B.computed],$.prototype,"identifier",1),s([B.computed],$.prototype,"isInverted",1),s([B.computed],$.prototype,"color",1),s([B.computed],$.prototype,"config",1),s([B.computed],$.prototype,"locale",1),s([B.computed],$.prototype,"localeColor",1),s([B.computed],$.prototype,"items",1);const Ep=e=>({height:e.y,width:e.x}),kp={},uo="none",Tp={position:{x:0,y:0},rotation:0};class _{constructor(e){this.state=C.observable.map(kp);this.selectedId=C.observable.box(uo);this.editMode=C.observable.box(!1);this.dragMode=C.observable.box(!1);this.minLength=0;this.addSticker=(e,t=!0)=>k(this,null,function*(){yield this.addStickerAsync(e,t)});this.addStickerAsync=(o,...n)=>k(this,[o,...n],function*({spriteId:e,state:t,transform:i},r=!0){return new Promise((a,l)=>{i=this.getInitialTransform(i);const{identifier:c}=t,d=this.editor.orderHelper.addSprite(c);this.editor.engine.addStickerFromAssets(c,this.editor.engineMediator.image.container,d).then(u=>k(this,null,function*(){e&&u.setData({id:e});const g=u.getID();this.container[g]=u,this.editor.orderHelper.renameSprite(c,g);const y=this.getSize(g);y.width*=u.getScale().x,y.height*=u.getScale().y,u.setPivot(.5,.5);let E;if(i.scale)E=i.scale;else if(i.size)E={x:i.size.width/y.width,y:i.size.height/y.height};else{const K=this.editor.shortestOutputSide*.4,re=_.magnitude(K)/_.sizeMagnitude(u.getSizeInWorldSpace());E={x:re,y:re}}const{flipHorizontally:D,flipVertically:T}=this.editor.outputContainer.getData();u.setFlipHorizontally(D),u.setFlipVertically(T),u.setTransform({position:i.position,scale:E,rotation:i.rotation}),t.flipHorizontally!==void 0&&u.setFlipHorizontally(t.flipHorizontally!==D),t.flipVertically!==void 0&&u.setFlipVertically(t.flipVertically!==T),this.setContainerProperties(g,f({},t));const z=u.getData();this.setInitialSpriteState(g,m.STICKER),this.stickerToolStore.setState(g,f(f({},z),{identifier:c})),yield this.editor.renderPromise(),r&&(this.selectedId.set(g),this.addSnapshot(O.ADD,this.stickerLocale.add)),a()})).catch(u=>{console.error(u),l()})})});this.addText=(e,t=!0)=>k(this,null,function*(){yield this.addTextAsync(e,t)});this.addTextAsync=({spriteId:e,state:t,transform:i},r=!0)=>new Promise((o,n)=>{i=this.getInitialTransform(i);const a=this.editor.orderHelper.addSprite(t.identifier),l=this.editor.shortestOutputSide,c={fontIdentifier:t.identifier,text:t.text,width:t.width||l*.6,fontSize:t.fontSize||l*.1,lineHeight:t.lineHeight,alignment:t.alignment,textColor:t.textColor,backgroundColor:t.backgroundColor};this.editor.engine.addTextWithFontLoading(c,this.editor.engineMediator.image.container,a).then(d=>k(this,null,function*(){e&&d.setData({id:e});const u=d.getID();this.container[u]=d,this.editor.orderHelper.renameSprite(t.identifier,this.id);const{flipHorizontally:g,flipVertically:y}=this.editor.outputContainer.getData();d.setFlipHorizontally(g),d.setFlipVertically(y),d.setPivot(.5,.5),d.setPosition(i.position),d.setRotation(i.rotation),this.setInitialSpriteState(u,m.TEXT);const E=d.getData();this.textToolStore.setState(u,f({},E)),yield this.editor.renderPromise(),r&&(this.selectedId.set(u),this.addSnapshot(O.ADD,this.textLocale.add)),o()})).catch(d=>{console.error(d),n()})});this.addTextDesign=(e,t=!0,i=!1)=>k(this,null,function*(){yield this.addTextDesignAsync(e,t,i)});this.addTextDesignAsync=({spriteId:e,state:t,transform:i},r=!0,o=!1)=>new Promise((n,a)=>{i=this.getInitialTransform(i);const l=this.editor.orderHelper.addSprite(t.identifier),c=this.editor.shortestOutputSide,d={width:t.width||c*.6,text:t.text,color:t.color,inverted:t.isInverted,seed:t.seed,padding:t.padding};this.editor.engine.addTextDesignAsync(t.identifier,d,this.editor.engineMediator.image.container,l).then(u=>k(this,null,function*(){e&&(o&&(this.pureRemoveSprite(e),this.textDesignToolStore.state.delete(e)),u.setData({id:e}));const g=u.getID();this.container[g]=u,this.editor.orderHelper.renameSprite(t.identifier,this.id);const{flipHorizontally:y,flipVertically:E}=this.editor.outputContainer.getData();u.setFlipHorizontally(y),u.setFlipVertically(E),u.setPivot(.5,.5),u.setPosition(i.position),u.setRotation(i.rotation),this.setInitialSpriteState(g,m.TEXT_DESIGN);const D=u.getData();this.textDesignToolStore.setState(g,f(f({},D),{identifier:t.identifier})),yield this.editor.renderPromise(),r&&(this.selectedId.set(g),this.addSnapshot(O.ADD,this.textDesignLocale.add)),n()})).catch(u=>{console.error(u),a()})});this.spriteLocalTransform=()=>({position:this.editor.previewToOutput(this.position),size:this.size,rotation:this.rotation});this.clickableCanvas=e=>{this.editor.clickableCanvas(e)};this.setContainerProperties=(e,t,i=!1)=>{this.container[e].setData(t),i&&this.updatePositionAndSize(),this.editor.render()};this.setContainerPosition=(e,t)=>{this.container[e].setPosition(t)};this.pureRemoveSprite=e=>{this.editor.engine.removeContainer(this.container[e]);const t=this.container[e].getIndexInParent();return t===-1?(delete this.container[e],this.state.delete(e),this.editor.orderHelper.removeSprite(e),!0):!1};this.deleteSprite=(e=this.id)=>{const t=this.state.get(e);t.tool===m.STICKER?this.stickerToolStore.delete():t.tool===m.TEXT?this.textToolStore.delete():t.tool===m.TEXT_DESIGN&&this.textDesignToolStore.delete()};this.removeSprite=e=>{const t=this.pureRemoveSprite(e);t&&(this.selectLast(),this.spriteSnapshot("delete"),this.editor.render())};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.spriteSnapshot=e=>{this.addSnapshot(O.EDIT,this.historyLocale[e])};this.updateStateFromHistory=e=>k(this,null,function*(){const t=Object.keys(this.container),i=e.spriteIdList;if(i.length!==t.length){const r=t.filter(n=>i.indexOf(n)===-1),o=i.filter(n=>t.indexOf(n)===-1);r.forEach(n=>{this.pureRemoveSprite(n)});for(let n=0;n<o.length;n+=1){const a=o[n],l=e.common?e.common[a]:void 0,c=e.text?e.text[a]:void 0,d=e.sticker?e.sticker[a]:void 0,u=e.textdesign?e.textdesign[a]:void 0;if(l){const g={spriteId:a,transform:{size:l.size?Ep(w.fromSize(l.size)):void 0,position:new w(l.position),rotation:l.rotation}};c?yield this.addNewText(g,c):u?yield this.addNewTextDesign(g,u):d&&(yield this.addNewSticker(g,f(f({},d),{flipHorizontally:l.flipHorizontally,flipVertically:l.flipVertically})))}}}else this.updateSpriteStateFromHistory(e)});this.addNewText=(e,t)=>k(this,null,function*(){if(this.textToolStore.doesTextAssetExist(t.identifier))yield this.addTextAsync(f(f({},e),{state:t}),!1);else throw new Error(`Text identifier ${t.identifier} doesn't exist`)});this.addNewTextDesign=(e,t)=>k(this,null,function*(){if(this.textDesignToolStore.doesTextDesignAssetExist(t.identifier))yield this.addTextDesignAsync(f(f({},e),{state:t}),!1);else throw new Error(`TextDesign identifier ${t.identifier} doesn't exist`)});this.addNewSticker=(e,t)=>k(this,null,function*(){if(this.stickerToolStore.doesStickerAssetExist(t.identifier))yield this.addStickerAsync(f(f({},e),{state:t}),!1);else throw new Error(`Sticker identifier ${t.identifier} doesn't exist`)});this.updateSpriteStateFromHistory=e=>k(this,null,function*(){Object.keys(this.container).forEach(t=>{const i=e.common?e.common[t]:void 0,r=e.sticker?e.sticker[t]:void 0,o=e.text?e.text[t]:void 0,n=e.textdesign?e.textdesign[t]:void 0,a=this.state.get(t);if(a&&i){this.state.set(t,a);const l=this.container[t];l.setPosition(new w(i.position)),l.setRotation(i.rotation),a.rotation=l.getRotation(),i.flipHorizontally!==void 0&&l.setFlipHorizontally(i.flipHorizontally),i.flipVertically!==void 0&&l.setFlipVertically(i.flipVertically),r?(l.setSizeInWorldSpace(i.size),this.stickerToolStore.updateStateFromHistory(t,r)):o?this.textToolStore.updateStateFromHistory(t,f(f({},o),{fontIdentifier:o.identifier})):n&&this.textDesignToolStore.updateStateFromHistory(t,f(f({},n),{inverted:n.isInverted})),this.updatePositionAndSize(t)}})});this.getSpriteHistoryState=()=>{const e=C.toJS(this.state),t=C.toJS(this.textToolStore.state),i=C.toJS(this.textDesignToolStore.state),r={common:e,[m.STICKER]:C.toJS(this.stickerToolStore.state),[m.TEXT]:t,[m.TEXT_DESIGN]:i,spriteIdList:Object.keys(this.container)};return Object.keys(r.common).forEach(o=>{r.common[o].size=this.container[o].getSizeInWorldSpace(),r.common[o].position=this.container[o].getPosition(),r.common[o].order=this.container[o].getIndexInParent()}),r};this.updateStateFromSerialization=(e,t)=>k(this,null,function*(){if(t&&t.length)try{const i=yield Promise.all(t.map(l=>k(this,[l],function*({svg:r,raster:o,name:n,identifier:a}){const c=(r==null?void 0:r.data)?oi.SVG:o.type,d=`data:${c};base64,${(r==null?void 0:r.data)||o.data}`,u=yield co(d,150);return{stickerURI:d,thumbnailURI:u,name:n,type:c,identifier:a}})));yield this.stickerToolStore.addCustomStickerAsset(i)}catch(i){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}for(let i=0;i<e.spriteIdList.length;i+=1){const r=e.spriteIdList[i],o=e.common?e.common[r]:void 0,n=e.sticker?e.sticker[r]:void 0,a=e.text?e.text[r]:void 0,l=e.textdesign?e.textdesign[r]:void 0;if(o){let{size:c}=o;c&&(c={width:this.editor.worldToPreview(o.size.width),height:this.editor.worldToPreview(o.size.height)});const{flipHorizontally:d,flipVertically:u}=this.editor.outputContainer.getData(),g=this.editor.outputContainer.getRotation(),y=u!==d?o.rotation-g:o.rotation+g,E=u!==d?-y:y,D={spriteId:r,transform:{size:c,position:o.position,rotation:E}};if(a){const T=this.textToolStore.validFontWithConfig(a.identifier);a.identifier=T==null?void 0:T.identifier,yield this.addNewText(D,a)}else l?yield this.addNewTextDesign(D,l):n&&(yield this.addNewSticker(D,f(f({},n),{flipHorizontally:o.flipHorizontally,flipVertically:o.flipVertically})))}}});this.serializableState=()=>k(this,null,function*(){const e=this.editor.spriteStore.getSpriteHistoryState();Object.keys(e.common).forEach(i=>{const{flipHorizontally:r,flipVertically:o}=this.editor.outputContainer.getData(),n=this.editor.outputContainer.getRotation(),a=o!==r?-e.common[i].rotation:e.common[i].rotation;e.common[i].rotation=o!==r?a+n:a-n});const t=yield Promise.all(this.editor.spriteStore.stickerToolStore.customStickers.map(a=>k(this,[a],function*({identifier:i,type:r,stickerURI:o,name:n}){const l={identifier:i,name:n,raster:{data:"",type:oi.JPEG}};if(r===oi.SVG&&(l.svg={data:o.split(",")[1]}),r===oi.JPEG||r===oi.PNG)[,l.raster.data]=o.split(","),l.raster.type=r;else{const c=yield co(o);[,l.raster.data]=c.split(","),l.raster.type=oi.PNG}return l})));return{sprite:e,customStickers:t}});this.updateCanvasControls=()=>{Object.keys(this.container).forEach(e=>{this.updatePositionAndSize(e,!0);const t=this.state.get(e);if(t){if(t.tool===m.TEXT){const i=this.getContainerProperties(e);this.textToolStore.changeSize(e,i)}else if(t.tool===m.TEXT_DESIGN){const i=this.getContainerProperties(e);this.textToolStore.changeWidth(i.width)}}})};this.setEditMode=e=>{this.currentSprite&&([m.TEXT,m.TEXT_DESIGN].indexOf(this.tool)!==-1&&(e?this.editor.modalStore.showTextEditModal():this.editor.modalStore.hideModal(),this.editMode.set(e)))};this.setDragMode=e=>{this.dragMode.set(e)};this.setPosition=e=>{const t=this.currentSprite,i=this.container[this.id];if(t&&i){i.setPosition(this.editor.previewToWorld(e));const{position:r}=this.getSizePositionFromContainer();t.position.x=r.x,t.position.y=r.y,this.state.set(this.id,t),this.editor.render()}};this.setSize=e=>{const t=this.currentSprite;t&&(t.size.width=e.width,t.size.height=e.height,this.state.set(this.id,t))};this.setRotation=e=>{const t=this.currentSprite;if(t){const{flipHorizontally:i,flipVertically:r}=this.editor.outputContainer.getData(),o=this.editor.outputContainer.getRotation(),n=pr({rotation:e+o,flipHorizontally:i,flipVertically:r});this.container[this.id].setRotation(n),t.rotation=this.container[this.id].getRotation(),this.state.set(this.id,t),this.editor.render()}};this.onCanvasClick=e=>{this.isEditMode||this.selectHighestOrderSprite(e)};this.select=e=>{const t=this.state.get(e);if(t){const i=this.editor.activeStore.tool;i!==t.tool&&this.editor.activeStore.selectTool(t.tool),this.selectedId.set(e)}};this.selectLast=()=>{const e=this.editor.orderHelper.getLastSpriteId();e&&this.select(e)};this.selectNext=()=>{if(this.currentSprite){const e=this.container[this.id],t=e.getIndexInParent();if(t){const i=Object.keys(this.container).find(r=>this.container[r].getIndexInParent()===t-1);i&&this.select(i)}}};this.deselect=()=>{this.selectedId.set(uo)};this.bringToFront=e=>{const t=this.editor.orderHelper.bringToFront(e);this.container[e].setIndexInParent(t),this.spriteSnapshot("order"),this.editor.render()};this.flipHorizontally=e=>{const t=this.state.get(e),i=this.container[e];i.setFlipHorizontally(!i.getFlipHorizontally()),t.flipHorizontally=i.getFlipHorizontally(),this.spriteSnapshot("flip"),this.state.set(e,t),this.editor.render()};this.pureReset=()=>{this.selectedId.set(uo),Array.from(this.state.keys()).forEach(e=>{this.pureRemoveSprite(e)}),this.stickerToolStore.pureReset(),this.textToolStore.pureReset(),this.textDesignToolStore.pureReset()};this.selectHighestOrderSprite=e=>{const t=this.editor.brushToolStore.containerId();if(e=e.filter(o=>o!==t),e.length<1){this.deselect();return}let i="",r=0;e.forEach(o=>{const n=this.container[o],a=n&&n.getIndexInParent()||0;a>=r&&(r=a,i=o)}),this.select(i)};this.onCornerDrag=({x:e,y:t})=>{if(this.currentSprite){const i=new w(this.currentSprite.position),r=new w(e,t),o=r.subtract(i).magnitude,n=this.getSize(),a=o*2/_.sizeMagnitude(n);if(o>this.minLength)if(this.isSpriteSticker)if(this.stickerToolStore.resizeMode!=="unrestricted")this.setStickerSize({width:n.width*a,height:n.height*a});else{const l=this.rotationWRTOutputRotation,c=r.subtract(i),d=Math.cos(l),u=Math.sin(l),g=Math.max(Math.abs(c.x*d*2+c.y*u*2),this.minLength),y=Math.max(Math.abs(c.x*-u*2+c.y*d*2),this.minLength);this.setStickerSize({width:g,height:y})}else this.isSpriteText?this.setTextSize(n.width*a):this.isSpriteTextDesign&&this.setTextDesignScale(a);this.editor.render()}};this.onWidthDrag=({x:e,y:t})=>{const i=new w(this.currentSprite.position),r=new w(e,t),o=r.subtract(i).magnitude,n=this.editor.previewToWorld(2*o);if(n>this.minLength&&(this.setContainerProperties(this.id,{width:n},!0),this.isSpriteText)){const a=this.getContainerProperties(this.id);this.textToolStore.changeWidth(a.width)}};this.onPaddingDrag=({x:e,y:t})=>{if(this.isSpriteTextDesign){let i=this.getContainerProperties(this.id);const r=new w(this.currentSprite.position),o=new w(e,t),n=o.subtract(r).magnitude,a=Math.max(this.editor.previewToWorld(n)-i.width/2,0);this.setContainerProperties(this.id,{padding:a},!0),this.isSpriteTextDesign&&(i=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(i.padding))}};this.correctTextFlip=()=>{const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();Object.values(this.container).forEach(i=>{(i.type==="text"||i.type==="text-design")&&(i.setFlipHorizontally(e),i.setFlipVertically(t))})};this.reverseTextHorizontally=()=>{Object.values(this.container).forEach(e=>{(e.type==="text"||e.type==="text-design")&&e.setFlipHorizontally(!e.getFlipHorizontally())})};this.reverseTextVertically=()=>{Object.values(this.container).forEach(e=>{(e.type==="text"||e.type==="text-design")&&e.setFlipVertically(!e.getFlipVertically())})};this.getOutputProperties=()=>this.editor.outputContainer.getData();this.getContainerProperties=e=>this.container[e].getData();this.getContainerTransform=e=>this.container[e].getTransform();this.getDuplicateContainerTransform=e=>{const t=this.container[e].getTransform(),i=this.editor.shortestOutputSide*.1,r=new w(t.position).add(new w(i,i));return f(f({},t),{position:r})};this.getDuplicateContainerFlip=e=>{const t=this.container[e].getFlipHorizontally(),i=this.container[e].getFlipVertically();return{flipHorizontally:t,flipVertically:i}};this.updatePositionAndSize=(e=this.id,t=!1)=>{const{position:i,size:r}=this.getSizePositionFromContainer(e),o=this.state.get(e);if(o){if(o.position.x=i.x,o.position.y=i.y,o.size.width=r.width,o.size.height=r.height,t){const n=this.container[e].getRotation();this.container[e].setRotation(n),o.rotation=this.container[e].getRotation()}this.state.set(e,o)}};this.getInitialTransform=e=>{const t=this.editor.outputToWorld(Tp.position);if(!e){const i=this.editor.outputContainer.getRotation();return{rotation:i,position:t}}return f({position:t},e)};this.setInitialSpriteState=(e,t)=>{const i=this.container[e],{position:r,size:o}=this.getSizePositionFromContainer(e),n=i.getRotation(),a=t!==m.STICKER?!1:i.getFlipHorizontally(),l=t!==m.STICKER?!1:i.getFlipVertically();this.state.set(e,{tool:t,position:r,rotation:n,size:o,flipHorizontally:a,flipVertically:l})};this.setStickerSize=e=>{const t=this.container[this.id];t.setSizeInWorldSpace(this.editor.previewSizeToWorld(e));const i=this.currentSprite;i&&(i.size=this.editor.worldSizeToPreview(t.getSizeInWorldSpace()),this.state.set(this.id,i))};this.setTextSize=e=>{let t=this.getContainerProperties(this.id);const i={width:this.editor.previewToWorld(e)},r=i.width/t.width,o={fontSize:Math.round(t.fontSize*r)},n=this.isSpriteText?f(f({},i),o):i;i.width>this.minLength&&o.fontSize&&(this.setContainerProperties(this.id,n,!0),t=this.getContainerProperties(this.id),this.textToolStore.changeFontSize(t.fontSize,!0),this.textToolStore.changeWidth(t.width))};this.setTextDesignScale=e=>{let t=this.getContainerProperties(this.id);const i=t.width*e;if(i>this.minLength){this.setContainerProperties(this.id,{width:i},!0);const{width:r}=this.getContainerProperties(this.id);this.textDesignToolStore.changeWidth(r),t=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(t.padding)}};this.getSizePositionFromContainer=(e=this.id)=>{const t=this.container[e];if(t){const i=this.editor.worldToPreview(t.getPosition()),r=this.editor.worldSizeToPreview(t.getSizeInWorldSpace());return{position:i,size:r}}return{position:{x:0,y:0},size:{height:1,width:1}}};this.getSize=(e=this.id)=>{const t=this.container[e];return t?this.editor.worldSizeToPreview(t.getSizeInWorldSpace()):{width:0,height:0}};this.editor=e,this.container={},this.stickerToolStore=new W(e),this.textToolStore=new I(e),this.textDesignToolStore=new $(e),this.rect=new Z(this.editor,this),this.minLength=this.editor.configStore.measurements.canvasControls.sprite.minSize/Math.sqrt(2)}static magnitude(e,t){return new w(e,t||e).magnitude}static sizeMagnitude(e){return Math.sqrt(e.width*e.width+e.height*e.height)}get currentSprite(){return this.isSpriteSelected?this.state.get(this.id):void 0}get padding(){return this.textDesignToolStore.padding}get isEditMode(){return this.editMode.get()}get isDragMode(){return this.dragMode.get()}get id(){return this.selectedId.get()}get isSpriteSelected(){return this.id!==uo}get position(){return this.currentSprite?this.currentSprite.position:void 0}get tool(){return this.currentSprite?this.currentSprite.tool:void 0}get size(){return this.currentSprite?this.currentSprite.size:void 0}get rotation(){return this.currentSprite?this.currentSprite.rotation:void 0}get rotationWRTOutputRotation(){if(this.currentSprite){const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData(),i=this.editor.outputContainer.getRotation();return pr({rotation:this.currentSprite.rotation-i,flipHorizontally:e,flipVertically:t})}return}get flipHorizontal(){return this.currentSprite?this.currentSprite.flipHorizontally:void 0}get isSpriteSticker(){return this.tool===m.STICKER}get isSpriteText(){return this.tool===m.TEXT}get isSpriteTextDesign(){return this.tool===m.TEXT_DESIGN}get spritePosition(){if(this.currentSprite){const{x:e,y:t}=this.currentSprite.position,{height:i,width:r}=this.currentSprite.size;return{x:Math.round(e-r/2),y:Math.round(t-i/2)}}return}get currentRect(){return this.currentSprite?this.rect:void 0}get leftTopPosition(){return this.currentSprite?this.rect.leftTop:void 0}get leftBottomPosition(){return this.currentSprite?this.rect.leftBottom:void 0}get leftMidPosition(){return this.currentSprite?this.rect.leftMid:void 0}get leftMidPadPosition(){if(this.currentSprite){const{leftMid:e}=this.rect;return{x:e.x-this.editor.worldToPreview(this.padding),y:e.y}}return}get rightTopPosition(){return this.currentSprite?this.rect.rightTop:void 0}get rightBottomPosition(){return this.currentSprite?this.rect.rightBottom:void 0}get rightMidPosition(){return this.currentSprite?this.rect.rightMid:void 0}get rightMidPadPosition(){if(this.currentSprite){const{rightMid:e}=this.rect;return{x:e.x+this.editor.worldToPreview(this.padding),y:e.y}}return}get leftBottomHandlePosition(){return this.currentSprite?this.rect.leftBottomHandle:void 0}get rightBottomHandlePosition(){return this.currentSprite?this.rect.rightBottomHandle:void 0}get historyLocale(){return this.isSpriteSticker?this.stickerLocale:this.isSpriteText?this.textDesignLocale:this.textLocale}get stickerLocale(){return this.editor.configStore.locale[m.STICKER].history}get textLocale(){return this.editor.configStore.locale[m.TEXT].history}get textDesignLocale(){return this.editor.configStore.locale[m.TEXT_DESIGN].history}}s([C.action],_.prototype,"addSticker",2),s([C.action],_.prototype,"addStickerAsync",2),s([C.action],_.prototype,"addText",2),s([C.action],_.prototype,"addTextAsync",2),s([C.action],_.prototype,"addTextDesign",2),s([C.action],_.prototype,"addTextDesignAsync",2),s([C.action],_.prototype,"clickableCanvas",2),s([C.action],_.prototype,"setContainerProperties",2),s([C.action],_.prototype,"setContainerPosition",2),s([C.action],_.prototype,"pureRemoveSprite",2),s([C.action],_.prototype,"deleteSprite",2),s([C.action],_.prototype,"removeSprite",2),s([C.action],_.prototype,"addSnapshot",2),s([C.action],_.prototype,"updateStateFromHistory",2),s([C.action],_.prototype,"addNewText",2),s([C.action],_.prototype,"addNewTextDesign",2),s([C.action],_.prototype,"addNewSticker",2),s([C.action],_.prototype,"updateSpriteStateFromHistory",2),s([C.action],_.prototype,"updateStateFromSerialization",2),s([C.action],_.prototype,"updateCanvasControls",2),s([C.action],_.prototype,"setEditMode",2),s([C.action],_.prototype,"setDragMode",2),s([C.action],_.prototype,"setPosition",2),s([C.action],_.prototype,"setSize",2),s([C.action],_.prototype,"setRotation",2),s([C.action],_.prototype,"onCanvasClick",2),s([C.action],_.prototype,"select",2),s([C.action],_.prototype,"selectLast",2),s([C.action],_.prototype,"selectNext",2),s([C.action],_.prototype,"deselect",2),s([C.action],_.prototype,"bringToFront",2),s([C.action],_.prototype,"flipHorizontally",2),s([C.action],_.prototype,"pureReset",2),s([C.action],_.prototype,"onCornerDrag",2),s([C.action],_.prototype,"onWidthDrag",2),s([C.action],_.prototype,"onPaddingDrag",2),s([C.action],_.prototype,"correctTextFlip",2),s([C.action],_.prototype,"reverseTextHorizontally",2),s([C.action],_.prototype,"reverseTextVertically",2),s([C.computed],_.prototype,"currentSprite",1),s([C.computed],_.prototype,"padding",1),s([C.computed],_.prototype,"isEditMode",1),s([C.computed],_.prototype,"isDragMode",1),s([C.computed],_.prototype,"id",1),s([C.computed],_.prototype,"isSpriteSelected",1),s([C.computed],_.prototype,"position",1),s([C.computed],_.prototype,"tool",1),s([C.computed],_.prototype,"size",1),s([C.computed],_.prototype,"rotation",1),s([C.computed],_.prototype,"rotationWRTOutputRotation",1),s([C.computed],_.prototype,"flipHorizontal",1),s([C.computed],_.prototype,"isSpriteSticker",1),s([C.computed],_.prototype,"isSpriteText",1),s([C.computed],_.prototype,"isSpriteTextDesign",1),s([C.computed],_.prototype,"spritePosition",1),s([C.computed],_.prototype,"currentRect",1),s([C.computed],_.prototype,"leftTopPosition",1),s([C.computed],_.prototype,"leftBottomPosition",1),s([C.computed],_.prototype,"leftMidPosition",1),s([C.computed],_.prototype,"leftMidPadPosition",1),s([C.computed],_.prototype,"rightTopPosition",1),s([C.computed],_.prototype,"rightBottomPosition",1),s([C.computed],_.prototype,"rightMidPosition",1),s([C.computed],_.prototype,"rightMidPadPosition",1),s([C.computed],_.prototype,"leftBottomHandlePosition",1),s([C.computed],_.prototype,"rightBottomHandlePosition",1),s([C.computed],_.prototype,"historyLocale",1),s([C.computed],_.prototype,"stickerLocale",1),s([C.computed],_.prototype,"textLocale",1),s([C.computed],_.prototype,"textDesignLocale",1);const v=h(p()),N=h(p()),Ml=h(p()),gt={position:{x:0,y:0},size:{height:0,width:0},lockResolution:!1,forceDimensions:!1,ratio:"*"},zl={identifier:"identity",outputRotation:0,rotationInDegrees:0,flipHorizontally:!1,flipVertically:!1,cropState:Ml.observable.map({})};class H{constructor(e,t){this.minCropSize=0;this.state=zl,this.configStore=e.configStore,this.minCropSize=this.configStore.measurements.crop.minSize,this.defaults=t}changeIdentifier(e){this.state.identifier=e;const t=this.state.cropState.get(e);t||this.state.cropState.set(e,f({},gt))}changeRatio(e){const t=this.state.cropState.get(this.identifier);t&&this.state.cropState.set(this.identifier,f(f({},t),{ratio:e}))}changeSize(e){const t=this.state.cropState.get(this.identifier);t&&(e.width&&e.width>0&&(t.size.width=Math.round(e.width)),e.height&&e.height>0&&(t.size.height=Math.round(e.height)),this.state.cropState.set(this.identifier,t))}changeHeight(e){const t=this.state.cropState.get(this.identifier);t&&(e&&(t.size.height=Math.round(e),this.state.cropState.set(this.identifier,t)))}changeWidth(e){const t=this.state.cropState.get(this.identifier);t&&(e&&(t.size.width=Math.round(e),this.state.cropState.set(this.identifier,t)))}changePositionX(e,t){const i=this.state.cropState.get(this.identifier);return i&&e<=t-this.minCropSize&&e>=0?(i.position.x=Math.round(e),this.state.cropState.set(this.identifier,i),!0):!1}changePositionY(e,t){const i=this.state.cropState.get(this.identifier);return i&&e<=t-this.minCropSize&&e>=0?(i.position.y=Math.round(e),this.state.cropState.set(this.identifier,i),!0):!1}changePosition(e,t){const i=this.state.cropState.get(this.identifier);return i&&(e.x<=t.width-this.minCropSize&&e.x>=0&&e.y<=t.height-this.minCropSize&&e.y>=0)?(i.position.x=Math.round(e.x),i.position.y=Math.round(e.y),this.state.cropState.set(this.identifier,i),!0):!1}changeLockResolution(e){const t=this.state.cropState.get(this.identifier);t&&(t.lockResolution=e!==void 0?e:!t.lockResolution,this.state.cropState.set(this.identifier,t))}changeForceDimensions(e){const t=this.state.cropState.get(this.identifier);t&&(t.forceDimensions=e,this.state.cropState.set(this.identifier,t))}setRotation(e){this.state.rotationInDegrees=e}resetRotation(){this.state.rotationInDegrees=0}resetOutputRotation(){this.state.outputRotation=0}resetFlip(){this.state.flipHorizontally=!1,this.state.flipVertically=!1}updateFlip({flipHorizontally:e,flipVertically:t}){this.state.flipHorizontally=e,this.state.flipVertically=t}setOutputRotation(e){this.state.outputRotation=e}flipHorizontally(){this.state.flipHorizontally=!this.state.flipHorizontally}flipVertically(){this.state.flipVertically=!this.state.flipVertically}get flipCenter(){const{width:e,height:t}=this.defaults.maxCropMaskSize;return new w(e/2,t/2)}get isFlippedHorizontal(){return this.state.flipHorizontally}get isFlippedVertical(){return this.state.flipVertically}get identifier(){return this.state.identifier}get height(){return this.selectedCrop?this.selectedCrop.size.height:gt.size.height}get width(){return this.selectedCrop?this.selectedCrop.size.width:gt.size.width}get position(){return this.selectedCrop?this.selectedCrop.position:gt.position}get ratio(){return this.selectedCrop?this.selectedCrop.ratio:gt.ratio}get size(){return this.selectedCrop?this.selectedCrop.size:gt.size}get x(){return this.selectedCrop?this.selectedCrop.position.x:gt.position.x}get y(){return this.selectedCrop?this.selectedCrop.position.y:gt.position.y}get lockResolution(){return this.selectedCrop?this.selectedCrop.lockResolution:gt.lockResolution}get forceDimensions(){return this.selectedCrop?this.selectedCrop.forceDimensions:gt.forceDimensions}get selectedCrop(){return this.state.cropState.get(this.identifier)}get rotationInDegrees(){return this.state.rotationInDegrees}get outputRotation(){return this.state.outputRotation}}s([N.observable],H.prototype,"state",2),s([N.action],H.prototype,"changeIdentifier",1),s([N.action],H.prototype,"changeRatio",1),s([N.action],H.prototype,"changeSize",1),s([N.action],H.prototype,"changeHeight",1),s([N.action],H.prototype,"changeWidth",1),s([N.action],H.prototype,"changePositionX",1),s([N.action],H.prototype,"changePositionY",1),s([N.action],H.prototype,"changePosition",1),s([N.action],H.prototype,"changeLockResolution",1),s([N.action],H.prototype,"changeForceDimensions",1),s([N.action],H.prototype,"setRotation",1),s([N.action],H.prototype,"resetRotation",1),s([N.action],H.prototype,"resetOutputRotation",1),s([N.action],H.prototype,"resetFlip",1),s([N.action],H.prototype,"updateFlip",1),s([N.action],H.prototype,"setOutputRotation",1),s([N.action],H.prototype,"flipHorizontally",1),s([N.action],H.prototype,"flipVertically",1),s([N.computed],H.prototype,"flipCenter",1),s([N.computed],H.prototype,"isFlippedHorizontal",1),s([N.computed],H.prototype,"isFlippedVertical",1),s([N.computed],H.prototype,"identifier",1),s([N.computed],H.prototype,"height",1),s([N.computed],H.prototype,"width",1),s([N.computed],H.prototype,"position",1),s([N.computed],H.prototype,"ratio",1),s([N.computed],H.prototype,"size",1),s([N.computed],H.prototype,"x",1),s([N.computed],H.prototype,"y",1),s([N.computed],H.prototype,"lockResolution",1),s([N.computed],H.prototype,"forceDimensions",1),s([N.computed],H.prototype,"selectedCrop",1),s([N.computed],H.prototype,"rotationInDegrees",1),s([N.computed],H.prototype,"outputRotation",1);const Sr=h(p());class Pl{constructor(e){this.transforms={output:JSON.stringify(Qt.IDENTITY),preview:JSON.stringify(Qt.IDENTITY)};this.editor=e,this.overlayOpacity=0,this.frameOpacity=0}static rotateOutput(e,t){e%=360;switch(e){case 90:case-270:return t.swapped.multiply(-1,1);case 180:case-180:return t.multiply(-1);case 270:case-90:return t.swapped.multiply(1,-1);default:return t}}onLeave(){const{flipHorizontally:e,flipVertically:t,rotation:i,outputRotation:r}=this.transformToolStore.rotateFlipState;this.editor.overlayToolStore.identifier!=="identity"&&this.editor.overlayToolStore.changeOpacity(this.overlayOpacity),this.editor.frameToolStore.identifier!=="identity"&&this.editor.frameToolStore.changeOpacity(this.frameOpacity);const o=this.editor.previewToWorld(new w(this.transformToolStore.leftTopRespectFlip).add(new w(this.transformToolStore.rightBottomRespectFlip)).divide(2).add(new w(this.transformToolStore.unRotatedDefaults.cropMaskPosition)),!0),n=this.engineMediator.preview.container,{outputContainer:a}=this.editor;a.setResolution(Sr.toJS(this.transformToolStore.localOutputImageSize)),a.setData({flipVertically:t,flipHorizontally:e});const l=n.getScale();this.editor.overlayToolStore.correctOverlayFlip(),this.saveTransforms();let c=1;if(this.transformToolStore.lockResolution){const{cropMaskSize:E,defaultImageSize:D}=this.transformToolStore,T=this.transformToolStore.maxCropMaskSize,z={height:E.height*D.height/T.height,width:E.width*D.width/T.width};c=z.width/this.transformToolStore.localOutputImageSize.width}const d=Math.abs(l.x),u=c/(d/this.transformToolStore.defaultScale),g={x:u,y:u},y=-(i-r);a.setTransform({scale:g,position:o,rotation:y}),this.editor.engineMediator.preview.updateTransform(0,!1),this.editor.scale.setInitialTransform(),this.editor.spriteStore.updateCanvasControls(),this.editor.focusToolStore.updateCanvasControls()}onEnter(){this.editor.overlayToolStore.identifier!=="identity"&&(this.overlayOpacity=this.editor.overlayToolStore.opacity,this.editor.overlayToolStore.changeOpacity(0)),this.editor.frameToolStore.identifier!=="identity"&&(this.frameOpacity=this.editor.frameToolStore.opacity,this.editor.frameToolStore.changeOpacity(0)),this.editor.scale.setScaleToDefault();const e=this.engineMediator.preview.container,{outputContainer:t}=this.editor,i=JSON.parse(this.transforms.preview);t.setResolution(Sr.toJS(this.transformToolStore.defaultImageSize)),e.setTransform(i),t.setTransform(JSON.parse(this.transforms.output));const r=i.scale;t.setData({flipVertically:!1,flipHorizontally:!1}),this.transformToolStore.transformStore.updateFlip({flipVertically:r.y<0,flipHorizontally:r.x<0}),this.engineMediator.preview.savePreviewTransform(i);const{scale:o}=this.engineMediator.preview.calculateTransform();this.editor.scale.setInitialTransform(o.x)}rotateOutputContainer(e=!1){this.editor.outputContainer.rotate90(e),this.transformToolStore.transformStore.setOutputRotation(this.editor.outputContainer.getRotation());const{rotation:t}=this.transformToolStore.rotateFlipState;this.engineMediator.preview.updateTransform(t),Sr.runInAction(()=>{this.editor.scale.setInitialTransform();const i=this.getScaleWithFlip(t);this.engineMediator.preview.container.setScale(i),this.transformToolStore.setCropDefaults(!0),this.transformToolStore.updateCropMask()}),this.editor.render()}applyPreviewTransform(){const{rotation:e,flipHorizontally:t,flipVertically:i}=this.transformToolStore.rotateFlipState,r=this.editor.scale.getPositionWithOffset(),o=this.getScaleWithFlip();let n=e;t&&(n=On(n)),i&&(n=On(n));const a={position:r,rotation:n,scale:o};this.engineMediator.preview.savePreviewTransform(a),this.engineMediator.preview.container.setTransform(a)}getScaleWithFlip(e=this.transformToolStore.rotateFlipState.rotation){const{flipHorizontally:t,flipVertically:i}=this.transformToolStore.rotateFlipState,r=t?-1:1,o=i?-1:1,n=this.editor.scale.calculateScale(e);return{x:n*r,y:n*o}}saveTransforms(){const e=JSON.stringify(this.engineMediator.preview.container.getTransform()),t=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:e,output:t}}saveTransformsBasedOnFlip(){const e=this.engineMediator.preview.container.getTransform(),{scale:t}=e,{flipVertically:i,flipHorizontally:r}=this.editor.outputContainer.getData(),o=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:JSON.stringify(f(f({},e),{scale:{x:r?-t.x:t.x,y:i?-t.y:t.y}})),output:o}}get engineMediator(){return this.editor.engineMediator}get transformToolStore(){return this.editor.transformToolStore}}const Bl="identity";class S{constructor(e){this.unRotatedDefaults={cropMaskPosition:{x:0,y:0},scale:1};this.defaultAngle=0;this.dragMode=v.observable.box(!1);this.minCropSize=0;this.localSnapshotEnabled=!0;this.defaults={cropMaskPosition:{x:0,y:0},maxCropMaskSize:{width:0,height:0},imageSize:{width:0,height:0},scale:1};this.localOutputSize={width:0,height:0};this.checkIfTransformThumbnailExits=e=>{let t=this.editor.configStore.config.assetBaseUrl;const{length:i}=t;if(t[i-1]!=="/"&&(t+="/"),`${t}transform/`===e)return!1;const r=new Image;try{return r.src=e,!0}catch(o){return!1}};this.reset=()=>{this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.setDefaultAngle(0);const e=this.editor.outputContainer.getRotation();e!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop(),this.editor.render()};this.changeLocalOutputSize=e=>{this.localOutputSize.height=Math.round(e.height),this.localOutputSize.width=Math.round(e.width)};this.changeDefaultScale=e=>{this.defaults.scale=e};this.changeLocalOutputHeight=e=>{this.localOutputSize.height=Math.round(e)};this.changeLocalOutputWidth=e=>{this.localOutputSize.width=Math.round(e)};this.changeLockResolution=()=>{this.transformStore.changeLockResolution(),this.addLocalSnapshot()};this.rotateClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical!==this.isFlippedHorizontal)};this.rotateAntiClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical===this.isFlippedHorizontal)};this.flipHorizontally=(e=!0)=>{this.transformStore.flipHorizontally(),this.editor.spriteStore.reverseTextHorizontally(),this.transformRender(e),e&&this.addLocalSnapshot()};this.flipVertically=(e=!0)=>{this.transformStore.flipVertically(),this.editor.spriteStore.reverseTextVertically(),this.transformRender(e),e&&this.addLocalSnapshot()};this.applyDefaultCrop=(e=!1)=>{if(this.identifier==="identity"){const{identifier:t}=this.getMatchingItem();this.changeIdentifier(t,e)}};this.updateCropMask=()=>{this.changeIdentifier(this.identifier,!0)};this.onLeftTop=({x:e,y:t})=>{const i=this.getRatio(),r=this.rightBottom,{minCropMaskSize:o,maxCropMaskSize:n}=this,a=Math.min(Math.max(0,e),r.x-o.width),l=Math.min(Math.max(0,t),r.y-o.height),c=r.x-a,d=r.y-l,u={width:Math.max(this.minCropSize,Math.min(c,n.width-a)),height:Math.max(this.minCropSize,Math.min(d,n.height-l))};if(i==="*")this.changePosition({x:a,y:l})&&this.changeCropAndOutputSize(u);else{const g=this.proportionalSize(i,u),y=new w(r).rounded.subtract({x:g.width,y:g.height});this.changePosition(y)&&this.changeCropAndOutputSize(g)}};this.onLeftBottom=({x:e,y:t})=>{const i=this.getRatio(),r=this.rightTop,{minCropMaskSize:o,maxCropMaskSize:n}=this,a=Math.min(Math.max(0,e),r.x-o.width),l=Math.max(0,t,r.y+o.height),c=r.x-a,d=l-r.y,u={width:Math.max(1,Math.min(c,n.width-a)),height:Math.max(1,Math.min(d,n.height-r.y))};if(i==="*"){const g=this.changeCropAndOutputSize(u);g&&this.changePositionX(a)}else{const g=this.proportionalSize(i,u);this.changePositionX(Math.round(r.x)-g.width)&&this.changeCropAndOutputSize(g)}};this.onRightTop=({x:e,y:t})=>{const i=this.getRatio(),r=this.leftBottom,{minCropMaskSize:o,maxCropMaskSize:n}=this,a=Math.max(0,e,r.x+o.width),l=Math.min(Math.max(0,t),r.y-o.height),c=a-r.x,d=r.y-l,u={width:Math.max(1,Math.min(c,n.width-r.x)),height:Math.max(1,Math.min(d,n.height-l))};if(i==="*")this.changePositionY(l)&&this.changeCropAndOutputSize(u);else{const g=this.proportionalSize(i,u);this.changePositionY(Math.round(r.y)-g.height)&&this.changeCropAndOutputSize(g)}};this.onRightBottom=({x:e,y:t})=>{const i=this.getRatio(),r=this.leftTop,{minCropMaskSize:o,maxCropMaskSize:n}=this,a=Math.max(0,e,r.x+o.width),l=Math.max(0,t,r.y+o.height),c=a-r.x,d=l-r.y,u={width:Math.max(1,Math.min(c,n.width-r.x)),height:Math.max(1,Math.min(d,n.height-r.y))};if(i==="*")this.changeCropAndOutputSize(u);else{const g=this.proportionalSize(i,u);this.changeCropAndOutputSize(g)}};this.onPixelWidth=e=>{const t=JSON.stringify(v.toJS(this.localOutputSize)),i=this.entityManager.items.find(o=>o.identifier===this.identifier),r=this.defaults.imageSize;if(i&&i.ratio){let o=e,n=this.localOutputSize.height,{ratio:a}=i;if(a==="*"&&this.lockResolution&&(a=this.localOutputSize.width/this.localOutputSize.height),a==="*"&&!this.lockResolution)o=Math.max(Math.min(e,r.width),this.minCropSize),this.changeLocalOutputWidth(o);else{const l=S.placeCropMask(a,r);o=Math.max(Math.min(o,l.width),this.minCropSize),n=o/a,this.changeLocalOutputSize({height:n,width:o})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(t)),Math.round(o)}return e};this.onPixelHeight=e=>{const t=JSON.stringify(v.toJS(this.localOutputSize)),i=this.entityManager.items.find(o=>o.identifier===this.identifier),r=this.defaults.imageSize;if(i&&i.ratio){let o=e,n=this.localOutputSize.width,{ratio:a}=i;if(a==="*"&&this.lockResolution&&(a=this.localOutputSize.width/this.localOutputSize.height),a==="*"&&!this.lockResolution)o=Math.max(Math.min(e,r.height),this.minCropSize),this.changeLocalOutputHeight(o);else{const l=S.placeCropMask(a,r);o=Math.max(Math.min(o,l.height),this.minCropSize),n=o*a,this.changeLocalOutputSize({height:o,width:n})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(t)),Math.round(o)}return e};this.closestRatioReducer=e=>(t,i)=>i===null||Math.abs(e-t.ratio)<Math.abs(e-i.ratio)?-1:1;this.closestDimensionsReducer=e=>(t,i)=>{if(i===null)return-1;const r=Math.abs(t.dimensions.x/t.dimensions.y),o=Math.abs(i.dimensions.x/i.dimensions.y);return r===o?t.dimensions.x*t.dimensions.y>i.dimensions.x*i.dimensions.y?-1:1:Math.abs(e-r)<Math.abs(e-o)?-1:1};this.getMatchingItem=()=>{const e=this.entityManager.items.findIndex(l=>l.identifier==="imgly_transform_common_custom");if(e!==-1)return this.entityManager.items[e];const t=this.entityManager.items.findIndex(l=>l.ratio==="*");if(t!==-1)return this.entityManager.items[t];const i=v.toJS(this.editor.outputContainer.getResolution()),r=Math.abs(i.width/i.height),[o]=this.entityManager.items.filter(l=>l.ratio&&typeof l.ratio=="number").sort(this.closestRatioReducer(r)),[n]=this.entityManager.items.filter(l=>l.dimensions&&!l.ratio).sort(this.closestDimensionsReducer(r));if(!o||!n||!o.ratio&&!n.dimensions)return this.entityManager.items[0];if(!n||!n.dimensions)return o;if(!o||!o.ratio)return n;const a=Math.abs(n.dimensions.x/n.dimensions.y);return a===o.ratio||Math.abs(r-o.ratio)<Math.abs(r-a)?o:n};this.getTransform=e=>{let t=this.entityManager.items.find(i=>i.identifier===e);return t||(t=this.getMatchingItem()),t};this.editor=e,this.selectedCategory=Bl,this.transformStore=new H(e,this.defaults),this.transformations=new Pl(e);const n=this.config,{enableRotation:t,enableFlip:i}=n,r=qe(n,["enableRotation","enableFlip"]),o=this.editor.assetProvider.getAssets("transform");this.entityManager=new de(o,f(f({},r),{categoryKey:"",itemKey:"thumbnailURI",locale:f(f({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("transform")})),this.rect=new Z(this.editor,this.transformStore,"topLeft",!1,!1),this.rectForUi=new Z(this.editor,this.transformStore,"topLeft",!1,!0),this.minCropSize=this.editor.configStore.measurements.crop.minSize}static inRadians(e){return e*Math.PI/180}static placeCropMask(e,t){if(t.height*e>t.width){const r=t.width/e;return{height:r,width:t.width,yChanged:!0}}const i=t.height*e;return{height:t.height,width:i,yChanged:!1}}changeIdentifier(e,t=!1){this.transformStore.changeIdentifier(e);const i=this.getCropMask(e,this.defaults.imageSize);i&&(this.transformStore.changeRatio(i.ratio),this.changeLocalOutputSize(i),this.updatePreviewSizeWRTImageSize(),i.yChanged!==void 0&&this.updateInitialCropMaskPosition(i.yChanged),i.dimensions&&this.changeLocalOutputSize({width:i.dimensions.x,height:i.dimensions.y}),t&&this.addLocalSnapshot())}setDragMode(e){this.dragMode.set(e)}getCropMask(e,t){const i=this.getTransform(e);if(i){const{ratio:r,forceDimensions:o,lockDimensions:n,dimensions:a=null}=i;if(o&&this.transformStore.changeForceDimensions(o),n&&this.transformStore.changeLockResolution(n),r)switch(r){case"*":return this.changePosition({x:0,y:0}),f(f({},t),{yChanged:void 0,ratio:"*",dimensions:a});default:return f(f({},S.placeCropMask(i.ratio,t)),{ratio:i.ratio,dimensions:a})}else{const{x:l,y:c}=i.dimensions;return f(f({},S.placeCropMask(l/c,t)),{ratio:null,dimensions:a})}}return null}setCropDefaults(e=!1){const t=this.editor.outputContainer.getResolution();this.setDefaultImageSize(t);const i=this.editor.getPreviewSize(),{position:r}=this.editor.engineMediator.preview.previewTransformWithoutDpr;this.setMaxCropSize(i),this.setDefaultCropPosition({x:r.x-i.width/2,y:r.y-i.height/2}),this.changeDefaultScale(this.editor.scale.defaultScale),e||(this.unRotatedDefaults.cropMaskPosition=this.defaultCropMaskPosition,this.unRotatedDefaults.scale=this.defaultScale)}setDefaultImageSize(e){this.defaults.imageSize=f({},v.toJS(e)),this.lockResolution||(this.localOutputSize=f({},v.toJS(e)))}setMaxCropSize(e){this.defaults.maxCropMaskSize.height=e.height,this.defaults.maxCropMaskSize.width=e.width}setDefaultCropPosition(e){this.defaults.cropMaskPosition.x=e.x,this.defaults.cropMaskPosition.y=e.y}resetCrop(){this.state.cropState=v.observable.map({}),this.state.identifier="identity"}toggleCategorySelection(e){this.selectedCategory=this.selectedCategory===e?Bl:e}pureReset(){this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.resetCrop()}changePosition(e){return this.transformStore.changePosition(e,this.defaults.maxCropMaskSize)}changePositionX(e){return this.transformStore.changePositionX(e,this.defaults.maxCropMaskSize.width)}changePositionY(e){return this.transformStore.changePositionY(e,this.defaults.maxCropMaskSize.height)}changeCropAndOutputHeight(e){return e&&e>=this.minCropSize?(this.transformStore.changeHeight(e),this.lockResolution||this.changeLocalOutputHeight(e*this.defaults.imageSize.height/this.defaults.maxCropMaskSize.height),!0):!1}changeCropAndOutputWidth(e){return e&&e>=this.minCropSize?(this.transformStore.changeWidth(e),this.lockResolution||this.changeLocalOutputWidth(e*this.defaults.imageSize.width/this.defaults.maxCropMaskSize.width),!0):!1}changeCropAndOutputSize(e){const t=this.changeCropAndOutputHeight(e.height),i=this.changeCropAndOutputWidth(e.width);return{widthChanged:t,heightChanged:i}}transformRender(e=!0){this.transformations.applyPreviewTransform(),e&&this.editor.render()}addLocalSnapshot(e=`Local ${this.locale.title}`){if(this.localSnapshotEnabled){const t=this.state,{cropState:i}=t,r=qe(t,["cropState"]);this.editor.addLocalTransformSnapshot(f(f(f({},r),this.cropState),{localOutputSize:v.toJS(this.localOutputSize),outputSize:this.engineMediator.output.container.getResolution(),defaults:v.toJS(this.defaults),previewTransform:this.engineMediator.preview.container.getTransform(),outputTransform:this.engineMediator.output.container.getTransform()}),e)}}updateLocalStateFromHistory(e){const{tool:t}=this.editor.activeStore;t===m.TRANSFORM&&(this.transformStore.changeLockResolution(e.lockResolution),this.transformStore.changeForceDimensions(e.forceDimensions),this.transformStore.changeIdentifier(e.identifier),this.transformStore.setRotation(e.rotationInDegrees),this.setDefaultAngle(e.rotationInDegrees),this.transformStore.setOutputRotation(e.outputRotation),this.transformStore.updateFlip(e),this.engineMediator.output.container.setRotation(e.outputRotation),this.setDefaultImageSize(e.defaults.imageSize),this.localOutputSize=e.defaults.imageSize,this.changeLocalOutputSize(e.localOutputSize),this.transformStore.changeSize(e.size),this.changePosition(e.position),this.setMaxCropSize(e.defaults.maxCropMaskSize),this.setDefaultCropPosition(e.defaults.cropMaskPosition),this.changeDefaultScale(e.defaults.scale),this.engineMediator.output.container.setResolution(e.outputSize),this.engineMediator.preview.container.setTransform(e.previewTransform),this.engineMediator.output.container.setTransform(e.outputTransform))}updateStateFromHistory(e){const{tool:t}=this.editor.activeStore;t!==m.TRANSFORM&&(this.engineMediator.output.container.setTransform(e.outputTransform),this.engineMediator.preview.container.setTransform(e.previewTransform),this.engineMediator.output.container.setResolution(e.outputSize),this.changeLocalOutputSize(e.outputSize))}get serializableState(){const{flipHorizontally:e,flipVertically:t}=this.rotateFlipState,i=this.editor.engineMediator.output.container.getRotation()*180/Math.PI%360,{identifier:r,rotationInDegrees:o}=this,n=o*Math.PI/180;let a=i+o;a=Math.round(a/90)*90,a=a<0?a+360:a,a=(360-a)%360;const{start:l,end:c}=this.convertUIToOperationOptions(n,a);return{flipHorizontally:e,flipVertically:t,rotation:n,start:l,end:c,identifier:r,outputRotation:a}}getStartEndForOperation(e){const{leftTop:t,rightBottom:i,maxCropMaskSize:r}=this,o=t.y,n=t.x,a=i.x,l=i.y;switch(e){case 270:return{leftTop:{x:r.height-l,y:n},rightBottom:{x:r.height-o,y:a}};case 180:return{leftTop:{x:r.width-a,y:r.height-l},rightBottom:{x:r.width-n,y:r.height-o}};case 90:return{leftTop:{x:o,y:r.width-a},rightBottom:{x:l,y:r.width-n}};default:return{leftTop:{x:n,y:o},rightBottom:{x:a,y:l}}}}getStartEndForUI(e,t,i){const{maxCropMaskSize:r}=this,o=t.y,n=t.x,a=i.x,l=i.y;switch(e){case 90:return{leftTop:{x:o,y:r.height-a},rightBottom:{x:l,y:r.height-n}};case 180:return{leftTop:{x:r.width-a,y:r.height-l},rightBottom:{x:r.width-n,y:r.height-o}};case 270:return{leftTop:{x:r.width-l,y:n},rightBottom:{x:r.width-o,y:a}};default:return{leftTop:{x:n,y:o},rightBottom:{x:a,y:l}}}}convertOperationOptionsToUI({start:e,end:t,rotation:i,outputRotation:r}){const o=r===90||r===270,n=o?w.fromSize(this.defaultImageSize).swapped:w.fromSize(this.defaultImageSize),a=Math.cos(i),l=Math.sin(i),c=this.calculateScale(i),d=new w(Math.min(e.x,t.x),Math.min(e.y,t.y)),u=new w(Math.max(e.x,t.x),Math.max(e.y,t.y)),g=u.subtract(d).divide(2),y=d.add(g).multiply(n),E=y.subtract(n.multiply(.5)),D=new w(E.x*a-E.y*l,E.x*l+E.y*a).multiply(c),T=n.multiply(.5).add(D),z=T.divide(n),K=z.subtract(g.multiply(c)),re=z.add(g.multiply(c)),De=o?w.fromSize(this.maxCropMaskSize).swapped:w.fromSize(this.maxCropMaskSize),Ge=K.multiply(De),ze=re.multiply(De),{leftTop:A,rightBottom:te}=this.getStartEndForUI(r,Ge,ze);return{start:new w(A),end:new w(te)}}convertUIToOperationOptions(e,t){const i=t===90||t===270,r=i?w.fromSize(this.defaultImageSize).swapped:w.fromSize(this.defaultImageSize),o=i?w.fromSize(this.maxCropMaskSize).swapped:w.fromSize(this.maxCropMaskSize),n=Math.cos(-e),a=Math.sin(-e),l=this.calculateScale(e,i),{leftTop:c,rightBottom:d}=this.getStartEndForOperation(t),u=new w(c).divide(o),g=new w(d).divide(o),y=g.subtract(u).divide(2),E=u.add(y).multiply(r),D=E.subtract(r.multiply(.5)),T=new w(D.x*n-D.y*a,D.x*a+D.y*n).divide(l),z=r.multiply(.5).add(T),K=z.divide(r),re=K.subtract(y.divide(l)),De=K.add(y.divide(l));return{start:re,end:De}}calculateScale(e,t=!1){const i=t?w.fromSize(this.defaultImageSize).swapped:w.fromSize(this.defaultImageSize),r=new w(Math.abs(i.x*Math.cos(e))+Math.abs(i.y*Math.sin(e)),Math.abs(i.x*Math.sin(e))+Math.abs(i.y*Math.cos(e))),o=i.subtract(r.clone()).divide(2).abs;return o.y>o.x?o.y*2/i.y+1:o.x*2/i.x+1}updateStateFromSerialization(e,t){this.localSnapshotEnabled=t,this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.setDefaultAngle(0),this.editor.outputContainer.getRotation()!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop();const i=Math.round(e.rotation*180/Math.PI);this.transformStore.setRotation(i>180?i-360:i),this.applyOutputRotationFromSerialization(e),e.identifier&&this.transformStore.changeIdentifier(e.identifier);let r=e.outputRotation<0?e.outputRotation+360:e.outputRotation;if(r=(360-r)%360,e.start&&e.end){(e.end.x===0||e.end.y===0)&&(e.end.x=1,e.end.y=1);const{start:o,end:n}=this.convertOperationOptionsToUI({start:new w(e.start),end:new w(e.end),rotation:e.rotation,outputRotation:r});this.changePositionX(o.x),this.changePositionY(o.y);const a=n.x-o.x,l=n.y-o.y;this.transformStore.changeSize({width:a,height:l});const{maxCropMaskSize:c,imageSize:d}=this.defaults,u={height:l*d.height/c.height,width:a*d.width/c.width};this.changeLocalOutputSize(u)}this.editor.outputContainer.setData({flipHorizontally:e.flipHorizontally,flipVertically:e.flipVertically}),e.flipHorizontally&&this.flipHorizontally(!1),e.flipVertically&&this.flipVertically(!1),this.editor.overlayToolStore.correctOverlayFlip(),this.localSnapshotEnabled=!0}applyOutputRotationFromSerialization(e){if(e.outputRotation!==void 0)switch(e.outputRotation){case 90:this.transformations.rotateOutputContainer();break;case 180:this.transformations.rotateOutputContainer(),this.transformations.rotateOutputContainer();break;case 270:this.transformations.rotateOutputContainer(!0);break;default:break}this.transformations.rotateOutputContainer(!0),this.transformations.rotateOutputContainer()}setDefaultAngle(e){this.defaultAngle=e}updateCanvasControls(e){const t=v.toJS(this.cropMaskPosition),i=v.toJS(this.cropMaskSize),r=v.toJS(this.defaults.maxCropMaskSize);this.changeCropAndOutputSize({height:r.height*i.height/e.height,width:r.width*i.width/e.width}),this.changePosition({y:r.height*t.y/e.height,x:r.width*t.x/e.width})}onLeave(){this.transformations.onLeave()}onEnter(){this.transformations.onEnter()}saveTransforms(){this.transformations.saveTransforms()}saveTransformsBasedOnFlip(){this.transformations.saveTransformsBasedOnFlip()}setRotation(e){this.transformStore.setRotation(e),this.transformRender()}rotateOutputContainer(e=!1){return k(this,null,function*(){this.setDragMode(!0),this.transformations.rotateOutputContainer(e),yield this.editor.wait(),this.setDragMode(!1)})}applyInitialCrop(){const{identifier:e}=this.getMatchingItem();this.changeIdentifier(e,!1)}clickableCanvas(e){this.editor.clickableCanvas(e)}proportionalSize(e,t,i=this.defaults.maxCropMaskSize,r=this.minCropSize){const o={width:t.height*e,height:t.height};return(o.width>i.width||o.width<r||o.height<r)&&(o.width=t.width,o.height=t.width/e),o.width=Math.round(o.width),o.height=Math.round(o.height),o}checkAndAddSnapshot(e){const t=v.toJS(this.localOutputSize);(e.width!==t.width||e.height!==t.height)&&this.addLocalSnapshot()}updateInitialCropMaskPosition(e){const{cropMaskSize:t}=this,i=this.defaults.maxCropMaskSize;e?this.changePosition({x:0,y:Math.abs(i.height-t.height)/2}):this.changePosition({x:Math.abs(i.width-t.width)/2,y:0})}updatePreviewSizeWRTImageSize(){const e=v.toJS(this.localOutputSize),t=v.toJS(this.defaults.imageSize),i=v.toJS(this.defaults.maxCropMaskSize),r={height:i.height*e.height/t.height,width:i.width*e.width/t.width};this.transformStore.changeSize(r)}getScaleWithFlip(e=this.rotateFlipState.rotation){return this.transformations.getScaleWithFlip(e)}get cropState(){return this.transformStore.selectedCrop}get identifier(){return this.transformStore.identifier}get ratio(){return this.transformStore.ratio}get height(){return this.transformStore.height}get width(){return this.transformStore.width}get localOutputImageSize(){return this.localOutputSize}get localOutputHeight(){return this.localOutputSize.height}get localOutputWidth(){return this.localOutputSize.width}get lockResolution(){return this.transformStore.lockResolution}get forceDimensions(){return this.transformStore.forceDimensions}get rotationInDegrees(){return this.transformStore.rotationInDegrees}get outputRotation(){return this.transformStore.outputRotation}get isDragMode(){return this.dragMode.get()}get rotateFlipState(){const{flipHorizontally:e,flipVertically:t,rotationInDegrees:i,outputRotation:r}=this.transformStore.state;return{flipHorizontally:e,flipVertically:t,rotation:S.inRadians(i),outputRotation:r}}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}get config(){return this.editor.configStore.config[m.TRANSFORM]}get locale(){return this.editor.configStore.locale[m.TRANSFORM]}get isOptionSelected(){return this.identifier!=="identity"}get leftTop(){return this.rect.leftTop}get leftBottom(){return this.rect.leftBottom}get rightTop(){return this.rect.rightTop}get rightBottom(){return this.rect.rightBottom}get isFlippedHorizontal(){return this.transformStore.isFlippedHorizontal}get isFlippedVertical(){return this.transformStore.isFlippedVertical}get leftTopRespectFlip(){return this.rectForUi.leftTop}get leftBottomRespectFlip(){return this.rectForUi.leftBottom}get rightTopRespectFlip(){return this.rectForUi.rightTop}get rightBottomRespectFlip(){return this.rectForUi.rightBottom}get cropMaskPosition(){return this.transformStore.position}get cropMaskSize(){return this.transformStore.size}get state(){return this.transformStore.state}get defaultImageSize(){return this.defaults.imageSize}get maxCropMaskSize(){return this.defaults.maxCropMaskSize}get minCropMaskSize(){const e=this.getRatio();return e==="*"||e===1?{width:this.minCropSize,height:this.minCropSize}:e>1?{width:this.minCropSize*e,height:this.minCropSize}:{width:this.minCropSize,height:this.minCropSize*e}}get defaultCropMaskPosition(){return this.defaults.cropMaskPosition}get defaultScale(){return this.defaults.scale}get engineMediator(){return this.editor.engineMediator}getRatio(){const e=this.getTransform(this.identifier);if(e){if(Object.prototype.hasOwnProperty.call(e,"ratio"))return this.lockResolution?this.localOutputWidth/this.localOutputHeight:e.ratio;const{x:t,y:i}=e.dimensions;return t/i}return"*"}}s([v.observable],S.prototype,"selectedCategory",2),s([v.observable],S.prototype,"defaults",2),s([v.observable],S.prototype,"localOutputSize",2),s([v.action],S.prototype,"changeIdentifier",1),s([v.action],S.prototype,"setDragMode",1),s([v.action],S.prototype,"setCropDefaults",1),s([v.action],S.prototype,"setDefaultImageSize",1),s([v.action],S.prototype,"setMaxCropSize",1),s([v.action],S.prototype,"setDefaultCropPosition",1),s([v.action],S.prototype,"resetCrop",1),s([v.action],S.prototype,"toggleCategorySelection",1),s([v.action],S.prototype,"pureReset",1),s([v.action],S.prototype,"reset",2),s([v.action],S.prototype,"changePosition",1),s([v.action],S.prototype,"changePositionX",1),s([v.action],S.prototype,"changePositionY",1),s([v.action],S.prototype,"changeCropAndOutputHeight",1),s([v.action],S.prototype,"changeCropAndOutputWidth",1),s([v.action],S.prototype,"changeCropAndOutputSize",1),s([v.action],S.prototype,"onLeave",1),s([v.action],S.prototype,"onEnter",1),s([v.action],S.prototype,"changeLocalOutputSize",2),s([v.action],S.prototype,"changeDefaultScale",2),s([v.action],S.prototype,"changeLocalOutputHeight",2),s([v.action],S.prototype,"changeLocalOutputWidth",2),s([v.action],S.prototype,"changeLockResolution",2),s([v.action],S.prototype,"setRotation",1),s([v.action],S.prototype,"rotateClockwise",2),s([v.action],S.prototype,"rotateAntiClockwise",2),s([v.action],S.prototype,"rotateOutputContainer",1),s([v.action],S.prototype,"flipHorizontally",2),s([v.action],S.prototype,"flipVertically",2),s([v.action],S.prototype,"applyDefaultCrop",2),s([v.action],S.prototype,"applyInitialCrop",1),s([v.action],S.prototype,"updateCropMask",2),s([v.action],S.prototype,"clickableCanvas",1),s([v.action],S.prototype,"onLeftTop",2),s([v.action],S.prototype,"onLeftBottom",2),s([v.action],S.prototype,"onRightTop",2),s([v.action],S.prototype,"onRightBottom",2),s([v.action],S.prototype,"proportionalSize",1),s([v.action],S.prototype,"onPixelWidth",2),s([v.action],S.prototype,"onPixelHeight",2),s([v.action],S.prototype,"updateInitialCropMaskPosition",1),s([v.action],S.prototype,"updatePreviewSizeWRTImageSize",1),s([v.computed],S.prototype,"cropState",1),s([v.computed],S.prototype,"identifier",1),s([v.computed],S.prototype,"ratio",1),s([v.computed],S.prototype,"height",1),s([v.computed],S.prototype,"width",1),s([v.computed],S.prototype,"localOutputImageSize",1),s([v.computed],S.prototype,"localOutputHeight",1),s([v.computed],S.prototype,"localOutputWidth",1),s([v.computed],S.prototype,"lockResolution",1),s([v.computed],S.prototype,"forceDimensions",1),s([v.computed],S.prototype,"rotationInDegrees",1),s([v.computed],S.prototype,"outputRotation",1),s([v.computed],S.prototype,"isDragMode",1),s([v.computed],S.prototype,"rotateFlipState",1),s([v.computed],S.prototype,"selectedCategoryIdentifier",1),s([v.computed],S.prototype,"categories",1),s([v.computed],S.prototype,"items",1),s([v.computed],S.prototype,"config",1),s([v.computed],S.prototype,"locale",1),s([v.computed],S.prototype,"isOptionSelected",1),s([v.computed],S.prototype,"leftTop",1),s([v.computed],S.prototype,"leftBottom",1),s([v.computed],S.prototype,"rightTop",1),s([v.computed],S.prototype,"rightBottom",1),s([v.computed],S.prototype,"isFlippedHorizontal",1),s([v.computed],S.prototype,"isFlippedVertical",1),s([v.computed],S.prototype,"leftTopRespectFlip",1),s([v.computed],S.prototype,"leftBottomRespectFlip",1),s([v.computed],S.prototype,"rightTopRespectFlip",1),s([v.computed],S.prototype,"rightBottomRespectFlip",1),s([v.computed],S.prototype,"cropMaskPosition",1),s([v.computed],S.prototype,"cropMaskSize",1),s([v.computed],S.prototype,"state",1),s([v.computed],S.prototype,"defaultImageSize",1),s([v.computed],S.prototype,"maxCropMaskSize",1),s([v.computed],S.prototype,"minCropMaskSize",1),s([v.computed],S.prototype,"defaultCropMaskPosition",1),s([v.computed],S.prototype,"defaultScale",1);class ce{constructor(e){this.checkImageResize=()=>{this.engine.on(Ll.BEGAN_IMAGE_DOWNSCALING,()=>{this.modalStore.showInfoModal("resizing")}),this.engine.on(Ll.IMAGE_DOWNSCALED,({width:e,height:t})=>{const{maxMegaPixels:i}=this.configStore.config.engine.downscaleOptions,r=Fn.isMobile()?i.mobile:i.desktop;this.modalStore.hideModal(),this.modalStore.showActionModal({type:ae.WARNING,identifier:"imageResized",handleConfirm:()=>{this.modalStore.hideModal()},error:{megapixels:`${r}`,width:`${e}`,height:`${t}`}})})};this.init=e=>{const t=this.historyStore.isDirty();t?this.modalStore.showActionModal({type:ae.WARNING,identifier:"discardChanges",handleConfirm:()=>{this.setImage(e),this.resetToolStates()},handleDismiss:()=>{this.setImage(e,!0)}}):this.setImage(e,!0).then(()=>{const{engine:i,displayCanvasRendererWarning:r}=this.configStore.config;i.preferredRenderer==="canvas"&&r&&this.modalStore.showActionModal({type:ae.WARNING,identifier:"unsupportedWebGLRenderer",handleConfirm:()=>{this.modalStore.hideModal()}})}),this.historyStore.reset(),this.libraryStore.fetchImages()};this.setImage=(e,t=!1)=>k(this,null,function*(){try{this.modalStore.showInfoModal(this.configStore.config.displayResizeWarning?"resizing":"loading"),this.scale.defaultScale=1,this.scale.resetOffset(),yield this.activeStore.setImage(e),yield this.engineMediator.image.addImageToContainer(),this.engineMediator.output.applyNewImageTransform(),this.engineMediator.preview.updateTransform(),this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.historyStore.addInitialSnapshot();const{flipHorizontally:i,flipVertically:r}=this.transformToolStore.rotateFlipState;this.outputContainer.setData({flipVertically:r,flipHorizontally:i}),t?(this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls(),this.transformToolStore.resetCrop(),this.transformToolStore.applyDefaultCrop(),this.transformToolStore.saveTransformsBasedOnFlip(),this.transformToolStore.onEnter(),this.transformToolStore.setRotation(this.transformToolStore.rotationInDegrees),this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()):this.transformToolStore.saveTransforms(),this.snappingStore.calculatePreviewTopLeftPosition(),yield this.renderPromise(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"&&this.filterToolStore.setImageAndGetPreviews();const o=this.activeStore.tool;o?this.configStore.events.onImageLoaded():this.onReady(),this.modalStore.identifier==="imageResized"||this.modalStore.hideModal()}catch(i){this.configStore.events.onErrorImageLoading(i),this.modalStore.hideModal(),this.modalStore.showActionModal({type:ae.ERROR,identifier:i.identifier?i.identifier:"rendering",error:i,handleConfirm:()=>{window.location.reload()}})}});this.onToolChange=(e,t=null,i=!0)=>{if(e===t)return;if(this.engineMediator.preview.container){if([e,t].indexOf(m.TRANSFORM)!==-1){const{canvasSize:r}=this.canvasStore,o=this.configStore.measurements.basicToolControlBar.controlsBarHeight;if(e===m.TRANSFORM){this.transformToolStore.onLeave(),this.historyStore.removeTransformLocalSnapshots();const n=this.engineMediator.preview.container.getScale().x,a=this.engineMediator.output.container.getResolution(),{defaultImageSize:l}=this.transformToolStore,c=n!==1||l.width!==a.width||l.height!==a.height;c&&this.addSnapshot(void 0,O.EDIT,this.configStore.locale.transform.title),this.snappingStore.calculatePreviewTopLeftPosition(),this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=r.height+o,this.resize(!0))}else t===m.TRANSFORM&&(this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=r.height-o,this.resize(),this.render()),this.transformToolStore.onEnter(),this.transformToolStore.addLocalSnapshot(),this.historyStore.saveTransformLocalSnapshotIndex())}else this.scale.resetOffset(),this.scale.resetPosition(),this.scale.setScaleToDefault(),this.scale.scaleRender(!0);i&&this.render()}};this.resize=(e=!1)=>{try{this.transformToolStore.applyDefaultCrop(),this.canvasStore.updateCanvasDimensions();const t=Li.toJS(this.transformToolStore.maxCropMaskSize),i=this.activeStore.tool===m.TRANSFORM;(!i||e)&&this.transformToolStore.onEnter();const r=this.engineMediator.preview.container.getRotation(),o=this.engineMediator.preview.updateTransform(r);if(o){this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.transformToolStore.updateCanvasControls(t),this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls();const n=this.transformToolStore.getScaleWithFlip(r);this.engineMediator.preview.container.setScale(n),(!i||e)&&(this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()),this.snappingStore.calculatePreviewTopLeftPosition(),this.render()}}catch(t){this.modalStore.showActionModal({type:ae.ERROR,identifier:"rendering",handleConfirm:()=>{window.location.reload()}})}};this.export=(i={})=>{var{preventExportEvent:e}=i,t=qe(i,["preventExportEvent"]);return new Promise((r,o)=>{this.modalStore.showInfoModal("exporting");const n=this.activeStore.tool===m.TRANSFORM;n&&this.transformToolStore.onLeave();const{config:a}=this.configStore,l=f(f({},a.export.image),t),{exportType:c,format:d,quality:u,enableDownload:g}=l;this.engineMediator.engine.export(c,d,u).then(y=>{g&&this.triggerFileDownload(a.export.filename,d,c,y),e||this.configStore.events.onExport(y),r(y),n&&this.transformToolStore.onEnter(),this.modalStore.hideModal(),this.historyStore.isDirtySinceSave=!1}).catch(y=>{o(y),n&&this.transformToolStore.onEnter(),this.modalStore.hideModal()})})};this.serialize=({image:e}={image:!0})=>this.serializationMediator.serialize({image:e});this.deserialize=e=>this.serializationMediator.deserialize(e);this.close=()=>{this.historyStore.isDirtySinceSave&&this.configStore.config.displayCloseWarning?this.modalStore.showActionModal({type:ae.WARNING,identifier:"unsavedChanges",handleConfirm:()=>{this.configStore.events.onClose()}}):this.configStore.events.onClose()};this.hasChanges=()=>this.historyStore.isDirty();this.wait=(e=0)=>new Promise(t=>setTimeout(t,e));this.clickableCanvas=e=>k(this,null,function*(){e?(yield new Promise(t=>setTimeout(t,0)),this.canvasStore.enableCanvasClick()):this.canvasStore.disableCanvasClick()});this.onReady=()=>k(this,null,function*(){const{layout:e,forceCrop:t}=this.configStore.config;if(e==="advanced"&&this.activeStore.selectTool(this.configStore.defaultTool),t){const i=this.transformToolStore.localOutputImageSize,r=i.width/i.height,o=this.transformToolStore.entityManager.items.map(n=>n.ratio?n.ratio:n.dimensions.x/n.dimensions.y);o.indexOf("*")!==-1?console.error('ForceCrop will not work if "*" is one of the ratios'):o.indexOf(parseFloat(r.toFixed(2)))===-1&&this.activeStore.selectTool(m.TRANSFORM)}this.configStore.events.onEditorReady()});this.addSnapshot=(e,t,i)=>{this.historyStore.addSnapshot(e,t,i)};this.addLocalTransformSnapshot=(e,t,i=O.EDIT)=>{this.historyStore.addSnapshot({localTransform:e},i,t)};this.resetToolStates=()=>{this.filterToolStore.pureReset(),this.focusToolStore.pureReset(),this.adjustmentsToolStore.pureReset(),this.overlayToolStore.pureReset(),this.frameToolStore.pureReset(),this.brushToolStore.pureReset(),this.spriteStore.pureReset(),this.transformToolStore.pureReset(),this.historyStore.reset(),this.render()};this.getAssetPath=e=>this.assetProvider.getPathForCategory(e);this.render=()=>k(this,null,function*(){yield this.renderPromise()});this.applyFlipToPreview=e=>this.engineMediator.previewSpaceToFlippedPreviewSpace(e);this.getPreviewSize=()=>{const{width:e,height:t}=this.engine.getOutputDimensions();return e&&t?{width:Math.round(this.worldToPreview(this.outputToWorld(e))),height:Math.round(this.worldToPreview(this.outputToWorld(t)))}:{height:t,width:e}};this.triggerFileDownload=(e,t,i,r)=>{const o=t===At.JPEG&&i!==Mi.MSBLOB?".jpeg":".png",n=e+o,a=this.blobFromExportData(r);this.triggerBlobDownload(n,a)};this.triggerBlobDownload=(e,t)=>{if(navigator.msSaveBlob)navigator.msSaveBlob(t,e);else{const i=document.createElement("a"),r=URL.createObjectURL(t);i.href=r,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),tl()||URL.revokeObjectURL(r)}};this.blobFromExportData=e=>typeof e=="string"?Gn(e):e instanceof HTMLImageElement?Gn(e.src):e;this.configStore=new Ke;const t=this.configStore.saveConfig(e);if(this.engineMediator=new Nl(this),this.serializationMediator=new Vn(this),this.spriteStore=new _(this),this.scale=new pe(this),this.filterToolStore=new le(this),this.adjustmentsToolStore=new G(this),this.focusToolStore=new R(this),this.overlayToolStore=new me(this),this.frameToolStore=new ie(this),this.brushToolStore=new ee(this),this.transformToolStore=new S(this),this.libraryStore=new Je(this),this.modalStore=new pt(this),this.snappingStore=new Mt(this),this.activeStore=new Ct(this),this.canvasStore=new je(this),this.historyStore=new Pi(this),this.modalStore.showInfoModal("loading"),this.libraryStore.initProvider(t),this.configStore.config.displayResizeWarning&&this.checkImageResize(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"){const i=this.configStore.config.engine;this.previewThumbnails=new Kn(f(f({},i),{license:this.configStore.config.license,assetProvider:this.configStore.assetProvider}))}}static get defaultColors(){return Object.keys(Be).map(e=>{const t=Be[e];return{identifier:e,color:t,colorString:fr(t)}})}static get defaultBackgroundColors(){return Object.keys(Mn).map(e=>{const t=Mn[e];return{identifier:e,color:t,colorString:fr(t)}})}static get devicePixelRatio(){return window.devicePixelRatio||1}get shortestOutputSide(){const e=this.outputContainer.getBounds();return Math.min(e.width,e.height)}get assetProvider(){return this.configStore.assetProvider}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get orderHelper(){return this.engineMediator.orderHelper}renderPromise(){return this.engineMediator.render(this.engineMediator.preview.container)}previewToWorld(e,t){return zt(e)?this.engineMediator.previewSpaceToWorldSpace(e,t):this.engineMediator.previewSpaceToWorldSpace(e,t)}worldToPreview(e){return zt(e)?this.engineMediator.worldSpaceToPreviewSpace(e):this.engineMediator.worldSpaceToPreviewSpace(e)}worldSizeToPreview(e){return{width:this.engineMediator.worldSpaceToPreviewSpace(e.width),height:this.engineMediator.worldSpaceToPreviewSpace(e.height)}}previewSizeToWorld(e,t){return{width:this.engineMediator.previewSpaceToWorldSpace(e.width,t),height:this.engineMediator.previewSpaceToWorldSpace(e.height,t)}}outputToWorld(e){return zt(e)?this.engineMediator.outputSpaceToWorldSpace(e):this.engineMediator.outputSpaceToWorldSpace(e)}previewToOutput(e){return zt(e)?this.engineMediator.previewSpaceToOutputSpace(e):this.engineMediator.previewSpaceToOutputSpace(e)}get outputContainer(){return this.engineMediator.output.container}}s([Li.action],ce.prototype,"resize",2),s([Li.action],ce.prototype,"export",2),s([Li.action],ce.prototype,"clickableCanvas",2);function ts(e,t){const i=e.width/e.height,r=t.width/t.height;return i>r?e.height/t.height:e.width/t.width}const Fp={transform:Qt.IDENTITY};class ni{constructor(e){this.initialTransform=Qt.IDENTITY;this.editor=e,this.state=Ze.observable(Fp)}createPreview(e){this.container=this.editor.engine.createPreview(e)}updateTransform(e=0,t=!0){const i=this.calculateTransform(e);return i.scale.x?(t?this.saveInitialTransform(i):this.savePreviewTransform(i),this.container.setTransform(this.state.transform),!0):!1}saveInitialTransform(e){this.initialTransform=e,this.savePreviewTransform(e)}savePreviewTransform(e){Ze.runInAction(()=>{this.state.transform.position=e.position,this.state.transform.scale=e.scale,this.state.transform.rotation=e.rotation;const t=ce.devicePixelRatio;this.previewTransformWithoutDpr={position:new w(e.position).divide(t),scale:new w(e.scale).divide(t),rotation:e.rotation}})}get transform(){return this.state.transform}get position(){return this.state.transform.position}get scale(){return this.state.transform.scale}get rotation(){return this.state.transform.rotation}calculateTransform(e=0){const t=ce.devicePixelRatio,{width:i,height:r}=this.editor.canvasStore.canvasSize,o=this.editor.engine.getOutputDimensions();let n=ts({width:i,height:r},o),a=.95;window.innerWidth<600&&(a=.98),n*=a;const l=r-o.height*n,c=this.editor.configStore.measurements.mainCanvasActionBar.height*2;l<c&&(n=ts({width:i,height:r-c},o),n*=a),n*=t;const d={x:i*t/2,y:r*t/2},u={x:n,y:n};return new Qt(d,u,e)}}s([Ze.action],ni.prototype,"updateTransform",1),s([Ze.action],ni.prototype,"savePreviewTransform",1),s([Ze.computed],ni.prototype,"transform",1),s([Ze.computed],ni.prototype,"position",1),s([Ze.computed],ni.prototype,"scale",1),s([Ze.computed],ni.prototype,"rotation",1);class Pt{constructor(){this.imageContainerOrder=[];this.spriteContainerOrder=[]}static checkTool(e){if([m.STICKER,m.TEXT,m.TEXT_DESIGN,m.BRUSH,m.FRAME].indexOf(e)!==-1)throw new Error("addIndex is used for non sprites, for sprites use addSprite")}static remove(e,t){const i=t.findIndex(r=>r===e);i!==-1&&t.splice(i,1);return}static indexForOrder(e,t,i){const r=e[i],o=t.findIndex(a=>a===i);if(o!==-1)return{index:o,order:t};const{length:n}=t;if(n){let a;for(a=0;a<n;a+=1){const l=t[a],c=e[l];if(r<c)return t=[...t.slice(0,a),i,...t.slice(a)],{index:a,order:t}}}return t.push(i),{index:t.length-1,order:t}}addIndex(e){Pt.checkTool(e);const{index:t,order:i}=Pt.indexForOrder(Pt.IMAGE_CONTAINER_INDEX,this.imageContainerOrder,e);return this.imageContainerOrder=i,t}removeIndex(e){Pt.checkTool(e),Pt.remove(e,this.imageContainerOrder)}addSprite(e){return this.spriteContainerOrder.push(e),this.imageContainerOrder.length+this.spriteContainerOrder.length-1}removeSprite(e){Pt.remove(e,this.spriteContainerOrder)}renameSprite(e,t){const i=this.spriteContainerOrder.findIndex(r=>r===e);i!==-1&&(this.spriteContainerOrder[i]=t)}bringToFront(e){const t=this.spriteContainerOrder.findIndex(i=>i===e);return t!==-1&&(this.spriteContainerOrder.splice(t,1),this.spriteContainerOrder.push(e)),this.getLastSpriteIndex()}getLastSpriteId(){const{length:e}=this.spriteContainerOrder;return this.spriteContainerOrder[e-1]}getSpriteIndex(e){const t=this.spriteContainerOrder.findIndex(i=>i===e);return t+this.imageContainerOrder.length-1}getLastSpriteIndex(){return this.imageContainerOrder.length+this.spriteContainerOrder.length-1}}Pt.IMAGE_CONTAINER_INDEX={[m.ART_FILTER]:0,[m.FILTER]:1,[m.ADJUSTMENT]:2,[m.FOCUS]:3,[m.OVERLAY]:4};class Nl{constructor(e){this.orderHelper=new Pt;const t=e.configStore.config.engine;this.engine=new Xn(f(f({},t),{license:e.configStore.config.license,assetProvider:e.configStore.assetProvider})),this.image=new El(e),this.output=new kl(e),this.preview=new ni(e),this.editor=e}render(e){return this.engine.render(e)}previewSpaceToWorldSpace(e,t){const i=this.preview.previewTransformWithoutDpr;if(zt(e)){const r=this.editor.engine.convertPointFromPreviewIntoWorldSpace(w.ZERO,i,t),o=this.editor.engine.convertPointFromPreviewIntoWorldSpace({x:e,y:0},i,t);return w.distance(new w(r),new w(o))}return this.editor.engine.convertPointFromPreviewIntoWorldSpace(e,i,t)}worldSpaceToPreviewSpace(e){const t=this.preview.previewTransformWithoutDpr;if(zt(e)){const i=this.editor.engine.convertPointFromWorldIntoPreviewSpace(w.ZERO,t),r=this.editor.engine.convertPointFromWorldIntoPreviewSpace({x:e,y:0},t);return w.distance(new w(i),new w(r))}return this.editor.engine.convertPointFromWorldIntoPreviewSpace(e,t)}outputSpaceToWorldSpace(e){return zt(e)?Hl.getScalarInWorldSpace(e,this.editor.engine.getOutputContainer()):Hl.getPointInWorldSpace(e,this.editor.engine.getOutputContainer())}previewSpaceToOutputSpace(e){const t=this.preview.previewTransformWithoutDpr;if(zt(e)){const i=this.editor.engine.convertPointFromPreviewIntoOutputSpace(w.ZERO,t),r=this.editor.engine.convertPointFromPreviewIntoOutputSpace({x:e,y:0},t);return w.distance(new w(i),new w(r))}return this.editor.engine.convertPointFromPreviewIntoOutputSpace(e,t)}previewSpaceToFlippedPreviewSpace(e){return this.editor.engine.convertPointFromPreviewIntoFlippedPreviewSpace(e)}}const Re=h(p()),jl=[[0,0],[0,1],[1,0],[1,1]],Ip=[[0,1,2,3],[2,3,0,1],[1,0,3,2],[3,2,1,0]];class Z{constructor(e,t,i="center",r=!0,o=!1){this.considerRotation=!0;this.considerFlip=!0;this.store=t,this.m=i==="center"?Z.movePivotTo([.5,.5]):jl,this.considerRotation=r,this.considerFlip=o,this.configStore=e.configStore}static getFlippedEdgeIndex(e,t,i){return Ip[(t?1:0)+(i?2:0)][e]}static movePivotTo(e){return jl.map(t=>[t[0]-e[0],t[1]-e[1]])}get position(){return this.store.position}get size(){return this.store.size}get rotation(){return this.considerRotation?this.store.rotationWRTOutputRotation:0}get flipHorizontally(){return this.considerFlip?this.store.isFlippedHorizontal:!1}get flipVertically(){return this.considerFlip?this.store.isFlippedVertical:!1}get flipCenter(){return this.considerFlip?this.store.flipCenter:null}handleOrigin(e,t,i){const r=Z.getFlippedEdgeIndex(e,t,i),o=this.m[r][0]*this.size.width,n=this.m[r][1]*this.size.height;return{width:o,height:n}}get leftTop(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(0,t,i);return Z.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftBottom(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(1,t,i);return Z.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightTop(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(2,t,i);return Z.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightBottom(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(3,t,i);return Z.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftBottomHandle(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(1,t,i);return r.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,Z.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightBottomHandle(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(3,t,i);return r.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,Z.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftMid(){const e=new w(this.leftTop),t=new w(this.leftBottom);return e.add(t).divide(2)}get rightMid(){const e=new w(this.rightTop),t=new w(this.rightBottom);return e.add(t).divide(2)}}Z.coordinatesWithRotation=({width:e,height:t},i,r,o,n,a)=>{let l=e*Math.cos(i)-t*Math.sin(i)+a.x,c=e*Math.sin(i)+t*Math.cos(i)+a.y;return r&&(l=n.x*2-l),o&&(c=n.y*2-c),new w({x:l,y:c}).rounded},s([Re.computed],Z.prototype,"position",1),s([Re.computed],Z.prototype,"size",1),s([Re.computed],Z.prototype,"rotation",1),s([Re.computed],Z.prototype,"flipHorizontally",1),s([Re.computed],Z.prototype,"flipVertically",1),s([Re.computed],Z.prototype,"flipCenter",1),s([Re.computed],Z.prototype,"leftTop",1),s([Re.computed],Z.prototype,"leftBottom",1),s([Re.computed],Z.prototype,"rightTop",1),s([Re.computed],Z.prototype,"rightBottom",1),s([Re.computed],Z.prototype,"leftBottomHandle",1),s([Re.computed],Z.prototype,"rightBottomHandle",1),s([Re.computed],Z.prototype,"leftMid",1),s([Re.computed],Z.prototype,"rightMid",1);const Ni=(e,t=0,i=3)=>{const r=Math.tan(t),o=Math.sqrt(r**2+1);return{x:e.x+i/o,y:e.y+i*r/o}},ho={blurRadius:40,gradientSize:.2},Op=f({start:{x:0,y:0},end:{x:0,y:0}},ho),Ap=f({center:{x:0,y:0},radius:0},ho),Rp=f({origin:{x:0,y:0},rotation:0,size:0},ho),Mp=ho,yi={identifier:"identity",linear:Op,radial:Ap,mirrored:Rp,gaussian:Mp},xe=h(p());class Me{constructor(e){this.selectFocus=(e,t)=>{xe.runInAction(()=>{this.state.identifier=e,t&&(this.state[e].blurRadius=t)})};this.changeBlurRadius=(e,t)=>{e!=="identity"&&(this.state[e].blurRadius=t)};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=yi.identifier,this.state.identifier!=="identity"&&(this.state[this.state.identifier].blurRadius=yi[this.state.identifier].blurRadius))};this.setLinear=({start:e,end:t})=>{this.state.linear.start.x=e.x,this.state.linear.start.y=e.y,this.state.linear.end.x=t.x,this.state.linear.end.y=t.y};this.setLinearStart=e=>{this.state.linear.start.x=e.x,this.state.linear.start.y=e.y};this.setLinearEnd=e=>{this.state.linear.end.x=e.x,this.state.linear.end.y=e.y};this.setRadialCenter=e=>{this.state.radial.center.x=e.x,this.state.radial.center.y=e.y};this.setRadialRadius=e=>{this.state.radial.radius=e};this.setMirroredOrigin=e=>{this.state.mirrored.origin.x=e.x,this.state.mirrored.origin.y=e.y};this.setMirroredRotation=e=>{this.state.mirrored.rotation=e};this.setMirroredSize=e=>{this.state.mirrored.size=e};this.getEffectProperties=()=>this.effect?this.effect.getProperties():null;this.setLinearFocus=e=>{this.effect=this.engineMediator.engine.addLinearBlur(e,this.imageContainer,this.order),this.updateLinearState(this.effect.getProperties())};this.setGaussianFocus=e=>{this.effect=this.engineMediator.engine.addGaussianBlur(e,this.imageContainer,this.order),this.updateGaussianState(this.effect.getProperties())};this.setRadialFocus=e=>{this.effect=this.engineMediator.engine.addRadialBlur(e,this.imageContainer,this.order),this.updateRadialState(this.effect.getProperties())};this.setMirroredFocus=e=>{this.effect=this.engineMediator.engine.addMirroredBlur(e,this.imageContainer,this.order),this.updateMirroredState(this.effect.getProperties())};this.updateFromEngineState=e=>{const t=this.getEffectProperties();if(t&&e!=="identity")switch(e){case X.LINEAR:this.updateLinearState(t);break;case X.RADIAL:this.updateRadialState(t);break;case X.MIRRORED:this.updateMirroredState(t);break;default:break}};this.updateGaussianState=e=>{this.changeBlurRadius(X.GAUSSIAN,e.blurRadius)};this.updateMirroredState=e=>{const t=this.editor.worldToPreview(e.mirrorAxisOrigin),i=new w(this.editor.worldToPreview(e.mirrorAxisDirection)),r=i.subtract(t),o=Math.atan2(r.y,r.x);this.setMirroredOrigin(this.editor.worldToPreview(e.mirrorAxisOrigin)),this.setMirroredRotation(o),this.setMirroredSize(this.editor.worldToPreview(e.clearAreaWidth)),this.changeBlurRadius(X.MIRRORED,e.blurRadius)};this.updateRadialState=e=>{this.setRadialCenter(this.editor.worldToPreview(e.center)),this.setRadialRadius(this.editor.worldToPreview(e.radius)),this.changeBlurRadius(X.RADIAL,e.blurRadius)};this.updateLinearState=e=>{this.setLinearStart(this.editor.worldToPreview(e.start)),this.setLinearEnd(this.editor.worldToPreview(e.end)),this.changeBlurRadius(X.LINEAR,e.blurRadius)};this.setEffectProperties=e=>this.effect?(this.effect.setProperties(e),this.effect.getProperties()):null;this.removeFocus=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.engineMediator.orderHelper.removeIndex(m.FOCUS))};this.editor=e,this.engineMediator=this.editor.engineMediator,this.state=yi}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get order(){return this.engineMediator.orderHelper.addIndex(m.FOCUS)}get imageContainer(){return this.engineMediator.image.container}}s([xe.observable],Me.prototype,"state",2),s([xe.action],Me.prototype,"selectFocus",2),s([xe.action],Me.prototype,"changeBlurRadius",2),s([xe.action],Me.prototype,"reset",2),s([xe.action],Me.prototype,"setLinear",2),s([xe.action],Me.prototype,"setLinearStart",2),s([xe.action],Me.prototype,"setLinearEnd",2),s([xe.action],Me.prototype,"setRadialCenter",2),s([xe.action],Me.prototype,"setRadialRadius",2),s([xe.action],Me.prototype,"setMirroredOrigin",2),s([xe.action],Me.prototype,"setMirroredRotation",2),s([xe.action],Me.prototype,"setMirroredSize",2),s([xe.action],Me.prototype,"updateFromEngineState",2);class R{constructor(e){this.selectFocus=e=>{if(e!==this.identifier){this.focusStore.removeFocus();const t=this.maxIntensity*.2,{width:i}=this.editor.engine.getOutputContainer().getBounds(),r=this.editor.shortestOutputSide*.2;switch(e){case X.LINEAR:const o=this.editor.outputToWorld({x:-i/2,y:0}),n=this.editor.outputToWorld({x:i/2,y:0});this.setLinearFocus({start:o,end:n,blurRadius:t});break;case X.RADIAL:const a=this.editor.outputToWorld({x:0,y:0});this.setRadialFocus({center:a,radius:r,blurRadius:t});break;case X.MIRRORED:const l=this.editor.outputToWorld({x:0,y:0}),c=r,d=this.editor.outputToWorld(Ni({x:0,y:0},0));this.setMirroredFocus({mirrorAxisOrigin:l,clearAreaWidth:c,blurRadius:t,mirrorAxisDirection:d});break;case X.GAUSSIAN:this.setGaussianFocus({blurRadius:t});break;default:break}this.focusStore.selectFocus(e,t),this.editor.render(),this.addSnapshot(O.ADD,m.FOCUS)}};this.changeIntensity=e=>{const t=this.focusStore.setEffectProperties({blurRadius:e});t&&(this.focusStore.changeBlurRadius(this.identifier,t.blurRadius),this.editor.render())};this.changeRelativeIntensity=e=>{const t=(this.maxIntensity-R.minIntensity)*e/100+R.minIntensity,i=this.focusStore.setEffectProperties({blurRadius:t});i&&(this.focusStore.changeBlurRadius(this.identifier,i.blurRadius),this.editor.render())};this.toolSnapshot=e=>{this.addSnapshot(O.EDIT,e)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.clickableCanvas=e=>{this.editor.clickableCanvas(e)};this.pureReset=()=>{this.focusStore.removeFocus(),this.focusStore.reset()};this.reset=()=>{this.pureReset(),this.editor.render(),this.addSnapshot(O.DELETE,this.locale.controls.buttonReset)};this.setStart=e=>{const t=this.focusStore.setEffectProperties({start:this.editor.previewToWorld(e)});t&&(this.focusStore.setLinearStart(this.editor.worldToPreview(t.start)),this.editor.render())};this.setEnd=e=>{const t=this.focusStore.setEffectProperties({end:this.editor.previewToWorld(e)});t&&(this.focusStore.setLinearEnd(this.editor.worldToPreview(t.end)),this.editor.render())};this.setCenter=e=>{const t=this.focusStore.setEffectProperties({center:this.editor.previewToWorld(e)});t&&(this.focusStore.setRadialCenter(this.editor.worldToPreview(t.center)),this.editor.render())};this.setRadius=e=>{const t=this.focusStore.setEffectProperties({radius:this.editor.previewToWorld(e)});t&&(this.focusStore.setRadialRadius(this.editor.worldToPreview(t.radius)),this.editor.render())};this.setOrigin=e=>{const t=this.focusStore.setEffectProperties({mirrorAxisOrigin:this.editor.previewToWorld(e),mirrorAxisDirection:this.editor.previewToWorld(Ni(e,this.rotation))});t&&(this.focusStore.setMirroredOrigin(this.editor.worldToPreview(t.mirrorAxisOrigin)),this.editor.render())};this.setSize=e=>{const t=this.focusStore.setEffectProperties({clearAreaWidth:this.editor.previewToWorld(e)});t&&(this.focusStore.setMirroredSize(this.editor.worldToPreview(t.clearAreaWidth)),this.editor.render())};this.setRotation=e=>{this.focusStore.setEffectProperties({mirrorAxisDirection:this.editor.previewToWorld(Ni(this.origin,e))}),this.focusStore.setMirroredRotation(e),this.editor.render()};this.updateStateFromHistory=(e,t)=>{this.focusStore.removeFocus();const{magnitude:i}=t;M.runInAction(()=>{switch(e.identifier){case X.LINEAR:this.focusStore.selectFocus(X.LINEAR),this.setLinearFocus({start:this.editor.previewToWorld(new w(e.linear.start).multiply(t)),end:this.editor.previewToWorld(new w(e.linear.end).multiply(t)),blurRadius:e.linear.blurRadius});break;case X.GAUSSIAN:this.focusStore.selectFocus(X.GAUSSIAN),this.setGaussianFocus({blurRadius:e.gaussian.blurRadius});break;case X.RADIAL:this.focusStore.selectFocus(X.RADIAL),this.setRadialFocus({center:this.editor.previewToWorld(new w(e.radial.center).multiply(t)),radius:this.editor.previewToWorld(e.radial.radius*i),blurRadius:e.radial.blurRadius});break;case X.MIRRORED:this.focusStore.selectFocus(X.MIRRORED),this.setMirroredFocus({mirrorAxisOrigin:this.editor.previewToWorld(new w(e.mirrored.origin).multiply(t)),clearAreaWidth:this.editor.previewToWorld(e.mirrored.size*i),blurRadius:e.mirrored.blurRadius,mirrorAxisDirection:this.editor.previewToWorld(Ni(e.mirrored.origin,e.mirrored.rotation))});break;case"identity":this.pureReset();break;default:break}})};this.updateStateFromSerialization=e=>k(this,null,function*(){if(R.doesFocusIdentifierExist(e.identifier))this.focusStore.removeFocus(),M.runInAction(()=>{this.focusStore.selectFocus(e.identifier);switch(e.identifier){case X.LINEAR:this.setLinearFocus(e.linear);break;case X.GAUSSIAN:this.setGaussianFocus(e.gaussian);break;case X.RADIAL:this.setRadialFocus(e.radial);break;case X.MIRRORED:this.setMirroredFocus({mirrorAxisOrigin:e.mirrored.origin,clearAreaWidth:e.mirrored.size,blurRadius:e.mirrored.blurRadius,mirrorAxisDirection:Ni(e.mirrored.origin,e.mirrored.rotation)});break;default:break}});else throw new Error(`Focus identifier ${e.identifier} doesn't exist`)});this.updateCanvasControls=()=>{this.focusStore.updateFromEngineState(this.identifier)};this.getFocusStateForHistory=()=>{const e=this.editor.canvasStore.sizeVector,{linear:t}=this.focusStore.state,{radial:i}=this.focusStore.state,{mirrored:r}=this.focusStore.state,o=e,{magnitude:n}=o;return f(f({},this.focusStore.state),{linear:f(f({},t),{start:new w(t.start).divide(o),end:new w(t.end).divide(o)}),radial:f(f({},i),{center:new w(i.center).divide(o),radius:i.radius/n}),mirrored:f(f({},r),{origin:new w(r.origin).divide(o),size:r.size/n}),gaussian:f({},this.focusStore.state.gaussian)})};this.editor=e,this.focusStore=new Me(this.editor);const t=this.editor.assetProvider.getAssets("focus");this.entityManager=new de(t,f(f({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("focus")}))}static get minIntensity(){return 0}static doesFocusIdentifierExist(e){return Object.keys(X).map(t=>X[t]).findIndex(t=>t===e)!==-1}get state(){return this.focusStore.state}get serializableState(){switch(this.identifier){case X.LINEAR:return{identifier:this.identifier,linear:this.focusStore.getEffectProperties()};case X.RADIAL:return{identifier:this.identifier,radial:this.focusStore.getEffectProperties()};case X.MIRRORED:const e=this.focusStore.getEffectProperties();return{identifier:this.identifier,mirrored:{blurRadius:e.blurRadius,origin:e.mirrorAxisOrigin,rotation:M.toJS(this.state.mirrored.rotation),size:e.clearAreaWidth}};case X.GAUSSIAN:return{identifier:this.identifier,gaussian:this.focusStore.getEffectProperties()};default:return yi}}get start(){return this.focusStore.state.linear.start}get startOnPreview(){const e=this.editor.applyFlipToPreview(this.focusStore.state.linear.start);return{x:Math.abs(e.x),y:Math.abs(e.y)}}get end(){return this.focusStore.state.linear.end}get endOnPreview(){const e=this.editor.applyFlipToPreview(this.focusStore.state.linear.end);return{x:Math.abs(e.x),y:Math.abs(e.y)}}get center(){return this.focusStore.state.radial.center}get radius(){return this.focusStore.state.radial.radius}get origin(){return this.focusStore.state.mirrored.origin}get rotation(){return this.focusStore.state.mirrored.rotation}get rotationOnPreview(){const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();return pr({rotation:this.focusStore.state.mirrored.rotation,flipHorizontally:e,flipVertically:t})}get size(){return this.focusStore.state.mirrored.size}get mirroredAreaWidth(){const{width:e,height:t}=this.editor.canvasStore.canvasSize;return Math.sqrt(e**2+t**2)*2}get identifier(){return this.state.identifier}get intensity(){return this.identifier==="identity"?yi.gaussian.blurRadius:this.state[this.identifier].blurRadius}get relativeIntensity(){const{blurRadius:e}=this.identifier==="identity"?this.state.gaussian:this.state[this.identifier];return(e-R.minIntensity)*100/(this.maxIntensity-R.minIntensity)}get maxIntensity(){return this.editor.shortestOutputSide/10}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[m.FOCUS]}get locale(){return this.editor.configStore.locale[m.FOCUS]}get items(){return this.entityManager.items}setGaussianFocus({blurRadius:e}){this.focusStore.setGaussianFocus({blurRadius:e})}setLinearFocus({start:e,end:t,blurRadius:i}){this.focusStore.setLinearFocus({start:e,end:t,blurRadius:i})}setRadialFocus({center:e,radius:t,blurRadius:i}){this.focusStore.setRadialFocus({center:e,radius:t,blurRadius:i})}setMirroredFocus({mirrorAxisOrigin:e,clearAreaWidth:t,blurRadius:i,mirrorAxisDirection:r}){this.focusStore.setMirroredFocus({mirrorAxisOrigin:e,clearAreaWidth:t,blurRadius:i,mirrorAxisDirection:r})}}s([M.action],R.prototype,"selectFocus",2),s([M.action],R.prototype,"changeIntensity",2),s([M.action],R.prototype,"changeRelativeIntensity",2),s([M.action],R.prototype,"clickableCanvas",2),s([M.action],R.prototype,"pureReset",2),s([M.action],R.prototype,"reset",2),s([M.action],R.prototype,"setStart",2),s([M.action],R.prototype,"setEnd",2),s([M.action],R.prototype,"setCenter",2),s([M.action],R.prototype,"setRadius",2),s([M.action],R.prototype,"setOrigin",2),s([M.action],R.prototype,"setSize",2),s([M.action],R.prototype,"setRotation",2),s([M.action],R.prototype,"updateStateFromHistory",2),s([M.action],R.prototype,"updateStateFromSerialization",2),s([M.action],R.prototype,"updateCanvasControls",2),s([M.computed],R.prototype,"state",1),s([M.computed],R.prototype,"start",1),s([M.computed],R.prototype,"startOnPreview",1),s([M.computed],R.prototype,"end",1),s([M.computed],R.prototype,"endOnPreview",1),s([M.computed],R.prototype,"center",1),s([M.computed],R.prototype,"radius",1),s([M.computed],R.prototype,"origin",1),s([M.computed],R.prototype,"rotation",1),s([M.computed],R.prototype,"rotationOnPreview",1),s([M.computed],R.prototype,"size",1),s([M.computed],R.prototype,"mirroredAreaWidth",1),s([M.computed],R.prototype,"identifier",1),s([M.computed],R.prototype,"intensity",1),s([M.computed],R.prototype,"relativeIntensity",1),s([M.computed],R.prototype,"maxIntensity",1),s([M.computed],R.prototype,"isOptionSelected",1),s([M.computed],R.prototype,"config",1),s([M.computed],R.prototype,"locale",1),s([M.computed],R.prototype,"items",1);import{keyframes as zp}from"styled-components";const po=zp`
from {
  opacity: 1;
  transform: scale(0);
}
to {
  opacity: 0;
  transform: scale(10);
}
`;import{keyframes as Pp}from"styled-components";const Ul=Pp`
  0% {
    opacity: 0;
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
`;import{keyframes as Bp}from"styled-components";const fo=Bp`
  0% {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
`;import Di from"react";var Qe=[],Wl=function(){return Qe.some(function(e){return e.activeTargets.length>0})},$l=function(){return Qe.some(function(e){return e.skippedTargets.length>0})},Vl="ResizeObserver loop completed with undelivered notifications.",Gl=function(){var e;typeof ErrorEvent=="function"?e=new ErrorEvent("error",{message:Vl}):(e=document.createEvent("Event"),e.initEvent("error",!1,!1),e.message=Vl),window.dispatchEvent(e)},vi;(function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(vi||(vi={}));var is=function(){function e(t,i,r,o){return this.x=t,this.y=i,this.width=r,this.height=o,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return e.prototype.toJSON=function(){var t=this,i=t.x,r=t.y,o=t.top,n=t.right,a=t.bottom,l=t.left,c=t.width,d=t.height;return{x:i,y:r,top:o,right:n,bottom:a,left:l,width:c,height:d}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),Dr=function(e){return e instanceof SVGElement&&"getBBox"in e},mo=function(e){if(Dr(e)){var t=e.getBBox(),i=t.width,r=t.height;return!i&&!r}var o=e,n=o.offsetWidth,a=o.offsetHeight;return!(n||a||e.getClientRects().length)},rs=function(e){var t,i,r=(i=(t=e)===null||t===void 0?void 0:t.ownerDocument)===null||i===void 0?void 0:i.defaultView;return!!(r&&e instanceof r.Element)},ql=function(e){switch(e.tagName){case"INPUT":if(e.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},Si=typeof window!="undefined"?window:{},go=new WeakMap,Xl=/auto|scroll/,Lp=/^tb|vertical/,Np=/msie|trident/i.test(Si.navigator&&Si.navigator.userAgent),Et=function(e){return parseFloat(e||"0")},Hi=function(e,t,i){return e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=!1),Object.freeze({inlineSize:(i?t:e)||0,blockSize:(i?e:t)||0})},Kl=Object.freeze({devicePixelContentBoxSize:Hi(),borderBoxSize:Hi(),contentBoxSize:Hi(),contentRect:new is(0,0,0,0)}),os=function(e,t){if(t===void 0&&(t=!1),go.has(e)&&!t)return go.get(e);if(mo(e))return go.set(e,Kl),Kl;var i=getComputedStyle(e),r=Dr(e)&&e.ownerSVGElement&&e.getBBox(),o=!Np&&i.boxSizing==="border-box",n=Lp.test(i.writingMode||""),a=!r&&Xl.test(i.overflowY||""),l=!r&&Xl.test(i.overflowX||""),c=r?0:Et(i.paddingTop),d=r?0:Et(i.paddingRight),u=r?0:Et(i.paddingBottom),g=r?0:Et(i.paddingLeft),y=r?0:Et(i.borderTopWidth),E=r?0:Et(i.borderRightWidth),D=r?0:Et(i.borderBottomWidth),T=r?0:Et(i.borderLeftWidth),z=g+d,K=c+u,re=T+E,De=y+D,Ge=l?e.offsetHeight-De-e.clientHeight:0,ze=a?e.offsetWidth-re-e.clientWidth:0,A=o?z+re:0,te=o?K+De:0,_e=r?r.width:Et(i.width)-A-ze,yt=r?r.height:Et(i.height)-te-Ge,tu=_e+z+ze+re,iu=yt+K+Ge+De,Zs=Object.freeze({devicePixelContentBoxSize:Hi(Math.round(_e*devicePixelRatio),Math.round(yt*devicePixelRatio),n),borderBoxSize:Hi(tu,iu,n),contentBoxSize:Hi(_e,yt,n),contentRect:new is(g,c,_e,yt)});return go.set(e,Zs),Zs},bo=function(e,t,i){var r=os(e,i),o=r.borderBoxSize,n=r.contentBoxSize,a=r.devicePixelContentBoxSize;switch(t){case vi.DEVICE_PIXEL_CONTENT_BOX:return a;case vi.BORDER_BOX:return o;default:return n}},ns=function(){function e(t){var i=os(t);this.target=t,this.contentRect=i.contentRect,this.borderBoxSize=[i.borderBoxSize],this.contentBoxSize=[i.contentBoxSize],this.devicePixelContentBoxSize=[i.devicePixelContentBoxSize]}return e}(),yo=function(e){if(mo(e))return Infinity;for(var t=0,i=e.parentNode;i;)t+=1,i=i.parentNode;return t},Yl=function(){var e=Infinity,t=[];Qe.forEach(function(a){if(a.activeTargets.length===0)return;var l=[];a.activeTargets.forEach(function(d){var u=new ns(d.target),g=yo(d.target);l.push(u),d.lastReportedSize=bo(d.target,d.observedBox),g<e&&(e=g)}),t.push(function(){a.callback.call(a.observer,l,a.observer)}),a.activeTargets.splice(0,a.activeTargets.length)});for(var i=0,r=t;i<r.length;i++){var o=r[i];o()}return e},ss=function(e){Qe.forEach(function(i){i.activeTargets.splice(0,i.activeTargets.length),i.skippedTargets.splice(0,i.skippedTargets.length),i.observationTargets.forEach(function(o){o.isActive()&&(yo(o.target)>e?i.activeTargets.push(o):i.skippedTargets.push(o))})})},Jl=function(){var e=0;for(ss(e);Wl();)e=Yl(),ss(e);return $l()&&Gl(),e>0},as,Zl=[],Hp=function(){return Zl.splice(0).forEach(function(e){return e()})},Ql=function(e){if(!as){var t=0,i=document.createTextNode(""),r={characterData:!0};new MutationObserver(function(){return Hp()}).observe(i,r),as=function(){i.textContent=""+(t?t--:t++)}}Zl.push(e),as()},ec=function(e){Ql(function(){requestAnimationFrame(e)})},vo=0,jp=function(){return!!vo},Up=250,Wp={attributes:!0,characterData:!0,childList:!0,subtree:!0},tc=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],ic=function(e){return e===void 0&&(e=0),Date.now()+e},ls=!1,$p=function(){function e(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return e.prototype.run=function(t){var i=this;if(t===void 0&&(t=Up),ls)return;ls=!0;var r=ic(t);ec(function(){var o=!1;try{o=Jl()}finally{if(ls=!1,t=r-ic(),!jp())return;o?i.run(1e3):t>0?i.run(t):i.start()}})},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var t=this,i=function(){return t.observer&&t.observer.observe(document.body,Wp)};document.body?i():Si.addEventListener("DOMContentLoaded",i)},e.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),tc.forEach(function(i){return Si.addEventListener(i,t.listener,!0)}))},e.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),tc.forEach(function(i){return Si.removeEventListener(i,t.listener,!0)}),this.stopped=!0)},e}(),So=new $p,cs=function(e){!vo&&e>0&&So.start(),vo+=e,!vo&&So.stop()},Vp=function(e){return!Dr(e)&&!ql(e)&&getComputedStyle(e).display==="inline"},rc=function(){function e(t,i){this.target=t,this.observedBox=i||vi.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var t=bo(this.target,this.observedBox,!0);return Vp(this.target)&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),oc=function(){function e(t,i){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=i}return e}(),Do=new WeakMap,nc=function(e,t){for(var i=0;i<e.length;i+=1)if(e[i].target===t)return i;return-1},wr=function(){function e(){}return e.connect=function(t,i){var r=new oc(t,i);Do.set(t,r)},e.observe=function(t,i,r){var o=Do.get(t),n=o.observationTargets.length===0;nc(o.observationTargets,i)<0&&(n&&Qe.push(o),o.observationTargets.push(new rc(i,r&&r.box)),cs(1),So.schedule())},e.unobserve=function(t,i){var r=Do.get(t),o=nc(r.observationTargets,i),n=r.observationTargets.length===1;o>=0&&(n&&Qe.splice(Qe.indexOf(r),1),r.observationTargets.splice(o,1),cs(-1))},e.disconnect=function(t){var i=this,r=Do.get(t);r.observationTargets.slice().forEach(function(o){return i.unobserve(t,o.target)}),r.activeTargets.splice(0,r.activeTargets.length)},e}(),ds=function(){function e(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");wr.connect(this,t)}return e.prototype.observe=function(t,i){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!rs(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");wr.observe(this,t,i)},e.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!rs(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");wr.unobserve(this,t)},e.prototype.disconnect=function(){wr.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();const dc=h(xr());import uf from"styled-components";import df from"react";const cc=df.createContext({}),hf=uf.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  background: ${e=>e.theme.background};
  color: ${e=>e.theme.foreground};
  display: flex;
  flex-direction: row;
  overflow: hidden;
  -webkit-touch-callout: none;
  user-select: none;
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
    /* css reset for a global box-sizing: border-box */
    box-sizing: content-box;
    /* todo: fix the issue with these settings */
    font-size: inherit;
    color: inherit;
    line-height: normal;

    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.2) transparent;

    &::-webkit-scrollbar-track {
      border-radius: 10px;
      background-color: transparent;
      margin: 1px;
    }

    &::-webkit-scrollbar {
      width: 6px;
      height: 6px;
      background-color: transparent;
    }

    &::-webkit-scrollbar-thumb {
      border-radius: 10px;
      box-shadow: inset 0 0 14px rgba(0, 0, 0, 0.4);
      background-color: rgba(255, 255, 255, 0.2);
    }

    &::-webkit-scrollbar-thumb:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }
  }
`;class uc extends Di.Component{constructor(e){super(e);this.node=Di.createRef();this.saveEditorDimensions=e=>{this.setState({contextValue:{element:e,rect:e.getBoundingClientRect()}})};var t;if((t=Di)==null?void 0:t.version){const i=Number.parseInt(Di.version.split(".")[0],10),r=Number.parseInt(Di.version.split(".")[1],10);(i<16||i===16&&r<8)&&console.error("Please be aware that the PhotoEditorSDK will require React 16.8.6 or above.")}this.saveEditorDimensions=dc.default(this.saveEditorDimensions,100),this.resizeObserver=new ds(([i])=>{this.saveEditorDimensions(i.target)}),this.state={contextValue:{element:null,rect:null}}}componentDidMount(){var e;((e=this.node)==null?void 0:e.current)&&this.resizeObserver.observe(this.node.current)}componentWillUnmount(){var e;((e=this.node)==null?void 0:e.current)&&this.resizeObserver.unobserve(this.node.current)}render(){const{children:e}=this.props,{contextValue:t}=this.state;return Di.createElement(hf,{ref:this.node},Di.createElement(cc.Provider,{value:t},e))}}import Ao from"react";const se=h(p());import wi,{PureComponent as Rf,Component as ws,forwardRef as xs,memo as kc,createElement as Mf}from"react";const hc=h(p());import{useState as pf}from"react";if(!pf)throw new Error("mobx-react-lite requires React with Hooks support");if(!hc.spy)throw new Error("mobx-react-lite requires mobx at least version 4 to be available");import{unstable_batchedUpdates as pc}from"react-dom";const gc=h(p());import{useCallback as ff,useEffect as n0,useState as mf}from"react";var gf=function(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var r=i.call(e),o,n=[],a;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)n.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(a)throw a.error}}return n};function ps(){var e=gf(mf(0),2),t=e[1],i=ff(function(){t(function(r){return r+1})},[]);return i}function fc(e){return typeof Symbol=="function"?Symbol.for(e):"__$mobx-react "+e+"__"}var bf={};function mc(){return typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:bf}var yf=fc("observerBatching");function vf(e){e()}function wo(e){e||(e=vf),gc.configure({reactionScheduler:e}),mc()[yf]=!0}var Sf=!1;function kt(){return Sf}import{forwardRef as Ef,memo as Cc}from"react";const bs=h(p());import ys from"react";const bc=h(p());function yc(e){return bc.getDependencyTree(e)}function vc(e){var t={cleanAt:Date.now()+Df,reaction:e};return t}var Df=1e4,wf=1e4,Cr=new Set,fs;function Sc(){fs===void 0&&(fs=setTimeout(xf,wf))}function Dc(e){Cr.add(e),Sc()}function wc(e){Cr.delete(e)}function xf(){fs=void 0;var e=Date.now();Cr.forEach(function(t){var i=t.current;i&&(e>=i.cleanAt&&(i.reaction.dispose(),t.current=null,Cr.delete(t)))}),Cr.size>0&&Sc()}import Cf from"react";var xo=!1,Co=[];function ms(e){return function(){xo?Co.push(e):e()}}function gs(e){xo=!0,Co=[];try{var t=e();xo=!1;var i=Co.length>0?Co:void 0;return Cf.useLayoutEffect(function(){i&&i.forEach(function(r){return r()})},[i]),t}finally{xo=!1}}var _f={};function xc(e){return"observer"+e}function ji(e,t,i){if(t===void 0&&(t="observed"),i===void 0&&(i=_f),kt())return e();var r=i.useForceUpdate||ps,o=r(),n=ms(o),a=ys.useRef(null);if(!a.current){var l=new bs.Reaction(xc(t),function(){c.mounted?n():(l.dispose(),a.current=null)}),c=vc(l);a.current=c,Dc(a)}var d=a.current.reaction;return ys.useDebugValue(d,yc),ys.useEffect(function(){return wc(a),a.current?a.current.mounted=!0:(a.current={reaction:new bs.Reaction(xc(t),function(){n()}),cleanAt:Infinity},n()),function(){a.current.reaction.dispose(),a.current=null}},[]),gs(function(){var u,g;if(d.track(function(){try{u=e()}catch(y){g=y}}),g)throw g;return u})}var vs=function(){return vs=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},vs.apply(this,arguments)};function Ss(e,t){if(kt())return e;var i=vs({forwardRef:!1},t),r=e.displayName||e.name,o=function(a,l){return ji(function(){return e(a,l)},r)};o.displayName=r;var n;return i.forwardRef?n=Cc(Ef(o)):n=Cc(o),kf(e,n),n.displayName=r,n}var Tf={$$typeof:!0,render:!0,compare:!0,type:!0};function kf(e,t){Object.keys(e).forEach(function(i){Tf[i]||Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))})}function Ui(e){var t=e.children,i=e.render,r=t||i;return typeof r!="function"?null:ji(r)}Ui.propTypes={children:_c,render:_c};Ui.displayName="Observer";function _c(e,t,i,r,o){var n=t==="children"?"render":"children",a=typeof e[t]=="function",l=typeof e[n]=="function";return a&&l?new Error("MobX Observer: Do not use children and render in the same time in`"+i):a||l?null:new Error("Invalid prop `"+o+"` of type `"+typeof e[t]+"` supplied to `"+i+"`, expected `function`.")}const Ec=h(p());import T0 from"react";const Ds=h(p());import A0 from"react";wo(pc);var Tc=0;function zf(e){if(typeof Symbol=="function")return Symbol(e);var t="__$mobx-react "+e+" ("+Tc+")";return Tc++,t}var Cs={};function si(e){return Cs[e]||(Cs[e]=zf(e)),Cs[e]}function Ic(e,t){if(Fc(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++)if(!Object.hasOwnProperty.call(t,i[o])||!Fc(e[i[o]],t[i[o]]))return!1;return!0}function Fc(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var Pf={$$typeof:1,render:1,compare:1,type:1,childContextTypes:1,contextType:1,contextTypes:1,defaultProps:1,getDefaultProps:1,getDerivedStateFromError:1,getDerivedStateFromProps:1,mixins:1,propTypes:1};function Bf(e,t){var i=Object.getOwnPropertyNames(Object.getPrototypeOf(e));Object.getOwnPropertyNames(e).forEach(function(r){!Pf[r]&&i.indexOf(r)===-1&&Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}function Bt(e,t,i){Object.hasOwnProperty.call(e,t)?e[t]=i:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:i})}var Oc=si("patchMixins"),Ac=si("patchedDefinition");function Lf(e,t){var i=e[Oc]=e[Oc]||{},r=i[t]=i[t]||{};return r.locks=r.locks||0,r.methods=r.methods||[],r}function Rc(e,t){for(var i=this,r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];t.locks++;try{var a;return e!=null&&(a=e.apply(this,o)),a}finally{t.locks--,t.locks===0&&t.methods.forEach(function(l){l.apply(i,o)})}}function Mc(e,t){var i=function(){for(var o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];Rc.call.apply(Rc,[this,e,t].concat(n))};return i}function Nf(e,t,i){var r=Lf(e,t);r.methods.indexOf(i)<0&&r.methods.push(i);var o=Object.getOwnPropertyDescriptor(e,t);if(o&&o[Ac])return;var n=e[t],a=zc(e,t,o?o.enumerable:void 0,r,n);Object.defineProperty(e,t,a)}function zc(e,t,i,r,o){var n,a=Mc(o,r);return n={},n[Ac]=!0,n.get=function(){return a},n.set=function(c){if(this===e)a=Mc(c,r);else{var d=zc(this,t,i,r,c);Object.defineProperty(this,t,d)}},n.configurable=!0,n.enumerable=i,n}var _s=se.$mobx||"$mobx",Pc=si("isMobXReactObserver"),Bc=si("isUnmounted"),_o=si("skipRender"),Eo=si("isForcingUpdate");function jf(e){var t=e.prototype;if(e[Pc]){var i=Es(t);console.warn("The provided component class ("+i+`) 
                has already been declared as an observer component.`)}else e[Pc]=!0;if(t.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if(e.__proto__!==Rf){if(!t.shouldComponentUpdate)t.shouldComponentUpdate=Lc;else if(t.shouldComponentUpdate!==Lc)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}Nc(t,"props"),Nc(t,"state");var r=t.render;return t.render=function(){return Hf.call(this,r)},Nf(t,"componentWillUnmount",function(){var o;if(kt()===!0)return;if((o=this.render[_s])===null||o===void 0||o.dispose(),this[Bc]=!0,!this.render[_s]){var n=Es(this);console.warn("The reactive render of an observer class component ("+n+`) 
                was overriden after MobX attached. This may result in a memory leak if the 
                overriden reactive render was not properly disposed.`)}}),e}function Es(e){return e.displayName||e.name||e.constructor&&(e.constructor.displayName||e.constructor.name)||"<component>"}function Hf(e){var t=this;if(kt()===!0)return e.call(this);Bt(this,_o,!1),Bt(this,Eo,!1);var i=Es(this),r=e.bind(this),o=!1,n=new se.Reaction(i+".render()",function(){if(!o&&(o=!0,t[Bc]!==!0)){var l=!0;try{Bt(t,Eo,!0),t[_o]||ws.prototype.forceUpdate.call(t),l=!1}finally{Bt(t,Eo,!1),l&&n.dispose()}}});n.reactComponent=this,a[_s]=n,this.render=a;function a(){o=!1;var l=void 0,c=void 0;if(n.track(function(){try{c=se._allowStateChanges(!1,r)}catch(d){l=d}}),l)throw l;return c}return a.call(this)}function Lc(e,t){return kt()&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==t?!0:!Ic(this.props,e)}function Nc(e,t){var i=si("reactProp_"+t+"_valueHolder"),r=si("reactProp_"+t+"_atomHolder");function o(){return this[r]||Bt(this,r,se.createAtom("reactive "+t)),this[r]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){var a=!1;return se._allowStateReadsStart&&se._allowStateReadsEnd&&(a=se._allowStateReadsStart(!0)),o.call(this).reportObserved(),se._allowStateReadsStart&&se._allowStateReadsEnd&&se._allowStateReadsEnd(a),this[i]},set:function(a){!this[Eo]&&!Ic(this[i],a)?(Bt(this,i,a),Bt(this,_o,!0),o.call(this).reportChanged(),Bt(this,_o,!1)):Bt(this,i,a)}})}var Hc=typeof Symbol=="function"&&Symbol.for,jc=Hc?Symbol.for("react.forward_ref"):typeof xs=="function"&&xs(function(e){return null}).$$typeof,Uc=Hc?Symbol.for("react.memo"):typeof kc=="function"&&kc(function(e){return null}).$$typeof;function ks(e){if(e.isMobxInjector===!0&&console.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),Uc&&e.$$typeof===Uc)throw new Error("Mobx observer: You are trying to use 'observer' on a function component wrapped in either another observer or 'React.memo'. The observer already applies 'React.memo' for you.");if(jc&&e.$$typeof===jc){var t=e.render;if(typeof t!="function")throw new Error("render property of ForwardRef was not a function");return xs(function(){var r=arguments;return Mf(Ui,null,function(){return t.apply(void 0,r)})})}return typeof e=="function"&&(!e.prototype||!e.prototype.render)&&!e.isReactClass&&!Object.prototype.isPrototypeOf.call(ws,e)?Ss(e):jf(e)}function ko(){return ko=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},ko.apply(this,arguments)}function Uf(e,t){if(e==null)return{};var i={},r=Object.keys(e),o,n;for(n=0;n<r.length;n++){if(o=r[n],t.indexOf(o)>=0)continue;i[o]=e[o]}return i}var Ts=wi.createContext({});function Wf(e){var t=e.children,i=Uf(e,["children"]),r=wi.useContext(Ts),o=wi.useRef(ko({},r,i)),n=o.current;if(!1)var a;return wi.createElement(Ts.Provider,{value:n},t)}Wf.displayName="MobXProvider";function Wc(e,t,i,r){var o=wi.forwardRef(function(n,a){var l=ko({},n),c=wi.useContext(Ts);return Object.assign(l,e(c||{},l)||{}),a&&(l.ref=a),wi.createElement(t,l)});return r&&(o=ks(o)),o.isMobxInjector=!0,Bf(t,o),o.wrappedComponent=t,o.displayName=$f(t,i),o}function $f(e,t){var i,r=e.displayName||e.name||e.constructor&&e.constructor.name||"Component";return t?i="inject-with-"+t+"("+r+")":i="inject("+r+")",i}function Vf(e){return function(t,i){return e.forEach(function(r){if(r in i)return;if(!(r in t))throw new Error("MobX injector: Store '"+r+"' is not available! Make sure it is provided by some Provider");i[r]=t[r]}),i}}function $c(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(typeof arguments[0]=="function"){var r=arguments[0];return function(o){return Wc(r,o,r.name,!0)}}else return function(o){return Wc(Vf(t),o,t.join("-"),!1)}}if(!ws)throw new Error("mobx-react requires React to be available");if(!se.observable)throw new Error("mobx-react requires mobx to be available");import Wi from"react";import Vc,{css as Kf}from"styled-components";import Gf,{css as qf}from"styled-components";const _r=qf`
  position: absolute;
  top: 0;
  left: 0;
  height: ${e=>e.theme.measurements.colorItem.size}px;
  width: ${e=>e.theme.measurements.colorItem.size}px;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};
  pointer-events: none;
`,Xf=Gf.div.attrs(e=>({style:{background:e.color}}))`
  ${_r}
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.background};
`;var To=Xf;const Yf=Vc.div`
  ${_r}
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.overlay};

  box-sizing: border-box;
  border: 2px solid transparent;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};
  transition: border-color 300ms ease-in-out;
  ${e=>e.isActive&&Kf`
      border-color: ${e.theme.selectColor.activeBorderColor};
    `}
`,Fs=Vc.span`
  display: inline-block;
  height: 2px;
  width: 2px;
  border-radius: 50%;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.6);
  background: rgba(255, 255, 255, 0.87);
  margin: 1px;
  pointer-events: none;
`,Jf=({isActive:e,className:t,style:i})=>Wi.createElement(Yf,{isActive:e,className:t,style:i},e&&Wi.createElement(Wi.Fragment,null,Wi.createElement(Fs,null),Wi.createElement(Fs,null),Wi.createElement(Fs,null)));var Fo=Jf;import em from"styled-components";import{css as Zf}from"styled-components";const ve=Zf`
  &:focus {
    outline: none;
    box-shadow: 0 0 2px ${e=>e.theme.focusOutlineColor};
  }
  &:-moz-focusring {
    outline: none;
    box-shadow: 0 0 2px ${e=>e.theme.focusOutlineColor};
  }
`;import{css as Qf}from"styled-components";const $i=Qf`
  position: absolute !important;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
  clip: rect(1px, 1px, 1px, 1px);
`;const tm=em.button.attrs({type:"button"})`
  &&& {
    box-sizing: border-box;
  }
  position: relative;
  background: transparent;
  border: none;
  height: ${e=>e.theme.measurements.colorItem.size}px;
  width: ${e=>e.theme.measurements.colorItem.size}px;
  margin: ${e=>e.theme.colorItem.margin};
  padding: 0;
  cursor: pointer;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};

  &:hover {
    opacity: 0.7;
  }

  ${ve}

  &:disabled {
    opacity: ${e=>e.theme.selectColor.inactiveOpacity};
    cursor: default;
  }
`;var Io=tm;import im from"styled-components";const rm=im.div.attrs(e=>{const t=e.url?{backgroundImage:`url(${e.url})`}:{};return{style:t}})`
  ${_r}
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.tiledBackground};
`;var Oo=rm;const om=({isActive:e,onClick:t,color:i,label:r,isDisabled:o,tiledBackgroundUrl:n,className:a,style:l,children:c})=>Ao.createElement(Io,{disabled:o,onClick:t,"aria-label":r,className:a,style:l},Ao.createElement(Oo,{url:n}),Ao.createElement(To,{color:i}),Ao.createElement(Fo,{isActive:e}),c);var Gc=$c("config")(ks(om));import Is from"react";import nm from"styled-components";const sm=nm.div`
  display: block;
  opacity: 1;
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: ${e=>e.theme.measurements.zIndex.dialog.backdrop};
  text-align: left;
  background: ${e=>e.theme.modal.backdrop};
  height: 100%;
  width: 100%;
`;var Ro=sm;import am from"react";import lm,{css as cm}from"styled-components";const dm=lm.div`
  display: none;
  visibility: hidden;
  opacity: 0;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${e=>e.theme.measurements.zIndex.dialog.base};
  transition: opacity 100s ease-in-out;

  ${e=>e.isVisible&&cm`
      opacity: 1;
      display: block;
      visibility: visible;
    `};
`,Mo=({isVisible:e,className:t,children:i})=>am.createElement(dm,{isVisible:e,className:t},i);import um from"styled-components";const hm=um.div.attrs(({style:e})=>({role:"dialog","aria-hidden":!1,style:e}))`
  display: flex;
  flex: 0 0 auto;
  flex-direction: column;
  transition: top 0.25s ease;
  position: absolute;
  top: calc(50% + ${e=>e.top}px);
  left: calc(50% + ${e=>e.left}px);
  width: ${e=>e.width};
  height: ${e=>e.height};
  transform: translate(-50%, -50%);
  border-radius: ${e=>e.theme.shape.radiusLarge}px;
  background: ${e=>e.theme.modal.background};
  color: ${e=>e.theme.modal.bodyForeground};
  z-index: ${e=>e.theme.measurements.zIndex.dialog.container};

  @media all and (min-width: 0) and (max-width: 640px) {
    text-align: center;
    width: auto;
    min-width: 200px;
    height: auto;
    top: 50%;
    left: 50%;
  }
`;var zo=hm;const pm=({isVisible:e=!1,width:t="350px",height:i="fit-content",position:r,header:o,body:n,footer:a,className:l,style:c,children:d})=>Is.createElement(Mo,{isVisible:e},Is.createElement(Ro,null),Is.createElement(zo,{height:i,width:t,left:r.x,top:r.y,className:l,style:c,"data-test":ye.Dialog},o,n,d,a));var qc=pm;import fm from"styled-components";const mm=fm.div`
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-sizing: border-box;
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  color: ${e=>e.theme.modal.bodyForeground};

  padding: 0px 20px 11px;
  &:first-child {
    padding-top: 11px;
  }

  @media all and (min-width: 0) and (max-width: 640px) {
    align-items: center;
  }
`;var Lt=mm;import gm from"styled-components";const bm=gm.div`
  display: flex;
  border-top: 2px solid
    ${e=>e.type==="error"?e.theme.error:e.theme.warning};

  min-height: 40px;
  justify-content: flex-end;
  @media all and (min-width: 0) and (max-width: 640px) {
    height: auto;
    flex-direction: column;
    justify-content: space-around;
  }
`;var Vi=bm;import ym from"styled-components";const vm=ym.h3`
  font-size: ${e=>e.theme.measurements.fontSystem.headline2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.headline2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.headline2.case};
  color: ${e=>e.theme.modal.headerForeground};

  padding: 11px 20px 0px;
`;var Gi=vm;import Sm,{css as Xc,keyframes as Dm}from"styled-components";const Kc=Dm`
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
`,wm=Xc`
  animation: ${Kc} 2s infinite ease 1.5s;
`,xm=Xc`
  animation: ${Kc} 2s infinite ease;
`,Cm=Sm.div`
  color: ${e=>e.theme.primary};
  margin: 12px 0;
  position: relative;
  width: 40px;
  height: 40px;
  box-shadow: inset 0 0 0 2px;
  transform: translateZ(0);
  border-radius: 50%;
  &:before,
  &:after {
    border-radius: 50%;
    position: absolute;
    content: '';
  }
  &:before {
    width: 25px;
    height: 45px;
    background: ${e=>e.theme.modal.background};
    border-radius: 45px 0 0 45px;
    top: -2.5px;
    left: -2.5px;
    transform-origin: 25px 25px;
    ${wm};
  }
  &:after {
    width: 25px;
    height: 45px;
    background: ${e=>e.theme.modal.background};
    border-radius: 0 45px 45px 0;
    top: -2.5px;
    left: 25px;
    transform-origin: 0px 25px;
    ${xm};
  }
`;var Po=Cm;import Wo from"react";import Ps from"react";import Bs from"react-dom";const Os=["Moz","Webkit","O","ms"];function _m(e){let t="",i=!0,r;for(r=0;r<e.length;r+=1)i?(t+=e[r].toUpperCase(),i=!1):e[r]==="-"?i=!0:t+=e[r];return t}function As(e,t){return t?`${t}${_m(e)}`:e}function Em(e="transform"){if(typeof window=="undefined"||typeof window.document=="undefined")return"";const{style:t}=window.document.documentElement;if(e in t)return"";let i;for(i=0;i<Os.length;i+=1)if(As(e,Os[i])in t)return Os[i];return""}var Yc=Em();function Bo(e,t){for(let i=0,{length:r}=e;i<r;i+=1)if(t.apply(t,[e[i],i,e]))return e[i];return null}function Rs(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function qi(e){return typeof e=="number"&&!Number.isNaN(e)}function Se(e){return parseInt(e,10)}let Lo="";function km(e,t){return Lo||(Lo=Bo(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],i=>Rs(e[i]))),Rs(e[Lo])?e[Lo](t):!1}function Ms(e,t,i){let r=e;do{if(km(r,t))return!0;if(r===i)return!1;r=r.parentNode}while(r);return!1}function No(e,t,i){if(!e)return;e.attachEvent?e.attachEvent(`on${t}`,i):e.addEventListener?e.addEventListener(t,i,!0):e[`on${t}`]=i}function ai(e,t,i){if(!e)return;e.detachEvent?e.detachEvent(`on${t}`,i):e.removeEventListener?e.removeEventListener(t,i,!0):e[`on${t}`]=null}function Jc(e){let t=e.clientHeight;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t+=Se(i.borderTopWidth),t+=Se(i.borderBottomWidth),t}function Zc(e){let t=e.clientWidth;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t+=Se(i.borderLeftWidth),t+=Se(i.borderRightWidth),t}function Qc(e){let t=e.clientHeight;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t-=Se(i.paddingTop),t-=Se(i.paddingBottom),t}function ed(e){let t=e.clientWidth;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t-=Se(i.paddingLeft),t-=Se(i.paddingRight),t}function td(e,t){const i=t===t.ownerDocument.body,r=i?{left:0,top:0}:t.getBoundingClientRect(),o=e.clientX+t.scrollLeft-r.left,n=e.clientY+t.scrollTop-r.top;return{x:o,y:n}}function id({x:e,y:t,rotation:i}){const r=`translate(${e}px,${t}px) rotate(${i}rad)`;return{[As("transform",Yc)]:r}}function rd(e,t){let i=null;return e.targetTouches&&(i=Bo(e.targetTouches,r=>t===r.identifier)),e.changedTouches&&!i&&(i=Bo(e.changedTouches,r=>t===r.identifier)),i}function od(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:null}import Tm from"react-dom";function zs(e){const t=Tm.findDOMNode(e);if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}function nd(e,t,i){if(!e.props.bounds)return[t,i];let{bounds:r}=e.props;r=typeof r=="string"?r:f({},r);const o=zs(e);if(typeof r=="string"){const{ownerDocument:n}=o,a=n.defaultView,l=r==="parent"?o.parentNode:n.querySelector(r);if(!(l instanceof HTMLElement))throw new Error(`Bounds selector "${r}" could not find an element.`);if(o instanceof HTMLElement){const c=a.getComputedStyle(o),d=a.getComputedStyle(l);r={left:-o.offsetLeft+Se(d.paddingLeft)+Se(c.marginLeft),top:-o.offsetTop+Se(d.paddingTop)+Se(c.marginTop),right:ed(l)-Zc(o)-o.offsetLeft+Se(d.paddingRight)-Se(c.marginRight),bottom:Qc(l)-Jc(o)-o.offsetTop+Se(d.paddingBottom)-Se(c.marginBottom)}}}return r=r,qi(r.right)&&(t=Math.min(t,r.right)),qi(r.bottom)&&(i=Math.min(i,r.bottom)),qi(r.left)&&(t=Math.max(t,r.left)),qi(r.top)&&(i=Math.max(i,r.top)),[t,i]}function Ho(e,t,i){const{state:r}=e,o=!qi(r.lastX),n=zs(e);return o?{node:n,deltaX:0,deltaY:0,lastX:t,lastY:i,x:t,y:i}:{node:n,deltaX:t-r.lastX,deltaY:i-r.lastY,lastX:r.lastX,lastY:r.lastY,x:t,y:i}}function jo(e,t){return{node:t.node,x:e.state.x+t.deltaX,y:e.state.y+t.deltaY,deltaX:t.deltaX,deltaY:t.deltaY,lastX:e.state.x,lastY:e.state.y}}function sd(e){return e.props.axis==="both"||e.props.axis==="x"}function ad(e){return e.props.axis==="both"||e.props.axis==="y"}function Uo(e,t){const i=zs(t);let{offsetParent:r}=t.props;return!r&&i instanceof HTMLElement&&(r=i.offsetParent||i.ownerDocument.body),td(e,r)}const Tt={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let $e=Tt.mouse;const Ls={cancel:null,disabled:!1,offsetParent:null,handle:null,transform:null,onStart:()=>{},onDrag:()=>{},onStop:()=>{},onMouseDown:()=>{}};class Xi extends Ps.Component{constructor(){super(...arguments);this.state={dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:void 0};this.getTouchFromEvent=e=>{const t=od(e);return this.setState({touchIdentifier:t}),rd(e,t)};this.preventDefault=e=>{e.stopPropagation&&e.stopPropagation()};this.handleDragStart=e=>{const t=Bs.findDOMNode(this);if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:i}=t;if(this.props.disabled||!(e.target instanceof Node)||this.props.handle&&!Ms(e.target,this.props.handle,t)||this.props.cancel&&Ms(e.target,this.props.cancel,t))return!1;const r=Uo(e,this);if(r==null)return!1;const{x:o,y:n}=r,a=Ho(this,o,n),l=this.props.onStart(e,a);if(l===!1)return!1;this.setState({dragging:!0,lastX:o,lastY:n}),$e.move==="touchmove"?No(i,$e.move,this.onTouchDrag):No(i,$e.move,this.onMouseDrag),No(i,$e.stop,this.handleDragStop)};this.handleDrag=e=>{const t=Uo(e,this);if(t==null)return;const{x:i,y:r}=t,o=Ho(this,i,r),n=this.props.onDrag(e,o);if(n===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(a){const l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.setState({lastX:i,lastY:r})};this.handleDragStop=e=>{if(!this.state.dragging)return;const t=Uo(e,this);if(t==null)return;const{x:i,y:r}=t,o=Ho(this,i,r),n=Bs.findDOMNode(this);this.setState({dragging:!1,lastX:NaN,lastY:NaN}),this.props.onStop(e,o),n&&($e.move==="touchmove"?ai(n.ownerDocument,$e.move,this.onTouchDrag):ai(n.ownerDocument,$e.move,this.onMouseDrag),ai(n.ownerDocument,$e.stop,this.handleDragStop))};this.onMouseDown=e=>(this.preventDefault(e),$e=Tt.mouse,this.props.onMouseDown(e),e.button&&typeof e.button=="number"&&e.button!==0?!1:this.handleDragStart(e));this.onMouseDrag=e=>(this.preventDefault(e),this.handleDrag(e));this.onMouseUp=e=>(this.preventDefault(e),$e=Tt.mouse,this.handleDragStop(e));this.onTouchStart=e=>{this.preventDefault(e),$e=Tt.touch;const t=this.getTouchFromEvent(e);return this.handleDragStart(t)};this.onTouchDrag=e=>{this.preventDefault(e),$e=Tt.touch;const t=this.getTouchFromEvent(e);return this.handleDrag(t)};this.onTouchEnd=e=>{this.preventDefault(e),$e=Tt.touch;const t=this.getTouchFromEvent(e);return this.handleDragStop(t)}}componentWillUnmount(){const e=Bs.findDOMNode(this);if(e){const{ownerDocument:t}=e;ai(t,Tt.mouse.move,this.onMouseDrag),ai(t,Tt.touch.move,this.onTouchDrag),ai(t,Tt.mouse.stop,this.handleDragStop),ai(t,Tt.touch.stop,this.handleDragStop)}}render(){return Ps.cloneElement(Ps.Children.only(this.props.children),{style:f({touchAction:"none"},this.props.children.props.style),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}Xi.defaultProps=Ls,Xi.displayName="DraggableCore";const Fm=f(f({},Ls),{axis:"both",bounds:!1,defaultClassName:"draggable",defaultClassNameDragging:"draggable-dragging",defaultClassNameDragged:"draggable-dragged",defaultPosition:{x:0,y:0},position:null,rotation:0,updateOnPosition:!1});class Ns extends Wo.Component{constructor(e){super(e);this.onDragStart=(e,t)=>{const i=this.props.onStart(e,jo(this,t));if(i===!1)return!1;this.setState({dragging:!0,dragged:!0})};this.onDrag=(e,t)=>{const{position:i,defaultPosition:r,onDrag:o,bounds:n}=this.props;if(!this.state.dragging)return!1;const a=jo(this,t),l=Boolean(i),c={x:l?a.x:r.x,y:l?a.y:r.y,slackX:0,slackY:0};if(n){const{x:u,y:g}=c;c.x+=this.state.slackX,c.y+=this.state.slackY;const[y,E]=nd(this,c.x,c.y);c.x=y,c.y=E,c.slackX=this.state.slackX+(u-c.x),c.slackY=this.state.slackY+(g-c.y),a.x=c.x,a.y=c.y,a.deltaX=c.x-this.state.x,a.deltaY=c.y-this.state.y}const d=o(e,a);if(d===!1)return!1;this.setState(c)};this.onDragStop=(e,t)=>{if(!this.state.dragging)return!1;const i=this.props.onStop(e,jo(this,t));if(i===!1)return!1;const r={dragging:!1,slackX:0,slackY:0,x:0,y:0},o=Boolean(this.props.position);if(o){const{x:n,y:a}=this.props.position;r.x=n,r.y=a}this.setState(r)};this.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,slackX:0,slackY:0}}componentDidUpdate(e){const t=Boolean(this.props.position);t&&(this.props.updateOnPosition?(e.position&&e.position.x!==this.props.position.x||e.position.y!==this.props.position.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}):(e.position&&this.props.position.x!==this.state.x||this.props.position.y!==this.state.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}))}componentWillUnmount(){this.setState({dragging:!1})}render(){const De=this.props,{position:e,defaultPosition:t,rotation:i,defaultClassName:r,defaultClassNameDragging:o,defaultClassNameDragged:n}=De,a=qe(De,["position","defaultPosition","rotation","defaultClassName","defaultClassNameDragging","defaultClassNameDragged"]),{x:l,y:c,dragging:d,dragged:u}=this.state;let g={};const y=Boolean(e),E=!y||d,D=e||t,T={x:sd(this)&&E?l:D.x,y:ad(this)&&E?c:D.y,rotation:i};g=id(T);const z=Wo.Children.only(this.props.children),K=[z.props.className||"",r,d?o:"",u?n:""].join(" ").trim(),re=Wo.cloneElement(z,{className:K,style:f(f({},z.props.style),g)});return Wo.createElement(Xi,f(f({},a),{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),re)}}Ns.defaultProps=Fm,Ns.displayName="Draggable";var ld=Ns;const fd=h(Er());import bt from"react";import li,{css as md}from"styled-components";import Tr from"react";import qm,{css as Xm}from"styled-components";import kr from"styled-components";const Vo=kr.span`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
`,js=kr(Vo)``,Ve=kr(Vo)``,Ki=kr(Vo)``,Go={display:"none",left:0,top:0},qo=kr(Vo)`
  display: ${({display:e})=>e};
  left: ${({left:e})=>e}px;
  top: ${({top:e})=>e}px;
  pointer-events: none;
  border-radius: 50%;
  background-color: rgba(255, 255, 255, 0.12);
  animation: ${po} 1.2s;
  width: 100px;
  height: 100px;
  margin-top: -50px;
  margin-left: -50px;
  opacity: 0;
`,Nt=Xm`
  color: ${e=>e.theme.button.activeForeground};
`,Km=qm.button`
  &&& {
    box-sizing: border-box;
  }
  text-align: center;
  position: relative;
  padding: 4px 8px;
  min-height: 32px;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  font-size: ${e=>e.theme.measurements.fontSystem.button1.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.button1.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.button1.case};
  font-family: ${e=>e.theme.typography.fontFamily}, sans-serif;
  cursor: pointer;
  border: none;
  background-color: transparent;
  overflow: hidden;
  ${ve}

  /* Active */

  &:active {
    ${Nt}
  }

  ${({isActive:e})=>e&&Nt}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${Ve} {
      background-color: ${e=>e.theme.button.outlinedInactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${Ki} {
      background-color: ${e=>e.theme.button.hoverOverlayColor};
    }
  }
`;class et extends Tr.Component{constructor(){super(...arguments);this.state=Go;this.timeout=null;this.onClick=e=>{const t=e.currentTarget.getBoundingClientRect(),i=e.pageX-t.left,r=e.pageY-t.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(i,r)}):this.setRippleState(i,r),this.props.onClick(e)};this.setRippleState=(e,t)=>{this.setState({left:e,top:t,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){const u=this.props,{isActive:e,isDisabled:t,label:i,ariaLabel:r,children:o,className:n}=u,a=qe(u,["isActive","isDisabled","label","ariaLabel","children","className"]),{left:l,top:c,display:d}=this.state;return Tr.createElement(Km,f(f({"data-test":r,className:n,isActive:e,disabled:t,"aria-label":r},a),{onClick:this.onClick}),i,o,Tr.createElement(qo,{display:d,left:l,top:c}),Tr.createElement(Ve,null),Tr.createElement(Ki,null))}}et.defaultProps={type:"button",isDisabled:!1,isActive:!1};import Ym from"react";import pd,{css as Jm}from"styled-components";const Zm=pd.label`
  ${$i}
`,Qm=pd.label`
  display: block;
  font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
  color: ${e=>e.theme.toolControlBar.inputLabelForeground};
  margin: 0;
  padding-bottom: 8px;

  ${({isDisabled:e})=>e&&Jm`
      opacity: ${t=>t.theme.toolControlBar.inputLabelInactiveOpacity};
      cursor: default;
      pointer-events: none;
    `}
`,Ce=({label:e,htmlFor:t,show:i,style:r,isDisabled:o,className:n})=>{const a=i?Qm:Zm,l=t||(e?e.replace(" ","-"):void 0);return Ym.createElement(a,{style:r,isDisabled:o,htmlFor:l,className:n},e)};Ce.defaultProps={show:!0};const eg=li.div`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
`,tg=li(Ce)`
  align-self: flex-start;
`,gd=li(et)`
  color: ${e=>e.theme.button.textSecondaryForeground};
  padding: 1px 7px 2px;
`,ig=li.div`
  display: flex;
  justify-content: space-between;
  width: ${e=>e.theme.measurements.advancedUIToolControlBar.width-48}px;
`,rg=li.article`
  /* 0.6 of width here refers to the width of the container without padding */
  width: ${e=>.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  text-align: center;
  margin-top: 7px;
  display: inline-block;
  color: ${e=>e.theme.toolControlBar.inputLabelForeground};
`,og=li.div`
  width: ${e=>.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  transform: translateZ(0);
  overflow: hidden;
  transition: all 500ms ease-out;
`,ng=li.span`
  width: ${e=>Math.round(e.length*.6*e.theme.measurements.advancedUIToolControlBar.width)}px;
  margin-left: -${e=>e.activeIndex*.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  position: relative;
  display: inline-block;
  transform: translateZ(0);
  transition: all 600ms cubic-bezier(0.77, 0, 0.175, 1);
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
`,bd=li.div`
  border: solid ${e=>e.theme.card.foreground};
  border-width: 0 2px 2px 0;
  padding: 3px;
  height: 0;
  width: 0;

  ${({direction:e})=>e==="left"?md`
          margin-left: 2px;
          transform: rotate(135deg);
        `:md`
          margin-right: 2px;
          transform: rotate(-45deg);
        `}
`;class yd extends bt.PureComponent{constructor(e){super(e);this.updateIndex=(e,t=!1)=>{let i=e+(t?-1:1);const r=this.props.list.length-1;i>r&&(i=0),i<0&&(i=r),this.props.onSelect(this.props.list[i].identifier)};this.getActiveIndex=e=>{const{list:t}=this.props,i=t.findIndex(r=>r.identifier===e);return i!==-1?i:0};this.throttledUpdateIndex=fd.default(this.updateIndex,600)}render(){const{list:e,label:t,showLabel:i=!0}=this.props,r=this.getActiveIndex(this.props.defaultIdentifier),o=e.length<=1;return bt.createElement(eg,{"data-test":ye.CarouselSlider},bt.createElement(tg,{show:i,label:t}),bt.createElement(ig,{id:`photoeditorsdk-${t.replace(" ","-")}`},bt.createElement(gd,{ariaLabel:"Select Previous",isDisabled:o,onClick:()=>this.throttledUpdateIndex(r,!0)},bt.createElement(bd,{direction:"left"})),bt.createElement(og,null,bt.createElement(ng,{activeIndex:r,length:e.length},e.map(n=>bt.createElement(rg,{key:n.identifier},n.value)))),bt.createElement(gd,{ariaLabel:"Select Next",isDisabled:o,onClick:()=>this.throttledUpdateIndex(r)},bt.createElement(bd,{direction:"right"}))))}}yd.defaultProps={showLabel:!0};var vd=yd;import Ir from"react";import sg from"styled-components";const ag=sg.div`
  display: flex;
  position: relative;
  margin-bottom: 12px;
  max-width: ${e=>e.theme.measurements.basicToolControlBar.maxWidth}px;
`;var Xo=ag;import lg,{css as Sd}from"styled-components";const cg=lg.div.attrs({tabIndex:0})`
  position: relative;
  height: 16px;
  width: 16px;
  cursor: pointer;
  background-color: ${e=>e.theme.checkbox.background};
  border-radius: ${e=>e.theme.shape.radiusSmall}px;
  transition-timing-function: ease-in;
  transition-duration: 0.3s;
  &::after {
    content: '';
    position: absolute;
    display: inline-block;
    left: 5px;
    width: 5px;
    height: 10px;
    border-style: solid;
    border-width: 0 2px 2px 0;
    border-color: transparent;
    transform: rotate(45deg) scale(0.8);
  }

  &:first-child {
    margin-right: 8px;
  }

  &:last-child {
    margin-left: 8px;
  }

  ${ve}

  &:hover {
    opacity: ${e=>e.theme.checkbox.hoverOpacity};
  }
  ${e=>e.isChecked&&Sd`
      background-color: ${e.theme.checkbox.activeBackground};
      &::after {
        color: ${e.theme.checkbox.activeForeground};
        border-color: ${e.theme.checkbox.foreground};
      }
      &:hover {
        background-color: ${e.theme.checkbox.activeBackground};
        opacity: 0.8;
      }
    `}
  ${e=>e.isDisabled&&Sd`
      opacity: 0.5;
      cursor: default;
      pointer-events: none;
    `}
`;var Fr=cg;import dg from"styled-components";const ug=dg.input.attrs({type:"checkbox",tabIndex:0})`
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
  margin: 0;
  padding: 0;
  ${ve}
`;var Ko=ug;const Dd=({label:e,value:t,checkMarkPosition:i,onClick:r,isDisabled:o,className:n,style:a})=>{const l=`photoeditorsdk-${e.replace(" ","-")}`;return Ir.createElement(Xo,{"data-test":ye.Checkbox,className:n,style:a},i==="left"&&Ir.createElement(Fr,{onClick:r,isDisabled:o,isChecked:t}),Ir.createElement(Ce,{isDisabled:o,label:e,htmlFor:l}),Ir.createElement(Ko,{id:l,disabled:o,checked:t,onChange:r}),i==="right"&&Ir.createElement(Fr,{onClick:r,isDisabled:o,isChecked:t}))};var wd=Dd;Dd.defaultProps={value:!1,checkMarkPosition:"left"};import{css as hg}from"styled-components";const ci=hg`
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  width: 100%;
  min-height: 26px;
  color: ${e=>e.theme.textInput.foreground};
  padding-bottom: 7px;
  border: none;
  appearance: none;
  border-bottom: 1px solid ${e=>e.theme.textInput.borderColor};
  background: ${e=>e.theme.textInput.background};
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
  transition: border-color 0.4s ease-in-out;

  &:focus {
    outline: none;
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &:-moz-focusring {
    outline: none;
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &:disabled {
    opacity: ${e=>e.theme.textInput.inactiveOpacity};
    pointer-events: none;
  }

  &:hover {
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &::-ms-clear,
  &::-ms-reveal {
    display: none;
  }

  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  &::-webkit-inner-spin-button,
  &::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
`;import jt from"react";import Id from"styled-components";import pg,{css as fg}from"styled-components";const xd=fg`
  opacity: ${e=>e.theme.dropdown.inactiveOpacity};
  pointer-events: none;
`,Cd=pg.div`
  display: block;
  position: relative;
  width: 100%;
  white-space: nowrap;
  transition-duration: 0.5s;

  &:disabled {
    ${xd}
  }

  ${({isDisabled:e})=>e&&xd}
`;import mg,{css as gg}from"styled-components";const _d=mg.li`
  padding: 10px 16px;
  text-overflow: ellipsis;
  font-size: ${e=>e.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.button2.case};
  white-space: nowrap;
  color: ${e=>e.theme.dropdown.foreground};

  &:hover {
    cursor: pointer;
    background: ${e=>e.theme.dropdown.listItemHoverBackground};
  }

  ${({isActive:e})=>e&&gg`
      border-left: 2px solid ${t=>t.theme.primary};
    `}

  ${ve}
`;import vg,{css as Td}from"styled-components";import Ed from"react";import kd,{css as Yi}from"styled-components";const bg=kd.div`
  display: flex;
  ${e=>Ht()||Or()?Yi`
        overflow: hidden;
      `:e.direction==="vertical"?Yi`
        flex-direction: column;
        flex: 1 1 auto;
        overflow-y: auto;
        overflow-x: hidden;
      `:Yi`
      overflow-y: hidden;
      overflow-x: auto;
    `};
`,yg=kd.ul.attrs(()=>({role:"menubar","aria-label":"Tool Navigation"}))`
  display: flex;
  flex-direction: ${e=>e.direction==="vertical"?"column":"row"};

  list-style: none;
  padding: 0;
  margin: 0;

  ${e=>Ht()||Or()?Yi`
        width: 100%;
        height: 100%;

        ${()=>e.direction==="vertical"?Yi`
              overflow-y: auto;
              overflow-x: hidden;

              /* hidde the arrows */
              margin-top: -10px;
              margin-bottom: -10px;
              padding-top: 10px;
              padding-bottom: 10px;

              /* hide the scrollbar */
              padding-right: 10px;
              margin-right: -10px;
            `:Yi`
            overflow-y: hidden;
            overflow-x: auto;

            margin-right: -10px;
            margin-left: -10px;
            padding-right: 10px;
            padding-left: 10px;

            padding-bottom: 10px;
            margin-bottom: -10px;
          `}

        scrollbar-face-color: #454545;
        scrollbar-track-color: ${e.theme.toolbar.background};
        scrollbar-base-color: ${e.theme.toolbar.background};
        scrollbar-3dlight-color: #454545;
        scrollbar-highlight-color: #454545;
        scrollbar-arrow-color: ${e.theme.toolbar.background};
        scrollbar-shadow-color: #454545;
        scrollbar-dark-shadow-color: #454545;
      `:""}
`,Us=({direction:e="horizontal","data-test":t,className:i,children:r})=>Ed.createElement(bg,{direction:e,className:i},Ed.createElement(yg,{direction:e,"data-test":t},r));const Ws=vg(Us)`
  position: absolute;

  background: ${e=>e.theme.dropdown.listBackground};
  color: ${e=>e.theme.dropdown.listForeground};
  border: 1px solid ${e=>e.theme.dropdown.listBorderColor};
  box-shadow: ${e=>e.theme.dropdown.listShadow};

  visibility: hidden;
  opacity: 0;
  ${e=>e.isOpen?Td`
        visibility: visible;
        opacity: 1;
        display: flex;
      `:""}

  transition: all 0.5s ease;

  width: 100%;
  max-height: 160px;
  margin: 5px 0;

  /* had to add these changes to get the dropdown working in IE11 */
  ${()=>Ht()?Td`
        > ul {
          height: 160px;
          margin-bottom: 0px;
          margin-top: 0px;
          padding-bottom: 0px;
          padding-top: 0px;
        }
      `:""}

  border-radius: 0 0 ${e=>e.theme.shape.radiusMedium}px
    ${e=>e.theme.shape.radiusMedium}px;
  z-index: ${e=>e.theme.measurements.zIndex.input.list};
`;Ws.defaultProps={direction:"vertical"};import Sg from"styled-components";const Fd=Sg.div`
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  color: ${e=>e.theme.dropdown.foreground};
  background-color: ${e=>e.theme.dropdown.background};
  border: none;
  border-bottom: 1px solid ${e=>e.theme.dropdown.borderColor};
  padding: 5px 0;
  cursor: ${e=>e.showList?"pointer":"default"};
  transition: border-color 0.4s ease-in-out;

  &:hover {
    border-color: ${e=>e.theme.dropdown.hoverBorderColor};
  }

  ${ve}
`,Dg=Id.div`
  position: absolute;
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${e=>e.theme.dropdown.caretColor};
  transform: rotate(${e=>e.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
  right: 0;
  top: 13px;
`,wg=Id.div``;class Od extends jt.PureComponent{constructor(e){super(e);this.state={isOpen:!1};this.handleOutsideClick=e=>{if(this.node&&this.node.contains(e.target))return;this.setState({isOpen:!1})};this.onSelect=e=>{const{onSelect:t}=this.props;t(e),this.setState({isOpen:!1})};this.onClick=()=>{this.setState(e=>({isOpen:!e.isOpen}))};this.listItem=e=>{const{itemStyle:t,selectedItem:i}=this.props,{isOpen:r}=this.state,{value:o,label:n}=e;let a={};return typeof t=="function"?a=t(e):t!==null&&typeof t=="object"&&(a=t),jt.createElement(_d,{"aria-hidden":!r,tabIndex:0,style:a,onClick:()=>this.onSelect(o),key:o,isActive:i===o},n)};this.onKeyDown=e=>{(e.code==="Space"||e.code==="Enter")&&this.onClick()};this.nodeRef=t=>{this.node=t}}componentDidMount(){document.addEventListener("mousedown",this.handleOutsideClick,!1)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1)}render(){const{selectedItem:e,list:t,label:i,style:r,isDisabled:o}=this.props,{isOpen:n}=this.state,a=t.length>1,l=o?{}:{tabIndex:0};return jt.createElement(wg,null,jt.createElement(Ce,{isDisabled:o,style:{paddingLeft:"0px"},label:i}),jt.createElement("div",{ref:this.nodeRef},jt.createElement(Cd,{isOpen:n,isDisabled:o},jt.createElement(Fd,f(f({"data-test":ye.Dropdown,"aria-hidden":o},l),{showList:a,style:r,onClick:a?this.onClick:void 0,onKeyDown:this.onKeyDown}),e,a&&jt.createElement(Dg,{rotation:n?180:0})),jt.createElement(Ws,{"data-test":ye.DropdownList,isOpen:n},a&&t.map(this.listItem)))))}}import xg from"styled-components";const Ad=xg.input.attrs({type:"file",id:"fileUpload",accept:"image/*"})`
  display: none;
`;import Cg from"react";const _g=({children:e})=>{const t=i=>{i.preventDefault()};return Cg.createElement("form",{onSubmit:t},e)};var Rd=_g;import Ar from"react";import Tg,{css as Pd}from"styled-components";import $s from"react";import Md from"styled-components";const Eg=Md.input`
  ${ci}
  /* override user agent style */
  padding: 0;
  &:disabled {
    opacity: ${e=>e.theme.textInput.inactiveOpacity};
    cursor: default;
    pointer-events: none;
  }
`,kg=Md.div`
  position: relative;
  &:first-child {
    margin-right: 15px;
  }
`;class zd extends $s.Component{constructor(){super(...arguments);this.onChange=e=>{const{onChange:t}=this.props;t&&t(e.target.value)}}render(){const{id:e,testId:t,value:i,type:r,min:o,max:n,onBlur:a,onFocus:l,onKeyUp:c,onKeyDown:d,onMouseUp:u,onTouchEnd:g,isDisabled:y,className:E,children:D}=this.props;return $s.createElement(kg,{className:E},$s.createElement(Eg,{id:e,"data-test":t,"aria-hidden":y,disabled:y,value:i,type:r,min:o,max:n,onChange:this.onChange,onBlur:a,onFocus:l,onKeyUp:c,onKeyDown:d,onMouseUp:u,onTouchEnd:g}),D)}}zd.defaultProps={type:"text"};var Yo=zd;const Fg=Tg.div`
  ${Ht()?Pd``:Pd`
        display: flex;
        flex: 0 1 auto;
        flex-direction: column;
      `}
`;class Rr extends Ar.Component{constructor(e){super(e);this.node=null;this.handleOutsideClick=e=>{if(this.node&&this.node.current&&this.node.current.contains(e.target))return;this.onSubmit()};this.onSubmit=()=>{const{onSubmit:e}=this.props,{value:t,isActive:i}=this.state;if(e){const r=parseFloat(Rr.cleanValue(t));!Number.isNaN(r)&&i&&e(`${r}`)}this.setState({isActive:!1})};this.onBlur=()=>{this.onSubmit()};this.onFocus=()=>{this.setState({isActive:!0})};this.onKeyDown=e=>{const{value:t}=this.state;if(e.key==="Enter")this.onSubmit();else if(e.key==="ArrowUp"){const i=parseFloat(Rr.cleanValue(t));typeof i=="number"&&this.setState({value:(i+1).toString(),isActive:!0})}else if(e.key==="ArrowDown"){const i=parseFloat(Rr.cleanValue(t));typeof i=="number"&&this.setState({value:(i-1).toString(),isActive:!0})}};this.onChange=e=>{this.setState({value:e.replace(/[^\d.,-]/g,""),isActive:!0})};this.state={value:this.props.value||"",isActive:!1},this.node=Ar.createRef(),document.addEventListener("mousedown",this.handleOutsideClick,!1),document.addEventListener("touchstart",this.handleOutsideClick,!1)}static getDerivedStateFromProps({value:e},{value:t,isActive:i}){return e!==t&&!i?{value:e}:null}static cleanValue(e){return e?e.replace(",",".").replace(/[a-zA-Z]/g,"").trim():""}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1),document.removeEventListener("touchstart",this.handleOutsideClick,!1)}render(){const{id:e,label:t,isDisabled:i,ariaHidden:r,onMouseUp:o,onTouchEnd:n,className:a}=this.props,{value:l}=this.state;return Ar.createElement(Fg,{ref:this.node,"data-test":ye.NummericInput,className:a},Ar.createElement(Ce,{htmlFor:e,label:t,show:!!t,isDisabled:i}),Ar.createElement(Yo,{id:e,value:l,isDisabled:i,"aria-hidden":r,onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.onFocus,onMouseUp:o,onTouchEnd:n}))}}Rr.defaultProps={showLabel:!0};var Jo=Rr;import Vs from"react";import Ig from"styled-components";const Og=Ig.input.attrs({type:"search"})`
  ${ci}
`,Ag=e=>{const t=i=>{e.onChange(i.target.value)};return Vs.createElement("div",null,Vs.createElement(Ce,{show:!1,label:"photoeditorsdk-Search"}),Vs.createElement(Og,{id:"photoeditorsdk-Search",onChange:t,placeholder:e.placeholder}))};var Bd=Ag;import Gs from"react";import Ld,{css as Rg}from"styled-components";const Mg=Ld.div``,Nd=({label:e,children:t,inline:i,showLabel:r,isDisabled:o,"data-test":n})=>Gs.createElement(Mg,{"data-test":n},Gs.createElement(Ce,{isDisabled:o,label:e,show:r}),Gs.createElement(zg,{id:`photoeditorsdk-${e.replace(" ","-")}`,inline:!!i},t)),zg=Ld.div`
  display: inline-flex;
  ${e=>!e.inline&&Rg`
        flex-wrap: wrap;
      `||""}
`;Nd.defaultProps={showLabel:!0};var Hd=Nd;import Ji from"react";import Mr,{css as zr}from"styled-components";const Pg=Mr.div`
  display: flex;
  flex-direction: column;
  /* needed for IE11 to properly calculate the width */
  min-width: 1px;
`,Bg=Mr(Ce)`
  padding-bottom: 2px;
`,qs=zr`
  ${Or()||Ht()?zr`
        width: 16px;
        height: 16px;
      `:zr`
        width: 20px;
        height: 20px;
      `}
  background: ${e=>e.theme.slider.thumbBackground};
  border: 2px solid ${e=>e.theme.slider.thumbBorderColor};
  border-radius: 50%;
  cursor: pointer;
`,Lg=e=>{let t=(e.value-e.min)*100/(e.max-e.min);return e.adjust?e.value>0?(t=e.value*(e.max/2)*100,`${e.theme.slider.trackColor} 0%,
      ${e.theme.slider.trackColor} 50%,
      ${e.theme.slider.activeTrackColor} 50%,
      ${e.theme.slider.activeTrackColor} ${50+t}%,
      ${e.theme.slider.trackColor} ${50+t}%,
      ${e.theme.slider.trackColor} 100%
      `):e.value<0?(t=e.value*(e.min/2)*100,`${e.theme.slider.trackColor} 0%,
      ${e.theme.slider.trackColor} ${50-t}%,
      ${e.theme.slider.activeTrackColor} ${50-t}%,
      ${e.theme.slider.activeTrackColor} 50%,
      ${e.theme.slider.trackColor} 50%,
      ${e.theme.slider.trackColor} 100%
      `):`${e.theme.slider.trackColor} 0%,
    ${e.theme.slider.trackColor} 100%`:`${e.theme.slider.activeTrackColor} 0%,
    ${e.theme.slider.activeTrackColor} ${t}%,
    ${e.theme.slider.trackColor} ${t}%,
    ${e.theme.slider.trackColor} 100%`},Ng=Mr.input`
  display: flex;
  flex: 1 0 auto;
  appearance: none;
  max-width: calc(100% - 50px);
  outline: none;
  border-radius: 0; /* iOS */

  ${ve}

  ${Or()||Ht()?zr`
        margin-top: 10px;
        height: 20px;
        /* remove once we have a better concept for focus in all browser */
        &:focus {
          box-shadow: none;
        }
      `:zr`
        height: 2px;
        background: ${e=>`linear-gradient(to right, ${Lg(e)})`};
      `}
  &::-moz-focus-outer {
    /** This is to remove the dotted focus lines in firefox */
    border: 0;
  }
  &:disabled {
    opacity: ${e=>e.theme.slider.inactiveOpacity};
    pointer-events: none;
  }
  &:hover {
    opacity: ${e=>e.theme.slider.hoverOpacity};
  }
  &::-webkit-slider-runnable-track {
    cursor: pointer;
    appearance: none;
  }
  &::-moz-range-track {
    appearance: none;
    cursor: pointer;
  }
  &::-ms-track {
    cursor: pointer;
    height: 2px;
    appearance: none;
    background: transparent;
    color: transparent;
    border-color: transparent;
    border-width: 6px 0;
  }
  &::-webkit-slider-thumb {
    appearance: none;
    ${qs}
  }
  &::-moz-range-thumb {
    appearance: none;
    ${qs}
  }
  &::-ms-thumb {
    appearance: none;
    ${qs}
  }
  &::-ms-fill-lower {
    background: ${e=>`${e.theme.slider.activeTrackColor}`};
  }
  &::-ms-fill-upper {
    background: ${e=>`${e.theme.slider.trackColor}`};
  }
  &::-ms-tooltip {
    display: none;
  }
  @media all and (min-width: 0) and (max-width: 599px) {
    width: 200px;
  }
`,Hg=Mr.div`
  display: flex;
  align-items: center;
  height: 26px;
  margin-right: ${e=>e.centerSlider?-56:0}px;
`,jg=Mr(Jo)`
  max-width: 50px;
  padding-left: 16px;
  > div > input {
    text-align: center;
  }
`;class jd extends Ji.Component{constructor(e){super(e);this.onSubmit=e=>{const{onChange:t,suffix:i,divider:r,min:o,max:n,value:a}=this.props,l=e.replace(i,""),c=l?parseFloat(l)/r:a,d=Math.max(o,Math.min(n,c));Number.isNaN(d)||(t(d),this.props.onMouseUp?this.props.onMouseUp():this.props.onTouchEnd&&this.props.onTouchEnd())};this.onSliderChange=e=>{const{onChange:t}=this.props,i=parseFloat(e.target.value);t(i)};this.randomId=lo()}render(){const{"data-test":e,identifier:t,value:i,min:r,max:o,divider:n,suffix:a,decimal:l,showLabel:c,showInput:d,style:u,centerSlider:g,adjust:y,label:E,isDisabled:D,step:T,"aria-hidden":z,onMouseUp:K,onTouchEnd:re,className:De}=this.props,Ge=`photoeditorsdk-slider-${this.randomId}`,ze=`${Ge}-input`,A=`${(i*n).toFixed(l)}${a}`,te=d&&Ji.createElement(jg,{id:ze,value:A,isDisabled:D,"aria-hidden":z,onSubmit:this.onSubmit});return Ji.createElement(Pg,{className:De,"data-test":e||t||Ge},Ji.createElement(Bg,{isDisabled:D,label:E,show:c}),Ji.createElement(Hg,{centerSlider:d&&g},Ji.createElement(Ng,{type:"range",role:"slider","aria-hidden":z,tabIndex:0,value:i,min:r,max:o,step:T,style:u,disabled:D,id:Ge,onChange:this.onSliderChange,adjust:y,name:E,onKeyUp:this.onSliderChange,onKeyDown:this.onSliderChange,onMouseUp:K,onTouchEnd:re}),te))}}jd.defaultProps={showLabel:!0,showInput:!0,adjust:!1,centerSlider:!1,min:-1,max:1,value:0,step:.01,decimal:0,divider:100,suffix:""};var Ud=jd;import Ut from"react";import Ug from"styled-components";const Pr=Ug(et)`
  color: ${e=>e.theme.button.textPrimaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&Nt}

  ${Ve} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`;import Wg from"styled-components";const Br=Wg(et)`
  color: ${e=>e.theme.button.textSecondaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&Nt}

  ${Ve} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`;class Wd extends Ut.Component{constructor(){super(...arguments);this.onDismiss=()=>{const{handleClose:e,handleDismiss:t}=this.props;e&&e(),t&&t()};this.onConfirm=()=>{const{handleClose:e,handleConfirm:t}=this.props;e&&e(),t&&t()}}render(){const{headerLabel:e,bodyLabel:t,confirmLabel:i,dismissLabel:r,type:o,children:n}=this.props,a=Ut.Children.toArray(n)[0];if(!Ut.isValidElement(a))throw new Error("Child is not a valid react element");return Ut.cloneElement(a,{handleConfirm:this.onConfirm,handleDismiss:this.onDismiss,header:Ut.createElement(Gi,null,e),body:Ut.createElement(Lt,{"data-test":ye.DialogBody},t),footer:Ut.createElement(Vi,{type:o},r&&Ut.createElement(Br,{label:r,ariaLabel:r,onClick:this.onDismiss}),i&&Ut.createElement(Pr,{label:i,ariaLabel:i,onClick:this.onConfirm}))})}}import Ft from"react";import Zo from"styled-components";const $g=Zo.div`
  display: flex;
`,Vg=Zo(Gi)`
  padding: 0;
`,Gg=Zo.div`
  display: flex;
  flex-direction: column;
  margin-left: 8px;
  @media all and (min-width: 640px) {
    margin-left: 30px;
  }
`,qg=Zo(Lt)`
  padding: 0;
  margin: 0;
`;class $d extends Ft.PureComponent{render(){const{headerLabel:e,bodyLabel:t,children:i}=this.props,r=Ft.Children.toArray(i)[0];if(!Ft.isValidElement(r))throw new Error("Child is not a valid react element");return Ft.cloneElement(r,{height:"90px",body:Ft.createElement(Lt,{"data-test":ye.DialogBody},Ft.createElement($g,null,Ft.createElement(Po,null),Ft.createElement(Gg,null,Ft.createElement(Vg,null,e),Ft.createElement(qg,null,t))))})}}import tt from"react";import Lr from"styled-components";const Xg=Lr.form`
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
`,Kg=Lr.textarea`
  display: flex;
  caret-color: ${e=>e.theme.primary};
  ${ci}
  min-height: 100%;
  padding: 0px;
  outline-offset: -8px;
  color: ${e=>e.theme.modal.bodyForeground};
  resize: none;
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;

  &:selection,
  &:-moz-selection {
    background-color: ${e=>e.theme.primary};
    color: ${e=>e.theme.foreground};
  }
`,Yg=Lr.label`
  padding: 11px 20px 8px;
  font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
  color: ${e=>e.theme.modal.headerForeground};
`,Jg=Lr(Lt)`
  height: 100%;
`,Zg=Lr(Vi)`
  border-top: none;
`;class Vd extends tt.Component{constructor(){super(...arguments);this.state={value:""};this.input=tt.createRef();this.handleKeydown=e=>{bl(this.handleDismiss)(e)};this.handleDismiss=()=>{const{handleDismiss:e}=this.props;e&&e(!1)};this.handleConfirm=()=>{const{handleConfirm:e}=this.props,{value:t}=this.input.current;t&&(e&&e(t),this.handleDismiss())};this.onChange=e=>{const t=rl(e.target.value);this.input.current.value=t,this.setState({value:t})};this.onSubmit=e=>{e.preventDefault()}}componentDidMount(){const{text:e,defaultText:t}=this.props;this.input.current.focus(),this.input.current.value=e||t||"",this.setState({value:this.input.current.value}),document.addEventListener("keydown",this.handleKeydown,!1),e===t&&this.input.current.select()}componentDidUpdate(e){const{isVisible:t}=this.props;e.isVisible!==t&&(t&&this.input.current.focus())}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeydown,!1)}render(){const{headerLabel:e,dismissLabel:t,confirmLabel:i,maxLength:r,type:o,children:n}=this.props,{value:a}=this.state,l=tt.Children.toArray(n)[0];if(!tt.isValidElement(l))throw new Error("Child is not a valid react element");return tt.cloneElement(l,{handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss,isConfirmDisabled:!a,height:"150px",header:tt.createElement(Yg,{htmlFor:"photoeditorsdk-TextInput"},e),body:tt.createElement(Jg,null,tt.createElement(Xg,{onSubmit:this.onSubmit},tt.createElement(Kg,{ref:this.input,id:"photoeditorsdk-TextInput",placeholder:"Write Something",autoFocus:!0,onChange:this.onChange,maxLength:r}))),footer:tt.createElement(Zg,{type:o},tt.createElement(Br,{label:t,ariaLabel:t,onClick:this.handleDismiss}),tt.createElement(Pr,{label:i,ariaLabel:i,isDisabled:!a,onClick:this.handleConfirm}))})}}Vd.defaultProps={defaultText:"Write Something"};var Gd=Vd;import Qg from"styled-components";const qd=Qg.div`
  padding-bottom: ${e=>(e.count||1)*8}px;
`;var Xd=qd;qd.defaultProps={count:1};import Zi from"react";class Kd extends Zi.Component{getChildren(){const e=[],t=[];return Zi.Children.forEach(this.props.children,i=>{switch(i.type.componentName){case"case":this.props.type===i.props.value&&e.push(i);break;case"default":t.push(i);break}}),e.length>0?e:t}render(){const e=this.getChildren();return e.length===0?null:Zi.createElement(Zi.Fragment,null,e)}}class Xs extends Zi.Component{render(){return this.props.children}}Xs.componentName="case";class Ks extends Zi.Component{render(){return this.props.children}}Ks.componentName="default";import eb,{keyframes as tb,css as ib}from"styled-components";const rb=tb`
  from { transform: translate(-50%, 0%); }
  to { transform: translate(-50%, 50%); }
`,ob=eb.div`
  position: absolute;
  top: ${e=>e.position.y}px;
  left: ${e=>e.position.x}px;
  transform: translate(-50%, 50%);
  background: black;
  color: white;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  padding: 10px 16px;
  text-align: center;
  z-index: ${e=>e.theme.measurements.zIndex.toast};
  visibility: hidden;

  ${({show:e})=>e&&ib`
      visibility: visible;
      animation: ${rb} 0.5s, fadeout 0.5s 2.5s;
    `}
`;var Yd=ob;import Ys from"react";import Js,{css as Jd}from"styled-components";const nb=Js(et)`
  ${({fullWidth:e})=>e&&Jd`
      width: 100%;
    `}
`,sb=Js.div`
  &:focus {
    outline: none;
  }

  > img {
    height: 18px;
    width: 18px;
  }

  > svg {
    height: 18px;
    width: 18px;
  }
  display: none;

  @media all and (min-width: 0) and (max-width: 599px) {
    display: flex;
  }
`,ab=Js.div`
  display: flex;
  justify-content: center;
  align-items: center;
  &:focus {
    outline: none;
  }

  ${({hasIcon:e})=>e&&Jd`
      @media all and (min-width: 0) and (max-width: 599px) {
        display: none;
      }
    `}
`,xi=n=>{var{label:e,children:t,icon:i,fullWidth:r}=n,o=qe(n,["label","children","icon","fullWidth"]);const a=Ys.createElement(ab,{hasIcon:!!i},e,t);return Ys.createElement(nb,f({fullWidth:r},o),i&&Ys.createElement(sb,null,i),(t||e)&&a)};import lb from"styled-components";const cb=lb(xi)`
  background: ${e=>e.theme.button.outlinedPrimaryBackground};
  color: ${e=>e.theme.button.outlinedPrimaryForeground};
  border: 1px solid ${e=>e.theme.button.outlinedBorderColor};
  min-width: 32px;
`;import db from"styled-components";const ub=db(xi)`
  background: ${e=>e.theme.button.outlinedSecondaryBackground};
  color: ${e=>e.theme.button.outlinedSecondaryForeground};
  border: 1px solid ${e=>e.theme.button.outlinedBorderColor};
`;import JO from"react";import Zd from"styled-components";const iA=Zd(et)`
  color: ${e=>e.theme.foreground};
  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&Nt}

  ${Ve} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`,rA=Zd.div`
  display: flex;
  &:focus {
    outline: none;
  }
`;import hb from"styled-components";const pb=hb(xi)`
  background: ${e=>e.theme.button.containedPrimaryBackground};
  color: ${e=>e.theme.button.containedPrimaryForeground};
  border: 1px solid ${e=>e.theme.button.containedPrimaryBackground};

  &:active {
    color: ${e=>e.theme.button.containedPrimaryForeground};
  }
`;import Qi from"react";import fb,{css as Qd}from"styled-components";const mb=()=>Qd`
    animation: ${fo} 0.2s linear;
  `,gb=Qd`
  border: 1px solid ${e=>e.theme.card.activeBorderColor};
  ${js} {
    background-color: ${e=>e.theme.card.activeOverlayColor};
  }
`,bb=fb.button.attrs(e=>{const t={};return e.image&&(t.backgroundImage=`url(${e.image})`),{style:t}})`
  &&& {
    box-sizing: border-box;
  }

  /* basic ui text items use position absolute */
  position: relative;

  padding: 0;
  cursor: pointer;
  /* Safari will change the height of the toolbar and position the category cards at the bottom for some reason */
  vertical-align: top;
  border: none;
  box-sizing: border-box;
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  background-color: ${e=>e.theme.card.background};
  color: ${e=>e.theme.card.foreground};
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  ${mb};
  animation-fill-mode: both;
  overflow: hidden;

  ${ve}

  /* Active */

  /* No :active styles on purpose. */

  ${({isActive:e})=>e&&gb}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${Ve} {
      background-color: ${e=>e.theme.card.inactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${Ki} {
      background-color: ${e=>e.theme.card.hoverOverlayColor};
    }
  }
`;class eu extends Qi.Component{constructor(){super(...arguments);this.state=Go;this.timeout=null;this.onKeyDown=e=>{(e.key==="Space"||e.key==="Enter")&&(this.props.onClick&&this.props.onClick())};this.onClick=e=>{const t=e.currentTarget.getBoundingClientRect(),i=e.pageX-t.left,r=e.pageY-t.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(i,r)}):this.setRippleState(i,r),this.props.onClick(e)};this.setRippleState=(e,t)=>{this.setState({left:e,top:t,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){const{children:e,label:t,isActive:i,isDisabled:r,image:o,style:n,className:a}=this.props,{left:l,top:c,display:d}=this.state;return Qi.createElement(bb,{isActive:i,"aria-label":t,"data-test":t,disabled:r,image:o,onClick:this.onClick,onKeyDown:this.onKeyDown,style:n,className:a},e,Qi.createElement(qo,{display:d,left:l,top:c}),Qi.createElement(js,null),Qi.createElement(Ve,null),Qi.createElement(Ki,null))}}eu.defaultProps={isActive:!1};import gA from"react";import Nr,{css as Qo}from"styled-components";const SA=Nr.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 4px;
  font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
`,DA=Nr.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  position: absolute;
  bottom: 0px;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  left: 0;
  ${e=>e.withBackground?Qo`
          color: ${e.theme.card.labelForeground};
          height: 40px;
          background: ${e.theme.card.labelBackground};
        `:Qo`
          color: ${e.theme.card.foreground};
          height: 32px;
        `}
  width: 100%;
  cursor: pointer;
`,wA=Nr.div`
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${e=>e.theme.card.labelForeground};
  ${e=>e.withBackground?Qo`
          border-top-color: ${e.theme.card.labelForeground};
        `:Qo`
          border-top-color: ${e.theme.card.foreground};
        `}
  transform: rotate(${e=>e.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
`,xA=Nr.span`
  display: flex;
  align-items: center;
  justify-content: center;
  padding-left: 10px;
`,CA=Nr.div`
  ${$i}
`;import yb from"styled-components";const vb=yb.div.attrs(e=>({"data-test":ye.CardAvatar,style:{backgroundImage:`url(${e.url})`}}))`
  position: absolute;
  top: 4px;
  left: 4px;
  height: 28px;
  width: 28px;
  border-radius: 50%;
`,MR={Focused:ve,VisuallyHidden:$i},zR={ripple:po,scale:Ul,slide:fo},PR={Container:uc,ColorItem:Gc,ColorItemBase:Io,ColorItemBackground:To,ColorItemTiledBackground:Oo,ColorItemActiveOverlay:Fo,Dialog:qc,DialogBase:Mo,DialogContainer:zo,DialogBackdrop:Ro,DialogHeader:Gi,DialogBody:Lt,DialogFooter:Vi,DialogSpinner:Po,TextEditModal:Gd,ActionModal:Wd,InfoModal:$d,Spacer:Xd,Draggable:ld,DraggableCore:Xi,Toast:Yd,Input:{Label:Ce,File:Ad,Search:Bd,Slider:Ud,CarouselSlider:vd,Selection:Hd,Checkbox:wd,CheckboxBase:Xo,CheckboxInput:Ko,CheckboxCheckMark:Fr,Dropdown:Od,Text:Yo,NumericInput:Jo,Form:Rd},Switch:{Index:Kd,Case:Xs,Default:Ks}},BR={CommonInputStyles:ci};export{JO as a,gA as b,ll as c,cc as d,sl as e,fl as f,ds as g,nl as h,dl as i,ul as j,pb as k,cb as l,ub as m,al as n,gl as o,Ve as p,vb as q,cl as r,ml as s,Pr as t,Br as u,Pv as v,pl as w,iA as x,hl as y,SA as z,O as A,xi as B,Us as C,rA as D,qe as E,DA as F,Z as G,wA as H,xA as I,zn as J,CA as K,et as L,$ as M,eu as N,Jt as O,I as P,fr as Q,s as R,ye as S,ce as T,MR as U,zR as V,PR as W,xr as X,ks as Y,Ts as Z,Wf as _,$c as $,p as aa};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
